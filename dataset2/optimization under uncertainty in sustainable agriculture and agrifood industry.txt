Víctor M. Albornoz
Alejandro Mac Cawley
Lluis M. Plà-Aragonés   Editors
Optimization 
Under Uncertainty 
in Sustainable 
Agriculture and 
Agrifood IndustryOptimization Under Uncertainty in Sustainable 
Agriculture and Agrifood IndustryVíctor M. Albornoz • Alejandro Mac Cawley •
Lluis M. Plà-Aragonés 
Editors 
Optimization Under 
Uncertainty in Sustainable 
Agriculture and Agrifood 
IndustryEditors 
Víctor M. Albornoz 
Departamento de Industrias 
Universidad Tecnica Federico Santa Maria 
Santiago, Chile 
Lluis M. Plà-Aragonés 
Department of Mathematics 
University of Lleida 
Lleida, Spain 
Alejandro Mac Cawley 
Pontifical Catholic University of Chile 
Santiago, Chile 
ISBN 978-3-031-49739-1 ISBN 978-3-031-49740-7 (eBook) 
https://doi.org/10.1007/978-3-031-49740-7 
© Springer Nature Switzerland AG 2024 
This work is subject to copyright. All rights are reserved by the Publisher, whether the whole or part of 
the material is concerned, specifically the rights of translation, reprinting, reuse of illustrations, recitation, 
broadcasting, reproduction on microfilms or in any other physical way, and transmission or information 
storage and retrieval, electronic adaptation, computer software, or by similar or dissimilar methodology 
now known or hereafter developed. 
The use of general descriptive names, registered names, trademarks, service marks, etc. in this publication 
does not imply, even in the absence of a specific statement, that such names are exempt from the relevant 
protective laws and regulations and therefore free for general use. 
The publisher, the authors, and the editors are safe to assume that the advice and information in this book 
are believed to be true and accurate at the date of publication. Neither the publisher nor the authors or 
the editors give a warranty, expressed or implied, with respect to the material contained herein or for any 
errors or omissions that may have been made. The publisher remains neutral with regard to jurisdictional 
claims in published maps and institutional affiliations. 
This Springer imprint is published by the registered company Springer Nature Switzerland AG 
The registered company address is: Gewerbestrasse 11, 6330 Cham, Switzerland 
Paper in this product is recyclable.Prologue 
We are proud to present this Handbook, with selected chapters devoted to optimiza￾tion under uncertainty in sustainable agriculture and agrifood industry. Agricultural 
systems involve a lot of uncertainty and make the decision-making process difficult 
for the decision-maker, which is not always the farmer in modern or intensive agri￾culture. Decision support systems in agriculture must consider models and available 
databases to face real-world problems with guarantees. There is an agreement on 
the necessity of sustainable agriculture; however, there is a controversy if economic 
sustainability should prevail over environmental respect and social development. 
We do not take part in this dispute and have allowed the contributors an open 
interpretation of sustainability. The result corroborates the difficulties of accounting 
for the social and environmental pillars of sustainability face to the economic pillar, 
present in all the chapters. 
This Handbook was promoted by the CYTED-funded BigDDSAgro1 network 
(Red Iberoamericana de Agro-Bigdata y Decision Support Systems para un sector 
agropecuario sostenible, in Spanish). The BigDSSAgro network started its activities 
in 2016, and it comprises research groups from 39 institutions (universities, public 
research centers, and private companies), coming from 15 different countries in 
Latin America, Europe, and Oceania. The network’s main objectives are promoting 
the interaction, cooperation, transfer of knowledge, and technologies related to het￾erogeneous information systems supporting decision-making in agriculture. Among 
other activities, the BigDSSAgro network organizes regular meetings, develops 
student and researcher exchanges, and supports the proposal of joint research and 
cooperation activities. This Handbook is the fruit of our last Conference, before the 
COVID19, where invitation letters were issued to potential contributors to this book 
and finally, eight chapters were selected, which are now presented in this Handbook. 
In general, the chapters of this book deal with agricultural decision prob￾lems involving big companies or big challenges. They are complex problems of 
considerable size that develop innovative OR methods to give solution to these
1 https://www.cyted.org/BIGDSSAGRO 
vvi Prologue
problems. To point out some of the different methodologies deployed along the 
book and adapted to particular agricultural decision problems, we can observe: 
Routing, transportation, risk management, evolutionary algorithms, and stochastic 
optimization. Applications range from various agricultural areas like wine or grain 
transportation, fresh produce planning, crop rotation, waste valorization, pesticide 
application, or cold storage management in the fruit supply chain. 
The chapters in this book have been ordered and grouped according to a rational 
sorting criteria giving sense and facilitating the movement from one paper to the 
next. Even though they are self-contained, the reader can skip from one to the other 
according to their likes or needs. The papers portrait the diversity of subjects covered 
and give a good idea of the importance of the subject and the size of the research 
communities engaged in this area. The Guest-Editors would like to thank the authors 
for their contributions and hope that the readers will appreciate this special issue and 
will profit from the methodologies, ideas, and real application examples to further 
contribute to this growing area. 
Santiago, Chile Víctor M. Albornoz 
Santiago, Chile Alejandro Mac Cawley Vergara 
Lleida, Spain Lluis Miquel Plà-AragonésContents 
Wine Journey: A Methodology for Analysing Wine Shipping 
Route Based on Temperature and Risk........................................ 1 
Max Garafulic and Alejandro F. Mac Cawley 
1 Introduction .................................................................. 1 
2 Literature Review ............................................................ 2 
3 Methodology ................................................................. 4 
3.1 Container Temperature Data .......................................... 5 
3.2 External Temperature Data and Correlation Calculation ............ 6 
3.3 Regression Model: Fitting and Validation ............................ 9 
3.4 Indicators and Risk Definition ........................................ 10 
4 Results........................................................................ 12 
4.1 Correlations and Fitted Model ........................................ 12 
4.2 Model Validation ...................................................... 13 
4.3 Decision-Making ...................................................... 15 
4.3.1 Case Study 1: Melbourne (AUS) to Oakland (USA) ........ 15 
4.3.2 Case Study 2: Melbourne (AUS) to Miami (USA) .......... 18 
4.3.3 Case Study 2: Route Risk Index Analysis.................... 19 
5 Discussion .................................................................... 20 
6 Conclusion ................................................................... 23 
Appendix: Interpolation Algorithm Explanation................................. 24 
References ......................................................................... 26 
Model for Estimating the Demand for Soybean Railway 
Transport in Brazil’s Logistic Corridors Under Competitive 
Conditions......................................................................... 29 
Thiago Guilherme Péra, Abner Matheus João, 
and José Vicente Caixeta Filho 
1 Introduction .................................................................. 29 
2 Methods ...................................................................... 30 
3 Results........................................................................ 31 
4 Conclusions and Contributions.............................................. 34 
References ......................................................................... 34
viiviii Contents
Implementing a Decision Support System for Plant Variety 
Testing in the Czech Republic .................................................. 35 
David Hampel, Martin Tláskal, and Jitka Janová 
1 Introduction .................................................................. 35 
2 The Role of Design Planning in Field Trials ............................... 36 
3 Alpha-Design ................................................................ 38 
3.1 Alpha-Design Construction ........................................... 39 
3.1.1 Alpha-Design When v = ks .................................. 39 
3.1.2 Alpha-Design when v = ks................................... 40 
4 Design Optimality Criteria .................................................. 40 
4.1 A-Optimal Alpha-Design ............................................. 42 
5 Ex Post Constraints in Alpha-Design ....................................... 43 
5.1 Self-Proximities Problem ............................................. 43 
5.2 Dividing the Experiment into Multiple Strips........................ 44 
5.3 Groups of Varieties According to Certain Characteristics ........... 45 
5.4 Additional Modifications to the Alpha-Design....................... 45 
6 Validation of the Damage-Robust Alpha-Design........................... 46 
6.1 Influence on the Evaluation of the Experiment....................... 46 
6.2 Validation .............................................................. 47 
7 Lessons Learned from Implementation in CISTA Practice ................ 48 
7.1 Neighbouring Plant Varieties Problem................................ 49 
7.1.1 NPVP in the Original and Damage-Resistant 
Alpha-Design .................................................. 49 
7.1.2 Addressing the Neighbouring Plant Varieties Problem ...... 51 
8 Implementation Problems Due to Personnel Influences ................... 54 
9 Conclusions .................................................................. 59 
References ......................................................................... 60 
Agri-food Supply Chain: An Optimisation Approach for Waste 
Valorisation ....................................................................... 63 
João Pires-Ribeiro, Lourenço Cruz, and Ana Barbosa-Póvoa 
1 Introduction .................................................................. 63 
2 Agri-food Supply Chains Characteristics and Challenges ................. 64 
2.1 AFSC’s Challenges .................................................... 66 
2.1.1 Sustainability and Waste Reduction .......................... 66 
2.1.2 Uncertainty and Changes in Consumer Behaviour .......... 67 
2.1.3 Product Perishability .......................................... 67 
2.1.4 Lead Times and the Retail Sector............................. 68 
3 Design and Planning of AFSC .............................................. 69 
3.1 Problem Description ................................................... 69 
3.2 Model Formulation .................................................... 71 
3.2.1 Sets............................................................. 71 
3.2.2 Scalars ......................................................... 72 
3.2.3 Parameters ..................................................... 72 
3.2.4 Variables ....................................................... 73Contents ix
3.2.5 Objective Function ............................................ 75 
3.2.6 Constraints..................................................... 77 
4 Case Study, Results, and Discussion ........................................ 86 
4.1 Case Study Specifications ............................................. 86 
4.2 Case Study Data ....................................................... 87 
4.3 Results and Discussion ................................................ 93 
4.3.1 Results Analysis............................................... 94 
4.3.2 Results Summary .............................................. 101 
5 Conclusions and Future Research Steps .................................... 102 
References ......................................................................... 103 
Managing Risk in Fresh Produce Planning Considering Price 
Variability, Yield Variability, and Regional Complementarity.............. 105 
Miguel Peinado-Guerrero, Omar Ahumada, Rodrigo Ulloa, 
Xaimarie Hernandez-Cruz, Grace Neal, Abhay Jayani, 
and J. Rene Villalobos 
1 Introduction .................................................................. 105 
1.1 Problem Statement..................................................... 106 
1.2 A Brief Review of Previous Work .................................... 106 
1.3 Objectives of This Work............................................... 108 
2 Uncertainties in the Planning Decisions of Fresh Produce................. 109 
2.1 Price Variability........................................................ 109 
2.2 Yield Variability ....................................................... 111 
3 Stochastic Model Formulation .............................................. 112 
3.1 Notation ................................................................ 113 
3.2 Contract ................................................................ 115 
3.3 Two-Stage Stochastic Program Description .......................... 115 
3.3.1 First-Stage Problem ........................................... 117 
3.3.2 Second-Stage Problem ........................................ 119 
4 Solution Procedure........................................................... 121 
5 Case Study ................................................................... 123 
6 Conclusions and Directions for Future Research........................... 131 
References ......................................................................... 132 
In Silico Evaluation and Prediction of Pesticide Supported 
by Reproducible Evolutionary Workflows .................................... 135 
Anderson Oliveira, Fabricio Firmino, Pedro Vieira Cruz, 
Jonice de Oliveira Sampaio, and Sérgio Manuel Serra da Cruz 
1 Introduction .................................................................. 135 
2 Background .................................................................. 137 
2.1 Reproducibility Challenges in Evolutionary Computing ............ 137 
2.2 Evolutionary Scientific Workflows ................................... 139 
2.3 Island Model Optimisation Paradigm................................. 141 
3 Materials and Methods ...................................................... 143 
3.1 Materials ............................................................... 143 
3.2 Methodology ........................................................... 144x Contents
4 Results........................................................................ 145 
4.1 Evolutionary Algorithm Modules..................................... 146 
5 Discussion .................................................................... 149 
5.1 Answering Competency Questions ................................... 149 
5.1.1 CQ 1: Descriptive Statistics................................... 150 
5.1.2 CQ 2: Ranking of Pesticide Traces ........................... 152 
5.1.3 CQ 3: Classification of the Top Ten Pesticides .............. 152 
5.1.4 CQ 4: Prediction of Malathion Use........................... 153 
6 Conclusions .................................................................. 155 
References ......................................................................... 156 
A Precision Agriculture Approach for a Crop Rotation Planning 
Problem with Adjacency Constraints.......................................... 161 
Víctor M. Albornoz and Gabriel E. Zamora 
1 Introduction .................................................................. 161 
2 Literature Review ............................................................ 163 
2.1 The Management Zone Problem ...................................... 164 
2.2 The Crop Rotation Problem ........................................... 165 
3 Modeling Approach.......................................................... 166 
4 Computational Results....................................................... 170 
5 Conclusions and Further Research .......................................... 174 
References ......................................................................... 175 
A System for Supporting Supplier and Cold Storage Selection 
in the Fresh Fruit Supply Chain................................................ 179 
Wladimir E. Soto-Silva, Marcela C. González-Araya, and Lluís M. Plà￾Aragonés 
1 Introduction .................................................................. 179 
2 Literature Review ............................................................ 180 
3 Supplier Selection in the Fresh FSC ........................................ 184 
4 FruitPS-DSS Development and Design ..................................... 188 
5 The Planning Model ......................................................... 189 
6 Database and Pre-processing ................................................ 191 
7 Graphical Interface........................................................... 192 
8 FruitPS-DSS Performance in a Chilean Agri-industrial Company ........ 194 
8.1 Analyzing Different Scenarios Through the FruitPS-DSS .......... 196 
9 Report from the FruitPS-DSS Using Data from the Case Study........... 201 
10 Feedback from Chilean Agri-industrial Companies........................ 204 
11 Conclusions and Future Research ........................................... 204 
Appendix 1......................................................................... 205 
Appendix 2......................................................................... 208 
References ......................................................................... 210Wine Journey: A Methodology 
for Analysing Wine Shipping Route 
Based on Temperature and Risk 
Max Garafulic and Alejandro F. Mac Cawley 
1 Introduction 
Chile is currently the fourth largest wine-exporting country in the world, with 
9.8 million hectolitres (mhl) exported in 2017. It is only surpassed by Spain with 
22.1 mhl, Italy with 21.4 mhl, and France with 15.4 mhl (OIV, 2018). Wine export 
volumes have continuously increased. In 2016, the global export volume was 
104 mhl, while in 2001 it was only 60 mhl (indicating a growth of 73.33% in 15 
years) (OIV, 2018). Moreover, wine exports have become highly significant in the 
case of wine-producing countries with a small internal market, where most wineries 
obtain their income through sales in the foreign market. In the case of Chile, 
67% of the wineries derive their revenue from export markets, while 30% of them 
obtain 90% of their income from export sales (Wickramasekera & Bianchi, 2013). 
Therefore, within the international wine supply chain, good maritime transport 
decision-making by the wineries has become increasingly important. 
On the other hand, the high cost of reefers, which is three times that of a dry 
van container (Mac Cawley, 2014), causes producers to export wine in the latter. 
For example, in South Africa, 80% of its wine is shipped in standard 20-foot 
containers, while the rest is exported in reefers and 40-foot containers (Meyer, 
2002). Consequently, during its maritime transport, the wine is potentially exposed 
to extreme environmental conditions, which can affect its quality, with temperatures 
being the most critical variable to consider, according to previous research (Meyer, 
2002; Butzke et al., 2012; Benítez et al., 2003; Chung et al., 2008; Lam et al., 2013; 
Pérez-Coello et al., 2003; Recamales et al., 2006; Hasnip et al., 2004; Sivertsen 
M. Garafulic · A. F. Mac Cawley (O) 
Department of Industrial and Systems Engineering, Pontificia Universidad Católica de Chile, 
Santiago, Chile 
e-mail: mgarafulic1@uc.cl; amac@uc.cl 
© Springer Nature Switzerland AG 2024 
V. M. Albornoz et al. (eds.), Optimization Under Uncertainty in Sustainable 
Agriculture and Agrifood Industry, https://doi.org/10.1007/978-3-031-49740-7_1
12 M. Garafulic and A. F. Mac Cawley
et al., 2001; Hartley, 2001). Therefore, it is fundamental to consider the temperatures 
along different routes and the risk they pose to the wine quality. 
The main problem is that transport decisions are based only on transportation 
costs. Usually, the freight forwarders use the least cost route to send containers 
(Cullinane & Toy, 2000), without considering the risk to wine quality due to heat 
exposure (Mac Cawley, 2014). Previously, Butzke et al. (2012) pointed out the 
ignorance of producers, shippers, and consumers regarding this problem. As a result, 
according to Parker (2008), between 10% and 25% of wines sold in America have 
been damaged by exposure to high temperatures. 
Our objective is to improve and support the current maritime transport decision￾making by assessing the risk to wine quality associated with a route and its 
transportation cost. To achieve this, our first contribution is to determine if there 
is a correlation between the temperature inside dry van containers and the external 
temperature along different shipping routes for bottled wine exports, to develop a 
model and predict the internal temperature along maritime trips around the world. 
Our second contribution is the identification of indicators that can assess the risk of a 
given route based on the predicted internal temperatures along the routes and on the 
Arrhenius equation, which allows us to relate the temperature with an acceleration 
of chemical reactions in the wine (Mac Cawley, 2014). We present two case studies 
in which the decision-maker must select one of the routes available, using a port and 
date of departure and a port and date of arrival. 
The paper is structured as follows. Firstly, Sect. 2 presents a review of the 
research related to this work. Subsequently, the work methodology is presented in 
Sect. 3, followed by the results in Sect. 4. Finally, the results and the conclusions are 
discussed in Sects. 5 and 6, respectively. 
2 Literature Review 
One of the main studies documenting temperature measurements in wine transport 
was carried out by Mac Cawley (2014). The author registered, within 4 years, 
transport temperatures of 735 trips in the entire wine supply chain, using more than 
1000 dataloggers. Subsequently, he compared the temperature behaviour at various 
stages of the chain: land transport to the port of departure, maritime transport and 
transhipment, and ground transportation from the destination port to the importer. 
Similar to Butzke et al. (2012), Mac Cawley (2014) used the Arrhenius equation 
to quantify the risk that temperature poses to the quality of wine, by comparing 
the rate of chemical reactions at the temperatures observed, with the rate under 
ideal temperature conditions along maritime routes. Before this work, the most 
important research was carried out by Butzke et al. (2012). The authors recorded the 
temperatures inside 47 standard 12-bottle cases of wine, dispatched from California 
to 13 destinations within the United States. Using the Arrhenius equation, the 
authors quantified the accumulated heat exposure of wine along land routes. On the 
other hand, Meyer (2002) summarized the research available on wine transportationAnalyzing Wine Shipping Route 3
temperatures in South Africa (based on recorded temperatures in various maritime 
trips) and the effect of heat exposure on some properties of wine. Another study 
was carried out by Marquez et al. (2012), where the temperatures of wine shipments 
to the United States from Australia were tracked with information recorded by 57 
dataloggers between June and December 2008. The temperatures were studied in 
three stages: land transport in Australia to the port of origin, travel at sea, and 
transportation by land in the United States. For each stage, we determined the 
following parameters: mean, minimum, and maximum average temperature. These 
authors proposed two thresholds of 25 ◦C and 40 ◦C and calculated the time at which 
the wine was over these limits. Finally, Hartley (2001), based on Meyer (2002) work, 
studied the feasibility of importing bulk wine to the United Kingdom to reduce glass 
waste. In this case, the difference in the effect of heat exposure between bottled and 
bulk wine was studied. The author suggested that the thermal inertia of bulk wine 
reduces the effect of heat exposure, thus being an advantage compared to bottled 
wine. 
With the project NCEP-NCAR Reanalysis 1 of the National Oceanic and 
Atmospheric Administration (NOAA) (1996), we obtained data on environmental 
(external) temperatures along the maritime trips studied. Various climatological 
variables, including the temperature on Earth’s surface, have been recorded since 
1948 and documented in databases (one per year). Specifically, the temperature has 
been recorded in a point mesh of 2.5 × 2.5 degrees of latitude and longitude, with a 
6-hour frequency. The data provided by this project have mainly been used in recent 
climatology and atmospheric science studies (Hartmann et al., 2016; Varikoden 
and Ramesh Kumar, 2014; Jadin et al., 2010; Yang et al., 2016; Zhang et al., 
2011; Ji et al., 2018). For example, Ji et al. (2018) evaluated the effects of the 
Indian Ocean’s springtime sea surface temperature on the Tibetan Plateau’s heat 
source in summer, using daily NCEP-NCAR Reanalysis data of four climatological 
variables, including air temperature, at 17 pressure levels, from 1979 to 2011. On 
the other hand, Yang et al. (2016) used monthly mean NCEP-NCAR Reanalysis 
of five variables, including air temperature, from 1948 to 2002, to study the inter￾decade variation in the intensity of the South Asian High (anticyclone in the upper 
troposphere over the Tibetan Plateau), explained by the potential anomalies in these 
variables. 
Regarding temperature modelling, there are no previous studies in the transport 
sector that relate the temperature inside a system (in our case, inside containers) 
to the outside temperature (air temperature on Earth’s surface). The relationship 
between temperatures has been modelled in climatological and hydrological studies. 
Laanaya et al. (2017) modelled the average daily water temperature of the Sainte￾Marguerite River (Quebec, Canada) according to the average air temperature and 
flow. The aim was to compare the performance of four models, including a linear 
regression one. Another relevant study by Bilgili (2010) analysed three models 
(a linear regression model, a non-linear regression model, and an artificial neural 
network) to explain the monthly soil temperature as a function of the monthly values 
of air temperature and six other meteorological variables observed at the Adana 
meteorological station (Turkey). Lastly, a similar study was conducted by Sahoo4 M. Garafulic and A. F. Mac Cawley
et al. (2009). Based on the data from four water streams that flow into Lake Tahoe 
(USA), the authors compared the accuracy of three models (artificial neural network, 
chaotic non-linear dynamic model, and a regression model) to explain the behaviour 
of the daily stream water temperature based on the daily air temperature and solar 
radiation. They studied the effect of considering different daily lags of these two 
explanatory variables on the forecast performance of the models. 
Concerning the risk in wine transport, the Arrhenius equation has been used 
previously to assess the danger to wine quality in the study by Butzke et al. (2012) 
and Mac Cawley (2014). However, within maritime transport, the risk concept 
has been addressed only for hazardous products and the environmental damage 
caused by accidents. Various studies have focused on the literature review of risk 
assessment. Ozbas (2013) addressed qualitative and quantitative methods for risk 
analysis of accidents. On the other hand, Goerlandt and Montewka (2015), based 
on Aven (2012) classification of various approaches of risk (expected cost or loss, 
probability of an undesirable event, etc.), reviewed studies from 1970 to 2014, in 
which these approaches have been used. Most studies have focused on model risk 
caused by collisions, groundings, or petroleum spills. For example, they developed 
an oil maritime transport planning model in the research by Douligeris et al. (1997). 
The objective of such a model was to minimize a convex combination of the 
expected operational and spill risk costs of the shipping routes used to transport oil 
between two ports of departure and arrival. Later, Iakovou (2001) solved a similar 
multi-objective planning problem for petroleum products. 
3 Methodology 
The container temperature values are obtained from the previous work by Mac Caw￾ley (2014). Secondly, an explanation is provided for how the external temperature 
values were obtained, based on data provided by Kalnay et al. (1996), and how the 
correlation values between these two variables were calculated. Subsequently, the 
methodology used to fit and validate the model used to predict temperatures along 
routes is explained. The last section explains how risk indicators for wine quality 
were defined for the routes. 
This study presents differences concerning previous studies since no prior ones in 
maritime transport account for the temperatures during shipping and the relationship 
between external container temperatures and the ones inside. Several research has 
used water or soil temperature, in conjunction with other variables, to predict other 
variables (Laanaya et al., 2017; Bilgili, 2010; Sahoo et al., 2009). However, in our 
study, we use the information from sensed internal container transport temperature 
and correlate it with the external one (NCEP-NCAR), developing a model that can 
predict the internal container temperature by using the external one.Analyzing Wine Shipping Route 5
3.1 Container Temperature Data 
The temperature data inside dry van containers were obtained from the database by 
Mac Cawley (2014), with measurements taken by 167 thermographs placed on 74 
transport trips during various years and dates. In this database, each measurement of 
the thermograph is associated with the moment it was recorded. The measurement 
frequency was defined in 2-hour intervals. Further, each thermograph is related to 
the voyage of a vessel. Each ship has the times of departure and arrival to the 
destination assigned to it and the specific maritime route followed. Finally, each 
route is described by its length and some marked points (longitude and latitude) that 
define its shape. As an example, Fig. 1 shows the points marked along a route from 
San Antonio (CHI) to New York (USA). 
Although the temperature information was available along with the exact times 
the measurements were recorded, the ship’s location was unknown, which is 
necessary to correlate the ship’s position with a point on the NCEP-NCAR mesh 
and, thus, to assign an external temperature value. To determine these points, an 
interpolation algorithm with two stages was programmed. In the first stage, the 
accumulated distance travelled until each marked point of the route was calculated. 
In the second stage, a ship was assumed to travel at a constant speed throughout 
the route. Thus, if the departure and arrival times are ti and tf , respectively, and 
the distance of the route travelled is d, then the ships’ speed is calculated as v =
d/ (
tf − ti
)
. This allows the estimation of the distance travelled until each instance 
Fig. 1 Marked points along the San Antonio (CHI)–New York (USA) route (Mercator projection). 
Source: QGIS 2.18.156 M. Garafulic and A. F. Mac Cawley
Fig. 2 Application of interpolation algorithm on the sample route (Mercator projection). Source: 
QGIS 2.18.15 
of temperature measurement. If we have M measurement times ti ≤ tm ≤ tf , 
m = 1, ..., M, the distance travelled by the ship is dm = (tm − ti) · v. 
Then, the marked points of the route between which the ship was at each 
measurement time tm can be deduced by comparing dm with the accumulated 
distances of the marked points. Subsequently, the distance between the measurement 
point and any of the marked points can be calculated, which is noted as d2
m. To assign 
a specific position (latitude and longitude) to each recording time, it is assumed 
that between each pair of marked points, the ship moves, approximately, around 
the shortest arc that joins them. In this sense, a point qm is determined on this 
arc, whose distance to the selected marked point is similar to d2
m. The algorithm 
pseudocode is presented below, and an explanation of the pseudocode is presented 
in the appendices section. 
In this way, a trip over the route previously presented in Fig. 1 can be re￾established, as shown in Fig. 2. 
3.2 External Temperature Data and Correlation Calculation 
Once the specific points of internal temperature measurement were obtained, it was 
necessary to associate them with the external temperature values. As stated at the 
beginning of Sect. 3, temperature measurements on Earth’s surface (NCEP-NCAR 
data) from each year are provided by NOAA (Kalnay et al., 1996), with a 6-hour 
frequency.Analyzing Wine Shipping Route 7
Algorithm 1 Interpolation algorithm 
STAGE 1: 
for pn, n = 1, ..., N do 
Calculation of the distance between marked points pn and pn−1 along the route, defined as d¯
n
Calculation of the accumulated distance to each marked point along the route: D¯ n = En
k=1 d¯
k
end for 
Speed calculation: v = d/ (
tf − ti
)
STAGE 2: 
for tm, m = 1, ..., M do 
Calculation of the accumulated distance to each measurement point qm: dm = (
tm − ti
)
· v
Definition of break condition: break1= FALSE 
n = 1 
while break = FALSE do 
if D¯ n ≤ dm ≤ D¯ n+1 then 
break1= TRUE 
else 
n = n + 1 
end if 
end while 
if m ≥ 2 then 
if D¯ n ≤ dm−1 ≤ D¯ n+1 then 
Lower extreme point definition: en(m) = qm−1 
else 
Lower extreme point definition: en(m) = pn
end if 
else 
Lower extreme point definition: en(m) = pn
end if 
Upper extreme point definition En(m) = pn+1 
Definition of orthodrome parameters between extreme points 
Calculation of distance between the measurement point and the lower extreme point: d2 
m = dm − D¯ n(m)
Definition of initial coordinates (starting with the lower extreme point): φm = φn(m), λm =λn(m)
if φn(m) < φn(m)+1 then 
Definition of longitude increase in each iteration: Aφ = 10−4◦ > 0 
else 
Definition of longitude increase in each iteration: Aφ = −10−4◦ < 0 
end if 
Error definition: e = 1 km 
Definition of break condition: break2= FALSE 
Initial longitude: φm + Aφ
while break2= FALSE do 
Calculation of corresponding latitude using orthodrome equation: λm
Calculation of orthodromic distance to lower extreme point: d3 
m
if
|
|
|d3 
m − d2 
m
|
|
| < e then 
return φm, λm
break2= TRUE 
else 
Update longitude: φm ← φm + Aφ
end if 
end while 
end for 8 M. Garafulic and A. F. Mac Cawley
For each thermograph, the purpose was to assign an external temperature value to 
each internal temperature measurement point q = (φ,λ) at time t and, subsequently, 
calculate the correlation coefficient between the internal and external temperatures 
(the longitude is denoted by φ, while the latitude is denoted by λ). To achieve this, 
a small routine was programmed with R commander. The flow chart of the routine 
is as shown below:Analyzing Wine Shipping Route 9
Table 1 Trips and devices according to routes 1–24 
ID Origin Destination Trips Devices 
1 Melbourne (AUS) Oakland (USA) 1 3 
2 Valparaíso (CHI) New York (USA) 3 15 
3 San Antonio (CHI) Charleston (USA) 1 8 
4 San Antonio (CHI) Port Elizabeth (USA) 9 18 
5 San Antonio (CHI) Houston (USA) 4 7 
6 San Antonio (CHI) Port Elizabeth (USA) 2 5 
7 San Antonio (CHI) Charleston (USA) 1 5 
8 San Antonio (CHI) Miami (USA) 6 12 
9 San Antonio (CHI) Baltimore (USA) 2 3 
10 San Antonio (CHI) Long Beach (USA) 4 5 
11 San Antonio (CHI) Port Everglades (USA) 3 7 
12 San Antonio (CHI) Baltimore (USA) 7 12 
13 San Antonio (CHI) Long Beach (USA) 1 1 
14 San Antonio (CHI) Charleston (USA) 4 5 
15 San Antonio (CHI) New York (USA) 12 33 
16 San Antonio (CHI) Port Elizabeth (USA) 1 1 
17 San Antonio (CHI) Philadelphia (USA) 3 3 
18 Valparaíso (CHI) New York (USA) 2 8 
19 San Antonio (CHI) Nola (USA) 1 1 
20 San Antonio (CHI) Nola (USA) 2 4 
21 San Antonio (CHI) Seattle (USA) 2 2 
22 San Antonio (CHI) Boston (USA) 1 3 
23 Melbourne (AUS) Miami (USA) 1 2 
24 Melbourne (AUS) Philadelphia (USA) 1 4 
The correlations between internal and external temperatures were calculated for 
each thermograph, distributed into 74 trips along 24 routes. In total, 167 correlations 
were calculated. The distribution of the devices and trips by route can be observed 
in Table 1. 
3.3 Regression Model: Fitting and Validation 
An auto-regressive model was fitted, in which the internal temperature only depends 
on its previous lags and on the external temperature, that is, a model of type 
yt = α0 + α1 · xt +E
K
k=1
βk · yt−k + et, (1)10 M. Garafulic and A. F. Mac Cawley
where yt represents the temperature inside the containers at time t, xt represents 
the external temperature at the same time, K is the number of internal temperature 
lags to consider, and et
iid
∼ N (0, σ2). Each lag represents a 6-hour period. To 
fit the model, external temperature lags xt−k were not included, as their effect is 
summarized in the effect of the internal temperature lags. The fitting was made 
with the information from 65 of the 74 trips (19,097 training data) and with the 
temperature data on the Celsius scale. To select the variables, the model of c1 
was initially fitted without any internal temperature lag. Subsequently, the first lag 
(K = 1), second (K = 2) lag, and so on were considered, until the increase in R2
value was observed to be insignificant. 
The model was used to forecast (every 6 hours) the internal temperatures 
along nine trips (2294 test data) of various durations and during different seasons. 
To measure the accuracy of the forecast, two scale-dependent measures were 
selected: MAD, which, as Hyndman and Athanasopoulos (2014) suggests, is easy 
to understand, and RMSE, which has been used in previous studies where the 
temperature is the dependent variable (Laanaya et al., 2017; Sahoo et al., 2009). 
On the other hand, unlike MAD, it penalizes errors of greater magnitude. The 
advantage is that these measures are in the same data scale (◦C). For a set of N
internal temperature forecasts yˆt , t = 1, ..., N and their respective realizations yt , 
t = 1, ..., N, the MAD and the RMSE are defined, respectively, as 
MAD = 1
N ·
E
N
t=1
|
|yt − ˆyt
|
| , (2) 
RMSE =
r||]
1 
N ·
E
N
t=1
(
yt − ˆyt
)2 
. (3) 
3.4 Indicators and Risk Definition 
Two practical cases were studied. The aim was to indicate which of the routes is 
the most convenient to use in terms of risk and cost (alternative route), in case the 
cheapest route is not the least risky. The route risk was assessed based on the internal 
temperature forecast, using the model obtained in Eq. 1. The historical means of 
temperatures at each point along the route are used as an external temperature 
forecast. These are calculated based on the last 30 annual realizations, obtained 
from Kalnay et al. (1996). 
It is assumed that the probability of the merchandise arriving in poor condition is 
an increasing function of three proposed indicators, considered equally important. In 
this way, a route risk index ρ (non-dimensional) was calculated for each route, based 
on the percentage difference between its indicator value and the indicator value 
of the cheapest route. The indicators are defined as follows. Firstly, the standardAnalyzing Wine Shipping Route 11
deviation (variability) of the internal temperatures along the trip is calculated, 
denoted by σ (
◦C). According to Mac Cawley (2014), changes in temperature 
can cause piston movements on the corks, increasing the risk of wine oxidation. 
Furthermore, a threshold of 25 ◦C is proposed. This temperature is considered 
dangerous for wine quality (Mac Cawley, 2014), especially during long periods of 
exposure (Ough, 1992). The second indicator is the travel time τ (days) in which this 
threshold is exceeded. Finally, based on the Arrhenius equation and previous study 
by Mac Cawley (2014), the last indicator uses the percentage difference between 
the rate at which a reaction occurs at a variable temperature T and the rate at which 
it occurs at the base temperature Tb, which can be expressed as 
Av(T ) = 100 ·
(
e
Ea
R ·
( 1
Tb − 1
T
)
− 1
)
, (4) 
where Ea corresponds to the activation energy, measured in J/mol, and R is the 
universal constant of ideal gases, measured in J · K−1 · mol−1, while T and Tb
are measured in absolute scale (K). The optimal storage temperature of the wine is 
considered as the base temperature, that is, 13 ◦C (Butzke et al., 2012). The specific 
values of the parameters are Ea = 41.223 J/mol and R = 8.314472 J· K−1 · mol−1. 
The value of Ea corresponds to the activation energy of hydrolysed alcohol 
fermentation by the yeast Saccharomyces cerevisiae used in wine fermentation 
(Mac Cawley, 2014; Converti et al., 1996). By integrating equation 4 over a trip and 
using T = ˆyt , the accumulated acceleration of chemical reactions can be quantified 
as a percentage, denoted by Av (%), which is the third indicator. Then, if a given 
route and the cheapest route have indicators Av, τ , σ and Avc, τc, σc, respectively, 
ρ (%) is defined as 
ρ = 100 ·
(
ω1 ·
Avc − Av
Avc
+ ω2 ·
τc − τ
τc
+ ω3 ·
σc − σ
σc
)
, (5) 
where ωi = 1/3, i = 1, 2, 3. In this study, a given route is considered less risky 
than the cheapest route if it presents a positive ρ value. If various routes satisfy 
this condition, the alternative route is selected based on unitary costs, i.e. the route 
which presents the lowest value of the quotient of the transportation cost difference 
(compared with the cheapest route) and its ρ value. This quotient is considered as 
the unitary (marginal) cost of risk reduction, denoted by cρ. 
For each case analysed, two departure dates were defined: 1 January and 1 July. 
Information on the services provided by different shipping companies was used to 
determine the travel time from the port of origin to the port of destination. With this 
information, arrival dates were obtained. On the other hand, maps of routes between 
ports are available at Lekkas (2007), which provided the length and marked points 
that define the routes. The transportation costs of the routes were quoted in US 
dollars with different shipping and freight forwarding companies, based on a port￾to-port service of a 20-foot dry van container, full of bottled wine (FCL).12 M. Garafulic and A. F. Mac Cawley
Finally, various values of the weights ωi, i = 1, 2, 3 of Eq. 5 were used to 
calculate ρ for the routes of the second case in July, to show how risk assessment 
of routes and the choice of alternative routes depend on the importance assigned to 
each indicator. 
4 Results 
In this section, the results obtained are presented. Firstly, the correlations obtained 
between the internal and external temperatures and the results of the fitted model 
are shown. Secondly, the validation of the model and the obtained forecast error 
measures are presented. The last part presents the results of the application cases. 
4.1 Correlations and Fitted Model 
A total of 167 correlations between internal temperature values and their respective 
external temperature values were calculated. Each correlation value was calculated 
based on a specific thermograph, as noted in Sect. 3.1. Some statistical measures 
of the correlations obtained are shown in Table 2. Approximately 50% of the 
correlations obtained are higher than 81.4%, while 25% are higher than 88.8%. The 
results indicate a moderate and a strong linear relationship between these variables 
(Ratner, 2009). As an example, a graph of the internal and external temperatures 
related to a single thermograph is presented in Fig. 3. 
In this case, the correlation value is 88.9%. As pointed out in Sect. 3.3, to fit the 
model, the training data were obtained from 65 of the 74 trips. The results of the 
fitted model are presented in Table 3. The internal temperature was considered up to 
the fifth lag (K = 5 in Eq. 1). The value obtained by R2 indicates that the variation 
of yt is explained up to 95.14% due to the variability of the explanatory variables. In 
contrast, the high value of the F statistic indicates a significant relationship between 
the response and the explanatory variables. An interpretation of the estimator values 
is provided in the next section. As mentioned in Sect. 3.3, a forward method was 
used to add variables to the model. Firstly, the model in Eq. 1 was fitted, considering 
only the external temperature as a regression variable. Then, the lags of internal 
Table 2 Statistical measures 
of obtained correlations 
Indicator Value 
Min. 0.601 
Mean 0.802 
Median 0.814 
Upper quartile 0.888 
Max. 0.960Analyzing Wine Shipping Route 13
Fig. 3 Example: external and internal temperatures related to a single thermograph 
Table 3 Model results 
Variable Estimator SE t value p value CI inf (95%) CI sup (95%) 
Intercept (α0) 0.0252 0.0382 0.6604 0.5090 −0.0497 0.1002 
xt (α1) 0.0348 0.0027 12.9842 0 0.0296 0.0401 
yt−1 (β1) 0.6980 0.0066 106.4369 0 0.6852 0.7109 
yt−2 (β2) −0.0296 0.0067 −4.4165 0 −0.0428 −0.0165 
yt−3 (β3) 0.1154 0.0067 17.2883 0 0.1023 0.1284 
yt−4 (β4) 0.6445 0.0068 95.0867 0 0.6312 0.6578 
yt−5 (β5) −0.4643 0.0065 −71.6325 0 −0.4770 −0.4516 
R2 0.9514 
Adjusted R2 0.9514 
RSE (σˆ ) 1.3152 
Observations (N) 19,097 
F statistic 62,318.9430 (p value = 0) 
temperature were added until the increase in the value of R2 was insignificant. The 
last significant increase in R2 occurred when the fifth lag (K = 5) was added. 
Figure 4 shows the increase in the value of R2 and the decrease in the value of the 
mean of squared error (MSE) of these models. 
4.2 Model Validation 
As mentioned in Sect. 3.3, the model was tested on nine trips (2294 points). The 
two indicators used to determine the quality of the forecast of the fitted model were 
MAD and RMSE. The results obtained for the accuracy of forecasts on each trip 
and the global data (considering large vectors that link all the values of current 
temperatures and forecast) are presented in Table 4. The obtained values of RMSE14 M. Garafulic and A. F. Mac Cawley
1.00 
0.95 
0.90 
0.85 
0.80 
0.75 
0.70 
0.65 
0.60 
0.55 
0.50 
0 1 2 3 4 5 6 
0.936596 
0.951425 0.953108 
0.0 
1.5 
3.0 
4.5 
6.0 
7.5 
9.0 
10.5 
12.0 
13.5 
15.0 
0 1 2 3 4 5 6 
2.2534 
1.7298 1.6707 
a 
b 
Value of R2 
Value of MSE 
7 8 
78 
Fig. 4 R2 and MSE v/s lags of internal temperature in models (lags of yt on horizontal axis) 
Table 4 RMSE and MAD 
for forecast using test data Trip RMSE (◦C) MAD (◦C) 
1 2.472 1.012 
2 2.674 0.725 
3 0.069 0.198 
4 3.090 0.966 
5 0.780 0.527 
6 0.218 0.318 
7 0.236 0.357 
8 1.940 0.991 
9 2.142 0.836 
Global 1.425 0.805Analyzing Wine Shipping Route 15
are in a low–normal range, compared with those that have been obtained in research 
in which the temperature is predicted (Laanaya et al., 2017; Gómez et al., 2014). In 
the study by Laanaya et al. (2017), quoted in Sect. 2 , values ranging from 1.29 ◦C to 
2.26 ◦C were obtained by the regression model, while its global value was 1.83 ◦C. 
The best performance model had a global value of 1.44 ◦C, higher than the global 
RMSE obtained by the model in this study. The performance of other meteorological 
models has been measured with RMSE. Gómez et al. (2014) obtained values 
ranging from 2 ◦C to 4 ◦C for hourly forecast temperatures of the RAMS model, 
in 72-hour periods. The RMSE values varied according to day or night, different 
seasons of the year, and the geographic location of meteorological stations (inland 
or coastal) within the Valencia region (Spain). The authors concluded that the 
RAMS performance was good in spring and summer for coastal stations and in 
fall and winter for inland ones, with RMSE ranging from 2 ◦C to 3 ◦C and 2 ◦C 
to 4 ◦C, respectively. The RMSE values per trip obtained in this study are low– 
normal compared with this range, and the global result is significantly smaller. On 
the other hand, the quality of the forecast is such that, the mean absolute deviation 
of 1.012 ◦C was not exceeded for any trip. The global result of MAD was 0.805 ◦C. 
These results indicate that, on average, the forecast errors are less than 1 ◦C. As an 
example, Fig. 5 presents the forecast and actual temperatures recorded for trip 4 and 
the corresponding tracking signal. 
4.3 Decision-Making 
The results are shown in the first two parts of this section. The aim was to indicate 
which route is the most convenient to use in terms of risk and cost, according to the 
criterion defined in Sect. 3.4. The numeration and shape of the routes under study 
are shown in Figs. 6 and 8, for each case, respectively. The case results are shown in 
Tables 5 and 6. Each table presents, for each route, the values of Av, τ , σ, ρ (with 
ωi = 1/3, i = 1, 2, 3) and the unitary costs of risk reduction cρ (USD/%) for each 
departure date and its transportation cost (USD). 
Furthermore, at the end of each case, heatmaps based on the internal temperature 
forecasts are presented in Figs. 7 and 9. 
Finally, case 2, in July, was used as an example to show how different indicator 
weight values in ρ equation affect the route risk assessment and the choice of 
alternative routes. This example is presented in the last part of this section. 
4.3.1 Case Study 1: Melbourne (AUS) to Oakland (USA) 
In this case, four routes from Melbourne (AUS) to Oakland (USA) were compared, 
with a 35-day window. The routes studied are shown in Fig. 6. In this case, the16 M. Garafulic and A. F. Mac Cawley
Fig. 5 Forecast and actual temperatures for trip 4 and tracking signal values 
cheapest route is route 4. The results for January and July are presented in Table 5, 
and the following can be noted: 
• Risk results: The values of the first two indicators increase in July for all routes, 
because most of their trajectory is in the northern hemisphere (summer season). 
In January, routes 3 and 4 are less risky than routes 1 and 2 in terms of Av. 
However, in terms of τ , the wine is exposed to temperatures above 25 ◦C for 2.1 
and 1.4 days, respectively. Lastly, route 1 has less variability than the others. In 
terms of τ , routes 1, 3, and 4 are riskier than route 2, as wine can be exposed 
to temperatures above 25 ◦C for 12.1, 4.7, and 4 days, respectively. On the other 
hand, variability results show that route 1 is the most variable. In this sense, the 
σ value increases only for this route, while it decreases for routes 2–4. Finally, 
according to the route risk index ρ, the route that presents the lowest risk is route 
2, for both months.Analyzing Wine Shipping Route 17
Fig. 6 Routes from Melbourne (AUS) to Oakland (USA) (Mercator projection). Source: QGIS 
2.18.15 
Table 5 Case 1: Results for indicators and unitary costs of risk reduction 
Month Indicator/route 1 2 3 4 
January Av (%) 54.914 36.672 27.167 28.124 
τ (days) 0.0 0.0 2.1 1.4 
σ (
◦C) 3.402 7.255 7.641 7.238 
ρ (%) 19.244 23.018 −17.391 – 
cρ (USD/%) 119.518 8.689 −11.50 – 
July Av 68.198 52.316 45.845 43.287 
τ 12.1 0.9 4.7 4.0 
σ 5.259 4.435 4.774 4.546 
ρ −91.077 19.947 −9.447 – 
cρ −48.311 10.027 −21.171 – 
Cost (USD) 4400 2300 2300 2100 
• Alternative route: Route 4 is the lowest cost, with a value of USD 2100. It 
should be the preferred route in any season based only on cost. If we look 
at other indices, the shipping time (ρ) indicates that only route 2 should also 
be considered, with an extra cost of only USD 200, for both months. If we 
observe the risk reduction, it reaches 23.018% and 19.947% for January and July, 
respectively, while the costs of risk reduction are USD 8.689 and 10.027 per unit 
of risk percentage for the same months. In this case, the unitary costs and the ρ
values of the alternative route are similar for both months. 
The heatmaps for January and July are shown in Fig. 7.18 M. Garafulic and A. F. Mac Cawley
Table 6 Case 2: Results for indicators and unitary costs of risk reduction 
Month Indicator/route 5 6 7 8 9 
January Av (%) 51.412 20.763 27.655 55.276 39.731 
τ (days) 0.0 0.0 0.0 0.0 0.0 
σ (
◦C) 3.532 5.481 5.955 3.034 4.163 
ρ (%) – 1.472 −7.470 2.193 1.612 
cρ (USD/%) – 271.739 −53.548 729.594 434.243 
July Av 80.849 45.348 47.521 28.924 15.116 
τ 18.8 0.2 0.0 2.4 0.4 
σ 5.269 3.867 3.980 4.375 5.036 
ρ – 56.253 55.230 56.210 61.270 
cρ – 7.111 7.242 28.465 11.425 
Cost (USD) 1900 2300 2300 3500 2600 
Fig. 7 Heatmaps of routes in case 1. Source: QGIS 2.18.15 
4.3.2 Case Study 2: Melbourne (AUS) to Miami (USA) 
This case compares five routes between the ports of Melbourne (AUS) and Miami 
(USA) with a 40-day time window. The routes are shown in Fig. 8. 
In this case, route 5 is the cheapest. The results for January and July can be seen 
in Table 6, and the following can be noted: 
• Risk results: The values of the first two indicators increase in July for the first 
three routes and decrease for the others because a significant part of the last two 
routes is in the southern hemisphere (winter in July). In January, routes 6 and 7 
are significantly less risky than the others in terms of Av. In terms of τ , there is 
no risk on any route. Lastly, route 8 has less variability than the others. In July, 
results for Av show that routes 8 and 9 are the least risky because it is summer 
in the northern hemisphere. Regarding τ , routes 6, 7, and 9 have no risk. Route 8Analyzing Wine Shipping Route 19
Fig. 8 Routes from Melbourne (AUS) to Miami (USA) (Mercator projection). Source: QGIS 
2.18.15 
indicates 2.4 days with temperatures over the 25 ◦C threshold, while route 5 is the 
most critical, with 18.8 days with temperatures over 25 ◦C. On the other hand, 
variability results show that route 5 is the most variable. In this case, σ value 
increases for routes 5, 8, and 9, while it decreases for routes 6 and 7. Finally, 
according to ρ, route 8 poses the lowest risk in January (with a value of 2.193%), 
while route 9 poses the lowest risk in July (with a value of 61.270%). 
• Alternative route: Route 5 is the cheapest, costing USD 1900. It should be the 
preferred route in any season based only on cost. Considering the indicators as 
equally important, the values of ρ indicate that the only alternative is route 6, with 
an extra cost of USD 400, for both months. The risk reduction reaches 1.472% 
and 56.253%, while the costs of risk reduction are USD 271.739 and 7.111 per 
unit of risk percentage, in January and July, respectively. In this case, there is a 
significant risk reduction with a low unitary cost in July, while a very low-risk 
reduction with a high unitary cost is observed in January. 
The corresponding heatmaps for January and July are shown in Fig. 9. 
4.3.3 Case Study 2: Route Risk Index Analysis 
The route risk assessment and the alternative routes of the case studies can change 
depending on the risk criteria, that is, the assigned relevance to each indicator, 
represented by changes in the indicator weights in ρ definition (Eq. 5). This is 
exemplified with case 2, in July. The analysis was carried out by varying in 0.0520 M. Garafulic and A. F. Mac Cawley
Fig. 9 Heatmaps of routes in case 2. Source: QGIS 2.18.15 
units the values of weights ω1, ω2, and ω3, ranging from 0 to 1, in lexicographical 
order, to generate a set of points o on the plane ω1 + ω2 + ω3 = 1. In this way, ρ
was calculated on each point according to 5, and the alternative routes were defined, 
considering their unitary costs of risk reduction. 
Figure 10 presents two colour maps for routes 6–9. In the first one, each colour 
indicates the least risky route on each point of o. Analogously, in the second, 
each colour indicates the most convenient route to use, instead of the cheapest, by 
considering the unitary costs of risk reduction. With regard to most criteria, route 9 
is the least risky, especially when Av is considered highly important. On the other 
hand, route 6 is the least risky when σ is considered important, while the same holds 
true for route seven and τ . Conversely, route eight is considered the least risky with 
a specific combination of ω1, ω2, and ω3. 
Considering the unitary costs of risk reduction, route 6 should be selected as the 
alternative route for most of the criteria, as it is better than routes 8 and 9, due to 
its low transportation cost (difference of USD 400 compared to the cheapest route) 
and, consequently, its unitary cost of risk reduction. For the same reason, route 7 
should be selected as an alternative instead of route 9, based on the high values of 
τ . Route 9 is selected only when Av is considered important. 
5 Discussion 
Results show a strong correlation between the temperature inside the containers and 
the outside temperature: a median of 81.4% and an upper quartile of 88.8% were 
obtained for the calculated correlations. This indicates that the outside temperatures 
have a significant effect on the inside temperatures in the case of dry van containers.Analyzing Wine Shipping Route 21
1.0 
0.8 
0.6 
0.4 
0.2 
0.0 
0.0 
0.2 
0.4 
0.6 
0.8 
1.0 1.0 
0.8 
0.6 
0.4 
0.2 
700 USD 0.0
1,600 USD 400 USD 
400 USD 
Least risky routes 
w3 
w3 
w2 
w1 
w2 
w1 
Route 6 
Route 7 
Route 8 
Route 9 
Route 6 
Route 7 
Route 8 
Route 9 
Least risky routes in case 2, July 
Alternative routes in case 2, July 
Alternative routes 
1.0 
0.8 
0.6 
0.4 
0.2 
0.0 
0.0 
0.2 
0.4 
0.6 
0.8 
1.0 1.0 
0.8 
0.6 
0.4 
0.2 
0.0 
400 USD 
400 USD 
700 USD 
a 
b 
Fig. 10 Colourmaps of least risky and alternative routes in case 2, July. Source: R 3.4.422 M. Garafulic and A. F. Mac Cawley
It should be noted that this effect is not perfect. Therefore, it is not sufficient to 
know the external temperatures along a route to quantify its risk. It is necessary to 
correctly model the effect of the outside temperature on the temperature inside the 
containers. 
Regarding the values of the estimators of the fitted model, it is necessary to 
discuss several aspects. It seems contradictory that the estimator value of α1 is only 
0.0348 because the correlation between the external and internal temperatures in 
all the trips was greater than 0.6. This is explained by the fact that the external 
temperature variable loses significance in the presence of internal temperature 
lags. On the other hand, high estimations of β1 (6-hour lag) and β4 (24-hour 
lag) were obtained. The first value (0.6980) could be explained by thermal inertia 
and the effect of the most recent temperature on the current temperature. The 
concept of thermal inertia was studied previously by Hartley (2001). Meanwhile, 
the significance of the internal temperature of the previous 24 hours (0.6445) can be 
explained by the fact that a good predictor of the next day’s temperature at time t is 
the current day’s temperature at the same time. On the other hand, the estimator of 
β2 is negative (−0.0296) and is explained by the “day–night” effect of the 12-hour 
lag temperature on the current temperature. However, the estimator values for β3
(18-hour lag) and β5 (30-hour lag) are not easily interpreted. 
Regarding model validation, it can be noticed that the model’s prediction quality 
is completely satisfactory, according to the values obtained for MAD and RMSE, 
as shown in Table 4. The results indicate a good forecast performance. MAD values 
are easily interpreted and, with a global value of 0.805 ◦C, are considered low for 
a forecast with a 6-hour frequency and over 2-week periods. The RMSE values are 
low–normal compared with previous research (Laanaya et al., 2017; Gómez et al., 
2014), as mentioned in Sect. 4.2, with a global value of 1.425 ◦C. 
With regard to the case study results, a seasonal behaviour of the proposed 
indicators is observed as expected. Those routes that are mostly in the northern 
hemisphere present higher values of their first two indicators during July, while they 
decrease in January, contrary to those that are mostly in the southern hemisphere, 
as shown in case 2 in Sect. 4.3.2. In case 1 in Sect. 4.3.1, the values of the first two 
indicators increase for all routes in July. With regard to σ, the reasons that explain 
its seasonal behaviour are not clear. However, it can be noted that the value of σ
decreases as the routes move closer to the North Pole in July (routes 2 to 4 in case 
1, and routes 6 and 7 in case 2). As a result of the indicators’ seasonal behaviour, 
in terms of the route risk index ρ (with equal importance for all the indicators), the 
results of the case studies indicate that, in general, there is no least risk route at any 
time of the year. As case 2 shows, route 8 is the least risky in January, while route 9 
is the least risky in July. On the other hand, the cheapest route can be riskier for wine 
quality than some of the more expensive routes, as noted in both cases. Moreover, 
in case 2, in July, the cheapest route is always riskier than the others, based on any 
criterion analysed in Sect. 4.3.3. In this section, as shown in the first colourmap of 
Fig. 10, it is noted how the risk assessment depends on the risk criteria, and any route 
could be the least risky one. On the other hand, the second colourmap shows how 
the transportation costs along routes become a determining factor for the choice ofAnalyzing Wine Shipping Route 23
alternative routes: routes 6 and 7 (at USD 400) are preferred, instead of routes 8 and 
9 (at USD 1600 and 700, respectively) on the points where the latter are considered 
the least risky routes. In this sense, the variation of ρ for each route according to 
various risk criteria is insufficient to balance the difference in transportation costs: 
routes 6 and 7 are more similar to routes 8 and 9, based on risk instead of costs. 
6 Conclusion 
It is necessary to improve maritime transport decisions within the international 
supply chain while considering the risk to wine quality due to transport temper￾atures. Currently, these decisions are based only on the transportation cost of the 
routes, with preference given to the minimum cost route between ports of origin and 
destination, and no consideration for the risk to wine quality. 
With the objective of supporting the current transport decision-making, the 
correlation between internal and external temperatures has been studied for the first 
time within the transport sector, and a simple auto-regressive model of six variables 
has been fitted. This model allows the forecast of the temperature inside standard 
shipping containers (dry van) along any maritime route in the world, during any 
time of the year, and assigns risk indicators to each route. To achieve this, the data 
of temperatures inside containers were obtained from the database by Mac Cawley 
(2014). Subsequently, the corresponding external temperature values were assigned, 
based on the data provided by Kalnay et al. (1996). In this way, the correlation study 
and the model fitting were carried out. Once the model was validated according to 
the values of MAD and RMSE, it was used to calculate three proposed indicators 
for wine quality along various routes in two case studies, based on the predicted 
temperatures and the Arrhenius equation. In both cases, the routes were studied 
according to their indicator values and costs, to determine which route could be 
used instead of the cheapest route. 
The results obtained indicate a moderate to strong linear relationship (Ratner, 
2009) between the internal and external temperatures, reaching correlation values 
of over 60.1%, with a mean of 80.2%. On the other hand, the fitted model presents 
a great forecast performance, according to the obtained values of MAD and RMSE, 
with global values of 0.805 ◦C and 1.425 ◦C, respectively. Due to the good model 
accuracy, the proposed indicators can be estimated with high confidence for various 
maritime routes. 
The results of the case studies indicate that the cheapest routes can be riskier 
than some of the more expensive routes. It is possible to significantly decrease the 
risk to wine quality by using alternative routes. There is a strong seasonal behaviour 
among the indicators. Thus, considering the seasonal factor in the route risks, there 
may not be the least risky route at any time of the year. Furthermore, the route risk 
assessment depends on the criteria, that is, the importance assigned to each indicator.24 M. Garafulic and A. F. Mac Cawley
Future efforts should focus on the origin, by improving the data capture. The 
main limitations of this work are related to this issue. Firstly, with regard to the 
internal temperature measurements, although each measurement time was known, 
the geographical position of the ships had to be interpolated. Secondly, considering 
the interpolated position as the actual one, the corresponding external temperature 
value was assigned by determining the closest point and time in the NCEP-NCAR 
point mesh to the interpolated point. Consequently, the external temperature values 
assigned were not exact. On the other hand, the containers’ positions on the ships 
were not registered. Therefore, this was not considered a variable in the fitted model. 
Containers exposed directly to the sunshine can have a different internal temperature 
from those that are surrounded by other containers. If it is possible to register 
the internal and external temperatures along maritime trips, and other variables 
as the containers’ positions, the inaccuracies will be minimized, and a more 
accurate model can be developed. Future approaches can focus on documenting 
the temperatures inside trucks and the arrival status and quality of the merchandise 
on various trips; this can allow us to determine how much the winery or importer 
could be willing to pay for better temperatures during the shipment of the wines. 
This research can affect the shipping decision-making process of wineries, 
freight forwarders, and shipping companies. As a customer, a winery can assess the 
risk of the routes offered by shipping companies and freight forwarders and improve 
transport decision-making. As a supplier, a freight forwarder or a shipping company 
can offer better services by offering the customer a set of routes with various risks 
to wine quality. 
Acknowledgments Alejandro F. Mac Cawley acknowledges financial support from FONDECYT 
Iniciacion Project # 11180502. Finally, we offer special thanks to Professor John Bartholdi III, who 
is no longer with us, for his help and guidance in this work and the Wine Supply Chain Council. 
Appendix: Interpolation Algorithm Explanation 
The algorithm is described as follows. Consider the representation of φ for longitude 
and λ for latitude. The following input is considered, given a device with M
measurements during a trip, associated with: 
• a maritime route with length d, marked with N points defined as p1 =
(φ1, λ1), ..., pn = (φN , λN ), where point p1 corresponds to the port of origin 
and pN to the port of destination, 
• time of beginning and end of the trip ti, tf , respectively, and 
• time t1, ..., tM of temperature measurements, ordered chronologically.Analyzing Wine Shipping Route 25
The purpose is to determine the approximate position of the ship at each measure￾ment time tm, m = 1, ..., M. The positions to be determined are defined as points 
qm = (φm, λm), m = 1, ..., M. The two stages of the algorithm are as follows: 
1. Stage 1: 
1.1 Calculation of the distances between pairs of continuous points pn and pn−1
along the route, defined as d¯
n, n = 1, ..., N, with d¯
1 = 0. 
1.2 Calculation of accumulated distance to each point marked along the route, 
defined as D¯ n = En
k=1 d¯
k, n = 1, ..., N. 
1.3 Calculation of the ship speed, as v = d/ (
tf − ti
)
. 
The second stage is executed for each searched point qm = (φm, λm), m =
1, ..., M: 
2. Stage 2: 
2.1 Calculation of the distance travelled up to the time of measurement tm, 
defined as dm = (tm − ti) · v. 
2.2 Given the distance travelled until each measurement time m, the pair of 
marked points along the route between which the ship was located is 
determined. If D¯ n ≤ dm ≤ D¯ n+1, then the ship was between the marked 
points pn and pn+1, and pn is defined as the lower extreme point and pn+1 as 
the upper extreme point associated with qm. If the same condition holds true 
for the previous searched measurement point, that is, D¯ n ≤ dm−1 ≤ D¯ n+1, 
m ≥ 2, then it is convenient to define the lower extreme point as qm−1, which 
is closer to qm. The lower and extreme upper points are denoted as en(m) and 
En(m), respectively. The extreme points are the points between which the 
ship was, approximately, at time tm, following the direction from the lower 
to the upper point. 
2.3 The latitude λm and longitude φm of the searched point qm is initialized as 
the values of the coordinates of the lower extreme point, that is, λm = λn(m)
and φm = φn(m). 
2.4 Calculation of the distance between the measurement point and the lower 
extreme point, defined as d2
m = dm − D¯ n(m). 
2.5 The longitude of the searched point is increased by a small angle Aφ: 
φm ← φm +Aφ. This angle can be positive or negative. If the lower extreme 
point’s longitude is less than the upper point’s, then a positive Aφ is selected. 
Otherwise, a negative value is selected. This allows considering the direction 
followed by the ship between the extreme points. 
2.6 Calculation of the new point latitude λm ←, assuming that the point is on the 
orthodrome between the extreme points. The orthodrome equation is used. 
2.7 Calculation of the distance between the obtained point qm = (φm, λm) and 
the point en(m), defined as d3
m, using orthodromic distances. 
2.8 If the orthodromic distance d3
m is similar to d2
m, that is, if |
|d3
m − d2
m
|
| < e, 
then the position of the ship at the time of measurement is determined and the 
algorithm returns the point coordinates (a point on the orthodrome between26 M. Garafulic and A. F. Mac Cawley
extreme points, whose distance is very similar to d2
m, was determined). e is 
the error allowed. If not, it is necessary to return to point 2.4, add a new 
longitudinal increase Aφ, and execute steps 2.6, 2.7, and 2.8. 
References 
Aven, T. (2012). The risk concept—historical and recent development trends. Reliability Engineer￾ing & System Safety, 99, 33–44. 
Benítez, P., Castro, R., & García Barroso, C. (2003). Changes in the polyphenolic and volatile 
contents of “fino” sherry wine exposed to ultraviolet and visible radiation during storage. 
Journal of Agricultural and Food Chemistry, 51(22), 6482–6487. 
Bilgili, M. (2010). Prediction of soil temperature using regression and artificial neural network 
models. Meteorology and Atmospheric Physics, 110(1), 59–70. 
Butzke, C. E., Vogt, E. E., & ChacóRodríguez, L. (2012). Effects of heat exposure on wine quality 
during transport and storage. Journal of Wine Research, 23(1), 15–25. 
Chung, H.-J., et al. (2008). Effect of vibration and storage on some physico-chemical properties of 
a commercial red wine. Journal of Food Composition and Analysis, 21(8), 655–659. 
Converti, A., Bargaglioti, C., Cavanna, C., Nicolella, C., & Borghi, M. D. (1996). Evaluation of 
kinetic parameters and thermodynamic quantities of starch hydrolysate alcohol fermentation 
by saccharomyces cerevisiae. Bioprocess Engineering, 15(2), 63–69. 
Cullinane, K., & Toy, N. (2000). Identifying influential attributes in freight route/mode choice 
decisions: A content analysis. Transportation Research Part E: Logistics and Transportation 
Review, 36(1), 41–53. 
Douligeris, C., Iakovou, E., & Yudhbir, L. (1997). Maritime route risk analysis for hazardous 
materials transportation. IFAC Proceedings Volumes, 30(8), 563–568. 
Gómez, I., Caselles, V., & Estrela, M. (2014). Real-time weather forecasting in the Western 
Mediterranean Basin: An application of the RAMS model. Atmospheric Research, 139, 71– 
89. 
Goerlandt, F., & Montewka, J. (2015). Maritime transportation risk analysis: Review and analysis 
in light of some foundational issues. Reliability Engineering & System Safety, 138, 115–134. 
Hartley, A. (2001). Final report: Monitoring of wine heat exposure during commercial shipments. 
Journal of Wine Research, 23(1), 15–25. 
Hartmann, H., et al. (2016). Seasonal predictions of precipitation in the Aksu-Tarim River basin 
for improved water resources management. Global and Planetary Change, 147, 86–96. 
Hasnip, S., et al. (2004). Effects of storage time and temperature on the concentration of ethyl 
carbamate and its precursors in wine. Food Additives & Contaminants, 21(12), 1155–1161. 
Hyndman, R. J., & Athanasopoulos, G. (2014). Forecasting: Principles and practice. OTexts.com. 
Iakovou, E. T. (2001). An interactive multiobjective model for the strategic maritime transportation 
of petroleum products: Risk analysis and routing. Safety Science, 39(1), 19–29. 
Jadin, E. A., et al. (2010). Stratospheric wave activity and the pacific decadal oscillation. Journal 
of Atmospheric and Solar-Terrestrial Physics, 72(16), 1163–1170. 
Ji, C., et al. (2018). On the relationship between the early spring Indian Ocean’s sea surface 
temperature (SST) and the Tibetan Plateau atmospheric heat source in summer. Global and 
Planetary Change, 164, 1–10. 
Kalnay, E., et al. (1996). The NCEP/NCAR 40-year reanalysis project. Bulletin of the American 
Metereological Society, 77, 437–470. 
Laanaya, F., St-Hilaire, A., & Gloaguen, E. (2017). Water temperature modelling: Comparison 
between the generalized additive model, logistic, residuals regression and linear regression 
models. Hydrological Sciences Journal, 62(7), 1078–1093.Analyzing Wine Shipping Route 27
Lam, H., et al. (2013). A real-time risk control and monitoring system for incident handling in 
wine storage. Expert Systems with Applications, 40(9), 3665–3678. 
Lekkas, D. (2007). Marinetraffic. https://www.marinetraffic.com/es/voyage-planner. Accessed 11 
Aug 2017. 
Mac Cawley, A. (2014). The international wine supply chain: Challenges from bottling to the glass. 
PhD thesis, School of Industrial and Systems Engineering. Georgia Institute of Technology. 
Marquez, L., et al. (2012). Cool or hot: A study of container temperatures in Australian wine 
shipments. Australasian Journal of Regional Studies, 18, 420–443. 
Meyer, D. (2002). Final report: A study of the impact of shipping/transportation conditions and 
practices on wine. Report 1.3.1/702.0001, Technology Exploitation Centre. 
OIV. (2018). State of the vitiviniculture world market. Technical report, Organisation Interna￾tionale de la Vigne et du Vin. 
Ough, C. (1992). Winemaking basics. The Haworth Press. 
Ozbas, B. (2013). Safety risk analysis of maritime transportation: Review of the literature. 
Transportation Research Record, 2326(1), 32–38. 
Parker, R. (2008). Parker’s wine buyer’s Guide: The complete, easy-to-use reference on recent 
vintages, prices, and ratings for more than 8,000 wines from all the major wine regions. Simon 
and Schuster. 
Pérez-Coello, M., et al. (2003). Influence of storage temperature on the volatile compounds of 
young white wines. Food Control, 14(5), 301–306. 
Ratner, B. (2009). The correlation coefficient: Its values range between +1/−1, or do they? Journal 
of Targeting, Measurement and Analysis for Marketing, 17(2), 139–142. 
Recamales, A., et al. (2006). The effect of time and storage conditions on the phenolic composition 
and colour of white wine. Food Research International, 39(2), 220–229. 
Sahoo, G., Schladow, S., & Reuter, J. (2009). Forecasting stream water temperature using 
regression analysis, artificial neural network, and chaotic non-linear dynamic models. Journal 
of Hydrology, 378(3), 325–342. 
Sivertsen, H., et al. (2001). Sensory and chemical changes in Chilean Cabernet Sauvignon 
wines during storage in bottles at different temperatures. Journal of the Science of Food and 
Agriculture, 81(15), 1561–1572. 
Varikoden, H., Ramesh Kumar, M. R., & Babu, C. A. (2014). Indian summer monsoon rainfall 
characteristics during contrasting monsoon years. Pure and Applied Geophysics, 171(7), 1461– 
1472. 
Wickramasekera, R., & Bianchi, C. C. (2013). Management characteristics and the decision to 
internationalize: Exploration of exporters vs. non-exporters within the Chilean wine industry. 
Journal of Wine Research, 24(3), 195–209. 
Yang, G., Li, C.-Y., & Tan, Y.-K. (2016). The interdecadal variation of the intensity of the south 
Asian high. Journal of Tropical Meteorology, 22(1), 19–29. 
Zhang, L., Zhi, X., & Yang, H. (2011). The relationship between the cold surge over the NSCS 
& the ENSO events. In International Conference on Information Science and Technology (pp. 
126–131).Model for Estimating the Demand for 
Soybean Railway Transport in Brazil’s 
Logistic Corridors Under Competitive 
Conditions 
Thiago Guilherme Péra, Abner Matheus João, and José Vicente Caixeta Filho 
1 Introduction 
In 2019, Brazil produced 235.5 million tons of grains, having soybean and corn 
represent 91.33% of the total (Companhia Nacional de Abastecimento, 2019). Mato 
Grosso’s state (MT) is the largest producer of grains in Brazil, accounting for 33.19 
million soybean tons and 31.24 million corn tons in the same year. 
Brazil cargo transportation matrix is heavily reliant on truck transportation 
because the railway line is not enough for attending all Brazilian demand. In MT, 
most of the state production is transported using trucks because there is only one 
transhipment terminal for MT, located in the municipality of Rondonópolis, that 
connects to the Santos Port (“Rumo Malha Norte”—RMN). In 2019, 15.05 million 
tons of grains were transported through RMN from Rondonópolis (MT) (Agência 
nacional de Transportes Terrestres, 2020). 
Other projected railway solutions are being considered: (i) “Ferrogrão” railway 
located in the municipality of Sinop (MT) that aims to connect the state of MT to 
the Miritituba port, in Itaituba (PA); (ii) RMN expansion to Cuiabá (MT); (iii) RMN 
expansion to Nova Mutum (MT); (iv) RMN expansion to Lucas do Rio Verde (MT); 
and (v) “Ferrovia Paraense,” connecting Lucas do Rio Verde (MT) to Barcarena 
(PA) port. The solutions involving the expansion of RMN by the operator of the 
railway, RUMO S/A, and the Ferrogrão project that is led by Brazilian government 
which plans launching the bid for the construction and operation of the line until the 
end of 2020 are the most speculated projects. 
T. G. Péra () · J. V. C. Filho 
“Luiz de Queiroz” College of Agriculture, University of São Paulo, Piracicaba, SP, Brazil 
e-mail: thiago.pera@usp.br 
A. M. João 
Polytechnic School, University of São Paulo, São Paulo, SP, Brazil 
© Springer Nature Switzerland AG 2024 
V. M. Albornoz et al. (eds.), Optimization Under Uncertainty in Sustainable 
Agriculture and Agrifood Industry, https://doi.org/10.1007/978-3-031-49740-7_2
2930 T. G. Péra et al.
In Brazil, freight prices are determined by free negotiation between the carriers 
and the export companies, cooperatives, or producers, and the most common hiring 
model is on the sport market, which can vary along the year, because it is liable to 
many factors. As the Brazilian rail line is not big enough, the railway freight prices 
are determined by a discount over the roadway freight prices; in that way the prices 
for rail transportation also can vary during the year, and the discount can vary to 
adjust itself to the demand for the usage of the railway (Branco et al., 2011). 
This paper aims to present a comparative analysis between the actual and 
projected railway solutions for Mato Grosso’s state grain exportation market, 
considering the demand calculation for each railway and the impact on total cost 
reduction in order to define the best investment option for the public and private 
actors. 
2 Methods 
For the evaluation of the demand of the multimodal corridors, the method was 
structured by evolving six steps. In the first step, it was utilized the soybean and corn 
production database for the 141 municipalities located in MT (Instituto Brasileiro 
de Geografia e Estatística, 2018). The second step consisted on the construction 
of a matrix for the possibilities of transportation for every municipality considered 
before to the existent corridors: strictly roadway transport to the ports of Rio Grande 
(RS), São Francisco do Sul (SC), Imbituba (SC), Paranaguá (PR), São Luís (MA), 
Santos (SP) and Porto Velho (RO) and then rail transhipment terminals in Porto 
Nacional (TO) and Palmeirante (TO) connecting to São Luís (MA) port, Uberaba 
(MG) and Araguari (MG) connecting to Vitória (ES) port and Rondonópolis (MT) 
connecting to Santos (SP) port. For the planned corridors, it was considered the 
RMN expansions listed previously, Ferrogrão railway, Paraense railway, FIOL 
railway and FICO railway. 
Step 3 is related to the roadway, railway and waterway freight prices for 
the matrix. For that step it was utilized the distance information of TransCAD 
system (TransCAD Transportation Planning Software, 2020), and freight prices 
were estimated from the Freight Information System (SIFRECA) database (Group 
of Research and Extension in Agroindustrial Logistics, 2019) using econometric 
models of freight estimation (Branco et al., 2011). For origin to transhipment 
terminal situations (OT), the estimation method is present on Eq. (1), 
ln 
F reightit 
= a + b ∗ ln (distanceit)
F reightit = ea ∗ distanceb
it (1)Model for Estimating the Demand for Soybean Railway Transport in Brazil’s... 31
and Eq. (2) presents the estimation method for origin to ports (directly) situation 
(OD). 
ODij = a + distanceij (2) 
The railway freight scenarios were calculated by roadway freight discounts 
(Branco et al., 2011). In the fourth step, a minimum cost algorithm was built with 
the objective to allocate the transportation flows since capacity restrictions were not 
included in this study. In this situation, for every municipality i, it was calculated 
the OTit and ODij for terminals t and ports j, and then Eq. (3) presents the logical 
choice in the algorithm; all the production of i is transported to j, where OTDitj is 
the total intermodal solution, Eq. (4), and K is the selected corridor. 
selk = argminj

OTDitj ; ODij 
, ∀i (3) 
OTDitj = OT it + (1 − discount) ∗ ODtj (4) 
Step 5 is the analysis of the results of the previous step for the estimative of the 
total cargo demand of every interest corridor k as shown in Eq. (5). 
Demandk = 
141
i
grainproduct ioni ∗ ksel, ∀k (5) 
In the last step, simulations were performed by varying freely the rail discount 
over roadway freight prices in order to evaluate demand gains or losses. 
3 Results 
Table 1 presents the results of the coefficients for roadway freight prices for both 
segregations exposed in the previous section. 
Figure 1 presents the amount of cargo of the two products considered that 
are captured by the existent terminal in Rondonópolis and the projects: RMN 
expansion to Lucas do Rio Verde; Paraense Railway; and Ferrogrão railway, with 
all options existing and operating simultaneously. The potential demand is bigger 
Table 1 Results of freight 
analysis 
Coefficients OD OT 
a 40.711 0.478218 
b 0.092473 0.64992 
R-squared 0.834 0.728 
p-value <0.01 <0.0132 T. G. Péra et al.
Fig. 1 Railway demand for each discount 
Fig. 2 Railway demand and average cost for each discount 
for Ferrogrão, followed by Rondonópolis solution. Considering that the medium 
observed discount for railway freight prices in Brazil stands between 31% and 
42% (Branco et al., 2011), Ferrogrão’s demand would stand between 14.06 mi tons 
(30% discount) and 18.51 mi tons (40% discount). Rondonópolis would vary among 
7.63 mi tons and 8.7 mi (below the current volume), and Paraense solution wouldn’t 
be representative with less than 0.16 mi tons captured. 
Figure 2 extrapolates the scenario where all the railways are operative in the same 
time in order to understand the impact on total logistic exportation cost for MT. If 
there is no discount for railway transportation, the average cost is R$ 178.36/t, and 
in a hypothetic view, with 50% discount, the cost is 15.96% lower. 
In that way, taken into analysis the actual solutions presented on the Methods 
section (30% railway discount) and varying the discount for Ferrogrão facing RMN 
expansions, it was possible to understand which would be the best solution by the 
reduction of exportation cost for MT grain producers. For that sort of analysis, the 
discount for Ferrogrão and the chosen RMN expansion were freely varied betweenModel for Estimating the Demand for Soybean Railway Transport in Brazil’s... 33
Fig. 3 Total exportation cost for each discount for Ferrogrão and RMN expansion (R$ billion) 
20% and 50%, and the matrix of MT state soybean and corn exportation cost is 
presented in Fig. 3. 
Considering the discount for Ferrogrão in 30% and the expansion to Cuiabá in 
30%, the logistic cost is R$ 13.412 billion; if Cuiabá discount increases 5%, the cost 
decreases by 1.29%; if Ferrogrão discount changes to 35%, the cost is decreased by 
1.54%. In the same analysis for Nova Mutum, the cost is decreased by 1.36% with 
the variation in RMN discount and the change is lower by 1.45% for Ferrogrão. 
For Lucas do Rio Verde, the difference is larger, 0.54% for RMN and 1.73% for 
Ferrogrão.34 T. G. Péra et al.
4 Conclusions and Contributions 
According to the results presented, any addition to Brazilian rail line would present 
a good impact on demand capturing for the rail controller and would improve the 
delivery of the Brazilian commodities to the ports and therefore to the consumers 
overseas. Furthermore, in a market where there are many actors competing for 
delivering the service of transportation, a minimal reduction in the price of freight, 
which is a cost as most of the logistics operations, by creating a gain in railway 
operations (increasing the discount over freight prices) can change the matrix of 
cargo demand, switching from road to rail transportation, leading to an increase on 
volume by rail lines, reducing the total cost for exportation in MT. 
Additionally, in a microeconomic perspective, an addition to the exportation 
corridors in MT would be followed by a shift on transportation supply curve, which, 
in a ceteris paribus condition, would lead a change on equilibrium freight prices to 
a new market clearing price, which can also be explained by a higher discount over 
road transportation prices for rail. 
About the investment choice based on cost reduction, Ferrogrão investment is 
the one which would cooperate better with the exporters in MT; the potential for 
reduction on total costs using this railway is bigger in the scenario where this railway 
is established in Lucas do Rio Verde (MT), facing a single terminal expansion in 
RMN, when all the actual solutions are considered with market discounts. 
Acknowledgments The authors would like to thank the “Group of Research and Extension in 
Agroindustrial Logistics – ESALQ-LOG” and FEALQ for the financial support. 
References 
Agência nacional de Transportes Terrestres. (2020). “Anuário Estatístico”, 2020. Retrieved 
February 27, 2020, from <http://www.antt.gov.br/ferrovias/arquivos/Anuario_Estatistico.html> 
Branco, J., Caixeta-Filho, J., Gameiro, A., Xavier, C., Paes, W., & La Cruz, B. (2011). Otimização 
Logística para o Transporte Multimodal de Safras Agrícolas pelo Corredor Centro-Norte: o que 
pensam as empresas e instituições envolvidas? Revista Amazônia: CI & Desemv, 6(12). 
Companhia Nacional de Abastecimento. (2019). “Boletim Grãos Dezembro 2019”. Retrieved 
February 27, 2020, from <https://www.conab.gov.br/info-agro/safras/graos> 
Group of Research and Extension in Agroindustrial Logistics - ESALQ-LOG, “Freight Informa￾tion System”, 2019. Retrieved February 15, 2020, from <https://esalqlog.esalq.usp.br/en/> 
Instituto Brasileiro de Geografia e Estatística. (2018). Produção Agrícola Municipal – 
2018. Retrieved February 17, 2020, from <https://www.ibge.gov.br/estatisticas/ 
economicas/agricultura-e-pecuaria/9117-producao-agricola-municipal-culturas-temporarias-e￾permanentes.html> 
TransCAD Transportation Planning Software, Caliper. Retrieved February 17, 2020, from <https:/ 
/www.caliper.com/tcovu.htm>Implementing a Decision Support System 
for Plant Variety Testing in the Czech 
Republic 
David Hampel, Martin Tláskal, and Jitka Janová 
1 Introduction 
The sustainability of global growth is dependent on many factors; one of the most 
important is ensuring food production for an ever-increasing population. One way of 
meeting this objective is through intensive breeding of new crop varieties, together 
with testing of their performance characteristics. 
Successful breeding results in so-called variety registration as a prerequisite for 
the release of propagating material of varieties of economically important agricul￾tural and vegetable species. For growers and other users of varieties, registration not 
only guarantees the utility value of the variety and the corresponding quality of the 
propagating material, but it also guarantees the protection of human, animal, plant 
and environmental health. 
The process of registering a new variety is based on conducting field experiments 
that need to be planned to be statistically evaluable. The outputs of the statistical 
analysis serve both as a basis for the registration of the variety by crop experts and 
as information about the variety to the general agricultural public. This information 
is also of considerable importance to processors of agricultural products. 
The Central Institute for Supervising and Testing in Agriculture is an organisa￾tional unit of the Czech Republic, whose main activity is public administration. The 
institute, through a mandate from the Ministry of Agriculture of the Czech Republic, 
performs professional activities shaping agricultural policy in the Czech Republic; 
is the competent authority issuing, inter alia; permits for the import of propagating 
material; as well as permits for putting seeds of officially unregistered varieties into 
circulation. In addition, it registers fertilisers, grants protection rights for varieties 
D. Hampel () · M. Tláskal · J. Janová 
Department of Statistics and Operation Analysis, Mendel University in Brno, Brno, 
Czech Republic 
e-mail: qqhampel@mendelu.cz; martin.tlaskal@ukzuz.cz; janova@mendelu.cz 
© Springer Nature Switzerland AG 2024 
V. M. Albornoz et al. (eds.), Optimization Under Uncertainty in Sustainable 
Agriculture and Agrifood Industry, https://doi.org/10.1007/978-3-031-49740-7_3
3536 D. Hampel et al.
and performs official controls in the field of organic farming in accordance with the 
Common European Agricultural Policy. 
The basis for the performance of the above-mentioned professional activities 
is mainly the statistical processing of extensive data sets originating from variety 
testing. Therefore, it is possible to state that the subject of the project is, in a 
broader sense, the creation of a system to support decision-making in the field of 
agricultural policy of the Czech Republic, which is performed at the National Plant 
Variety Office of the Central Institute for Supervising and Testing in Agriculture. 
High-quality and rapid data evaluation and interpretation of results are crucial for 
the formulation of correct decisions and their subsequent implementation in the field 
of agricultural policy in the Czech Republic. 
The speed of data processing and the quality of the initial statistical outputs are 
essential for a correct final decision on variety registration. In the framework of the 
project TD010128 supported by the Technology Agency of the Czech Republic, 
a comprehensive decision support system in the field of variety testing called 
Statspro was designed and implemented, including tools for planning experiments, 
evaluation of a single experiment and an experimental series. This system ensures 
continuous and precise processing of data from variety trials through a high-quality 
modern software solution using the latest knowledge of statistical experiment 
planning and data processing methodology. 
2 The Role of Design Planning in Field Trials 
In field experimentation and variety trials, single factorial trials are often arranged in 
complete randomised blocks (CRBs). As the number of treatment1 levels increases, 
the risk of not meeting the basic assumption for the use of CRBs, which is 
the homogeneity of growth conditions within the replicate blocks, increases. The 
effect of this environmental heterogeneity may be eliminated, for example, by 
arranging the experiment in a Latin square. However, the disadvantage of this 
approach, especially in experiments with a large number of treatments, is the 
high spatial demand. Another possibility is the use of randomised incomplete 
blocks, especially balanced2 blocks, but these cannot be constructed for most of 
the usual combinations of the number of treatments and repetitions; see (Yates, 
1936). Moreover, complete blocks, which are common in field experiments, cannot 
be constructed from blocks designed in this way.
1 Treatments refer to different levels (qualitative and quantitative) of the factor under investigation. 
Since the treatment applied to a plot is represented by a variety, in the following text we will 
identify the term treatment with variety. 
2 For balanced designs, the number of locations of two specific treatments in the same block is the 
same for all pairs of treatments. Implementing a DSS for Plant Variety Testing in the Czech Republic 37
Therefore, a design was sought that did not have the limitations of complete 
experimental designs with respect to the number of treatments and allowed for a 
comparison of large numbers of treatments over a relatively small area. One such 
arrangement is Alpha-design, which was introduced in the work of Patterson and 
Williams (1976). The main idea behind Alpha-design is the sophisticated division 
of experimental parts into incomplete blocks. This structure is used in experimental 
evaluation, where the block factor allows for the elimination of spatial heterogeneity 
(discussed in, e.g. Hampel & Hartmann, 2006). Alpha-design is a subclass of 
resolvable experimental designs, where in the set of blocks forming a replication, 
each variety is represented only once. The blocks do not necessarily have the 
same length, and the number of plots v and the number of replications r are not 
theoretically bounded. 
The main idea behind the use of blocks in varietal experiments is to divide 
the area into these blocks so that the parts within each block may be considered 
homogeneous, whereby the effects of spatial heterogeneity may be better controlled. 
Let us illustrate the use of blocks with the following example motivated by Kempton 
et al. (1997). Consider a simple experiment to compare yield of five plant varieties. 
Let us use 20 segments and assume that 10 segments are good (having high fertility) 
and 10 are bad (having low fertility). Furthermore, assume that we know the location 
of the good and bad segments. Let us define four blocks, two containing good plots 
and two containing bad plots, and use a complete block design (see Table 1, case 
(a)). Each variety is grown on two good plots and two bad plots. The comparison 
between varieties in this case is fair. 
If we do not use blocks, the situations described below may occur. If we are 
unlucky, some varieties will be distributed mostly in good blocks and others mostly 
in bad blocks (see Table 1, case (b)). This will cause an overestimation of the yield 
for varieties E and D and underestimation of the yield for varieties C and A. 
In the case of extreme luck, we could achieve a not bad design by randomising 
the layout (see Table 1, case (c)) in which comparisons between varietal averages 
Table 1 Illustration of randomisation and the importance of block use 
(a) Good and bad blocks 
Plant varieties A B C D E
Block I (good) Good Good Good Good Good 
Block II (good) Good Good Good Good Good 
Block III (bad) Bad Bad Bad Bad Bad 
Block IV (bad) Bad Bad Bad Bad Bad 
(b) No blocks—unlucky location 
A B C D E
Good Bad Bad Good Good 
Bad Good Bad Good Good 
Bad Good Bad Bad Good 
Bad Bad Bad Good Good 
(c) No blocks—lucky location 
A B C D E
Good Good Bad Good Bad 
Bad Good Good Bad Bad 
Bad Bad Bad Bad Good 
Good Bad Good Good Good 38 D. Hampel et al. 
are not affected by the differences between good and bad plots. Nevertheless, 
each variety will still achieve a large difference between the yields per plot, and 
consequently the average residual square in the analysis of variance will be larger, as 
it will also include the effect of the individual blocks. This will give larger standard 
errors for the comparison of varieties than those that would have been obtained using 
the appropriate blocks. Overall, we can summarise that not using blocks usually 
leads in practice to distorted relative means and increased standard errors. 
3 Alpha-Design 
In the next section, we describe the introduction of Alpha-designs, where one 
of the advantages is their relatively straightforward design, which allows for the 
creation of a computer algorithm to automatically produce plans for variety trials. 
The disadvantage is that Alpha-designs are not balanced, whereby the number 
of locations of two varieties in a block is not the same for all pairs of varieties. 
Moreover, Alpha-designs are not always the most efficient design that could be 
constructed, but this loss of efficiency is not too great. 
Practical conditions in the field dictate that all designs used for variety experi￾ments (including Alpha-design) are resolvable, where in the set of blocks forming 
one repetition, each variety is present only once. For example, since some important 
disease measurements are expensive, they must be limited to one or two replications. 
The execution or harvesting of large-scale experiments may be done step-by-step, 
with one or more complete replications in each step, thanks to decomposability. 
Other important terms that we will work with are listed below. 
Replication This term is used in several senses; here we define a replication as a 
certain group of plots of an experiment. This replication may be implemented as 
multiple strips in the field; it makes sense to talk about the results for a particular 
replication. By replication we further mean the number of replicates r for each 
variety. In other words, we can refer to a replication as the fact that a variety 
is represented in the experiment on multiple plots, whereby we obtain r values 
(typically yield) for each variety from the entire experiment. We will only consider 
experimental designs where the value of r is the same for all varieties. The number 
of replications r is usually a fixed number, since it is assumed that the total area for 
experimentation is given in advance. 
Randomisation If we arrange the varieties within each block into parts randomly, 
we speak of randomised blocks. Furthermore, we can randomly assign numbers 1 
to s to blocks in a replication and numbers 0 to v − 1 to individual varieties. 
Incomplete Balanced Blocks Incomplete blocks are blocks that do not contain all 
v varieties. If a pair of varieties occurs in a common block as many times as any 
other pair of varieties, we speak of incomplete balanced blocks. Given the number 
of varieties v, the block size k, the number of repetitions r and the number of direct Implementing a DSS for Plant Variety Testing in the Czech Republic 39 
comparisons (i.e. within a block) for each pair of varieties λ, the existence of a 
design with incomplete balanced blocks depends on the equality: 
λ(v − 1) = (k − 1)r.
However, integer values of λ are rarely achieved for combinations of v, k and r; in 
other words, designs with incomplete balanced blocks are only available for a few 
combinations of v, k and r. 
Binary Design A binary design is an experimental arrangement in which each 
variety occurs at most once in the same block. 
3.1 Alpha-Design Construction 
Alpha-design was introduced in the work of Patterson and Williams (1976) for v ≤
100 varieties and r = 2, 3, 4 replications. The authors recommend equal-length 
blocks of length k between 4 and 16 plots (the block length can be approximately 
defined as √v) and require a number of blocks s > 1, v = ks. If the number of 
varieties is not the product of the acceptable block lengths and their corresponding 
number, blocks of two sizes differing by one plot are allowed. 
3.1.1 Alpha-Design When v = ks
We first describe the construction of Alpha-design when v = ks. The varieties will 
be numbered from 0 to v −1. We define the generating matrix Gk×r with elements 
g(p, q) ∈ {mod s}, p = 1,...,k, q = 1,...,r, where mod s denotes the set of all 
remainders after integer division by s. If the generating matrix has the first column 
and the first row zero, it is called a reduced generating matrix. 
We arrange the variety numbers (from 0 to v − 1) in the matrix Bk×s. To form 
the j -th replication, j = 1,...,r, we use the j -th column of the matrix G and the 
whole matrix B, where the i-th row of the matrix B is cyclically shifted by g(i, j )
positions to the left. An example is given in Table 2. 
An important property of the constructed design is the number of concurrences 
of specific pairs of varieties, i.e. the number of blocks containing both varieties. 
A design with concurrences c1, c2,... is called an α(c1, c2,...) design, and the 
highest ci is called the degree of the Alpha-design. The question of the reachability 
of Alpha-designs with specific concurrences or degrees is a non-trivial problem, 
which is discussed in, e.g. (Patterson & Williams, 1976). 40 D. Hampel et al. 
Table 2 Construction of an 
Alpha-design for 20 varieties 
in three replications of four 
blocks of five plots (v = 20, 
r = 3, s = 4, k = 5). This is 
the original example from 
(Patterson & Williams, 1976) 
Generating matrix G Matrix of variety numbers B
0 0 0 
0 1 2 
0 2 3 
0 3 1 
0 3 2 
0 1 2 3 
4 5 6 7 
8 9 10 11 
12 13 14 15 
16 17 18 19 
Resulting design 
Replication I Replication II Replication III 
0 1 2 3 
4 5 6 7 
8 9 10 11 
12 13 14 15 
16 17 18 19 
0 1 2 3 
5 6 7 4 
10 11 8 9 
15 12 13 14 
19 16 17 18 
0 1 2 3 
6 7 4 5 
11 8 9 10 
13 14 15 12 
18 19 16 17 
3.1.2 Alpha-Design when v /= ks
This case occurs very often in practice. We will try to construct a design with two 
block lengths k1 and k2 that differ by 1. Such a design exists when the number of 
varieties v can be expressed in the form v = s1k1 + s2k2, where s1, k1, s2 and k2 are 
integers. Each replication will then consist of s1 blocks of length k1 and s2 blocks 
of length k2. Let us choose k2 = k1 + 1. The construction of the design proceeds in 
two steps: 
1. An Alpha-design is constructed for v + s2 varieties with s = s1 + s2 blocks of k1 
plots in each replication. 
2. A group of s2 varieties is dropped, such that no pair selected from these 
varieties appears in the same block. This group consists of varieties with numbers 
v,... , v + s2 − 1. 
In our example (Table 2) we get an Alpha-design for 17 varieties by dropping the 
varieties numbered 17, 18 and 19. In each replication we will have one block of five 
plots and three blocks of four plots. 
4 Design Optimality Criteria 
So now we have instructions for the construction of a large number of Alpha-design 
variants with specific parameters. However, not all will provide the same conditions 
for final comparison of varieties based on the measured values. To further evaluate 
the design, we need to define a incidence matrix N = nij of dimension v × b, 
b = rs, where nij is generally the number of occurrences of variety i in the j -th 
block, j = 1,...,b. Remember that the Alpha-design is a binary design, where 
nij = 1 or nij = 0 (this is a consequence of resolvability). The product T = NN'Implementing a DSS for Plant Variety Testing in the Czech Republic 41 
defines the variety concurrence matrix, and the information matrix of a design of 
dimension v × v is given by 
A = rI − k−1T. (1) 
The matrix r−1A has exactly v − 1 non-zero eigenvalues ei, i = 1,...,
v − 1. We call these eigenvalues canonical efficiency factors, all of which lie 
in the interval (0, 1〉. Several optimality criteria are based on these factors, the best 
known of which are: 
• A-optimality, where the harmonic mean of the efficiency factors is maximised: 
max 
v − 1
v−1 
i=0 e−1 
i
. (2) 
This criterion minimises the average variance of all pairwise comparisons of 
varieties. The quantity e = (v − 1)/v−1 
i=0 e−1 
i is referred to as the (achieved) 
design efficiency. 
• E-optimality maximises the smallest canonical efficiency factor 
max min ei (3) 
whereby minimising the greatest variance of varietal contrasts. 
• D-optimality maximises the geometric mean of the canonical efficiency factors 
maxv
−1
i
ei
 1 
v−1 
(4) 
and ensures that the total variance is minimised. 
• The (M, S)-optimality first finds the group of designs with maximum v−1 
i=1 ei
and then selects a design from this group such that v−1 
i=1 e2 
i is minimum. 
In the case of a balanced (all pairs of varieties are contained in one block equally 
often) incomplete binary design, all these criteria are equal to the average of the 
canonical efficiency factors 
e¯ = 1 
v − 1 
v−1
i=1 
ei = v(k − 1)
k(v − 1)
, (5) 
since in this case e1 = e2 =···= ev−1. We can also say that the design is efficiently 
balanced in this case. For an unbalanced design, however, these criteria give slightly 
different results. 42 D. Hampel et al. 
4.1 A-Optimal Alpha-Design 
The A-optimality criterion is most often used to construct the optimal Alpha-design. 
In order to rule out Alpha-designs with relatively low efficiency in advance, we 
select designs whose matrix of concurrences has: 
(a) The smallest possible range of off-diagonal elements, and 
(b) The smallest number of off-diagonal elements greater than 1. 
So we will prefer the lowest degree design, specifically the α(0, 1) design over the 
α(0, 1, 2) design. These two examples will cover 376 of the 414 combinations of 
parameters r, v and k in the range discussed in the work of Patterson and Williams 
(1976). For the remaining combinations, the Alpha-design is not available, and in 
these cases the k parameter needs to be changed appropriately. If the α(0, 1) design 
is not available and the α(0, 1, 2) design is available, choose a design such that as 
few pairs of varieties as possible concur twice. 
The necessary conditions for the existence of an α(0, 1) design by Patterson 
and Williams (1976) are k ≤ s and r ≤ s. These conditions are not sufficient, 
however, the condition k ≤ s guarantees the existence of a α(0, 1) design in most 
combinations of restricted design parameters. For r = 3 and r = 4, the α(0, 1, 2)
design exists precisely when the k ≤ s2 condition holds. 
For designs with relatively high efficiency selected in this way, we must 
determine those with maximum efficiency to satisfy the A-optimality condition. We 
then call the designs with the maximum efficiency value among all Alpha-designs 
with specific parameters r, s, v, the α-optimal ones. 
Note that such design is more than A-optimal. A particular design may have very 
high efficiency and yet be of a degree higher than 2. The requirement for a low 
degree design also helps to ensure the acceptability of the design in the sense of 
E-optimality. 
In practice, however, it is sufficient to obtain a near-optimal design, and for this 
purpose limits of realistically achievable efficiency for various parameters of the 
Alpha-design have been constructed. If the efficiency of our constructed design is 
close enough to a suitable bound, there is no need to look for a not significantly 
better design. In the original work of Patterson and Williams (1976), a mostly 
unreachable limit is given: 
E1 = (v − 1)(r − 1)
(v − 1)(r − 1) + r(s − 1)
. (6) 
In (Das & Kageyama, 1991) the limit that may be reached for an efficiently balanced 
design is given, as follows: 
E2 = (v − 1)
−1tr(r−1A), (7) Implementing a DSS for Plant Variety Testing in the Czech Republic 43 
where tr(A) denotes the trace of matrix A. In (Jarrett, 1977), the two-sided bound 
for efficiency is constructed as 
e¯

1 − (v − 2)S2 
e(¯ e¯ − (v − 3)S)
≤ e ≤ ¯e

1 − (v − 2)S2 
e(¯ e¯ + (v − 3)S)
, (8) 
where 
S2 =
v−1 
i=1 (ei − ¯e)2 
(v − 1)(v − 2)
.
However, the lower bound for efficiency is meaningful only if e >¯ (v − 3)S holds. 
The bound (6), although computationally easy, was designed specifically for Alpha￾design and may be more closely approximated than the bounds (7) and (8), which 
have more general applications. 
5 Ex Post Constraints in Alpha-Design 
In the practical deployment of the Alpha-design with few replications, the problem 
arises of preventing the destruction of part of the experiment and the possible 
fundamental loss of information about the variety located on multiple plots in the 
affected area. Spatial restrictions of a trial with a large number of varieties are 
common. Last but not least, other requirements for the experimental design are 
raised, such as the elimination of possible varietal competition. 
In the Statspro system, all of these problems are solved. Modifications of the 
original Alpha-design are implemented, and this solution works in an automatic 
way. The self-proximities problem as well as the breaks in replications problem are 
discussed in detail in (Janová & Hampel, 2016), and a complete description of the 
varieties sorting problem is given in (Hampel et al., 2013). 
5.1 Self-Proximities Problem 
The original Alpha-design allows for mutual proximity of the same varieties placed 
in different replicates, making the experimental design susceptible to appreciable 
loss of information about a given variety in the event of local damage to the 
experiment. Six types of undesirable placements of replicates with the same variety 
are identified, shown in the diagram in Fig. 1. Proximities denoted as 1–3 are 
undesirable, and we try to avoid them in the experimental design. Proximity type 4 
is acceptable when we design an experiment with a low number of varieties or in the 
case of short blocks. Completely undesirable is proximity 5, which is a combination 44 D. Hampel et al. 
Fig. 1 Undesirable 
positioning of the plots of the 
same plant variety 
6 
6 
5 
5 
5 
4 
4 
3 
2 3
2 
1 
1 
of proximity types 2 and 4. The case of proximity 6 is only related to the edge of 
the planned experiment, which is more exposed to potential damage. 
In the case of local damage to an experiment planned with a view to limiting 
the occurrence of the mentioned proximity varieties, field experiments with a small 
number of replications, where otherwise all information on a particular variety 
could be destroyed, can be evaluated properly. Due to the economic constraints, 
field experiments tend to be carried out only on a limited number of locations. 
Thus, the loss of information from a single location may lead to difficult or biased 
comparisons of the destroyed varieties with other varieties tested. 
Statspro is able to modify the Alpha-design, which resolves the above-mentioned 
problems automatically. A modified design is introduced in (Janová & Hampel, 
2016), which may be denoted as damage-robust or damage-resistant (DR) design in 
the discussed context. In principle it is an improvement of the original Alpha-design 
by permutations of varieties in blocks or by reshuffling blocks within replications. 
An alternative solution is offered by van Es et al. (2007), where spatially balanced 
designs are introduced. In (Williams, 1986) the idea of Alpha-design is extended 
to so-called Latinised designs, and in (John & Williams, 1998) this approach is 
extended to generate t-Latinised row-column designs. These designs can, to varying 
degrees, avoid some of the types of undesirable proximities mentioned above. 
However, a fundamental limitation of these designs is the requirement for a near￾square design shape, which is not always feasible due to space constraints. 
5.2 Dividing the Experiment into Multiple Strips 
The experiments are usually arranged in the form of that one row, one replication. 
However, sometimes this is not possible for a particular experiment due to area 
restrictions at a particular site in a given year. Then it is necessary to proceed to 
break the replicates into multiple strips; see the scheme in Fig. 2. 
To solve this problem, information about splitting replications into multiple strips 
should be included in the planning of the Alpha-design. The usual number of strips 
created from a single replication is 1 to 4. The final design of the experiment should 
be as rectangular as possible, ideally so that all strips have the same number of 
plots (this cannot always be met with blocks of different lengths). Therefore, it is 
necessary to choose a block length at the beginning of the generation of the Alpha￾design such that the strip may be assembled from a certain number of complete 
blocks. Implementing a DSS for Plant Variety Testing in the Czech Republic 45 
Replication A 
Replication B 
Replication C 
A 
B 
C 
Block 
1 
Block 
s/2 
Block 
s/2 + 1 
Block 
s 
Block 
s + 1 
Block 
2s + 1 
Block 
3s/2 
Block 
3s/2 + 1 
Block 
5s/2 
Block 
5s/2 + 1 
Block 
2s 
Block 
rs 
Block 
1 
Block 
s/2 
Block 
s/2 + 1 
Block 
s 
Block 
s + 1 
Block 
3s/2 
Block 
3s/2 + 1 
Block 
2s 
Block 
2s + 1 
Block 
5s/2 
Block 
5s/2 + 1 
Block 
rs 
Fig. 2 Illustration of dividing replications (superblocks) into multiple stripes (source: Janová & 
Hampel, 2016) 
5.3 Groups of Varieties According to Certain Characteristics 
When designing an experiment, it is sometimes necessary to take into account 
certain characteristics of the varieties, typically their height. Although it is not 
reliably proven that different heights of neighbouring varieties cause undesirable 
interactions, it is better to avoid any doubt and plan the experiment so that extremely 
tall and extremely short varieties are not present on neighbouring plots. 
This task requires previously known accompanying data, e.g. the aforementioned 
height of the varieties. When dividing varieties into groups, two problems must be 
taken into account: 
• How many groups should be created, and 
• How many varieties should be put into a particular group. 
If these problems are not solved, then varieties may not be arranged so that varieties 
from the same group or from an adjacent group are next to each other. In order to 
successfully solve these problems, it was necessary to develop an algorithm that 
arranges the varieties according to the requirement without disturbing the other 
conditions imposed on the Alpha-design. 
5.4 Additional Modifications to the Alpha-Design 
The problems mentioned in the previous text must be solved in such a way 
that neither the Alpha-design rules are violated nor the individual procedures for 
correcting undesirable situations are undesirably affected. To address this problem, 
the following schematic procedure for constructing experiment plans has been 
proposed, which effectively ensures the above constraints: 
1. Select blocks with respect to the division of replications into multiple strips. 
2. Generate the Alpha-design. 46 D. Hampel et al. 
3. Arrange the blocks into strips to satisfy certain rules. In the event that blocks of 
length 5 and 6 are combined, the strips should be stacked so that the short blocks 
are, if possible, inside the strip and not at the beginning or end. 
4. Eliminate errors 1–4 for all block lengths by rotating the pieces in the blocks and 
eliminate error 6 for blocks of lengths 8, 9, 10 by rearranging the pieces in the 
blocks on the 4th replication. 
5. Find error 6 for block lengths 5, 6, 7 and remove it by moving blocks or 
rearranging parts in the blocks. 
6. Assign varieties to individual sequence numbers according to groups that are 
created based on user-specified variety characteristics, typically variety height. 
The algorithm works for blocks of length 5–16; for combinations of blocks of length 
5 and 6, there must be at least three blocks in the strip. There is still some freedom in 
the ordering of the blocks into strips. Full algorithms for Alpha-design modifications 
may be found in (Janová & Hampel, 2016). 
6 Validation of the Damage-Robust Alpha-Design 
6.1 Influence on the Evaluation of the Experiment 
Modern evaluation of particular experiments planned in Alpha-design is provided 
using mixed models; see in, e.g. (Searle et al., 1992; Venables & Ripley, 1997) 
and (Pinheiro & Bates, 2000). For this class of models, the process of parameter 
estimation covers the estimation of fixed effects for varieties, random effects for 
blocks and replications and variance components. Currently, the preferred method 
of estimation is the residual maximum likelihood (REML) introduced in (Patterson 
& Thompson, 1971) and applied as, e.g. AIREML (see Gilmour et al., 1995). 
We use the following notation for the mixed model: symbol n denotes the number 
of observations, symbol p the number of fixed effect levels and qm the number of 
m-th random effect levels. Typically, a mixed model with a fixed variety effect, 
two random effects (for replication and for block) and a stochastic error term is 
employed 
y = Xβ + Zu + ε, (9) 
where y is n×1 vector of the dependent variable (yield, typically), X is n×p design 
matrix for fixed effects without a constant term, β is p × 1 vector of parameters for 
fixed effects, Z is n × (qb + qr) design matrix for qb block random effects and qr
replication random effects without a constant term, u is (qb + qr) × 1 vector of 
random effects parameters and ε is n × 1 vector of an error term. 
In (9), matrix X identifies the particular variety in the experiment, while matrix 
Z contains the information on the placement of the plot in a particular block and 
replication. Hence, the evaluation is dependent only on the location of a particular Implementing a DSS for Plant Variety Testing in the Czech Republic 47 
plot in a particular block and replication. As this location is unchanged, the 
evaluation remains the same for the modified Alpha-design as for the original 
one. 
6.2 Validation 
For the validation of damage-resistant Alpha-design properties, we adopt the proce￾dure given in (Janová & Hampel, 2016). The validation consists in a comparison of 
the Damage-resistant design and the original Alpha-design in the sense of damage 
robustness. For this purpose, the post-damage balance level and damage robustness 
measures are defined in (Janová & Hampel, 2016). Practically, in the case of 
damage occurrence, we will prefer the higher number of existing observations for 
all varieties rather than complete information for some varieties and lost information 
for the others. 
To reveal the damage robustness of the modified design, we use the results 
of extensive simulations considering two types of damage provided in (Janová 
& Hampel, 2016). Firstly, the damage of 3×3 plots is considered, which affects 
at least two replications; in the real experiment, this may be caused by wildlife, 
insects, diseases or chemicals. Secondly, the damage of one frontier column of 
the experiment that may be caused by wildlife or human error is simulated. We 
assume that the damage of the 3×3 plots appears in 80% of cases and the damage 
of one frontier exists in 20% of cases; these two damages are disjunct. Original 
Alpha-designs and derived damage-resistant Alpha-designs were constructed for 18 
design types denoted by v-k-r-w that differ in the number of varieties v, blocks 
k, replications r and/or shape given by number of superblock breaks w. The same 
random damage was simulated for both designs. For each design type, 1000 different 
damages were simulated. 
The results of damage simulation for both designs are summarised as scheme 
in Fig. 3. It is clearly visible that original Alpha-design allows systematically more 
occurrence of totally destructed varieties than damage-resistant design, especially 
for designs with two replications. For three or four replications, the damage-resistant 
design guarantees systematically higher numbers of undestroyed replications for all 
varieties. 
The extensive simulations have been processed to validate the modification 
procedures and confirm the high global damage robustness of the modified designs 
compared to the original ones. Employing the procedures in the Statspro system, we 
are able to automatically produce damage-robust designs that retain the efficiency 
level of the original design. This result may be considered a direct improvement 
of the design planning routines, and as such it has already been implemented into 
the official practice of the Czech Central Institute of Supervising and Testing in 
Agriculture. 48 D. Hampel et al. 
Fig. 3 Presence of maximum number of replications under damage appearance for original 
designs (black squares) and damage-resistant designs (white squares) of type v-k-r-w; x-axis: 
number of maximum present plots 
7 Lessons Learned from Implementation in CISTA Practice 
The first version of Statspro with a graphical user interface identical to the current 
version was created in 2013. In (Adamec et al., 2013) the authors describe the 
functionalities of this support system for decision-making. In the years 2014– 
2021, the Statspro system was gradually improved and extended with additional 
functionalities. The most significant changes include the following: 
1. Continuous expansion of the content of the internal crop database of Statspro. In 
2014, the database consisted of six crops, in 2021 it will contain 40 crops. Implementing a DSS for Plant Variety Testing in the Czech Republic 49 
2. For selected crops, the ability to automatically evaluate more traits than just yield, 
such as dry matter yield and green matter yield, has been implemented. 
3. Extension of the output of the statistical evaluation of the experiment at a given 
location with additional useful information such as the number of missing plots 
and the percentage of pairs of varieties that are statistically significantly different 
from each other in a given characteristics. 
4. Partial modifications of assessments and outputs using NNA and REML meth￾ods. 
5. Modification of the Alpha-design generation optimisation process so that the 
occurrence of neighbouring pairs of varieties in multiple repetitions is less 
frequent. 
The latter modification to the Statspro system will now be discussed in more detail, 
as it is another modification to the design of the experiment. 
7.1 Neighbouring Plant Varieties Problem 
In this chapter, we focus on a sparsely studied property of experimental design, 
namely, the presence and number of repeats of neighbouring plant varieties in 
different replications. This property of the realised design may be important in cases 
where the effects of adjacent plots may be present. As an example, a situation 
where varieties with very low disease or pest resistance are included in a trial, 
which will always exert higher infection pressure on their neighbours. In the case 
of repeated neighbouring, this effect may be severe and may systematically bias the 
performance of the variety placed next to the source of infection compared to other 
varieties. 
Slightly after the deployment of Statspro, a wheat crop expert pointed out that 
there were more repetitive neighbouring varieties in the newly introduced damage￾resistant Alpha-design and not only in experiments with a small number of varieties. 
This needed to be investigated and steps taken to correct it if necessary. For future 
reference, we denote the neighbouring plant varieties problem as the NPVP. 
7.1.1 NPVP in the Original and Damage-Resistant Alpha-Design 
Theoretically, it can be reasoned that the somewhat limited randomisation of the 
damage-resistant Alpha-design may cause increased numbers of repeatedly adjacent 
plant varieties in the experimental design. It is therefore necessary to first compare 
the damage-resistant Alpha-design defined in (Janová & Hampel, 2016) with the 
original Alpha-design regarding NPVP. For this purpose, 1000 original and damage￾resistant Alpha-designs were generated with the following parameters: 
• three replications, 
• blocks of length k = 5, 8 and 10 and 
• number of plant varieties v = 80, 60 or 64, 40, 20 or 24. 50 D. Hampel et al. 
Note that the results presented below form part of the publication (Viskotová 
et al., 2018). Characteristics related to repeatedly neighbouring plant varieties are 
summarised in Table 3 for the original Alpha-design and in Table 4 for the damage￾resistant Alpha-design. 
Generally, both designs produce repeatedly neighbouring plant varieties. It can 
be seen that the numbers of repeatedly adjacent plant varieties are systematically 
Table 3 Characteristics related to repeatedly neighbouring plant varieties for the original Alpha￾design. The average, minimum and maximum number of identical neighbours through the whole 
design, as well as the number of three identical neighbours in the design, are given. (Source: 
Viskotová et al., 2018) 
Number of identical neighbours Number of three identical pairs 
Design parameters Average Minimum Maximum Average Minimum Maximum 
k = 10, v = 80 13.58 0 48 0.05 0 8 
k = 10, v = 60 16.52 0 46 0.22 0 6 
k = 10, v = 40 20.49 0 48 0.90 0 12 
k = 10, v = 20 25.44 18 35 3.50 0 8 
k = 8, v = 80 5.66 0 30 0.00 0 0 
k = 8, v = 64 8.10 0 32 0.01 0 8 
k = 8, v = 40 12.34 0 35 0.21 0 10 
k = 8, v = 24 16.81 0 37 0.91 0 12 
k = 5, v = 80 0.00 0 0 0.00 0 0 
k = 5, v = 60 0.00 0 0 0.00 0 0 
k = 5, v = 40 0.01 0 8 0.00 0 0 
k = 5, v = 20 5.38 0 12 0.00 0 0 
Table 4 Characteristics related to repeatedly neighbouring plant varieties for the Damage￾resistant Alpha-design. Given are average, minimum, and maximum number of identical 
neighbours through the whole design as well as the number of three identical neighbours in the 
design. (Source: Viskotová et al., 2018) 
Number of identical neighbours Number of three identical pairs 
Design parameters Average Minimum Maximum Average Minimum Maximum 
k = 10, v = 80 16.90 0 53 0.25 0 8 
k = 10, v = 60 19.32 0 57 0.41 0 12 
k = 10, v = 40 21.94 0 49 1.03 0 8 
k = 10, v = 20 25.65 17 39 3.60 0 10 
k = 8, v = 80 10.38 0 47 0.07 0 9 
k = 8, v = 64 11.61 0 37 0.12 0 8 
k = 8, v = 40 15.10 0 50 0.37 0 8 
k = 8, v = 24 18.13 4 43 1.32 0 12 
k = 5, v = 80 6.68 0 45 0.00 0 0 
k = 5, v = 60 5.99 0 33 0.00 0 0 
k = 5, v = 40 6.08 0 21 0.00 0 0 
k = 5, v = 20 9.21 0 20 0.27 0 3 Implementing a DSS for Plant Variety Testing in the Czech Republic 51 
higher in the damage-resistant Alpha-design than in the original Alpha-design. The 
largest differences between the two designs are for blocks of length k = 5; in other 
cases, the differences are not so pronounced. Further analyses carried out in paper 
(Viskotová et al., 2018) report that in the case of at least 40 varieties, a significant 
percentage of designs with a very small number of repeatedly adjacent varieties can 
be found among the analysed damage-resistant designs. The situation is problematic 
for 20 varieties and blocks of length 10, but here the situation is also unfavourable 
for the original Alpha-design. 
7.1.2 Addressing the Neighbouring Plant Varieties Problem 
In order to efficiently detect the number of repeating pairs of neighbouring varieties, 
we need to introduce some degree of neighbourhood of varieties. Accurate detection 
would of course be possible by analysing the resulting design, but finding a suitable 
design would take a disproportionately long period of time. Therefore, we introduce 
a neighbourhood rate 
NC = 
k−1
i=1 
mmi
i ,
where mi is the highest value in the i-th block (with dimensions s × s) above the 
main block diagonal in the concurrences matrix CM, i.e. the maximum frequency 
of occurrence of the same pairs of varieties on neighbouring plots (with sequence 
number i and i + 1) of the block in the whole experiment. The number of such 
pairs will always be a multiple of s. As in the case of efficiency of design, it is not 
necessary to achieve the highest possible efficiency, nor is it necessary to minimise 
this criterion absolutely in the case of the neighbourhood rate. In practice, it will 
be satisfactory to achieve a reasonably low neighbourhood rate. For this purpose, 
we define the critical values separating the categories of neighbourhood rate for a 
particular design as 
th1 = min{k − 2 + rr
, 2 + (k − 3)(r − 1)
r−1},
th2 = max{k − 2 + rr
, 2 + (k − 3)(r − 1)
r−1}.
The value k − 2 + rr here corresponds to s neighbouring pairs in all replications, 
and on the remaining (k − 2)rs pairs of neighbouring plots within blocks, each pair 
of varieties occurs exactly once. The value 2 + (k − 3)(r − 1)(r−1) corresponds to 
(k − 3)s pairs neighbouring each other in r − 1 replications, and on the remaining 
(2r + k − 3)s pairs of neighbouring plots inside the blocks, each pair of varieties 
occurs exactly once. 52 D. Hampel et al. 
Based on the NC criterion and the critical values th1 and th2, we divide the 
designs into neighbourhood categories A, B and C and determine the scores NC∗
of the designs assigned to each category as follows: 
• Category A: NC ≤ th1, NC∗ = −2; 
• Category B: th1 < NC ≤ th2, NC∗ = −1; 
• Category C: NC > th2, NC∗ = NC. 
In addition to speeding up the search for an acceptable design, these neighbourhood 
categories ensure that the set of designs obtained from optimising the neigh￾bourhood rate is still sufficiently rich. Below, we provide a description of the 
neighbourhood rate-aware algorithm: 
1. Set the initial values of the achieved design efficiency ED = 0, the concurrence 
matrix CM = rE, where r is the number of replications, E denotes the matrix 
of all ones with dimensions v × v and v is the number of varieties. 
2. A total of 2000 designs are then gradually created (this value has been tested to 
ensure an acceptable design in practice), comparing the values of ED and NC∗
with the best design so far. The priority is to achieve the design with the highest 
efficiency, i.e. if the newly created design has a higher efficiency, the previously 
most efficient design will be replaced by this one, regardless of the value of the 
neighbourhood criterion. 
3. Only in the case of an identical efficiency of the designs are the NC∗ values 
compared, with a lower value being desirable (fewer repeating neighbouring 
pairs of varieties in the replications). However, for some combinations of 
parameters v, r and k, minimising the NC∗ criterion may significantly reduce 
the number of resulting designs. 
4. Therefore, if the design with the highest possible efficiency value and the lowest 
neighbourhood category (i.e. category A) is achieved, the optimisation process 
is terminated, although an equally efficient design with an even lower NC value 
may be generated in the next iteration. 
From the point of view of the NC criterion, the purpose of this suboptimal procedure 
is, therefore, to reduce the probability of generating a design with many repeatedly 
neighbouring pairs of varieties in r or r − 1 replications. The level of reduction 
achieved by this for different combinations of design parameters may be seen from 
the plots in Figs. 4 and 5, where the corresponding probabilities were estimated 
using relative frequencies based on a set of 500 generated designs. The individual 
designs belonging to the lowest neighbourhood category A are more likely to occur 
when optimised with NC, whereas without this optimisation, designs of higher 
neighbourhood categories will be generated with significant probability (here the 
aim was only to maximise ED). 
A comparison of the graphs in Figs. 4 and 5, which show the results of the 
analysis of designs with k = 10 and r = 3, reveals that while for v = 30 
(Fig. 4) it is almost impossible to obtain a design with some pairs of varieties 
repeatedly neighbouring in all replications when optimising NC (relative frequency 
is equal to 0%), for v = 40 (Fig. 5) such a design will occasionally be generated Implementing a DSS for Plant Variety Testing in the Czech Republic 53 
Fig. 4 Relative frequencies of the neighbourhood criterion NC values without optimisation 
(circles) and with optimisation (squares) for the combination of number of varieties 30, block 
size 10 and number of replications 3 
Fig. 5 Relative frequencies of the neighbourhood criterion NC values without optimisation 
(circles) and with optimisation (squares) for the combination of number of varieties 40, block 
size 10 and number of replications 3 
(relative frequency is equal to 4.4%). While in the first case, the design with the 
highest efficiency is usually achieved after 800 iterations or less (see Fig. 6), in 
the second case, the resulting design may not have the highest possible efficiency 
even after reaching the limit of 2000 iterations (see Fig. 7). Therefore, there is less 
room for minimising the NC criterion, as illustrated, for example, by the pair of 
trajectories highlighted in red. The design of the neighbourhood category A was 
replaced by the design of category C after about 1700 iterations, since a design with 
a higher efficiency was generated. However, during the next 300 iterations, a design 
belonging to a lower neighbourhood category was no longer generated. 54 D. Hampel et al. 
Fig. 6 Values of E and NC (500 trajectories of the iterative process) for the combination of 
number of varieties 30, block size 10 and number of replications 3 
Fig. 7 Values of E and NC (500 trajectories of the iterative process) for the combination of 
number of varieties 40, block size 10 and number of replications 3 
8 Implementation Problems Due to Personnel Influences 
The implementation of Statspro has had a positive effect on standardising the proce￾dures used for planning and evaluating field crop experiments. Data flows have been 
adapted, and, in the case of certain crops, suitable areas for further automation of 
complex human operations have been detected. Crop experts were actively involved 
in the implementation of Statspro, e.g. making additional recommendations that led 
to more user-friendly outputs and to the inclusion of additional characteristics in the 
results summary. Implementing a DSS for Plant Variety Testing in the Czech Republic 55 
The exception was one crop expert who rejected the new system and advocated 
non-statistical evaluation procedures. The management of the office insisted on the 
uniformity of the procedure for all crops; hence, the analysis of the practice of 
experiments on the given crop was performed. The crop expert wanted to prevent 
the potential problem of intercrop competition, whereby the yield of neighbouring 
varieties can be affected by their interaction (typically height, root system, different 
growth dynamics). Illustrations of this problem and how it may be detected and 
modelled are given in, e.g. (Hartmann & Hampel, 2006). 
The crop expert divided the varieties into a group of semi-dwarf varieties D, 
subjectively formed groups of short (S) and tall (T) varieties. Based on these 
groups, the crop expert conducted three experiments. In practice, the results from the 
separate experiments for certain objectives were presented together and compared 
across the experiments. Moreover, the division of varieties into these groups was 
highly subjective; after the experiment was performed, it became apparent that the 
short varieties included taller varieties than most of the tall varieties. 
However, a major problem is that it is not possible to perform a statistical 
comparison of varieties from different experiments. Here, perhaps the crop expert 
felt that there was no soil heterogeneity in the experimental station conditions and 
therefore no need to use a block design. However, as, e.g. (Hartmann, 2004) shows, 
real experiments are burdened by environmental heterogeneity, which is reflected in 
the significance of differences in the effects of Alpha-design blocks in the evaluation 
of experiments. 
Statspro makes it possible to make better use height information and to correctly 
compare varieties of different types in a single experiment, with the height of the 
varieties being taken into account in the planning of the experiment and avoiding 
the neighbourhood of very short and very tall varieties. 
At a regular meeting with breeders in August 2016, the arrangement of a separate 
trial with semi-dwarfs and a trial with other varieties was presented. It was stressed 
that the trials would not be linked in any way and the results would be presented 
separately. Furthermore, an algorithm for the placement of varieties in the design of 
the trial, taking into account the heights, was presented at the meeting to ensure that 
varieties with very different heights are not placed next to each other. The transition 
to the proposed experimental design and the principle of placing varieties in the 
experiment according to height was illustrated by the diagram in Fig. 8. 
D S T D
Fig. 8 Diagram of the old and new experimental setups involving the height of varieties 56 D. Hampel et al. 
Fig. 9 Illustration of a direct 
and indirect comparison of 
varieties within the blocks of 
the experiment 
1 2 3 4 
21 3 4 5 
4 5 2 3
7 6 13 11 8 9 10 15 1 2 4 1
10 6 9 15 8 14 7 12 11 13 
1 1 4 15 9 12 1 8 3 6 7 101
Experiment 1 Experiment 2 
5 
1 
The varieties were grouped with the grouping being determined by the algorithm, 
and they were arranged in such a way that the neighbourhood of non-contiguous 
groups is excluded. Next, Fig. 9 was used to illustrate the problem of the impossi￾bility of correct statistical comparison of varieties placed in different experiments. 
It is possible to compare varieties within a single trial either directly in individual 
blocks, as in the case of varieties 9 and 10, or indirectly: varieties 10 and 8 may be 
compared through variety 7. However, a comparison of varieties between trials is 
not available, and it is not possible to link varieties 1 and 6, for example. 
The discussion was highly emotional, and it was evident that the crop expert 
rejected the deployment of correct testing principles and influenced breeders to 
reject and protest the proposed experimental design. The arguments used against the 
introduction of the proposed system at the meeting were, firstly, that only division 
into different trials will ensure that the varieties do not vary in height and, secondly, 
that it is not only the height of the varieties that matters, but also the overall 
expression of the habitus of the variety; hence, it is impossible to have a common 
trial. 
The implementation of the Statspro system for a given crop found itself in a 
strange situation where uninformed or negatively motivated people turned against 
the new practices. The internal staffing problem was addressed by the National Plant 
Variety Office, and another special training session was organised in December 2016 
to provide relevant information to breeders. 
Many dogmatic comments were addressed there, e.g. regarding the influence 
of the overall habit of the variety, it was pointed out that the overall habit is not 
taken into account in the implementation of two separate experiments and is not 
actually evaluated or described in any way and that the division is made exclusively 
according to the height of the varieties. Furthermore, the meeting focused on a 
comparison of possible situations in the old and new experimental setup. It was 
pointed out that the new algorithm, with the usual experimental parameters (block 
length of Alpha-design 10), will guarantee at least as small differences in the height 
of varieties on adjacent blocks as in the current experimental setup, but will probably 
achieve better results, since four height groups are used in the design construction. Implementing a DSS for Plant Variety Testing in the Czech Republic 57 
Table 5 Comparison of differences in varietal heights on neighbouring plots for the original 
arrangement in two separate experiments and the arrangement in one joint experiment using 
optimisation by varietal height 
Separated experiments Joint experiment 
Experiment Maximum Average Percentage of Maximum Average Percentage of 
code difference difference above-limit cases difference difference above-limit cases 
E210 23 6.8 29.8 22.4 6.2 18.8 
E211 17 5.6 23.9 15 4.8 9.7 
E212 12 3.7 11.1 9 3.0 0.0 
E213 30 8.3 30.6 19.6 5.5 14.7 
E214 17 4.7 9.3 14.8 5.4 8.8 
E410 19 6.2 23.7 18.2 7.0 26.5 
E411 18 5.2 20.3 17 4.1 8.3 
E412 22 6.0 24.3 16 4.4 13.3 
E413 41 9.1 38.2 23.2 5.3 10.7 
E414 15 6.0 20.4 11.4 4.4 5.3 
A comparison of differences in heights of neighbouring varieties (in cm) from 
real separate experiments and in a situation where one experiment would be planned 
according to the proposed methodology was presented. We take 10 cm as a certain 
limit value for detecting too different neighbours. As may be seen in Table 5: 
• There are already above limit differences in the height of neighbouring 
varieties in the original arrangement, and 
• the proposed system is unlikely to achieve higher height differences than at 
present. 
It should be noted here that the characteristics for the one experiment type were 
identified using an imaginary experiment, the varieties in question were not grown 
side by side, but realistically in the original separate experiments. The design of 
the single trial was automatically constructed taking into account the heights of 
the varieties, which were taken from the real separate trials. Although the joint 
experiment was not actually performed, the comparison made may be considered 
plausible, because if the height of the varieties is such an important characteristic, it 
must be broadly stable. 
The substantive comments were settled after this meeting, and subsequently the 
National Plant Variety Office confirmed the implementation of Statspro also for 
the crop under discussion. The crop expert was not internally reconciled to the 
situation and in January 2019 provoked further discussions on the appropriateness 
of arranging trials with the crop in question. 
Since the experiments with the given crop had already been performed in the 
proposed arrangement and with optimisation of the distribution of the varieties 
according to their heights, it was possible to present other results besides the theo￾retical description above and the real differences in the heights of the neighbouring 
varieties. Figure 10 shows a comparison of the heights of the varieties of the planned 58 D. Hampel et al. 
Fig. 10 Comparison of the planned heights and actually measured heights in a randomly selected 
part of the experiment 
arrangement and the actual measured heights for a randomly selected section of one 
of the experiments. 
The typical waves are visible in the planned experiment, which are a mani￾festation of the smooth transition between the heights of the varieties. The actual 
expression of the varieties largely follows the theoretical assumptions, but there is 
also a degree of unreliability, e.g. for varieties 1 and 14 in the left part of the figure. 
Although the real heights may differ from the theoretical input data, the heights of 
the neighbouring varieties are still without significant differences. 
The alleged effect of differences in the heights of the neighbouring varieties 
on their yield was also commented upon. As an example, one of the shortest 
varieties in the range was chosen, where it is necessary that neighbouring varieties 
must be taller. Figure 11 shows the yield of this variety for each replication at 
different experimental stations versus the difference between the average height of 
neighbours and the height of the variety under study. Different situations may be 
observed in a given year: at station stv the yield decreases as the difference between 
the height of the neighbours increases, at station jar it is more or less stable, and at 
station sp it increases. Overall, there is no evidence of any inter-plant competition 
adversely affecting the yield of this short variety. An analogous analysis for other 
short varieties gave a similar result. 
After the meeting in January 2019, there were no more complaints from breeders. 
No issue related to varietal heights has been reported to date. On the contrary, the 
performed analyses have highlighted a revision of the methodology for measuring 
variety heights, both in terms of technical implementation and inappropriate 
practices in hands-on implementation. Implementing a DSS for Plant Variety Testing in the Czech Republic 59 
Fig. 11 Plotting the dependence of the yield of a selected short variety for each replication at 
different experimental stations in a given year on the difference between the average height of 
neighbours and the height of the variety under study 
9 Conclusions 
Two major issues have arisen in the deployment of Statspro. The first was the 
existence of repeatedly neighbouring varieties in the damage-resistant Alpha￾design. Analysis of this problem showed that there are fundamentally no more pairs 
than in the original Alpha-design, but the better display capabilities of Statspro made 
this problem more visible. In order to eliminate this phenomenon, a neighbourhood 
rate was introduced, which, by means of critical values, allows a given design to be 
categorised in terms of the possibility of limiting repeatedly occurring neighbouring 
pairs of varieties. This neighbourhood rate is then optimised in the design generation 
procedure. 
The second problem was caused by the unwillingness of one crop expert to 
implement the proposed procedures for planning and evaluating the experiments. 
Although it does not appear so, this problem caused by one person required a great 
deal of inefficient effort on the part of both the statisticians and the management of 
CISTA and potentially worked to bring the CISTA into disrepute. Similar problems 
are described in (Verdooren, 2020), which discusses historical problems with 
enforcing the planning and evaluation of experiments. An example is the refusal 60 D. Hampel et al. 
to randomise the replication of an experiment. In order to solve the whole problem, 
it was necessary to force ourselves to be as calm as possible and gradually provide 
more and more factual arguments and results of analyses to both the management 
of the CISTA and the professional public. Although it is not the primary work of 
statisticians or biometricians, it is necessary to consider negative reactions when 
deploying new functionalities in real operation, ideally anticipating and eliminating 
them in advance. 
Finally, Statspro as a support system for decision-making in the area of plant 
variety testing used by the National Plant Variety Office of Central Institute for 
Supervising and Testing in Agriculture, the Czech Republic, is now fully deployed 
and routinely used. In the area of experimental design, which is dealt with in this 
chapter, a damage-resistant Alpha-design is implemented with the possibility of 
breaking the experiment into multiple strips and optimising the neighbourhood of 
varieties according to a given characteristic. 
References 
Adamec, V., Hampel, D., & Janová, J. (2013). Decision support system for plant variety testing 
in the Czech Republic. In: Proceedings of the 31st International Conference Mathematical 
Methods in Economics 2013 (pp. 1–6). Vysoká škola polytechnická Jihlava. 
Das, A., & Kageyama, S. (1991). A class of E-optimal proper efficiency-balanced designs. 
Biometrika, 78, 693–696. 
Gilmour, A. R., Thompson, R., & Cullis, B. R. (1995). Average information REML: An efficient 
algorithm for variance parameter estimation in linear mixed models. Biometrics, 51, 1440– 
1450. 
Hampel, D., & Hartmann, J. (2006). Spatial analysis in varietal experiments (in Czech). In: 
Biometrické metody a modely v souˇcasné vˇedˇe a výzkumu – Sborník referát˚u XVII. Letní školy 
biometriky (pp. 129–136). ÚKZÚZ. 
Hampel, D., Adamec, V., Tláskal, M., Myšková, K., & Janová, J. (2013). Statspro—Statistical 
methods and approaches in variety testing (in Czech). Mendel University in Brno. 
Hartmann, J. (2004). Efficiency of varietal trials arranged in incomplete Alpha-design blocks 
in the Czech plant variety testing system (in Czech). In: Biometrické metódy a modely v 
pôdohospodárskej vede a výuˇcbe - Sborník referát˚u XVII. Letnej školy biometriky (pp. 159– 
166). ASAPV. 
Hartmann, J., & Hampel, D. (2006). Controlling inter-plot competition in field trials (in Czech). In: 
Biometrické metody a modely v souˇcasné vˇedˇe a výzkumu - Sborník referát˚u XVII. Letní školy 
biometriky (pp. 137–145). ÚKZÚZ. 
Janová, J., & Hampel, D. (2016). alfaDRA: A program for automatic elimination of variety self￾proximities in alpha-design. Computers and Electronics in Agriculture, 122, 156–160 (2016). 
https://doi.org/10.1016/j.compag.2016.01.022 
Jarrett, R. G. (1977). Bounds for the efficiency factor of block designs. Biometrika, 64, 67–72. 
John, J. A., Williams, E. R. (1998). t-latinized designs. Australian and New Zealand Journal of 
Statistics, 40, 111–118. 
Kempton, R. A., Fox, P. N., & Cerezo, M. (1997). Statistical methods for plant variety evaluation. 
Chapman & Hall. 
Patterson, H. D., & Thompson, R. (1971). Recovery of interblock information when block sizes 
are unequal. Biometrika, 58, 545–554. Implementing a DSS for Plant Variety Testing in the Czech Republic 61 
Patterson, H. D., & Williams, E. R. (1976). A new class of resolvable incomplete block designs. 
Biometrika 63, 83–92. 
Pinheiro, J. C., & Bates, D. M. (2000). Mixed-effects models in S and S-PLUS. Springer. 
Searle, R., Casella, G., & McCulloch, C. E. (1992). Variance components. John Wiley & Sons. 
van Es, H. M., Gomes, C. P., Sellmann, M., & van Es, C. L. (2007). Spatially balanced complete 
block designs for field experiments. Geoderma, 140, 346–352. 
Venables, W. N., & Ripley, B. D. (1997). Modern applied statistics with S-plus. Springer. 
Verdooren, L. R. (2020). History of the statistical design of agricultural experiments. JABES, 25, 
457–486. https://doi.org/10.1007/s13253-020-00394-3 
Viskotová, L., Tláskal, M., & Strelec, ˇ L. (2018). Neighbouring plant varieties problem in the 
damage resistant alpha design. In: Proceedings of the International Conference of Numerical 
Analysis and Applied Mathematics 2017 (ICNAAM 2017). American Institute of Physics (AIP). 
https://doi.org/10.1063/1.5043743 
Williams, E. R. (1986). Row and column designs with contiguous replicates. Austrian Journal of 
Statistics, 28, 154–163. 
Yates, F. (1936). A new method of arranging variety trials involving a large number of varieties. 
The Journal of Agricultural Science, 26, 424–455. Agri-food Supply Chain: An 
Optimisation Approach for Waste 
Valorisation 
João Pires-Ribeiro, Lourenço Cruz, and Ana Barbosa-Póvoa 
1 Introduction 
Agribusiness activities are extremely important to populations, as they provide 
much-needed food and generate jobs and wealth (European Commission, 2017). 
The sector has existed for an extended period but is now facing severe changes 
due to profound shifts in the existing technologies and end customers’ consumption 
habits (Kearney, 2010). As a consequence of these changes, sector stakeholders are 
feeling an increasing pressure to adapt their current operating models to ones that 
better cater to the evolving needs of clients (Goedde et al., 2015). 
One should highlight sustainability concerns, social concerns, and access to tech￾nology within the major drivers for change. Awareness of sustainability is currently 
on the rise, with many consumers beginning to adapt their consumption habits to 
reflect such concerns. It has been reported that consumers are now willing to spend 
more on organic and sustainable sources to tackle environmental sustainability 
and improve dietary quality. Apart from sustainability, social concerns are also 
becoming generalised. These concerns, which span from supporting locally grown 
products to investing in local job creation, lead customers to prefer closer proximity 
to farms and markets and pay more attention to the origin of their products. 
Naturally, this pushes supply chains (SC) towards a more local (decentralised) 
configuration and emphasises product freshness and traceability. Finally, access to 
ever-evolving technologies drives changes and sector improvement at an increasing 
rate. 
The uniqueness of AFSC stems from intrinsic characteristics which make AFSC 
management vastly different from the government of other SC. Firstly, AFSC 
J. Pires-Ribeiro () · L. Cruz · A. Barbosa-Póvoa 
CEG-IST, Instituto Superior Técnico, Universidade de Lisboa, Lisboa, Portugal 
e-mail: pires.ribeiro@tecnico.pt; apovoa@tecnico.ulisboa.pt 
© Springer Nature Switzerland AG 2024 
V. M. Albornoz et al. (eds.), Optimization Under Uncertainty in Sustainable 
Agriculture and Agrifood Industry, https://doi.org/10.1007/978-3-031-49740-7_4
6364 J. Pires-Ribeiro et al.
deal mostly with highly perishable products (Kusumastuti et al., 2016), which add 
a series of additional difficulties to the planning of SC activities (for instance, 
keeping high inventory levels as a means of addressing sudden demand increases 
is not possible, as products degenerate while in inventory). Secondly, the sector 
features high supply and demand uncertainty, which makes planning activities more 
difficult (Van der Vorst et al., 2007). Finally, the industry has naturally high lead 
times. Both vegetal and animal origin products require considerably more time to 
develop than most products from typical SC. These characteristics, associated with 
the previously mentioned uncertainty, make AFSC particularly difficult to manage. 
Decision-supporting tools to foster better decisions at all SC decision levels are 
required. 
In this work, we address this challenge and focus on designing and planning 
the agri-food supply chain. An optimisation model is proposed where important 
characteristics within these systems are explored, namely, product perishabil￾ity; technological processing alternatives; storage policies; and reverse logistics 
activities. Uncertainty in supply and demand is also considered, leading to the 
development of a stochastic mixed-integer linear model. This renders a more 
realistic model as AFSC are often subject to such uncertainties. In particular, 
uncertainty in supply discriminates a broad set of causes of uncertainty and supply 
loss. 
The model is tested via the application of a case study, mostly drawn from 
an existing sugar beet supply chain in the Netherlands (Jonkman et al., 2019), 
and important conclusions are drawn. Three different situations considering the 
expansion of an existing AFSC are studied. Case A is where storage is allowed 
solely in warehouses. Case B is similar to Case A, but storage is permitted in 
every echelon. And finally, Case C is where the expansion of the same AFSC 
is considered, in which storage is allowed in every echelon and including a 
reprocessing echelon where reverse logistics operations are enabled. 
This paper is structured as follows: the main AFSC characteristics and challenges 
are presented in Sect. 2. In Sect. 3 the design and planning of AFSC is discussed, 
presenting the problem and model used in this chapter. The case study is presented 
in Sect. 4 succeeded by the results and discussion. Finally, in Sect. 5 the conclusions 
and future research steps are presented. 
2 Agri-food Supply Chains Characteristics and Challenges 
Agribusiness encompasses all activities related to commercial farming. The USD 
5 trillion sector was reported to represent 10 of consumer spending, provide 
40% of worldwide employment, and be responsible for 30% of greenhouse gas 
emissions, as of 2015 (Goedde et al., 2015). In the European Union (EU), the sector 
encompasses EUR 117.4 and 137.9 billion in imports and exports, respectively 
(European Commission, 2017).Agri-food Supply Chain: An Optimisation Approach for Waste Valorisation 65
Despite its considerable economic, social, and environmental impact, as well 
as recently growing productivity, significant concerns regarding the sector’s future 
ability to provide food on a worldwide scale are on the rise. Recent estimates 
suggest that by 2050 caloric and crop demands will have increased by 70 and 
100%, respectively (Goedde et al., 2015). This steep rise in consumption needs, 
alongside water scarcity (Alcamo et al., 2007) and desertification (Bai et al., 2008), 
clearly indicates a need to improve how the agribusiness sector is preparing for such 
challenges. 
In this set, agribusinesses frequently entail vast and complex SC with interna￾tional dimensions, making it particularly important to study to reach out for new, 
innovative methods to improve their design and operation. Understanding the roles 
of farmers, traders, processors, transporters, retailers, and consumers becomes vital. 
Agri-food SC have been reported to fall into four types: local, manufactured, 
commodity, and conserved (Smith, 2008). 
As the name indicates, local supply chains do not rely on long-distance trans￾portation. Furthermore, local chains frequently support organic farming and can 
stimulate local farming economies, thus effectively combating established agricul￾tural monopolies. 
Manufactured SC products are processed with components from different ori￾gins, often allowing consumers to avoid post-acquisition processing. The complex￾ity of manufactured SC depends on the product, as simple products may involve 
just a few components, whereas others may require many different elements to be 
created. This added complexity often undermines ingredient traceability and flows 
of information within the chain. 
Commodity SC deal with products manufactured and sold to worldwide uni￾form specifications. The high standardisation implicates commodities can be sold 
everywhere. These products are bulked and transported by sea over great distances 
to ensure minimum cost. Commodity prices are very dependent on the market and 
tend to be very low and unstable and decline over time (Joint FAO/WHO Expert 
Committee on Food Additives. Meeting and Joint FAO/WHO Expert Committee 
on Food Additives and World Health Organization, 2004). Although this makes 
commodity-based products accessible to most consumers, farmers can be severely 
affected by sudden price drops. 
Conserved SC make use of conservation techniques such as drying and pas￾teurisation to preserve food quality and avoid product degradation. The increased 
longevity permits long-distance transportation, enabling constant access to other￾wise seasonal products such as fruits and vegetables. These SC are further benefiting 
from current inexpensive transportation and modern conservation methods. 
Although the different particularities of each type of AFSC might suggest 
specialisation in the management of these SC, most of the challenges are shared 
by every AFSC. Thus, a deeper understanding of these common goals is beneficial 
to the management of AFSC.66 J. Pires-Ribeiro et al.
2.1 AFSC’s Challenges 
Most AFSC face several challenges, which should be addressed holistically, as only 
then will solutions truly impact the performance of these networks. To evaluate 
how decision-makers and managers should face current and future challenges, it 
is imperative to develop a thorough understanding of what causes them and how 
AFSC are impacted. In this section, the most relevant challenges affecting AFSC are 
discussed (sustainability and waste reduction, uncertainty and changes in consumer 
behaviour, product perishability, lead times, and the retail sector). 
2.1.1 Sustainability and Waste Reduction 
Sustainability and waste reduction are the perfect illustrations of the challenges 
faced by AFSC, as current sustainability and environmentally friendly trends have 
put them in the spotlight. In 2016, 88 million tonnes of food were wasted in the 
EU alone, with estimated costs of up to EUR 183 billion (Stenmark et al., 2016). 
Moreover, it has been reported that approximately one-third of food is lost or wasted 
globally, amounting to 1.3 billion tonnes per year. Overall, waste per capita is around 
ten times higher in industrialised countries (Gustavsson et al., 2011). In these coun￾tries, food waste occurs mostly at the consumption level, with customers frequently 
discarding goods that are still appropriate for consumption (European Parliament, 
2017). Contrarily, early SC stages in low-income countries are more wasteful due 
to financial, managerial, and technical limitations (Gustavsson et al., 2011). In 
industrialised economies, consumer behaviour is changing, and better coordination 
between all AFSC participants may be key steps towards waste reduction. On 
the other hand, improving farmers’ businesses and stronger industrialisation could 
revert wastefulness in low-income countries. 
For every wasted tonne of food, resources are spent in vain, and production 
activities generate unnecessary emissions. While genetically modified (GM) crops 
and other innovative technologies might support additional productivity, food waste 
reduction is mandatory. Considering this problem, companies are being challenged 
to improve product shelf-life and innovate in packaging to reduce downstream waste 
as part of the efforts to meet customer demand. 
Alongside waste reduction, sustainability is a pressing issue. Current AFSC must 
be redesigned to ensure that resources will be available to future generations without 
damaging their ability to provide nutrition to a growing worldwide population. 
In 2017, the World Economic Forum and Deloitte TTL conducted a scenarios 
analysis (Schwab, 2017) on the future of food security and agriculture, putting 
forward four different scenarios depending on two factors: market connectivity and 
resource consumption. It is argued that the only genuinely positive outcome, named 
open-resource sustainability, results from combining high market connectivity and 
efficient resource consumption. This scenario further consolidates the necessity for 
joint action in addressing current problems affecting AFSC.Agri-food Supply Chain: An Optimisation Approach for Waste Valorisation 67
2.1.2 Uncertainty and Changes in Consumer Behaviour 
Due to product perishability, weather unpredictability, and long lead times, AFSC 
cannot rely on increased inventory to deal with supply uncertainty. Consequently, 
supply uncertainty is a challenge AFSC must be designed to address. Among 
possible solutions, flexibility and adaptation are particularly important and have 
been extensively analysed, although with modest results (Combe et al., 2012). Fur￾thermore, demand uncertainty also plays a critical role in AFSC and is increasingly 
interconnected with consumer behaviour. As mentioned above, dietary habits are 
changing, with more people following healthy trends and accessing appropriate 
nutrients and calories. Such possibility stems significantly from recent improve￾ments in productivity and transportation, as well as conservation methods, all which 
allow for seasonality mitigation and a fresh supply of quality foodstuff worldwide. 
Due to increased consumer buying power in developing economies, caloric and 
protein consumption are rising. Furthermore, as sustainability gains increasing 
importance on the international stage, so do biological products, which more and 
more customers are willing to buy, even if at a higher price. 
In the past, AFSC focused mostly on aggressive cost reduction to ensure 
competitive pricing. Prominent players in the foodstuff business are changing their 
production habits to satisfy these newly acquired consumption habits. For instance, 
Nestlé and Häagen-Dazs dropped their synthetic vanillin (the primary component 
of vanilla extract) consumption entirely for bio-vanillin, a more expensive, higher￾quality alternative (Gallage & Møller, 2015). Naturally, as players move towards 
satisfying new trends, so does the need to adapt existing AFSC. 
2.1.3 Product Perishability 
Unlike other sectors, agribusinesses cannot rely on storing buffer products as 
safety stocks to suppress supply uncertainty challenges due to product perishability. 
That is, several goods have low shelf-life and require immediate consumption. 
Nonetheless, the influence of product perishability is more significant than just 
preventing safety stock. In fact, perishability influences the whole SC, which must 
be designed to address the issue. Notably, the decrease in product quality over time, 
which leads to price decreases, makes conventional SC strategies inappropriate for 
many AFSC. These products reach peak value at the exact time of harvest, gradually 
decreasing over time. 
Authors studying the SC of perishable products, specifically fresh produce, use 
the marginal value of time (MVT), the rate at which products lose value over 
time. Analysing MVT variation across AFSC makes it possible to identify hybrid 
strategies as the best-performing. In particular, adopting a responsive model from 
post-harvest to cooling, followed by an efficient model for the rest of the SC has 
been highlighted (Blackburn & Scudder, 2009). 
Commonly, fresh produce is subject to cooling or other preservation forms to 
decelerate the rate at which quality is lost. However, there is a period between68 J. Pires-Ribeiro et al.
harvesting and conservation in which quality is lost at the highest rate, following 
which quality decline slows down considerably due to preservation (e.g. the moment 
at which goods are cooled). Bearing this scenario in mind, it is comprehensible that 
the critical time between harvest and conservation should be kept to a minimum to 
avoid quality decrease (which results in decreased pricing). As such, AFSC need to 
be as fast and responsive as possible at this early stage. Contrarily, and as mentioned, 
product quality can be maintained for longer periods of time after conservation, 
which means quickness is no longer as impactful and necessary. This means that, 
after cooling, AFSC should no longer be designed as fast and responsive but rather 
as cost-efficient, stressing the need for hybrid strategies. 
2.1.4 Lead Times and the Retail Sector 
Due to the nature of the productive activities, lead times between placing an order 
and receiving the product can be considerable in agribusiness SC, e.g. waiting for 
crops or animals to grow to the appropriate size before further processing. Although 
this has always been the case, consumer behaviour changes, supermarkets, and e￾commerce further aggravated the problem. 
Demand uncertainty has been covered in Sect. 2.1.2 and is known to affect 
AFSC considerably. The inability to accurately predict future demand for foodstuff 
prevents retail agents or even processors from having complete confidence in 
the amounts to order from their respective suppliers, leading to fear of possible 
stockouts if demand suddenly increases. In sectors with shallow lead times between 
order placement and product receival, this problem is mitigated. Retailers can 
prevent stockouts by placing orders that are processed fast enough and stock backed 
up. However, such a strategy is not possible in sectors with high lead times, as orders 
may require considerable delivery time. Consequently, when demand for a high-lead 
time product suddenly rises, retailers feel forced to order more than demand, hoping 
to fix the problem by placing large orders, which is a valid strategy for most low￾lead time SC. Nonetheless, as high-lead times prevent suppliers from immediately 
responding to orders, retailers grow stressed at impending stockouts, often placing 
yet larger orders despite having ordered more than enough. This mindset originates 
serious overstocking, which exponentially increases along the SC and has been 
coined the Forrester or bullwhip effect. 
Alongside uncertainty, supermarkets rise also poses further concerns towards 
SC with higher lead times between order placement and product delivery. Most 
supermarkets remain competitive by hosting constant promotional events, which 
frequently revolve around weekly special sales of predetermined products. Due to 
their little bargaining power, most suppliers are forced to cope with large retailers’ 
deadlines and decisions, which often place short-notice orders that suppliers 
struggle to fulfil. Supermarkets frequently order larger-than-usual quantities from 
their suppliers whenever promotional events are programmed, further increasing the 
problem. In some cases, big orders for promotional purposes have been reported to 
be received only 72 hours before the expected delivery time, which hatcheries andAgri-food Supply Chain: An Optimisation Approach for Waste Valorisation 69
broiler houses, for instance, may not be capable of coping with (Gustavsson et al., 
2011). Suppliers who do not possess the ability to handle such short-notice order 
volumes, but cannot afford to deny business opportunities with large retailers, are 
often forced to buy surplus volume from other suppliers at greater expense and fail 
to make the most efficient use of their own resources (Van der Vorst et al., 2007). 
Given these SC’s characteristics, complexity, and challenges, there is a need to 
support their decisions. That will be explored in the following chapter through the 
development of a design and planning model described in Sect. 3. 
3 Design and Planning of AFSC 
The generic AFSC here considered consists of five echelons: suppliers, which 
ensure the supply of raw materials; factories/processors, which use raw materials to 
manufacture products; warehouses/distributors, which store products for posterior 
sale and distribute them to retailers; retailers, where products are sold to end 
consumers; and reprocessors, which receive wasted products from the remaining 
SC and produce other valuable products from them, which are then sold to end 
consumers. 
The different production processes are represented as technologies, which have 
associated production costs and bills of materials. Product inventory can be allowed 
in every echelon to mimic reality better, although storage capacity is higher in 
warehouses than in other entities. Furthermore, all entities can ship their waste 
to reprocessors, thus effectively modelling reverse logistics and end-of-life (EOL) 
product concerns. The general structure of the AFSC discussed here is highlighted 
in Fig. 1. Although most authors assume centralised configurations (Kusumastuti 
et al., 2016), current food-miles concerns and local production awareness pave the 
way to alternative (decentralised) setups. To account for such possibility, flows can 
be allowed between farmers and distributors/retailers (see Fig. 1). 
3.1 Problem Description 
The problem in study focuses on the design and planning of AFSC at a strategic￾tactical level to optimise the economic performance of the SC, measured by the 
maximisation of the expected net present value (ENPV). The problem can be 
described as follows: 
Given:
• A set of products (raw materials, intermediate products, and final products);
• A set of technologies, which convert raw materials to intermediate and final 
products, 
– Associated operating costs, material inputs, and outputs;70 J. Pires-Ribeiro et al.
Fig. 1 General structure of an AFSC with a reprocessing echelon to mimic reverse logistics, where 
the arrows represent allowed product flows (arrows after retailers and reprocessors represent sales 
to end consumers)
• A set of entities (suppliers, processors, distributors, markets, and reprocessors), 
– Associated locations and transportation costs, 
– Associated technology capacity, 
– Associated storage capacity, 
– Associated demand; 
Select the:
• Technology capacity to use in each entity in each time period;
• Stored quantity in each entity in each time period;
• Product flows between entities in each time period; 
Subject to:
• Inventory constraints;
• Technology constraints;
• Storage constraints;
• Transportation constraints;
• Demand requisites;
• Supply availability;
• Service level constraints;
• Reprocessing constraints. 
So as to:
• Maximise the net present value (NPV) under uncertainty in supply and demand.Agri-food Supply Chain: An Optimisation Approach for Waste Valorisation 71
3.2 Model Formulation 
The model developed was designed to maximise the expected net present value 
(ENPV) of an AFSC using a mixed-integer linear programming (MILP) model. 
This multistage model considers uncertainty in supply and demand recurring to a 
stochastic programming approach and a scenario tree (detailed further ahead). The 
mathematical modelling adequately addresses the problem identified in Sect. 3.1 and 
is thoroughly presented below. 
3.2.1 Sets 
The different entities, products, and other relevant features were conveniently 
grouped in sets to structure the model and ease its utilisation. 
V entitites V = VstoUVtraUVsupUVf acUVwarUVmarUVrepUVtec
Vsto Entities with storage 
Vtra Entities with product transformation 
Vsup Suppliers 
Vf ac Factories/Processors 
Vwar Warehouses/Distributors 
Vmar Markets 
Vrep Reprocessors 
Vtec Entities with technologies 
P products P = PwasUPf inUPraw
Pwas Products which correspond to waste 
Pf in Final products (to be sold) 
Praw Raw materials 
I technologies I = IproU Irep
Ipro Processing technologies 
Irep Reprocessing technologies 
S nodes for stochastic uncertainty modelling 
F allowed flows of products between entities 
T time periods72 J. Pires-Ribeiro et al.
3.2.2 Scalars 
Scalars correspond to fixed values which remain immutable during computation. In 
this context, scalars are used to force certain conditions into happening or to ensure 
specific values stay within a reasonable range. The following scalars are employed: 
qplupper maximum flow of materials allowed between two entities 
qpllower minimum flow of materials allowed between two entities 
target minimum allowed percentage of demand satisfaction 
percent minimum allowed percentage of technology capacity usage 
ir interest rate 
sv salvage value of the investment performed 
tr tax rate 
f cimax maximum invested fixed capital 
3.2.3 Parameters 
Parameters correspond to pre-defined values used in the model, usually presented in 
an oriented list that can be related to one or more sets. In this context, parameters 
vary depending on the entity, product, or even the time period to which they are 
applied. 
Entity-Related Parameters 
torv inventory turnover ratio in entity v 
init ialinvv initial storage investment for each entity with storage capacity 
cent ityinitv initial storage capacity of each entity 
cestomax
v,t maximum limit for the expansion of storage capacity in entity v in 
time period t 
cestomin
v,t minimum limit for the expansion of storage capacity in entity v in 
time period t 
nextov maximum total limit for the expansion of storage capacity in entity 
v 
cinvv cost of inventory in entity v per stored product unit 
Product-Related Parameters 
rates product demand variation rate for each node s 
supratep,s supply variation rate for product p for each node s 
dmkupper
p,v maximum value for the demand of product p in entity v in the first 
time period 
init invp,v initial inventory of product p in entity v 
avaip,v availability of raw material p in entity v 
fpprodp,v final price of product p in entity v 
prmatp,v price of raw material p in entity v 
qrmatp,p quantity of raw material p necessary to produce product p’ 
f inprop,i final product p of each technology iAgri-food Supply Chain: An Optimisation Approach for Waste Valorisation 73
posspurp,v product p which entity v has the possibility to purchase 
cdispp,v cost of disposal of product p in entity v 
reprofp,v fraction of waste p which is possible to reprocess in entity v 
imwfp,v fraction of product p which immediately turns into waste in entity v 
lostsfp,v fraction of stored product p which is lost as waste in entity v 
sdmisp,v fraction of product p which is lost due to supply and demand 
mismatch in entity v 
Technologies-Related Parameters 
cplinit
i,v initial capacity of technology i in entity v 
inviniti,v initial investment in each technology i in entity v 
operci,v operative cost of technology i in entity v for each produced unit 
pconsi,p consumption of product p by technology i 
prodti,p technology i which produces product p 
ceplmax
i,v maximum limit for the expansion of technology i in entity v 
ceplmin
i,v minimum limit for the expansion of technology i in entity v 
nexpli,v maximum total limit for the expansion of technology i in entity v 
alphapli,v,t variable investment in technology i in entity v 
açphawhv,t variable investment in entity v with storage capacity 
Transportation-Related Parameters 
transpcv,v transportation cost for one unit between entities v and v’ 
linkv,v cost of establishing a transportation contract between entities v and 
v’ 
f iplv,v distance between entities v and v’ 
Other Parameters 
probs probability of occurrence of node s 
lvlv,s,t auxiliary parameter to establish the average inventory level at entity v in 
time period t 
3.2.4 Variables 
Variables correspond to the different decisions taken to achieve the final objective. 
The variables are divided in three groups: continuous variables, the objective 
function variable and corresponding auxiliary variables, and a smaller set of binary 
variables. 
Continuous Variables 
P Uv,w,p,s,t amount of product p purchased by entity v from entity w at time 
period t in node s 
Win
i,v,p,s,t amount of product p consumed by technology i at entity v in time 
period t in node s 
Wout
i,v,p,s,t amount of product p produced by technology i at entity v in time 
period t in node s74 J. Pires-Ribeiro et al.
Wout1
v,p,s,t amount of product p produced at farm v in time period t after 
supply variation is applied in node s 
Wout2
v,p,s,t amount of product p produced at farm v in time period t after waste 
fraction is applied in node s 
Pf arm
p,v,t amount of product p lost at farm v from supply and demand 
mismatch in time period t 
SQp,v,t total amount of product p lost as waste in farm v in time period t 
QP Lv,w,p,s,t amount of product p shipped from entity v to entity w in time 
period t in node s 
INVv,p,s,t inventory level of product p kept at entity v in time period t in node 
s 
ILv,s,t average product inventory level kept at entity v in time period t in 
node s 
CPLi,v,t capacity of technology i available at entity v in time period t 
CEPLi,v,t expansion of capacity of technology i in entity v undertaken in 
time period t 
Csto
v,t storage capacity of entity v in time period t 
CEsto
v,t expansion of storage capacity of entity v undertaken in time period 
t 
CSert customer service level in time period t 
Demp,v,s,t demand for product p in entity v in time period t in node s 
U nDemp,v,s,t unmet demand for product p in entity v in time period t in node s 
Binary Variables 
XPLi,v,t equals 1 if the expansion of capacity of technology i at entity v occurs 
in time period t 
Xsto
v,t equals 1 if the expansion of storage capacity at entity v occurs in time 
period t 
YPLv,w,t equals 1 if the flow between entities v and w is established in time 
period t 
Objective Function Variable and Corresponding Auxiliary Variables 
ENPVs expected net present value corresponding to node s 
SAv,p,s,t sales value of product p at market v in time period t and node s 
CFs,t cash flow in time period t and node s 
ENEs,t expected net earnings in time period t and node s 
FT DCt fraction of the total depreciation capital which must be paid in time 
period t 
FCI fixed capital investment 
DEPt capital depreciation factor in time period tAgri-food Supply Chain: An Optimisation Approach for Waste Valorisation 75
3.2.5 Objective Function 
As stated, the model presented herein focuses on the economic objective of ENPV 
maximisation. This section provides a detailed analysis of the objective function and 
corresponding auxiliary equations. Equation 1 corresponds to the objective of ENPV 
maximisation, considering the probability of each scenario s occurrence, given by 
the scenario tree. The NPVs is expressed as a function of the cash flows (CFs,t) of 
each scenario and time period and corresponding interest rate (ir), Eq. 2. 
maxENP V = pbs × NPVs (1) 
NPVs = 
t
CFs,t
(1 + ir)t (2) 
Equation 3 allows for the calculation of the cash flow for each scenario and time 
period featured in Eq. 1. The CF is determined as the difference between expected 
net earnings (ENE) in scenario s and time period t and the fraction of the total 
depreciable capital which must be paid in time period t. In the last period, CF also 
encompasses the recoverable fraction of the fixed investment via its salvage value 
(sv). 

CFs,t = ENEs,t − FTDCt ∀s,t | ((ord(t) ≤ (|t| − 1)) ∧ nts,t)
CFs,t = ENEs,t − FTDCt − sv · FCI∀s,t | ((ord(t) = |t|) ∧ nts,t) (3) 
The ENE parameter required in Eq. 3 is calculated in Eq. 4 where to the total 
income are deducted all costs. The total income is calculated by the product of units 
sold and the respective price in each market. Additionally, the following costs are 
considered:
• Cost of raw materials determined by multiplying the number of units produced 
by the corresponding costs of the bill of materials;
• Cost of operating technologies determined by multiplying the cost of production 
of a single unit by technology i by the number of units it produces;
• Cost of inventory determined by the product of the cost of storage of a single unit 
by the average storage level at any given entity;
• Cost of transportation determined by estimating the total amount of transported 
products, which corresponds to the sum of products sent by entity v to other 
entities and the products bought by entity v. This total is then multiplied by the 
cost of transportation of a single product per distance unit and the total distance 
between each of the entities between which transportation is carried out at any 
time period;
• Cost of waste disposal is determined by calculating the total amount of waste not 
prone to being reprocessed and multiplying it by the disposal cost per product 
unit. The waste amount is the difference between the influx of products to 
reprocessors and their sales, as the resulting amount corresponds to the waste 
not reprocessed.76 J. Pires-Ribeiro et al.
Apart from the costs listed above, a final term in Eq. 4 accounts for the 
depreciation of the fixed capital, to which the tax rate ir is applied. Equation 5 
accounts for calculating this depreciation (DEPt), which was deemed linear. 
ENEs,t = (1 − ir)
×
⎡
⎣ 
(v,p)∈mar(v)

fpprodp,v × SAv,p,s,t 
− 
(v,w,p)∈sup(w)

prmatp,v×P Uv,w,p,s,t 
− 
(i,v,p)∈T rans(v)

operci,v × Wout i,v,p,s,t 
− 
(v)∈sto(v)

cinvv × ILv,s,t 
− 
transpcv,w
× 
qplv,w,p,s,t × P Uw,v,p,s,t 
× f iplv,w
− 
(v,w,p)∈repro(w)
qplv,w,p,s,t − SAw,p,s,t 
× cdispp,v,t 
⎤
⎦ + (ir × DEPt)
(4) 
DEPt = (1 − sv) × FCI
t (5) 
As mentioned, the cash flow calculation considers the fraction of the depreciable 
capital that must be paid in time period t, for which such fraction must also be 
calculated. For this reason, the total fixed capital was divided equally by all time 
periods, as denoted by Eq. 6. 
FT DCt = FCI
t (6) 
Finally, to obtain the total fixed capital, Eq. 7 encompasses the investment 
considered in the SC:
• Facility investment, which is translated by the storage capacity of each entity 
and the corresponding cost per capacity unit, as well as the eventual investments 
in storage capacity expansion and corresponding variable costs;
• Technology investment, which is translated by the initial capacity of each 
technology and corresponding cost per capacity unit, as well as the eventual 
investments in technology capacity expansion and corresponding variable costs;
• Transportation investment, which corresponds to the costs of celebrating trans￾portation agreements with transportation companies for each of the necessaryAgri-food Supply Chain: An Optimisation Approach for Waste Valorisation 77
routes. Note the importance of the binary variable YPLv,w,t , which ensures only 
effective routes are considered. 
FCI = 
v∈sto(v)

cent ityinit v × init ialinvv

+ 
v∈sto(v)

alphawhv,t × CEstov,t 
+ 
v∈tec(v)


cplinit
i,v × inviniti,v
+ 
v∈tec(v)

alphapli,v,t × CEPLi,v,t 
+
v,w

linkv,w × YPLv,w,t  (7) 
3.2.6 Constraints 
These constraints allow for model coherence in terms of mass balance and flows, 
among others. This section lists and discusses the modelled constraints, which have 
been categorised depending on where their applicability lies. 
Inventory Constraints 
Inventory constraints ensure that appropriate mass balances are applied to each 
entity and establish the acceptable inventory levels for warehouses, as well as the 
maximum and minimum storage capacities deemed realistic for each entity. 
Equation 8 corresponds to a continuity condition that ensures coherence between 
the material inflows and outflows in entities where inventory is not allowed. The 
equation forces the total material inflow to equal the total material outflow. For 
this, the total inflow includes materials purchased (P Uv, w, p, s,t), materials 
produced (W outi,v,p,s,t), and materials received from other entities (QP Lw,v,p,s,t). 
The total outflow includes materials sent to other entities (QP Lv,w,p,s,t), material 
consumption (Wini,v,p,s,t), and material turned into waste. Two sources of waste 
are considered: the first corresponds to a fraction (imwfp,v) of the manufactured 
products (W outi,v,p,s,t), which does not meet the required quality standards upon 
production; the second corresponds to a fraction (lostsfp,v) of the average inventory 
level (ILv,s,t) which becomes improper for consumption due to product perishabil￾ity. 

w∈f low(w,v)
QP Lw,v,p,s,t +
w
P Uv,w,p,s,t +
i
Wout i,v,p,s,t
= 
v∈mar(v)
QP Lv,w,p,s,t +
i
Win
i,v,p,s,t +
i

Wout i,v,p,s,t × imwf p,v
+
w

ILv.s.t × lostsf p,v ∀ p ∈ P ∧ v /∈ Vsto ∧ (s,t) ∈ S (8)78 J. Pires-Ribeiro et al.
Equations 9 and 10 follow the same rationale behind Eq. 8 but are, in turn, 
applied to entities where inventory is allowed. As such, apart from all other terms 
already seen in Eq. 8, the inventory levels in time period t (INVv,p,s,t) and t − 1
(INVv,p,s,t−1) are featured. Equation 9 uses the initial inventory (init invp,v) and is 
thus applied to the first modelled time period. For all remaining time periods, Eq. 9 
is adapted into Eq. 10. 
init invp,v + 
v∈f ac(v)
QP Lw,v,p,s,t +
w
P Uv,w,p,s,t +
i
Wout i,v,p,s,t
= 
v∈mar(v)
QP Lv,w,p,s,t + INV v,p,s,t +
i
Win
i,v,p,s,t
+
i

Wout i,v,p,s,t × imwf p,v
+
w

ILv.s.t × lostsf p,v ∀p ∈ P ∧ v ∈ Vsto ∧ s ∈ S ∧ t = 1 (9) 
INV v,p,s,t−1 + 
v∈f ac(v)
QP Lw,v,p,s,t +
w
P Uv,w,p,s,t +
i
Wout i,v,p,s,t
= 
v∈mar(v)
QP Lv,w,p,s,t + INV v,p,s,t +
i
Win
i,v,p,s,t
+
i

Wout i,v,p,s,t × imwf p,v
+
w

ILv.s.t × lostsf p,v ∀p ∈ P ∧ v ∈ Vsto ∧ s ∈ S ∧ t = 1 (10) 
Equations 11 and 12 focus on establishing the average inventory level at each 
entity. Equation 11 ensures that the average inventory level at entity v does not 
exceed a certain reasonable fraction of the total storage capacity of the entity via the 
parameter lvlv,s,t . On the other hand, Eq. 12 forces the average inventory level to 
respect a reasonable inventory turnover ratio (torv) to ensure appropriate inventory 
management while respecting the limit set by Eq. 11. 
lvlv,s,t × ILv,s,t ≤ Cstov,t ∀v ∈ Vsto ∧ (s,t) ∈ S (11) 
ILv,s,t =

(w,p)∈f low(v,w) QP Lv,w,p,s,t
torv
∀v ∈ Vsto ∧ (s,t) ∈ S (12) 
Equations 13 and 14 focus on purchases and sales, respectively. Equation 13 
ensures entity v can only purchase available units from entity w (it should beAgri-food Supply Chain: An Optimisation Approach for Waste Valorisation 79
noted that the available quantity—avaip,v—does not vary with the time period). 
Equation 14 forces all sales from one entity to another to be considered as a flow of 
products to be transported between the two to ensure reasonable transportation costs 
are considered (as discussed, transportation flows require corresponding costs, e.g. 
a contract with a transportation company). 

w
P Uw,v,p,s,t ≤ avaip,v ∀v ∈ V ∧ p ∈ Praw ∧ (s,t) ∈ S (13) 
SAv,p,s,t = 
w∈f low(w,v)
QP Lw,v,p,s,t ∀v ∈ V ∧ p ∈ P ∧ (s,t) ∈ S (14) 
Technology Constraints 
The model presented here uses the set technologies (i) to define all production 
(processing) and reprocessing processes. As such, specific constraints need to be 
established to determine the capacity of each technology, as well as the inputs and 
outputs associated with each process. This section summarises these constraints. 
Equation 15 ensures coherence between the production undertaken by tech￾nology i in entity v (W outi,v,p,s,t) and its corresponding capacity (CPLi,v,t), by 
forcing production not to overcome the maximum installed capacity. 

p∈f in(p)
Wout i,v,p,s,t ≤ CPLi,v,t ∀i ∈ I ∧ v ∈ Vtra ∧ p ∈ P ∧ (s,t) ∈ S
(15) 
Equation 16 functions similarly but instead addresses product consumption 
(Wini,v,p,s,t), by forcing product consumption by technology i not to exceed 
the total installed capacity. Meanwhile, Eq. 17 defines Wini,v,p,s,t as the product 
between the production flow (W outi,v,p,s,t) and the corresponding raw materials 
necessary to produce each of the manufactured products (qrmatp,p). 
CPLi,v,t ≥ 
i∈ipro(i)
Win
i,v,p,s,t ∀i ∈ I ∧ v ∈ Vtra ∧ t ∈ T (16) 
Win
i,v,p,s,t = 
p∈f in(p)

Wout i,v,p,s,t × qrmatu,p
∀i ∈ I ∧ v ∈ Vtra ∧ p ∈ P ∧ (s,t) ∈ S (17) 
Equation 18 allows for a minimum acceptable utilisation capacity of technology 
i at entity v to be defined for each time period (per cent), by ensuring the product80 J. Pires-Ribeiro et al.
between per cent and the technology’s capacity (CPLi,v,t) does not surpass the 
produced flow. 
percent ×CPLi,v,t ≤ 
p∈f in(p)
Wout i,v,p,s,t ∀i ∈ I ∧v ∈ Vtra ∧t ∈ T (18) 
Equations 19 and 20 establish the capacity (CPLi,v,t) of technology i in entity 
v for any given time period t. Equation 19 defines such capacity as the capacity 
installed in the last modelled time period plus an eventual capacity expansion 
(CEPLi,v,t) registered in the present time period. Equation 20 adapts Eq. 19 to 
the first time period by making use of the initial capacity (cplinit
i,v). 
CPLi,v,t = CPLi,v,t−1 + CEPLi,v,t ∀i ∈ I ∧ v ∈ Vtra ∧ t ∈ T (19) 
CPLi,v,t = cplinit
i,v + CEPLi,v,t ∀i ∈ I ∧ v ∈ Vtra ∧ t ∈ T (20) 
As technology capacity expansions (CEPLi,v,t) are essential inputs for Eqs. 19 
and 20, these must be well defined. The trio of Eqs. 21, 22, and 23 define the max￾imum limit for technology capacity expansion in any time period (ceplmax i,v), the 
minimum limit for technology capacity expansion in any time period (ceplmin
i,v), 
and the maximum sum of all technology capacity expansions which occur during 
the modelled time span (nexpli,v), respectively. As such, these equations ensure 
technology capacity expansions stay within reasonable bounds (Eqs. 21 and 22) 
and that total facility capacity dictates the maximum technology capacity installed 
(Eq. 23). 
CEPLi,v,t ≤ ceplmax i,v ∀i ∈ I ∧ v ∈ Vtra ∧ t ∈ T (21) 
CEPLi,v,t ≥ ceplmin
i,v ∀i ∈ I ∧ v ∈ Vtra ∧ t ∈ T (22) 

t
CEPLi,v,t ≤ nexpli,v ∀i ∈ I ∧ v ∈ Vtra ∧ t ∈ T (23) 
Storage Constraints 
Apart from technologies used to represent the different production/manufacturing 
processes within the SC, storage functions are another essential feature of the 
different entities, as it permits inventory to be kept at each entity. Storage was 
modelled in a similar way to technologies in the sense that storage levels are 
also regulated by maximum and minimum capacities and capacity expansions. 
Equation 24 is applied for the first time period and defines the storage capacity in 
entity v (Cstov,t) as the initial storage capacity for that same entity (cent ityinitv) 
to which an eventual storage capacity expansion in time t (CEstov,t) is added. 
Equation 25 functions similarly to Eq. 24 but is instead applied to all other time 
periods, as the initial storage capacity is replaced by the storage capacity in theAgri-food Supply Chain: An Optimisation Approach for Waste Valorisation 81
previous time period (Cstov,t −1). Equations 26 and 27 ensure that storage capacity 
expansions stay within maximum (cestomax v,t) and minimum (cestomin
v,t) realistic 
boundaries, respectively. Equation 28 ensures the sum of all storage capacity 
expansions undertaken during the program runtime does not surpass a realistic limit 
(nexstov). 
Cstov,t = cent ityinit v + CEstov,t ∀v ∈ Vsto ∧ t ∈ T (24) 
Cstov,t = Cstov,t−1 + CEstov,t ∀v ∈ Vsto ∧ t ∈ T (25) 
CEstov,t ≤ cestomax v,t ∀v ∈ Vsto ∧ t ∈ T (26) 
CEstov,t ≥ cestomin
v,t ∀v ∈ Vsto ∧ t ∈ T (27) 

t
CEstov,t ≤ nexstov ∀v ∈ Vsto ∧ t ∈ T (28) 
Finally, Eq. 29 ensures coherence between storage capacity at entity v in time 
period t (Cstov,t) and the inventory level for each product p in the same entity and 
time period (INV v,p,s,t), by forcing the sum of all stored products never to exceed 
total storage capacity. 

p
INV v,p,s,t ≤ Cstov,t ∀v ∈ Vsto ∧ p ∈ P ∧ (s,t) ∈ S (29) 
Transportation Constraints 
A set of transportation constraints was introduced to ensure that material flows 
remained within appropriate values. For these, the total flow of materials between 
two entities v and w was defined as the sum between the products sent from v 
to w (QP Lv,w,p,s,t) and the products sold by v to w (P Uv,w,p,s,t). Equation 30 
forces the total flow never to surpass the maximum acceptable limit for product 
flow (qplupper), and Eq. 31 ensures the same flow is never inferior to a minimum 
value (qpllower). 

p

QP Lv,w,p,s,t + P Uv,w,p,s,t 
≤ qplupper × YPLv,w,t
∀ (v, w) ∈ F ∧ p ∈ P ∧ (s,t) ∈ S (30) 

p

QP Lv,w,p,s,t + P Uv,w,p,s,t 
≥ qpllower × YPLv,w,t
∀ (v, w) ∈ F ∧ p ∈ P ∧ (s,t) ∈ S (31)82 J. Pires-Ribeiro et al.
Supply and Demand Constraints 
To help fill the void in the literature, the model discussed here includes a compre￾hensive strategy to model supply uncertainty. When addressing supply in AFSC, 
two details are of the utmost importance: firstly, it is vital to remember supply 
uncertainty comes from a variety of sources, from variable weather conditions to 
unpredictable plagues or other causes of crop loss; secondly, it should be noted that 
agri-food supply will frequently be unable to adapt to demand fluctuations, primarily 
due to the high-lead time characteristic of the sector. As such, the modelling 
approach must cater to all these characteristics to provide genuinely realistic results. 
As mentioned, AFSC show reduced flexibility in adapting supply to demand 
variation, as lead times are generally too high for production corrections to be 
undertaken in appropriate time spans. To mimic this condition, the current model 
defined the supply of each product as a predetermined value with no connection to 
the demand in the corresponding time period. That is, supply and demand are often 
mismatched, in accordance with what is seen in reality. Naturally, the predetermined 
supply is a theoretical value (for instance, the total production from the arable land 
of a farm), which never truly corresponds to the effective supply that comes from it 
due to inevitable losses. Consequently, several constraints were also incorporated 
to address such losses and to depict real-life agri-food production satisfactorily. 
Figure 2 provides a clear snapshot of the sources of uncertainty/losses in the generic 
structure of the SC. 
Fig. 2 Generic structure of the AFSC with pinpointed sources of uncertainty/losses. Red repre￾sents product growth uncertainty in suppliers; green represents harvesting losses; purple represents 
losses due to supply and demand mismatch; orange represents inventory losses due to product 
perishability; blue represents losses in processing pathways; brown represents end customers’ 
demand uncertaintyAgri-food Supply Chain: An Optimisation Approach for Waste Valorisation 83
Equation 32 serves as the starting point for supply modelling and, as mentioned, 
considers the maximum capacity of production of p in farm v (excluding all 
losses) as the maximum theoretical availability of p (avaip,v). The equation defines 
variable Wout1
v,p,s,t as the quantity of product p, which is effectively produced by 
deducting supratep,s from the theoretical availability. The parameter supratep,s
functions similarly to rates, as it is also an assigned value to each node in the 
stochastic scenario tree, but rather corresponds to the variation in supply for each 
product p (unlike rates, which reports to demand variation). 

p∈raw(p)
Wout1
v,p,s,t = 
p∈raw(p)

avaip,v × supratep,s
∀v ∈ Vsup ∧ p ∈ Praw ∧ (s,t) ∈ S (32) 
By immediately deducting a fraction from the theoretical production, Eq. 32 
effectively mimics uncontrollable factors such as weather changes, soil fertility, 
occurrence of swarms, and natural disasters (floods and droughts, among others), 
which cause losses to occur even before the products are harvested. As such, 
auxiliary variable Wout1
v,p,s,t corresponds to the quantity of product p which can 
be harvested in farm v in time period t. 
During and after harvesting, the products are handled manually by workers or 
by machinery. Naturally, the harvesting operation will sometimes feature product 
mishandling and other accidents which result in additional post-harvest losses. As 
the current model is strategic and tactical, the modelled time periods are too long 
for the specific handling of each product to be incorporated. Alternatively, post￾harvesting losses are accounted for as an average loss for the entire time period, that 
is, fraction imwf p,v (the immediate fraction of product p which turns to waste in 
entity v). Equation 33 defines auxiliary variable Wout2
v,p,s,t as the total product p 
produced in farm v after the harvesting operations. 

p∈raw(p)
Wout2
v,p,s,t = 
p∈raw(p)


Wout1
v,p,s,t × 
1 − imwf p,v
∀v ∈ Vsup ∧ p ∈ Praw ∧ (s,t) ∈ S (33) 
As mentioned in this section’s introduction, high lead times often result in mis￾matches between supply and demand. As most food products are highly perishable, 
such mismatch frequently means excessive supply cannot be kept for long periods 
of time and is, eventually, wasted. Equation 34 defines variable Pf armp,v,t as the 
total product p, which is turned to waste in farm v in time period t due to excessive 
supply. This variable is calculated as a percentage of the total product after harvest84 J. Pires-Ribeiro et al.
(Wout2
v,p,s,t), as an average assumed percentage of product is lost due to this 
mismatch (sdmisp,v). 

p
Pf armp,v,t = 
p∈raw(p)
Wout2
v,p,s,t×sdmisp,v ∀v ∈ Vsup∧p ∈ Praw∧t ∈ T
(34) 
As mentioned in this section, the current model allows for storage to be kept 
in every entity along the SC in Cases B and C (please refer to Sect. 4), condition 
which better mimics reality in comparison to models which solely allow storage 
to be kept in warehouses and distribution centres. As food products are highly 
perishable, perishability must be addressed, especially regarding stored products. 
As identified by Jonkman et al. (2019), several modelling strategies are available to 
incorporate product perishability. Nonetheless, most strategies focusing on quality 
or shelf-life counters require shorter modelling time periods and are, thus, applicable 
to operational models. As the current model has a strategic and tactical breadth, such 
strategies are unsatisfactory. To circumvent the inconvenience, a more statistical 
approach was followed by assuming that for each larger time period, an average 
fraction of the stored products eventually become inappropriate for consumption as 
is—the lost stored fraction (lostsf p,v,t). Equation 35 agglomerates all sources of 
waste in farms to obtain the total spoiled quantity in a given time period (SQp,v,t). 

p∈raw(p)
SQp,v,t = 
p∈raw(p)


Wout1
v,p,s,t × imwf p,v
+
p
Pf armp,v,t
+ 
p∈raw(p)

INV v,p,s,t × lostsf p,v,t  ∀v ∈ Vsup ∧ p ∈ Praw ∧ (s,t) ∈ S
(35) 
Finally, as the total waste for each farm is calculated, an inventory balance for 
each farm is possible, derived from Eqs. 9 and 10, and is given by Eq. 36. 

w,p
P Uv,w,p,s,t + 
p∈raw(p)
Wout1
v,p,s,t + 
(w,p)∈f low(w,v)
QP Lw,v,p,s,t
= 
(w,p)∈f low(v,w)
QP Lv,w,p,s,t + 
p∈raw(p)
SQp,v,t
∀v ∈ Vsup ∧ p ∈ Praw ∧ (s,t) ∈ S (36) 
Appropriate AFSC design models must effectively address demand fluctuations 
and their corresponding uncertainty, as only then can truly realistic results be 
obtained.Agri-food Supply Chain: An Optimisation Approach for Waste Valorisation 85
Equations 37 and 38 establish the connection between demand and sales. 
Equation 37 forces sales (SAv,p,s,t) never to surpass demand (Demv,p,s,t), while 
Eq. 38 ensures sales remain above a minimum acceptable percentage of demand 
satisfaction (target). 
SAv,p,s,t ≤ Demv,p,s,t ∀v ∈ V ∧ p ∈ P ∧ (s,t) ∈ S (37) 
SAv,p,s,t ≥ Demv,p,s,t × target ∀v ∈ V ∧ p ∈ P ∧ (s,t) ∈ S (38) 
Equation 39 defines the demand for product p at entity v in the first time period 
as equal to a predetermined value (dmkupper
p,v), as this starting point is important 
to then address demand uncertainty throughout the modelled time span. In fact, to 
address demand uncertainty, a stochastic modelling approach was followed, in line 
with work developed by several authors (Shabani et al., 2012; Huber et al., 2017; 
Govindan et al., 2014; Galal & El-Kilany, 2016). A scenario tree was established 
to do so, where each scenario corresponds to a tree node (set S). Each node then 
branches into four possible scenarios in the following time period, and to each node 
an occurrence probability is attributed (probs). Each node is then associated with a 
demand variation rate (rates). Having established the stochastic scenario tree, Eq. 40 
defines demand for product p in entity v in time period t as the demand in the 
previous time period, to which rates for the current tree node is applied. As such, 
demand uncertainty is effectively mimicked by selecting a tree node. 
Demp,v,s,t = dmkupper
p,v ∀v ∈ V ∧ p ∈ P ∧ (s,t) ∈ S (39) 
Demp,v,s,t = Demp,v,s,t−1 × rates ∀v ∈ V ∧ p ∈ P ∧ (s,t) ∈ S (40) 
Reprocessing Constraint 
One final constraint was established to model the functioning of reprocessing 
facilities. In real scenarios, it is never possible to fully reprocess the waste generated 
alongside SC; consequently, only a certain fraction of the waste reaching reprocess￾ing facilities should generate new commercially interesting products. This fraction is 
here incorporated as reprof p,v (the fraction of product p which can be reprocessed 
at entity v). Equation 41 defines the total amount of new product generated by 
reprocessors (Wout i,v,p,s,t) as a function of the waste input (Win
i,v,p,s,t) taking into 
account both the raw material requirements necessary to produce the new product 
(qrmatp,p) and reprof p,v. 
Win
i,v,u,s,t × reprof p,v = 
p∈raw(p)

Wout i,v,p,s,t × qrmatp,p

∀i ∈ Irep ∧ v ∈ Vrep ∧ p ∈ Pf in ∧ u ∈ Pwas ∧ (s,t) ∈ S (41)86 J. Pires-Ribeiro et al.
Complementary Equations 
Apart from the objective function and corresponding constraints necessary for the 
modelling of AFSC, two complementary equations were defined to obtain the level 
of unmet demand of product p at any given entity v in time period t (U nDemp,v,s,t) 
and the level of customer service in time period t (CSert). Although not strictly 
necessary, these variables are useful when interpreting results from case studies and 
are defined by Eqs. 42 and 43, respectively. 
U nDemp,v,s,t = Demp,v,s,t − 
w∈f low(w,v)
QP Lw,v,p,s,t
∀v ∈ V ∧ p ∈ P ∧ (s,t) ∈ S (42) 
CSert = 
s

probs ×

(v,p)∈mar(v) U nDemp,v,s,t

(v,p)∈mar(v)

dmkupper
p,v × rates


∀ t ∈ T
(43) 
4 Case Study, Results, and Discussion 
The model described throughout Sect. 3 was tested by applying a case study, 
consisting of several scenarios explained herein. The section characterises the 
specifications of each case in detail and comments on the data sources. Furthermore, 
the present section also summarises the results of the application of the three cases 
of the case study. The result presentation is accompanied by a critical discussion 
of the results, focusing on drawing conclusions regarding the applicability of the 
model and its behaviour in response to different SC characteristics (mimicked by the 
different cases). Naturally, the results of the three cases are analysed comparatively, 
as only then can truly meaningful conclusions be drawn. 
4.1 Case Study Specifications 
The case study data described here is based on that first published by Jonkman et al. 
(2017) and later revisited by Jonkman et al. (2019). The case study was analysed 
under three different cases and all with specific changes meant to be addressed 
comparatively to assess the model’s applicability to a realistic context. Starting 
from the simplest and most commonly used type of SC (Case A) to a more flexible 
SC using circular economy principles (Case C). Thus being able to compare the 
pros and cons of more complex SC in the AFSC context. The different cases are 
structured as follows:Agri-food Supply Chain: An Optimisation Approach for Waste Valorisation 87
• Case A: the expansion of an existing AFSC is considered, in which storage is 
allowed solely in warehouses, and under supply and demand uncertainty;
• Case B: the expansion of the same AFSC is considered, but storage is allowed in 
every echelon, and under supply and demand uncertainty:
• Case C: the expansion of the same AFSC is considered, in which storage is 
allowed in every echelon, under supply and demand uncertainty, and including a 
reprocessing echelon where reverse logistics operations are allowed. 
It should also be noted that, in all cases, suppliers can send commercially 
ready intermediate products directly to distributors, thus suppressing unnecessary 
routing in which market-ready products are sent from suppliers to distributors via 
manufacturers (suboptimal routing). 
The model presented here is then implemented using GAMS and tested via a 
case study. The results of such application are compiled, analysed, and discussed in 
Sect. 4.3. 
4.2 Case Study Data 
As mentioned, the case study’s different cases here addressed have been taken 
from works published by Jonkman et al. (2017, 2019). The original papers focused 
on redesigning and expanding a sugar beet processing AFSC in the Netherlands, 
stemming from an expected rise in demand due to changing European legislation 
(Unie, 2011). The data was slightly adapted to better fit the three cases explained 
before. Nonetheless, as most of the data was drawn from an existing SC, it was 
mostly kept intact. Additional data was also retrieved from the work published by 
Cardoso et al. (2015); Ribeiro and Barbosa-Póvoa (2018). 
The SC includes two processing facilities (factories), located in Dinteloord (F1) 
and Vierverlaten (F2), and two potential processing facilities, one equipped with 
conventional technology, located in Puttershoek (F3), and one with a small-scale 
biorefinery technology, located in Roosendaal (F4). The processing echelon is 
served by 43 suppliers (S1–S43), each with 1000 ha allocated to the plantation 
of sugar beet (for specific data on the location of the suppliers, please refer to 
Fig. 3). The distribution echelon includes four facilities, located in Rotterdam (W1), 
Eindhoven (W2), Drachten (W3), and Apeldoorn (W4) and serves a total of 17 
markets (M1–M17). For the third case, the reprocessing echelon corresponds to 
facilities F1, F2, and eventually F3, in which reprocessing technologies are installed. 
The locations of these facilities are depicted in Fig. 3. 
The SC uses sugar beet (p1) and beet leaves (p2) as raw materials, originating 
in the supplying echelon. Each supplier has a typical sugar beet yield of 80 ton/ha 
in the first time period (Jonkman et al., 2019) and a beet leaves yield of 30 ton/ha 
in the first time period (assumed for this work). Alongside the SC, the two raw 
materials are processed into white sugar (p3), raw sugar (p4), ethanol (p5), biogas 
(p6), molasses (p7), beet pulp (p8), lime fertiliser (p9), and tare soil (p10). In Case88 J. Pires-Ribeiro et al.
Fig. 3 Location of the facilities within the sugar beet SC. Suppliers are marked in blue, existing 
processors in red, the potential conventional processor in green, the potential biorefinery processor 
in purple, warehouses/distributors in brown, and markets/retailers in orange 
C, tare soil can be sold to end consumers or sent to the reprocessing echelon, where 
it can be used as a raw material to produce other agri-products (p11). 
The processing echelon is initially equipped with a conventional processing 
technology (i1) which converts sugar beet into white sugar, generating lime 
fertiliser, beet pulp, molasses, and tare soil as by-products. However, a small-scale 
biorefinery technology (i2) can also be implemented, whereby sugar beet and beet 
leaves are converted into raw sugar, generating ethanol, biogas, and tare soil as by￾products. Additionally, the raw sugar can be sold as is or converted into white sugar 
and molasses via a sugar refining technology (i3). Finally, in Case C, an additional 
technology (i4) is installed, accounting for reprocessing tare soil into other agri￾products. The product inputs and outputs for all four technologies are depicted 
in Fig. 4. Furthermore, Table 1 introduces the sale prices of all products in final 
markets in the first time period. For the raw materials, prices of EUR 25.3/tonneAgri-food Supply Chain: An Optimisation Approach for Waste Valorisation 89
Fig. 4 Product inputs and outputs for all processing and reprocessing technologies 
Table 1 Sale prices of final 
products to end consumers 
Product Sale price to end consumer (EUR/ton) 
p3 500.00 
p4 450.00 
p5 400.00 
p6 90.00 
p7 150.00 
p8 45.00 
p9 6.00 
p10 10.00 
p11 84.10 
and EUR 7.67/tonne are set for sugar beet and beet leaves for the first time period, 
respectively. 
As far as storage capacity is concerned, all entities are given the possibility 
to keep inventory. However, storage capacity is much higher in warehouses when 
compared to the rest of the SC. Warehouses W1 and W3 begin with a storage 
capacity of 450 tonnes per time period and W2 and W4 with 300 tonnes per time 
period. On the other hand, suppliers, processors, and markets begin with a storage 
capacity of 2 tonnes per time period (Cases B and C). Furthermore, in each time 
period, entities are allowed to expand their storage capacity. Again, warehouse 
capacity expansions can be wider than those of the remaining SC players. Maximum 
expansions of 50 tonnes per time period and 2 tonnes per time period are allowed 
for warehouses and all remaining SC players, respectively. As capacity expansions 
should be optional, depending on the conditions of the SC, the minimum capacity 
expansion was set to zero for all entities. 
Similarly, entities with technologies are also dependent on technology capacity 
(i.e. maximum processing capacity). Entities F1 and F2 operate with processing 
capacities of 9125 kton/year and 3650 kton/year, respectively. F1 and F2 can also90 J. Pires-Ribeiro et al.
Table 2 Summary of annual fixed costs and processing costs depending on facility design and 
installed capacity 
Annual capacity Annual fixed Processing cost (EUR/ton) 
Facility design (kton) cost (M EUR) i1 i2 i3 i4 
Conventional 9125 8.33 62.3 – 12.9 10.6 
5475 5 63.36 – – 10.78 
3650 3.67 65.49 – – 10.96 
Biorefinery 5475 5 – 63.36 – – 
3650 3.67 – 65.49 – – 
2190 2.67 – 69.53 – – 
expand their i1 processing capacity by 100 kton/year. Technology expansions should 
be optional depending on the needs of the SC, for which a minimum expansion 
capacity of zero was set for all entities. Additionally, F1 has an initial sugar 
refining (i3) capacity of 1000 kton/year. It is important to note that the small-scale 
biorefinery design (i2) is not initially installed in any entity. As such, the possibility 
of opening a facility using this design is also explored. In this case, the facility 
can begin operations with a technology capacity between 500 kton/year and 1000 
kton/year. Likewise, the possibility of opening another conventional processing 
facility is explored. In this case, possible starting technology (i1) capacities of 9125 
kton/year, 5475 kton/year, or 3650 kton/year are considered. Table 2 summarises 
the annual fixed costs of each facility design and technology capacity. 
The case considers three time periods of 1 year each; thus modelling the SC for 
a total of 3 years and a minimum demand satisfaction level of 90% is required for 
each time period. Additionally, product inventories are set to zero for all entities, 
the turnover ratio for all entities is set at 20, the parameter lvlv,s,t is set to 2 for 
all entities, and storage costs of EUR 0.30/tonne are assumed for the entirety of the 
SC. The interest rate, salvage value, and tax rate are fixed at 10%, 20%, and 30%, 
respectively. 
In terms of transportation, contracting costs are set at EUR 200 for each 
contracted route, and variable costs are set at EUR 0.05/ton.km. 
Product spoilage due to perishability, harvesting losses, and supply and demand 
mismatch losses in farms all set at 5%. In reprocessing entities, 90% of incoming 
waste is converted to final product. 
All costs increase by 1% per time period, and, as previously described, supply 
and demand are subject to uncertainty in all cases. A stochastic scenario tree was 
established to account for demand uncertainty and support the mimicking of supply 
uncertainty. Figure 5 depicts the scenario tree, and Table 3 includes reference to 
the probability of occurrence of each node, as well as associated variation rates in 
supply and demand. As can be seen, a trending increase in demand was modelled, 
with 5% and 10% variations occurring depending on the scenario. Similarly, supply 
variation losses of 5% and 10% have been added, with the final scenario tree 
accounting for all combinations of supply losses and demand increase.Agri-food Supply Chain: An Optimisation Approach for Waste Valorisation 91
Fig. 5 Stochastic scenario tree. Each scenario(s) branches into four possible scenarios in the 
following time period. Each scenario is associated with a specific occurrence probability and 
includes either a 5% or 10% demand increase in comparison to the previous time period, as well 
as a 5% or 10% decrease in supply due to crop-growth variations 
Other important variables for the calculation of the objective function pertain to 
initial installation costs and variables costs for both storage and technology capacity. 
Tables 4 and 5 summarise initial investment and variable costs for storage and 
technology, respectively. 
It should be noted that Tables 4 and 5 only refer to the costs incurred in the first 
time since costs were assumed to increase by 1% from one time period to the next. 
Additionally, it is important to mention that the initial investment and variable costs 
relating to technology i4 were not available in the consulted literature and have been 
assumed by force of necessity. 
Apart from the costs, and returning attention to the scenario tree, it can be seen 
that the first scenario (node s1) is deterministic. Upon this node, the remaining 
variations are applied, giving rise to the stochastic scenarios where uncertainty is 
indeed considered. As a deterministic node, the initial supply and demand do not 
suffer variations, as can be seen in Table 3, and are then known values. Mention 
has been given to the state of supply, in the form of arable areas and corresponding 
product yields. Adding to this, the different sources of loss have also been specified 
in this section. To complement such data, Table 6 summarises the deterministic 
demand values for each product in each retailer.92 J. Pires-Ribeiro et al.
Table 3 Information pertaining to the stochastic scenario tree 
Corresponding Occurrence Supply Demand 
Node time period probability (%) variation rate (%) variation rate (%) 
s1 t1 100 0 0 
s2 t2 12.5 −5 +5 
s3 t2 50 −5 +10 
s4 t2 25 −10 +5 
s5 t2 12.5 −10 +10 
s6 t3 6.25 −5 +5 
s7 t3 3.125 −5 +10 
s8 t3 6.25 −10 +5 
s9 t3 6.25 −10 +10 
s10 t3 6.25 −5 +5 
s11 t3 3.125 −5 +10 
s12 t3 12.5 −10 +5 
s13 t3 6.25 −10 +10 
s14 t3 3.125 −5 +5 
s15 t3 6.25 −5 +10 
s16 t3 3.125 −10 +5 
s17 t3 12.5 −10 +10 
s18 t3 3.125 −5 +5 
s19 t3 3.125 −5 +10 
s20 t3 6.25 −10 +5 
s21 t3 12.5 −10 +10 
Table 4 Initial and variable costs pertaining to storage capacity in the first time period 
Entity Initial investment costs (EUR/capacity unit) Variable costs (EUR/ton) 
S1-S43 0.10 1.95 
F1-F4 0.10 1.95 
W1 1.00 2.10 
W2 1.00 2.15 
W3 1.00 2.13 
W4 1.00 1.95 
M1-M17 0.10 1.95 
A brief analysis of Table 6 concludes that product demand was uniform among 
retailing agents. Although this does not correspond to what is seen in reality, in 
which consumer habits depend on culture and geographic location, it was deemed 
an acceptable simplification of the input data.Agri-food Supply Chain: An Optimisation Approach for Waste Valorisation 93
Table 5 Initial and variable costs pertaining to technology capacity in the first time period 
Entity Technology Initial investment costs (EUR/capacity unit) Variable costs (EUR/ton) 
F1 i1 1.00 5.24 
i3 0.90 8.00 
i4 0.60 3.73 
F2 i1 1.00 7.68 
i3 0.90 8.00 
i4 0.60 3.73 
F3 i1 1.00 6.28 
i3 0.90 8.00 
i4 0.60 3.70 
F4 i2 1.30 9.62 
Table 6 Deterministic 
demand values for the first 
time period 
Entity Product Demand (ton) 
M1-M17 p3 4246 
p4 555 
p5 83 
p6 696 
p7 368 
p8 831 
p9 238 
p10 293 
p11 7650 
Table 7 ENPV obtained for each case 
Case 
Metric Case A Case B Case C 
Expected net present 3,074,961.95 3,080,248.23 4,053,404.26 
value (EUR) 
4.3 Results and Discussion 
As mentioned, the model developed and discussed is designed to maximise the 
ENPV, an economic maximisation objective. Table 7 displays each of the three 
cases’ ENPV (final objective value). 
The results from Table 7 seem to agree with what was expected. Each case 
is defined based on the previous one, adding additional features which would, in 
theory, improve the performance of the SC in an agri-food context. This translates, 
naturally, to an increase in the observed ENPV. The economic performance between 
Cases A and B is not remarkably different. The added storage capacity throughout 
the SC can help prevent product wastage, but only up to a certain level, as product 
perishability prevents keeping high inventory levels. Still, as can be seen, this added 
storage capacity impacts the economic performance positively, even if not strikingly.94 J. Pires-Ribeiro et al.
However, the same does not hold for Case C, where a considerably higher financial 
performance is achieved. Even though further analysis needs to be conducted to 
confirm this, it may be argued that, at first glance, this fact goes well in line with 
current trends, in which reverse logistics are identified as a promising area in AFSC. 
An extensive analysis of the results is conducted to understand better the causes of 
such differences in the objective value. 
4.3.1 Results Analysis 
To improve the clarity of the information provided, this section presents the 
results for each case individually. The individual data is then brought together 
and discussed in further sections. The three cases correspond to possible operating 
models of the SC, modelling different storage policies in Cases A and B, while Case 
C considers the investment in reprocessing processes. 
Case A 
Case A corresponds to the case where storage is solely allowed in ware￾houses/distributors. Hence, this is the simplest of the three cases and, naturally, 
has the lowest registered ENPV (as the features added to Cases B and C are targeted 
at improving SC performance at the economic level). Table 8 highlights the major 
economic variables used as auxiliary data to obtain the maximum ENPV. 
As seen in Table 8, the initial investment is complemented with additional 
investment in the second time period (expansion of technology capacity and/or 
expansion of storage capacity). No additional expansions are registered for the third 
time period. The depreciation costs incurred per time period corresponding to the 
fraction of the fixed investment which does not fall under the salvage value of said 
investment divided equally between all existing time periods (linear depreciation is 
considered). 
One other important detail is the increase in ENE throughout the time periods. 
This goes well in line with the model’s expected behaviour, as the SC’s expansion 
derives from an expected increase in demand and, consequently, in supply, which 
ultimately translates into higher sales (and revenues). 
Apart from the economic indicators used to assess the ENPV, other features of 
interest can be analysed. Namely, technology and storage usage and capacity vary 
Table 8 Results for major 
economic variables for Case 
A 
Variable Value (EUR) 
Fixed capital investment (t1) 13,981,000.00 
Capital investment (t2) 437,325.00 
Capital investment (t3) 0.00 
Expected net earnings (t1) 6,291,700.00 
Expected net earnings (t2) 6,972,600.00 
Expected net earnings (t3) 7,032,200.00 
Depreciation costs per time period 3,728,300.00 Agri-food Supply Chain: An Optimisation Approach for Waste Valorisation 95
Table 9 Storage-related results for Case A 
Capacity expansion (ton) Average inventory level (ton) 
Entity Initial storage capacity (ton) t1 t2 t3 t1 t2 t3 
W1 450 50 50 0 350 380 510 
W2 300 50 50 0 275 300 300 
W3 450 50 50 0 350 375 475 
W4 300 50 50 0 250 310 310 
Table 10 Technology-related results for Case A 
Initial processing Capacity expansion (ton) Average production (ton) 
Entity Technology capacity (ton) t1 t2 t3 t1 t2 t3 
F1 i1 9,125,000 0 125,000 0 58,500 64,350 69,850 
i3 1,000,000 0 0 0 9,550 10,350 10,350 
F2 i1 3,650,000 0 234,000 0 40,950 46,800 50,800 
i3 0 500,000 123,000 0 5450 6800 6800 
F3 i1 0 0 0 0 0 0 0 
i3 0 0 0 0 0 0 0 
F4 i2 0 785,500 0 0 32,500 34,750 36,150 
depending on the needs of the SC. Tables 9 and 10 summarise the major storage and 
technology-related variables, respectively. 
Storage capacity expansions of 50 tonnes are registered for all existing ware￾houses in the two first time periods (this goes well in line with previously discussed 
economic parameters, in which no investment costs are seen in the final time period). 
Consequently, warehouses W1 and W3 finish with storage capacities of 550 tonnes 
and warehouses W2 and W4 with storage capacities of 400 tonnes. It has been 
mentioned that an expected increase in supply and demand is pushing for the SC 
expansion, which in turn leads to higher sales volumes. Naturally, higher sales 
require higher production and distribution, which require additional storage. The 
data follows this trend, with average inventory levels going up from one time period 
to the next, even though average levels are kept constant in W2 and W4 from the 
second to the third time periods. 
It should be noted that the strategic decision not to open facility F3 is taken. 
Instead, capacity expansion is performed in already existing locations F1 and F2, 
bearing the same technologies as the eventual facility F3. In parallel, the biorefinery 
technology is installed, represented by facility F4, which is opened in the first time 
period and operates unchanged throughout the modelled horizon. Secondly, it can 
be seen that entity F1 performs a capacity expansion of the conventional technology 
(i1) in the second time period, to cope with increasing production necessities 
(note that the average production increases steadily throughout). As processing 
requirements vary only slightly for technology i3, one single expansion is registered 
for entity F2. Again, no investment is performed in the final period.96 J. Pires-Ribeiro et al.
Table 11 Results for major 
economic variables for Case 
B 
Variable Value (EUR) 
Fixed capital investment (t1) 13,996,000.00 
Capital investment (t2) 453,705.00 
Capital investment (t3) 0.00 
Expected net earnings (t1) 6,293,600.00 
Expected net earnings (t2) 6,975,400.00 
Expected net earnings (t3) 7,035,100.00 
Depreciation costs per time period 3,728,600.00 
Table 12 Storage-related results of warehouses for Case B 
Capacity expansion (ton) Average inventory level (ton) 
Entity Initial storage capacity (ton) t1 t2 t3 t1 t2 t3 
W1 450 50 50 0 315 335 485 
W2 300 50 50 0 240 260 260 
W3 450 50 50 0 315 330 335 
W4 300 50 50 0 215 270 270 
Case B 
Case B is very similar to Case A, but storage capacity is allowed in every SC 
echelon, although in significantly lower amounts when compared to the ware￾house/distribution echelon. The added storage prevents product perishability (up to 
a certain reasonable level) and slightly improves the economic performance of the 
model. Table 11 highlights the major economic variables used as auxiliary data to 
obtain the maximum ENPV. 
In Case B, as in Case A, investment occurs solely in the first and second time 
periods. The economic variables assume slightly higher values when compared 
to Case A, precisely due to higher storage costs. This comes naturally from the 
additional storage capacity installed in every entity of every echelon. As mentioned, 
the improved scattered storage capacity supports the reduction of losses due to 
product perishability, allowing larger product quantities to be available at any given 
time. In turn, this reality is translated into higher sales and, consequently, higher 
ENE (several thousand euros). 
Tables 12 and 13 present storage-related parameters, and Table 14 displays 
technology-related parameters. 
The performance of the storage echelon is very similar to that verified in Case 
A, with the same capacity expansions taking place and average inventory levels 
behaving in the same manner. Nonetheless, it should be noted that, although average 
inventory level variation is similar, the observed values are lower when compared to 
their Case A counterparts. Such reduction stems from the additional storage capacity 
spread across the remaining SC players. 
Table 13 summarises the storage behaviour for all remaining SC entities, i.e. all 
SC entities which do not possess storage capacity in Case A. As can be seen, the 
initial storage level is sufficient for most entities to respond positively to storageAgri-food Supply Chain: An Optimisation Approach for Waste Valorisation 97
Table 13 Storage-related results of non-warehouses for Case B 
Capacity expansion (ton) Average inventory level (ton) 
Entity Initial storage capacity (ton) t1 t2 t3 t1 t2 t3 
S1-S39 2 0 0 0 0.71 0.77 0.77 
S40-S43 2 2 2 0 2.10 4.30 5.20 
F1-F4 2 0 0 0 0.71 0.77 0.77 
M1-M17 2 0 0 0 0.71 0.77 0.77 
Table 14 Technology-related results for Case B 
Initial processing Capacity expansion (ton) Average production (ton) 
Entity Technology capacity (ton) t1 t2 t3 t1 t2 t3 
F1 i1 9,125,000 0 125,000 0 58,500 64,350 69,850 
i3 1,000,000 0 0 0 9,550 10,350 10,350 
F2 i1 3,650,000 0 234,000 0 40,950 46,800 50,800 
i3 0 500,000 123,000 0 5450 6800 6800 
F3 i1 0 0 0 0 0 0 0 
i3 0 0 0 0 0 0 0 
F4 i2 0 785,500 0 0 32,500 34,750 36,150 
necessity across all time periods, as capacity expansion is only observed in four 
locations. Suppliers S40 to S43 suffer expansions of 2 tonnes in both the first 
and second time periods, thus increasing their total storage capacity to 6 tonnes 
at the end of the modelled horizon. As can be seen, the average inventory levels 
stay slightly below maximum capacity for all entities. Suppliers S40 to S43 are all 
located near areas with intense retailer presence, which is why the expansions occur 
in these locations, as the higher average inventory requires additional transportation. 
By featuring shorter distances between entities, the transportation costs are then 
minimised. 
As can be observed, technology-related behaviour is identical for Cases A and 
B. Such case stems from the nature of the additional storage capacity, which occurs 
mainly at the supplier and retailer levels. Suppliers and retailers can store products 
for fixed (short) periods of time, thus better preserving products and minimising 
the negative impact of perishability. However, since Case B is similar to A in all 
data except for storage capacity, demand for products is the same, and consequently, 
product production is identical. However, it should be noted that, by preventing more 
loss, Case B features a higher met demand percentage when compared to Case A. 
Case C 
Case C is the most dissimilar to Cases A and B, as it includes one additional echelon 
in the SC. The additional echelon performs reprocessing operations to transform 
otherwise wasted products into other commercially valuable ones. As such, Case 
C imposes a higher number of products, technologies, and product flows when 
compared to its counterparts.98 J. Pires-Ribeiro et al.
Table 15 Results for major 
economic variables for 
Case C 
Variable Value (EUR) 
Fixed capital investment (t1) 14, 882, 000.00 
Capital investment (t2) 455, 240.50 
Capital investment (t3) 0.00 
Expected net earnings (t1) 6, 994, 300.00 
Expected net earnings (t2) 7, 744, 200.00 
Expected net earnings (t3) 7, 809, 900.00 
Depreciation costs per time period 3, 968, 600.00 
Table 16 Waste disposal costs for each case 
Case 
Variable Case A Case B Case C 
Waste disposal cost (EUR) 128,123.41 95,265.41 40,943.48 
As the added echelon provides other commercially beneficial operations, it is 
natural that the corresponding economic optimisation also bears better results, as 
can be seen by the maximum ENPV, which is considerably higher than the ones 
registered for Cases A and B. Table 15 highlights the significant economic variables 
used as auxiliary data to obtain the maximum ENPV. 
As expected, the initial investment is highest for Case C, as it builds upon Case B 
by adding a set of reprocessing technologies with corresponding installation costs. 
The capital investment for the second time period increases slightly when compared 
to that of Case B, from which it can be concluded that additional investment was 
made to expand either storage capacity or technology capacity. 
Knowing that the reverse logistics activities allow for a certain fraction of existing 
waste to be turned into other commercially viable products, it is possible to see that 
ENE for Case C are highest among the three cases. Two different factors explain 
such fact. First, a fraction of otherwise wasted product (which has no value) is turned 
into sales, thus increasing revenues. Second is due to diminished costs. As seen 
in Eq. 4, waste disposal implicates costs that need to be supported by the SC. By 
reducing the amount of waste, new products become available for retailing, and 
disposal costs are reduced simultaneously, thus achieving better performance in both 
revenue maximisation and cost-cutting. To better highlight this situation, Table 16 
presents the waste disposal costs for all three cases. 
The decreasing waste disposal costs align well with the notion that each case 
improves on the previous. Case B includes more flexible and readily available 
storage capacity, thus better addressing perishability and reducing waste. However, 
a considerably higher difference exists between Case C and the other cases, as 
reverse logistics activities greatly reduce the final waste, which cannot be subject 
to reprocessing. 
Tables 17 and 18 present storage-related parameters, and Table 19 displays 
technology-related parameters.Agri-food Supply Chain: An Optimisation Approach for Waste Valorisation 99
Table 17 Storage-related results of warehouses for Case C 
Capacity expansion (ton) Average inventory level (ton) 
Entity Initial storage capacity (ton) t1 t2 t3 t1 t2 t3 
W1 450 50 50 0 375 395 545 
W2 300 50 50 0 300 320 320 
W3 450 50 50 0 375 390 395 
W4 300 50 50 0 275 330 330 
Table 18 Storage-related results of non-warehouses for Case C 
Capacity expansion (ton) Average inventory level (ton) 
Entity Initial storage capacity (ton) t1 t2 t3 t1 t2 t3 
S1-S39 2 0 0 0 0.71 0.77 0.77 
S40-S43 2 2 2 0 2.10 4.30 5.20 
F1-F3 2 2 2 0 3.60 5.80 5.90 
F4 2 0 0 0 0.71 0.77 0.77 
M1-M17 2 0 0 0 0.71 0.77 0.77 
The results in Table 17 show a very similar storage behaviour to what is observed 
in the previous cases. The major difference is the average inventory level, which is 
higher due to the additional necessity of storing the reprocessed products (in this 
case, p11). 
The results from Table 18 shed light on the increased investment made in the 
second time period. As can be seen, storage capacity for non-warehouse entities 
behaves similarly to what is seen in Case B, except for the processing echelon, in 
which capacity expansions are also observed in the first and second time periods. 
The reprocessing echelon in this case study corresponds to the processing echelon, 
as the reprocessing technology (i4) is installed in entities F1-F3. As such, seeing 
storage capacity expansions in the entities where the additional product is being 
processed does not come as a surprise. Storing products near its origin helps prevent 
incurring in further transportation costs. This is further confirmed by entity F4 (the 
small biorefinery facility), in which the reprocessing technology is not installed 
which remains without further storage capacity expansions. 
Again, it can be observed that the model prefers expanding the capacity of 
existing infrastructure rather than installing a new facility (F3). The behaviour of 
technologies i1-i3 remains unchanged, but adding a reprocessing technology (i4) 
gives rise to new observations. It should be noted that the reprocessing technology 
is installed from the start in entities F1 and F2, and capacity expansions are not 
necessary throughout the modelled horizon. 
At first glance, the average production of this new reprocessing technology may 
seem abnormally high compared to the remaining products. For instance, in entity 
F1 it exceeds even the production of white sugar via i1 (Table 19). However, a more 
careful analysis identifies p11 (the reprocessed, commercially viable product) as 
‘other agri-products’. Product p10 corresponds to soil tare, which can be used to100 J. Pires-Ribeiro et al.
Table 19 Technology-related results for Case C 
Initial processing Capacity expansion (ton) Average production (ton) 
Entity Technology capacity (ton) t1 t2 t3 t1 t2 t3 
F1 i1 9,125,000 0 125,000 0 58,500 64,350 69,850 
i3 1,000,000 0 0 0 9,550 10,350 10,350 
i4 1,000,000 0 0 0 87,000 95,700 95,700 
F2 i1 3,650,000 0 234,000 0 40,950 46,800 50,800 
i3 0 500,000 123,000 0 5450 6800 6800 
i4 500,000 0 0 0 43,350 54,090 54,090 
F3 i1 0 0 0 0 0 0 0 
i3 0 0 0 0 0 0 0 
i4 0 0 0 0 0 0 0 
F4 i2 0 785,500 0 0 32,500 34,750 36,150 
Table 20 Percentage of 
unmet demand obtained for 
each case 
Case 
Variable Case A Case B Case C 
Unmet demand (%) 9.80 7.60 6.50 
produce fertilisers and enrich arable land. Technology i4 harnesses the fertilising 
properties of p10 and allows for other products to be grown using it. As such, p11 
corresponds to a myriad of other vegetal crops which can be grown using soil tare. 
As p11 accounts for a broad set of possible vegetal crops and considering such crops 
to be the output of technology i4, a higher product output is acceptable and natural. 
Unmet Demand 
Some results of each case have been compared to those from other cases to better 
comprehend the results obtained and the influence of the different changes operated 
within the SC. Another important factor that should be considered when assessing 
the performance of the different cases is the level of unmet demand. The unmet 
demand is important for two major reasons. Firstly, the existence of unmet demand 
implies a potential source of revenue is not being utilised, which in turn lowers the 
economic performance of the SC as a whole. Secondly, the unmet demand can also 
be utilised to infer the SC’s perceived customer service to the client. As customer 
orders are not fully complied with, the more likely it is for that customer to lose 
trust in the SC (or a part of its actors) and search for other business opportunities, 
negatively impacting the SC’s sources of revenue. As such, the lower the percentage 
of unmet demand, the better. Table 20 summarises the percentages of unmet demand 
obtained for each case. 
Before further analysis, it should be noted that a minimum percentage of demand 
satisfaction of 90% is imposed to the model (as mentioned before) to ensure 
a minimum acceptable level is achieved at all times. In Case A, the minimum 
percentage is barely achieved (90.20% demand satisfaction). Increased demand 
satisfaction is registered between Cases A and B, as the additional scattered 
storage capacity in Case B reduces waste (see Table 16) and improves demandAgri-food Supply Chain: An Optimisation Approach for Waste Valorisation 101
fulfilment. Finally, an additional increase in demand satisfaction is seen between 
Cases B and C, as the reverse logistics activities provide further waste reduction and 
generate resources that can be applied to other productive activities, thus positively 
impacting the available quantities for sale. Again, the unmet demand variation 
further consolidates the beneficial impact of the successive improvements made to 
the SC and tested via Cases A, B, and C. 
4.3.2 Results Summary 
This section summarises the significant differences between the three cases and 
uses such differences to make a case for the improved performance the modelling 
approach provides. Table 21 provides a snapshot of the three cases’ major differ￾ences. 
As seen in Table 21, each case builds upon the previous one by adding an 
improvement to either the technological or storage-related approach. By adding 
more flexible storage options, Case B mitigates part of the product perishability 
issues to which Case A cannot respond positively, thus improving the model’s 
environmental and economic performance. Similarly, Case C improves on the per￾formance of Case B by incorporating reverse logistics, further reducing the amount 
of wasted product and improving on the economic performance by transform￾ing non-valuable waste into commercially viable goods. Although improvement 
between Cases A and B is undeniable, the progress caused by the addition of reverse 
logistics activities is considerably more impactful, a finding which goes well in 
line with the current state of the art. When investing in reverse logistics, there is 
a positive contribution to the environment due to the better use of materials and a 
benefit in economic gains. 
Table 21 Differences between the three cases 
Case Technology-related approach Storage-related approach 
Case A Three processing technologies, without 
reprocessing possibility 
Storage is allowed at the 
warehouses/distributors echelon 
Case B Three processing technologies, without 
reprocessing possibility 
Storage in warehouses is complemented 
with minor and flexible storage in every 
single echelon 
Case C Four processing technologies, including a 
reprocessing technology to incorporate 
reverse logistics 
Storage in warehouses is complemented 
with minor and flexible storage in every 
single echelon 102 J. Pires-Ribeiro et al.
5 Conclusions and Future Research Steps 
The three cases analysed herein are mostly taken from an existing sugar beet SC 
in the Netherlands, for which a considerable portion of the data is realistic. Even 
though some of the data was assumed or derived from other publications, and 
the three cases were designed to fit the study’s intent, the results can be seen as 
considerably realistic, a trait which further improves their relevance. As such, it is 
possible to affirm that the model proposed herein serves as an improved modelling 
tool for the specific context of AFSC, in which literature has been documented as 
scarce. This new improved approach can then serve two major objectives. Firstly, 
it directly targets existing knowledge gaps. Secondly, it highlights other limitations 
and lack of research on the specific AFSC context, stimulating other researchers to 
build upon these findings with further investigative work. 
Future work can be done to improve its representation of real SC and the 
challenges faced by decision-makers. One further step would be to implement the 
full spectrum of TBL concerns. Another possible improvement is studying other 
AFSC-specific characteristics, such as comparing the performance of centralised 
and decentralised SC configurations, adding specific cold chain features, and 
inserting product traceability concerns, among others. Again, it is essential to 
remember that each additional feature further increases the complexity of the 
problem, which then needs to be modelled, incurring consequent challenges. 
As main results, it can be said that AFSC is one of SC’s fields where proper 
management can directly lead to relevant improvements in people’s lives. Turning 
these SC more efficient can lead to less waste, cost reductions, and a more resilient 
food supply. The challenges when addressing this topic result from these systems’ 
particularities, from farm to sale point. This work aims to identify and propose a 
new model to aid decision-making in AFSC properly. 
Here a novel approach is presented to the challenge of design and planning of 
AFSC, considering different possible SC characteristics (from forward to close-loop 
SC) and uncertainty in perishability and demand. The MILP model, presented in 
Sect. 3, aims at providing a generic tool to be used by decision-makers, adapted 
to each SC, therefore providing insights on better strategies for SC planning and 
design. 
In this work, a case study is presented to demonstrate the model’s applicability 
and provide a discussion on results that can be used by academics and practitioners 
alike. 
AFSC have space for improvement as it can be concluded that adding features 
such as more widely available storage capacity and reverse logistics positively 
contribute to the objective of economic performance optimisation. 
Reverse logistics are now among the most prominent responses to increasing 
environmental concerns and on the forefront of sustainability objectives and waste 
reduction. Here, the superior economic performance of Case C brings new light into 
this paradigm, as it clearly shows reverse logistics are not only a powerful tool toAgri-food Supply Chain: An Optimisation Approach for Waste Valorisation 103
improve the environmental performance of AFSC (waste reduction), but also serve 
as a meaningful contributor to better economic performance. 
Flexible storage offers several benefits in the context of AFSC. One of the 
main advantages is the ability to manage inventory levels effectively. This is 
particularly important in the agri-food industry, where products have a limited shelf 
life and require specific storage conditions. In addition, flexible storage options can 
improve the responsiveness of the AFSC, as those solutions might enable faster and 
more efficient handling of products, helping in reducing lead times and improving 
customer service levels. 
Acknowledgments The authors acknowledge the support provided by FCT and P2020 under the 
project PTDC/EGEOGE/28071/2017, Lisboa -01.0145-Feder-28071 and SFRH/BD/148499/2019. 
This work is financed by national funds through the FCT—Foundation for Science and Technology, 
I.P., under the project UIDB/00097/2020. 
References 
Alcamo, J., Flörke, M., & Märker, M. (2007). Future long-term changes in global water resources 
driven by socio-economic and climatic changes. Hydrological Sciences Journal, 52(2), 247– 
275. 
Bai, Z. G., Dent, D. L., Olsson, L., & Schaepman, M. E. (2008). Global assessment of land 
degradation and improvement: 1. Identification by remote sensing. Tech. rep., ISRIC-World 
Soil Information. 
Blackburn, J., & Scudder, G. (2009). Supply chain strategies for perishable products: The case of 
fresh produce. Production and Operations Management 18(2), 129–137. 
Cardoso, S. R., Barbosa-Póvoa, A. P., Relvas, S., & Novais, A. Q. (2015). Resilience metrics in 
the assessment of complex supply-chains performance operating under demand uncertainty. 
Omega, 56, 53–73. 
Combe, I., Dreyer, B., & Grønhaug, K. (2012). Coping with unpredictable supply: The role of 
flexibility and adaptation. European Journal of Marketing, 46(10), 1268–1282. 
European Commission. (2017). Monitoring EU Agri-Food Trade: Development in 2017 2017: 
Another record year for EU agri-food exports. 
European Parliament. (2017). Food waste: The problem in the EU in numbers. Euro￾pean Parliament (pp. 15–17). https://www.europarl.europa.eu/news/en/headlines/society/ 
20170505STO73528/food-waste-the-problem-in-the-eu-in-numbers-infographic 
Joint FAO/WHO Expert Committee on Food Additives. Meeting and Joint FAO/WHO Expert 
Committee on Food Additives and World Health Organization. (2004). Evaluation of certain 
food additives and contaminants: Sixty-first report of the Joint FAO/WHO Expert Committee 
on Food Additives (Vol. 61). World Health Organization. 
Galal, N., & El-Kilany, K. (2016). Sustainable agri-food supply chain with uncertain demand and 
lead time. International Journal of Simulation Modelling, 15(3), 485–496. 
Gallage, N. J., & Møller, B. L. (2015) Vanillin–bioconversion and bioengineering of the most 
popular plant flavor and its de novo biosynthesis in the vanilla orchid. Molecular Plant, 8(1), 
40–57. 
Goedde, L., Horii, M., & Sanghvi, S. (2015). Pursuing the global opportunity in food and 
agribusiness. Tech. rep., McKinsey Global Institute. 
Govindan, K., Jafarian, A., Khodaverdi, R., & Devika, K. (2014). Two-echelon multiple-vehicle 
location–routing problem with time windows for optimization of sustainable supply chain 
network of perishable food. International Journal of Production Economics, 152, 9–28.104 J. Pires-Ribeiro et al.
Gustavsson, J., Cederberg, C., Sonesson, U., Van Otterdijk, R., & Meybeck, A. (2011). Global 
food losses and food waste. 
Huber, J., Gossmann, A., & Stuckenschmidt, H. (2017). Cluster-based hierarchical demand 
forecasting for perishable goods. Expert Systems with Applications, 76, 140–151. 
Jonkman, J., Bloemhof, J. M., Van der Vorst, J. G., & van der Padt, A. (2017). Selecting food 
process designs from a supply chain perspective. Journal of Food Engineering, 195, 52–60. 
Jonkman, J., Barbosa-Póvoa, A. P., & Bloemhof, J. M. (2019). Integrating harvesting decisions 
in the design of agro-food supply chains. European Journal of Operational Research, 276(1), 
247–258. 
Kearney, J. (2010). Food consumption trends and drivers. Philosophical Transactions of the Royal 
Society B: Biological Sciences, 365(1554), 2793–2807. 
Kusumastuti, R. D., Van Donk, D. P., & Teunter, R. (2016). Crop-related harvesting and processing 
planning: A review. International Journal of Production Economics, 174, 76–92. 
Ribeiro, J. P., & Barbosa-Póvoa, A. (2018). Modelling and analysing supply chain resilience flow 
complexity. In: A. Friedl, J. J. Klemeš, S. Radl, P. S. Varbanov, & T. Wallek (Eds.), 28th 
European Symposium on Computer Aided Process Engineering, Computer Aided Chemical 
Engineering (Vol 43, pp. 815–820). Elsevier. https://doi.org/10.1016/B978-0-444-64235-6. 
50143-1. http://www.sciencedirect.com/science/article/pii/B9780444642356501431 
Schwab, K. (2017). The fourth industrial revolution. Currency. 
Shabani, A., Saen, R. F., & Torabipour, S. M. R. (2012). A new benchmarking approach in cold 
chain. Applied Mathematical Modelling, 36(1), 212–224. 
Smith, B. G. (2008). Developing sustainable food supply chains. Philosophical Transactions of the 
Royal Society B: Biological Sciences, 363(1492), 849–861. 
Stenmark, Å., Jensen, C., Quested, T., & Moates, G. (2016). Estimates of European food waste 
levels. IVL-report C 186. 
Unie, S. (2011). Long-term stability of the european sugar sector, also after 2015; posi￾tion paper Dutch sugar sector. http://www.suikerunie.nl/getmedia/b86833a6-35c4-46c9-8242-
2572378df21c/Position-paper-Dutch-sugar-sector.pdf 
Van der Vorst, J. G., Da Silva, C. A., & Trienekens, J. H. (2007). Agro-industrial supply chain 
management: Concepts and applications. 17. FAO Agricultural management, Marketing and 
Finance.Managing Risk in Fresh Produce 
Planning Considering Price Variability, 
Yield Variability, and Regional 
Complementarity 
Miguel Peinado-Guerrero, Omar Ahumada, Rodrigo Ulloa, 
Xaimarie Hernandez-Cruz, Grace Neal, Abhay Jayani, and J. Rene Villalobos 
1 Introduction 
Fresh food supply chains are subject to the same challenges of traditional supply 
chains but with some important and unique considerations. Namely, planning and 
decision-making in the fresh food supply chain must accommodate the perishability 
of the product. Perishability disrupts both supply and demand, making the task of 
planning much more difficult as the variability within each echelon of the supply 
chain compounds. Inherent to this additional variability are price volatility from 
fresh foods delivered by growers and the uncertainty of yield. From the perspective 
of the grower, these factors complicate the task of deciding when and how much 
of each crop to plant to maximize her expected profits. This work covers the 
development of a mathematical model for making planting decisions that are robust 
to the price and yield variability of fresh foods so that growers can maximize 
their expected profit. The utility of the model is highlighted by considering a 
coalition of growers from complementary regions (regions where peak yield occurs 
over a different portion of the year) to pool their resources together and satisfy a 
predetermined contract. 
M. Peinado-Guerrero · O. Ahumada · R. Ulloa · X. Hernandez-Cruz · G. Neal · A. Jayani · 
J. R. Villalobos () 
International Logistics and Productivity Improvement Laboratory, Arizona State University, 
Tempe, AZ, USA 
e-mail: rene.villalobos@tisconsulting.org 
© Springer Nature Switzerland AG 2024 
V. M. Albornoz et al. (eds.), Optimization Under Uncertainty in Sustainable 
Agriculture and Agrifood Industry, https://doi.org/10.1007/978-3-031-49740-7_5
105106 M. Peinado-Guerrero et al.
1.1 Problem Statement 
From a grower’s perspective, there are three main sources of variability that affect 
the income resultant from their planting decisions: the yield per acre obtained for 
each crop planted, the prices received from selling the product, and the total volume 
that can be sold after harvesting (the demand). Tactical planning issues related to 
what to grow and the amount and timing of planting the crop in order to maximize 
expected profits given the risk profile of the grower have previously been addressed 
(Ahumada et al., 2012). Something that remains to be addressed is the issue of 
attenuating the variability by pooling and reallocating the risk in the form of a 
contract portfolio, by including growers from different, complementary regions. 
This is one of the issues explored in this work. 
To begin, it is assumed that there is a market demand that needs to be filled, and 
based on these needs, a contract is developed between a buyer and the grower(s). 
This contract specifies volumes needed to be met by the grower(s) for different 
crops at different points in time. We analyze two basic cases: (1) a single grower 
in a single region fulfills the contract on her own; (2) a coalition of growers who 
span multiple regions jointly fulfill the contract. Given that different regions have 
different growing and harvesting patterns and the price and yield of the products 
are subject to market and weather variations, respectively, this can be a difficult 
problem. We further assume that the contracts must be fulfilled and neither party 
will violate the contract (i.e., the buyer has no incentive to cancel specified demands, 
and the growers have no incentive to leave the contract unfulfilled). Because the 
grower(s) will fulfill the contract, it is further assumed that if they cannot completely 
satisfy the contract with their own resources, they will make purchases from the spot 
market at a price greater than specified by the contract. Similarly, if at any time the 
amount harvested of any crop is greater than the volume specified in the contract, 
the excess may be sold in the spot market for a price lower than the price specified 
in the contract. 
The objective of the model is to maximize the profits of the growers under the 
abovementioned conditions. Though the model used can be adapted to any grower 
by adjusting the set of parameters, it is demonstrated through a case study based 
on growers in the Southwestern United States (Phoenix, Arizona; Aspen, Colorado; 
and Albuquerque, New Mexico). 
1.2 A Brief Review of Previous Work 
Traditionally, agricultural models for supply chains analyze the production, dis￾tribution, and pricing of commodities such as corn, wheat, and soybeans (Glen, 
1987). However, the problem of planning and managing perishable fresh foods is 
much different. Highlighting the added complexity of planning for such products is 
the increased volatility in prices and yields compared to traditional commoditiesManaging Risk in Fresh Produce Planning Considering Price Variability, Yield... 107
(Zuurbier, 1999). The time gap between when a crop is planted and when it is 
harvested is the main source of difficulty. A key point at the time of planning 
planting decisions of fresh foods is to consider the uncertainty of the prices that will 
be received for the crops planted and the yield that will be obtained in the harvesting 
season. It is straightforward to see why these uncertainties impact the decisions of 
which crops to plant, how much to plant, when to plant, and when to harvest and why 
considering these uncertainties calls for hedging against unfavorable conditions. 
In a review, Ahumada and Villalobos (2009) observed that in order to make 
decisions in the face of crop yield and price uncertainty, while also considering 
the perishable nature of the product, new tactical and operational tools needed to 
be developed. The perishability of fresh food products makes it crucial for small 
growers to consider yield and price variability when making planting decisions. 
High price variability and corresponding risk are often associated with higher 
income, but small growers may avoid such crops due to lack of reserves available 
for realizing unattractive prices. They tend to prefer price-stable crops, potentially 
missing out on more profitable opportunities. To address this, decision support 
tools that consider the grower’s risk tolerance and expected price and variability 
at harvest time can help maximize profits while restricting risk. It is important to 
note that the decision of when and how much to plant is not straightforward and 
requires an integral approach, including the use of stochastic models to account for 
sources of variability. With new tactical planning models that properly incorporate 
risk, irreversible planting decisions would be much more robust to those adverse 
conditions a grower could find herself in when it is time to harvest. 
Recent literature has further highlighted the need for the development of new 
decision-making tools for the management and planning of fresh food supply chain. 
This need is largely driven by fast-changing agricultural markets coupled with new 
opportunities and challenges stemming from the increased availability of data. Tools 
that address these issues will be especially valuable for small and medium growers 
(Allaoui et al., 2018; Flores et al., 2019; Kamble et al., 2020; Villalobos et al., 2019). 
Ahumada and Villalobos (2011) introduced a deterministic tactical model that 
aims to maximize profits for a single producer with multiple plots. The model 
considers factors such as labor and resource availability and costs, produce per￾ishability, and logistics parameters such as delivery time and costs. Vassalos et al. 
(2013) utilized a simulation approach and found that the perishability of the products 
significantly affects the planning of the growing season and that utilizing seasonal 
price trends, instead of just average annual prices, results in a more effective growing 
plan. Some researchers, such as Parfitt et al. (2010), Galal and El-Kilany (2016), 
and Villalobos et al. (2019), have investigated how improved planning can lead to 
a better supply-demand match and reduce waste in the supply chain. Boyabatli et 
al. (2019) have also studied coordination of planning activities while considering 
sustainable practices. Ahumada et al. (2012) and Flores and Villalobos (2018) 
provide examples of planning methodologies that consider the stochastic nature of 
prices and yields. 
When procuring fresh products to meet year-round demand, it is important to 
consider the seasonal production windows, costs, and total product availability108 M. Peinado-Guerrero et al.
from various potential production regions. Due to varying climate conditions, 
these regions may have different production windows. To take advantage of any 
complementary harvesting seasons, it may be advantageous for growers to form 
partnerships and collaborate with growers from other regions. By doing so, they can 
ensure a steady supply of fresh products and meet customer demands throughout 
the year. Most of the previous works focus on single producing regions or in 
multiple producers within the same region, not addressing the issue of coordination 
between different locations, which may have different harvesting patterns based 
on their respective climates. The proper coordination of production plans between 
multiple locations begins with modeling the agronomic potential of a crop, which is 
considered the first and most crucial step. 
Recently, the importance of considering complementary production regions has 
been widely studied. Flores and Villalobos (2020) investigated the identification 
of such regions based on the expected yields and weather conditions at multiple 
locations. By grouping these locations into clusters based on similar climate 
patterns, the number of planning units was reduced to a manageable number. 
The use of complementary regions has been shown to be valuable, especially 
when climate conditions and market prices vary significantly. In another study, 
Hajimirzajan et al. (2021) developed a framework for large-scale crop planning 
that takes into account climate diversity and minimizes costs and resource usage. 
The framework was applied to onion, potato, and tomato production in Iran. 
Climate data and yield estimates can be used to evaluate the productivity of a given 
location for different planting options, particularly in regions with varying weather 
patterns (Birthal & Hazrana, 2019). These patterns can result in complementary 
productive seasons, which can be coordinated to increase the availability of fresh 
produce (Gaupp et al., 2019; Villa et al., 2019; Ahumada et al. 2023; Peinado￾Guerrero & Villalobos, 2022). Having alternative production windows is especially 
advantageous for planning purposes, when market demand does not align with the 
production season of a single region or when consumers have specific preferences 
for the produce they demand. 
The work presented in this chapter focuses on the use of a stochastic optimization 
model that considers the variability of prices and yields to choose how and when to 
harvest certain crops to satisfy a contract. The novelty of this work comes from 
using this model to consider a coalition of growers from different regions so that 
profits may be increased when compared to an individual’s efforts. 
1.3 Objectives of This Work 
The general goal of this work is to introduce a tool that allows for the planning 
of tactical planting decisions while considering variability in both the yield of the 
planted crop(s) and the prices received after harvesting the crop(s) while capitalizing 
on the complementarity of different growing regions. The objective is to attain aManaging Risk in Fresh Produce Planning Considering Price Variability, Yield... 109
planting, harvesting, and packing plan that maximizes the expected profit of the 
pooled growers. 
The specific goals of this work are as follows: 
• Describe a stochastic optimization model to address the coordination of growers 
from complementary regions, assuming uncertainties in prices and yields 
• Solve the stochastic optimization model making use of multi-cut Benders 
decomposition 
• The evaluation of results on a small case study where a single grower in a single 
region must meet a contract and then comparing the results for a coalition of 
growers from three different regions that must meet the same contract 
2 Uncertainties in the Planning Decisions of Fresh Produce 
This section addresses two main sources of variation that affect the income of 
fresh food growers: price and yield variability. It is assumed that commercialization 
uncertainty is eliminated by securing a non-breakable contract ahead of making any 
planting decisions. Furthermore, the logistics cost to deliver the product is assumed 
to be fixed and thus can be omitted from the planning models (Vassalos et al., 2013). 
Hence, the planning model described here considers only the costs associated with 
planting, harvesting, and packaging the produce and can be viewed as emulative 
of a direct-to-customer model, where the customer is a last-mile distributor and the 
seller is an entity we call the supply chain articulator (see Ulloa & Villalobos, 2022), 
who pools all available resources from participating growers to make centralized 
planning decisions. The information and product flow for this market interaction 
are illustrated in Fig. 1. The following subsections further discuss the sources of 
variability within this setting. 
2.1 Price Variability 
Price variability in fresh produce is the result of many factors with two large 
contributors: the first is lack of coordination between market demand and its supply; 
the second is product perishability. First let us consider price variability in the 
context of product perishability by examining three very popular fresh products in 
the USA: carrots, tomatoes, and strawberries. Figure 2 shows the profit estimates for 
an acre of each of the three products grown from a farm located in Southern New 
Mexico and sold in the Chicago market. 
Fresh carrots have a relatively long shelf life (low perishability) when properly 
stored (up to 2 months), as compared to tomatoes (up to 3 weeks) and strawberries 
(up to 1 week). Proportional to their perishability, strawberries produced the 
highest profit per acre, while carrots produced the lowest. This is largely a direct110 M. Peinado-Guerrero et al.
Fig. 1 Diagram of the decision-making process 
Fig. 2 Estimated profit per acre for three crops 
consequence of how the perishability of a product dictates the supply chain strategy 
used to move it from growers to the final consumer. Since carrots can be stored 
longer, this allows the supply chain to keep higher levels of inventory along its 
different echelons to better withstand demand variability and thus allow for reduced 
price variability. In other words, less inventory can be held at each echelon when 
a product is highly perishable, allowing for fewer opportunities to absorb the 
demand variability. Additionally, strawberries require the highest level of care in 
terms of production, harvest/coordination transportation, packaging, and storage 
environmental control, with the opposite being true for carrots. The price variabilityManaging Risk in Fresh Produce Planning Considering Price Variability, Yield... 111
resultant from a fresh food’s perishability is compounded with the number of 
echelons between supply and demand in a traditional long supply chain. It is well 
known that as the number of echelons between supply and demand increases, so 
does the distortion of the demand signals (Lee, 1997). 
2.2 Yield Variability 
A second factor that needs to be addressed is yield variability, which results in under￾or oversupply of crops. In this work, the SIMPLE yield model developed by Zhao 
et al. (2019) is utilized as the basis for determining a fresh food’s yield pattern. The 
model has been adapted to provide an approximation of crop yields and other inputs 
required for tactical planning models working with fresh produce (Ahumada et al., 
2023). The SIMPLE model relies on temperature and solar radiation data to get a 
total estimated yield per crop. There are two cases: If the crop is harvested only once 
(like carrots), then the estimated total would be dependent on the time of harvest. 
The second case occurs when a crop has multiple harvests (such as tomatoes), and 
the estimated total is used to determine the distribution across the harvesting weeks. 
Figure 3 shows the temperatures and solar radiation observed in the region of 
Albuquerque, NM (zip code 87102), where TMAX, TMIN, and TAVG are the max￾imum, minimum, and average temperature, respectively. Using this information, 
Fig. 4 shows the harvest distribution (in weeks) determined after calculating the 
total yield from the SIMPLE model resultant from planting 1 acre of tomatoes in 
Albuquerque during week 1 of the year. 
From these figures we can gather that the observed yield can vary considerably 
depending on the weather. Enabling growers to better anticipate yield variability by 
considering potential scenarios for weather patterns during the gap between planting 
and harvesting could greatly enhance their financial success. 
Fig. 3 Temperatures and radiation through a sample year112 M. Peinado-Guerrero et al.
Fig. 4 Distribution of SIMPLE model yield over 5 years per harvest week when planting 1 acre 
of tomatoes in Albuquerque during week 1 
To no surprise, higher income is associated with higher price variability and 
corresponding risk. Thus, in the long run, highly perishable crops are attractive to 
growers if they can tolerate the associated risk. From the perspective of variability, 
a small grower usually will avoid this type of crop because of the lack of reserves 
to face unattractive prices. The small grower generally prefers price-stable crops, 
often forfeiting potentially lucrative opportunities. One possibility for improving the 
profits of growers while keeping their risk level tolerable is to use decision support 
tools that help decide when and how much to plant for maximizing profits while 
restricting the decisions to the amount of risk they are willing to take. Furthermore, 
a critical part that the decision support tools need to consider is the expected price 
and their associated variability at the time that the crops are harvested. 
The issue of when and how much to plant is not straightforward if growers 
wish to protect themselves against potentially unfavorable circumstances when 
harvesting season arrives. This can be addressed by using decision support tools 
that consider the stochasticity and combinatorial nature of the underlying problem. 
In the next section, the stochastic model is introduced formally. 
3 Stochastic Model Formulation 
In this section, the stochastic optimization model’s formulation is described in detail 
along with some of its key inputs. First, the model’s notation is introduced.Managing Risk in Fresh Produce Planning Considering Price Variability, Yield... 113
3.1 Notation 
Sets 
t ∈ WEEKS Set of weeks for selling product 
h ∈ WEEKH Set of harvesting weeks 
p ∈ WEEKP Set of planting weeks 
w ∈ WEEK Set of weeks in the planning horizon (union of WEEKS, WEEKH, and 
WEEKP) 
j ∈ CROP Set of crops 
c ∈ CUST Set of customers 
l ∈ LOCATION Set of grower locations 
s ∈ SCEN Set of scenarios 
f ∈ FAC Set of packaging facilities 
z ∈ Z Set of optimality cuts 
Master Problem Parameters 
λ Weight of risk metric 
T Total target profit for the grower(s) 
prs The probability of scenario s being realized 
Cplantj Cost of planting crop j, per acre 
Clabor Cost of labor 
Ctemp Cost of temporal labor 
Chire Cost of hiring a laborer 
LAl Area of land available at location l 
Waterj Amount of water required by crop j, per acre 
Bl The budget available for location l 
W The total amount of water available 
LabPphj The number of labor-hours required to plant crop j during planting week p and 
harvest week h 
LabHphj The number of labor-hours required to harvest crop j during harvest week h 
when it was planted in week p 
Minj Minimum number of acres of crop j that must be planted, if it all 
Maxj Maximum number of acres of crop j that may be planted 
Mtemp Maximum number of temporal laborers that may be acquired 
πs
pjlz Dual value of harvest constraint for planting week p, harvest week h, crop j, and 
location l for optimality cut z 
πs
cz Dual value for constraint c in scenario s for optimality cut z 
Resources
c Resource for constraint c in scenario s (right-hand side of the constraint)114 M. Peinado-Guerrero et al.
Subproblem Parameters (Stochastic) 
Y ields
phjl The total expected yield, per acre, of crop j when planted in week p and 
harvested in week h at location l in scenario s 
harvests
phjl The total harvest of crop j when planted in week p and harvested in week h at 
location l in scenario s 
prices
tj The price received for crop j during week t in scenario s 
Spr ices
tj The price to purchase crop j during week t from the spot market in scenario s 
Subproblem Parameters (Deterministic) 
LDemtj The contract demand for crop j during week t 
UDemtj The maximum of crop j that can be used to satisfy the contract or sold in the spot 
market during week t 
PFcapf The max packing capacity of facility f 
Weightj Standard packaging weight for crop j 
Master Problem Variables 
MinStages Auxiliary decision variable for the potential value of scenario s given current 
first-stage decisions 
MinVars Auxiliary decision variable for minimizing excepted down-side distance from the 
target T 
Plantpjl Number of acres to plant during week p of crop j at location l 
Opltl Laborers required during week t at location l 
Hiretl Number of workers hired during week t at location l 
Firetl Number of workers fired during week t at location l 
Yjp Binary decision variable: 1 if crop j is planted in week p, 0 otherwise 
Opttl Temporal laborers required from during week t at location l 
Subproblem Variables 
SCtjcf Number of packaging units shipped to customer c during week t of crop j from 
facility f 
SPphjlf Amount of crop j planted in week p, harvested in week h, at location l, and sent to 
packaging facility f 
Selphjf Amount of crop j planted in week p, harvested in week h, and selected from 
packaging facility f 
Packhjf The amount of crop j packaged during week h from facility f 
Buytj Number of units to purchase from the spot market during week t of crop jManaging Risk in Fresh Produce Planning Considering Price Variability, Yield... 115
3.2 Contract 
One of the underlying assumptions of planning the production of crops is that we 
can characterize the demand of the different products being considered for planting 
decisions. There are different ways to characterize this demand, but in general 
we need to estimate the expected demand and the associated standard deviation 
according to some time resolution, for instance, weeks. In the case of fresh produce, 
the weekly demand is very often established before the growing season, while the 
final price received is tied to the available spot market price at the time of the crop’s 
delivery. This type of contract is known as a volume contract. The case where prices 
are not determined by the spot market, but instead are specified in advance, refers 
to a fixed-price contract. Usually, either contract specifies additional details such as 
point of delivery, quality of the product, packaging, and logistics issues. The contract 
will also stipulate the penalties associated with not meeting the terms of the contract 
for each party involved. Thus, at a high level, the contract specifies the volume of 
produce required and the pricing scheme, and the planning strategy consists of how 
much land to use and when to plant in order to meet these volumes. 
For the model used in this work, and for the case study that follows, it is assumed 
there is a single buyer willing to issue a fixed-price contract for a set of fresh foods. 
As described, this contract specifies the volume needed to be satisfied for each fresh 
food, while the price paid upon delivery is known when the agreement is made. It is 
further assumed that a supply chain articulator, an agent representing the growers, 
is tasked with determining how to satisfy the contract. 
It is assumed that neither the supply chain articulator nor the buyer will have any 
incentive to deviate from the agreements made through the contract. However, given 
the seasonality and variability of the yields obtained, it is inevitable that a grower 
will overproduce or underproduce, relative to the volume specified by the contract. 
In either case, there are associated costs. When overproducing, the grower must 
figure other ways to sell her product, or let it go to waste. When underproducing, 
she will be responsible for fees stipulated by the contract. To account for these 
circumstances, the model considers the availability of a spot market where growers 
can acquire or sell additional produce to meet or exceed the contracted demand. 
Thus, the growers have two means of satisfying the contract: (1) by their own 
production capabilities and (2) by purchasing from the spot market. The growers 
are also allowed to sell off any excess to the spot market and so effectively have two 
markets from which to gather income. 
3.3 Two-Stage Stochastic Program Description 
Here, the two-stage stochastic program is described in detail. The full stochastic 
model to be used here is an adaptation of the model developed by Ahumada et116 M. Peinado-Guerrero et al.
al. (2012). The problem formulation of the two-stage stochastic program with full 
recourse has the following general structure from Birge and Louveaux (1997): 
Max 
cT x + EδQ (x,δ (ω))|Ax = b, x ≥ 0

where 
Q {x,δ (ω)} = Max 
q(ω)
T y|Wy = h (ω) − T (ω) x, y ≥ 0
 
The vector x represents the first-stage decision variables and y the second-stage 
decision vector with feasible sets {x| Ax = b, x ≥ 0} and {y| Wy = h(ω) − T(ω)x, 
y ≥ 0}, respectively. ω represents any stochastic parameters present. δ(ω) is the 
set of vectors formed by the random parameters q, h, and T that are determined 
by a given realization of ω. Thus, q(ω) and h(ω) are the second-stage objective 
function coefficients and the right-hand side vectors, respectively, associated with 
realizations of ω. T(ω)x represents the realization propagated by the first-stage 
decisions. Finally, W is the matrix of parameters for the second-stage variables. 
For the reader unfamiliar with stochastic programming, the formulation can be 
understood in the context of our problem as follows: we want to maximize the 
difference between the expected revenue from the crops harvested and the planting 
costs for the planting decisions made, thus maximizing expected profit. Because 
we are assuming that the yield and spot market prices for each crop are random 
variables, once we make our planting decisions, we consider different realizations 
of price and yield that may be experienced when it is time to harvest and observe. 
This is the reason we take the expectation of the revenue. 
To set the stage for the complete model in detail, we first imagine the case of 
a single grower. The grower has certain restrictions on costs and land availability. 
These restrictions must be considered when determining, for each crop, how much 
to plant, when to plant, and the corresponding hiring decisions that must be made 
to satisfy the labor requirements. Such decisions are referred to here as tactical 
decisions. In the mathematical model presented here, all tactical decisions are made 
by the first-stage master problem with guidance from the second-stage subproblems. 
In other words, in the first stage of the problem, we solve a deterministic model 
that has some information from the stochastic second stage. The second stage is 
decomposed into n subproblems that each corresponds to a random realization 
of crop prices and yields, which will be referred to here as scenarios. In other 
words, for each scenario s∈ SCEN, there are different price and yield vectors. With 
sufficiently many scenarios considered, the final planting decisions should be robust 
to the actual realized market prices. Next, the first-stage problem is presented.Managing Risk in Fresh Produce Planning Considering Price Variability, Yield... 117
3.3.1 First-Stage Problem 
The first stage of the problem deals with solving a deterministic model, referred 
to as the master problem, that seeks to maximize the summation of the planting 
costs and the expected profit of the second stage. The master problem is described 
mathematically, using the notation from Sect. 3.1, as follows: 
max

s
prs M inStages − λ

s

t
prs(T − M inV ars)+
−
t

j

l
P lanttjl Cplantj
− 
t

l
Opltl Clabor − 
t

l
Hiretl Chire − 
t

l
Opttl Ctemp
(1) 
subject to 

j

p
P lantpjl ≤ LAl ∀l (2) 

j

p
P lantpjl Cplantjl ≤ Bl ∀l (3) 

j

p

l
P lantpjl W aterj ≤ W (4) 
Opltl + Opttl ≥ 
p

h:h=t

j
P lantpjl LabPphj
+

p

h:h=t

j

l

s
prs
H arvests
phjl LabHphj ∀t,l
(5) 
MinjYjp ≤ P lantpjl ≤ MaxjYjp ∀j, p,l (6) 
Hiretl − F iretl = Opltl − Oplt−1l ∀t,l (7) 
Hiretml + Opltm−1l ≥ Opltl ∀t,l (8) 

t

l
Hiretl ≤ Mf ix (9) 

l
Opttl ≤ Mtemp ∀t (10)118 M. Peinado-Guerrero et al.
M inV ars ≤ T ∀s (11) 
M inStages ≤ −
p

h

j

l
P lantpjl Y ields
phjlπs
pjlz +
c
πs
czResources
c ∀s, z
(12) 
M inV ars ≤ Qs ∀s (13) 
M inV ars ≤ M inStages ∀s (14) 
The objective (1) is to maximize the overall revenue for the grower(s), which 
includes maximizing the expected profit of the second stage minus the cost 
generated by the decisions made in the first stage; this includes a risk metric that 
penalizes decisions that lead to profits below a target T and can be adjusted by 
the parameter lambda (λ). This parameter is important for our study because it 
determines the penalization for target semi deviation, therefore making the solution 
risk neutral for λ equal to zero or risk adverse for higher values of λ. 
To describe the utility of the parameter λ more completely, given targeted profit 
T, the model penalizes decisions, proportional to the parameter λ. With a sufficiently 
high choice of λ, planting decisions in the first stage that push the second stage 
expected profits toward the target T are incentivized, thereby reducing the risk of not 
meeting the target. However, a trade-off may arise in the overall variability of the 
expected profits. Strictly for illustrative purposes, consider a case where we have two 
scenarios with objective function values z1 and z2 and a target T such that z1 < T < z2. 
If we have set λ = 1.5, we may guide the model toward planting decisions in the 
first stage that result in more subproblem objective values that are beyond the target 
so that in the simple example we have T < z1 ≤ z2. On the other hand, if we set 
λ = 0.5, this could result in first-stage decision variables that lead to z1 ≤ z2 < T. 
The remainder of the first-stage model is straightforward. Constraint (2) states 
that the grower(s) cannot plant more than the land available, and constraint (3) 
makes sure the grower(s) cannot spend more money than what is available. 
Constraint (4) verifies the planting decisions satisfy water restrictions. Constraint 
(5) guarantees that the labor requirements for each planting and harvesting week 
are satisfied. Constraint (6) provides a lower bound and an upper bound on the 
amount of land that one should plant if planted at all. Constraints (7)–(10) handle the 
labor requirements required to accommodate the planting decisions. Constraint (11) 
bounds MinVars to be below the targeted profit value T which can be interpreted as 
offering no additional incentives for decisions that lead second-stage revenues that 
are above the target profit. 
The master problem is connected to the second-stage problem in part by passing 
the optimal tactical decisions as parameters into the subproblems. Specifically, the 
planting decisions Plantpjl from the master problem are used to compute the harvestManaging Risk in Fresh Produce Planning Considering Price Variability, Yield... 119
harvests
phjl for scenario s using the corresponding per acre yield Y ields
phjl with 
(15): 
harvests
phjl = P lantpjl Y ields
phjl ∀p, h, j, l, s (15) 
That is, after the master problem is solved and planting decisions are made, a 
harvesting profile is generated for each subproblem based on its corresponding yield 
scenario. 
The master problem is further connected to the subproblems through feedback 
introduced from the second stage back to the first stage via constraints (12)–(14). 
The variables MinStages and MinVars act as auxiliary variables for the second-stage 
optimal objective function values Qs for each scenario s. Constraint (12) is the most 
impactful connection of these constraints. 
Constraint (12) uses the dual values from the second-stage problems to inform 
the planting decisions within the master problem. Such constraint formulations 
are referred to as Benders cuts. Simply put, the constraint formulation points the 
master problem in a direction where different planting decisions may lead to an 
improvement in the objective function of the subproblem. For example, if the dual 
value for a constraint on the amount you could harvest of tomatoes is 10, we 
could, loosely speaking, expect an increase of 10 to the objective function value 
of the given subproblem for each additional acre of tomato we choose to plant 
in the first stage. Multiplying this by the available amount of the corresponding 
resource provides an estimate of the total value we can capture by shifting our 
decisions. If this value for a crop X is greater than that of a crop Y, the first-stage 
problem may choose to increase the land allocated to crop X, subject to the full 
set of constraints. Hence, as we go from iteration to iteration, the dual values from 
each solved subproblem tend to guide the first-stage problem to planting decisions 
that improve the overall solution. The fully iterative algorithm for the exchange of 
information between the two stages of the full problem is described further in Sect. 
5. Next, the subproblem formulation is formally introduced. 
3.3.2 Second-Stage Problem 
In the second stage of the problem, given the tactical decisions x made in the first 
stage, we have for each scenario s a subproblem defined as follows: 
Qs(x) = max
⎡
⎣

t

k
⎛
⎝
c

f
SCtjcf
⎞
⎠prices
tj − 
t

k

f
Buytj Spr ices
tk
⎤
⎦
(16) 

f
SPphjlf = harvests
phjl ∀p, h, j, f, l (17)120 M. Peinado-Guerrero et al.
Selphjf = 
l
SPphjlf ∀p, h, j, f (18) 
P ackhjf = 
p

h:p≤h

j
Selphjf
W eightj
∀h, j, f (19) 

c
SCwjcf = P ackwjf ∀w, j, f (20) 

f
SCtjcf + Buytj ≥ LDemtj ∀t, j,c (21) 

f
SCtjcf + Buytj ≤ UDemtj ∀t, j,c (22) 

j
P ackhjf ≤ P F capf ∀h, f (23) 
The objective (16), for each scenario s, is to maximize the revenue from the 
second-stage decision variables based on the planting decisions made in the first￾stage problem. Constraint (17) ensures that everything harvested is sent to the 
packaging facility. Constraint (18) ensures that we sell all products that are received 
by the packaging facility. Constraint (19) converts the available product for sale 
from weight to packaging units, for example, cartons. Constraint (20) guarantees 
that all packaging units are sent to a customer. Constraint (21) forces the amount of 
product shipped to each customer to be at least the amount specified by the contract 
for each week. Constraint (22) places an upper bound on the amount of product that 
can be sold for any week. Constraint (23) ensures that for any week, it is not possible 
to package more product than the capacity of the packaging facility. 
Again, the stochastic nature of the problem at hand is captured entirely by solving 
a subproblem for each of the scenarios. If we let Qs(x) be the optimal value of a 
subproblem s given a price/yield scenario, we can make good planting decisions by 
maximizing the expectation of the second-stage subproblems. 
The next section reveals the complete iterative algorithm for solving the two￾stage stochastic programming problem. 
Generating Scenarios for the Subproblems 
The importance of the scenarios developed for the second-stage subproblems is that 
they must be representative of the universe of potential results, in order to converge 
to acceptable decisions that are robust to the different outcomes the grower might 
experience in practice.Managing Risk in Fresh Produce Planning Considering Price Variability, Yield... 121
Rather than generating scenarios using statistical methods, the scenarios used 
in this work come from real historical data. In the case of prices, 5 years of data 
are collected and processed using the market intelligence framework developed by 
Hernández-Cruz et al. (2022). For yields, weather data for the same 5 years is used 
to estimate yield vectors using the modified SIMPLE model introduced in Sect. 2.2. 
Developing the scenarios in this manner allows us to capture some of the interaction 
effects between prices and yield. 
In the next section, the overall solution algorithm is summarized. 
4 Solution Procedure 
As suggested in Sect. 3, the full optimization algorithm is an iterative procedure. 
It begins with a feasible planting decision. The selection of this initial solution 
may impact the number of iterations required to reach a stable solution, but the 
procedure assumes here that any feasible solution is a good enough starting point for 
the algorithm. Given the initial planting decisions, the second stage of the problem 
is initiated by first determining the corresponding potential harvest distribution for 
each crop. As discussed in Sect. 3.3.2.1, a set of yield scenarios is generated based 
on the planting decisions. With each of the potential harvest distributions determined 
and used as parameters to their corresponding subproblem, each subproblem is 
solved. Note that because these subproblems are independent, they may be solved 
in parallel to help reduce the time used to solve the problem. Next, dual information 
is collected from each of these subproblems, concluding the first pass of the 
algorithm through the second stage of the problem. The first stage of the problem 
begins by using the dual information collected in the subproblem as coefficients 
in Constraint (12) of the master problem. With the new constraints added, the 
master problem is resolved at the start of each iteration. The new planting decisions 
are compared with the previous planting decisions, and if there is no change, the 
algorithm terminates. If the planting decisions did change in the new master problem 
solution, we re-enter the second stage of the problem by again computing the new 
potential harvest vectors using these new planting decisions and repeat the algorithm 
until the terminating condition is satisfied. Table 1 shows the count of variables 
and constraints in both the master problem and each of the subproblems for the 
cases of a single grower and a coalition of three growers, providing some idea of 
the computational load increase as the number of growers considered increases. 
Figure 5 below illustrates the described solution algorithm. 
In general, after a sufficient number of iterations, the decisions across both stages 
reach a stable solution to the overall problem. Note that the dual value information 
is stored from iteration to iteration; hence the set of optimality cuts Z grows with 
the number iterations. The variable MinStages
, because of Constraint (12), provides 
an upper bound on what the value of Qs can be after adjustments are made to 
the planting decisions. Constraints (11), (13), and (14), coupled with the term 
λ
tsprs
(T − MinVars )+ in the objective function, help to minimize losses, if those122 M. Peinado-Guerrero et al.
Table 1 Count of variables and constraints for the master problem and each subproblem for the 
case of a single grower from one region and a collation of growers spanning three regions 
Single region Coalition of three regions 
Master problem Subproblem Master problem Subproblem 
Number of variables 984 65,196 2440 192,492 
Number of constraints 875 65,700 1607 129,348 
Fig. 5 Two-stage iterative optimization algorithm 
losses are defined as the distance below the target T across all scenarios. That is, 
for scenarios where Qs < T − ε, the first stage has additional incentive to make 
decisions that push these scenarios toward T for small ε. 
It is important to note that it is assumed that each scenario s generated is equally 
likely to occur in the objective function for the first stage, since maximization of the 
overall profit between both stages is pursued, where the expected value of the second 
stage across all scenarios is considered. In reality, the probabilities of different 
scenarios coming into fruition are unlikely to be distributed uniformly. However, 
with sufficiently many scenarios considered according with the probability of 
occurrence, the approach used should approximate the true distribution of the 
scenarios. Considering many scenarios comes at the expense of computation. 
Scenarios could be aggregated; however, this would reduce the granularity of the 
solution, thus our understanding of the problem’s dynamics. In this work, it is 
assumed that the scenarios proposed sufficiently capture enough information to be 
a representative sample.Managing Risk in Fresh Produce Planning Considering Price Variability, Yield... 123
5 Case Study 
This section highlights the benefits growers from different regions can gain by 
pooling their resources together using the model described in Sect. 3 and the solution 
procedure outlined in Sect. 4. The focus is on showcasing how this approach can 
lead to superior quality planning solutions, resulting in increased profits, reduced 
risk, and improved performance metrics for individual growers. 
We begin by considering the case of a single grower in Phoenix, Arizona. The 
case in which independent growers from Phoenix, Aspen, and Albuquerque are 
managed by a supply chain articulator is used for comparison. When alone, the 
grower in Phoenix is assumed to have 110 acres of land. When the coalition is 
developed, Phoenix is assumed to have 40 acres of land, while the growers in Aspen 
and Albuquerque hold 10 and 60 acres, respectively. This could also exemplify a 
single grower who is considering purchasing land in different regions, rather than 
one. 
For this case study, the growers can capture revenue from two separate sources: 
a contract and the spot market. It is assumed that the contract is developed ahead 
of time and details the volume of each crop that must be satisfied along with the 
corresponding prices. These attributes are depicted in Fig. 6 for the four contracted 
crops: bell peppers, celery, lettuce, and tomatoes. 
As previously mentioned, the grower must, at a minimum, meet the demand 
specified in the contract. Rather than incurring a direct penalty (payment to the 
customer) for any demand not met, it is assumed that the grower must purchase any 
product shortage for a given week from the spot market. This means if for any given 
week the demand for the product cannot be met with the resources available to the 
grower (land, water, etc.), they are forced to purchase from the spot market. Here, 
it will be assumed that purchases from the spot market cost 120% of the actual spot 
market price of the scenario. Similarly, if for any given week the grower produces 
more than is required by the contract, they may sell the excess at 80% of the true spot 
market price. Modeling in this way also helps steer the model form making drastic 
decisions to capitalize on arbitrage opportunities. Figure 7 shows standard boxplots 
of spot market prices for each contracted crop across the five scenarios discussed 
in Sect. 3.3.2.1. Note that because the spot market prices are in some cases highly 
volatile, the certainty that the contract brings can be particularly valuable for more 
risk adverse growers. 
To exemplify some of the complementarity between the regions and the different 
yield distribution characteristics among the contracted crops, Fig. 8 displays harvest 
curves for each region when planting in week 10 for one of the five scenarios. Imme￾diately it is easy to distinguish between celery/lettuce and bell peppers/tomatoes. 
Celery and lettuce are single-harvest crops, so their total yield determined by the 
SIMPLE model is allocated to a single week. Complementarity is best demonstrated 
in the case of tomatoes where we see that cooperation would allow the growers 
in these regions to span a considerable portion of the year. This feature will be 
important in satisfying the contract previously described.124 M. Peinado-Guerrero et al. Fig. 6 Contract volume and price for each week and each contracted cropManaging Risk in Fresh Produce Planning Considering Price Variability, Yield... 125
Fig. 7 Standard boxplot of prices for each crop during each week across the five scenarios 
4,000 
3,000 
2,000 
1,000 
0 
28 29 30 31 32 33 34 35 36 37 
Week 
Harvest Volume (Lbs) 
Harvest Volume (Lbs)
Harvest Volume (Lbs) 
Harvest Volume (Lbs) 
20,000 
15,000 
10,000 
5,000 
0 
30 31 36 
Week 
Albuquerque Aspen Phoenix 
30,000 
20,000 
10,000 
0 
36 
6,000 
4,000 
2,000 
0 
Week 
22 23 24 25 26 27 2829 30 31 32 33 34 35 36 37 
Week 
Yield Dist. for Bell Peppers Yield Dist. for Celery 
Yield Dist. for Lettuce Yield Dist. for Tomatoes
Fig. 8 Harvest distribution for each contracted crop and each growing region when planting 1 acre 
in week 10126 M. Peinado-Guerrero et al.
Table 2 Planting decisions 
for single grower in Phoenix Planting week Crop Acres 
5 Bell peppers 1.00 
5 Tomatoes 88.95 
6 Lettuce 1.00 
6 Bell peppers 2.25 
6 Tomatoes 2.77 
8 Lettuce 1.00 
8 Tomatoes 2.83 
12 Lettuce 1.00 
12 Bell peppers 1.10 
14 Tomatoes 1.68 
41 Tomatoes 2.92 
42 Tomatoes 3.48 
Total 110.00 
The task of the optimization model is to consider inputs (availability of land, 
labor, capital, and water and the capacity of the available packing facilities) in order 
to allocate planting decisions to the grower(s) such that the contract is satisfied, and 
the cumulative profit of the growers is maximized while minimizing some risk expo￾sure. Regarding risk, the term in the objective function λ
tsprs
(T − MinVars
)+
discussed in Sect. 4 is a direct way of pushing the solution toward planting decisions 
that avoid being below some target. However, this work aims to highlight using the 
complementarity of regions so the parameters λ and T will remain fixed across both 
cases (single grower and coalition of three growers). Values λ = 1 and T = 0 are 
chosen, which can be interpreted as the growers being risk neutral to making at least 
$0 in collective profits (breaking even). 
For the case of the single grower, Table 2 summarizes the planting decisions. 
Figure 9 shows for each contracted crop, how much was harvested, how much was 
purchased from the spot market, and what the contract demand was. 
Furthermore, Fig. 10 shows, across iterations of the algorithm, the second-stage 
objective function for each scenario (revenue), the average second-stage objective 
function value, and the standard deviation of the objective function values across 
all scenarios. The second-stage objective function can be viewed as the expected 
revenue, with the first-stage planting costs needed to account for the overall profit. 
For Phoenix alone, the overall average profit at the end of the algorithm after 
considering the first-stage planting costs is $749,353 with an overall standard 
deviation of $362,906 and a standard deviation of profit per acre planted of $34,602. 
The results show that rather than matching harvest as best to the demand profile 
as possible, the grower chose to plant heavily in favor of tomatoes, using the profits 
made from selling to the spot market to subsidize the other crops. Figure 10 also 
shows that as the algorithm trends toward a stable solution, the standard deviation 
of the objective function in the second stage is proportional to the average objective 
function value. This is analogous to the reward (revenue) of the grower being 
proportional to the risk they are taking for their planting decisions. We should alsoManaging Risk in Fresh Produce Planning Considering Price Variability, Yield... 127 20,000 15,000 10,000 5,000 0 15,000 10,000 5,000 0 0 400,000 300,000 200,000 100,000 Week Contract Fulfillment for Lettuce Contract Fulfillment for Tomatoes Contract Fulfillment for Celery Contract Fulfillment for Bell Peppers 
Volume (Lbs) 
Volume (Lbs) 
Volume (Lbs) 
Volume (Lbs) 
Week 
Week Week 
0 10 20 30 40 50 0 10 20 30 40 50 
0 10 20 30 40 50 0 10 20 30 40 50 
20,000 
10,000 
0 
Contract Demand Harvested Purchased 
Fig. 9 Weekly contract demand, amount harvested, and amount purchased from the spot market for each contracted crop in the case of a single grower in 
Phoenix128 M. Peinado-Guerrero et al.
1,500,000 
1,000,000 
500,000 
Revenue ($) 
0 
–500,000 
–1,000,000 
0 10 
Revenue Mean and SD Across Iterations 
20 Iteration 
Mean Objective Function SD 
30 
Fig. 10 Second-stage subproblem objective functions across iterations along with their mean and 
standard deviation in the case of a single grower in Phoenix 
note a gap in Fig. 10 for standard deviation, given that there were some iterations 
where first-stage planting decisions led to constraint violations in the second-stage 
subproblems, rendering them infeasible and without an optimal value. 
Another observation from Fig. 10 is in the first iteration; the average revenue is 
negative. This is because the solution given to initiate the algorithm (see Fig. 5) is to 
plant nothing. This results in satisfaction of the contract completely by spot market 
purchases at the expense of the grower. 
The next step is considering the case of having two additional growers in 
Albuquerque, New Mexico, and Aspen, Colorado, with 60 and 10 acres of land 
available, respectively, while reducing the land available in Phoenix to 40 acres. 
Similar to the first case, Table 3 summarizes the planting decisions; Fig. 11 shows 
for each contracted crop, how much was harvested, how much was purchased from 
the spot market, and what the contract demand was; and Fig. 12 shows, across 
iterations of the algorithm, the second-stage objective function for each scenario 
(revenue), the average second-stage objective function value, and the standard 
deviation of the objective function values across all scenarios. 
The overall average profit at the end of the algorithm after considering the first￾stage planting costs is $823,841 with an overall standard deviation of $308,565 and 
a standard deviation of profit per acre planted of $28,421. 
Table 3 makes it immediately clear that planting decisions have been made to 
span a large portion of the year. To complement this observation, it is clear from 
Fig. 11 that the harvest season for tomatoes has been expanded. We also see a greater 
impact on the satisfaction of the contract for bell peppers and tomatoes by means of 
production, rather than spot market purchases. So, as hypothesized, when the threeManaging Risk in Fresh Produce Planning Considering Price Variability, Yield... 129
Table 3 Planting decisions 
for the coalition of growers 
Location Planting week Crop Acres 
Albuquerque 5 Lettuce 1.04 
Albuquerque 5 Tomatoes 15.79 
Phoenix 5 Tomatoes 38.40 
Albuquerque 9 Lettuce 0.00 
Albuquerque 10 Bell peppers 3.97 
Phoenix 10 Bell peppers 1.60 
Albuquerque 11 Lettuce 1.00 
Albuquerque 11 Bell peppers 1.05 
Albuquerque 18 Lettuce 1.00 
Albuquerque 20 Lettuce 1.00 
Aspen 21 Tomatoes 4.04 
Albuquerque 22 Lettuce 1.00 
Albuquerque 22 Tomatoes 3.31 
Albuquerque 23 Lettuce 1.00 
Aspen 23 Tomatoes 1.49 
Aspen 24 Tomatoes 2.59 
Albuquerque 25 Lettuce 1.00 
Albuquerque 25 Tomatoes 3.47 
Albuquerque 26 Lettuce 1.59 
Aspen 26 Tomatoes 1.88 
Albuquerque 27 Lettuce 1.21 
Albuquerque 27 Tomatoes 2.37 
Albuquerque 28 Lettuce 1.00 
Albuquerque 29 Tomatoes 6.98 
Albuquerque 30 Tomatoes 4.73 
Albuquerque 31 Tomatoes 7.50 
Total 110.00 
growers pool their production, more of the contract demand is satisfied via means 
of production. However, celery is left out of the planting decisions, and tomato is 
heavily relied on to subsidize the spot market purchases used to satisfy the contract 
demand of the other crops in either case. Of course, what this suggests is that celery 
is an undesirable crop for our selection of growers, while tomato is highly lucrative. 
Perhaps the most important observation here is that the standard deviation of 
the second-stage scenarios in the final iteration is much lower when there are three 
growers available than when only Phoenix is available. This is indicative of growers 
being able to combine their efforts (or a single large grower spreading their land 
over different regions) to reduce their risk exposure. 
With this collection of observations in hand, we next discuss the conclusions of 
this work and directions for future research.130 M. Peinado-Guerrero et al. 20,000 15,000 10,000 5,000 0 15,000 10,000 5,000 0 0 50,000 200,000 150,000 100,000 Week Contract Fulfillment for Lettuce Contract Fulfillment for Tomatoes Contract Fulfillment for Celery Contract Fulfillment for Bell Peppers 
Volume (Lbs) 
Volume (Lbs) 
Volume (Lbs) 
Volume (Lbs) 
Week 
Week Week 
0 10 20 30 40 50 0 10 20 30 4
0 10 20 30 40 50 0 10 20 30 4
20,000 
10,000 
0 
Contract Demand Harvested Purchased 
0 50 
0 50 
Fig. 11 Weekly contract demand, amount harvested, and amount purchased from the spot market for each contracted crop for the coalition of growersManaging Risk in Fresh Produce Planning Considering Price Variability, Yield... 131
1,500,000 
1,000,000 
500,000 
Revenue ($) 
0 
–500,000 
–1,000,000 
0 25 50 75
Revenue Mean and SD Across Iterations 
Iteration 
Mean Objective Function SD 
 100 
Fig. 12 Second-stage subproblem objective functions across iterations along with their mean and 
standard deviation for the coalition of growers 
6 Conclusions and Directions for Future Research 
The case study in Sect. 5 provided some interesting results: The complementarity 
of different regions and central coordination clearly helps to better match the 
demand reflected by a given contract. Such encouraging results should motivate 
more research in planning coordination and risk pooling effects of co-ops and other 
means of grower association, through better planning tools. 
As for future research directions, it is important to point out that the results of the 
model presented in this work are largely influenced by the given contract. In order 
to demonstrate the utility of the model, a generic contract was developed without 
rigor. However, this may not be the case in reality. In order to account for this, a 
natural extension of this work would be to develop a negotiation procedure between 
the supply chain articulator and the buyer. Such a procedure should converge to a 
contract that reflects the realistic expectations of a buyer and is reasonable for the 
production capabilities of the growers. 
There are several additional areas directly related to the food supply chain 
planning problem and beyond. Emphasized in this work was the use of comple￾mentary regions acting cooperatively to generate superior solutions that increase 
profits and decrease risk. The planning approach used in this work was of a 
centralized nature, in which decisions are made and transmitted to the growers for 
their implementation. While this centralized approach has shown to be beneficial 
for growers willing to commit to the requests of the supply chain articulator, there 
likely exist scenarios where growers do not want to give up their agency entirely. 
Following this, a natural extension is to use coordination approaches like those132 M. Peinado-Guerrero et al.
proposed by Mason and Villalobos (2015) and Ulloa (2022) to incorporate such 
growers into the decentralized optimization tools. The interaction between growers 
who grant full information to the supply chain articulator and those who only grant 
partial information might be a fruitful area of research. 
This line of research, as it expands, should also consider the interaction of 
different regions to get an overall strategy to procure fresh produce for the whole 
country. The overarching vision is that this high-level plan should be used to identify 
potential gaps and ways to bridge them. Along these lines, the developed models 
cold be used to identify which technologies are most promising for the future 
of agriculture and also price the utility of using shared pools of labor, capital, 
equipment, and other resources for different combinations of growing regions. 
When these resources are aggregated, the question remains of how to share the 
benefits among all participants, given that the decisions are made centrally. Hence, 
one natural extension of this work is the mechanism design for the allocation of 
the profits to the participating growers. To extend this, if we again consider the risk 
parameter discussed in Sect. 3, the profit allocation should consider the risk that 
the growers are taking to offer their services in fulfillment of the contract. Directly 
following the observation that the standard deviation of profit decreases when 
resources are pooled together, the consideration of external investors that can offset 
some of the risk of more risk adverse growers, or the portfolio of growers as a whole, 
to push the coordinated planning decisions toward higher value solutions would 
be an interesting analysis. Frameworks that entice external capital participation to 
provide the resources needed and to reduce the level of risk for the growers could 
be developed. 
Acknowledgments This work was partially supported by the Foundation for Food and Agricul￾ture Research [Award Number CA18-SS-0000000116]. 
References 
Ahumada, O., Hernández-Cruz, X., Ulloa, R., Peinado-Guerrero, M., Quijada, F., & Villalobos, 
J. R. (2023). A tactical planning model for fresh produce production considering productive 
potential and changing weather patterns. Biosystems Engineering, 232, 13–28. 
Ahumada, O., Rene Villalobos, J. R., & Nicholas Mason, A. (2012). Tactical planning of the 
production and distribution of fresh agricultural products under uncertainty. Agricultural 
Systems, 112, 17–26. https://doi.org/10.1016/j.agsy.2012.06.002 
Ahumada, O., & Villalobos, J. R. (2009). Application of planning models in the agri-food 
supply chain: A review. European Journal of Operational Research, 196, 1–20. https://doi.org/ 
10.1016/j.ejor.2008.02.014 
Ahumada, O., & Villalobos, J. R. (2011). A tactical model for planning the production and 
distribution of fresh produce. Annals of Operations Research, 190(1), 339–358. https://doi.org/ 
10.1007/s10479-009-0614-4 
Allaoui, H., Guo, Y., Choudhary, A., & Bloemhof, J. (2018). Sustainable agro-food supply chain 
design using two-stage hybrid multi-objective decision-making approach. Computers and 
Operations Research, 89, 369–384. https://doi.org/10.1016/j.cor.2016.10.012Managing Risk in Fresh Produce Planning Considering Price Variability, Yield... 133
Birge, J. R., & Louveaux, F. (1997). Two-stage linear recourse problems. In Introduction to 
stochastic programming (pp. 155–197). Springer. https://doi.org/10.1007/0-387-22618-4_5 
Birthal, P. S., & Hazrana, J. (2019). Crop diversification and resilience of agriculture to climatic 
shocks: Evidence from India. Agricultural Systems, 173(October 2018), 345–354. https:// 
doi.org/10.1016/j.agsy.2019.03.005 
Boyabatli, O., Nasiry, J., & Zhou, Y. H. (2019). Crop planning in sustainable agriculture: Dynamic 
farmland allocation in the presence of crop rotation benefits. Management Science, 65(5), 
2060–2076. https://doi.org/10.1287/mnsc.2018.3044 
Flores, H., & Villalobos, J. R. (2018). A modeling framework for the strategic design of local fresh￾food systems. Agricultural Systems, 161, 1–15. https://doi.org/10.1016/j.agsy.2017.12.001 
Flores, H., & Villalobos, J. R. (2020). A stochastic planning framework for the discovery of 
complementary, agricultural systems. European Journal of Operational Research, 280(2), 707– 
729. https://doi.org/10.1016/j.ejor.2019.07.053 
Flores, H., Villalobos, J. R., Ahumada, O., Uchanski, M., Meneses, C., & Sanchez, O. (2019). Use 
of supply chain planning tools for efficiently placing small growers into high-value, vegetable 
markets. Computers and Electronics in Agriculture, 157, 205–217. https://doi.org/10.1016/ 
j.compag.2018.12.050 
Galal, N. M., & El-Kilany, K. S. (2016). Sustainable agri-food supply chain with uncertain demand 
and lead time. International Journal of Simulation Modelling, 15(3), 485–496. 
Gaupp, F., Hall, J., Mitchell, D., & Dadson, S. (2019). Increasing risks of multiple breadbasket 
failure under 1.5 and 2 ◦C global warming. Agricultural Systems, 175(May), 34–45. https:// 
doi.org/10.1016/j.agsy.2019.05.010 
Glen, J. J. (1987). Mathematical models in farm planning: A survey. Operations Research, 35, 
641–666. https://doi.org/10.1287/opre.35.5.641 
Hajimirzajan, A., Vahdat, M., Sadegheih, A., Shadkam, E., & Bilali, H. E. (2021). An integrated 
strategic framework for large-scale crop planning: Sustainable climate-smart crop planning and 
agri-food supply chain management. Sustainable Production and Consumption, 26, 709–732. 
https://doi.org/10.1016/j.spc.2020.12.016 
Hernández-Cruz, X., Villalobos, J. R., Runger, G., & Neal, G. (2022). Layered market 
intelligence system. Transportation Research Procedia, 67, 31–38. https://doi.org/10.1016/ 
j.trpro.2022.12.032 
Kamble, S. S., Gunasekaran, A., & Gawankar, S. A. (2020). Achieving sustainable performance 
in a data-driven agriculture supply chain: A review for research and applications. International 
Journal of Production Economics, 219, 179–194. https://doi.org/10.1016/j.ijpe.2019.05.022 
Lee, H. L., Padmanabhan, V., & Whang, S. (1997). The Bullwhip Effect In Supply Chains. Sloan 
Management Review, 38(3), 93–102. 
Mason, A. N., & Villalobos, J. R. (2015). Coordination of perishable crop production using auction 
mechanisms. Agricultural Systems, 138, 18–30. 
Parfitt, J., Barthel, M., & Macnaughton, S. (2010). Food waste within food supply chains: 
Quantification and potential for change to 2050. Philosophical Transactions of the Royal 
Society B: Biological Sciences, 365(1554), 3065–3081. 
Peinado-Guerrero, M., & Villalobos, J. R. (2022). Technology-enabled, rapid-response fresh food 
supply chains: A paradigm and case study. Transportation Research Procedia, 67, 39–45. 
https://doi.org/10.1016/j.trpro.2022.12.033 
Ulloa, R. (2022). Development of tools for planning and coordinating the production of small 
farmers as a response to market opportunities. Doctoral dissertation, Arizona State University. 
Ulloa, R., & Villalobos, J. R. (2022). Use of real options for the coordination of a coalition of 
small growers with a buyer. Available at SSRN 4196515. https://doi.org/10.2139/ssrn.4196515 
Vassalos, M., Dillon, C. R., & Coolong, T. (2013). Optimal land allocation and production timing 
for fresh vegetable growers under price and production uncertainty. Journal of Agricultural and 
Applied Economics, 45, 683–699. https://doi.org/10.1017/s1074070800005204 
Villa, G., Adenso-Díaz, B., & Lozano, S. (2019). An analysis of geographic and product 
diversification in crop planning strategy. Agricultural Systems, 174(December 2018), 117–124. 
https://doi.org/10.1016/j.agsy.2019.05.006134 M. Peinado-Guerrero et al.
Villalobos, J. R., Soto-Silva, W. E., González-Araya, M. C., & González-Ramirez, R. G. (2019). 
Research directions in technology development to support real-time decisions of fresh produce 
logistics: A review and research agenda. Computers and Electronics in Agriculture, 167, 
105092. https://doi.org/10.1016/j.compag.2019.105092 
Zhao, C., Liu, B., Xiao, L., Hoogenboom, G., Boote, K. J., Kassie, B. T., ... & Asseng, S. (2019). 
A SIMPLE crop model. European Journal of Agronomy, 104, 97–106. 
Zuurbier, P. J. P. (1999). Supply chain management in the fresh produce industry: A mile to go? 
Europe, 30, 20–30.In Silico Evaluation and Prediction 
of Pesticide Supported by Reproducible 
Evolutionary Workflows 
Anderson Oliveira, Fabricio Firmino, Pedro Vieira Cruz, 
Jonice de Oliveira Sampaio, and Sérgio Manuel Serra da Cruz 
1 Introduction 
Advances in operations research and evolutionary computing (EC) in engineering 
and agriculture have been with us for several decades (Plà-Aragonés, 2015). EC 
allowed investigators to build better systems that use optimisation to obtain high￾quality results in less time and at lower costs associated with better performance 
(Kaufmann & Castillo, 2019; Eiben & Smith, 2015; Smith, 2015). 
Several real-world optimisation problems are ill-behaved solution spaces, infea￾sible to search and defy traditional evolutionary algorithms (EA), because they are, 
for example, non-linear, non-continuous, non-differentiable, or non-convex (Plà￾Aragonés, 2015; Baeck et al., 1997). Therefore, it may sometimes be challenging 
or impossible to replicate computational studies of this nature (Dalal et al., 2013; 
Bartz-Beielstein & Preuss, 2009). 
Optimisation problems encompass several types of paradigms. Computational 
experiments can range from isolated programmes based on simple mathematical 
models to complex multi-objective optimisation models (Baeck et al., 1997; Coello 
Coello et al., 2007). Quite a few authors expressed gaps between the theory and 
A. Oliveira · P. V. Cruz 
Department of Computer Sciences, Federal Rural University of Rio de Janeiro, Rio de Janeiro, 
Brazil 
F. Firmino · J. de Oliveira Sampaio 
PPGI/UFRJ, Institute of Computing, Federal University of Rio de Janeiro, Rio de Janeiro, Brazil 
e-mail: jonice@ppgi.ufrj.br 
S. M. S. da Cruz () 
Department of Computer Sciences, Federal Rural University of Rio de Janeiro, Rio de Janeiro, 
Brazil 
PPGI/UFRJ, Institute of Computing, Federal University of Rio de Janeiro, Rio de Janeiro, Brazil 
e-mail: serra@pet-si.ufrrj.br; serra@ufrrj.br 
© Springer Nature Switzerland AG 2024 
V. M. Albornoz et al. (eds.), Optimization Under Uncertainty in Sustainable 
Agriculture and Agrifood Industry, https://doi.org/10.1007/978-3-031-49740-7_6
135136 A. Oliveira et al.
reproducibility of experiments that involve optimisation problems in EC (Bartz￾Beielstein & Preuss, 2009; Bartz-Beielstein, 2006; Tauritz, 2009; Al-Sahaf et al., 
2019). 
Our investigation explores open issues in the current SWfMS regarding the 
design of large-scale in silico experiments that need scientific workflows equipped 
with EC reusable modules. They differ from traditional workflows because they 
apply evolutionary loops for large search spaces and hybrid combinations of many 
input datasets. 
SWfMS offers a framework for modelling and executing in silico experiments in 
centralised, distributed, or parallel environments. However, they still lack facilities 
to help researchers add and reuse EC and EA in reproducible workflows for 
experiments that need optimisation to solve multi-objective optimisation problems 
(Crick et al., 2009; Abramson et al., 2010; Nguyen et al., 2017; Da Cruz et al., 
2018). In this way, we offer a novel approach to mitigate such limitations. 
Solving single or multiple optimisation problems using EA and scientific 
workflows brings several advantages. First, the workflow can expose the details 
of the optimisation process to the researcher, making it easy to replace existing 
components or add new ones (Da Cruz et al., 2009). Second, optimisation can use 
parallel computing support embedded at the SWfMS or operating system level, 
allowing multi-core computers or HPC machines to load and compute-intensive 
CPU jobs. Finally, optimisation is widespread in real-world applications because 
it can reproduce the dynamics of systems in traditional management situations 
(Kaufmann & Castillo, 2019). With these advantages, scientific workflows may 
devise and solve multi-objective optimisation problems. 
Our work is one of the first efforts to realise an evolutionary scientific workflow 
composition workbench successfully. This chapter reports on the design and 
development of one critical enabling technology that allows researchers to compose 
evolutionary scientific workflows. 
The composition uses a set of reusable modules that encapsulate (single and 
multi-objective) evolutionary algorithms. VisPyGMO is our proposal. It helps 
researchers develop reusable scientific workflows that require complex optimisation 
tasks. The core idea of the proposal is to extend an SWfMS and offer generic 
EA modules to help researchers use EC and solve (single and multi-objective) 
optimisation problems more easily and quickly. 
This chapter is an extended version of our previous work (Da Cruz et al., 2018). 
We expand our work by discussing in depth the evolutionary experiments and the 
challenges of EC reproducibility. In addition, we discuss the synergy between EC 
and scientific workflows, presenting a set of new evolutionary modules and novel 
experiments. 
In this way, we show how VisPyGMO can overcome the challenges in EC while 
preserving the existing functionalities of the SWfMS. This manuscript develops and 
responds to a set of typical scientific competence questions (CQ) (Azzaoui et al., 
2013) related to the reproducibility challenges considered in EC investigations. We 
designed a multi-objective optimisation experiment in silico to show the feasibility 
of the approach.In Silico Evaluation and Prediction of Pesticide Supported by Reproducible... 137
The experiments considered a massive dataset of 20 years of data from the 
Pesticide Data Programme (PDP), a US pesticide residue monitoring programme 
(Monajemi et al., 2019; USDA, 2021); the evolutionary workflow extracts knowl￾edge from the dataset to predict future trends in pesticide usage. We implemented 
the entire framework, the dataset, the EA modules, and in silico experiments in the 
VisTrails system (Callahan et al., 2006). 
We organise this chapter as follows: Section 2 discusses the challenges of 
replicability and reproducibility of evolutionary workflows, followed by a detailed 
discussion of research questions. Section 3 presents the material and methods, 
and Sect. 4 presents our contribution named VisPyGMO. Section 5 contains the 
experimental evaluations. Finally, Sect. 6 highlights the contributions, limitations, 
and future work. 
2 Background 
2.1 Reproducibility Challenges in Evolutionary Computing 
Modern data science requires multi-cure, HPC, and large databases in unthink￾able ways at the turn of the twenty-first century. However, questions about the 
reproducibility of scientific experiments have gained visibility through several high￾profile journals, and EC investigations are no exception (Bartz-Beielstein & Preuss, 
2009; Bartz-Beielstein, 2006; Tauritz, 2009; Baker & Penny, 2016; Munafò et al., 
2017; Rougier et al., 2017; Benureau & Rougier, 2018; Allison et al., 2018; Maier 
et al., 2019). 
By replicability, we mean running the publicly available source code (known as 
workflows) developed by the authors, duplicating and getting consistent results to 
answer the same scientific questions using the original experimental setup (Rougier 
et al., 2017; Deelman et al., 2005; Habib et al., 2013). Reproducibility means 
(re)implementing the optimization model using the same knowledge available in 
the manuscript using another programming language than the one described in the 
original work (Rougier et al., 2017; Manninen et al., 2018; National Academies 
of Sciences E and M, 2019). Reproducibility requires the use of the same input 
data, computational steps, and methods but different experimental setup and analysis 
conditions to produce the same results. 
These definitions are consistent with the current terminology used in the scientific 
literature (National Academies of Sciences E and M, 2019; McDougal et al., 2016). 
However, there is an ongoing debate on its optimal use (Rougier et al., 2017; 
Benureau & Rougier, 2018; Allison et al., 2018; McDougal et al., 2016; Goodman 
et al., 2018). Bartz-Beielstein and Preuss (2009) and Tauritz (2009) highlighted the 
absence of commonly accepted terminology for EC and EA with respect to these 
definitions. To focus on EC research opportunities rather than its terminology, we 
consider the above definitions without further discussing the alternatives.138 A. Oliveira et al.
Table 1 Summary of challenges related to poor reproducibility in EC 
List of reproducibility challenges (RC) in evolutionary computing 
RC Gap Issue 
RC1 Insufficient record-keeping 
and poor computational 
efficiency 
Researchers do not record relevant digital artefacts, such 
as research protocols, datasets, hyperparameter tuning, or 
steps to get the results; the computational environment 
details are not transparent or complete because workflow 
tools have a high barrier to entry 
RC2 Flawed attempts to 
reproduce others’ research 
Researchers who attempted to reproduce the work could 
not properly follow the research protocols due to 
insufficient information 
RC3 Non-transparent reporting Researchers do not provide open access to relevant digital 
artefacts (e.g. input data, source code, evolutionary 
methods, hyperparameters, computational environment, 
and workflows) necessary to achieve reproducibility 
RC4 Lack of access to 
nonpublic datasets and 
source code of the EC 
experiments 
The absence of source code or datasets reduces the trust, 
attribution, and transparency of the experiments. 
However, each researcher’s manual record-keeping of 
multiple changes is burdensome and adds significant 
work to the research effort 
RC5 Barriers in the culture of 
open-sharable research 
Lack of incentives to adopt transparent and collaborative 
research, misaligned incentives for publication, or 
difficulty finding the time to provide self-training on 
data-sharing practices 
RC6 Obsolescence of the digital 
artefacts 
Technological upgrades, software evolution, or lack of 
data governance compromise the digital artefacts in the 
research corpus 
RC7 Poor data provenance 
management to adjust 
search behaviour 
There is a lack of support for fine-grained data 
provenance management, software versioning features, 
and data analytics 
According to Bartz-Beielstein and Preuss (2009), Tauritz (2009), Maier et al. 
(2019), Cheng et al. (2016), Drummond (2009), Callahan et al. (2006), and Izzo et 
al. (2009), replicability, instead of reproducibility, is prevalent in the EC community. 
The authors highlight that several investigations have various deficiencies that 
contribute to a loss of confidence in the metaheuristic. These issues can enlarge the 
gaps between theory and practice and reduce the reproducibility of its experiments. 
Table 1 presents the main reproducibility challenges in EC. 
The RC1 and RC2 challenges have a tight connection because researchers typi￾cally execute multiple EA and reasoning lines as researchers develop optimisation 
models, perform analysis, or formulate and test new hypotheses. This chain of 
processes requires executing many computational steps using various EAs, requiring 
a vast set of inputs (data and hyperparameters) in a computational environment 
comprising heterogeneous hardware and software. 
Furthermore, workflow runtimes can be minutes or even hours, and the search 
space can be substantial, requiring larger population sizes or the number of 
generations to find suitable solutions. However, current EC tools do not automateIn Silico Evaluation and Prediction of Pesticide Supported by Reproducible... 139
the complete optimisation process by creating evolutionary workflows, registering 
the provenance of experiments, and offering parallel computing to reduce overall 
runtime. 
RC3, RC4, and RC5 describe the computational barriers of in silico experiments 
that hinder reproducibility in EC investigations. They can be summarised as follows: 
(i) misapplication of open-source community-driven standards or interoperable 
definitions; (ii) lack of transparency of EA selection and execution of the com￾putational steps; (iii) insufficient registering of the entire corpus of artefacts and 
information necessary to (re) run the experiments, including the inadequate register 
of data provenance and dimensionality reduction techniques or misuse of metadata 
standards to annotate the dataset; and (iv) the EA hyperparameters, the source code, 
or the computational environment. 
RC6 and R7 represent other barriers to reproducibility in EC. Recent technologi￾cal advances in version control (e.g. GIT, GitHub, Jupyter notebooks), virtualisation 
of programming and executing environments (e.g. Virtual Machines, Kubernetes, 
Docker), and automatic provenance tracking can increase the data management 
efforts to ensure reproducibility and, simultaneously, expand data curation practices. 
These RCs are only part of a larger picture of the emerging trends in EC, and 
requirements can vary widely in EC. Hence, we foresee that offering innovative 
methodologies to support the creation of evolutionary experiments more easily 
would incentivise the EC researcher community’s much broader commitment to 
reproducibility. 
2.2 Evolutionary Scientific Workflows 
Modern scientific research has opened the opportunity to solve large-scale com￾putational problems that require multidisciplinary expertise. In silico experiments 
comprise a flow of scientific tasks (steps or activities) executed on a computing 
platform. Therefore, a common strategy to make these experiments more manage￾able and reproducible is to model them as scientific workflows using SWfMS (Crick 
et al., 2009; Rucinski et al., ´ 2010). 
The evolutionary scientific workflow is the automation of a scientific hypothesis, 
in which tasks compute the data resources according to a set of user-defined rules, 
producing the scientific results (data products) (Deelman et al., 2009; Baker & 
Penny, 2016; Munafò et al., 2017). The facilities offered by scientific workflows 
include rapid experiment design, improved reuse, scalable execution, and prove￾nance collection (Prabhu et al., 2011; Leveque et al., 2012; Sandve et al., 2013). 
According to Mattoso et al. (2010), people with exclusive skills in the scientific 
domain participate in the in silico lifecycle of experiments. We advocate a similar 
approach in evolutionary workflows. Figure 1 illustrates the three phases of the 
evolutionary workflow lifecycle. 
During the composition phase, workflows are abstract entities. They are concep￾tual artefacts of high level that describe only the sequence of logical tasks and their140 A. Oliveira et al.
Fig. 1 Phases of the in silico scientific life cycle experiment. Highlight evolutionary computing 
modules 
dependencies. Researchers describe data and computations as theoretical entities, 
whereas computations refer to logical entities mapped to one or more programmes. 
The abstract workflow simplifies the research process; it allows the research team 
to foresee a systematic approach to carry out the in silico experiment, providing 
flexibility to replace components with alternative implementations (Deelman et al., 
2005). 
The execution phase is the most complex phase of the lifecycle. Currently, the 
abstract workflow is mapped and implemented as a concrete workflow. Researchers 
do a lot of manual and highly specialised work. 
Concrete workflows describe the sequences of modules (tasks) to be executed 
and specify the computational resources required. For example, tasks range from 
data cleaning to building, evaluating, and training evolutionary models. 
The evolutionary scientific workflow is reproducible with feedback loops repre￾senting the computational problem and the optimisation cycle supporting the mul￾tiple patterns required by current optimisation problems. Compared to monolithic 
codes, evolutionary workflows provide users with a clear view of the flow within the 
optimisation process, making it easier to test and substitute optimisation modules. 
Today, few studies in the scientific workflow domain recognise the advantage of 
devising and solving optimisation problems using evolutionary scientific workflows. 
The composition of scientific workflows uses traditional algorithms and takes 
fewer input data to produce more outputs. Alternatively, evolutionary workflows use 
either EA or traditional algorithms. However, exploratory analysis requires many 
input data and sweep parameters to produce one or a few outputs. The key features 
of reproducible evolutionary scientific workflows are as follows:In Silico Evaluation and Prediction of Pesticide Supported by Reproducible... 141
• Randomness in the data access pattern: Evolutionary workflows mimicked 
biological evolution. As a result, they show more randomness in the access 
pattern caused by the sampling of input files for achieving convergence of the 
optimisation process.
• Data optimisation: The workflow notation should support data objects that can 
adequately represent the experiment, optimisation plan, and datasets (like the 
Pareto front). Moreover, proper support for data transformation must be provided, 
for example, to filter a set of designs or select the Pareto front.
• Dimensionality reduction: The selection of features significantly impacts the 
effectiveness of EA because the feature vector is generally large and sparse. Thus, 
reducing the number of features used in the classification while maintaining 
accuracy is essential in EC.
• Asynchronous communication: EA and related modules, like robust optimisation 
activities, require evaluation of designs in asynchronous terms.
• Concurrent execution: SWfMS should provide mechanisms to support the 
solver’s parallel execution and other modules, like robust optimisation.
• Instance routing: Since there will be many instances of the same process running 
concurrently, the messaging system should deliver the instances’ messages, being 
handled through an adequate correlation model, ensuring that data will flow 
between the modules as required. 
2.3 Island Model Optimisation Paradigm 
EC is increasingly popular within the scientific community and has been an active 
research area since the 1970s, where various successful applications in agriculture 
and engineering have been reported (Habib et al., 2013; Yu et al., 2021; Singh & 
Misra, 2017). EC is a subarea of artificial intelligence that comprises a family of 
nature-inspired solutions based on the theory of evolution that apply to real-world 
problems. 
Evolutionary algorithms (EAs) share a joint conceptual base to simulate the 
evolution of individual structures through reproduction, mutation, and selection 
processes. For Märtens and Izzo (2013) and Holland (1992), these processes are 
based on the perceived performance (fitness) of individual structures defined by the 
environment. 
Abramson et al. (2010) described EA as a cycle that involves a repetitive loop to 
pass the results from one iteration to the second (Fig. 2). According to Eiben and 
Smith (2015), there are well-defined steps to obtain a working EA. The first step 
identifies a representation: an appropriate data structure representing the range of 
potential solutions to the problem. The following step defines a way of measuring 
an individual’s quality based on problem-specific requirements. Finally, the last step 
specifies the proper selection and mutation operators.142 A. Oliveira et al.
Fig. 2 The figure depicts the steps of an EA as an optimisation cycle to find optimal solutions 
EA investigation includes single-objective optimisation (global), multi-objective 
optimisation, many-objective optimisation, dynamic optimisation, and constrained 
optimisation problems. It is an extensive research area. In this work, we focus on 
offering a set of reusable EA modules related to global optimisation and multi￾objective algorithms to solve real-world optimisation problems. 
This work considered the Island Model (IM) paradigm proposed by Izzo et 
al. (2009, 2012) and Rucinski et al. ( ´ 2010). IM allows scientists to distribute the 
EA over multiple processors. IM is a coarse-grained model that uses efficient 
parallelisation of global optimisation heuristics inspired by the theory of punctuated 
equilibria presented by Eldredge and Gould (1988). The model can be implemented 
for heterogeneous metaheuristic global optimisation based on different natural 
patterns, such as artificial bee colony (ABC), particle swarm optimisation (PSO), 
differential evolution (DE), or simulated annealing (SA), to name a few (Kirkpatrick 
et al., 1983; Kennedy & Eberhart, 1995). 
IM has advantages compared to other related models. For example, it explores the 
internal parallelism and concurrency of multi-core CPUs. In addition, the paradigm 
improves communication and data efficiency and reduces the latencies associated 
with message transfer using only local data files. Moreover, it is flexible enough to 
allow islands to run the same or different metaheuristic algorithms. The fundamental 
motivation behind our choice is that different EAs have different convergence and 
search properties; combining these algorithms leads to better solutions in a shorter 
time. 
IM is a general model for solving single- and multi-objective optimisation 
problems using high-performance parallel algorithms. The model is a general 
paradigm applied to EA and a broader family of optimisation processes that can 
even form heterogeneous archipelagos of islands where each island can use itsIn Silico Evaluation and Prediction of Pesticide Supported by Reproducible... 143
algorithm (Fernández de Vega et al., 2012). Like Crick et al. (2009), we consider 
an archipelago A as a pair. 
A =< I,T > (1) 
where I = {I1, I2, ... , In} is the set of islands and T is the migration topology, a 
directed acyclic graph (DAG) with I as the set of vertices. Furthermore, every island 
Ii is a quadruple: 
I =< Ei, Pi, Mi, Yi > i = {1, 2,...n} (2) 
where Ei is the EA used by the ith island, Pi is the population contained there, 
and Mi and Yi are, respectively, the migration-selection policy and migration 
replacement policy for the island. A population Pi is a couple <σ, τ> containing a 
set of individuals τ whose fitness value refers to the problem σ we consider solving. 
According to Izzo et al. (2009, 2012) and Rucinski et al. ( ´ 2010), an island I 
is an abstraction of any parallel entity, i.e. a thread, a CPU core, or a computing 
node in an extensive network. The population, P, of the islands, frequently 
evolves independently but can exchange M individuals between islands after several 
iterations in a process named migration-replacement Y. Migration allows only for 
one specific migration path between islands, defined by a DAG called topology. 
For Märtens and Izzo (2013), by restricting migration paths, the islands maintain 
their niche where evolution can evolve, which is visiting regions of a search 
space within the neighbourhood of the point previously visited (Crepinsek et al., 
2013). However, it receives new genetic material from other populations, maintains 
diversity, prevents premature convergence, and visits new search space regions. 
Märtens and Izzo (2013) stressed that the migration process improves and speeds 
up optimisation more than a single EA. For example, when connected to different 
optimisation algorithms such as ABC, DE, SO, SA, improved harmony search, or 
many more metaheuristics (Rucinski et al., ´ 2010), the set of all islands together 
within a topology is an archipelago. Every individual in an archipelago links to a 
solution to the optimisation problem establishing the global Pareto front. It opposes 
the local Pareto front comprising the solutions on a single island. 
3 Materials and Methods 
3.1 Materials 
Pesticides have the dual characteristics of being harmful and helpful to humans and 
are essential chemicals for ensuring food security. Therefore, the rational use and 
effective control of pesticides are critical to human health and the environment. 
The datasets used in our in silico experiments are based on the control of pesticide144 A. Oliveira et al.
residues in food samples. The Kaggle database (https://www.kaggle.com/usgs/ 
pesticide-use) offered the datasets produced by PDP (USDA, 2021) (https://www. 
ams.usda.gov/datasets/pdp). 
PDP is an American programme that monitors pesticide residues that test various 
domestic and imported foods for pesticide residues. PDP monitors and reports 
the use of pesticides and ensures that pesticide residues remain safe in domestic 
or imported food samples (Habib et al., 2013). The programme activities include 
the sampling, testing, and reporting of pesticide residues in dozens of agricultural 
commodities in the US food supply, with importance for those consumed by toddlers 
and children. 
For this study, we borrowed 20 years of PDP data from 1995 to 2015 (about 80 
MB of .mdb files and 35 million registries). The dataset includes annual county￾level pesticide use of active ingredients of pesticides applied to crops grown in the 
contiguous USA and includes more than 28 million chemical analyses. Therefore, 
one of the biggest challenges in handling the dataset is to convert these features into 
something meaningful to build a predictive model. 
We used low-cost computers for all experiments: an Intel-based core i7 (CPU 
at 4.20 GHz), 12 GB of RAM, and a Geforce GTX780Ti GPU graphic card. We 
run the evolutionary workflows on VisTrails system version 2.2.4, OpenSUSE 
operating system version 42.2, PaGMO/PyGMO C++ library version 1.1.5, 
and Python versions 2.7 and 3.0. Python scripts are available at https://github. 
com/SergioMSerra/PPGI_DataScience/blob/main/Scripts_Graphics_Information_ 
Processing_In_Agriculture.ipynb. 
3.2 Methodology 
Like Märtens and Izzo (2013), the methods adopted in our implementation use the 
foundations presented in Sect. 2 and asynchronous communication between the 
islands. Our implementation uses multiple threads of execution and asynchronous 
communication through the shared memory mechanism. Thus, optimisation on 
islands maps threads at the operating system level. The hierarchy of the modules 
is defined as follows:
• A problem is a function that accepts input as a vector of feature values (i.e. 
pesticide samples in our experiments) and returns output as a double precision 
value (i.e. the fitness value).
• A population Pi is a collection of pesticide samples coupled with a problem.
• An island Ii is a population coupled with an EAi used to optimise pesticides 
associated with the population Pi.
• An archipelago A is a collection of islands coupled with (a) a topology that 
describes how the islands are connected and (b) a migration Y, specifying the 
details of the migration algorithm.In Silico Evaluation and Prediction of Pesticide Supported by Reproducible... 145
We implemented in silico computational experiments as a reproducible evolu￾tionary workflow using VisPyGMO modules; we have set the IM modules on top 
of VisTrails (Fig. 4) to execute concrete workflows to analyse many input files 
(achieved from Kaggle) and produce one output, the trained model. 
Let us examine the implications of the modules described in the previous 
sections. We underline that the approach adopted here is not an econometrically 
sophisticated forecasting method but a prediction experiment using workflows, the 
EC, EA, and IM paradigms. 
Our experiments explain how VisPyGMO can answer the prioritised scientific 
competency (CQ) questions. A CQ defines the current needs for data integration. 
The relevance of the CQs is reflected in their general nature rather than in the 
specific questions per se. We stress that CQs are hard to answer without the 
execution of EA in evolutionary workflows.
• CQ1—Can we achieve descriptive statistics on the volume of commodities, 
pesticide residues, and types of pesticides found in food samples in the datasets?
• CQ2—Can we generate the ranking of the most common pesticide residues 
detected in food samples in the dataset?
• CQ3—What are the chemical classes of the most common pesticides detected in 
food samples?
• CQ4—Can we predict the trends in the use of pesticides of the most used 
commodities in the next five years? 
4 Results 
The primary objective of VisPyGMO is to offer an extensible and generic frame￾work to help researchers build and execute evolutionary workflows and avoid the 
reproducibility challenges discussed in Sect. 2. 
We centred our design on Izzo’s work and the VisTrails system because it is 
a stable and modular SWfMS that provides facilities for creating and executing 
reproducible workflows efficiently in Python. VisPyGMO enables researchers to 
model workflows using a familiar programming language with a rich ecosystem 
of existing software and documentation. Finally, VisTrails conveniently supports 
external modules to develop scientific workflows despite still lacking single- and 
multi-objective optimisation algorithms. 
VisPyGMO is applied in situations to deal with single- and multi-objective 
optimisation problems. In addition, it takes advantage of the parallelisation abstrac￾tion built around the IM paradigm, meaning that the algorithm is asynchronously 
parallelised, efficiently using the underlying multi-core architecture of the com￾puting host node. We encapsulated eight new implementations of multi-objective 
optimisation EA in VisPyGMO. 
Figure 3 illustrates a screenshot of the VisTrails system, and the grey canvas is 
the primary workspace where the scientist can build the workflows. The lower left146 A. Oliveira et al.
Fig. 3 Screenshot of VisPyGMO EA modules in VisTrails (red dotted box in the lower left 
palette), workflow builder canvas (the grey canvas in the middle), and workflow setup (blue dotted 
area in the upper right palette) 
palette shows the VisPyGMO modules; each has an array of parameters and typed 
connections. 
The composition of the evolutionary workflow is simple, where the researcher 
must drag the EC modules and drop them into the grey canvas. The following 
subsections describe the list of encapsulated EAs and their implementations (Fig. 4). 
4.1 Evolutionary Algorithm Modules 
The PyGMO package uses the VisTrails infrastructure and easily integrates with 
other user-defined functions and libraries. The package is an assemblage of Python 
classes stored in one or more files, and each class is an EA module. Due to the 
modularity of VisTrails, we quickly added the EA and IM modules to the system 
as new Python packages. Table 1 indicates the list of single and multi-objective 
algorithms used in VisPyGMO. 
The VisPyGMO package provides a simplified user interface to help researchers 
develop evolutionary workflows in parallel environments as efficiently as possible. 
In addition, we provide several EA that can solve single- or multi-objective 
optimisation problems.In Silico Evaluation and Prediction of Pesticide Supported by Reproducible... 147
Fig. 4 Example of a fragment of the evolutionary scientific workflow developed in VisTrails 
builder canvas using the EA modules 
Table 2 describes each algorithm and its name, type, package and module names, 
and the class of optimisation problem it solves (the description of problem types 
is available in PyGMO (2021)). For the sake of simplicity, we have classified the 
modules as (Continuous (C), integer, or mixed integer (Mi))-(Constrained (Co), 
Unconstrained (U))-(Single (S), Multi-objective (Mu)). 
We reused the PyGMO (2021) libraries for the following reasons. First, they 
provide more than 50 general-purpose optimisation algorithms distributed in three 
categories (heuristic, metaheuristic, and local optimisation). 
Second, the library offers native support for parallel computing with the message￾passing interface (MPI). The paradigm allows us to distribute the EA modules 
of the workflow over multiple processors while using a genetic operator. The 
genetic operator is a migration operator that takes advantage of overall algorithmic 
performance and speeds up workflow execution. For example, in an optimisation 
process, one can open multiple threads and explore the local machine’s parallelism 
or load distribution through MPI calls in parallel processing environments (CPU, 
GPU, HPC, or clouds).148 A. Oliveira et al.
Table 2 Summary of evolutionary algorithms available in VisPyGMO 
Heuristic global optimisation algorithms 
Algorithm name EA type Package name VisTrails module Problem type 
Differential 
Evolution (DE) 
Simple pygmo.de AlgorithmDE C-U-S 
Self-adaptive DE 
(jDE) 
Simple pygmo.sade AlgorithmSDE C-U-S 
Particle Swarm 
Optimisation (PSO) 
Simple pygmo.pso AlgorithmPSO C-U-S 
(N+1)-ES Simple 
Evolutionary 
Algorithm 
Simple pygmo.sea AlgorithmNSDE I-U-Mu 
Simple Genetic 
Algorithm (SGA) 
Simple pygmo.sga AlgorithmGA Mi-U-S 
Corona’s Simulated 
Annealing (SA) 
Simple pygmo.simulated_annealing AlgorithmSA C-U-S 
Artificial Bee 
Colony (ABC) 
Simple pygmo.bee_colony AlgorithmABC C-U-S 
Non-dominated 
Sorting GA 
(NSGA2) 
Multi pygmo.nsga2 AlgorithmNSGA C-U-Mu 
Third, the scientist can design his solvers, which VisPyGMO will parallelise 
because the generalised migration operator allows them to define the topologies 
(migration paths) between many islands (CPU multi-core). Finally, scientists can 
develop reusable workflows more easily, relying on the built-in provenance support 
and version control offered by VisTrails. 
Implementing the generalised asynchronous island model in VisTrails describes 
the island module (I), a population (P), and an evolutionary algorithm (EA). The 
class is the object responsible for launching the thread that applies the algorithm 
to evolve the population. Like EA modules, IM modules can be integrated into the 
workflow during design time, helping researchers deal with EC development issues. 
Population migrations occur at the end of each evolution cycle. Evolution 
happens in the background on a dedicated thread, while the data flows continue 
to run. An archipelago (A) is a container of the island and starts the asynchronous 
Island Model. 
Table 3 indicates the modules used to implement the IM paradigm in VisTrails. 
These modules represent the islands (I), the archipelago (A), and the method used 
to obtain the population (P).In Silico Evaluation and Prediction of Pesticide Supported by Reproducible... 149
Table 3 List of Island Model modules and packages in VisPyGMO 
Parallel Island Models 
Component name Package name IM paradigm 
Island (I) pygmo.thread_island Island 
GetPopulation (P) pygmo.island Population 
FacedIslandEvolve, Parseisland and CloneIsland (A) pygmo.island Archipelago 
5 Discussion 
EA in evolutionary workflows is a robust method to effectively reach the Pareto 
optimal front in single- and multi-objective optimization problems. Another benefit 
of using EA in workflows is that SWfMS efficiently exploits data parallelism while 
taking advantage of similarities of solutions by recombination. Such combinations 
can approximate the Pareto optimal front in a single workflow execution. SWfMS 
provides mechanisms for tracking provenance and other methodologies that pro￾mote reproducible science. 
So far, we have explained the framework and existing implementations of 
single- and multi-objective algorithms integrated into the VisPyGMO. Therefore, 
to evaluate and confirm the feasibility and usability of the proposed approach, we 
introduce a state-of-the-art pesticide prediction using EA embedded in evolutionary 
workflows to show how components analyse the massive dataset and study pesticide 
residues in fresh food samples. 
Pesticides protect food production and meet global food production; they are 
widely used to control unwanted organisms in agriculture around the world (Sharma 
et al., 2019; Tang et al., 2021). There are five major chemical groups of pesticides: 
organochlorines, organophosphorus, carbamates, pyrethrin, and pyrethroids. 
These chemicals should be applied accordingly; otherwise, they harm the 
environment and non-target organisms, including humans. The study of pesticide 
residues is critical for consumers and the entire food production chain. These 
studies find which pesticides will harm human health (USDA, 2021). In summary, 
predicting the limits on how much a pesticide should be applied to food during 
growth, processing, and storage and how much can persist in food that reaches the 
consumer is a crucial global concern (FAO, 2009). 
5.1 Answering Competency Questions 
We set up and execute the reusable evolutionary workflow as computational 
experiments to answer the competency questions (CQ1 to CQ4) presented in the 
previous subsection. We executed the reproducible evolutionary workflow ten times 
using the modules presented in Sect. 4.150 A. Oliveira et al.
Execution of the workflows was performed on a low-cost computer described 
in Sect. 3. The EA algorithm started with random starting points and was limited 
to 10,000 evaluations of objective functions and 20 islands, corresponding to 500 
generations with dataset registries. The data generated by the reusable evolutionary 
workflows were visualised using Python scripts. 
5.1.1 CQ 1: Descriptive Statistics 
Descriptive statistics form a significant part of quantitative data analysis. When 
coupled with graphical analyses, they summarise the samples and measures carried 
out in a study. 
Figures 7, 8, 9, and 10 illustrate the answers to the Competence Question 
CQ1; they illustrate the descriptive statistics of the dataset. Sample datasets store 
chemical analyses of commodities (e.g. fruit, vegetables, rice, catfish, beef muscle, 
groundwater, and treated and untreated drinking water exposed to one or more 
pesticides). 
We selected the samples analysed for the commodities without regard to country 
of origin, variety, growing season, or organic labelling. Our experiments considered 
the total number of samples analysed annually; the total amount analysed is 
28,431,358.00. Figure 5a (left) reveals the linear regression of the commodity series, 
an estimate of the central tendency, and a confidence interval (95%) for this estimate. 
Figure 5b (right) shows the distribution of the commodities analysed. We notice 
variations throughout the years; the mean value of the commodities analysed is 
21.952381, having a standard deviation of 4.758951 and a negative skewness of 
−0.441110, which means an almost symmetric distribution of the commodities 
during the evaluated time. 
Figure 6a (on the left) shows the linear regression of the pesticide series detected 
in the samples. It considers the central tendency and a confidence interval (95%) for 
that estimate. Figure 6b (on the right) illustrates the distribution of the pesticides 
Fig. 5 Overview of linear regression of commodities with 95% confidence intervals on the left (a) 
and distribution of commodities on the right (b)In Silico Evaluation and Prediction of Pesticide Supported by Reproducible... 151
Fig. 6 Linear regression of the pesticides on the left (a). Visualisation of the distribution of the 
pesticides on the right (b) 
Fig. 7 Overview of linear regression of the samples of commodities analysed on the left (a) and 
distribution on the right (b) 
detected in the analysed samples. We emphasise that the number of residues in food 
samples has increased. 
The mean value of the pesticides analysed is 272.000000, having a standard 
deviation of 101.277836 and a reduced skewness of 0.023511. This means an almost 
symmetric distribution of pesticides in the samples evaluated during the period. 
Figure 7a (left) shows the linear regression of the samples considered extracted 
from the commodities. It estimates the central tendency and a confidence interval 
(95%) for this estimate. Figure 7b (right) shows the distribution of the data analysed. 
The mean value of the analysed samples is 1.349112e+06, having a standard 
deviation of 6.284437e+05 and a reduced skewness of 0.008422, which means an 
approximately symmetric distribution. 
We emphasise that the number of analyses to detect pesticide traces has increased 
dramatically during the last few years of the series, with a higher density of 
analyses during the second decade of the investigation (2005–2015). It is probably 
in alignment with global awareness of the growing use of pesticides around the 
world, as described by Sharma et al. (2019). 
Figure 8 illustrates two density plots with the distribution analysis during the two 
decades of examination.152 A. Oliveira et al.
0.10 
Density Plot of Analyzes Realized by Decade 
0.08 
0.06 
density 
0.04 
0.02 
0.00 
1990 
1995 
2000 
2005 
2010 
Year 
2015 
2020 
Decade 2- 2005-2015 
Decade1- 1995-2004 
Fig. 8 Density graphs with the distribution of food sample analyses performed during the two 
decades of examination 
5.1.2 CQ 2: Ranking of Pesticide Traces 
Figure 9 illustrates the output of the evolutionary workflow, answering the com￾petency question CQ2. It shows the top ten traces of pesticides detected in food 
samples from 1995 to 2015. The total number of samples with these pesticides is 
2,122,733 (about 7.47% of the registries in the original dataset). Figure 9 shows the 
number of samples with residues of these pesticides. We can see that malathion is 
the most used active ingredient in the period and myclobutanil is the fungicide in 
the top ten pesticides. 
5.1.3 CQ 3: Classification of the Top Ten Pesticides 
Figure 10 replies to the competence question CQ3; the figure shows a sunburst 
diagram suitable for understanding how the output of the evolutionary workflow 
is composed. The graphic illustrates the relationships between pesticides, their 
chemical classes, and the sum of contaminated samples. Figure 10 illustrates the 
classification of pesticides. The first external ring of the graph shows the pesticide 
classification and the amount of each pesticide detected in the samples; the second 
intermediary ring shows the chemical classification of the pesticides. The internal 
ring shows whether the pesticide is in the insecticide or fungicide class.In Silico Evaluation and Prediction of Pesticide Supported by Reproducible... 153
2.000e+5 
Ranking - Top 10 Pesticides Traces 
1.500e+5 
1.000e+5 
5.000e+4 
0.000e+0 
Malathion 
Chiropythos 
Carbaryl 
Methomyl 
Mydobutanil 
Diazinon 
Dimethoate 
Endosulfan I 
Endosulfan II 
Endosulfan Sulfate 
Fig. 9 Ranking of the top ten pesticides found in food samples 
We note that nine of the top ten pesticides detected in the samples are insecticides 
and one is a fungicide. In summary, insecticides are chemicals synthesised to harm, 
repel, mitigate, or kill one or more species of insects. Insecticides control pests that 
infest cultivated plants or eliminate disease-carrying insects in fields, and fungicides 
are pesticides that kill or prevent the growth of fungi and their spores. They can 
regulate and control fungi that damage plants, such as rust, blight, and mildew. 
The second ring of Fig. 10 shows the most common classes of pesticides 
found in the samples. There are three classes of insecticides (e.g. organophosphate, 
organochlorine, and carbamate) and fungicides (e.g. triazole). 
5.1.4 CQ 4: Prediction of Malathion Use 
Figures 11 and 12 show the prediction and answer to the competency question CQ4. 
Figure 11 shows the rolling mean of the malathion time series, and Fig. 12 shows 
a graphical projection of the autoregressive integrated moving average (ARIMA) 
using VisPyGMO modules considering the pesticide that is the most widely used 
illustrated in Fig. 9.154 A. Oliveira et al.
Diazinon 9,91% 
Malathion 10,99% 
Myclobutanil 9,95% 
Triazole 9,95% 
Fungicide 
Inseticide 
Organochlorine 28,40% 
Methomyl 9,95% 
Endosulfan Sulfate 9,43% 
Endosulfan II 9,48% 
Endosulfan I 9,49% 
Dimethoate 9,49% 
Organophosphate 41,10% 
Chlorpyrifos 10,72% 
Carbaryl 10,59% 
Traces 
Carbamate 20,55% 
Fig. 10 Sunburst diagram distribution of the chemical classes of the top ten pesticides and their 
chemical classification 
15000 
Malathion series 
Rolling Mean 
Rolling Mean & Malathion Series 
14000 
13000 
Malathion 
11000 
12000 
10000 
1995.0 
1997.5 
2000.0 
2002.5 
2005.0 
2007.5 
2010.0 
2012.5 
2015.0 
Year 
Fig. 11 Visualization of malathion time series and rolling mean seriesIn Silico Evaluation and Prediction of Pesticide Supported by Reproducible... 155
9.55 
9.50 
9.45 
9.40 
Quantity 9.35 
9.30 
9.25 
0 5 10 15 
Years between 1995-2020 
Forecast 
20 25 30 
forecast 
Malathion 
35% confidence interval 
Fig. 12 ARIMA projection (quantity × time) with the prediction of Malathion usage in 2016– 
2020. The red dotted line denotes the forecast 
The ARIMA model is compared to most exponential smoothing models (Hynd￾man & Athanasopoulos, 2013). We chose ARIMA because it analyses and forecasts 
uniformly spaced univariate statistical data. Figure 12 shows the data series and the 
prediction of malathion use in the period 2016–2020. The experiments had an error 
rate and a tolerance of 35% in calculating the projections. 
Figure 12 shows that malathion (a class of the organophosphate class) has 
decreased since 2007. EPA reports support our evaluation and prediction (EPA, 
2018). The estimate of organophosphate insecticides has declined by more than 70% 
since 2000. The decrease in organophosphate reflects a change in the use of other 
classes of pesticides (i.e. pyrethroids, neonicotinoids, and other new chemistries) 
due to the elimination of and the use restrictions placed on organophosphates due to 
the review of pesticide registration. 
6 Conclusions 
As the human population grows, the demand to produce healthier food sustain￾ably increases. At the same time, operations research significantly contributes to 
solving various complex optimization agricultural problems. Traditionally, oper￾ations research employs statistics, optimisation techniques, and other analytical 
approaches to model and solve complex decision-making problems in the agri-food 
supply chain (Soto-Silva et al., 2016; Mauttone & Plà-Aragonés, 2022). 
However, these fields of knowledge still face issues regarding how to quickly 
transform a massive amount of agricultural data into helpful information for156 A. Oliveira et al.
decision-makers considering the reproducibility of optimisation computations. In 
this chapter, we present a novel computational approach that combines evolutionary 
and scientific workflows to assist users with little knowledge of optimisation 
techniques to compute large real-world datasets. 
Evolutionary workflows are considered a way to automate decision-making with 
a compilation of known sequences of actions for a routine procedure. Our approach 
offers end-to-end support to effectively reach the Pareto optimal front in single- and 
multi-objective optimisation problems using workflows. 
VisPyGMO presents an extensible framework with eight well-known single￾objective optimisation modules based on the Island Model paradigm. The experi￾ments analysed a massive dataset to predict the use of pesticides in agriculture and 
presented visualisations of the predictions. 
In future work, we plan to expand the range of single- and multi-objective 
EAs and evaluate novel combinations of these algorithms. For example, we are 
developing new heuristic optimisation modules (e.g. Monte Carlo search and 
strength Pareto), meta-algorithm modules, and local optimisation modules (e.g. 
compass search). 
We intend to continue investigating formal representations for abstract and 
execution models for evolutionary workflows in other knowledge domains, such 
as Soil Security and the OpenSoils platform (Cruz et al., 2018). Finally, we propose 
the enrichment of VisPyGMO with integration with a robust cloud computing and 
storage solution from AWS and FAIR Data Principles (Wilkinson et al., 2016). 
Acknowledgments This study was partially funded in part by the Coordenação de Aperfeiçoa￾mento de Pessoal de Nvel Superior – Brazil (CAPES) – Finance Code 001 and partially 
sponsored by the National Council of Scientific and Technological Development (CNPq) – Grant 
DT II (315399/2018-0, 306115/2021-2) and project (400044/2023-4), Brazilian National Fund 
to Develop Education (FNDE), Educational Tutorial Programme (PET-SI/UFRRJ), and Carlos 
Chagas Filho Research Foundation (FAPERJ). We thank the BigDSSAgro CYTED network. 
References 
Abramson, D., Bethwaite, B., Enticott, C., Garic, S., Peachey, T., Michailova, A., et al. (2010). 
Embedding optimization in computational science workflows. Journal of Computational 
Science, 1, 41–47. https://doi.org/10.1016/j.jocs.2010.04.002 
Allison, D. B., Shiffrin, R. M., & Stodden, V. (2018). Reproducibility of research: Issues and 
proposed remedies. Proceedings of the National Academy of Sciences of the United States of 
America, 115, 2561–2562. https://doi.org/10.1073/pnas.1802324115 
Al-Sahaf, H., Bi, Y., Chen, Q., Lensen, A., Mei, Y., Sun, Y., et al. (2019). A survey on evolutionary 
machine learning. Journal of the Royal Society of New Zealand, 49, 205–228. https://doi.org/ 
10.1080/03036758.2019.1609052 
Azzaoui, K., Jacoby, E., Senger, S., Rodríguez, E. C., Loza, M., Zdrazil, B., et al. (2013). Scientific 
competency questions as the basis for semantically enriched open pharmacological space devel￾opment. Drug Discovery Today, 18, 843–852. https://doi.org/10.1016/j.drudis.2013.05.008In Silico Evaluation and Prediction of Pesticide Supported by Reproducible... 157
Baeck, T., Fogel, D. B., & Michalewicz, Z. (1997). Handbook of evolutionary com￾putation (1st ed.). Thomas Baeck - D. CRC Press. 1130-undefined. Retrieved April 
22, 2021, from https://www.routledge.com/Handbook-of-Evolutionary-Computation/Baeck￾Fogel-Michalewicz/p/book/9780750308953 
Baker, M., & Penny, D. (2016). Is there a reproducibility crisis? Nature, 533, 452–454. https:// 
doi.org/10.1038/533452A 
Bartz-Beielstein, T. (2006). Research in evolutionary computation. In Exp. Res. Evol. Comput. (pp. 
3–12). Springer-Verlag. https://doi.org/10.1007/3-540-32027-x_1 
Bartz-Beielstein, T., & Preuss, M. (2009). The future of experimental research. In Proc. 11th 
Annu. Conf. companion Genet. Evol. Comput. Conf. - GECCO ’09 (p. 3185). Association for 
Computing Machinery (ACM). https://doi.org/10.1145/1570256.1570417 
Benureau, F. C. Y., & Rougier, N. P. (2018). Re-run, repeat, reproduce, reuse, replicate: Transform￾ing code into scientific contributions. Frontiers in Neuroinformatics, 11, 69. https://doi.org/ 
10.3389/fninf.2017.00069 
Callahan, S. P., Freire, J., Santos, E., Scheidegger, C. E., Silva, C. T., & Vo, H. T. (2006). VisTrails: 
Visualization meets data management. In Proc. ACM SIGMOD Int. Conf. Manag. Data (pp. 
745–747). ACM Press. https://doi.org/10.1145/1142473.1142574 
Cheng, S., Liu, B., Shi, Y., Jin, Y., & Li, B. (2016). Evolutionary computation and big data: Key 
challenges and future directions. In Lect Notes Comput Sci (Including Subser Lect Notes Artif 
Intell Lect Notes Bioinformatics) (Vol. 9714, pp. 3–14). LNCS. https://doi.org/10.1007/978-3-
319-40973-3_1 
Coello Coello, C., Lamont, G. B., & van Veldhuizen, D. A. (2007). Basic concepts. In Evol. 
Algorithms Solving Multi-objective Probl. (pp. 1–60). Springer US. https://doi.org/10.1007/ 
978-0-387-36797-2_1 
Crepinsek, M., Liu, S. H., & Mernik, M. (2013). Exploration and exploitation in evolutionary 
algorithms: A survey. ACM Computing Surveys, 45. https://doi.org/10.1145/2480741.2480752 
Crick, T., Dunning, P., Kim, H., & Padget, J. (2009). Engineering design optimization using 
services and workflows. Philosophical Transactions of the Royal Society A: Mathematical, 
Physical and Engineering Sciences, 367, 2741–2751. https://doi.org/10.1098/rsta.2009.0035 
Cruz, S. M. S., Ceddia, M. B., Schmitz, E. A., Rizzo, G. S., Miranda, R. C. T., Cruz, S. O., Correa, 
A. C., Klinger, F., Marinho, E. C., & Cruz, P. V. (2018). Towards an e-infrastructure for Open 
Science in Soils Security. Anais Do Brazilian E-Science Workshop (BreSci). https://doi.org/ 
10.5753/bresci.2018.3273 
Da Cruz, S. M. S., Campos, M. L. M., & Mattoso, M. (2009). Towards a taxonomy of provenance 
in Scientific Workflow Management Systems. In Serv. 2009 - 5th 2009 World Congr. Serv. (pp. 
259–266). https://doi.org/10.1109/SERVICES-I.2009.18 
Da Cruz, S. M. S., De Oliveira, A., & Firmino De Faria, F. (2018). Evolutionary scientific 
workflows. In 2018 IEEE Congr. Evol. Comput. CEC 2018 - Proc. Institute of Electrical and 
Electronics Engineers Inc.. https://doi.org/10.1109/CEC.2018.8477850 
Dalal, S. R., Shekelle, P. G., Hempel, S., Newberry, S. J., Motala, A., & Shetty, K. D. (2013). 
A pilot study using machine learning and domain knowledge to facilitate comparative 
effectiveness review updating. Medical Decision Making, 33, 343–355. https://doi.org/10.1177/ 
0272989X12457243 
Deelman, E., Gannon, D., Shields, M., & Taylor, I. (2009). Workflows and e-Science: An overview 
of workflow system features and capabilities. Future Generation Computer Systems, 25, 528– 
540. https://doi.org/10.1016/j.future.2008.06.012 
Deelman, E., Singh, G., Su, M. H., Blythe, J., Gil, Y., Kesselman, C., et al. (2005). Pegasus: 
A framework for mapping complex scientific workflows onto distributed systems. Scientific 
Programming, 13, 219–237. https://doi.org/10.1155/2005/128026 
Drummond, C. (2009). Replicability is not reproducibility: nor is it good science. Undefined. 
Eiben, A. E., & Smith, J. (2015). From evolutionary computation to the evolution of things. Nature, 
521, 476–482. https://doi.org/10.1038/nature14544 
Eldredge, N., & Gould, S. J. (1988). Punctuated equilibrium prevails [5]. Nature, 332, 211. https:/ 
/doi.org/10.1038/332211b0158 A. Oliveira et al.
FAO. (2009). Submission and evaluation of pesticide residues data for the estimation of maximum 
residue levels in food and feed. FOOD Agric Organ UNITED NATIONS 2009. Retrieved April 
23, 2021, from http://www.fao.org/3/i1216e/i1216e00.htm 
Fernández de Vega, F., Hidalgo Pérez, J. I., & Lanchares, J. (Eds.). (2012). Parallel architectures 
and bioinspired algorithms (Vol. 415). Springer Berlin Heidelberg. https://doi.org/10.1007/ 
978-3-642-28789-3 
Goodman, S. N., Fanelli, D., & Ioannidis, J. P. A. (2018). What does research reproducibility 
mean? In Get. to Good Res. Integr. Biomed. Sci. (Vol. 8, pp. 96–102). Springer International 
Publishing. https://doi.org/10.1126/scitranslmed.aaf5027 
Habib, I., Anjum, A., McClatchey, R., & Rana, O. (2013). Adapting scientific workflow structures 
using multi-objective optimization strategies. ACM Transactions on Autonomous and Adaptive 
Systems, 8, 1–21. https://doi.org/10.1145/2451248.2451252 
Holland, J. H. (1992). Adaptation in natural and artificial systems. MIT Press. Retrieved April 23, 
2021, from https://mitpress.mit.edu/books/adaptation-natural-and-artificial-systems 
Hyndman, R. J., & Athanasopoulos, G. (2013). Forecasting: Principles and practice (3rd ed.). 
OText. Retrieved April 23, 2021, from https://otexts.com/fpp3/ 
Izzo, D., Rucinski, M., & Ampatzis, C. (2009). Parallel global optimisation meta-heuristics using ´
an asynchronous island-model. In 2009 IEEE Congr. Evol. Comput. CEC 2009 (pp. 2301– 
2308). https://doi.org/10.1109/CEC.2009.4983227 
Izzo, D., Rucinski, M., & Biscani, F. (2012). The generalized Island model. ´ Studies in Computa￾tional Intelligence, 415, 151–169. https://doi.org/10.1007/978-3-642-28789-3_7 
Kaufmann, P., & Castillo, P. A. (Eds.). (2019). Applications of evolutionary computation (Vol. 
11454). Springer International Publishing. https://doi.org/10.1007/978-3-030-16692-2 
Kennedy, J., & Eberhart, R. (1995). Particle swarm optimization. In Proc. ICNN’95 - Int. Conf. 
Neural Networks (Vol. 4, pp. 1942–1948). IEEE. https://doi.org/10.1109/ICNN.1995.488968 
Kirkpatrick, S., Gelatt, C. D., & Vecchi, M. P. (1983). Optimization by simulated annealing. 
Science, 220, 671–680. https://doi.org/10.1126/science.220.4598.671 
Leveque, R., Mitchell, I., & Stodden, V. (2012). Reproducible research for scientific computing: 
Tools and strategies for changing the culture. Computing in Science & Engineering, 14, 13–17. 
https://doi.org/10.1109/MCSE.2012.38 
Maier, H. R., Razavi, S., Kapelan, Z., Matott, L. S., Kasprzyk, J., & Tolson, B. A. (2019). Introduc￾tory overview: Optimization using evolutionary algorithms and other metaheuristics. Environ￾mental Modelling and Software, 114, 195–213. https://doi.org/10.1016/j.envsoft.2018.11.018 
Manninen, T., Acimovi ´ c, J., Havela, R., Teppola, H., & Linne, M. L. (2018). Challenges in ´
reproducibility, replicability, and comparability of computational models and tools for neuronal 
and glial networks, cells, and subcellular structures. Frontiers in Neuroinformatics, 12, 20. 
https://doi.org/10.3389/fninf.2018.00020 
Märtens, M., & Izzo, D. (2013). The asynchronous island model and NSGA-II: Study of a new 
migration operator and its performance. In GECCO 2013 - Proc. 2013 Genet. Evol. Comput. 
Conf. (pp. 1173–1180). ACM Press. https://doi.org/10.1145/2463372.2463516 
Mattoso, M., Werner, C., Travassos, G. H., Braganholo, V., Ogasawara, E., De Oliveira, D., et al. 
(2010). Towards supporting the life cycle of large scale scientific experiments. International 
Journal of Business Process Integration and Management, 5, 79–92. https://doi.org/10.1504/ 
IJBPIM.2010.033176 
Mauttone, A., & Plà-Aragonés, L. M. (2022). Preface: Contributions of OR to solve agricultural 
problems. Annals of Operations Research, 314, 317–318. https://doi.org/10.1007/s10479-022-
04791-4 
McDougal, R. A., Bulanova, A. S., & Lytton, W. W. (2016). Reproducibility in computational 
neuroscience models and simulations. IEEE Transactions on Biomedical Engineering, 63, 
2021–2035. https://doi.org/10.1109/TBME.2016.2539602 
Monajemi, H., Murri, R., Jonas, E., Liang, P., Stodden, V., & Donoho, D. (2019). Ambitious 
data science can be painless. Harvard Data Science Review, 1. https://doi.org/10.1162/ 
99608f92.02ffc552In Silico Evaluation and Prediction of Pesticide Supported by Reproducible... 159
Munafò, M. R., Nosek, B. A., Bishop, D. V. M., Button, K. S., Chambers, C. D., Percie Du Sert, N., 
et al. (2017). A manifesto for reproducible science. Nature Human Behaviour, 1, 1–9. https:// 
doi.org/10.1038/s41562-016-0021 
National Academies of Sciences E and M. (2019). Reproducibility and replicability in science. 
National Academies Press. https://doi.org/10.17226/25303 
Nguyen, H. A., Van Iperen, Z., Raghunath, S., Abramson, D., Kipouros, T., & Somasekharan, S. 
(2017). Multi-objective optimisation in scientific workflow. In Procedia Comput. Sci. (Vol. 108, 
pp. 1443–1452). Elsevier B.V.. https://doi.org/10.1016/j.procs.2017.05.213 
Plà-Aragonés, L. M. (Ed.). (2015). Handbook of operations research in agriculture and the agri￾food industry (Vol. 224). Springer New York. https://doi.org/10.1007/978-1-4939-2483-7 
Prabhu, P., Kim, H., Oh, T., Jablin, T. B., Johnson, N. P., Zoufaly, M., et al. (2011). A survey of 
the practice of computational science. In State Pract. Reports, SC’11 (p. 1). ACM Press. https:/ 
/doi.org/10.1145/2063348.2063374 
PyGMO. (2021). Welcome to PyGMO — PyGMO 1.1.7dev documentation 2021. Retrieved April 
23, 2021, from https://esa.github.io/pygmo/ 
Rougier, N. P., Hinsen, K., Alexandre, F., Arildsen, T., Barba, L. A., Benureau, A. C. Y., et al. 
(2017). Sustainable computational science: The ReScience Initiative. PeerJ Computer Science, 
2017, e142. https://doi.org/10.7717/peerj-cs.142 
Rucinski, M., Izzo, D., & Biscani, F. (2010). On the impact of the migration topology on the Island ´
Model. Parallel Computing, 36, 555–571. https://doi.org/10.1016/j.parco.2010.04.002 
Sandve, G. K., Nekrutenko, A., Taylor, J., & Hovig, E. (2013). Ten simple rules for reproducible 
computational research. PLoS Computational Biology, 9, e1003285. https://doi.org/10.1371/ 
journal.pcbi.1003285 
Sharma, A., Kumar, V., Shahzad, B., Tanveer, M., Sidhu, G. P. S., Handa, N., et al. (2019). 
Worldwide pesticide usage and its impacts on ecosystem. SN Applied Sciences, 1, 1–16. https:/ 
/doi.org/10.1007/s42452-019-1485-1 
Singh, V., & Misra, A. K. (2017). Detection of plant leaf diseases using image segmentation and 
soft computing techniques. Information Processing in Agriculture, 4, 41–49. https://doi.org/ 
10.1016/j.inpa.2016.10.005 
Smith, S. L. (2015). Medical applications of evolutionary computation. In GECCO 2015 -
Companion Publ. 2015 Genet. Evol. Comput. Conf. (pp. 651–679). Association for Computing 
Machinery, Inc. https://doi.org/10.1145/2739482.2756567 
Soto-Silva, W. E., Nadal-Roig, E., Ganzález-Araya, M. C., & Plà-Aragones, L. M. (2016). 
Operational research models applied to the fresh fruit supply chain. European Journal of 
Operational Research, 251(2), 345–355. https://doi.org/10.1016/j.ejor.2015.08.046 
Tang, F. H. M., Lenzen, M., McBratney, A., & Maggi, F. (2021). Risk of pesticide pollution at the 
global scale. Nature Geoscience, 14, 206–210. https://doi.org/10.1038/s41561-021-00712-5 
Tauritz, D. (2009). Grand challenges in evolutionary computing: Part I. 
USDA. (2021). PDP Databases and Annual Summaries | Agricultural Marketing Service 2021. 
Retrieved April 23, 2021, from https://www.ams.usda.gov/datasets/pdp/pdpdata 
Wilkinson, M. D., Dumontier, M., IJ, A., Appleton, G., Axton, M., Baak, A., et al. (2016). 
Comment: The FAIR Guiding Principles for scientific data management and stewardship. 
Scientific Data, 3, 1–9. https://doi.org/10.1038/sdata.2016.18 
Yu, H., Yang, L., Li, D., & Chen, Y. (2021). A hybrid intelligent soft computing method for 
ammonia nitrogen prediction in aquaculture. Information Processing in Agriculture, 8, 64–74. 
https://doi.org/10.1016/j.inpa.2020.04.002A Precision Agriculture Approach for 
a Crop Rotation Planning Problem 
with Adjacency Constraints 
Víctor M. Albornoz and Gabriel E. Zamora 
1 Introduction 
Modern agriculture considers an intensive use of geographical positioning systems, 
sensors, drones, and other data collection devices that can contribute to collect and 
forecast spatial and temporal variations of soil and crop properties that determine 
yields and quality of crops. In the case of soil properties, they are usually represented 
by chemical and physical properties or indexes such as organic matter, nutrient stor￾age, soil fertility, and moisture, among others. These indexes when managed with 
information technology by using data science and analytical methods can contribute 
to improve agricultural practices. For instance, sowing, fertilization, irrigation, and 
harvest planning by zoning fields into site-specific management zones can benefit of 
within-field variability analysis for a better agricultural production. Therefore, it is 
possible to divide the crop field into site-specific management zones, whose choice 
defines the so-called management zone problem in precision agriculture (PA). In 
such a way, the delineation of management zones allows the efficiency in the input 
used to maximize yields and, simultaneously, minimizes the environmental impacts, 
which is also one of the biggest concerns of today’s society. 
On the other hand, there exists a production system in agriculture that results 
in a sustainable ecosystem called organic agriculture, which is an integral system 
for production of food on farms based on ecological management practices, whose 
main objective is also to achieve sustainable productivity. According to FAO (2003), 
organic agriculture is a holistic production management system that promotes and 
improves the health of the ecosystem respecting biological cycles and soil biological 
activity with a minimal use of external inputs and avoids synthetic fertilizers 
V. M. Albornoz () · G. E. Zamora 
Departamento de Industrias, Campus Santiago Vitacura, Universidad Técnica Federico Santa 
María, Santiago, Chile 
e-mail: victor.albornoz@usm.cl; gabriel.zamora.13@sansano.usm.cl 
© Springer Nature Switzerland AG 2024 
V. M. Albornoz et al. (eds.), Optimization Under Uncertainty in Sustainable 
Agriculture and Agrifood Industry, https://doi.org/10.1007/978-3-031-49740-7_7
161162 V. M. Albornoz and G. E. Zamora
and pesticides. Therefore, the label of organic product on agricultural markets 
denotes compliance with specific production practices and processing methods. 
Most industrialized countries have regulations, where the use of pesticides and 
synthetic fertilizers is usually prohibited or restraint. Compliance with the standard 
is ensured through regular inspection and certification. 
The importance of this last agricultural production system relies on the care 
it offers to the environment, explained because the soils correspond to a non￾renewable resource, on which 95% of the world’s food supplies depend (IFOAM, 
2008). Soil is a resource to which the production of conventional crops is depleting 
at an accelerated rate, since intensive agriculture system involves the use of chemical 
fertilizers and pesticides. Within addition, the practice of monocultures reduces 
the fertility of the land and makes crops more vulnerable to diseases. Given this, 
organic agriculture represents a systemic approach which does not consider the use 
of agrochemicals to prevent the degradation of natural resources, the loss of land, 
and its productive potential. Organic farmers have also been forced to restore the 
natural ecological balance (FAO, 2003). 
Moreover, the organic production system works in turn with various agricultural 
practices that help reduce soil degradation and consequently mitigate climate 
change. One of these agricultural practices corresponds to crop rotation, which is 
also considered in the present chapter. This practice turns out to be a key strategy 
of farmers to control environmental stress and crop yields, allowing to control 
soil nutrients, water use, pest, and pest risks (Barbieri et al., 2017). In this last 
reference, a comparison is made in various aspects on the practice of crop rotation 
between organic farming and conventional crop production systems. Among other 
results, it was observed that the nitrogen captured in the soil is usually higher in 
the organic system, because the rotation considers legume crops, in the same way 
that it considers in greater quantity periods of fallow and green fertilizers. However, 
the main difference in the use of crop rotation between the two crop systems is that 
in the case of organic farming, crop rotation has been used mainly to satisfy soil 
fertility and to prevent pests, without breaching the regulation of this crop system. 
The management zone problem in PA can also contribute with the practices 
aforementioned and, integrated with the cropping of complementary species of 
different botanical families at the same time in adjacency management zones, 
contributes to prevent pests in crop allocation. Therefore, the novelty of this chapter 
resides on the integration of the management zone delineation problem and the crop 
rotation planning problem with adjacency constraints for sustainable production 
systems. 
The remainder of this chapter is organized as follows: Sect. 2 introduces 
some basic aspects and a literature review of analytics models and methods in 
agricultural systems, the management zone problem, and the crop rotation problem 
with adjacency constrains. Section 3 describes the modeling approach developed 
to address the integrated problem of zoning and assign a crop rotation plan for 
each management zone in the partition of the field. Section 4 presents the results of 
different instances of the problem. Finally, in Sect. 5, conclusions and suggestions 
for further research are presented.A Precision Agriculture Approach for a Crop Rotation Planning Problem... 163
2 Literature Review 
Nowadays, a significant part of agricultural trade takes place in the context of 
agricultural supply chains. These supply chains are networks of organizations char￾acterized by several activities with different planning horizons through the echelons 
of the network, whose efficient coordination is critical because of perishability and 
quality of crops over time. In this context, the complexity of tactical, operational, 
and logistics problems in supply chain management has increased, being Operations 
Research one of the most important disciplines that deal with advanced analytical 
methodologies for modeling and solving these problems. 
Operations Research in agriculture is quite vast as reported by a quick overview 
of the existing literature. Audsley and Sandars (2009) presented a very good review 
with the use of OR in agriculture in Britain, and, the same year, Ahumada and Vil￾lalobos (2009) presented a specific review for planning models in agricultural supply 
chains for foods and vegetables. Thus, Higgins et al. (2010) summarized challenges 
of agricultural value chains using methodologies from Operations Research, Zhang 
and Wilhelm (2011) presented a comprehensive optimization model for some 
special fruit crops, and Plà et al. (2014) introduced new opportunities regarding 
Operations Research for the agricultural industry. Next, Soto-Silva et al. (2016) 
reviewed the applications of Operations Research methods in fresh fruit supply 
chain, Borodin et al. (2016) presented a state of the art in the application of Opera￾tions Research methodologies to handling uncertainty occurring in the agricultural 
supply chains, and Utomo et al. (2018) compiled existing agri-food supply chain 
research that uses agent-based modeling and simulation, and Villalobos et al. (2019) 
presented recent developments in information technology that are impacting the 
agri-food supply chains. Among the methodologies more cited in the previous 
reviews, we find the linear, nonlinear, and integer programs, as well as stochastic and 
robust optimization. More recently, bilevel optimization models are also included 
among the methodologies used in agriculture for the design and coordination of food 
supply chains. For example, Cheraghalipour et al. (2019) proposed a mixed-integer 
bilevel optimization model for rice supply chain to design and coordinate a network 
of producers, distribution centers, and plants with customers, and Albornoz and Vera 
(2023) presented a two-stage stochastic bilevel optimization model to coordinate a 
producer and a wholesaler to meet its demand in a hierarchical supply chain that 
considers a tactical harvest planning problem based on the previous contribution by 
Albornoz et al. (2021). 
On the other hand, Kamble et al. (2020) tried to discover the level of analytics 
used, sustainable agriculture supply chain objectives attained, the supply chain 
processes from where the data is collected, and the supply chain resources deployed 
for the same, and De and Singh (2021) reviewed fuzzy logic applications to address 
the highly uncertain factors of the agri-supply chain, such as the soil content, 
rainfall, humidity, and yields. However, among the methodologies more cited in 
the previous reviews, we find the deterministic optimization that we also consider 
in the present chapter.164 V. M. Albornoz and G. E. Zamora
2.1 The Management Zone Problem 
In agriculture, spatial and temporal variabilities of soil properties are key aspects 
in determining yield and quality of crops. Soil and crop characteristics can be 
used in the delimitation of the field into homogeneous site-specific management 
zones with similar characteristics to respond to within-field variability. These 
characteristics also allow the allocation of a crop rotation plan at each of the 
resulting management zones for obtaining the best yields and quality of crops. In 
this regard, delineating management zones efficiently and accurately is a major 
challenge that requires decision support systems in modern agriculture (Wolfert et 
al., 2017). Different approaches in literature for determining management zones 
are based on clustering algorithms such as the watershed segmentation algorithm 
(Roudier et al., 2008), principal component analysis (Ortega & Santibáñez, 2007), 
spatial principal components (Gavioli et al., 2016), fuzzy k-means (Peralta et al., 
2015; Córdoba et al., 2016), fuzzy c-means (Jiang et al., 2011; Betzek et al., 2018), 
multivariate k-means (Ohana-Levi et al., 2019), and segmentation methods arising 
from the signal processing area (Zane et al., 2013; Leroux et al., 2017; Denora et 
al., 2022), among others. 
Operations Research also provides different methodologies for the management 
zone problem; Cid-García et al. (2013) proposed a management zone delineation 
method using a binary integer programming model, which from a soil property 
allows delineation of rectangular management zones facilitating the agronomic 
practices for crop planning in a site-specific manner. This last approach has been 
applied by Haghverdi et al. (2015) to irrigation system design and by Xiaohu et 
al. (2016) who improve the methodology by applying a semivariogram analysis to 
determine the optimal grid size during the instance generation step. Then, Albornoz 
et al. (2015) extended the binary integer program model into a bi-objective mixed￾integer model as part of a hierarchical optimization approach for addressing zoning 
and crop planning problems. In this approach, authors first generate Pareto optimal 
solutions for the zoning problem and, by solving a crop assignment model that 
considers a limited amount of water irrigation and a given stock of seeds, present 
an alternative criterion for choosing a single solution for the crop planning problem. 
More recently, Salama et al. (2020) applied the binary integer programming model 
to solve the crop planning problem in a small farm while considering limited water 
availability. 
On the other hand, Albornoz and Ñanco (2016) presented a solution strategy 
for solving the abovementioned binary integer program using a column generation 
decomposition method. This numerical strategy was extended by Albornoz et al. 
(2019) for a robust optimization model that included a set of scenarios concerning 
uncertain future values for a soil or crop index. Cid-García and Ibarra-Rojas 
(2019) proposed an integrated optimization model for zoning and crop planning 
problems that considers a nonlinear optimization model that generates a partition 
based on a chemical property for crop assignment and another partition based on a 
physical property for irrigation activities. Treimun et al. (2019) proposed a greedyA Precision Agriculture Approach for a Crop Rotation Planning Problem... 165
approach for generating homogeneous partitions of rectangular management zones, 
and Velasco et al. (2021) generated management zones with orthogonal shapes (L 
or T shapes) that minimize the number of zones required to delineate the field based 
on evolutionary computation, specifically on a class of the estimation of distribution 
algorithms. In this chapter, we integrate the zoning problem with the crop rotation 
planning problem as part of a novel approach within the framework of a supply 
chain of organic producers. 
2.2 The Crop Rotation Problem 
The crop rotation planning problem is a decision problem where a crop pattern 
must be chosen for each parcel or management zone. This pattern will last a specific 
number of crop cycles that must face future demands and prices. In this respect 
there are abundant references in the literature that offer solutions for the crop 
rotation planning problem based on Operations Research methodologies; see Dury 
et al. (2012) and Memmah et al. (2015) as good surveys. In the seminal works by 
McCarl et al. (1977), Clark (1989), and Sarker et al. (1997), they proposed linear 
programming models considering land type, alternative crops, crop pattern, and 
input requirements for getting optimal net incomes. Kumar and Pathak (1989) and 
Mainuddin et al. (1977) proposed a crop planning model considering groundwater 
irrigation as an important resource. Dogliotti et al. (2003) presented a tool for 
generating crop rotations based on agronomic criteria. Haneveld and Stegeman 
(2005) proposed a linear programming-based model and an algorithmic strategy 
for generating feasible crop rotations. Detlefsen and Jensen (2007) introduced a 
network flow formulation for the crop pattern planning. Sarker and Ray (2009) 
formulated a crop planning problem as a multi-objective optimization model that 
includes possible sequences of two or three crops in the same area during the 
planning horizon. Adeyemo and Otieno (2010) presented an evolutionary algorithm 
to solve the multi-objective crop planning model that minimizes the total irrigation 
water and maximizes both the total net income from farming and the total 
agricultural output. Dos Santos et al. (2010) proposed a crop rotation model that 
was efficiently solved using column generation. Alabdulkader et al. (2012) used a 
mathematical program to optimize cropping patterns in Saudi Arabia. Costa et al. 
(2014) developed a linear integer problem to define optimal crop schedules with 
a combined production that met the required demand. This model also takes into 
account that harvested crops can be stored for a limited period of time. Santos 
et al. (2015) and Alfandari et al. (2015) proposed an optimal set of crops where 
a linear integer problem was developed to define optimal crop rotation schedules 
with a combined production that met the required demand while also minimizing 
the total planting area. In both papers, the proposed models were efficiently solved 
using a branch-and-price-and-cut decomposition method. More recently, Filippi et 
al. (2017) developed two mixed-integer programming models for an optimal crop 
rotation problem to deal with monetary objectives, where the first model maximized166 V. M. Albornoz and G. E. Zamora
the expected profit based on average data while the second used conditional value￾at-risk as a safety measure, and Albornoz et al. (2020) introduced a modeling 
framework for integrating a site-specific rectangular management zone problem and 
the crop rotation planning problem without adjacency constraints. 
From a sustainable production perspective, there are also relevant contributions 
based on Operations Research methodologies. Dos Santos et al. (2011) presented 
a crop rotation scheduling with adjacency constraints that was solved using a 
column generation-based algorithm. Deytieux et al. (2016) provided an overview for 
sustainability assessment in single- and multi-site studies. You and Hsieh (2017) for￾mulated a mixed-integer linear program to determine the crop rotations and harvest 
schedules of vegetables for organic farmers. Due to the complexity of the model, 
they proposed a two-phase heuristic approach to solve the model. Capitanescu et 
al. (2017) proposed a mixed-integer linear optimization model for the crop rotation 
problem adding various types of environmental constraints. Kountios et al. (2017) 
emphasized the importance of precision agriculture and sustainability but also the 
attitudes of farmers toward these topics. Boyabatli et al. (2019) examined crop 
planning decisions in sustainable agriculture. More recently, Albornoz and Zamora 
(2021) solved a crop planning problem with adjacency constraints which make use 
of the column generation method with column-dependent rows as a decomposition￾based heuristic. In the present chapter, we extend the previous research to the 
crop rotation planning problem with adjacency constraints in the context of smart 
agriculture. 
3 Modeling Approach 
A management zone is a sub-region of a field that is relatively homogeneous 
with respect to a given soil or crop property, such that it allows performing site￾specific agricultural management. In this chapter, the decision-making problem 
seeks to generate a partition of a field into rectangular management zones with low 
variability in a given soil property to allocate a crop rotation plan. For this purpose, 
the field is subdivided into cell farms that contain one sample point of the measured 
soil property. In a partition of the field, each management zone is formed by a subset 
of adjacent cells with a rectangular shape. 
To solve the problem, all the potential rectangular management zones must be 
generated, and from this set of potential zones, it must be determined a subset 
that defines a partition of the field and a required level of homogeneity. The set 
of potential management zones can be generated using Algorithm 1 in Cid-García 
et al. (2013). Let Z be the set containing all potential zones z, and let S be the set 
containing all soil samples s in the field; therefore we assume that we know a binary 
parameter cs, z that indicates if sample point s belongs to potential zone z or not. 
Notice that if the sample grid of the field has n rows and m columns, then it willA Precision Agriculture Approach for a Crop Rotation Planning Problem... 167
have N = nm sample points and set Z has a total number of potential zones given by 
the following expression: 
|Z| = n (n + 1)
2 ·
m (m + 1)
2 (1) 
On the other hand, defining a binary decision variable qz that takes a value equal 
to 1 if zone z is in the partition and 0 otherwise, by imposing Eq. (2) for each of the 
sample points s ∈ S, allows to get a partition of the field. 

z∈Z
cs,zqz = 1 (2) 
To guarantee a field partition into homogeneous management zones, we use the 
relative variance (RV) concept introduced by Ortega and Santibáñez (2007). The 
relative variance (RV) is defined as: 
RV = 1 −
Q
z=1 (nz − 1) / (N − Q) σ2
z
σ2 (3) 
where there are N sample points of a given soil property and a partition of a field into 
Q management zones, with each zone z including nz of the N sample points, where 
σ2
z is the variance of the soil property of the zone z and σ2 the total variance of the 
soil property in the field. RV takes values between 0 and 1, where a higher relative 
variance implies a higher internal homogeneity for each management zone into 
which the field is partitioned. Notice that the smaller value of RV is reached when 
the partition considers only one management zone, given by the nonhomogeneous 
field itself, and that the higher value of RV is reached when each management zone 
into the partition has a variance of the soil property equal to zero. Using the RV 
concept, every feasible partition of the field must satisfy a given lower bound for in 
order to meet the homogeneity criteria. 
Continuing with the addressed problem in this chapter, it must be determined 
simultaneously which crop rotation should be cultivated during the different periods 
of the planning horizon for each of the management zones into the partition of 
the field while respecting adjacency constraints that prohibit crops of the same 
botanical family to be grown at the same time in adjacent zones. In order to solve 
this problem, a novel binary integer programming model is proposed to integrate the 
management zoning problem and the crop rotation planning problem with adjacency 
constraints. Therefore, the proposed model seeks to generate a partition of the field, 
with a limited number of management zones, and to allocate a cropping plan at 
each zone so that the yield of the partition will be maximized considering demand168 V. M. Albornoz and G. E. Zamora
requirements for each crop at each time period. The sets, indices, parameters, and 
decision variables are described below: 
Sets and indices 
Z: set of potential management zones, with z ∈ Z 
S: set containing all soil samples, with s ∈ S 
T: set of time periods, with t ∈ T 
C: set of crops to be cultivated i ∈ C 
SF: set of botanical families, with p ∈ SF 
Fp: set of crop in botanical family p 
A: set of pairs of adjacent zones, with (z
, z) ∈ A 
Parameters 
pi, t: price of crop i in period t 
ri, t, z:yield of crop i in zone z during period t 
N:total number of sample points 
σz:standard deviation of potential zone z 
σ:standard deviation of the farm 
nz:number of sample points in potential zone i 
α:lower bound for the relative variance in the partition 
cs, z:indicates whether the potential zone z covers the sample point s or not 
LS:maximum number of zones to be set in a partition 
Decision variables 
qz:binary variable that takes a value equal to 1 if zone z is in the partition and 0 
otherwise 
xi, j, z:binary variable that takes a value equal to 1 if crop i is allocated to zone z 
in period t and 0 otherwise 
The integrated zoning and crop rotation planning with adjacency restriction 
model is: 
max 
z∈Z

i∈I
pi,t ri,t,z xi,t,z (4) 
s.t. 

z∈Z
cs,zqz = 1s ∈ S (5) 

1 −

z∈Z (nz − 1) σ2
z qz
σ2 
N − 
z∈Z qz


≥ α (6) 

z∈Z
qz ≤ LS (7) 

i∈Fp

xi,t,z + xi,t,z 	
≤ 1p ∈ SF, t ∈ T , 
z
, z	
∈ A (8)A Precision Agriculture Approach for a Crop Rotation Planning Problem... 169

i∈Fp
xi,t−1,z + xi,t,z ≤ 1p ∈ SF, z ∈ Z,t ∈ T − {1} (9) 

i∈I
xi,t,z = qzz ∈ Z,t ∈ T (10) 

t∈T
xf,t,z = qzz ∈ Z (11) 
xi,t,z ∈ {0, 1} z ∈ Z, i ∈ I,t ∈ T (12) 
qz ∈ {0, 1} ∀z ∈ Z (13) 
The objective function (4) maximizes the income associated with the crop plan. 
Constraint (5) guarantees a field partition. Constraint (6) ensures that a given level 
of homogeneity is satisfied for any feasible partition according to the RV concept 
introduced in Eq. (3). It should be remarked that constraint (5) is nonlinear; however 
through an algebraic handling, it is possible to obtain the following equivalent linear 
equation: 

z∈Z


(nz − 1) σ2
z + (1 − α) σ2

qz ≤ σ2N (1 − α) (14) 
Constraint (7) limits the number of zones in which the field will be divided. It is 
important to note that the quality of the partition depends on constraints (6) and (7), 
but there is a trade-off between them, because the higher the α value is, the greater 
the number of zones needed to achieve that level of homogeneity. 
Constraints (8)–(11) define the crop rotation plan with adjacency constraints. In 
particular, constraint (8) ensures that two crops belonging to the same botanical 
family in SF cannot be cultivated in adjacent management zones during each 
time period. These restrictions are the main difficulty of the problem, because 
the cardinality of the constraint set grows significantly as the number of potential 
management zones increases. This is why first in dos Santos et al. (2010) a different 
formulation is developed to reduce the number of constraints, and then Mauri (2019) 
explores relaxation and decomposition methods to improve the performance of the 
model. Constraint (9) prevents two species of the same botanical family from being 
cultivated in the same management zone in consecutive period. Constraint (10) 
ensures that at each time period, only one crop can be cultivated in a management 
zone of the resulting partition, and (11) ensures that each management zone has a 
fallow period during the planning horizon. Finally, constraints (12) and (13) define 
the binary nature of the variables. 
The number of potential management zones grows rapidly when the number of 
sample points in the field increases; and this polynomially augments the number170 V. M. Albornoz and G. E. Zamora
of decision variables and constraints of the problem. The cardinality of the set of 
variables is explained by the need to evaluate each potential management zone, and 
the number of adjacency constraints generated by these zones grows in a much 
larger proportion than the variable cardinality. 
Although the size of the model grows rapidly, the number of management zones 
in the optimal partitioning of the field grows only according to the number of 
sampling points. This means that it is possible to solve the problem by knowing 
only a few number of zones, without the need to generate information from the 
entire universe of potential management zones and their adjacency relationships. 
For this reason, in the present chapter, we use a straightforward extension of the 
column generation method with column-dependent row presented in Albornoz and 
Zamora (2021) for solving now the integrated model (4)–(13) that considers a crop 
rotation planning problem with adjacency constraints. 
4 Computational Results 
In this section, we show the results of different instances for a case study and compu￾tational experiments as part of the analysis in the use of the column generation-based 
strategy. The analysis compares the exact resolution of the integrated model using 
a state-of-the-art commercial software with the approximate solution of a column 
generation-based heuristic. The different instances and the decomposition heuristic 
were coded in Julia JuMP 0.19. All linear and integer problems were solved using 
the solver Gurobi 8.1.1. 
All the computational experiments were carried out on Intel Core i7-8500U 
1.99 GHz with 12 GB of RAM, considering 19 instances of measurements of a 
soil property with a minimum of 10 and a maximum of 100 sample points for 5 
botanical species belonging to 3 botanical families. Each of the N sample points 
could be represented by the ordered pair (i, j) where i = 1, ... , n and j = 1, ... ,m. 
Table 1 shows the different instances considered. The first column indicates the 
instance number. The second column is the number of samples in the length of the 
field (n), and the third column is the number of samples in its width (m). The fourth 
column shows the total number of sample points in the field (N = nm). The fifth 
column is the maximum number of allowed zones, and it is calculated based on the 
solution of the zoning problem without crops. The sixth column indicates the total 
number of potential rectangular management zones (|Z| = n(n + 1)m(m + 1)/4); 
that also represents the number of binary variables qz. The seventh column shows 
the total number of binary variables xi,t,z that can allocate different crops to each 
potential management zone at each time period, where to the five botanical species 
we add a fallow option as a sixth alternative that it defines the cardinality of set I. 
The last column presents the total number of adjacency constraints for the integrated 
model (4)–(13). 
Notice that the number of potential management zones, the number of variables, 
and the total number of adjacency constraints grow rapidly when the number ofA Precision Agriculture Approach for a Crop Rotation Planning Problem... 171
Table 1 The set of instances 
Instance n m |N| |LS| |Z| |T| |I|·|Z|·|T| |A|
1 2 5 10 4 45 4 1080 295 
2 3 5 15 6 90 4 2016 1140 
3 4 5 20 6 150 4 3600 2950 
4 5 5 25 9 225 4 5400 6200 
5 6 5 30 10 315 4 7560 11,445 
6 7 5 35 11 420 4 10,080 19,320 
7 8 5 40 11 540 4 12,960 30,540 
8 9 5 45 11 675 4 16,200 45,900 
9 10 5 50 11 825 4 19,800 66,275 
10 11 5 55 11 990 4 23,760 92,620 
11 12 5 60 11 1170 4 28,080 125,970 
12 13 5 65 11 1365 4 32,760 167,440 
13 14 5 70 11 1575 4 37,800 218,225 
14 15 5 75 11 1800 4 43,200 279,600 
15 16 5 80 11 2040 4 48,960 352,920 
16 17 5 85 11 2295 4 55,080 439,620 
17 18 5 90 12 2565 4 61,560 541,215 
18 19 5 95 12 2850 4 68,400 659,300 
19 20 5 100 12 3150 4 75,600 795,550 
0 
20000 
40000 
60000 
80000 
0 20 40 60 80 100 120 
Number of variables 
Number of sample points 
Fig. 1 Integrated model: growth in the number of variables 
sample points in the field increases. Figures 1 and 2 show more clearly the behavior 
of this growth that it is exponential in the case of the number of constraints, mainly 
due to the combinational nature of the adjacency constrains. It is also possible to 
deduce that this growth rate intensifies both when the number of crops and the 
planning horizon increase. 
Table 2 presents the results of the integrated crop rotation planning for small￾sized instances, most of them solved to optimality with Gurobi 8.1.1 using a given 
upper bound for the running time. The first column indicates the instance number. 
The second column shows the computational time in seconds using the solver. 
The third column indicates the optimal value of the integrated model (4)–(13) that 
represents field income. The fourth column presents the computational time by the172 V. M. Albornoz and G. E. Zamora
0 
100000 
200000 
300000 
400000 
500000 
600000 
700000 
800000 
900000 
0 20 40 60 80 100 120 
Number of variables 
Number of sample points 
Fig. 2 Integrated model: growth in the number of adjacency constraints 
Table 2 Results of the proposed model for small-sized instances 
Integrated model Column generation-based heuristic 
Instance Time Total income Time Total income GAP 
Small-sized instances 1 1.37 245.33 8.60 245.33 0% 
2 4.07 245.33 8.51 234.44 4% 
3 10.74 237.17 11.36 237.17 0% 
4 58.30 232.27 11.36 225.73 3% 
5 712.54 239.89 13.43 228.37 5% 
6 1671.28 240.66 13.80 221.19 8% 
7 6019.70 237.17 17.45 220.12 7% 
8 11132.40 241.70 12.86 230.60 5% 
9 20000.00 242.06 37.56 225.73 – 
10 20000.00 239.39 15.21 227.52 – 
column generation-based heuristic. The fifth shows the total income achieved by the 
proposed strategy, considering the integer formulation of model (4)–(13) with the 
resulting management zones obtained by the column generation-based algorithm. 
The last column presents the GAP between the income achieved by decomposition 
strategy and the optimal solution. 
All the instances were done by setting a maximum resolution time of 20,000 
seconds. Taking this into consideration, instances 1 to 8 could be solved to 
optimality and in the case of instances 9 and 10 only found a feasible integer 
solution using the solver. On the other hand, the column generation-based heuristic 
only solves to optimality the relaxed problem, so it cannot ensure that the optimum 
is achieved by solving the resulting problem generated by the column generation 
strategy in integer variables. Therefore the GAP is used as a quality measure of 
the solution obtained, compared to the optimum calculated by solving the problem 
directly with a solver. Notice that our results empirically show that the average GAPA Precision Agriculture Approach for a Crop Rotation Planning Problem... 173
Table 3 Results of the proposed model for medium-sized instances 
Column generation-based heuristic 
Instance Time Total income 
Medium-sized instances 11 24.54 222.92 
12 18.99 222.28 
13 20.11 231.33 
14 20.98 222.80 
15 24.92 229.00 
16 97.93 224.20 
17 22.85 232.42 
18 27.89 213.49 
19 38.78 219.98 
is of 4% considering all the instances solved to optimality and an average reduction 
of 3355 seconds in the running times compared to the solver. 
Next, Table 3 presents the performance of the proposed column and row 
generation algorithm for medium-sized instances. The first column indicates the 
instance number. The second column presents the computational time by the column 
generation-based heuristic. The third shows the total income achieved by the 
proposed strategy, considering the integer formulation of models (4)–(13) with the 
resulting management zones obtained by the column generation-based algorithm. 
For all the instances in Table 3, a feasible solution cannot be found within 
the time limit using the solver for the integrated model, mainly due to lack of 
memory. This highlights the best performance of the proposed strategy to solve 
the problem. Therefore, column generation-based heuristic with column-dependent 
rows is a decomposition strategy that is able to find good solutions to the integrated 
zoning and crop rotation problem with adjacency constraints, with reasonable 
computational times. 
Complementing the above, Table 4 shows the growth of the size of the problems 
when using the integrated model with the complete enumeration of all the manage￾ment zones and adjacency constraints and the column generation-based heuristic 
with column-dependent rows. The first column indicates the instance number. The 
second column shows the number of potential management zones in models (4)– 
(13). The third column presents the number of adjacency constraints of the model, 
the fourth column indicates the total number of variables, and the fifth column 
indicates the total number of constraints. The sixth column indicates the generated 
number of zones of the decomposition-based heuristic. The seventh column shows 
the number of adjacency constraints, the eighth column indicates the total number 
of variables, and the ninth shows the number of constraints. 
The table shows clearly that the amount of information needed to solve the 
problem when using column generation-based heuristic is much smaller, keeping the 
problem size in accessible dimensions for which the studied medium-sized instances 
can still be solved. Notice also that the growth rate of the number of constraints is174 V. M. Albornoz and G. E. Zamora
Table 4 Results of the proposed model 
Integrated model Column generation-based heuristic 
Instance |Z| |A| # Variables # Constrains |Z| |A| # Variables # Constrains 
1 45 295 1125 5307 16 33 400 1032 
2 90 1140 2250 17,207 22 54 550 1523 
3 150 2950 3750 41,272 34 121 850 2800 
4 225 6200 5625 83,202 61 377 1525 6930 
5 315 11,445 7875 149,657 54 234 1350 4946 
6 420 19,320 10,500 248,257 57 228 1425 4996 
7 540 30,540 13,500 387,582 66 287 1650 6060 
8 675 45,900 16,875 577,172 85 492 2125 9266 
9 825 66,275 20,625 827,527 92 545 2300 10,180 
10 990 92, 620 24,750 1,150,107 97 588 2425 10,896 
11 1170 125,970 29,250 1,557,332 104 668 2600 12,134 
12 1365 167,440 34,125 2,062,582 99 541 2475 10,420 
13 1575 218,225 39,375 2,680,197 109 564 2725 11,091 
14 1800 279,600 45,000 3,425,477 112 588 2800 11,501 
15 2040 352,920 51,000 4,314,682 125 776 3125 14,269 
16 2295 439,620 57,375 5,365,032 132 854 3300 15,483 
17 2565 541,215 64,125 6,594,707 126 652 3150 12,830 
18 2850 659,300 71,250 8,022,847 140 841 3500 15,649 
19 3150 795,550 78,750 9,669,552 139 773 3475 14,799 
greater than the variables, so the algorithmic strategy shows a greater improvement 
compared to its counterpart. 
5 Conclusions and Further Research 
In this chapter, an integrated model for the zoning and crop rotation planning 
problems with adjacency constraints is formulated and solved. For this purpose, a 
partition of a field composed of rectangular management zones with low variability 
in soil properties allows the definition of a crop rotation plan for each zone that 
maximizes yields and, simultaneously, minimizes the environmental impacts, so 
this methodology especially focuses on sustainability. However, the size of the 
model grows rapidly in the number of variables and constraints when the number 
of sample points increases. For this reason, a column-and-row generation algorithm 
with column-dependent rows is used as a heuristic to find a good feasible solution. 
The algorithm generates only a subset of potential management zones and the 
corresponding set of variables and adjacency constraints given rice a model with 
a reduced number of variables and constraints to be solved. 
Experiments were carried out in which different numbers of sample points in 
the field were considered. The results confirm that the problem size grows rapidlyA Precision Agriculture Approach for a Crop Rotation Planning Problem... 175
in the complete model formulation and that the number of constraints increases 
at a considerably higher rate than the number of variables. The medium-sized 
instances cannot be solved in a reasonable computational time using its complete 
model formulation, and for large instances, the memory capacity is exceeded, and 
no integer solution can be obtained. Therefore, the proposed algorithmic strategy is 
a good alternative to deal with the integrated model, being able to find acceptable 
feasible solutions to medium- and large-sized problems that cannot be solved 
directly. 
In further research, it would be necessary to develop a decomposition algorithm 
based on the branch-and-price method to find the optimal solution of the integrated 
model instead of the column generation based heuristic used in this chapter. In 
addition, future work can consider other interesting aspects in the model formu￾lation such as limitations in the production of crops related to a market demand, 
future yields, and prices associated to possible scenarios under uncertain weather 
conditions and incorporate more knowledge or common practices in the context of 
organic agriculture. 
Acknowledgments The authors would like to thank to Lluis Plà Aragonés for their valuable 
comments on earlier version of this chapter and the work performed by research assistant Iñigo 
Sagaseta de Ilurdoz. This research was partially supported by DGIIE from Universidad Técnica 
Federico Santa María (Grant PI_M_2021_99). 
References 
Adeyemo, J., & Otieno, F. (2010). Differential evolution algorithm for solving multiobjective crop 
planning model. Agricultural Water Management, 97(6), 848–856. 
Ahumada, O., & Villalobos, J. R. (2009). Application of planning models in the agri-food supply 
chain: A review. European Journal of Operational Research, 196(1), 1–20. 
Alabdulkader, A. M., Al-Amoud, A. I., & Awad, F. S. (2012). Optimization of the cropping pattern 
in Saudi Arabia using a mathematical programming sector model. Agricultural Economics, 
58(2), 56–60. 
Albornoz, V. M., Araneda, L., & Ortega, R. (2021). Planning and scheduling of selective harvest 
with management zones delineation. Annals of Operations Research, 316, 873–890. 
Albornoz, V. M., Cid-García, N. M., Ortega, R., & Ríos-Solís, Y. A. (2015). A hierarchical planning 
scheme based on precision agriculture. In L. M. Plá-Aragonés (Ed.), Handbook of operational 
research in agriculture and the agri-food Industry (pp. 129–162). Springer. 
Albornoz, V. M., & Ñanco, L. J. (2016). An empirical design of a column generation algorithm 
applied to a management zone delineation problem. Lecture Notes in Economics and Mathe￾matical Systems, 682, 201–208. 
Albornoz, V. M., Ñanco, L. J., & Sáez, J. L. (2019). Delineating robust rectangular management 
zones based on a column generation algorithm. Computers and Electronics in Agriculture, 161, 
194–201. 
Albornoz, V. M., Véliz, M. I., Ortega, R., & Ortíz-Araya, V. (2020). Integrated versus hierarchical 
approach for zone delineation and crop planning under uncertainty. Annals of Operations 
Research, 286, 617–634.176 V. M. Albornoz and G. E. Zamora
Albornoz, V. M., & Vera, P. I. (2023). Coordinating harvest planning and scheduling in an 
agricultural supply chain through a stochastic bilevel programming. International Transactions 
in Operational Research, 30, 1819–1842. 
Albornoz, V. M., & Zamora, G. E. (2021). Decomposition-based heuristic for the zoning and crop 
planning problem with adjacency constraints. TOP, 29, 248–265. 
Alfandari, L., Plateau, A., & Schepler, X. (2015). A branch-and-price-and-cut approach for 
sustainable crop rotation planning. European Journal of Operational Research, 241(3), 872– 
879. 
Audsley, E., & Sandars, D. (2009). A review of the practice and achievements from 50 years of 
applying OR to agricultural systems in Britain. OR Insight, 22(1), 2–12. 
Barbieri, P., Pellerin, S., & Nesme, T. (2017). Comparing crop rotations between organic and 
conventional farming. Scientific Reports, 1–10. https://doi.org/10.1038/s41598-017-14271-6 
Betzek, N. M., de Souza, E. G., Bazzi, C. L., Schenatto, K., & Gavioli, A. (2018). Rectification 
methods for optimization of management zones. Computers and Electronics in Agriculture, 
146, 1–11. 
Borodin, V., Bourtembourg, J., Hnaien, F., & Labadie, N. (2016). Handling uncertainty in 
agricultural supply chain management: A state of the art. European Journal of Operational 
Research, 254, 348–359. 
Boyabatli, O., Nasiry, J., & Zhou, Y. H. (2019). Crop planning in sustainable agriculture: Dynamic 
farmland allocation in the presence of crop rotation benefits. Management Science, 65, 2060– 
2076. 
Capitanescu, F., Marvuglia, A., Navarrete Gutiérrez, T., & Benetto, E. (2017). Multi-stage farm 
management optimization under environmental and crop rotation constraints. Journal of 
Cleaner Production, 147, 197–205. 
Cheraghalipour, A., Paydar, M. M., & Hajiaghaei-Keshteli, M. (2019). Designing and solving a 
bi-level model for rice supply chain using evolutionary algorithms. Computers and Electronics 
in Agriculture, 162, 651–668. 
Cid-García, N. M., Albornoz, V. M., Ríos-Solís, Y., & Ortega, R. (2013). Rectangular shape 
management zone delineation using integer linear programming. Computers and Electronics 
in Agriculture, 93, 1–9. 
Cid-García, N. M., & Ibarra-Rojas, O. J. (2019). An integrated approach for the rectangular 
delineation of management zones and the crop planning problems. Computers and Electronics 
in Agriculture, 164, 104925. 
Clark, H. R. (1989). Combinatorial aspects of cropping pattern selection in agriculture. European 
Journal of Operational Research, 40(1), 70–77. 
Córdoba, M. A., Bruno, C. I., Costa, J. L., Peralta, N. R., & Balzarini, M. G. (2016). Protocol for 
multivariate homogeneous zone delineation in precision agriculture. Biosystems Engineering, 
143, 95–107. 
Costa, A. M., dos Santos, L. M. R., Alem, D. J., & Santos, R. H. S. (2014). Sustainable vegetable 
crop supply problem with perishable stocks. Annals of Operations Research, 219(1), 265–283. 
De, A., & Singh, S. P. (2021). Analysis of fuzzy applications in the agri-supply chain: A literature 
review. Journal of Cleaner Production, 283, 124577. 
Denora, M., Fiorentini, M., Zenobi, S., Deligios, P. A., Orsini, R., Ledda, L., & Perniola, M. (2022). 
Validation of rapid and low-cost approach for the delineation of zone management based on 
machine learning algorithms. Agronomy, 12(1), 183. 
Detlefsen, N. K., & Jensen, A. L. (2007). Modelling optimal crop sequences using network flows. 
Agricultural Systems, 94(2), 566–572. 
Deytieux, V., Munier-Jolain, N., & Caneill, J. (2016). Assessing the sustainability of cropping 
systems in single-and multi-site studies. A review of methods. European Journal of Agronomy, 
72, 107–126. 
Dogliotti, S., Rossing, W. A. H., & Van Ittersum, M. K. (2003). ROTAT, a tool for systematically 
generating crop rotations. European Journal of Agronomy, 19(2), 239–250. 
dos Santos, L. M. R., Costa, A. M., Arenales, M. N., & Santos, R. H. S. (2010). Sustainable 
vegetable crop supply problem. European Journal of Operational Research, 204(3), 639–647.A Precision Agriculture Approach for a Crop Rotation Planning Problem... 177
dos Santos, L. M. R., Michelon, P., Arenales, M. N., & Santos, R. H. S. (2011). Crop rotation 
scheduling with adjacency constraints. Annals of Operations Research, 190(1), 165–180. 
Dury, J., Schaller, N., Garcia, F., Reynaud, A., & Bergez, J. E. (2012). Models to support cropping 
plan and crop rotation decisions. A review. Agronomy for Sustainable Development, 32(2), 
567–580. 
FAO. (2003). Agricultura orgánica, ambiente y seguridad alimentaria. In N. E.-H. Scialabba & C. 
Hattam (Eds.), Colección FAO: Ambiente y Recursos Naturales N◦ 4. FAO. 
Filippi, C., Mansini, R., & Stevenato, E. (2017). Mixed integer linear programming models for 
optimal crop rotation selection. Computers and Operations Research, 81, 26–39. 
Gavioli, A., Souza, E. G., Bazzi, C. L., Carvalho Guedes, L. P., & Schenatto, K. (2016). Optimiza￾tion of management zone delineation by using spatial principal components. Computers and 
Electronics in Agriculture, 127, 302–310. 
Haghverdi, A., Leib, B. G., Washington-Allen, R. A., Ayers, P. D., & Buschermohle, M. J. (2015). 
Perspectives on delineating management zones for variable rate irrigation. Computers and 
Electronics in Agriculture, 117, 154–167. 
Haneveld, W. K. K., & Stegeman, A. W. (2005). Crop succession requirements in agricultural 
production planning. European Journal of Operational Research, 166(2), 406–429. 
Higgins, A., Miller, C., Archer, A., Ton, T., Fletcher, C., & McAllister, R. (2010). Challenges of 
operations research practice in agricultural value chains. Journal of the Operational Research 
Society, 61(6), 964–973. 
IFOAM. (2008). Organic agriculture & healthy soils. Obtenido de IFOAM Organics International. 
https://www.ifoam.bio/our-work/what/soil 
Jiang, Q., Fu, Q., & Wang, Z. (2011). Study on delineation of irrigation management zones based 
on management zone analyst software. In D. Li, Y. Liu, & Y. Chen (Eds.), Computer and 
Computing Technologies in Agriculture IV. CCTA 2010. IFIP Advances in Information and 
Communication Technology (Vol. 346, pp. 419–427). Springer. 
Kamble, S. S., Gunasekaran, A., & Gawankar, S. A. (2020). Achieving sustainable performance 
in a data-driven agriculture supply chain: A review for research and applications. International 
Journal of Production Economics, 219, 179–194. 
Kountios, G., Ragkos, A., Bournaris, T., Papadavid, G., & Michailidis, A. (2017). Educational 
needs and perceptions of the sustainability of precision agriculture: Survey evidence from 
Greece. Precision Agriculture, 19(3), 537–554. 
Kumar, R., & Pathak, S. K. (1989). Optimal crop planning for a region in India by conjunctive 
use of surface and groundwater. International Journal of Water Resources Development, 5(2), 
99–105. 
Leroux, C., Jones, H., Clenet, A., & Tisseyre, B. (2017). A new approach for zoning irregularly￾spaced, within field data. Computers and Electronics in Agriculture, 141, 196–206. 
Mainuddin, M., Das Grupta, A., & Raj Onta, P. (1977). Optimal crop planning model for an existing 
groundwater irrigation project in Thailand. Agricultural Water Management, 33(1), 43–62. 
Mauri, G.R. (2019). Improved mathematical model and bounds for the crop rotation scheduling 
problem with adjacency constraints. European Journal of Operational Research 278(1), 120– 
135. 
McCarl, B. A., Candler, W. V., Doster, D. H., & Robbins, P. R. (1977). Experiences with farmer 
oriented linear programming for crop planning. Canadian Journal of Agricultural Economics, 
25(1), 17–30. 
Memmah, M.-M., Lescourret, F., Yao, X., & Lavigne, C. (2015). Metaheuristics for agricultural 
land use optimization. A review. Agronomy for Sustainable Development, 35(3), 975–998. 
Ohana-Levi, N., Bahat, I., Peeters, A., Shtein, A., Netzer, Y., Cohen, Y., & Ben-Gal, A. (2019). 
A weighted multivariate spatial clustering model to determine irrigation management zones. 
Computers and Electronics in Agriculture, 162, 719–731. 
Ortega, R., & Santibáñez, O. (2007). Agronomic evaluation of three zoning methods based on soil 
fertility in corn crops (Zea mays L.). Computers and Electronics in Agriculture, 58, 49–59.178 V. M. Albornoz and G. E. Zamora
Peralta, N. R., Costa, J. L., Balzarini, M., Franco, M. C., Córdoba, M., & Bullock, D. (2015). 
Delineation of management zones to improve nitrogen management of wheat. Computers and 
Electronics in Agriculture, 110, 103–113. 
Plà, L. M., Sandars, D. L., & Higgins, A. J. (2014). A perspective on operational research prospects 
for agriculture. Journal of the Operational Research Society, 65, 1078–1089. 
Roudier, P., Tisseyre, B., Poilv è, & H., Roger, J.-M. (2008). Management zone delineation using 
a modified watershed algorithm. Precision Agriculture 9(5), 233–250. 
Salama, O., Farouk, H. A., & Galal, N. M. (2020). Crop planning problem using rectangular 
management zones and different irrigation systems. In Proceedings of the International 
Conference on Industrial Engineering and Operations Management (pp. 392–399). 
Santos, L. M. R., Munari, P., Costa, A. M., Arenales, M. N., & Santos, R. H. S. (2015). A branch￾price-and-cut method for the vegetable crop rotation scheduling problem with minimal plot 
sizes. European Journal of Operational Research, 245, 581–590. 
Sarker, R., & Ray, T. (2009). An improved evolutionary algorithm for solving multiobjective crop 
planning models. Computers and Electronics in Agriculture, 68(2), 191–199. 
Sarker, R. A., Talukdar, S., & Haque, A. (1997). Determination of optimum crop mix for crop 
cultivation in Bangladesh. Applied Mathematical Modelling, 21(10), 621–632. 
Soto-Silva, W. E., Nadal-Roig, E., González-Araya, M. C., & Plà-Aragonés, L. M. (2016). 
Operational research models applied to the fresh fruit supply chain. European Journal of 
Operational Research, 251, 345–355. 
Treimun, G., Riff, M. C., & Albornoz, V. M. (2019). GHLAP: Greedy heuristic for land 
partitioning. In V. M. Albornoz & A. Mac Cawey (Eds.), Proceedings of the III International 
Conference on Agro BigData and Decision Support Systems in Agriculture (pp. 73–76). 
Universidad Técnica Federico Santa María. 
Utomo, D.S., Onggo, B.S., & Eldridge, S. (2018). Applications of agent-based modelling and 
simulation in the agri-food supply chains. European Journal of Operational Research 269 (3), 
794–805. 
Velasco, J., Vicencio, S., Lozano, J. A., & Cid-García, N. M. (2021). Delineation of site-specific 
management zones using estimation of distribution algorithms. International Transactions in 
Operational Research. https://doi-org.usm.idm.oclc.org/10.1111/itor.12970 
Villalobos, J. E., Soto-Silva, W. E., González-Araya, M. C., & González-Ramírez, R. G. (2019). 
Research directions in technology development to support real-time decisions of fresh produce 
logistics: A review and research agenda. Computers and Electronics in Agriculture, 167, 
105092. 
Wolfert, S., Ge, L., Verdouw, C., & Bogaardt, M.-J. (2017). Big data in smart farming – A review. 
Agricultural Systems, 153, 69–80. 
Xiaohu, Z., Li, J., Xiaolei, Q., Jianxiu, Q., Juan, W., & Yan, Z. (2016). An improved method of 
delineating rectangular management zones using a semivariogram-based technique. Computers 
and Electronics in Agriculture, 121, 74–83. 
You, P.-S., & Hsieh, Y.-C. (2017). A computational approach for crop production of organic 
vegetables. Computers and Electronics in Agriculture, 134, 32–42. 
Zane, L., Tisseyre, B., Guillaume, S., & Charnomordic, B. (2013). Within-field zoning using a 
region growing algorithm guided by geostatistical analysis. In Proceedings of the European 
Conference on Precision Agriculture ECPA 2013 (pp. 313–319). 
Zhang, W., & Wilhelm, W. E. (2011). OR/MS decision support models for the specialty foods 
industry: A literature review. Annals of Operations Research, 190, 131–148.A System for Supporting Supplier 
and Cold Storage Selection in the Fresh 
Fruit Supply Chain 
Wladimir E. Soto-Silva, Marcela C. González-Araya, 
and Lluís M. Plà-Aragonés 
1 Introduction 
In the fruit supply chain (FSC), the procurement of raw material implies decisions 
on fresh produce purchases and storage as in other agri-industries. These decisions 
are critical since they have a great impact on the final quality of the product and the 
efficiency of the industrial process (Soto-Silva et al., 2017). It is also important to 
highlight that the raw material purchase costs around 70% of the total production 
cost of any product (van der Vorst et al., 2007). Nevertheless, in the agri-industry, 
this purchase cost represents around 80% of the total production cost (Soto-Silva et 
al., 2017). 
Usually, juice, fresh, canned, dehydrated, and frozen fruit companies have to buy 
fresh fruit and hire the necessary cold chambers to preserve it for a long period 
before processing. These decisions are made before or during the beginning of a 
harvest season. Regarding this topic, the fruit quality is relevant for deciding the 
suitable number and refrigeration technology of the cold chamber. In this way, the 
supplier selection in the FSC is a critical issue because the shelf life of raw material 
is very short (Paam et al., 2019). This means that the coordination and planning of 
W. E. Soto-Silva 
Departamento de Computación e Industrias, Facultad de Ciencias de la Ingeniería, Universidad 
Católica del Maule, Talca, Chile 
M. C. González-Araya (O) 
Department of Industrial Engineering, Faculty of Engineering, Universidad de Talca, Curicó, 
Chile 
e-mail: mgonzalez@utalca.cl 
L. M. Plà-Aragonés 
Departamento de Matemática, Universidad de Lleida, Lleida, Spain 
Agrotecnio Research Center, Lleida, Spain 
e-mail: lmpla@matematica.udl.cat 
© Springer Nature Switzerland AG 2024 
V. M. Albornoz et al. (eds.), Optimization Under Uncertainty in Sustainable 
Agriculture and Agrifood Industry, https://doi.org/10.1007/978-3-031-49740-7_8
179180 W. E. Soto-Silva et al.
the FSC require more accuracy and speed for meeting present and future demands. 
Due to this, a decision support system (DSS) could be a useful tool for helping 
agro-industrial companies to make more precise and quick decisions. Nevertheless, 
in the literature, the majority of proposed DSSs have been developed to support 
crop decisions (Papadopoulos et al., 2011; Pavana et al., 2011; Mannini et al., 2013; 
Small et al., 2015; Navarro-Hellín et al., 2016; Cañadas et al., 2017; Rupnik et al., 
2018; Lasso et al., 2018; Rowshon et al., 2019). Therefore, the development of DSSs 
for supporting supplier selection, distribution, and storage decisions in the FSC is 
required. 
In this research, was developed a DSS for managing the supplier selection 
in large FSC companies that allows them to make fast and flexible decisions 
regarding fruit purchases and storage in cold chambers. The developed DSS keeps 
historical records of fruit producers and cold storage providers, makes purchase 
recommendations according to fruit quality, and estimates costs of cold storage 
rentals. Cold technology is recommended according to the processing plan of a 
company, fruit quality, and storage time. The authors adapted the DSS interface 
for a Chilean dehydrated fruit company; this company was involved in the current 
case study. 
This chapter is structured as follows: In the first sub-section, the introduction is 
presented. In the second sub-section, a literature review about DSS developed for 
decision-making process in agricultural supply chain is carried out. The third sub￾section describes the main decisions in the fresh FSC, while the fourth sub-section 
details the design of the proposed DSS. In the fifth sub-section, the results obtained 
by the DSS for a Chilean case study are shown. Finally, in the last sub-section, the 
main conclusions of this study and future research are presented. 
2 Literature Review 
DSSs have been applied in agriculture to support different decisions, such as 
strategic planning, management control, and operational control, and in different 
areas, such as wine, agriculture, business, health, environment, livestock, and 
perishable and non-perishable items (Turban & Aronson, 2000; Fountas et al., 
2015). Fountas et al. (2015) reviewed 141 articles about information systems for 
farm management, in which around 63% focused on managing farm operations. 
Table 1 presents DSSs developed to support decisions at different echelons of 
the agricultural supply chain. The DSSs included were published between 2011 
and until August of 2021. The echelons identified in the literature were seeding 
(planting), produce, harvest, and the production process. 
As can be observed in Table 1, 27 studies presented DDSs for agricultural supply 
chain decisions. Eleven (%) were developed for supporting crop decisions. It is 
important to notice that specific DSSs for FSC decisions were found. The majority 
of the reviewed articles do not deal with real case studies, using hypothetic instances 
for presenting the functionality of the DSS. In summary, there are still agriculturalA System for Supporting Supplier and Cold Storage Selection in the Fresh Fruit... 181 Table 1 DSSs for agricultural supply chain decisions Article Key aspects/contribution Echelon Case study Papadopoulos et al. (2011) The DSS determines the optimal amount of nitrogen in a crop based on the fuzzy set theory Crop Different types of crops Visconti et al. (2011) The DSS estimates salinity, sodicity, and alkalinity conditions of the soil. This information is used to determine the best crop that can be planted on a farm Seeding Different types of crops Pavana et al. (2011) The DSS allows planning fungicide applications to strawberry crops, seeking to minimize the fruit loss caused by pests Crop Strawberries Dionysis et al. (2012) The DSS determines the optimal routes of the agricultural machinery on a farm, aiming to minimize land compaction during its transit Seeding Different types of crops Mannini et al. (2013) The DSS estimates the amount of water required by every crop by considering water availability, soil characteristics, and type of crops Crop Different types of crops Elsheikh et al. (2013) The DSS identifies the suitability of land for different types of crops based on the climate, soil, topography, and evolution form Seeding Different types of crops López-Milán and Plà-Aragonés (2014) The DSS provides the optimal supply of sugarcane to a processing plant Harvest-production process Sugar cane Small et al. (2015) The DSS forecasts diseases in different crops by considering climatic and soil variables Crop Potato, tomato Kerselaers et al. (2015) The DSS determines which areas can be reused for cultivation Seeding Different types of crops Sánchez-Cohen et al. (2005) The DSS optimizes the number of crops to be seeded depending on the water availability Seeding Different types of crops Navarro-Hellín et al. (2016) The DSS allows managing the irrigation of a lemon orchard based on IoT tools that measure temperature, soil humidity, radiation, wind speed, and rainfall Crop Lemon (continued)182 W. E. Soto-Silva et al. Table 1 (continued) Article Key aspects/contribution Echelon Case study Tanuja et al. (2016) The DSS supports farm management decisions to increase their yields. For this, it determines the best combination of raw material (fertilizers, nitrogen, and water) that a crop will need Seeding Maize, wheat Cañadas et al. (2017) The DSS allows automatically controlling the climate of a greenhouse to reduce the appearance of tomato pests Crop Tomato Terribile et al. (2017) The DSS allows planning a vineyard plantation using geospatial analysis tools Planting Wine grapes Rupnik et al. (2018) The DSS simulates the behavior of pests in a corn farm, aiming to reduce crop losses Crop Corn Lasso et al. (2018) The DSS estimates the appearance of a coffee disease (coffee rust) caused by climate change Crop Coffee Rowshon et al. (2019) The DSS simulates water requirements in rice farms Crop Rice Perondi et al. (2019) The DSS forecasts climatological variations that affect crop growth Seeding Maize, wheat Weisong et al. (2019) The DSS identifies ideal locations to produce grapes, considering climate, soil, and labor variables Planting Grape Bonfante et al. (2019) The DSS allows managing irrigation in a crop, considering in situ soil sensor, remote sensing, and simulation modeling of water balance in the soil-plant and atmosphere system Seeding Maize Corbari et al. (2019) The DSS proposes an intelligent irrigation management in a crop, considering coupling satellite-driven soil water balance model and meteorological forecast Crop Different types of cropsA System for Supporting Supplier and Cold Storage Selection in the Fresh Fruit... 183 Gallardo et al. (2020) A DSS is proposed that allows to optimize irrigation and manage nutrients in fields of vegetable crops Crop Different types of crops Visconti et al. (2020) An intelligent agricultural traceability and management system based on IoT is proposed, which calibrates irrigation and nutrient management operations based on the type of crop, growth phase, soil and environment parameters, and meteorological information Seeding Different types of crops Vishwajith et al. (2020) A DSS is developed to support decision-making regarding recommended water, weeds, pest and disease management, and nutrient management in pulses crops Crop Pulses Manna et al. (2020) A DSS developed on the web is proposed, which aims to plan and manage olive tree crops Seeding Olive Monardes-Concha et al. 
(2020) 
The DSS proposes the optimal distribution of grapes from the 
orchards to the processing plant 
Harvest-production 
process 
Grape 
Khan et al. (2021) The DSS allows to manage irrigation in orange orchard, 
considering water availability, humidity, and crop growth 
Crop Orange184 W. E. Soto-Silva et al.
decisions related to irrigation (Mir & Quadri, 2009), cultivation (Jain & Raju, 2016), 
harvesting processes (Fountas et al., 2015), and refrigerated transport (Fountas et al., 
2015), in which it is necessary to develop a DSS. 
3 Supplier Selection in the Fresh FSC 
The coordination of the FSC is a relevant issue for most companies, especially those 
exporting abroad because they need to preserve the fruit shelf life for a longer time. 
The coordination relies on processing plants, and they manage the flow of fruit from 
orchards to the end customer. To do that, purchasing and storing fruit are crucial for 
the steady production of a processing plant. 
The structure of the first echelons of a typical FSC is shown in Fig. 1; they 
are purchase, transport, receiving, cold storage, and processing. In these echelons, 
around 80% of production costs are generated (Soto-Silva et al., 2016). Therefore, 
the stakeholders are required to put more effort into coordinating them so that they 
satisfy the fruit demand in the best physiological conditions. 
During the purchase stage, the plant managers need to assure enough raw 
material for the processing plant during the whole year. Purchase contracts are 
agreed on with producers before or during the harvesting season. It is very difficult 
to purchase fruit once the harvesting season is over because most of the production 
is already under contract, but it depends on market conditions. 
The fruit transportation from the orchards to the cold storage facilities and 
processing plants is done usually by trucks. As transportation is usually outsourced 
(Soto-Silva et al., 2016), processing plants need to plan the number of trucks to be 
rented for the harvest season and the rest of the year. 
Fig. 1 Supply chain structure of fresh fruit destined to agri-industrial plants (Soto-Silva et al., 
2017)A System for Supporting Supplier and Cold Storage Selection in the Fresh Fruit... 185
Concerning cold storage facilities, they usually have more than one cold chamber 
and various refrigeration technologies. The renting of cold chambers depends on 
the tonnes of fruit and their required refrigeration technology. It is important to note 
that, for many fruit species, such as apple, kiwi, peach, and plum, different varieties 
have different respiration rates and shelf life. This implies that each variety must be 
stored separately (Paam et al., 2019). 
There are many uncertainties surrounding the FSC such as market conditions, 
climate, exchange rates, and raw material shortage, among others (Soto-Silva et al., 
2016). For this reason, it is necessary to react quickly and flexibly to face these 
changes before and during the harvest season. In this way, a DSS could help to 
overcome these uncertainties by evaluating early different scenarios, where different 
information about these conditions could be forecasted and incorporated. In this 
study, a DSS is developed in order to support supplier selection, distribution, and 
storage decisions in the FSC, allowing analyzing quickly the possible scenarios and 
changes during a harvest season. 
In Table 2, the main tactical and operational decisions in the first echelons of 
the FSC addressed by the proposed DSS are identified, and their relationships are 
represented in Fig. 2. 
It is important to note that the tactical FSC planning could be divided into three 
decision areas or plans, as depicted in Fig. 2: (1) supply plan, (2) cold storage plan, 
and (3) transport plan. These plans allow considering all the involved decisions in 
the purchase, transport, production process, and cold storage echelons. 
According to Fig. 2, the supply plan (1) provides information to allow selecting 
fresh produce from suppliers (4), scheduling truck transportation (7), planning the 
supply for the processing plants (8), and leasing cold storage facilities (10). The cold 
storage plan (2) provides information for selecting fresh produce from suppliers 
(4), planning the production process (9), leasing cold storage facilities (10), and 
Table 2 Main decisions in the addressed echelons of the FSC 
Tactical planning decisions Echelons Main operational decisions 
(1) Supply plan 
(2) Cold storage plan 
(3) Transport plan 
Purchase 4. Selecting fresh produce from 
suppliers 
Transport 5. Buying or leasing the truck fleet 
6. Planning the truckload assignments 
7. Scheduling truck transportation 
Production process 8. Planning the supply for the 
processing plants 
9. Planning the production process 
Cold storage 10. Leasing cold storage facilities 
11 Selecting the refrigeration 
technology 
12. Planning the filling of cold 
chambers186 W. E. Soto-Silva et al.
Fig. 2 Relationships among decisions 
selecting the refrigeration technology (11). Finally, the transport plan (3) provides 
information for buying or leasing the truck fleet (5). 
Regarding every echelon of the FSC, in Fig. 2 it is possible to observe that in 
the purchase echelon, the purchase plan is made (4). This plan makes available 
information for planning the truckload assignments (6), planning the production 
process (9), and selecting the refrigeration technology (11). In the transport echelon, 
the made decisions are buying or leasing the truck fleet (5), planning the truckload 
assignments (6), and scheduling truck transportation (7). In the production process 
echelon, the associated decisions are planning the supply for the processing plants 
(8) and planning the production process (9). The decision (8) presents information 
for scheduling truck transportation (7) and planning the production process (9), 
while the decision (9) allows planning the filling of cold chambers (12). In the cold 
storage echelon, the made decisions are leasing cold storage facilities (10), selecting 
the refrigeration technology (11), and planning the filling of cold chambers (12). 
In addition, decision (10) allows selecting the refrigeration technology (11), and 
decision (11) impacts in planning the filling of cold chambers (12). 
Because of the complexity of these relationships and possible interactions during 
the year, it is difficult for a decision-maker to evaluate the impact of all the feasible 
decisions. In this sense, making decisions in a supply chain echelon independently 
from the rest of the FSC could lead to inefficiencies or sub-optimal decisions for the 
whole chain. Table 3 summarizes the input information and output reports required 
for integral decision-making in the FSC, while Fig. 3 illustrates their relationships 
considering a joint optimization of the FSC.A System for Supporting Supplier and Cold Storage Selection in the Fresh Fruit... 187
Table 3 Input information and output reports for planning the FSC 
Echelons Input information Output report 
Purchase A. Location of suppliers 
B. Identification of suppliers 
C. Quantity of fruit available by 
supplier 
D. Variety of fruit available by 
supplier 
E. Quality of fruit available by 
supplier 
O. Fruit purchase plan 
Transport F. Capacity of trucks 
G. Type of truck 
H. Number of available trucks 
P. Leasing plan of truck fleet 
Q. Assignment of fruit load per 
truck 
R. Transportation schedule 
Production process I. Plant capacities 
J. Demand for each fruit variety 
S. Fruit supply plan for each plant 
Cold storage K. Available number of cold 
chambers in each cold storage 
L. Location of cold storages 
M. Kind of refrigeration technology 
N. Cold chamber capacity 
T. Leasing plan of cold storage 
facilities 
U. Filling plan of cold chambers 
Transport 
Production 
Process 
Purchase Cold Storage 
F G 
J 
A 
B 
D 
E K 
L 
M 
N 
T 
U 
O 
Total Costs 
Inputs Fresh Fruit Supply Planning 
Outputs 
R 
S 
Q 
P 
C I 
H 
Fig. 3 Schematic representation of the information relationships for the decision-making process 
of FSC planning (adapted from Recio et al., 2003)188 W. E. Soto-Silva et al.
As shown in Tables 2 and 3 and Figs. 2 and 3, the tactical FSC planning has 
mainly four echelons: purchase, transport, production process, and cold storage. 
In all of these echelons, input information should be collected and analyzed to 
design the tactical FSC plan (see Table 2). Once the tactical FSC plan is obtained, 
it is possible to carry out the different output reports for supporting the decisions 
associated with each echelon, as presented in Table 3. For example, in Fig. 3, for 
obtaining the output report O (fruit purchase plan), the input information required 
corresponds to A, B, C, D, E, H, J, L, M, and N, which are defined in Table 2. To 
generate the output report T, you need the input information K, L, M, and N and 
the output report O. In addition, the output reports O and T, with input information 
P, Q, R, S, and U, allow calculating the total costs of the tactical FSC plan. In 
this way, it is possible to note that the decision-making process is not easy because 
many interrelated decisions and information need to be considered at the same time. 
Therefore, decision support tools for planning the FSC are necessary. 
Some large export companies design the tactical FSC plan at least 1 month in 
advance before the beginning of the fruit harvest. The design requires almost 4 
weeks and involves around ten professionals, who mainly belong to the operations 
department. Moreover, the resulting tactical plan could be sub-optimal and with 
limited flexibility if unforeseen changes happen. 
4 FruitPS-DSS Development and Design 
The agroindustry managers have little training or are not prone to use DSSs 
(McCown, 2012); thus, for the FruitPS-DSS to support the decision-making process, 
it must be easy to understand and have a friendly interface system. 
For developing the FruitPS-DSS, we used the Scrum strategy (Turban & 
Aronson, 2000) because it permitted a quick interaction between the company staff 
and the developers, demanding less time from all the stakeholders. Moreover, Scrum 
involves an incremental DSS development (Lonchamp, 2005), which means that it 
focuses on carrying out the DSS development in short time cycles called sprints. 
The Scrum methodology defines roles for the DSS developing team. These roles are 
product owner, scrum master, and team member (Lonchamp, 2005). In addition, the 
Scrum methodology is based on three stages. The first stage is planning, where all 
the relevant information for the DSS development is collected. The second stage is 
development, where the sprints for the DSS development are accomplished. The last 
stage is implementation, where the implementation plan for the DSS is carried out. 
Figure 4 shows the architecture of the developed DSS, the FruitPS-DSS. In 
this figure, the mathematical model proposed by Soto-Silva et al. (2017) for the 
purchase, transport, production process, and cold storage plans is connected to a 
database from which the model gets all the parameters. A user can interact with the 
model through an interface, load or modify parameters, and run the model. In this 
way, the user does not need to take care of the mathematical formulation.A System for Supporting Supplier and Cold Storage Selection in the Fresh Fruit... 189
Fig. 4 Architecture of the FruiPS-DSS (adapted from López-Milán and Plà-Aragonés (2014)) 
The input data for the model corresponds to the records of available producers, 
including estimated production and corresponding varieties and cost; transportation 
companies, including the number of trucks, load capacity, fuel consumption, and 
cost; storage companies, including the number of cold storage facilities with cold 
chambers and refrigeration technology, the stock capacity, and cost; and finally, 
the processing capacity of the plant. The output data corresponds to the model 
solution that is also stored in the database and represents the flow of fruit along 
the FSC over an operation year, including purchase, transport, production process, 
and cold storage plans. It is possible to modify, add, or remove information from the 
database through a graphical interface. This structure was built with the agreement 
of every member on the development team. In the following sub-sections, the main 
components of the FruitPS-DSS (planning model, database and pre-processing, and 
graphical interface) are described in more detail. 
5 The Planning Model 
As mentioned previously, the FruitPS-DSS implements the mixed-integer linear 
programming (MILP) model proposed by Soto-Silva et al. (2017), which seeks to 
minimize all the costs derived from the fruit purchase, transport, production process,190 W. E. Soto-Silva et al.
Table 4 Decision variables used in the planning model 
Decision variables Description 
Wpqtl Quantity of fruit to buy from producer p of type q with storage time t 
transported by truck type l 
Slpq Quantity of trips for truck type l from producer p with fruit type q 
Xpqt Binary variable with the value 1 if fruit is purchased from producer p of 
type q and storage time t; otherwise, the value is 0 
Cp Binary variable with the value 1 if the fruit is purchased from producer p 
and 0 if not 
Zqtcnl Quantity of fruit type q with storage time t in cold storage facility c in 
cold chamber n transported in truck type l 
Ylcn Number of trips by truck type l to cold storage facility c to cold 
chamber n 
Ac Binary variable with value 1 if cold storage facility c is used and 0 if not 
MEcnqt Binary variable with value 1 if fruit type q with storage time t is kept in 
cold storage facility c 
and cold storage activities needed for the plant operation. In this way, the model 
allows selecting fruit producers and cold chambers according to the fruit quality 
and quantity requested by the company. The MILP model proposed by Soto-Silva 
et al. (2017) is detailed in Appendix 1, where the decision variables of this model 
are presented in Table 4. The constraints represent the system operation described 
in Sect. 3. Some of the constraints considered by the model are plant capacity, fruit 
supply, fruit demand, number and capacity of trucks, and number and capacity of 
cold chambers, among others. 
Figure 5 shows a schematic representation of the relationships among the 
decision variables of the planning model with the input information and output 
reports mentioned in Table 3. The result of the decision variables depends on the 
input parameters and allows creating different outputs reports and scheduling to 
guarantee that the plant operates during the whole year. 
As can be observed in Fig. 5, the optimal value of decision variables (Wpqtl, Slpq, 
Xpqt, and Cp) allows generating the output report “Fruit purchase plan” (output O 
of Table 2). For example, the optimal value of the decision variable Wpqtl represents 
the quantity of a fruit species or variety q to buy from producer p that must be 
stored during period t and transported by truck l. The required inputs are location of 
suppliers, identification of suppliers, quantity of fruit available by supplier, variety 
of fruit available by supplier, number of available trucks, and demand for each fruit 
variety (inputs A, B, C, D, H, and J of Table 3).A System for Supporting Supplier and Cold Storage Selection in the Fresh Fruit... 191
A C 
B 
E 
D 
Wpqtl 
Slpq 
Xpqt 
Cp 
Zqtcnl 
Ylcn 
Ac 
M Ecnqt 
U 
T 
S 
R 
Q 
O 
Input Information Planning Model Output Reports
Decision Variables 
P 
F 
H 
I 
K 
L 
M 
N 
J 
G 
Fig. 5 Schematic representation of relationships among decision variables, input information, and 
output reports 
6 Database and Pre-processing 
The FruitPS-DSS integrates all the required information for model operation and 
user management into a single database. The fields associated with the purchase 
are producers, quantity and quality of fruit supply, cost of purchase, and transport 
availability. The fields considered in the storage are the availability of cold 
chambers, refrigeration technology of each cold chamber, transport, and leasing 
costs of each cold chamber. 
All data for the FruitPS-DSS must be collected, calculated, organized, and 
reviewed in order to deliver accurate reports (Fig. 6). The data uploaded may refer to 
purchase or storage data. Regarding purchases, it is necessary to introduce estimates 
of production for each producer by fruit variety and quality and fresh fruit price and 
demand. The “Upload Purchase Data from Excel” process is represented in Fig. 6. 
Storage decisions require entering the number of available cold chambers (owned 
or leased), their respective refrigeration technology and capacity, and transportation 
cost. The input parameter must be introduced before the beginning of the harvesting 
season. The “Upload Storage Data from Excel” process is represented in Fig. 6. 
The developed FruitPS-DSS was installed on a personal computer with an 
Intel(R) Core (TM) i5-5300U CPU 2.30 GHz processor with 8 GB of RAM and 
a 600 GB hard drive.192 W. E. Soto-Silva et al.
Start 
Upload Purchase Data 
from Excel 
Upload Storage Data from 
Excel 
¿Modify 
Information? 
¿Add New 
Date? 
No 
Yes 
Change Date 
Database 
Yes 
No 
Add New Input 
End 
Fig. 6 Diagram process for changing and adding new parameters to the database 
7 Graphical Interface 
The development of the FruitPS-DSS graphical interfaces was done by collecting 
suggestions from plant managers and team members. The different user profiles 
were considered, and all the menu options (three levels) are presented in Fig. 7. 
Interfaces were programmed in the NetBeans IDE programming platform (version 
8.0). This tool allows the user to load the input parameters from the database to the 
mathematical model implemented in the software OPL Development Studio IDE 
(version: 6.0.1), which uses IBM CPLEX software (version 12.10) as a solution 
engine. 
As observed in Fig. 7, there are three levels to enable the decision-making 
capabilities of the system. The first level corresponds to the main menu where a user 
can enter or modify the data in some of or all three sub-levels: cold storage menu, 
purchase menu, and computational parameters menu. These data are necessary 
inputs for the mathematical model embedded in the FruitPS-DSS. In addition, in 
order to avoid infeasibility, the data are checked for detecting inconsistencies. IfA System for Supporting Supplier and Cold Storage Selection in the Fresh Fruit... 193
Start Menu 
Cold Storage 
Menu Purchase Menu 
Computational 
Parameters 
Menu 
Storage Capacity Demand 
Storage Cost Sale Price of Fresh 
Fruit 
Relative 
Tolerance 
Fixed Costs Producer’s Supply Excecution 
Time 
Transport Cost Transport Cost 
Type of 
Refrigeration 
Technology 
Maximun 
Transportation Load 
Levels of Decision Support System 
Primary Level Secondary Level Tertiary Level 
Fig. 7 Levels of the FruitPS-DSS user interfaces 
inconsistencies are detected, the DSS does not run, and accordingly a message is 
issued. 
The purchase and cold storage menus address the corresponding decision￾making problems. These separated menus allow simplifying the planning and 
facilitating of the database management (data check, order, and store). The main 
stored data corresponds to producers, cold storages, and processing plants. The 
menu associated with the computational parameters permits changes in the relative 
tolerance and execution time of the MILP Solver: CPLEX software (version 12.10). 
This menu is for the more advanced users in mathematical programming. 
The actual appearance of the main interface of the FruitPS-DSS is presented 
in Fig. 8. This interface shows the purchase button, cold storage button, and 
computational parameters button for uploading data corresponding to the first level 
of Fig. 7. These buttons lead to associated menus. 
For executing the FruitPS-DSS, it is always necessary to retrieve the purchase, 
storage, and transportation data by entering them manually (Fig. 8a) or uploading 
them from a file. To not incur data digitation errors when many producers are 
involved, data parameters can be uploaded from an Excel file. Similarly, data about 
each cold chamber capacity and refrigeration technology, variable and fixed cold194 W. E. Soto-Silva et al.
Fig. 8 Main interface of FruitPS-DSS (a) and screen for loading the cold storage data (b) 
storage costs, and transportation costs can be uploaded from an Excel file, as shown 
in Fig. 8b. 
The action flow for reaching a plan by the FruitPS-DSS begins by entering the 
processing plant demand for each fruit variety and quality (see Fig. 9). Once the user 
agrees with all registered data, the model can be solved by returning to the first-level 
interface and clicking the start button. 
The solutions obtained by the FruitPS-DSS are exported to two Excel spread￾sheets. One spreadsheet presents the purchase proposal, and the other one presents 
the cold storage proposal, including the transport plan. The solutions are processed 
using dynamic tables and macros of Excel programmed with Visual Basic 6.0 in 
order to facilitate the user’s interpretation. 
8 FruitPS-DSS Performance in a Chilean Agri-industrial 
Company 
The FruitPS-DSS was applied in an agri-industrial plant of dehydrated apples 
located in the Maule Region, Chile. The dehydrated apples are destined for export. 
Annually, the processing plant consumes more than 36,000 tonnes of raw material; 
apples represent around 60%. During 2017, the company processed apples from 279 
producers, which supplied 6 varieties with 3 different qualities and had an annual 
apple demand of approximately 28,000 tonnes. During this season, 124 producers 
offered apples labeled as short term, 75 producers supplied apple varieties classified 
as medium term, and 80 producers as long term. Therefore, there was enough supply 
of all quality types of fresh fruit. In addition, there was enough fruit for satisfying 
the demand of the six varieties consumed by the plant; 134 producers supplied only 
one apple variety; 72, two apple varieties; and 73, three or more apple varieties.A System for Supporting Supplier and Cold Storage Selection in the Fresh Fruit... 195
Start 
Add Demand 
for Fruit? 
Modify 
Entered 
Information? 
No 
No 
No 
Yes 
Yes 
Yes 
End 
Save 
Planning 
Run model 
Modify 
Parameters 
Modify 
Parameters 
Model? 
Define 
Parameters 
Add New 
Entry Database 
New 
Information 
Fig. 9 Diagram process for the FruitPS-DSS execution 
Thus, the fruit supply was not purchased from only a few producers. This situation 
makes the decision-making process more complex for the dehydration plant. It is 
important to mention that, when deciding to purchase fruit from a producer, it is 
necessary to buy all of their fruit varieties produced. 
At the beginning of the season, the company had 12 cold storage facilities 
for rent available, which contained 70 cold chambers with different refrigeration 
technologies. In addition, it had leased a fleet of 28 trucks, which could be 
categorized by their cargo bin capacity (26, 32, and 66 bins). 
In order to store the fresh apples longer, a classification method was applied. This 
method considers the fruit conditions during the pre-harvest and harvest period and196 W. E. Soto-Silva et al.
the fruit ripeness when received. The method gives a classification to each batch 
of fruit for determining the cold chamber technology required for storing it. This 
classification method is called segregation, and it is related to the period that fresh 
products can be stored while maintaining their initial conditions. Therefore, there 
are three kinds of segregation: short (1 to 3 months), medium (3 to 6 months), 
and long term (6 to 9 months). Each kind of segregation should be stored in cold 
chambers with conventional (CR), smart fresh (SF), or controlled atmosphere (CA) 
refrigeration technology. Although fruit segregation is done by the company, this 
information had been neglected for the purchase and storage planning. The company 
purchased all the fruit that their cold storage facilities allowed for achieving the 
annual production plan regardless of refrigeration technology type. 
There was no central database to save and keep all the information together; 
therefore, each decision maker collected, processed, and stored the required infor￾mation on their own according to their experience. For the studied company, the 
fresh fruit purchase and storage processes were carried out during the harvest 
season. These processes lasted approximately 3 months, involving several human 
resources such as technical, administrative, and operational staff. In this sense, 
during this period it was necessary to coordinate many workers from different areas 
of the company. 
8.1 Analyzing Different Scenarios Through the FruitPS-DSS 
The developed FruitPS-DSS allows planning easily, quickly, and flexibly the 
purchase and storage of fresh fruit. With this in mind, the FruitPS-DSS can give 
different planning configurations if there are changes in the markets, prices, weather, 
or other conditions. In order to illustrate the utility of the FruitPS-DSS, different 
scenarios are considered. The input data are: 
• Fruit supply: The quality department staff carried out technical visits to the 
orchards during the pre-harvest period. In this way, in situ information about the 
fresh fruit physiological conditions and agricultural management was collected. 
This information was used to estimate the fresh fruit quantity and quality. During 
the sprints, it was defined that the representative of the quality department would 
have to estimate the fruit supply amount of every producer to the operations 
department staff (users). 
• Fruit purchase price: The purchase price was established by the company at the 
beginning of the harvest season according to the fresh fruit variety and quality. 
During the sprints, it was established that the operations department would be in 
charge of this estimation and feeding these data to the FruitPS-DSS. 
• Fruit demand: The fresh fruit demand was estimated according to the final 
product demand established by the commercial area of the company.A System for Supporting Supplier and Cold Storage Selection in the Fresh Fruit... 197
• Cold chamber information: This information was collected by the operations 
department of the company. The leasing cost of a chamber was calculated as the 
average market price. 
• Transportation cost: This cost corresponded to the leasing costs of the fleet and 
involved two items: fixed and variable costs. The fixed cost corresponded to 
completed truck trips, and the variable cost was calculated based on the number 
of transported bins. In the case study, the average market price was used. 
The FruitPS-DSS is designed for supporting decisions in tactical supply planning 
at the beginning of a harvest season. Nevertheless, it can be used at any time if 
the conditions change. For example, an increase in product demand could imply 
purchasing more fresh fruit. However, outside the harvest season, the prices are 
high, and fresh fruit availability is low. In this case, the FruitPS-DSS can support the 
new purchase decisions in a short time to minimize the cost and obtain the required 
fruit quality. The FruitPS-DSS allows decision-makers’ flexibility and quickness 
for analyzing different situations to estimate their impacts on the tactical supply￾planning decisions. 
Table 5 presents two possible scenarios for the studied company, where a 
variation of 50% of fruit demand is analyzed. The scenario highlighted in gray 
corresponds to the current situation of the company. In Table 5, a negative 
percentage variation means a percentage reduction of the demand from the original 
value. On the other hand, a positive percentage variation means a percentage 
increase of the demand from the original value. Moreover, in Appendix 2 (Table 
10), different scenarios are presented, which were defined in working meetings with 
agro-industrial and operational managers of agro-industrial companies of the Maule 
Region, Chile. These scenarios assume different possible changes in the demand 
and fruit price during a season, because they change more often. In this way, the 
performance of the FruitPS-DSS can be demonstrated. 
Regarding Table 5, when the fruit demand increases from 0% to +50%, the 
number of selected producers increases from 135 to 197, representing a percentage 
increase around 46%, and the number of cold storage facilities increases from 8 to 
10, representing a percentage increase around 25%. These increments are reflected 
in the total cost that augments about 39%. On the other hand, when the fruit demand 
decreases from 0% to −50%, the number of selected producers decreases from 135 
to 68, representing a percentage reduction around 49%, and the number of cold 
storage facilities decreases from 8 to 4, representing a percentage reduction around 
50%. These reductions affect the total cost that reduces around 48%. 
In Fig. 10, the two previous scenarios (−50% and +50%) are represented 
considering each fruit segregation. The fruit prices are maintained constant. 
Figure 10 shows the selection of the cold chambers according to the percentage 
variation of the different fruit segregations. Firstly, when the demand for long-term 
fruit increases, the use of CA chambers increases, and when the contrary occurs, the 
use of SF and CR increases. Table 6 compares the results shown in Fig. 10 with the 
results obtained for the base scenario.198 W. E. Soto-Silva et al. Table 5 Purchase and storage plan for a demand variation of 50% % Variation Purchase (tonnes) No. cold chambers Cost (M US $) Demand Prices Short Medium Long No. suppliers CR SF CA No. CSF Purchase Storage Total cost −50% 0% 4613 2534 6913 68 5 3 8 4 792.5 146.6 939.1 0% 0% 9226 5068 13,826 135 10 5 15 8 1554.5 287.6 1.842.1 +50% 0% 13,839 7602 20,739 197 15 8 23 10 2163.0 400.1 2563.1A System for Supporting Supplier and Cold Storage Selection in the Fresh Fruit... 199
-50% Demand +50% Demand 
mrettrohsninoitairaV 
Cold Chambers Cold Chambers 
1 2 3 4 5 6 7 8 9 10 1 2 3 4 5 6 7 8 9 10 
CSF 
1 568 910 1,672 1,140 
CSF 
1 570 908 1.672 1.140 
2 1,720 1,520 1,700 2 1,520 1,520 1,900 
3 760 760 760 760 380 3 760 760 760 760 380 
4 285 340 570 570 4 285 456 454 570 
5 760 760 760 750 5 758 758 759 755 
6 543 6 543 
7 950 1,450 684 7 948 1,450 713 
8 760 760 950 8 760 760 950 
9 570 587 570 565 9 1,500 1,500 700 1,500 1,498 
mretmuidemninoitair aV 
Cold Chambers Cold Chambers 
1 2 3 4 5 6 7 8 9 10 1 2 3 4 5 6 7 8 9 10 
CSF 
1 560 980 1.600 1.150 
CSF 
1 550 928 1,672 1,140 
2 1,520 1,520 1,900 2 1,520 1,520 1,900 
3 760 760 760 760 380 3 760 760 760 760 380 
4 320 456 454 535 4 285 456 524 500 
5 760 760 760 750 5 760 760 760 750 
6 600 6 590 
7 475 725 342 7 1,400 1,400 1,400 420 
8 380 380 475 8 1,140 1,140 1,425 
9 1,100 1,214 1,139 1,129 9 1,000 1,000 314 1,139 1,129 
mretgnolninoit airaV 
Cold Chambers Cold Chambers 
1 2 3 4 5 6 7 8 9 10 1 2 3 4 5 6 7 8 9 10 
CSF 
1 275 464 836 570 
CSF 
1 825 1,392 2,508 1,710 
2 760 760 950 2 2,280 2,280 2,850 
3 380 380 380 380 190 3 1,140 1,140 1,140 1,140 570 
4 143 228 227 285 4 428 684 681 855 
5 379 379 380 378 5 1,137 1,137 1,139 1,133 
6 272 6 815 
7 930 1,350 670 7 800 1.400 750 
8 760 760 950 8 760 760 950 
9 1,140 1,022 1,139 1,129 9 1,123 1,022 1,300 990 
CA SF CR 
Fig. 10 Storage plan with different demand percentage variations 
In Table 6, it is possible to observe that the number of producers where the fruit is 
bought changes in each scenario. Comparing the demand for short-term fruit, there 
is an increase from 125 to 145 producers when the demand varies from a decrease 
of 50% to an increase to 50%. When the demand for medium-term fruit varies in 
these same proportions, there is an increase of 128 to 143 producers. Finally, when 
the demand for long-term fruit varies in the aforementioned proportion, there is an 
increase from 115 to 148 producers. 
Analyzing the behavior of the total costs presented in Table 5, it is possible to 
observe that they are not linear. For example, when the short-term fruit demand200 W. E. Soto-Silva et al. Table 6 Purchase and storage plan for each scenario compared to the base scenario Variation Purchase (tonnes) No. cold chambers Cost (M US $) Demand Prices Short Medium Long No. suppliers CR SF CA No. CSF Purchase Storage Total cost 0% 0% 9226 5068 13,826 135 10 5 15 8 1554.5 287.6 1842.1 −50% 0% 4613 2534 6913 68 5 3 8 4 792.5 146.6 939.1 Short term 4580 5068 13,516 125 5 5 15 8 1280.5 236.9 1517.4 Medium term 9226 2113 13,826 128 10 3 15 7 1391.1 257.3 1648.5 Long term 9578 5689 7001 115 10 5 8 8 1230.9 227.7 1458.7 +50% 0% 13,839 7602 20,739 197 15 8 23 10 2162.9 400.1 2563.1 Short term 13,329 5262 13,543 145 15 5 15 9 1776.3 328.6 2105.1 Medium term 8997 7654 14,323 143 10 8 15 8 1712.2 316.8 2029.2 Long term 9125 5187 21,339 148 10 5 23 11 1970.8 364.6 2335.4A System for Supporting Supplier and Cold Storage Selection in the Fresh Fruit... 201
increases by 50%, the total cost is $2,105,068. However, when the medium-term 
fruit demand increases by 50%, the total cost is $2,029,078, which is less than 
that obtained for the short-term fruit. For this reason, a FruitPS-DSS is useful 
for supporting the related decisions. Without this tool, an agricultural manager 
might purchase more expensive fruit and rent cold chambers with more expensive 
refrigeration technology, augmenting the total costs. 
The average of the FruitPS-DSS computational times for each scenario presented 
in Table 6 was 1890 s. This time is reasonable considering that a purchase and 
storage tactical plan for all the processing period (9 months) is proposed. The 
averages of computational times for the analysis when the demand decreases 
and increases 50% (scenarios considered in Fig. 10) were 1344 s and 2374 s, 
respectively. 
9 Report from the FruitPS-DSS Using Data from the Case 
Study 
The report obtained by the DSS for the fresh fruit purchase plan of each fresh fruit 
variety and segregation term is presented in Fig. 11. This report is generated and 
delivered by the FruitPS-DSS in pdf format for inspection by users. The report 
format shown in Fig. 11 was designed jointly by the team members with the 
representatives of the operations and quality departments considering the required 
information and previous company reports. 
The demand of the processing plant for the whole season was 74,000 bins 
considering both fruit variety and quality (type of segregation). The FruitPS-DSS 
offers a detailed report with the number of bins to be purchased from each producer 
according to their available varieties. A summary of this report is provided in Table 
7. 
Regarding the plan for fresh fruit storage, Table 8 shows the cold storage plan 
proposed by the FruitPS-DSS according to the fruit variety. 
In Table 8, it is possible to observe that one available storage chamber stays 
empty (cold storage 9); this probably occurs because storage 9 is located very far 
from the processing plant (130 kilometers). Additionally, some cold storages only 
receive one kind of fruit variety, such as storages 1, 3, 5, and 11. This can happen 
because they have only one type of refrigeration technology. 
As can be seen in Table 9, a cold storage facility can store more than one type of 
fruit segregation because it has chambers with different refrigeration technologies. 
It is important to highlight that every chamber can only store one kind of fruit 
variety because each variety has different respiration rates. So, if they are mixed, 
their shelf life can be reduced or the quality deteriorated. Table 8 shows the detailed 
cold storage plan obtained by the FruitPS-DSS. 
As shown in Table 9, the cold storage plan depends on the purchased fruit quality, 
the availability of cold storage facilities, and the associated refrigeration technology.202 W. E. Soto-Silva et al.
System Report Date: 28/08/2018 
Page: 1/1 Fresh Fruit Purchase Plan 
Company Data 
Company Data Planta Agroindustrial Ltda. 
Department Departamento de Abastecimiento 
User Nombre Apellido 
Purchased bins according to the type of segregation 
Apple variety Long term Medium term Short term Total (bins) 
Royal Gala 5,393 3,488 3,119 12,000 
Granny Smith 11,139 8,119 14,742 34,000 
Fuji 11,761 3,994 6,245 22,000 
Braeburn 3,000 - - 3,000 
Pink Lady 2,000 - - 2,000 
Rojas 1,000 - - 1,000 
Total (bins) 34,293 11,501 24,106 74,000 
Observations: 
Fig. 11 Fresh fruit purchase plan obtained by the FruitPS-DSSA System for Supporting Supplier and Cold Storage Selection in the Fresh Fruit... 203
Table 7 Summary of the fresh fruit purchase plan obtained by the FruitPS-DSS 
Purchase Bins of apple variety Total (bins) 
ID suppliers Royal Gala Granny Smith Fuji Brearburn Pink Lady Red 
2 – 168 144 – – – 312 
4 88 84 121 – – – 293 
8 – 66 – – – – 66 
. . . . . . . . 
. . . . . . . . 
276 – – 169 – – – 169 
277 – 37 – – – – 37 
279 – 85 95 – – – 180 
Total (bins) 12,000 34,000 22,000 3000 2000 1000 74,000 
Table 8 Cold storage plan obtained by the FruitPS-DSS 
Bins destined to each CSF Total (bins) 
Apple variety 1 2 3 4 5 6 7 8 9 10 11 
Royal Gala 119 5393 – – 988 3000 – 2500 – – – 12,000 
Granny Smith – – 12,119 2000 – 14,742 1200 – – 3939 – 34,000 
Fuji – 5900 – 3165 – 6245 2696 3994 – – – 22,000 
Brearburn – – – – – – – – – 3000 – 3000 
Pink Lady – – – 2000 – – – – – – – 2000 
Red – – – – – – 750 – – – 250 1000 
Total (bins) 119 11,293 12,119 7165 988 23,987 4646 6494 – 6939 250 74,000 
Table 9 Detailed cold storage plan 
Bins assigned to each cold chamber Total (bins) 
CSF 1 2 3 4 5 6 7 8 9 10 
1 (CR) 119 – – – – – – – – – 119 
2 (AC) 1500 2400 4400 2993 – – – – – – 11,293 
3 (AC) 4000 3119 5000 – – – – – – – 12,119 
4 (AC) 1999 2000 1166 2000 – – – – – – 7165 
5 (SF) – – – 988 – – – – – – 988 
6 (CR) 2782 3000 – 2990 3000 3000 2994 333 2976 2912 23,987 
7 (AC) 750 1200 1196 1500 – – – – – – 4646 
8 (SF) 1994 2000 2500 – – – – – – – 6494 
9 (AC) – – – – – – – – – – – 
10 (AC) 1014 2000 1939 1986 – – – – – – 6939 
11 (AC) 250 – – – – – – – – – 250 
Total bins 14,408 15,719 16,201 12,457 3000 3000 2994 333 2976 2912 74,000204 W. E. Soto-Silva et al.
10 Feedback from Chilean Agri-industrial Companies 
The general manager and the operations manager of the company evaluated 
the FruitPS-DSS. After using the FruitPS-DSS for 20 days, they considered the 
proposed tactical plans (purchase and cold storage plans) relevant and appreciated 
that they were obtained quickly since they usually spend almost 3 weeks finishing 
them each season. In addition, they valued that it was possible to make plans 
according to different scenarios so that the DSS could be used at different times 
of the year for anticipating decisions. They also concluded that the developed 
DSS is a useful decision-making tool for purchasing and choosing cold storage. 
It has a user-friendly interface that provides all the required reports for supporting 
these decisions. This information was obtained through interviews with different 
stakeholders such as the operations manager and the quality and operations depart￾ment representatives once all the sprints were finished. During these interviews, 
each stakeholder highlighted that the data was stored in different Excel files before 
the FruitPS-DSS development. They were dissatisfied with this situation since the 
information takes a long time to retrieve. This kind of data storage was risky because 
sometimes the files were damaged, losing all the information. Moreover, it was 
inefficient due to the difficulty in analyzing the information stored on different 
personal computers, especially when analyzing data from several seasons. 
A detected obstacle by stakeholders is that it is necessary to collect all the 
required data before a production season in order to obtain the tactical plan. 
Nonetheless, sometimes it is not possible to do this because of unforeseen situations, 
such as climate changes, delays in the lease of cold storage facilities, and uncertainty 
about the available truck fleet during the production season, among others. 
11 Conclusions and Future Research 
The FruitPS-DSS contributes by supporting complex decisions currently made 
based on the experience of agri-industrial professionals. This DSS was deployed 
and validated according to the experience of three operational managers who are 
in charge of the fruit purchase and storage processes of their companies. These 
professionals agreed that the DSS is a useful tool for supporting the decision-making 
process by providing tactical plans in an easy and fast way. It replaces the current 
spreadsheets used to manually plan purchases and storage. 
Developing a DSS for planning the processing season could serve as a database 
for all the necessary data for management and control, allowing any user to make 
decisions in a quick, flexible, and simple way. 
For the case study, it was estimated that the use of the FruitPS-DSS reduced 
the purchase, storage, and transportation costs around 10%. During a processing 
season, this amount corresponds to a savings of approximately US $50,000, which 
were estimated comparing the real operational results with those obtained by theA System for Supporting Supplier and Cold Storage Selection in the Fresh Fruit... 205
FruitPS-DSS. In addition, the decision-makers indicated that the proposed FruitPS￾DSS could facilitate different activities such as ordering and handling information; 
improving the decision-making process for purchasing, transporting, and storing 
fresh fruit; adding greater speed and accuracy to the process, among others. Thus, 
a better coordination of these activities would allow obtaining better quality fruit, 
increasing the conversion rate to dehydrated products, and, therefore, involving a 
growth in product revenue and a reduction of fruit losses. 
For future research, the incorporation of uncertainty in the parameters of the 
implemented optimization model, such as fruit demand, supply, and/or prices, could 
be addressed through multistage stochastic programming or robust optimization. 
Moreover, due to the computational complexity for solving these approaches, 
metaheuristic solution methods could be analyzed. Finally, a future extension of 
the FruitPS-DSS could be the integration of other optimization models related to 
plan cold chambers opening and closing during a processing season. 
Acknowledgments Marcela C. González-Araya would like to thank FONDECYT Project 
1191764 (Chile), and Wladimir E. Soto-Silva would like to thank CONICYT MEC Project 
MEC80180022 (Chile) for their financial support. 
Appendix 1 
MILP model proposed by Soto-Silva et al. (2017). 
Parameters 
CCpqt: Purchase cost for producer p of the fruit type q with storage time t 
(US$/tonnes) 
Opqt: Fruit supply from producer p of type q with storage time t (tonnes), where 
1 = long term, 2 = medium term, 3 = short term 
CTp: Transport cost from producer p to the plant by tonnes of fruit (US$/tonnes) 
CFTl: Fixed cost of transport using truck type l 
CAp: Administration cost for producer p 
M: Big M 
Dqt: Demand for fruit type q with storage time t (tonnes) 
QMl: Maximum load for truck type l (tonnes) 
CTqtc: Cost of transport from the plant for fruit type q with storage time t destined 
for warehouse c (US$/tonnes) 
CEcn: Cost of keeping the fruit in warehouse c, in cold chamber n (US$/tonnes) 
CAc: Fixed cost for warehouse c 
CFcn: Fixed cost of chamber n in warehouse c 
CFTl: Fixed cost of transport using truck type l 
qtyc: Number of available warehouses 
Wcn: Storage capacity of cold chamber n in warehouse c (tonnes) 
QMl: Maximum load of truck type l (tonnes)206 W. E. Soto-Silva et al.
TEcn: Type of refrigeration technology in cold chamber n in warehouse c 
(1 = long term, 2 = medium term, 3 = short term) 
Dqt: Quantity of fruit to store of type q with storage time t (tonnes) 
Decision Variables 
Wpqtl: Tonnes of fruit to buy from producer p, of type q, with storage time t 
transported by truck type l 
Slpq: Quantity of trips for truck type l, from producer p, with fruit type q 
Xpqt: Binary variable with the value 1 if fruit is purchased from producer p, of 
type q and storage time t, and otherwise the value is 0 
Cp: Binary variable with the value 1 if the fruit is purchased from producer p and 
0 if not 
Zqtcnl: Tonnes of fruit type q with storage time t in warehouse c in cold chamber 
n transported in truck type l 
Ylcn: Number of trips by truck type l to warehouse c to cold chamber n 
Ac: Binary variable with value 1 if warehouse c is used and 0 if not 
MEcnqt:Binary variable with value 1 if fruit type q with storage time t is kept in 
warehouse c in chamber n 
Mathematical Model 
Minimize E
peP
E
qeQ
E
teT
CCpqtXpqtOpqt + E
peP
E
qeQ
E
teT
CT pXpqtOpqt
+ E
peP
CApCp + E
l ε L
E
p ε P
E
q ε Q
CFT l Slpq
+ E
qeQ
E
teT
E
ceC
E
neN
E
leL
(
CT qtc + CEcn) Zqtcnl
+ E
ceC
CAc Ac + E
ceC
E
neN
E
qeQ
E
teT
CFcn MEcnqt + E
leL
E
ceC
E
neN
CFT l Ylcn
(1) 
Subject to: 
E
qeQ
E
teT
Xpqt ≤ MCp∀peP (2) 
E
peP
E
teT
E
leL
Wpqtl ≥ E
teT
Dqt∀qeQ (3) 
E
leL
Wpqtl ≤ Xpqt Opqt ∀q e Q, p e P , t e T (4)A System for Supporting Supplier and Cold Storage Selection in the Fresh Fruit... 207
E
teT
Wpqtl ≤ QMl Slpq ∀q e Q, l e L, p e P (5) 
E
teT
E
q∈Q
MEcnqt ≤ 1 ∀c e C, n e N (6) 
E
leL
Zqtcnl ≤ WcnMEcnqt ∀c e C, n eN,t e T (7) 
E
ceC
E
neN
E
leL
Zqtcnl = E
peP
E
leL
Wpqtl ∀q e Q, t e T (8) 
E
neN
E
q∈Q
E
t∈T
MEcnqt ≤ qtyc Ac ∀ceC (9) 
MEcnqt = 0 ∀c e C, n e N , q e Q, t e T : t <TEcn (10) 
E
qeQ
E
teT
Zqtcnl ≤ QMl Ylcn ∀l e L, c e C, n e N (11) 
Ylcn, Slpq e Z+ ∀l e L, c e C, n e N, p e P , q e Q
(12) 
Ac,MEcnqt, Xpqt, Cp e {0, 1} ∀c e C, n e N , p e P , q e Q, t e T
(13) 
Zqtcnl, Wpqtl ≥ 0 ∀p e P , q e Q, t e T , c e C, n e N , l e L
(14) 
The objective function (1) seeks to minimize all the costs derived from the fruit 
purchase, transport, production process, and cold storage activities needed for the 
plant operation. Constraint (2) establishes that if any fruit variety is bought from a 
producer, all the producer’s fruit supply must be bought. Constraint (3) indicates 
that the quantity of fruit to buy of a specific type and specific storage time must 
meet the processing plant’s demand. Constraint (4) shows that the quantity of fruit 
to buy will be less than the supply that is available from the producers. Constraint 
(5) allows determining the number of total trips to be made per truck during the 
purchase season. Constraint (6) establishes that only one type of fruit can be stored 
in each cold chamber. Constraint (7) makes the amount of fruit to be stored in each 
of the cold chambers in the warehouses subject to the choice of chamber and its 
storage capacity. Constraint (8) permits joining the purchase and storage together208 W. E. Soto-Silva et al.
given that the fresh produce purchased is equal to the fresh produce to be stored in 
the cold chambers. The other constraints for this model correspond to the constraints 
given in the purchasing and storing models. Constraint (9) shows the activation of 
a cold chamber within a warehouse in order to store fruit only if the warehouse is 
active. Constraint (10) ensures that fruit is not stored in a cold chamber if it has a 
length of storage time lower than the chamber’s refrigeration technology allowing 
it to stock. Constraint (11) limits the maximum number of trips per truck at full 
capacity according to truck type and the amount of fruit to buy from the producers. 
Constraints (12), (13), and (14) correspond to the integrality and non-negativity 
constraints on the decision variables, respectively. 
Appendix 2 
Table 10 presents different scenarios for fruit demand and price. In each scenario, 
the percentage variation for every fruit segregations (short, medium, or long term) is 
the same. The obtained results show that the number of selected producers and cold 
storage facilities does not have the same percentage variation than the fruit demand 
and price. Consequently, the total cost also varies in a different percentage.A System for Supporting Supplier and Cold Storage Selection in the Fresh Fruit... 209 Table 10 Purchase and storage plan for each scenario Variation Purchase (tonnes) No. cold chambers Cost (M US $) Demand Prices Short Medium Long No. suppliers CR SF CA No. CSF Purchase Storage Total cost 
−50%
−50% 4650 2354 7056 75 6 3 8 4 387.8 71.8 459.5 
−50%
−25% 4648 2543 6869 72 5 3 8 4 594.4 109.9 704.3 
−50% 0% 4613 2534 6913 68 5 3 8 4 792.5 146.6 939.1 
−50%
+25% 4600 2567 6893 68 5 3 8 3 990.7 183.3 1173.9 
−50%
+50% 4598 2601 6861 67 5 3 8 3 1188.8 219.9 1408.7 
−25%
−50% 6987 3813 10, 290 106 8 5 11 6 540.7 100.1 640.7 
−25%
−25% 6924 3810 10, 356 104 8 4 11 6 811.1 150.1 961.1 
−25% 0% 6920 3801 10, 370 100 8 4 11 5 1081.4 200.1 1281.5 
−25%
+25% 6923 3799 10, 368 100 8 4 11 5 1351.8 250.1 1601.9 
−25%
+50% 6918 3780 10, 392 101 8 4 10 5 1622.2 300.1 1922.3 
0%
−50% 9234 5070 13, 816 139 10 5 15 8 777.2 143.8 921.1 
0%
−25% 9230 5070 13, 820 134 10 6 15 8 1165.9 215.7 1381.5 
0% 0% 9226 5068 13, 826 135 10 5 15 8 1554.5 287.6 1.842.1 
0%
+25% 9225 5045 13, 850 132 10 6 15 7 1943.1 359.5 2302.6 
0%
+50% 9220 5001 13, 899 129 9 5 16 7 2331.7 431.4 2763.1 
+25%
−50% 11, 550 6350 17, 250 175 13 6 19 9 887.2 164.1 1051.3 
+25%
−25% 11, 545 6342 17, 263 172 14 6 19 9 1330.8 246.2 1576.9 
+25% 0% 11, 533 6335 17, 283 169 13 6 19 9 1774.3 328.2 2102.6 
+25%
+25% 11, 530 6332 17, 288 164 13 6 19 8 2218.0 410.3 2628.2 
+25%
+50% 11, 528 6329 17, 293 161 13 6 20 8 2661.5 492.4 3153.9 
+50%
−50% 13, 901 7623 20, 656 208 15 8 23 11 952.4 176.2 1128.5 
+50%
−25% 13, 855 7614 20, 711 199 15 8 23 11 1622.2 300.1 1922.3 
+50% 0% 13, 839 7602 20, 739 197 15 8 23 10 2163.0 400.1 2563.1 
+50%
+25% 13, 840 7600 20, 740 196 15 8 24 10 2703.7 500.2 3203.9 
+50%
+50% 13, 832 7598 20, 750 192 14 8 24 10 3244.5 600.2 3844.7210 W. E. Soto-Silva et al.
References 
Bonfante, A., Monaco, E., Manna, P., De Mascellis, R., Basile, A., Buonanno, M., Cantilena, G., 
Esposito, A., Tedeschi, A., & De Michele, C. (2019). LCIS DSS—An irrigation supporting 
system for water use efficiency improvement in precision agriculture: A maize case study. 
Agricultural Systems, 176, 102646. 
Cañadas, J., Sánchez-Molina, J. A., Rodríguez, F., & del Águila, I. M. (2017). Improving automatic 
climate control with decision support techniques to minimize disease effects in greenhouse 
tomatoes. Information Processing in Agriculture, 4, 50–63. 
Corbari, C., Salerno, R., Ceppi, A., Telesca, V., & Mancini, M. (2019). Smart irrigation forecast 
using satellite LANDSAT data and meteo-hydrological modeling. Agricultural Water Manage￾ment, 212, 283–294. 
Dionysis, D., Bochtis, C., Claus, G., Sørensen, B., & Green, O. (2012). A DSS for planning of 
soil-sensitive field operations. Decision Support Systems, 53, 66–75. 
Elsheikh, R., Rashid, A., Shariff, M., Amiri, F., Noordin, B., Balasundram, S., & Soom, M. 
(2013). Agriculture Land Suitability Evaluator (ALSE): A decision and planning support tool 
for tropical and subtropical crops. Computers and Electronics in Agriculture, 93, 98–110. 
Fountas, S., Carli, G., Sørensen, C., Tsiropoulos, Z., Cavalaris, D., Vatsanidou, B., Liakos, B., 
Canavari, M., Wiebensohn, J., & Tisserye, B. (2015). Farm management information systems: 
Current situation and future perspectives. Computers and Electronics in Agriculture, 115, 40– 
50. 
Gallardo, M., Elia, A., & Thompson, R. B. (2020). Decision support systems and models for aiding 
irrigation and nutrient management of vegetable crops. Agricultural Water Management, 240, 
106209. 
Jain, R., & Raju, S. (2016). In R. Jain & S. S. Raju (Eds.), Decision support system in agriculture 
using quantitative analysis. Agrotech Publishing Academy. 
Kerselaers, E., Rogge, E., Lauwers, L., & Van Huylenbroeck, G. (2015). Decision support for 
prioritising of land to be preserved for agriculture: Can participatory tool development help? 
Computers and Electronics in Agriculture, 110, 208–220. 
Khan, R., Zakarya, M., Balasubramanian, V. M., Jan, A., & Menon, V. G. (2021). Smart sensing￾enabled decision support system for water scheduling in Orange Orchard. IEEE Sensors 
Journal, 21(16), 17492–17499. 
Lasso, E., Valencia, O., Corrales, D. C., López, I. D., Figueroa, A., & Corrales, J. C. (2018). 
A cloud-based platform for decision making support in Colombian agriculture: A study case 
in coffee rust. In P. Angelov, J. Iglesias, & J. Corrales (Eds.), Advances in Information and 
Communication Technologies for Adapting Agriculture to Climate Change. AACC’17 2017. 
Advances in Intelligent Systems and Computing (Vol. 687). Springer. 
Lonchamp, J. (2005). Open source software development process modelling. Software process 
modelling (pp. 1–35). Springer. 
López-Milán, E., & Plà-Aragonés, L. (2014). A decision support system to manage the supply 
chain of sugar cane. Annals of Operations Research, 219, 285–297. 
Manna, P., Bonfante, A., Colandrea, M., Di Vaio, C., Langella, G., Marotta, L., Mileti, F., Minieri, 
L., Terribile, F., Vingiani, S., & Basile, A. (2020). A geospatial decision support system to assist 
olive growing at the landscape scale. Computers and Electronics in Agriculture, 168, 105143. 
Mannini, P., Genovesi, R., & Letterio, T. (2013). TIRRINET: large scale DSS application for on￾farm irrigation scheduling. Procedia Environmental Sciences, 19, 823–829. 
McCown, R. (2012). A cognitive systems framework to inform delivery of analytic support for 
farmers’ intuitive management under seasonal climatic variability. Agricultural Systems, 105, 
7–20. 
Mir, S., & Quadri, S. (2009). Decision support systems: Concepts, progress and issues – A 
review. In E. Lichtfouse (Ed.), Climate change, intercropping, pest control and beneficial 373 
microorganisms, sustainable agriculture reviews (Vol. 2). Springer Science Business Media 
B.V..A System for Supporting Supplier and Cold Storage Selection in the Fresh Fruit... 211
Monardes-Concha, C., Serrano-Julio, C., & Hoffmann, C. (2020). Linear programming based 
decision support system for grapes transport planning in CAPEL. International Transactions 
in Operational Research, 1–27. 
Navarro-Hellín, H., Martínez-del-Rincón, J., Domingo-Miguel, R., Soto-Valles, F., & Torres￾Sánchez, R. (2016). Original papers: A decision support system for managing irrigation in 
agriculture. Computers and Electronics in Agriculture, 124, 121–131. 
Paam, P., Berretta, R., Heydar, M., & Garcia-Flores, R. (2019). The impact of inventory 
management on economic and environmental sustainability in the apple industry. Computers 
and Electronics in Agriculture, 163, 104848. 
Papadopoulos, A., Kalivas, D., & Hatzichristos, T. (2011). Decision support system for nitrogen 
fertilization using fuzzy theory. Computers and Electronics in Agriculture, 78, 130–139. 
Pavana, W., Fraisse, C., & Peres, N. (2011). Development of a web-based disease forecasting 
system for strawberries. Computers and Electronics in Agriculture, 75, 169–175. 
Perondi, D., Fraisse, C., Staub, C., Cerbaro, V., Barreto, D., & Pequeno, D. (2019). Crop season 
planning tool: Adjusting sowing decisions to reduce the risk of extreme weather events. 
Computers and Electronics in Agriculture, 156, 62–70. 
Recio, B., Rubio, F., & Criado, J. A. (2003). A decision support system for farm planning using 
AgriSupport II. Decision Support Systems, 36, 189–203. 
Rowshon, M. K., Dlamini, N. S., Mojid, M. A., Adib, M. N. M., Amin, M. S. M., & Lai, S. H. 
(2019). Modeling climate-smart decision support system (CSDSS) for analyzing water demand 
of a large-scale rice irrigation scheme. Agricultural Water Management, 216, 138–152. 
Rupnik, R., Kukar, M., Vracar, P., Košir, D., Pevec, D., & Bosni ˇ c, Z. (2018). AgroDSS: A decision ´
support system for agriculture and farming. Computers and Electronics in Agriculture, 16, 
260–271. 
Sánchez-Cohen, I., Díaz-Padilla, G., Velásquez-Valle, M., Slack, D., Heilman, P., & Pedroza￾Sandoval, A. (2005). A decision support system for rainfed agricultural areas of Mexico. 
Computers and Electronics in Agriculture, 114, 178–188. 
Small, I. M., Joseph, L., & Fry, W. E. (2015). Development and implementation of the BlightPro 
decision support system for potato and tomato late blight management. Computers and 
Electronics in Agriculture, 115, 57–65. 
Soto-Silva, W., González-Araya, M., Plà-Aragonés, L. M., & Nadal-Roig, E. (2016). Transport 
planning in processing plants for the fruit industry. In Proceedings of 5th the International 
Conference on Operations Research and Enterprise Systems (ICORES 2016) (pp. 71–78). 
Soto-Silva, W. E., González-Araya, M. C., Oliva-Fernández, M., & Pla-Aragones, L. (2017). 
Optimizing fresh food logistics for processing: application for a large Chilean apple supply 
chain. Computers and Electronics in Agriculture, 136, 42–57. 
Tanuja, R., Patil, S., Shamshuddin, K., Rajashekhar, P., & Sadanand, P. (2016). Krushi Samriddhi: 
a decision support system for farmers to get high crop yield. In International Conference on 
Computational Techniques in Information and Communication Technologies. 
Terribile, F., Bonfante, A., D’Antonio, A., De Mascellis, R., De Michele, C., Langella, G., Manna, 
P., Mileti, F. A., Vingiani, S., & Basile, A. (2017). A geospatial decision support system for 
supporting quality viticulture at the landscape scale. Computers and Electronics in Agriculture, 
140, 88–102. 
Turban, E., & Aronson, J. (2000). Decision support systems and intelligent systems (6th ed.). 
Prentice Hall. 
van der Vorst, G. A. J., da Silva, C. A., & Trienekens, J. H. (2007). Agro-industrial supply chain 
management: Concepts and applications. Food and Agriculture Organization of the United 
Nations. 
Visconti, F., De Paz, J. M., Rubio, J. L., & Sánchez, J. (2011). SALTIRSOIL: a simulation model 
for the mid to long-term prediction of soil salinity in irrigated agriculture. Soil Use Manage, 
27, 523–537. 
Visconti, P., de Fazio, R., Velázquez, R., Del-Valle-Soto, C., & Giannoccaro, N. (2020). Develop￾ment of sensors-based agri-food traceability system remotely managed by a software platform 
for optimized farm management. Sensors, 20(13), 3632.212 W. E. Soto-Silva et al.
Vishwajith, K. P., Sahu, P. K., Dhekale, B. S., Mishra, P., & Chellai, F. (2020). Decision support 
system (dss) on pulses in India. Legume Research - An International Journal, 43, 530–538. 
Weisong, W., Shaoqi, G., Xuejie, Z., Kanianska, R., & Jianying, F. (2019). WebGIS-based 
suitability evaluation system for Chinese table grape production. Computers and Electronics 
in Agriculture, 165, 104945.
