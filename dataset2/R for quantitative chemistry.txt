R for Quantitative
Chemistry
R for Quantitative Chemistry is an exploration of how the R language can be
applied to a wide variety of problems in what is typically termed “Quantita￾tive Chemistry” or sometimes “Analytical Chemistry”. Topics include: basic
statistics, spectroscopic data, acid base equilibria and titrations, binding curves
(of great current interest for biomedical applications), Fourier Transforms, and
chemical kinetics and enzyme kinetics. An innovative feature is the discussion
(as an alternative to the less stable nls packages) of the simplex adaptation sub￾plex (R package) coupled with Monte Carlo analysis to determine confidence
intervals for estimated parameters resulting from least squares optimization.
Chemists who are interested in learning R as a research tool as well as chemists
who are teaching quantitative chemistry, as well as their students will be inter￾ested. As most R books approach data analysis from an economic, social,
medical, or biological context. Analysis of chemical data draws upon specific
numerical models and a different set R programming and packages than is typi￾cally discussed in other disciplines. This book will be based upon, in large part,
actual experimental data and will include end of chapter questions and projects.
Readers are encouraged to email the author at gosserch@gmail.com and to
follow the accompanying blog on Medium “R Programming for Quantitative
Chemistry”.
Key Features:
• Elements of R programming for Chemists
• Literature-based examples
• Includes binding assay analysis
• Integrates theory, experiment, and R programming
Dr. David K. Gosser Jr. is Professor of Chemistry at City College of New
York, CUNY. Dr. Gosser received his Ph.D. in Physical Inorganic Chemistry
from Brown University.R for Quantitative
Chemistry
David K. Gosser Jr.First edition published 2024
by CRC Press
6000 Broken Sound Parkway NW, Suite 300, Boca Raton, FL 33487-2742
and by CRC Press
4 Park Square, Milton Park, Abingdon, Oxon, OX14 4RN
CRC Press is an imprint of Taylor & Francis Group, LLC
© 2024 David K. Gosser Jr.
Reasonable efforts have been made to publish reliable data and information, but the author and pub￾lisher cannot assume responsibility for the validity of all materials or the consequences of their use.
The authors and publishers have attempted to trace the copyright holders of all material reproduced
in this publication and apologize to copyright holders if permission to publish in this form has not
been obtained. If any copyright material has not been acknowledged please write and let us know so
we may rectify in any future reprint.
Except as permitted under U.S. Copyright Law, no part of this book may be reprinted, reproduced,
transmitted, or utilized in any form by any electronic, mechanical, or other means, now known
or hereafter invented, including photocopying, microfilming, and recording, or in any information
storage or retrieval system, without written permission from the publishers.
For permission to photocopy or use material electronically from this work, access www.copyright.com
or contact the Copyright Clearance Center, Inc. (CCC), 222 Rosewood Drive, Danvers, MA 01923,
978-750-8400. For works that are not available on CCC please contact mpkbookspermissions@tandf.
co.uk
Trademark notice: Product or corporate names may be trademarks or registered trademarks and are
used only for identification and explanation without intent to infringe.
Library of Congress Cataloging-in-Publication Data
Names: Gosser, David K., author.
Title: R for quantitative chemistry / David Gosser.
Description: First edition. | Boca Raton : CRC Press, 2024. |
Includes bibliographical references.
Identifiers: LCCN 2023005880 (print) | LCCN 2023005881 (ebook) |
ISBN 9781032414799 (hardback) | ISBN 9781032415475 (paperback) |
ISBN 9781003358640 (ebook)
Subjects: LCSH: Analytical chemistry—Quantitative—Data processing. |
R (Computer program language)
Classification: LCC QD101.2 .G68 2024 (print) | LCC QD101.2 (ebook) |
DDC 543.0285/5133—dc23/eng/20230531
LC record available at https://lccn.loc.gov/2023005880
LC ebook record available at https://lccn.loc.gov/2023005881
ISBN: 9781032414799 (hbk)
ISBN: 9781032415475 (pbk)
ISBN: 9781003358640 (ebk)
DOI: 10.1201/9781003358640
Typeset in Times
by codeMantraContents
Preface ix
Author xi
1 Intro to R 1
1.1 R in RStudio Cloud 1
1.2 Vectors and Numerics 2
1.3 Functions 8
1.4 Reading and Writing Data Files 8
1.5 Control Structures: For Loop 10
1.6 Packages 11
1.7 Questions and Projects 11
References 12
2 Data and Statistics 13
2.1 Comparing Two Sets of Data: The t Test 19
2.2 Questions and Projects 21
References 21
3 Beer’s Law and Linear Regression 23
3.1 Linear Regression 24
3.2 Residual Plots 28
3.3 Method Validation 33
3.4 Questions and Projects 33
References 33
4 Solving Equilibrium 35
4.1 Systematic Treatment of Equilibrium 35
4.2 pH of Hydrofluoric Acid 35
4.3 Solving over a Series of Ka Values with a for Loop 39
4.4 Carbon Dioxide and Acidification 41
4.5 Visualizing Root Finding 46
4.6 Questions and Projects 47
vvi Contents
5 Titrations 49
5.1 The Approximate View 49
5.1.1 Initial H 49
5.1.2 The Buffer Region 50
5.1.3 Endpoint 51
5.2 An Exact Solution 52
5.3 Root Finding: pH as Function of Volume 56
5.4 Using Sapply with Uniroot to Solve for Titration Curve 57
5.5 Effect of Ionic Strength/Activity Coefficients 61
5.5.1 Ionic Strengths and Activity 61
5.6 Project 62
Reference 62
6 Binding Curves 63
6.1 Myoglobin Binding 64
6.2 L not in Excess 67
6.3 Acid/Base Binding Curve 67
6.4 Exploration of Diprotic Titrations 72
6.4.1 Preparation of Experimental Data 72
6.5 Projects 78
References 78
7 Electrochemistry 79
7.1 Biochemists Potential 79
7.2 Ascorbic Acid 79
7.3 Questions and Projects 81
References 82
8 Fourier Transform and Spectroscopy 83
8.1 Audio Analogy 83
8.2 Questions for Discussion 86
8.3 The Fourier Transform 87
8.4 Questions: Orthogonality 88
8.5 FT and Signal Averaging 93
9 R Kinetic Analysis 95
9.1 First Order Kinetics 95
9.2 Optimization Methods: First Order Reaction 96
9.3 Monte Carlo 99
9.4 Solving Differential Equations with Desolv Package 102
9.5 Enzyme Kinetics 103Contents vii
9.6 Project 104
Reference 104
10 Reports in R Markdown 105
10.1 Basic Formatting 106
10.2 Embedding R Code in R Markdown 107
Index 109Preface
This book originated from an effort to integrate programming into the teaching
of Quantitative Chemistry (or Quantitative Chemical Analysis) at the City Col￾lege of New York. In choosing a language, I found in R the following desirable
qualities for teaching:
1. A comprehensive online platform in R Studio Cloud (now rebranded
as Posit)
2. Easy to get up & running.
3. Quality graphics
4. Wide range of statistical packages.
5. Commonly used in scientific research
6. Vibrant online community
Each chapter introduces one or more problems that can be solved in R and
includes a suggested project (typically involving student-collected or literature
data) through which the student can deepen their understanding of analytical
chemistry and practice new R skills.
I would like to acknowledge the helpful feedback from my students in
Chemistry 243 at City College, and especially Aleksandr Knyazev, who for￾matted this book in latex and contributed the automated R program to perform
Monte Carlo analysis with the subplex package.
ixAuthor
My original training in programming traces back to FORTRAN and punchcards
& Mainframe at Brown University, where I completed a PhD in Chemistry &
developed a simulation program to analyze electrochemical experiments, soon
ported to PC with the lovely Turbo Pascal (now still available using FreePascal).
xiIntro to R 1
Every programming language has similar elements. We need to input data,
identify variables, perform calculations, create functions, control program flow,
and output data and graphics. The R language is attractive in that it has a full
online development environment -RStudio Cloud (https://rstudio.cloud)- and
built-in functions for regression analysis, solving equations, and producing
graphics. R is increasingly used for those involved in data analysis and statis￾tics, particularly social sciences, bio-statistics, and medicine. References on R
tend to emphasize different features of R more suitable for social sciences, data
mining, ecology, and medicine. A good reference for scientists using numer￾ical methods is available [1], and an Analytical Chemistry textbook [2] that
provides examples in R is available. This manual will present the elements of R
gradually, as needed, mostly through chemical data examples. This document
itself is created with R Markdown (https://bookdown.org/yihui/rmarkdown/),
which integrates a document creation with R code.
1.1 R IN RSTUDIO CLOUD
We will write our programs on an online platform (an IDE) called Rstu￾dio Cloud (RStudio Cloud is being renamed Posit Cloud), which makes it
platform-independent - we access the program the same way on a PC, Mac,
or Chromebook. The Rstudio Cloud environment is divided into four main
sections, with the most important elements listed below.
• Top Left: Script - where you write R code
• Bottom Left: Console - show output
• Top Right: Environment - we will mostly ignore this
• Bottom Right: show Plots, help, packages
DOI: 10.1201/9781003358640-1 12 R for Quantitative Chemistry
To start writing a program in Rstudio Cloud: create a Space (like a file folder
that can contain related programs), select New project, and from the menu:
File —— Newfile —– Rscript
& start typing! To run a program, highlight the code and select “run”. You
can create multiple Projects and R scripts in a single Space. Spaces are dis￾played on the left and you can create multiple spaces. In the tools icon (upper
right), spaces can be shared. When you run a script program, results and error
messages will appear on the console, and plots appear on the plot area. In this
document, the shaded area is R code, and the output appears in a white back￾ground following the shaded R script. The theory is described in the text, and
the details of R code are described in the code comment (text preceded by #)
1.2 VECTORS AND NUMERICS
In R we use < − to set a variable to a value. R uses “vector” calculation, which
avoids use of loops in more traditional programming. For instance, below we
set 𝑥 equal to a series of values (a vector), and then calculate a series of values
of 𝑦.1 • Intro to R 34 R for Quantitative Chemistry1 • Intro to R 5
Once we have a series of 𝑥 and 𝑦, of equal length, we can easily create a graph.6 R for Quantitative Chemistry
Below is an example of basic formatting commands.1 • Intro to R 7
type=“p”: for points (by default)
type=“l”: for lines
type=“b”: for both; points are connected by a line8 R for Quantitative Chemistry
1.3 FUNCTIONS
We can define a function and evaluate it later in the R script.
1.4 READING AND WRITING DATA FILES
With larger data sets, as in a titration, we prefer to be able to read a data file,
such as output from a spreadsheet. A common filetype is csv (comma-separated
values) files. Usually, the first row contains the headers, and the remaining rows
the values. If you upload a csv file into your working directory, it can be read
into dataframes. Dataframes are columns of values that do not have to be of the
same type (Names, dates, income, etc), and they are very important in many R
applications. However, here’ we are focusing on vectors, and we can convert
a dataframe with two or more numeric columns (such as volume and pH) into
respective vectors. The data file “mydat.csv” looks like this:1 • Intro to R 9
vol, pH
1.5, 3.2
3.0, 6.6
7.0, 14.010 R for Quantitative Chemistry
1.5 CONTROL STRUCTURES: FOR LOOP
Control structures allow iterative operations (for loop) and decision directed
operations (if then else).1 • Intro to R 11
1.6 PACKAGES
So far we have been using the base R that is available by creating an R script.
However, we will also make use of R packages which extend R by adding
graphical or computational extensions to R. They can be installed by selecting
“Packages” and “Install” in the lower right quadrant of RStudio and searching
by name for the package. Examples of packages we will use are nls2 (nonlinear
regression), fftw (Fourier transform), and Stats (Statistics). The use of each
package will be explored in the context of its use.
1.7 QUESTIONS AND PROJECTS
1. Create a vector “myvec” equal to 1, 5, 10, …, 100 with the sequence
command, and create a function yval equal to myvec squared. Create a
plot of yval versus myvec, with the data symbols as points.
2. Write the vector yval to a file. Check that the file was created.
3. pH = −log[H+
]. Create a vector “pH” of pH values from 1 to 10. Create
a function “hplus” which converts pH to hydrogen ion concentration.
Call the function to calculate the hydrogen ion concentration for the
series of pH values.12 R for Quantitative Chemistry
4. Find an equation with dependent and independent variables used in
science or social science (𝑦 = 𝑓 (𝑥)). Create a reasonable range and
sequence of 𝑥 values, calculate the 𝑦 values. Make a plot accurately
labeled and with a title.
REFERENCES
1. O. Jones, R. Maillardet, and A. Robinson (2009). Introduction to Scientific Program￾ming and Simulation Using R. CRC Press: Boca Raton, FL.
2. D. Harvey. Analytical Chemistry. https://chem.libretexts.org/Bookshelves/ Analyti￾cal_Chemistry/Analytical_Chemistry_2.1_(Harvey).Data and
Statistics 2
Every measurement has random error: Error that is inherent in the nature
of the measurement. For instance, while the true mass of an object might be
1.0000 g, the actual measured mass will deviate from that value in a random
manner, and the measured mass could well be 1.02 or 0.98 g. These deviations
follow a Gaussian distribution. Random error is also referred to as noise. We
can simulate the results of a number of measurements with the use of the R
command rnorm. Below we simulate five measured values assuming a true
value of 1. The rnorm command is useful in simulating realistic data. Using
set.seed will reproduce the same set of random numbers.
DOI: 10.1201/9781003358640-2 1314 R for Quantitative Chemistry
rnorm(𝑛,mean=0,sd=1) Generates Gaussian Random Values
input 𝑛 is the number of values, mean, standard deviation. Default values are
0 for mean and standard deviation of 1.
Comments Most used here to simulate realistic data by adding noise to an
idealized model. If we want a reproducible simulation we can use set.seed.
Significant Figures: The number of significant figures is all the certain figures
plus one uncertain figure. The degree of uncertainty in the last digit is ultimately
determined by a statistical analysis.
The Mean (or average) of a set of 𝑛 measurements 𝑥 is defined:
∑𝑛
𝑥 =
𝑖=1
𝑥𝑖
𝑛
The mean and standard deviation can be related to the Gaussian distribution
- that gives the probability of observing a particular value of 𝑥. For a finite
number of measurements, the Gaussian distribution can be approximated as:2 • Data and Statistics 15
𝑦 =
1
𝑠
√
(2𝜋)
𝑒
− (𝑥−𝑥)
2
2𝑠2
Data that we can collect from individuals or society can roughly follow a Gaus￾sian distribution. In a study [1], the average male weight is 76.7 kg with a
standard deviation of 12.1 kg, while women had an average weight of 61.5
with a standard deviation of 11.1 kg. Substituting this into the Gaussian distri￾bution formula16 R for Quantitative Chemistry2 • Data and Statistics 17
Note: We can specify symbols in the plot command. pch = 0,square
pch = 1,circle
pch = 2,triangle point up
pch = 3,plus
pch = 4,cross
pch = 5,diamond18 R for Quantitative Chemistry
Each point represents the probability of a particular observation,and the
area under the curve (the sum of all probabilities) is 1. The distance from the
mean of a particular measurement can be discussed in terms of “deviations from
the mean” as multiples of the standard deviation. For instance: 68.3% of mea￾surements lie within plus or minus one standard deviation 95.5% within plus
or minus two standard deviations 99.7% within plus or minus three standard
deviations. The R command for the cumulative distribution, which approaches
1, is pnorm.
pnorm(𝑛,mean=0,sd=1) Generates Gaussian Random Values
input: 𝑛 is the number of values, mean, standard deviation. Default values are2 • Data and Statistics 19
0 for mean and standard deviation of 1.
Comments: Most used here to simulate realistic data by adding noise to and
idealized model.
2.1 COMPARING TWO SETS OF DATA:
THE t TEST
Argon was discovered because the mass of chemically generated nitrogen was
significantly different from nitrogen obtained from air. Significant, in statistics,
is carefully defined in terms of probabilities. An interesting example comes
from history. Rayleigh’s investigation [2] of the mass of chemically gener￾ated nitrogen (for instance, from the decomposition of pure NO) and nitrogen
obtained from air was about 0.5% greater than that obtained from chemical
decomposition. Was this slight difference attributable to experimental error?
The mass of the two sets of masses were as follows, and the results of a t-test
in R are shown.20 R for Quantitative Chemistry
The important value to look for is 𝑝 (probability) value: it tells us the prob￾ability that this overlap is due to merely random experimental error. The p value
reported indicates about a one in a million chance that these results would occur2 • Data and Statistics 21
if the masses were actually the same. We can also see that the size standard devi￾ations, and see that they are much smaller than the difference between the two
average values.
2.2 QUESTIONS AND PROJECTS
1. Simulate ten random values centered around 1, with a standard devia￾tion of 0.1, 5 times. Compare the mean values obtained in each case. In
each case, what is the standard deviation? What is the average standard
deviation?
2. Gaussian Project
• Find two data sets that are likely to follow random distribution and
are likely to have similar mean values. This could be baseball batting
averages, heights, or some other attribute. Should be >15 values.
• Using R, create two vectors that represent the two data sets.
• Find the mean and the standard deviation. The commands are - if 𝑋
is the vector: mean(𝑋) and sd(𝑋).
• Use the dnrom command and graph the estimated Gaussian distribu￾tion over a reasonable range.
• Use the t-test to determine if they are significantly different. Interpret
the results.
REFERENCES
1. W. Millar (1986). Distribution of body weight and height. Journal of Epidemiology
and Community Health, 40: 319–323.
2. L. Rayleigh and W. Ramsay (1895). Argon, a new constituent of the atmosphere.
Philosophical Transactions of the Royal Society of London A, 186: 187–241.Beer's Law and
Linear Regression 3
Beer’s law for UV-Vis Spectroscopy is:
𝐴𝑏𝑠 = 𝜖𝜆𝑏𝑐
where 𝐴 = absorbance 𝜖𝜆 = absorption coefficient at a particular wavelength,
𝑏 = pathlength (typically cm), and 𝑐 = concentration (usually in molarity or µ
grams)
There is a linear relationship between the absorbance and the concentra￾tion, given a fixed pathlength and wavelength. In any experimental situation,
the inherent noise in the data will mean that we need to include a constant (𝐼 =
intercept).
𝐴𝑏𝑠 = 𝜖𝜆𝑏𝑐 + 𝐼
In order to use Beer’s Law to analyze for a particular component in solution
(an ãnalyte), we construct a calibration curve using experimentally determined
data. The object is to determine the absorption coefficient, 𝜖. We prepare solu￾tions of varying concentrations of the analyte, and measure the absorbance.
According to Beer’s Law, a plot of Absorbance versus concentration should
result in a straight line with a slope equal to 𝜖.
Let’s take an example. The data comes from the widely used Bradford
assay for protein [1]. In the Bradford assay, a dye (Coomassie brilliant blue
G-250) changes from red to blue when attached to proteins, and this color
absorption at 595 nm) is used to measure protein concentration. Here is sample
data for a calibration [2] for the BSA (Bovine Serum Albumin) standard.
DOI: 10.1201/9781003358640-3 2324 R for Quantitative Chemistry
3.1 LINEAR REGRESSION
We use the “lm” command to do linear regression - to find the best fit to the data
according to the least squares criterion: the slope (𝜖) and intercept are adjusted
to minimize the sum of the squares of the deviations of the experimental data
from the fitted line. The concept of regression is used throughout this book and
is central to analyzing data in chemistry. Mathematical models in Chemistry
have adjustable parameters - for Beer’s Law they are the absorptivity coeffi￾cient (the slope) and the intercept. Regression methods find the “best fit” line:
the choice of slope and intercept which generates a line which will have the
smallest sum of the squares of the deviations from the experimental data.3 • Beer's Law and Linear Regression 2526 R for Quantitative Chemistry3 • Beer's Law and Linear Regression 27
Coomassie Blue. Associates with Proteins through non-covalent interac￾tions.
From summary(BL) we learn the best fit values for the slope (𝜖) and the inter￾2
cept, the standard deviations of these fitted values, the 𝑝 values, and the 𝑟
value: how well a linear model explains the data.28 R for Quantitative Chemistry
lm(ydata,xdata) Linear regression on a set of paied 𝑥 and 𝑦 values.
input xdata and ydata are the names of 𝑥 and 𝑦 vectors previosly defined.
Comments Output of lm are the intercept and slope of the best fit line, the
standard error of these values, and 𝑟 squared, a measure of how well a linear
model explains the data, and the 𝑝 value indicates the probability pf thr “null”
hypothesis: there is no linear relationship between 𝑥 and 𝑦.
The final step in an analysis is to calculate the concentration of an unknown
based on the absorbance measured. Rearranging Beer’s Law, we have, for
example, for an absorbance = 0.350
𝐴𝑏𝑠
𝑐 =
− 𝐼
𝜖
3.2 RESIDUAL PLOTS
In a regression analysis, it can be helpful to plot the residuals (the deviations) of
the experimental data from the theoretical best fit line (or curve). The residuals
should appear randomly distributed above and below the best fit line.3 • Beer's Law and Linear Regression 29
For the Bradford determination, we have:
We can simulate an example with more points, based on a typical Bradford
assay. The simulated data exaggerates the magnitude of typical deviations to
help visualize.30 R for Quantitative Chemistry3 • Beer's Law and Linear Regression 3132 R for Quantitative Chemistry3 • Beer's Law and Linear Regression 33
3.3 METHOD VALIDATION
There is much attention on method validation in the Analytical Literature
and industries concerned with analyte measurement [3]. A brief summary is
provided below:
• Selectivity: ability to measure in the presence of interferences.
• Accuracy: agreement with the true value.
• Precision: Given by relative standard deviation: the (standard deviation
divided by the mean) times 100.
• Linearity and Range: over what concentrations does Beer’s Law hold?
• Limit of Detection: At what concentration is the signal to noise ratio 3:1
3.4 QUESTIONS AND PROJECTS
Linear Regression Project
1. Find real world data that you expect to follow a linear relationship. Data
points should be >10.
2. Enter the 𝑥 𝑦 data as the vector “xval” and “yval” in R.
3. Use lm command to perform linear regression.
4. Summarize the results.
5. Plot the data and the best fit line.
6. Analysis & Interpretation: 𝑝 value for intercept and slope.
7. Make a residual plot. Is it consistent with linear relationship?
8. What is the relative precision?
REFERENCES
1. M.M. Bradford (1976). Rapid and sensitive method for the quantitation of
microgram quantities of protein utilizing the principle of protein-dye binding.
Analytical Biochemistry, 72 (1–2): 248–254. https://www.sciencedirect.com/ sci￾ence/article/abs/pii/0003269776905273?34 R for Quantitative Chemistry
2. P.N. Brady and M.A. Macnaughtan (2015). Evaluation of colorimetric assays for ana￾lyzing reductively methylated proteins: Biases and mechanistic insights. Analytical
Biochemistry, 491: 43–51. https://www.ncbi.nlm.nih.gov/ pmc/articles/PMC4631703/.
3. T. Roa (1986). Validation of analytical methods. In: M.T. Stauffer (ed.), Calibra￾tion and Validation of Analytical Methods, vol. 40, pp. 319–323. BoD – Books on
Demand. https://www.intechopen.com/chapters/57909.Solving
Equilibrium 4
4.1 SYSTEMATIC TREATMENT
OF EQUILIBRIUM
In solving chemical equilibrium, we often make approximations to simplify the
mathematical solution. For instance, we often use the approximation of negli￾gible dissociation of weak acids. Here, we will explore the use of R to solve
equilibrium without approximations. We find the equation to solve through
application of a systematic analysis of equilibrium, which takes into account
the equilibrium, charge balance, and mass balance expressions.
4.2 pH OF HYDROFLUORIC ACID
We can show four equations:
HF dissociation
HF ⇌ H
+ + F
−
[H+ F
−
4 𝐾𝑎 =
] [ ]
= 6
HF
.8 × 10−
[ ]
Water Dissociation
H2O ⇌ H
+ + OH−
14 𝐾𝑤 = [H
+
] [OH−
] = 10−
Mass Balance
[HF]𝑖 = [HF] + [F
−
]
DOI: 10.1201/9781003358640-4 3536 R for Quantitative Chemistry
Charge Balance
[H
+ = F
− OH−
] [ ] + [ ]
Successively substituting the mass balance, charge balance, and 𝐾𝑤 into the
dissociation expression: eliminate [HF]
H
𝐾𝑎 =
[
+
] [F
−
]
[HF]𝑖 − [F−]
eliminate [F
−
]
H
𝐾𝑎 =
[
+
] ( [H+
] − [OH−
])
[HF]𝑖 − [H+] + [OH−
]
eliminate OH−
[ ]
H
𝐾𝑎 =
[
+
] ( [H+
] − 𝐾𝑤
[H+ ]
)
HF 𝐾𝑤
𝑖 H+ [ ] − [ ] + H+ [ ]
Finally, simplifying a bit:
𝐾𝑎 × ( [HF]
2
𝑖[H
+
] − [H
+
] + 𝐾𝑤) − ( [H
+
]
3 − 𝐾𝑤 [H
+
]) = 0
We can solve this for [H+
] using the uniroot command.4 • Solving Equilibrium 3738 R for Quantitative Chemistry
The solution is [H+
] 0.00229 M, or 23% dissiciated. Compare with the
approximate solution, assuming negligible dissociation
√
[H
+
] = 𝐾𝑎 [HA]𝑖 = 0.00260M
uniroot(function,c(lower,upper),tol): Finds the root (zero) of a function given
a lower and upper bound and a tolerance.
input: a function, upper and lower 𝑥 values to bracket the search, and a toler￾ance (uncertainty in the final result)
Comments: important output is the root and the precision of the root.4 • Solving Equilibrium 39
4.3 SOLVING OVER A SERIES OF Ka
VALUES WITH A FOR LOOP
We can use a for loop to iterate uniroot with a sequence of 𝐾𝑎 values.40 R for Quantitative Chemistry4 • Solving Equilibrium 41
Of course, we could use the same method to integrate over a sequence of HF
concentration values as well.
4.4 CARBON DIOXIDE AND
ACIDIFICATION
Added carbon dioxide in atmosphere not only affects climate, but also pH of
water. Let’s explore using the systematic method. We assume aqueous carbon
dioxide is fixed by the constant atmospheric carbon dioxide.42 R for Quantitative Chemistry
We start with Henry’s law equilibrium between gas and dissolved gas. Carbon
dioxide concentration is reported in ppm, so it is converted to atm.
CO2(g) ⇌ CO2(aq)
CO
𝐾𝐻 = 0.034 2
=
(aq)
CO2(g)
CO2(g) is 415 ppm, or 0.000415 as a fraction
We convert using:
Partialpressure = Totalpressure molefraction ×
If 1 atm is standard, then if CO2 is 0.000415 parts of the atm, then the CO2
pressure = 1 atm × 0.000415.
[CO2] ( ) [ ] ( ) aq = 𝐾𝐻 CO2 g
[CO2] (aq)
5 = 0.034 × 0.000415 = 1.41 · 10− M4 • Solving Equilibrium 43
Given CO2(aq) is constant, we have four coupled equilibriums to consider:
CO2(aq) + H2O ⇌ H2CO3(aq)
𝐾hyd = 0.0026
hyd (hydrolysis)
H2CO3(aq) ⇌ HCO3
−
(aq) + H
+
𝐾𝑎1 = 1.67 · 10−4
HCO3
−
aq ⇌ CO3
−
aq H+
( ) ( ) +
11 𝐾𝑎2 = 5.6 · 10−
H2O ⇌ H
+ OH− +
14 𝐾𝑤 = 1.00 · 10−
Charge Balance
[H
+
] = [OH−
] + [HCO3
−
] + 2[CO2
3
−
]
Substitute the 𝐾𝑤, 𝐾𝑎1
, and 𝐾𝑎2
expressions into the charge balance
H
𝐾𝑤 𝐾𝑎1
· [H2CO3] 2𝐾
[
+
] + +
𝑎2
· [HCO3
−
=
]
[H+] [H+] [H+]
Substituting 𝐾hyd and 𝐾𝑎1
(again)
H
+ 𝐾𝑤 𝐾𝑎 · 𝐾hyd
=
1
· [CO2]aq 2 · 𝐾 · 𝐾 · [H2CO3]
[ ] 𝑎1 𝑎2
[H+
+
] [H+
+
] [H+]
2
Finally, 𝐾hyd again,
𝐾 𝐾 𝐾
H
+
· hyd · [CO2]aq 2𝐾 · 𝐾
[ ] 𝑤
+
𝑎1
+
𝑎1 𝑎2
· 𝐾hyd · [CO2 aq
=
]
[H+] [H+] [H
+
]
2
Multiply by [H+
]
2
and total to
[H
+
]
3 − 𝐾𝑤 · [H
+
] + 𝐾𝑎1
· 𝐾hyd · [CO2]aq · [H
+
] + 2𝐾𝑎1
· 𝐾𝑎2
· 𝐾hyd · [CO2]aq = 0
An approximate approach:
Since 𝐾𝑎2
and 𝐾𝑤 are small compare to 𝐾𝑎1
, we could try to ignore them,
and we would have:
[
2 𝐾𝑎1 = H
+
] /H2CO344 R for Quantitative Chemistry
where
H2CO3 = 𝐾hyd · CO2(aq) = 0.0026 · 1.41 × 10−5
And
[H
+
]
2 = 𝐾𝑎1
· 𝐾hyd · CO2(aq)4 • Solving Equilibrium 4546 R for Quantitative Chemistry
4.5 VISUALIZING ROOT FINDING
The process of finding a root can be illustrated by evaluating the root function
at pH values in the neighborhood of the 5.6. The root function can be seen to
go from plus to minus in this region.4 • Solving Equilibrium 47
The situation in natural waters is more complex and may involve further reac￾tions of solid calcium carbonate. So ocean pH is not 5.6, but has values between
7 and 8. Nevertheless, atmospheric CO2 is causing some acidification. cal￾cium carbonate dissolution can mitigate ocean acidification, although is not an
equilibrium process.
4.6 QUESTIONS AND PROJECTS
2 1. Consider a HClO2 (chlorous acid0 with 𝐾𝑎 = 1.2 · 10−
.
Solve for H+ using the systematic method, taking into account 𝐾𝑏1
, 𝐾𝑤,
charge balance and mass balance. In solving this system, we can safely
ignore 𝐾𝑏2
. Solve to find the pH of 0.01 M with uniroot and also use a
for loop to explore the fraction of dissociation versus concentration of
HA.
2. The Halfway Method for Solving Equilibrium Problems
Based on the simplest root-finding method (bisection), here is a way
of calculating a better answer when the approximation of slight dis￾sociation is not satisfied. It is similar to the way a calculator or a
computer solves equations (i.e. it is a numerical method). Another48 R for Quantitative Chemistry
method, cited in some Chemistry texts, is the method of successive
approximations. Unfortunately, this method is unstable in some cir￾cumstances. In practice, there are faster methods, but they are more
complicated. Additionally, this method requires understanding of the
reaction quotient and its relationship to the equilibrium constant. The
method can be summarized as follows:
• Define the extreme limits of dissociation. For instance, the 0.0100
M HA can be zero percent dissociated or 100
• Select the concentration value of H+
“halfway” between 0.00 and
0.010 M, 0.0050 M
• Substitute that value of H+
into the reaction quotient 𝑄 expression:
𝑄 =
[H+
]
2
[HA]𝑖− [H+ ]
= (0.0050)20.0050 = 0.005 note: 𝑄 is the same form
as 𝐾𝑎 but when concentrations are not at equilibrium.
• Compare the 𝑄 value to the 𝐾𝑎 value. If 𝑄 > 𝐾𝑎 then the amount
of dissociation is <0.0050 M. If 𝑄 < 𝐾𝑎, then the actual amount of
dissociation is >0.0050 M. The concentrations must change so that
𝑄 becomes closer to 𝐾. In this case the 𝑄 < 0.005, and it therefore
must be more dissociated than 0.005.
• Now the range must be somewhere between 0.005 and 0.010, and we
0 0075 2
choose a new “halfway” that is 0.0075. Our new 𝑄 is: =
( . 𝑄
)
0.0025
= 0.0225, and 𝑄 > 𝐾, and our next value must be a smaller dissoci￾ation. The next halfway is between 0.00500 and 0.0075, which is =
0.00625. The 𝑄 = 0.010, and we must go smaller again! The halfway
is between 0.0050 and 0.00625, which is 0.005625, and 𝑄 = 0.007,
which is pretty close to 0.0066. We can go as far as we want (or tell
a computer to do it) and get as accurate as we want. Here we are sat￾isfied to know that the dissociation has to be between 0.00500 and
0.00563, so we end with H+ = 0.0053 M. By the way, what does the
approximate method give: H+ = SQRT(0.0066 × 0.01) = 0.00812 M.
This is much worse than the actual dissociation −80% versus 53%.
So pH = 2.27
Now you try it with the case of aspartic acid, with a pK1 = 1.88.
What is the pH of 0.01 M aspartic acid?
Also: A good numerical method can “bracket” how close the answer
must be to the true answer. The halfway method does this. Each
step successively brackets the true value between smaller and smaller
ranges.
Your R project: Translate the “halfway method” to an R program
using a for loop to iterate and an if else statement to decide on the
next calculation.Titrations 5
Here we will extend the use of the R command “uniroot” to solve for an acid￾base titration curve. First, we quickly review the common approximate method
that is often presented.
5.1 THE APPROXIMATE VIEW
For the titration of a weak acid with a strong base, we can use approximate
solutions for different parts of the titration curve. This is useful to get a quali￾tative understanding of the chemical equilibrium. For instance, the analysis of
amino acids (diprotic or triprotic) is often considered in this light.
For now, let’s consider the titration of 15.0 mL of 0.1 M lactic acid,
𝐾𝑎 = 1.38 · 10−4 with 0.1 M NaOH.
5.1.1 Initial H
We use
√
[H
+
] = 𝐾𝑎 · [HA]𝑖
DOI: 10.1201/9781003358640-5 4950 R for Quantitative Chemistry
5.1.2 The Buffer Region
In the buffer region (between 0 and equivalence point) we simply use the
equilibrium expression and assume a complete acid-base reaction and no
dissociation.
[HA [H
+
] = 𝐾𝑎
]
·
[A−]
or
A
pH = 𝑝𝐾𝑎 + log [
−
]
[HA]5 • Titrations 51
We can keep this approximation in mind as we explore more accurate solutions.
which leads to the pH at the midpoint = 𝑝𝐾𝑎
5.1.3 Endpoint
Here, we use the conjugate base and assume slight hydrolysis.52 R for Quantitative Chemistry
We can keep this approximation in mind as we explore more accurate solutions.
5.2 AN EXACT SOLUTION
Approaching in a systemic manner, we write down system equations for the
weak acid/strong base titration, where VA= volume of acid, cA = Concentra￾tion of acid, cB = concentration of base, and the equilibrium constants 𝐾𝑎 and
𝐾𝑤. In this way, we can get an expression of the volume of base as a function
of [H+
] (or pH). This makes direct comparisons with experiment difficult, as
we would normally want to predict pH as a function of added base.
Equilibrium Expressions
H
𝐾𝑎 =
[
+
] [A−
]
[ ] HA
𝐾𝑤 = [H
+
] [OH−
]
Charge Balance
[Na+ H
+ = A
− OH−
] + [ ] [ ] + [ ]
Sodium Ion Concentration
VB · cB
VA VB +
Mass Balance
[HA tot = HA A−
] [ ] + [ ]
This is a bit tricky. We can easily substitute the sodium ion concentration and
[OH−
] =
𝐾𝑤 to get: [H+ ]
VB · cB
VA VB + H
+ = A
− 𝐾
+
𝑤
H+ + [ ]
Solving for A−
[ ] is a bit more work.
Substituting the mass balance into the equilibrium expression:
A− H+
𝐾𝑎 = [A
−
] [H
+
]/[HA =
[ ] [ ] ]
([HA]tot − [A−])5 • Titrations 53
𝐾𝑎 · [Ha]tot − 𝐾𝑎 · [A
−
] = [A
−
] · [H
+
]
𝐾𝑎 · [HA]tot/[A
−
] = [H
+
] + 𝐾𝑎
[HA]tot ( [H+
=
] + 𝐾𝑎)
[A−] 𝐾𝑎
A
let fA = fraction of A = [
−
]
[HA]tot
fA 𝐾
=
𝑎
𝐾𝑎 + [H+]
now the fraction of A- times the total conc HA is A- conc
cA VA [A
−
] = fA ·
·
Va + VB
and we can substitute to get VB as function of other stuff
VB · cB fA · cA · VA
+ H
+ 𝐾
=
VA + VB (VA + VB
+
𝑤
) [H+]
this can be rearranged to:
( ( ) ) 𝐾𝑎/([H+
] + 𝐾𝑎) − [H+
] − 𝐾𝑤
VB
[H+ cA
(
]cA
= )
· VA
1.00 +
H−𝐾𝑤
·
cB
[H+ ]cB54 R for Quantitative Chemistry
Below we use this expression to calculate a titration curve for a weak acid.5 • Titrations 5556 R for Quantitative Chemistry
5.3 ROOT FINDING: pH AS
FUNCTION OF VOLUME5 • Titrations 57
5.4 USING SAPPLY WITH UNIROOT TO
SOLVE FOR TITRATION CURVE
Since we have an implicit expression for the hydrogen ion conentration, we
can use uniroot to solve for the hydrogen ion concentration, to generate a curve
that can be more directly compared to the experiment. We could have used a
for loop, but we can use the “sapply” command on uniroot.58 R for Quantitative Chemistry5 • Titrations 5960 R for Quantitative Chemistry5 • Titrations 61
5.5 EFFECT OF IONIC
STRENGTH/ACTIVITY COEFFICIENTS
Formally, we learn in physical chemistry that equilibrium constants are formu￾lated with activities, not concentrations. In many instances, the distinction may
not be important: for instance, we determine an equilibrium constant under
specified conditions. In thermodynamics, equilibrium constants are defined as
unit activity, which is obtainable at an ionic strength equal to zero. It does affect
our experiments on binding curves. Kennedy [1] discusses a practical approach
that we might apply to our analysis.
5.5.1 Ionic Strengths and Activity
Ionic Strength is defined:
1 ∑ 2
𝐼 =
2
𝑐𝑍
where 𝑐 is concentration and is charge.
The thermodynamic equilibrium constant for weak acid with charge 𝑧 is
𝛼H+𝛼A 𝐾th =
𝑧−1
𝛼HA𝑧
the equilibrium measured at ionic strength = 0. (an ideality, which can be
approached by doing experiments at a series of ionic strengths approaching
0 and extrapolating to zero )
where 𝛼H+ = 𝑓 [H+
]
where 𝑓H+ is the activity and alpha the activity coefficient
Because glass pH electrodes respond to proton activity, while HA and A￾are measured in molarities, a mixed equilibrium constant is defined ref
𝛼H+ [A𝑧−𝑙
𝐾mix =
]
[HA𝑍
]
and
𝑝𝐾mix = 𝑝𝐾th + log 𝑓A𝑧−1 − log 𝑓HA𝑧
The Debye Huckel equation is useful up to 𝐼 = 0.005
log10 𝑓𝑖 = −
2 𝐴𝑧 √
𝐼62 R for Quantitative Chemistry
under standard conditions 𝐴 = 0.509
A more realistic equation is:
log10 −
2 𝐴𝑧 √
𝐼
𝑓𝑖 =
(1
√
+ 𝐼)
th and for the 𝑛 dissociation of acid with charge z
A
√
𝐼(2𝑧
𝑝𝐾mix,𝑛 = 𝑝𝐾th,𝑛
− 2𝑛 + 1)
+
1
√
+ 𝐼
We can use this equation to make an approximate correct 𝐾 values obtained
from titration experiments.
5.6 PROJECT
1. Using the pK value(s) determined from a titration, simulate the titration
and compare (plot) both the titration curve and the simulation.
2. Apply activity theory to correct for ionic strength in determining 𝐾𝑎.
REFERENCE
1. C. Kennedy (1990). Ionic strength and the dissociation of acids, Biochemical Edu￾cation, 18(1): 35–40.Binding Curves 6
Binding Curves (or Binding Assays) are an approach to determining the equi￾librium constant for the interaction of two molecules, commonly used in
biochemistry [1]. Typically, a small molecule (commonly called the “ligand”)
attaches to a larger molecule such as a protein. If we denote the protein as P
and the ligand as L we can express the dissociation as:
PL ⇌ P+ L
and where the total protein is the bound plus unbound.
Ptot =PL P+
With the dissociation constant:
𝐾
[P L
𝑑 =
] [ ]
[PL]
The concentration of the ligand (in excess) is varied and the fraction bound
[PL]
is plotted versus the L [2]. Ptot
Substituting Ptot = P + PL into the 𝐾𝑑 expression:
we get
( [Ptot] − [PL]) [L] ( [Ptot 𝐾𝑑 = =
] [L] − [PL] [L])
[PL] [PL]
𝐾𝑑 [PL] + [PL] [L] = [Ptot] [L]
[PL] (𝐾𝑑 + [L]) = [Ptot] [L]
and we get expression for fraction bound as a function of 𝐾𝑑 and L.
[PL]
=
[L]
Ptot 𝐾𝑑 + [ ] L
DOI: 10.1201/9781003358640-6 6364 R for Quantitative Chemistry
note as L increases the fraction bound goes from 0 to 1.
The key to binding assay is to find an experimental method to determine
the concentration of PL, the bound form.
Although it is called a “binding assay” the equilibrium is discussed in terms
of the dissociation, with 𝐾𝑑
6.1 MYOGLOBIN BINDING6 • Binding Curves 6566 R for Quantitative Chemistry
nls2(𝑦 𝑓 (𝑣, 𝑤, 𝑥),start = 𝑐(𝑣 = 1, 𝑤 = 2, 𝑥 = 3): Non-linear regression with data
vector 𝑦 and function with parameters 𝑣, 𝑤, and 𝑥.
input: 𝑦 data as vector, the function, and starting values for the parameters.
Comments: Output estimates of parameters with their standard errors. 𝑝 value
output may not be reliable nor nonlinear regression.6 • Binding Curves 67
6.2 L NOT IN EXCESS
For the Binding Assay, with P = Initial Protein and L = Initial Ligand, and
PL = 𝑥 = amount of bound protein, we have the equilibrium expression:
( P
𝐾𝑑 =
[ ] − 𝑥) ( [L] − 𝑥)
𝑥
if we solve for 𝑥 and divide by L, we will get fraction bound.
𝐾
[P] [L] − [P]𝑥 − [L] + 2
𝑥 𝑥
𝑑 =
𝑥
𝐾𝑑𝑥 = [P] [L] − [P]𝑥 − 𝑥[L] + 2
𝑥
[P] [L] − [P]𝑥 − 𝑥[L] − 𝐾𝑑𝑥 +
2
𝑥 = 0
[P] [L] − ( 2 𝐾𝑑 + [P] + [L])𝑥 + 𝑥 = 0
The quadratic solution, divided by [L],
√
𝑥
=
(𝐾𝑑 + [P] + [L]) − (Kd + [P] + [L])2 − 4( [P] + [L])
L 2[L]
note: why not divide by P? because P is large and L is limiting.
6.3 ACID/BASE BINDING CURVE
Adapt to titration data, framed as fraction binding as determined from the
endpoint, vs pH (which is actually equilibrium ligand H)
We can transform titration data into a binding curve representation.
For the equilibrium:
HA ⇌ H
+ + A
−
H
𝐾𝑎 =
[
+
] [A−
]
[HA]68 R for Quantitative Chemistry
we are measuring H+
and for a weak base strong acid titration, the fraction
bound is fraction of the way to the endpoint.
HA 𝑓 =
[ ] vol
=
[A−] + [HA] volt
substituting the equilibrium expressions into this:
[HA 𝑓 =
𝐾𝑎 HA
]
[ ]
[H+ ]
+ [HA]
1
𝐾𝑎
[H+ ]
+ 1
[H+
𝑓 =
]
[H+] + 𝐾𝑎
It is useful to note that we are measuring [H+
], so unlike the similar binding
equation, there is no approximation of excess “ligand”.
This is a very useful way to analyze acid-base data to determine 𝐾𝑎 values.
Where is the error? The error is in the estimation of the endpoint, which
translates into a systematic error in the fraction bound.6 • Binding Curves 6970 R for Quantitative Chemistry6 • Binding Curves 7172 R for Quantitative Chemistry
This approach to acid-base binding can be generalized, and the solution for a
multi-protic system is:
[H+
] 2
2
=
𝐾1
+
[𝐻+
𝐾
] 3
1𝐾2
+
[𝐻+
𝐾
]
3
𝐾1𝐾2 3 𝑓
1 +
[𝐻+
𝐾
]
1
+
[𝐻+ ]
2
𝐾 𝐾
]
2
+
[𝐻+ 3
1 𝐾1𝐾2𝐾3
6.4 EXPLORATION OF DIPROTIC
TITRATIONS
6.4.1 Preparation of Experimental Data
We can transform titration data to a binding curve format.
if HA had slight dissociation we simply would have
𝐹 = (2 − VA × cB)/(VE× VB)6 • Binding Curves 73
but in actuality, the fraction bound is less according to the extent of dissociation
- the amount of H+
.
𝐹 < − (2 − ((VA × cB) + ( (H) × (VI + VA)))) /(VE× CB)74 R for Quantitative Chemistry6 • Binding Curves 7576 R for Quantitative Chemistry6 • Binding Curves 7778 R for Quantitative Chemistry
6.5 PROJECTS
1. Transform monoprotic or diprotic data to a binding curve and analyze
with nls2. Compare with the traditional midpoint analysis of a titration
curve.
REFERENCES
1. T. Pollard (2017). A guide to simple and informative binding assays. Molecular
Biology of the Cell, 21(23). doi: 10.1091/mbc.e10-08-0683.
2. While the mathematics of equilibrium is similar to a simple acid, note the difference
in a titration curve, where the -log(H) is measured.Electrochemistry 7
7.1 BIOCHEMISTS POTENTIAL
It is commonly known that physiological pH is around 7. But there is also a
physiological redox potential, which seems to have somewhat more variability.
A marker for the physiological redox potential is the ratio of reduced (GSH) and
oxidized (GSSG), which can vary from around 20:1 to 1:1, and it apparently
a function of health condition. Glutathione concentration is in the millimolar
range.
Biochemistry commonly uses thermodynamic values at pH = 7, although
the physical chemistry standard pH is at 1 M ion concentration. Thus, for an
electrode reaction that includes a hydrogen ion, the potential will differ from
0 0
the standard potential, 𝐸 . Biochemists denote the potential at pH = 7 ′
𝐸 .
For a half reaction,
𝑎A
+ + 𝑚H
+ + 𝑛𝑒− ⇌ 𝑏B
The Nernst equation is:
𝑎
]
𝑏
0
′ 0
0.05916 [B
𝐸 = 𝐸 −
𝑛 [A] [H+]𝑚
𝑅𝑇
𝐹
= 0.05916 at standard conditions.
7.2 ASCORBIC ACID
0 Ascorbic Acid is itself an acid with 𝐾𝑎 and 𝐾2 and a 𝐸 = 0.390.
H2A ⇌ A
2−
2H+ +
DOI: 10.1201/9781003358640-7 7980 R for Quantitative Chemistry
Dehydroascorbate + 2H+ + 2𝑒
− ⇌ Ascorbicacid
This system can be solved as follows [1]
0
0.05916 1 0 Red
𝐸 = 𝐸 −
2
· log .05916
− · log [H+]
2 + [H+] · 𝐾𝑎1 + 𝐾𝑎2
· 𝐾𝑎2
2 Ox
Assuming the reduced and oxidized forms are equal, we can calculate the
potential as a function of pH.7 • Electrochemistry 81
7.3 QUESTIONS AND PROJECTS
Consider the data from a classic PNAS paper [2]. Use nonlinear regression to
find 𝐸
0
and 𝐾𝑎1
and 𝐾𝑎2
.
Table Potential vs pH, Ascorbic Acid [Red] = [Ox]82 R for Quantitative Chemistry
REFERENCES
1. D.C.Harris (2007). Quantitative Chemical Analysis, 7
𝑡 ℎ edition. Freeman and
Company: New York.
2. H. Borsook and G. Keighley (1933). Oxidation-reduction potential of ascorbic acid
(vitamin C). PNAS, 19: 875–878.Fourier Transform
and Spectroscopy 8
8.1 AUDIO ANALOGY
Sound waves share useful similarities with electromagnetic radiation. They are
both represented as traveling sine waves. Sound waves are a periodic distur￾bance in physical medium (air) whereas em radiation is a periodic change in
an electric field. After a pulse excitation, the nmr signal decay contains that
reflect multiple relaxations at different frequencies. To explore the nature of
wave motion and the Fourier transform we can use audio files and R packages
that create, read, and manipulate audio files (.wav).
packages:
fftw
TuneR
Below we used R to generate representations of sound. The graphs are of
sound waves of different frequencies, as might be detected by a microphone:
the plots are amplitude of sound versus time.
DOI: 10.1201/9781003358640-8 8384 R for Quantitative Chemistry8 • Fourier Transform and Spectroscopy 8586 R for Quantitative Chemistry
8.2 QUESTIONS FOR DISCUSSION
1. Consider the first graph. Imagine you are the microphone, and you
measure amplitude by raising and lowering your hand.
2. According to the graph estimate how long does it take to go up and
down once?
3. How many times will it go up and down in one second? This is the
frequency.
4. Sound amplitude is related to compression of air. Sketch what com￾pression of air might look like as a function of distance.
5. What is oscillating up and down in the case of EM radiation?
Now we will consider how the Fourier transform can translate a time domain
representation to a frequency representation. For study of sound, and in spec￾troscopy, frequency representations are more useful. We use the R fftw package
command FFT to do this. Now we have a graph of intensity versus frequency.
We call this a transformation from the time domain to the frequency domain.
For the individual time domain graphs, you could easily sketch a frequency
domain representation. But what about the fourth graph? Somehow the FFT is
able to unscramble the waves and do the conversion.8 • Fourier Transform and Spectroscopy 87
8.3 THE FOURIER TRANSFORM
As we have seen, the FT transforms time domain data to frequency domain.
This turns out to be widely important and is key part of modern NMR (Earning
Richard Ernst the Noble Prize), other spectroscopies (FTIR), signal processing,
image processing, acoustics, and biology (bioacoustics).88 R for Quantitative Chemistry
Even though we may not encounter the Fourier transform in our math
courses, we can try to get a conceptual understanding with the math we know.
The key is in the idea of orthogonality.
8.4 QUESTIONS: ORTHOGONALITY
To try to understand what the FFT is doing, we can start with something
familiar, a vector represented on 𝑥 𝑦 coordinates.
1. Draw a vector 𝑣(0.75, 0.50) on an 𝑥 𝑦 grid. Now we know that if we drop
a vertical line from the end of the vector, we will find the 𝑥 component.
How do we find the 𝑦 component? Illustrate both.
2. In each case, more formally, what you just did was to multiply the vec￾tor 𝑣(0.75, 0.50) by 𝑥 and 𝑦 unit vectors to find the scalar product.
vec1 = 𝑣(1, 0) vec2 = 𝑣(0, 1) vec3 = 𝑣(2, 3)
Vector multiplication
𝑣(𝑥1, 𝑦1) × 𝑣(𝑥2, 𝑦2) = 𝑣(𝑥1 × 𝑥2, 𝑦1 × 𝑦2)
3. What is the scalar product of the 𝑥 and 𝑦 unit vectors? The unit 𝑥 and 𝑦
vectors are orthogonal. We used orthogonality to break apart a vector
into its 𝑥 and 𝑦 components.
Ok, what does this have to do with sound waves and the Fourier transform? We
see that a complex waveform is composed of many individual waves. Now it
turns out that the individual waves are orthogonal to each other, and we can use
that fact to “pick out” the individual waves using the Fourier transform.
Since the math is more complicated, let’s use R to explore.
If we multiply two functions and find the area under the curve of the result￾ing function, if it is zero then those are orthogonal.
We can sometimes see if the area under the curve is zero because the
positive and negative areas are symmetrical.8 • Fourier Transform and Spectroscopy 89
using R:
1. graph the product for the following:
sin(x)*sin(x)
sine(x)*sin(2*x)
sin(x)*sin(5*x)
sin(x)*sin(2*x)*sin(5*x)*sin(x)
2. can use estimate the area under the curve of these graphs? finite or zero
The Fourier transform is simply doing this over and over again, with many
frequencies. when it “hits” a part of the curve that matches the frequency (that
is non-orthogonal) it has a non-zero result and picks that frequency out.
Here is an example of actual sound wave & fft using R.90 R for Quantitative Chemistry8 • Fourier Transform and Spectroscopy 9192 R for Quantitative Chemistry8 • Fourier Transform and Spectroscopy 93
8.5 FT AND SIGNAL AVERAGING
Since FT spectroscopies are faster than continuous wave spectroscopies, more
spectra can be collected, and we can take advantage of signal averaging. Use R
to generate noisy sine waves and use signal averaging to see reduction in S/N
ratio.
rnorm can be used to add noise to a signal. Here we simply demonstrate the
impact of signal averaging by looking at the standard deviation as a function of
number of signals.
after 1
after 10
after 100
How does the average noise change with 𝑛 (=number of signals)94 R for Quantitative ChemistryR Kinetic Analysis 9
Methods we have examined previously, such as titration or binding curves,
have assumed a chemical equilibrium has been established. We now consider
methods where a chemical system is moving toward equilibrium.
9.1 FIRST ORDER KINETICS
For a reaction
A→B𝑘1
[A]𝑡 = [A]𝑡=0𝑒
−𝑘1·𝑡
Below we simulate kinetic data with noise and the perform nonlinear regression
with nsl2 In addition, we explore the use of a modified nelder-mead simplex,
called subplex. Simplex methods are generally a bit slower than those used in
nls2 (more iterations), but they are generally more robust. If you are getting an
error using nls2 you can try subplex.
DOI: 10.1201/9781003358640-9 9596 R for Quantitative Chemistry
9.2 OPTIMIZATION METHODS: FIRST
ORDER REACTION9 • R Kinetic Analysis 9798 R for Quantitative Chemistry9 • R Kinetic Analysis 99
9.3 MONTE CARLO
Sublex itself does not provide error estimates on the determined parameters.
However, since we are simulating experimental results if we simulate multiple
experiments and find the average standard deviation it is consistent with results
from nls.
The result of the average of five runs of sublex on simulated data results
finds the following average parameter and sd.
Result of nls
alpha 1.02382 0.14057
k 0.12620 0.03813100 R for Quantitative Chemistry
Result from mean of five simulations with subplex
alpha 1.000769 sd 0.1478484
k 0.1050 sd 0.0519
The agreement is excellent, in view of the fact that multiple runs of nls
on simulated data sets naturally result in slightly different values and standard
deviations.
Subplex can be used in combination with a loop to mimic a Monte Carlo
simulation as the loop allows for repeated iterations of a procedure, i.e. curve
fitting, along with generated noise. Some common examples of curve fitting
programs in R include nls and nls2, and while they’re very good at what they
do, there can be situations where they fail analytically and the Monte Carlo
approach is more applicable. In the following example, this approach is used
for a curve fit for the exponential decay of Iodine-131, with data obtained from
the following site [1].9 • R Kinetic Analysis 101
First, the raw data is simulated and a vector, 𝑏, was made for later in the
program. Some noise is then generated using the rnorm command, and the
standard deviation was found by using an nls fitting, but there are more sophis￾ticated methods to find an appropriate amount of error. Then, the parameters
for subplex to determine were defined with the exponential decay model; each
iteration of the for loop would generate new noise for the original data and add
the determined 𝑘-values and initial activity to the vector 𝑏. If more iterations
were desired, 𝑏 would have to be increased in length, but, while tedious, this
is easily done. When subplex reports the findings for both parameters, it does
so in a list format where both parameters are present together. As we want the
parameters to be separated so we can investigate their respective means and
standard deviations, the unlist command was used, and the desired calculations
could then be done. The unlist command does exactly what it says: it unlists a
list and turns it into a vector, which we already know how to manipulate from
Chapter 1. When the iterations were complete, 𝑏 contained information for102 R for Quantitative Chemistry
each iteration, and each entry in 𝑏 was then unlisted so the 𝑘-value informa￾tion and the initial activity value could be added to different vectors. The mean
and standard deviation of these vectors was then easily found, and the results
were in good agreement with the researcher’s determination of 𝑘 and the value
determined by nls.
9.4 SOLVING DIFFERENTIAL EQUATIONS
WITH DESOLV PACKAGE
It is beyond the scope of this text to go into detail, but the R package provides
a general differential equation problem solver (desolv) - a simple example is
provided below.9 • R Kinetic Analysis 103
In addition, there is a package FME which couples with desolv to perform
regression on data with the model determined with desolv. Examples are given
in the package documentation.
9.5 ENZYME KINETICS
The simplest formulation of an enzyme reaction is:
E+ S ⇌ [ES] →E+P
where the first step is characterized by rates 𝑘1 and 𝑘2:
and a slower second step 𝑘3.
𝐾eq =
𝑘1
𝑘2
It is generally accepted that enzymes catalyze reactions by binding the
transition state and lowering the free energy of reaction.
Experimentally, studies of enzyme kinetics focus on initial rates. Using a
steady state approximation - the concentration of ES quickly reaches a steady104 R for Quantitative Chemistry
state value - the Michalis-Menten equation - properly derived by Haldane and
Briggs,
[P
Rate 𝑑 Ratemax S
=
]
= 𝑘3
𝑡
[ES [ ]
𝑑
] =
𝐾𝑚 + [S]
𝐾𝑚 = 𝑣max = 𝐾cat𝑥𝐸
an equation reminiscent of the binding equation.
Complications due to the progress of the reaction vanish:
1. inhibition by accumulated products, loss of activity of the enzyme
2. The reverse reaction can be ignored because it cannot occur until some
products have had time to appear.
3. An initial-rate equation is much simpler to derive and use than an
equation for the full time course of a reaction.
4. There is no drift in the pH or other conditions at zero time.
9.6 PROJECT
The kinetic parameters 𝐾𝑚 and 𝐾cat are provided for Carbonic Anhydrase.
Analyze multiple simulations of initial rates versus substrate concentrations
with subplex and determine the average and standard deviation of 𝐾𝑚 and 𝐾cat.
Use an enzyme concentration 5 µM and a range of substrate from 0 to 50 mM.
Carbonic anhydrase
2 𝐾𝑚 = 2.6 · 10−
𝐾cat = 4.0 · 105
REFERENCE
1. https://radioactivity.eu.com/phenomenon/iodine_131.Reports in R
Markdown 10
RStudio Cloud contains a powerful document creation tool R Markdown, suit￾able for scientific reports, thesis and publication quality research papers. Some
nice features
• Simple mark up language
• Latex style equations
• Sharing through rpubs or other systems
• embedded R code to generate graphs in document
Creating Simple Report with R Markdown
In rstudio cloud, we can choose file → new file →
A new file (.rmd) will be created which already includes the first part of an
rmd file the “YAML” header, which declares the title, and html and pdf outputs.
““markdown—
title: “Sample Document”
author: “D. Gosser”
date: ‘2023-06-12’
output:
html_document: default
The default created R Markdown file also includes examples of simple
formatting and embedding r code.
Now you can input and format text, equations, images, and references, and
R code. You can view your formatted document: Select “knit” to produce an
html or pdf document.
Headers and subheaders are created with #, ##, ###.
““markdown Header Levels
DOI: 10.1201/9781003358640-10 105106 R for Quantitative Chemistry
# Header 1
## Header 2
### Header 3
““ Below are examples of R Markdown code and the output they produce.
10.1 BASIC FORMATTING10 • Reports in R Markdown 107
10.2 EMBEDDING R CODE IN
R MARKDOWN
For scientific work, the ability to insert latex equations is very useful. To insert
an inline equation bracket the latex code with dollar signs.108 R for Quantitative Chemistry
Examples of latex equations
which result in:
2
𝑦
𝐾cat
𝑎 · 𝑏
𝑎·𝑏
𝑐
𝛼 · 𝛽
𝛼 𝛽· (next line, centered)
After knitting to html, a simple way to share is to publish the document in
an rpub account, which provides an attractive html based document. In Rstu￾diocloud, after you knit to html, choose “publish” and choose rpub and create
an account.Index
acid binding curves 67–72
acidification, carbon dioxide and 41–45
activity coefficients, effect of 61–62
ascorbic acid 79–80
audio analogy 83–85
base binding curves 67–72
Beer’s law 24
for UV-Vis spectroscopy 23
binding assay 64, 67
binding curves 63–64
acid/base 67–72
exploration of diprotic titrations 72–77
L not in excess 67
myoglobin binding 64–66
biochemists potential 79
Bradford assay 23
carbon dioxide and acidification 41–45
control structures, for loop 10–11
csv (comma-separated values) files 8
data
comparing two sets of data 19–21
and statistics 13–19
data files, reading and writing 8–10
dataframes 8
desolv package, solving differential
equations with 102–103
diprotic titrations, exploration of
72–77
electrochemistry
ascorbic acid 79–80
biochemists potential 79
embedding R code in R markdown
107–108
enzyme kinetics 103–104
equilibrium, systematic analysis of 35
first order kinetics 95
for loop
control structures 10–11
series of Ka values with 39–41
formatting commands 6–7
Fourier transform (FT) 87–88
and signal averaging 93–94
functions, R for quantitative
chemistry 8
Gaussian distribution 14, 15
Henry’s law 42
hydrofluoric acid, pH of 35–38
ionic strength/activity coefficients, effect of
61–62
Ka values with for loop 39–41
kinetics
enzyme 103–104
first order 95
R (see R kinetic analysis)
linear regression 24–28
“lm” command 24
Monte Carlo simulation, R kinetic analysis
99–102
multi-protic system 72
myoglobin binding 64–66
nls2 64–65
nmr signal decay 83
numerics, vectors and 2–7
optimization methods: first order reaction
R kinetic analysis 96–99
orthogonality 88–93
109110 Index
packages 11
pH
as function of volume 56–57
of hydrofluoric acid 35–38
Posit Cloud 1
questions and projects 11–12
Beer’s law and linear regression 33
data and statistics 21
electrochemistry 81
R in RStudio Cloud 11–12
solving equilibrium 47–48
titrations 62
random error 13
Rayleigh’s investigation 19
reading data files 8–10
regression
analysis 28
linear 24–28
reports, in R markdown 105–106
embedding R code in R markdown
107–108
formatting 106
residual plots 28–32
R in RStudio Cloud 1–2
R kinetic analysis
first order kinetics 95
Monte Carlo simulation 99–102
optimization methods: first order reaction
96–99
R markdown
embedding R code in 107–108
reports in 105–106
rnorm command 13–14, 101
root finding
pH as function of volume 56–57
visualizing 46–47
RStudio Cloud 1
R in 1–2
sapply command 57–60
signal averaging, Fourier transform (FT) and
93–94
sound waves 83
spectroscopy, Beer’s law for UV-Vis 23
statistics, data and 13–19
systematic analysis of equilibrium 35
titrations
approximate view 49–52
buffer region 50–51
effect of ionic strength/activity
coefficients 61–62
end point 51–52
an exact solution 52–55
exploration of diprotic 72–77
initial H 49–50
pH as function of volume 56–57
root finding 56–57
using sapply with uniroot to solve for
titration curve 57–60
of weak acid 49
T test 19–21
uniroot command 36, 49
unlist command 101
UV-Vis spectroscopy, Beer’s law for 23
validation method 33
vectors and numerics 2–7
waves, sound 83
weak acid, titrations of 49
writing data files 8–10
