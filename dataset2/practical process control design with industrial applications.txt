Practical Process Control Design with Industrial Applications
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons LicensePractical Process Control Design with
Industrial Applications
Alan M. Kugelman
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons LicenseCopyright © 2024 by John Wiley & Sons, Inc. All rights reserved, including rights for text and data mining and
training of artificial technologies or similar technologies.
Published by John Wiley & Sons, Inc., Hoboken, New Jersey.
Published simultaneously in Canada.
No part of this publication may be reproduced, stored in a retrieval system, or transmitted in any form or by any
means, electronic, mechanical, photocopying, recording, scanning, or otherwise, except as permitted under Section
107 or 108 of the 1976 United States Copyright Act, without either the prior written permission of the Publisher, or
authorization through payment of the appropriate per-copy fee to the Copyright Clearance Center, Inc., 222
Rosewood Drive, Danvers, MA 01923, (978) 750-8400, fax (978) 750-4470, or on the web at www.copyright.com.
Requests to the Publisher for permission should be addressed to the Permissions Department, John Wiley & Sons,
Inc., 111 River Street, Hoboken, NJ 07030, (201) 748-6011, fax (201) 748-6008, or online at http://www.wiley.com/
go/permission.
Trademarks: Wiley and the Wiley logo are trademarks or registered trademarks of John Wiley & Sons, Inc. and/or
its affiliates in the United States and other countries and may not be used without written permission. All other
trademarks are the property of their respective owners. John Wiley & Sons, Inc. is not associated with any product
or vendor mentioned in this book.
Limit of Liability/Disclaimer of Warranty: While the publisher and author have used their best efforts in preparing
this book, they make no representations or warranties with respect to the accuracy or completeness of the contents
of this book and specifically disclaim any implied warranties of merchantability or fitness for a particular purpose.
No warranty may be created or extended by sales representatives or written sales materials. The advice and strategies
contained herein may not be suitable for your situation. You should consult with a professional where appropriate.
Further, readers should be aware that websites listed in this work may have changed or disappeared between when
this work was written and when it is read. Neither the publisher nor authors shall be liable for any loss of profit or
any other commercial damages, including but not limited to special, incidental, consequential, or other damages.
For general information on our other products and services or for technical support, please contact our Customer
Care Department within the United States at (800) 762-2974, outside the United States at (317) 572-3993 or fax (317)
572-4002.
Wiley also publishes its books in a variety of electronic formats. Some content that appears in print may not be
available in electronic formats. For more information about Wiley products, visit our web site at www.wiley.com.
Library of Congress Cataloging-in-Publication Data:
Names: Kugelman, Alan M., author.
Title: Practical process control design with industrial applications / Alan
M. Kugelman.
Description: Hoboken, New Jersey : Wiley, [2024] | Includes index.
Identifiers: LCCN 2024008989 (print) | LCCN 2024008990 (ebook) | ISBN
9781394246496 (cloth) | ISBN 9781394246519 (adobe pdf) | ISBN
9781394246502 (epub)
Subjects: LCSH: Process control.
Classification: LCC TS156.8 .K855 2024 (print) | LCC TS156.8 (ebook) |
DDC 660/.2815–dc23/eng/20240315
LC record available at https://lccn.loc.gov/2024008989
LC ebook record available at https://lccn.loc.gov/2024008990
Cover Design: Wiley
Cover Image: Courtesy of Alan M. Kugelman
Set in 9.5/12.5pt STIXTwoText by Straive, Chennai, India
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons Licensev
Contents
Preface xiii
1 Process Dynamics and Process Control Overview 1
1.1 Introduction 2
1.2 The Role of Process Control 3
1.3 Tag Naming Conventions 4
1.3.1 Tag Naming in Process Overview/Control Strategy Drawings 5
1.3.2 Process Overview/Control Strategy Drawing Conventions 6
1.4 Control Loop Essentials 7
1.4.1 The Feedback Control Loop 8
1.4.2 Control Loop Hardware 10
1.4.3 Control Loop Examples 10
1.4.4 Controller Modes 12
1.4.5 Open-loop Stable and Unstable Control Loops 12
1.5 Process Dynamics and Dynamic Responses 14
1.5.1 Representation of Process Dynamics: Process Response Curves 15
1.5.2 First-Order Linear Continuous Model 17
1.5.3 Transfer Function Representation 22
1.5.4 First-order Linear Discrete Model 23
1.6 Plant Testing 25
1.6.1 Objectives 25
1.6.2 Work Process 25
1.6.3 In Process Control 26
1.7 Classification of Process Control Strategies 28
1.7.1 Control Strategy Hierarchy: Relative Costs, Resources, and Credits 28
1.7.2 Safety Protection 30
1.7.3 Basic Regulation: Basic Regulatory Control 30
1.7.4 Advanced Regulation: Advanced Regulatory Control 31
1.7.5 Supervisory Control: Conventional Advanced Control Applications 34
1.7.6 MVCC and RTO: Advanced Control Applications 37
1.8 Benefits of Control Applications 41
References 43
2 Feedback Control Essentials 44
2.1 Introduction 45
2.2 Single Loop Control, Simple, and Complex Cascades 46
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons Licensevi Contents
2.3 Digital Control System (DCS) Work Environment 50
2.3.1 Control System Data Base Organization 50
2.3.2 PV Processing 51
2.3.3 Control Processing 52
2.3.4 Output Processing 53
2.3.5 Alarming 54
2.3.6 Limit Checking and Clamping 55
2.3.7 Operator Interface 55
2.3.8 History, Reports, and Trending 56
2.4 PID Control Algorithm Basics 57
2.4.1 Discrete Version of the PID 59
2.4.2 PID Control Direction 63
2.4.3 Output Direction and Control Valve Failure Mode 65
2.4.4 Proportional, Integral, and Derivative Control Contributions 67
2.4.5 PID Control Algorithm Options 71
2.4.6 PID and Cascade Initialization 76
2.4.7 PID Tuning 82
2.4.8 Tuning Cascaded Controllers 92
2.5 Noise, Filters, Plant Testing, and Closed-Loop Control 93
2.5.1 Signal-to-Noise Ratio 94
2.5.2 Filtering 95
2.5.3 Linear Exponential Filter Algorithm 96
2.6 Ratio Control 97
2.6.1 Ratio Controller Benefits 99
2.6.2 Ratio Control and Noise 101
2.6.3 Ratio Controller Initialization 102
2.7 Single Input–Single Output Model-Based Control (MBC) 104
2.7.1 Structure of the Model-Based Control Strategy 104
2.7.2 Tuning the Model-Based Controller 108
2.7.3 Filtering the “Raw” Bias 108
2.7.4 CV Set Point Response 109
2.7.5 Load Variable Response 111
2.8 Cascade Wind-up 112
2.8.1 What Causes Cascade Wind-up 113
2.8.2 Output and Set Point Clamps 114
2.8.3 Wind-up Directions 115
2.8.4 Wind-up Protection 118
References 119
3 Feedforward Control Essentials 120
3.1 The Role of Feedforward Control 120
3.2 Ratio Control and Steady-State Feedforward Control 124
3.3 Dynamic Compensation via the Lead-Lag Algorithm 126
3.4 Ratio Control and Dynamic Feedforward Control 130
3.5 Incremental Steady-State Feedforward Control 133
3.6 Incremental Dynamic Feedforward Control 137
3.7 Engineering Relationships That Provide Feedforward Corrections 141
3.7.1 Tower Reboiler Duty Control 142
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons LicenseContents vii
3.7.2 Tower Internal Reflux Control 145
3.7.3 Pressure Compensation of Tower Temperature 149
References 154
4 Process Analysis and Understanding 155
4.1 Business Drivers, Operating Plans, and Operational Objectives 156
4.2 Obtaining Useful Information 156
4.2.1 Interactions with Operators 156
4.2.2 Plant Testing 157
4.2.3 Technical Support from Process Engineering Specialists 157
4.2.4 Economic Support from Planning/Coordination Staff 157
4.3 Use of Process Analysis 158
4.3.1 Identifying Basic Regulatory Control Enhancements 159
4.3.2 Identifying Constraints and Disturbances 162
4.3.3 Identifying Feedforward Control Opportunities 165
4.3.4 Identifying Control Loop Interactions and Their Consequences 168
4.3.5 Identifying CVs, MVs, and DVs for Light-ends Tower Product Quality
Controls 174
5 Split Range Control 178
5.1 Split Range Control Overview 178
5.2 Split Range Control Applications 181
5.2.1 Hot Oil Heater Feed Surge Drum Pressure Control 181
5.2.2 Reactor Feed Surge Drum Pressure Control 183
5.2.3 Alkylation Plant Iso-Stripper Tower Overhead Pressure Control 185
5.2.4 Propylene Splitter Differential Pressure Control 187
5.2.5 Catalytic Reformer Discharge Pressure/Treat Gas System Pressure
Control 190
5.2.6 Tower Inlet Temperature Control 192
6 Override Control 195
6.1 Override Control Overview 195
6.2 Override Control Applications 198
6.2.1 Fractionator Sidestream Stripper Bottoms Level Control Override 199
6.2.2 Crude Distillation Unit (CDU) Overhead Quality Control with High-Pressure
Override 201
6.2.3 CDU Overhead Quality Control with Low-Level Override 203
6.3 From Override Control to Conventional Constraint Control 205
7 Conventional Constraint Control 208
7.1 DMC’s Role in Multivariable Constraint Control 209
7.2 Introduction to Conventional Constraint Control 210
7.3 Natural Draft Heater Combustion Control via Conventional Constraint Control 210
7.3.1 CVs, the MV, and CV–MV Relationships 212
7.3.2 CV Controller Output – MV Relationships 212
7.3.3 Choosing the Controller Output and the Active Constraint Variable 215
7.3.4 Signal Selector Configuration 217
7.4 Maximizing Heat Recovery 218
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons Licenseviii Contents
7.4.1 CVs, the MV, and CV–MV Relationships 221
7.4.2 CV Controller Output – MV Relationships 221
7.4.3 Choosing the Controller Output and the Active Constraint Variable 223
7.4.4 Signal Selector Configuration 225
7.5 Conventional Constraint Control Cascade Structure 226
7.6 Alternate Signal Selector Locations in Constraint Control Designs 228
7.7 Active Constraint Variable Switches 231
7.8 Constraint Control Design Issues 233
8 Design Considerations 236
8.1 First Steps: Process Understanding and Operating Objectives 237
8.2 Basic Control Attributes, Control Options 238
8.2.1 PID Control or Model-based Control (Section 2.7) 238
8.2.2 PID, PI, or I-only Control (Section 2.4.1) 239
8.2.3 PID Control Direction (Section 2.4.2), and Output Direction
(Section 2.4.3) 239
8.2.4 PID Proportional Action on Error or PV (Section 2.4.5) 240
8.2.5 PID Derivative Action on Error or PV (Section 2.4.1) 241
8.2.6 Set Point Initialization (Section 2.4.6) 241
8.2.7 SP Clamps or Output Clamps (Section 2.8.2) 241
8.2.8 Filter PV or No Filter (Section 2.5) 242
8.2.9 Cascade Usage (Section 2.2) 242
8.2.10 Feedforward Control Opportunities (Sections 3.2–3.4 and 3.7) 243
8.3 Standard DCS Functionality 243
8.4 Corporate and Site Standards 244
8.4.1 Corporate Developed and Supported Control Packages 244
8.4.2 Site Developed and Supported Control Packages 245
8.4.3 Schematic Display Standards 245
8.5 Sample Time, Control Frequency and Controller Scheduling 246
8.6 Calculated Control Variables 246
8.7 Inferential Variables 247
8.7.1 Updating an Inferential Model’s Bias Using an Analyzer Measurement 249
8.7.2 Updating an Inferential Model’s Bias Using Laboratory Data 250
8.8 Input Validation 252
8.9 Flow Compensation 258
8.10 Cascade Initialization and Wind-up Protection 259
8.11 Alarming and Operator Messaging 260
8.12 Interactions with Other Control Strategies 261
8.12.1 Two-Product Light-ends Tower Quality Control 262
8.12.2 Heat Integrations 262
8.13 Testing to Judge Control Strategy Acceptability 263
References 264
9 Level Control 265
9.1 Introduction 265
9.2 Single Loop Level Control 266
9.3 Light-ends Tower Inventory Control 268
9.3.1 Two Product Towers 268
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons LicenseContents ix
9.3.2 Towers with One Sidestream 270
9.4 Level Controllers that Manipulate Multiple Flows 273
9.4.1 Manipulated Flows are Unmeasured 273
9.4.2 Manipulated Flows are Measured 276
9.5 More Complex Level Control Applications 277
9.5.1 Reactor Quench Flow Hold-up Drum Inventory Control with Secondary
Switch 277
9.5.2 Reactor Feed Drum Inventory Control with Multiple Feed Sources 279
9.5.3 Reactor Feed Rate and Feed Mix Control 283
9.6 Averaging and Tight Level Controller Tuning 286
9.6.1 Light-ends Towers: Distillate Flow on Level Control 287
9.6.2 Light-ends Towers: Reflux Flow on Level Control 287
9.6.3 Feed Surge Drums 288
9.6.4 Fractionator Sidestream Stripper Bottoms Level Control 289
9.6.5 Fractionator Bottoms Level Control 290
References 290
10 Heat Input/Heat Removal Controls 291
10.1 Introduction 291
10.1.1 Heat Input/Heat Removal in a Light-ends Tower 292
10.1.2 Heat Utilization in Fixed Bed Catalytic Reaction System 293
10.1.3 Crude Preheat, Heat Integration, and Crude Distillation Unit (CDU) Heat
Utilization 293
10.2 Feed Preheat Controls 295
10.2.1 Reactor Feed Surge Drum Inlet Temperature Control 295
10.2.2 Chloride Treater Inlet Temperature Control 300
10.2.3 Reactor Preheat Exchanger Duty Control 302
10.2.4 Product Stripper Inlet Temperature Control 306
10.3 Control Strategies in Heat Integrated Units 311
10.3.1 Crude Distillation Unit (CDU) Sidestream Stripper Overhead Temperature
Control 312
10.3.2 Deethanizer Tray Temperature (Bottoms Quality) Control 315
10.3.3 Cat Naphtha Splitter Reboiler Duty Control 319
10.4 Fired Heater Firing Controls 323
10.4.1 Fired Heater Basics 324
10.4.2 Process Variable and Calculated Variable Summary 325
10.4.3 Basic COT Regulatory Control 327
10.4.4 Ratio Feed Rate Feedforward Control 329
10.4.5 Feedforward Control for Both Feed Rate and CIT 331
10.4.6 BTU Control: Feedforward Corrections for Fuel Gas Heating Value
Upsets 334
10.4.7 BTU Control with Combined Feed Rate and CIT Feedforward Control 336
10.4.8 Dual Fuel Fired Heaters: Importance of BTU Control 337
Reference 338
11 Energy Conservation Controls 339
11.1 Heat Recovery Maximization 340
11.1.1 Crude Fractionator Feed Preheat 340
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons Licensex Contents
11.1.2 Flow Distribution to Parallel Heat Exchangers 349
11.1.3 Catalytic Reformer Reactor Effluent Heat Utilization 352
11.1.4 Distillate Hydrofiner Reactor Effluent Heat Utilization 354
11.2 Lowering Fired Heater Stack Excess O2 Targets 357
11.2.1 Combustion Control Air Side Measurements 359
11.2.2 Natural Draft Heater Combustion Control 361
11.2.3 Forced Draft Heater Combustion Control 363
11.3 Reducing Tower Reboiler Duty and Reflux Flow 370
11.3.1 Crude Light-ends Section: Naphtha Splitter Fractionation Control 372
11.3.2 Aromatics Plant: Toluene Tower Fractionation Management 377
11.3.3 Light-ends Tower Pressure Minimization 381
11.4 Reducing Stripping Steam Utilization 383
11.4.1 Primary Fractionator (CDU) Bottoms Product Steam Stripping 383
11.4.2 Primary Fractionator (CDU) Sidestream Steam Stripping 386
11.4.3 Sour Water Steam Stripping 388
11.5 Reducing Steam Consumption in Amine Gas Treating Units 391
11.5.1 Scrubber and Regenerator Controls 393
11.5.2 Kerosene Hydrofiner Treat Gas Scrubber Feed Minimization 395
11.6 Reducing Reactor Treat Gas, Recycle Gas Flows 397
11.6.1 Gas Oil Hydrofiner Reactor Treat Gas and H2 Make Gas Minimization 397
11.6.2 Catalytic Reformer Reactor Recycle Gas Minimization 402
11.6.3 Naphtha Hydrofiner Reactor Treat Gas and H2 Make Gas Minimization 405
References 409
12 Tower Product Quality Controls 410
12.1 Tower Basics 412
12.2 Two-product Towers – Process Variable Summary 412
12.2.1 MVs, CVs, DVs, and Calculated Variables 413
12.2.2 CV–MV Pairings 417
12.2.3 Key Components and Separation 418
12.3 Two-product Towers – Common Product Quality Control CV–MV Pairs 419
12.3.1 Dual-product Quality Control 420
12.3.2 Control of One Product Quality 422
12.3.3 Towers with a Partial Condenser and an Overhead Vapor Product 423
12.3.4 Towers with Drumless Flooded Condensers 425
12.4 Towers with Sidestream – Process Variable Summary 427
12.4.1 MVs, CVs, DVs, and Calculated Variables 428
12.4.2 CV–MV Pairings 430
12.4.3 Key Components and Separation 431
12.5 Towers with Sidestream – Common Product Quality Control CV–MV Pairs 432
12.6 Cutpoint, Fractionation, and Their Impact on Tower Operations 435
12.6.1 Tower Cutpoint 435
12.6.2 Feed Composition Changes and Cutpoint 438
12.6.3 Tower Fractionation 439
12.7 Two-product Towers – Overview of Conventional Advanced Control
Applications 443
12.7.1 Conventional Advanced Product Quality Control with MV =Reboiler
Duty 444
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons LicenseContents xi
12.7.2 Fractionation Management with MV =Reflux Flow 445
12.7.3 Conventional Advanced Product Quality Control with MV = Reflux
Flow 447
12.7.4 Fractionation Management with MV = Reboiler Duty 450
12.7.5 Conventional Advanced Product Quality Control with MV = Distillate
Rate 451
12.7.6 Other Product Quality Strategies 453
12.8 Towers with Sidestream – Overview of Conventional Advanced Control
Applications 453
12.8.1 Conventional Distillate and Bottoms Advanced Product Quality
Control 454
12.8.2 Conventional Sidestream Advanced Product Quality Control 454
12.8.3 Fractionation Management 455
12.8.4 Fractionation Management with Product Quality Control Override 459
12.9 Two-product Towers – Conventional Advanced Control Application Examples 463
12.9.1 Crude Light-ends Section Tower Controls 464
12.9.2 Alternative Crude Light-ends Section – Catalytic Reformer Feed Debutanizer
(T-542) Controls 474
12.9.3 Benzene/Toluene/Xylene (BTX) Feed Fractionation Section Tower
Controls 479
12.9.4 Benzene/Toluene/Xylene (BTX) Product Fractionation Section Tower
Controls 483
12.10 Towers with Sidestream – Conventional Advanced Control Application
Examples 485
12.10.1 Crude Light-ends Section Naphtha Splitter Controls 485
12.10.2 Reformer Light-ends Section Reformate Stabilizer Controls 488
12.10.3 BTX Product Fractionation Section: Benzene Tower Controls 493
References 496
13 Fractionator Product Quality Control 497
13.1 Fractionator Unit Characteristics 499
13.1.1 Distillate, Bottoms, and Multiple Sidestream Products 500
13.1.2 Heat Removal via Multiple Pumparounds 500
13.1.3 Feed Preheat, Cooling, and Heat Integrations 502
13.1.4 Bottoms Stripping Steam and Sidestream Steam Strippers 503
13.1.5 Control Interactions 505
13.2 Feed True Boiling Point (TBP) Distillation Curve, Cutpoint, and Fractionation 505
13.2.1 Feed TBP Distillation Curve 506
13.2.2 Tower Cutpoint 507
13.2.3 Tower Fractionation 512
13.3 Crude Distillation Unit, CDU – The Most Important Primary Fractionator 515
13.3.1 Process Variable Summary 515
13.3.2 Control Basics and CV–MV Interactions 519
13.3.3 Overview of Conventional CDU Advanced Product Quality Control 520
13.3.4 Conventional Energy Conservation (ENCON) Controls 529
13.3.5 Example CDU Conventional Advanced Control Applications 532
13.4 Reactor Effluent Product Separation Section Main Fractionators 541
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons Licensexii Contents
13.4.1 Gasoil H/F Main Fractionator Gas Oil Sulfur Control and Yield
Maximization 541
13.4.2 FCCU Main Fractionator ICN 95% Point Control, Pumparound Duty
Management 548
14 Reactor Conversion Control 554
14.1 Reactor Control Fundamentals 555
14.1.1 Heat of Reaction 556
14.1.2 Rate of Reaction – Effects of Composition and Temperature 556
14.1.3 Heat and Mass Transfer Effect on Reaction Rate 557
14.1.4 Catalyst Activity, Catalyst Deactivation, and Catalyst Run Length 558
14.1.5 Treat Gas and Hydrogen Partial Pressure 560
14.1.6 Residence Time, Space Velocity, and Throughput Control 563
14.1.7 Reactor Feed Mix Control 563
14.2 Reactor System Unit Configurations 564
14.2.1 Feed Preparation Section 564
14.2.2 Feed Preheat Section 566
14.2.3 Reactor Section 569
14.2.4 Reactor Effluent Cooling and Product Separation Section 579
14.3 Reactor System Control Objectives, CVs, MVs, and DVs 581
14.3.1 Reactor System CVs 582
14.3.2 Reactor System MVs 583
14.3.3 Reactor System DVs 583
14.3.4 Bottom Line: Effective Reactor Control is Difficult to Achieve 583
14.4 Conventional Reactor Advanced Control Applications 584
14.4.1 Diesel Hydrofiner Effluent Sulfur Control 584
14.4.2 Gas Oil Hydrofiner R-535 Conversion Control 590
14.4.3 Hydrodesulfurization (HDS) R-725 A/B/C Conversion Control 598
14.4.4 Naphtha Hydrofiner Reactor R-135 Partial Pressure Control 605
14.4.5 Gas Oil Hydrofiner (R-305) Product Stripper Tower (T-307) Bottoms Quality
Control, Inlet Temperature Maximization 608
References 613
Index 615
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons Licensexiii
Preface
Practical Process Control Design with Industrial Applications presents process control essentials
and control strategy design fundamentals that are applicable to modern-day digital control
system (DCS) work environments. To provide a realistic framework to better understand and use
these fundamentals more effectively, many authentic industrial control application designs are
presented and discussed. To make the book’s content more beneficial to control engineers and
process engineers who support in-plant process control activities, process control practices and
design fundamentals are applied in a wide variety of unit operations.
The book’s control strategy design discussions are intended to be independent of specific DCSs.
Instead, the focus is on the control strategy’s cascade structure, its inherent functionality, and its
relationship to unit operating objectives. No matter the DCS, the use of standard DCS functionality,
i.e., standard algorithms and/or function blocks, is emphasized. Given the author’s wide-ranging
experiences over the years with Honeywell hardware and software, the DCS functionality assumed
to be standard and the functionality assumed to be nonstandard mirror that Honeywell experience.
However, references to the DCS control environment, DCS functionality, and control strategy
structures and configuration have been kept as generic as possible to allow these basic concepts
to be understood by practicing control engineers working in other DCS environments. Where
user-provided custom code and/or configuration is required to furnish nonstandard functionality,
descriptions of the logic and calculations are provided, but coding and configuration details, which
would obviously be DCS specific, are not.
The book’s target audience is control engineers and process engineers who support process con￾trol activities in an operating plant, and project engineers who support process control activities
in capital projects and DCS modernization projects. This includes operating company, DCS ven￾dor, and engineering, procurement, and construction (EPC) company personnel. For the target
audience, the book provides these major benefits:
● A better understanding of control strategy design fundamentals. The many realistic control strat￾egy designs presented for a wide variety of unit operations provide a practical framework for
understanding essential process control fundamentals.
● Methods that increase control strategy robustness. Methods are presented to manage numerous
“what if” design issues that increase control strategy robustness and ensure acceptable control
performance continues.
● Effective control strategy designs for a variety of common unit operations. Unit-specific con￾trol strategy designs for many common, industrial important process units are presented and
discussed.
The book is not intended to be a university level process control textbook. That need is filled by
many excellent texts that present control fundamentals with underlying theory and mathematical Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons Licensexiv Preface
details. However, clearly missing from the current mix of process control textbooks are discussions
of control strategy designs that link realistic process unit operating objectives to the strategy’s con￾trol objectives. Also absent is how control design fundamentals are applied in typical modern-day
DCS work environments. Thus, this book’s focus is on control strategy designs that emphasize the
use of standard DCS functionality and achieve control objectives in industrially important process
units.
With this focus, the important roles of process analysis and process understanding are empha￾sized when operating and control objectives are identified and control strategies designed. Because
process understanding is so essential to a control strategy’s design, a P&ID type drawing of the
process unit’s configuration is included for each control application and is an integral part of the
application’s discussion. A second drawing shows (i) the control strategy’s conceptual design, e.g.,
the components that provide the required control functionality to achieve the control objectives
and (ii) the control cascade’s structure, e.g., how the control components are logically ordered and
linked from ultimate secondary to ultimate primary.
The process control essentials, control strategy design fundamentals, and realistic control
applications presented and discussed make the book a prime process control reference. The book
also provides abundant source material for operating company in-house process control training
courses, and DCS vendor and EPC in-house or customer-focused training courses. And, although
not in the book’s target audience, if a chemical engineering faculty member wants to incorporate
realistic control strategies into an undergraduate or graduate level process control course, the book
provides a wide variety of control applications that illustrate how process control fundamentals
are applied to develop real-world solutions to real-world control problems.
The book’s use of process analysis and process understanding to help identify operating and
control objectives and design control strategies is a unique, otherwise unavailable instructional
approach to process control. The book applies process control design fundamentals in these impor￾tant unit-specific control strategies:
● Reactor feed drum and surge drum inventory controls
● Tower and reactor feed preheat control strategies implemented in highly heat-integrated units
● Tower, fractionator, and reactor control strategies that reduce energy consumption
● Fired heater firing and combustion control strategies
● Distillation tower product quality controls and fractionation management, with and without a
sidestream
● Primary and main fractionator product quality control strategies that must run in a multivariable
and interactive operating environment
● Fixed bed catalytic reactor conversion control strategies that manage temperature effects, catalyst
deactivation, and reactor feed/product heat integrations
In addition to traditional process control topics, in-depth discussions of the following real-world
design issues, covered superficially (if at all) in other process control textbooks, are included and
emphasized. And where appropriate, an enhanced understanding of the issue's role in control strat￾egy design is provided by realistic control strategy examples.
● The discreet PID control algorithm’s controlled variable (CV) and manipulated variable (MV)
engineering range and percentage of range conversions, its initialization, its configuration
options, and option choices for specific control needs
● The relationships among an ultimate secondary’s PID control direction, its control output
characteristic, its A/O block’s output direction, a valve characteristic, and the valve’s failure
mode
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons LicensePreface xv
● A ratio controller’s configuration options, its initialization, how it provides steady-state and
dynamic ratio feedforward control, and how it manages unavailable and invalid feedforward
inputs
● Ensuring bumpless cascade initialization – with no final control element (e.g., valve) movement
on the initialization pass, and how initialization status is transmitted upward in a cascade from
any secondary to the ultimate primary
● Ensuring control strategies are commissioned and decommissioned bumplessly
● Controller and cascade wind-up, wind-up protection, wind-up direction and its resolution, and
how wind-up status is transmitted upward in a cascade from any secondary to the ultimate
primary
● Commissioning and decommissioning feedforward control without affecting feedback control
● Validating unreliable measured and calculated inputs used in a control calculation
● Ensuring feedback control is unaffected when feedforward control inputs are declared invalid or
become unavailable, and when inputs return valid or become available again
● Ensuring control strategy robustness when any control input is declared invalid or returns valid
Note that there can be more than one control strategy design that in principle can achieve the
control objectives that are identified. This can be true even if the preferred design is developed
using recommended approaches – careful process analysis, real-time operations monitoring, anal￾ysis of operational history, and/or discussions with process technical and operations personnel. A
conclusive judgment on a preferred design’s suitability can be made only after its design features
are built/loaded in the DCS and carefully tested, first offline, and then online interfaced to process
operations. Its online performance must be monitored, its control performance evaluated, and
there must be confirmation that the control objectives are achieved.
The specific, realistic control strategy design examples presented and discussed in this book have
not undergone direct offline or online DCS testing. However, extensive in-plant experiences over
many years confirm their acceptability and suitability for the unit configurations considered. But
appropriate alternative conventional advanced control designs may exist. Therefore, when a control
strategy’s design is discussed, and performance uncertainties are identified, other approaches that
may improve performance are described, e.g., the use of model-based control to better manage dead
times.
At times, more advanced controls may be appropriate, e.g., DMC to better manage multivariable
and interactive responses, and RTO to help clarify and manage complex energy – yield trade-offs in
real-time. However, the complexity of the advanced control technology underlying both DMC and
RTO is well beyond this book’s focus and scope, and neither DMC nor RTO application designs are
considered. Nevertheless, for any conventional advanced control application considered, if process
scenarios suggest a potential need for either DMC or RTO, they are identified and discussed.
Annapolis, Maryland Alan M. Kugelman
June, 2024
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1
1
Process Dynamics and Process Control Overview
CHAPTER CONTENTS
1.1 Introduction
1.2 The Role of Process Control
1.3 Tag Naming Conventions
1.3.1 Tag Naming in Process Overview/Control Strategy Drawings
1.3.2 Process Overview/Control Strategy Drawing Conventions
1.4 Control Loop Essentials
1.4.1 The Feedback Control Loop
1.4.2 Control Loop Hardware
1.4.3 Control Loop Examples
1.4.4 Controller Modes
1.4.5 Open-loop Stable and Unstable Control Loops
1.5 Process Dynamics and Dynamic Responses
1.5.1 Representation of Process Dynamics: Process Response Curves
1.5.2 First-Order Linear Continuous Model
1.5.3 Transfer Function Representation
1.5.4 First-order Linear Discrete Model
1.6 Plant Testing
1.6.1 Objectives
1.6.2 Work Process
1.6.3 In Process Control
1.7 Classification of Process Control Strategies
1.7.1 Control Strategy Hierarchy: Relative Costs, Resources, and Credits
1.7.2 Safety Protection
1.7.3 Basic Regulation: Basic Regulatory Control
1.7.4 Advanced Regulation: Advanced Regulatory Control
1.7.5 Supervisory Control: Conventional Advanced Control Applications
1.7.6 MVCC and RTO: Advanced Control Applications
1.8 Benefits of Control Applications
References
While process unit design is based on steady-state principles and relationships, the process unit’s
operating environment is dynamic, characterized by changing feedstocks, unexpected upsets,
equipment failures, changing operating directives, and the need to satisfy constraints, some of
which are time-dependent. Maintaining plant operations at desired targets, meeting changing
operating objectives, eliminating the effects of process upsets, and maintaining operations
within and at constraint limits is the domain of process control. Process dynamics refers to the
dynamic relationships among process variables (PVs) that determine the process’ time-dependent
response to routine operator adjustments, unexpected upsets, hardware failures, and transitions
Practical Process Control Design with Industrial Applications, First Edition. Alan M. Kugelman.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2 1 Process Dynamics and Process Control Overview
to new operations. Process dynamics understanding plays an essential role in the design and
implementation of process control strategies.
1.1 Introduction
This chapter begins with an explanation of how important components of the feedback control
loop – measured inputs, calculated inputs, control loops, and calculated control outputs – are ref￾erenced in a modern Digital Control System (DCS). All such entities are assigned a name, made up
of alphanumeric characters, and the name assigned to each entity is called itstag name. Throughout
the book, standardized drawings are used to present process unit configurations and control strat￾egy cascades, with control relevant components identified by their tag names. This corresponds to
real-world project documentation used by operating sites, engineering, procurement and construc￾tion (EPC) contractors and DCS vendors. Therefore, to serve as future references, the tag naming
and drawing conventions are described and summarized.
The control loop is the basic unit of process control. Generic feedback control loops are pre￾sented to illustrate the relationships among a control loop’s control variable (CV), manipulated
variable (MV), and disturbance variable (DV). Several control loop examples (flow, pressure, and
level controllers) are presented, and the important role of controller mode is explained.
A dependent variable’s (e.g., a CV) time-domain dynamic response to a change in an independent
variable (e.g., an MV or DV) has characteristics (steady-state gain, KP, time-to-steady-state [TTSS],
time constant, 𝜏, and deadtime, 𝜃) that are relevant to process understanding, control strategy
design, and future control performance. A generic dependent variable’s dynamic response to a step
change in an independent variable is used to illustrate the physical significance and importance of
KP, TTSS, 𝜏, and 𝜃, and simple graphical procedures are presented to illustrate how these model
parameters are estimated. These parameters are used throughout this chapter to explain the
fundamentals of process dynamics and in subsequent chapters to guide control strategy designs.
In a modern DCS, data is sampled at a fixed frequency and process information is known only
at discrete times, making classical time-domain approaches invalid. Therefore, the discrete equiva￾lent of the time domain’s response curve – a recursive difference equation that contains dependent
and independent variable values at specific time steps (but with the same model parameters) is
presented and discussed. This discussion facilitates the understanding of the discrete PID (propor￾tional, integral, derivative) control algorithm and its basic functionality presented in Section 2.4
and the discrete linear exponential filter presented in Section 2.5.
Plant tests are performed to increase understanding of dynamic relationships among process vari￾ables (PV) and/or to identify a specific response’s dynamic parameters. Although simple graphical
procedures are presented to illustrate how KP, TTSS, 𝜏, and 𝜃 are estimated, commercially avail￾able statistical curve-fitting tools are far more effective compared to graphical methods at obtaining
accurate model parameter values. These methods are described qualitatively, with the important
role of the residual (the difference between predicted and measured PV values at each time step)1
explained.
Process control strategies are categorized (via five “Levels”) based on control need – safety protec￾tion is the most important need (Level 1), followed by basic regulatory controls (Level 2), advanced
regulatory controls (Level 3), conventional supervisory controls (Level 4), and advanced control
applications, e.g., dynamic matrix control (DMC), RTO (Level 5). Although the focus of this book
is the design of control strategies at Levels 3 and 4, the control functionality each level provides is
summarized and illustrated with industrially important applications.
1 In the discussion of model-based control in Sections 2.7, model error and prediction error are related to residuals.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.2 The Role of Process Control 3
Finally, how control strategies improve process control performance and capture credits is
described – by reducing a CV’s variability, operations can be moved closer to a product specifica￾tion or constraint limit. However, unless operations are actually moved closer to the specification
or constraint limit by a CV set point change, the bulk of the potential benefits are lost.
1.2 The Role of Process Control
The non-steady-state nature of refinery and chemical plant operations makes process control an
essential requirement for successful plant operations. Process units are designed to operate at a
set of desirable steady state operating points within an expected operating region or “window.”
Steady-state material and energy balances, physical models of unit operations, thermodynamic
relationships, and design correlations are used in unit designs. Typically, multiple cases are con￾sidered in the unit’s design, e.g., winter and summer operations, catalyst start-of-run/end-of-run
status, various feed rates and feed types, and several desired products and product qualities.
Various process, equipment, thermodynamic, physical and/or chemical equilibrium, safety, and
environmental constraints bound unit operations to a set of feasible states – the operating
window. The first task for well-designed and well-tuned process control strategies is to hold
plant operations at desired operating points within the operating window despite unexpected
process upsets/disturbances, e.g., feed composition and temperature changes, fuel gas composition
changes, instrument and other hardware failures, weather upsets, process equipment failures, and
operator errors. Profitable operations typically include many PVs at high or low constraint limits.
Therefore, process control strategies, designed to meet control and operating objectives, must also
safely respect multiple process constraints.
With plant operations at a desired operating point within the operating window, operators
will frequently make routine changes in some units. Examples of common, routine changes are
(i) relieve bottlenecks (e.g., full open valve, condenser cooling limitation), (ii) change unit feed
rates, (iii) increase reactor feed preheat to increase feed temperature or increase reactor treat
gas/feed ratio to increase reactor conversion, and (iv) change a light-ends tower’s reboiler steam
flow rate or its reflux flow rate to help bring product quality back to target. The plant’s dynamic
responses to typical process adjustments depend directly upon the performance of the plant’s suite
of underlying process control strategies. Thus, process control strategies must effectively manage
routine operator adjustments as process conditions change and/or as new limiting constraints
become active.
Profit varies within the operating window. Therefore, as business drivers change, there are
incentives to identify the process conditions within the operating window that align the plant’s
operations with the new economics. The business team, which includes site planners and coor￾dinators, typically employs a variety of offline tools to analyze the impact of business drivers on
plant operations. The business team, with input from site operations, maintenance, and technical
personnel, develops an operating plan. The plan contains a set of operating objectives and the new
set of process conditions that will achieve the new operating objectives. Important information
specified includes new flow, temperature and pressure targets, desired products and their qualities,
potential limiting constraints, PV high/low limits, feed and product tank IDs, and equipment to
place in or take out of service. Business plans are typically provided weekly or more frequently if
needed to account for unforeseen economic changes.
Process control is essential for operators to guide the plant’s transition to the new, desired opera￾tion in a smooth and stable manner in a reasonable timeframe while honoring process constraints.
Operators make the necessary process adjustments (e.g., changes to controller set points and PV Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License4 1 Process Dynamics and Process Control Overview
high/low constraint limits) via the DCS operator’s console; some manual changes to field hardware
may also be needed. The plant’s transition to the new operating point is monitored using the DCS’
operator interface.
In summary, the primary role of process control is to accomplish the following tasks:
● Hold plant operations at the current, desired operating point despite unexpected upsets/
disturbances.
● Provide smooth, fast, and safe transitions from one operation to another when (i) routine operator
adjustments are made as some process conditions and/or limiting constraints change and (ii) the
business team issues a new operating plan that must be implemented.
● Keep plant operations on the safe side of limiting constraints.
1.3 Tag Naming Conventions
Section 1.4 below will reveal that measured inputs, calculated inputs, control loops, and calculated
control outputs are all important components of the feedback control loop. These feedback loop
components are all assigned names in the DCS; the name assigned to each is called its tag name.
As used in this book, tag names have the following general format2:
SRCxyz
where
SRC – service code
xyz – numerical identifier
The service code is either two or sometimes three alphabetic characters. The first character indi￾cates the tag’s PV input source type – for example, F means flow and Q means heat duty. The service
code’s second character indicates the tag’s function – for example, C means controller. The third
character in the service code is optional and is used infrequently. But when it is used, it indicates the
special task associated with the tag – for example, V means validation. Table 1.1 lists the characters
used and what they represent. Here are some examples:
FI89 – Measured flow input
LI9 – Measured level input
PC134 – Pressure control loop
TC387 – Temperature control loop
TV3873 – TC387 sends its output (% range) to this valve
AIV243 – Analyzer measurement (AI243) validation
FCG114 – Feed flow FC114 lead/lag dynamic compensation (feedforward control)
All tags have tag attributes, specific properties or values that have assigned names and mnemon￾ics in the DCS. Example properties are engineering units (EUs) and engineering unit range
(EUHI, EULO), and example values are measured or calculated controller inputs (PV) and con￾troller set points (SPs). In this book, when referring to a tag and its attributes, the tag name and tag
attribute mnemonic are combined with a blank character between them. For example, FC119 SP
is the reference for flow controller FC119’s SP, and FC119 PV is the reference for FC119’s PV input.
2 In a plant, tag names start with a unit code, typically two alphabetic (or sometimes numerical) characters – for
example PS for the atmospheric pipestill unit. Because tag name duplication and tag name assignment to an
operator’s console are not issues here, unit codes are not needed and they are omitted.
3 As explained in Section 2.4.3, see Figure 2.14, TV387 would be a name assigned to the analog output (AO) block
(i.e., the valve) that receives TC387’s control output (in % of range).
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.3 Tag Naming Conventions 5
Table 1.1 Service Codes – First, Second, and Third Characters
First Character Second Character Third Character
A Analyzer C Control G Dynamic Compensation
F Flow I Indicator V Validation
L Level V Valve Z Calculation
P Pressure — — — —
Q Heat Duty — — — —
R Ratio — — — —
S Speed — — — —
T Temperature — — — —
1.3.1 Tag Naming in Process Overview/Control Strategy Drawings
The focal point of almost all control strategy discussions throughout the book are two drawings.
The first drawing provides a process configuration overview and is the basis for the process descrip￾tion. The second drawing presents the control strategy’s cascade structure and is the basis for
the strategy’s functional description. For future reference, the following “rules” highlight how the
non-instrument tags, the application tags, in a control strategy’s cascade structure are named. They
are presented in “example form” for the most common situations:
1. An application tag doing temperature control with an input source from a (measured)
high-level analog input (4–20 mA) temperature indicator TI311 is named TC311 (I → C, with
the same service code first character, and the same numerical identifier as PV-input source).
2. An application tag doing flow control with an input source from a (measured) flow indica￾tor FI103 is named FC103 (I → C, with the same service code first character, and the same
numerical identifier as PV-input source).
3. An application tag validating an online analyzer measurement AI186 is named AIV186 (3rd
character V added to service code, but the same first and second service code characters, and
the same numerical identifier as measurement input source).
4. An application tag validating a DTI point TI343 is named TIV343 (3rd character V added to
service code, same first and second service code characters, and the same numerical identifier
as measurement input source).
5. An application tag providing dynamic compensation for flow measurement FI45 is named
FIG45 (3rd character G added to service code, same first and second service code characters,
and the same numerical identifier as measurement input source).
6. An application tag providing dynamic compensation for a flow measurement controlled by
flow controller FC127 is named FCG127 (3rd character G added to service code, same first
and second service code characters, and the same numerical identifier as measurement input
source).
7. An application’s ratio controller, outputting to flow controller FC243, is named RC243 (new
service code RC, same numerical identifier as secondary).
8. An application’s ratio controller, outputting to heat duty controller QC300, is named RC300
(new service code RC, same numerical identifier as secondary).
9. An application’s reboiler heat duty controller, outputting to flow controller FC38, is named
QC38 (new service code QC, same numerical identifier as secondary).
10. An application’s reboiler heat duty controller, outputting directly to control valve TV281, is
named QC281 (new service code QC, same numerical identifier as secondary).
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License6 1 Process Dynamics and Process Control Overview
1.3.2 Process Overview/Control Strategy Drawing Conventions
The drawing conventions used for both the process overview and the control strategy’s cascade
structure drawings are summarized in Table 1.2. Notice that many of the tag naming rules presented
in Section 1.3.1 are illustrated in Table 1.2.
The tag naming and drawing conventions summarized in Tables 1.1 and 1.2 are used initially in
Section 1.4.3, and then in most subsequent sections of the book.
Table 1.2 Process Overview and Control Strategy Drawing Conventions
FC
86
FV86
Basic regulatory single control loop
TC
261
TV261
TI
261 A/I temperature measurement
connection to a basic regulatory
controller’s PV input
LC
80
Basic regulatory control cascade
FC
82
1
2
AI 3
236 AIV236 AC236 1. Basic regulatory control point connection to
 a control application controller’s PV input
2. Analyzer measurement validation
3. Data flow within a control application
 cascade
4. Validated analyzer measurement
 connection to control application controller’s
 PV input
4
TIV344 TC344 TI
344
1. Basic regulatory control point connection to
 a control application controller’s PV input
2. DTI temperature measurement validation
3. Data flow within a control application
 cascade
4. Validated DTI temperature connection to
 control application controller’s PV input
1
3 2
4
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.4 Control Loop Essentials 7
Table 1.2 (Continued)
RC261
QC261
SP
Data flow within a control
application cascade
FI
261 RC281 Basic regulatory control point connection to
a control application controller’s PV input
Control application output
to basic regulatory control loop
QC196
FC
196
FV196
SP
1. Basic regulatory control point connection to
 a control application controller’s PV input
2. Dynamic feedforward compensation for feed
 flow measurement FC15
3. Data flow within a control application cascade
4. Control application output to basic regulatory
 control loop
RC130
SP
FV103
FC
130
FC
15 FCG15
1
2
3
4
1.4 Control Loop Essentials
A PV describes a process condition; if it is maintained at a desired target within or at the boundary
of an operating region via closed-loop control, it is called a CV. A CV can be a measured PV, a PV
calculated from measured PVs, a lab value, or a final control element, e.g., a valve position. Most
measured CVs are temperatures, pressures, flows, levels, and compositions. Typical calculated CVs
are tower internal reflux,4 tower reboiler duty,5 and fired heater duty.6 CVs are dependent variables
whose measured or calculated values are determined by the process configuration and the current
values of other PVs.
A PV value calculated by a controller to achieve a control objective, e.g., maintain a CV at a
desired target (the CV’s set point), is called an MV. MVs change a valve position or other actuator
4 Defined and discussed in Chapter 3, Section 3.7.2.
5 Discussed in Chapter 3, Section 3.7.1.
6 Discussed in Chapter 10, Section 10.4.6.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License8 1 Process Dynamics and Process Control Overview
(e.g., fired heater stack damper), or in a cascade, an MV changes the SP of another controller. Ulti￾mately, it is a valve position or actuator action that changes process conditions; in a cascade, the
ultimate secondary outputs to the final control element. MVs are independent variables whose val￾ues are set by either controller adjustments or operator entries and can be maintained at desired
targets as process conditions change. CV values vary as controller adjustments and operator entries
change MV values.
A PV that upsets or disturbs a control loop is called a DV. DVs are independent variables, measured
or unmeasured, that affect the process and as the process responds to the DV’s change, one or more
CVs are affected. For example, a light-ends tower’s feed rate is frequently set by upstream process
conditions, but when it changes, it can have a significant effect on the tower’s overhead and/or
bottoms product’s quality.7 Also, upsets in any unit providing off gas to the fuel gas header can
cause rapid fuel gas heating value changes which can have an important impact on fired heater coil
outlet temperature controls.8 To correct for a disturbance, and return their CV to SP, the affected
feedback control loop responds by making MV adjustments.
1.4.1 The Feedback Control Loop
The control loop is the basic unit of process control. A generic feedback control loop that illustrates
the relationships among a CV, MV, and DV appears in Figure 1.1. In Figure 1.1, the CV is a mea￾sured PV which is the feedback controller’s PV input. Notice that the measurement hardware is an
element of the control loop. In this book, the controller is almost always a PID controller, and its
control output is calculated based on the difference between the CV value and its SP, the controller
error. Even though error will always be understood to be the difference between a CV value and
its SP, we will normally refer to error more generically as the difference between PV and SP, e.g.,
Error ≡ PV–SP. The controller’s calculated output determines the new value of the MV. Notice the
actuator hardware is also an element of the control loop. The CV responds to new MV values, and
Process unit
configuration
Feedback
control
Disturbance
variable (DV)
Controlled
variable (CV)
Manipulated
variable (MV) Actuator
hardware
Set
point
Measurement
hardware
+
Process unit
configuration
Controlled
variable (CV)
Figure 1.1 Feedback Control Loop Structure
7 Light-ends tower controls are presented and discussed in Chapter 12 (Tower Product Quality Control).
8 Fired heater firing controls are presented and discussed in Chapter 10, Section 10.4.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.4 Control Loop Essentials 9
new CV values are measured and become the controller input. This sequence continues until the
CV approaches its SP, error approaches zero, and there are no further MV changes.
Nonzero MV adjustments occur whenever the controller error (PV–SP) is nonzero, e.g., when
either an operator or another controller in a cascade changes the SP, or a process upset occurs
that affects the CV (the error’s PV input). With the CV initially at its SP, when the SP is changed,
controller error immediately jumps, and the controller calculates a new MV value. The CV
responds to this new MV value, and a new CV value is measured and becomes the controller’s
input. This sequence continues until the CV approaches the new SP, error approaches zero, and
there are no further MV changes. Likewise, when a DV change causes a process upset, the CV
responds, and a new CV value is measured and becomes the controller’s input. The error is now
nonzero and a new MV value is calculated, the CV responds, and a new CV value is measured. This
sequence continues until error approaches zero, the CV returns to its SP, and there are no further
MV changes.
When an upset occurs, feedback controller corrective action begins only after the CV’s value
starts to deviate from its SP. The performance of feedback control can be improved by combining it
with feedforward control,9 a model-based control algorithm that provides corrective actions, e.g.,
new MV values, as soon as a DV change is detected, and before the CV begins to deviate from
its SP. Because the DV is the feedforward controller’s input, feedforward control is possible only
for measured DVs or DVs that can be calculated or inferred from measured PVs. The basis for the
feedforward controller’s calculations are (linear) models of a CV’s dynamic response to DV and
MV changes; the models are developed using plant-test data. Both the feedback and feedforward
corrections contribute to the MV corrections that bring the CV back to SP.
An example feedback control loop with feedforward control is shown conceptually in Figure 1.2;
the relationships among a CV, MV, and DV are illustrated. Feedforward control essentials are
presented in Chapter 3.
Process unit
configuration
Feedback
control
Disturbance
variable (DV)
Controlled
variable (CV)
Manipulated
variable (MV) Actuator
hardware
Set
point
Measurement
hardware
+
Process unit
configuration
Controlled
variable (CV)
Feedforward
control
+
Measurement
hardware
Figure 1.2 Feedback Control Loop with Feedforward Control
9 Feedforward control essentials are discussed in detail in Chapter 3.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10 1 Process Dynamics and Process Control Overview
Process unit
configuration
Disturbance
variable (DV)
Controlled
variable (CV)
Manipulated
variable (MV)
Actuator
hardware
Set
point
+
Process unit
configuration
Controlled
variable (CV)
DP
cell Valve
positioner
Pressure/current
transducer
Digital/analog
signal
converter
Analog/digital
signal
converter
Current/pressure
transducer
Air
3–15 psi
Electronic
4–20 mA
Measurement
hardware
Air
3–15 psi
Electronic
4–20 mA
Digital control system
Error
Control
logic
Controller
+
–
Figure 1.3 Control Loop Hardware
1.4.2 Control Loop Hardware
Several hardware components are essential to make any control loop functional. Figure 1.3
illustrates the hardware components and transmission path for a flow measurement and flow
controller:
The measurement field hardware first generates a 3–15 psi air pressure signal, a pressure/current
transducer converts it to an electronic 4–20 mA signal, and the 4–20 mA signal is transmitted
to the control house where an analog/digital (A/D) signal converter generates the controller’s
digital input signal. The controller’s calculated output is converted to a 4–20 mA signal by
the digital/analog (D/A) signal converter and is transmitted to the actuator field hardware.
A current/pressure transducer converts the 4–20 mA signal to a 3–15 psi air pressure signal that
establishes the valve position. In most cases, the hardware components function transparently
and are normally not considered during control strategy design.
However, hardware components can fail, and the failure risk of some components is higher than
others. For example, many online analyzer measurements and externally multiplexed digital tem￾perature indicators (DTIs) are more prone to failure than high-level A/I analog inputs (4–20 mA).
The control strategy’s designer must be aware of any potential hardware failures, especially those
that can have detrimental process or control consequences. At a minimum, the designer must
understand a failure’s impact on the control strategy, and how the control strategy’s response will
impact the process. In many cases, user-provided logic/code is included in the control strategy’s
design to detect failures and take steps to prevent a process upset. The conventional advanced con￾trol applications presented in this book include methods to manage controller input and output
failures using input/output signal validation methods.
1.4.3 Control Loop Examples
Three single control loop examples at light-ends tower T-85’s overhead are illustrated in Figure 1.4.
Overhead pressure PC77 PV is maintained constant at its desired target (PC77 SP) by manipulating
air-fin condenser E-88’s duty via its air louvre positioning. The flow of LVN product to storage
FC86 PV is maintained constant at its desired target (FC86 SP) by flow controller FC86, and reflux Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.4 Control Loop Essentials 11
LVN to
storage
PC
77
E-88
D-115 LC
89
T
8
5
FI
83
LV89
FC
86
FV86
∞
Figure 1.4 Control Loop Examples I – Single Loops
drum D-115’s level LC89 PV is maintained constant by manipulating T-85’s reflux return flow via
valve LV89.
Additional control loops at the bottom segment of T-85 are shown in Figure 1.5. T-85 feed rate
FC87 PV is maintained at its desired target (FC87 SP) by flow controller FC87. Tray temperature
E-89
TI
88
TI
89
FC
87
TC
87
AI
95
APS top
pump around
(TPA)
HVN to
catalytic
reforming
5% Dist
point
TV87
TI
90
HVN to
storage 
FI
89
LC
80
FC
82
FV82
T
8
5
Figure 1.5 Control Loop Examples II – Single Loops and a Simple Cascade
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12 1 Process Dynamics and Process Control Overview
TC87 PV is maintained constant at its desired target (TC87 SP) by manipulating reboiler E-89’s duty
via adjustments to valve TV87 to change CDU top pumparound (TPA) flow. Also, T-85’s bottoms
level LC89 PV is maintained constant by manipulating flow of bottoms heavy virgin naphtha (HVN)
to catalytic reforming via adjustments to flow controller FC82’s SP.
The LC80 → FC82 control cascade is an example of a simple cascade, e.g., one primary con￾troller (LC80) sending its output to the SP of one secondary controller (FC82 SP). Complex cascades,
with multiple primaries or multiple secondaries, are common in the design of conventional control
application strategies. The structure of simple and complex cascades and cascade advantages and
disadvantages are discussed in Chapter 2, Section 2.2.
1.4.4 Controller Modes
A controller’s mode – Manual, Auto, or Cascade, determines whether the controller executes its
control algorithm, who can change its SP and who can change its output. The following table sum￾marizes a controller’s functionality for each mode:
Manual Auto Cascade
Control algo executed No Yes Yes
Controller output or valve position
(ultimate secondary) changed by
Operator Control algo calculation Control algo calculation
Controller SP changed by N/A Operator Controller’s primary
Therefore, in Figure 1.4, if controllers PC77, LC80, and FC86 are in Auto mode, all three control
loops are commissioned, and their SPs can only be changed by operators. If an operator wants to
change valve position FV86, FC86 must be transferred from Auto to Manual; however, flow con￾trol is no longer operational. In Figure 1.5, for the LC80 → FC82 cascade to be commissioned,
LC80 must be in Auto and FC82 must be in Cascade. To change FC82 SP, an operator must transfer
FC82 from Cascade to Auto. LC80 can no longer change FC82 SP, and level control is decommis￾sioned. To change valve position FV82, FC82 must be transferred from Auto or Cascade to Manual
mode. Just like transferring FC82 to Auto, LC80 can no longer change FC82 SP, and level control
is decommissioned.
1.4.5 Open-loop Stable and Unstable Control Loops
When a controller is transferred from Auto to Manual mode, control calculations and controller
outputs stop; the controller is in open loop. Control loops are open-loop stable if, in Manual mode,
the CV lines out at a new steady state after an input variable change or disturbance. Control
loops are open-loop unstable if, in Manual mode, the CV does not line out but keeps increasing or
decreasing. Almost all control loops are open-loop stable or self-regulating.
Figure 1.6 presents an example of a self-regulating temperature control loop. In Figure 1.6, reac￾tor R-401 feed rate (FI477) is set by feed surge drum D-425 level controller LC475. Reactor feed
preheat, via a fired heater and heat integration, occurs downstream of the surge drum. After the
catalytic reactions in R-401, reactor effluent light components (gas) are separated, and remain￾ing liquid is fed to the product stripper where the final products are separated. Product stripper
bottoms (hot side) and reactor feed (cold side) are heat integrated in exchangers E-420 A/B and via
three-way bypass valve TV487, E-420 A/B duty is manipulated by TC487 to control D-425 inlet tem￾perature. If TC487 is transferred to Manual mode, and an upset occurs that changes either E-420 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.4 Control Loop Essentials 13
LC
475
TI
448
TC
487
To reactor
R-401
Off gas to
fuel gas
header
Product
stripper
bottoms
Reactor
feed
Feed
surge
drum
E-420 A/B
TV487
FI
477
D
4
2
5
Figure 1.6 Open-loop Stable (Self-regulating) Temperature Control Loop
hot side (product stripper bottoms) or cold side (reactor feed) inlet temperature, D-425 inlet temper￾ature will be upset but it will eventually line out at a new value as determined by an E-420 A/B heat
balance. Because reactor feed preheat occurs downstream of D-425, R-401 inlet temperature is unaf￾fected and can be maintained at its desired value; thus, a reactor conversion upset can be avoided.
The most common example of an open-loop unstable, non-self-regulating control loop is level
control. In Figure 1.7, accumulator drum D-144 level LC122 PV is controlled by manipulating
D-144 inlet flow via valve LV122. If at steady state, e.g., FI144 PV ≈ FC124 PV, LC122 is trans￾ferred to Manual mode, and an upset in inlet flow FI144 occurs, LC122 PV will either increase
D-144
FV124
LV122
P-132
FC
124
FI
144
LC
122
LC122 mode = AUTO
Figure 1.7 Open-loop Unstable (Non-self-regulating) Level Control Loop
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14 1 Process Dynamics and Process Control Overview
R
7
8
1
E-703 A/B
TV703
Reactor feed
surge drum
Reactor effluent to
downstream units
LC
739
FC
739
TC
703
Treat
gas
Reactor feed
TI
713
D-735
Figure 1.8 Open-loop Unstable (Non-self-regulating) Temperature Control Loop
(if inlet flow increases) or decrease (if inlet flow decreases) until D-144 inventory either overflows
or empties. Unless D-144 outlet flow FC124 is changed, there is no inherent correction that can
force the material balance to close at a new steady state.
If the feed to a reactor with exothermic reactions is preheated by hot reactor effluent, depending
upon how reactor feed temperature is controlled, an open-loop unstable (non-self-regulating)
temperature loop may exist. Such a process configuration is shown in Figure 1.8. R-781 is a packed
multibed catalytic reactor in which exothermic reactions, in the presence of a hydrogen-rich treat
gas to promote the desired reactions, produce the desired products. Although heat is generated
and reactor bed temperatures rise as the reactions proceed along the catalyst beds, the reactor feed
must be preheated to a high enough temperature to initiate the desired reactions. Inlet temperature
controller TC703 maintains feed inlet temperature at a SP (TC703 SP) by manipulating E-703A/B
duty that maintains the desired conversion. If TC703 is transferred to Manual mode, and a feed
composition upset occurs that slightly increases the rate of reaction, because the reactions are
exothermic, reactor bed temperatures rise. Thus, reactor effluent temperature increases, and
after exchange with the hotter reactor effluent in E-703 A/B, feed temperature increases. This
further promotes the exothermic reactions, rates of reaction increase further, and reactor bed
temperatures continue to rise. This cycle of rising temperatures will continue, and since there is
no inherent correction that can force the temperature to line-out at a new steady state, a dangerous
temperature runaway can occur.
This temperature runaway can be avoided if the reactor effluent’s measured temperature (TI713)
is controlled and maintained at target. One possibility is to use a portion of the treat gas as interbed
quench to control TI713 PV. However, additional hardware costs and reactor bed information is
needed in order to assess whether a treat gas quench solution is feasible and/or justified.
1.5 Process Dynamics and Dynamic Responses
Control strategy design and troubleshooting plant upsets both require knowledge of process
dynamic responses in the affected process units. In almost all cases, it is impractical to develop
detailed, non-linear, first-principle dynamic simulations to study these dependencies. Instead,
control engineers use process analysis, in many cases involving data collected during plant tests,
to complete these tasks. The process response curve is an empirical tool that graphically shows Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.5 Process Dynamics and Dynamic Responses 15
plant test results of a PV’s (dependent variable) response to a change in another PV (independent
variable). It provides visual insight into the dynamic relationship among PVs.
In the discussion of the feedback control loop (Section 1.4), there were many references to a CV’s
dynamic response to changes in an MV and a DV. The characteristics of the CV—MV dynamic
response are central to a control loop’s performance, and the suitability of a CV—MV pairing.
The characteristics of CV—DV dynamic responses can provide helpful input to a control strategy’s
design, for example the need for feedforward control and other more advanced (and more com￾plex) components. These CV—MV dynamic characteristics are now explored with the help of the
process response curve.
1.5.1 Representation of Process Dynamics: Process Response Curves
Two basic characteristics that describe a dynamic response are sensitivity and response time or set￾tling time. The process gain or steady-state gain (KP) provides a measure of sensitivity, and the TTSS
provides a measure of response time and settling time. The definition of KP and the meaning of the
TTSS are illustrated in Figure 1.9, which presents a typical dependent variable (e.g., a CV) dynamic
response to a step change in an independent variable (e.g., an MV) of strength ΔX at time t = 0.
This is an example of a process reaction curve. The dependent variable’s response lines out at a
new steady state, YSS2, at TTSS units of time after the initial change (at t = 0) in the independent
variable. KP, in EUs, is the ultimate change in the dependent variable, ΔY = YSS2 − YSS1, divided
by the change in the independent variable, ΔX = XSS2 − XSS1. The TTSS is the time it takes for
the process response curve to essentially line out and remain at a new steady state value. Note: The
estimation of KP and TTSS requires the dependent variable to approach and remain at a new steady
state value after the independent variable change.
In Section 1.5.2 we will discuss, illustrate, and quantify how process design and current operat￾ing conditions determine response dynamics. Just to provide an example, refer to feed surge drum
D-425’s process configuration in Figure 1.6. With inlet temperature controller TC487 manipulating
Time →
Time →
Independent
variable
X(t)
Dependent
variable
Y(t)
XSS2
XSS1
YSS1
YSS2
ΔY = YSS2 – YSS1
ΔX = XSS2 – XSS1 
KP = ΔY/ΔX
Time to steady state
(TTSS)
t = 0
Figure 1.9 Dynamic Response Characteristics – Steady State Gain (KP) and Time-to-steady-state (TTSS)
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License16 1 Process Dynamics and Process Control Overview
D
4
2
5
LC
475
TI
448
To reactor
R-401
Off gas to
fuel gas
header
Product
stripper
bottoms 
Reactor
feed
Feed
surge
drum
E-420 A/B
TV487
FI
477
TC
487
Figure 1.10 D425 Inlet Temperature Response Slowed by Exchanger Dynamics
three-way bypass valve TV487, the inlet temperature TC477 PV will respond to a TC487 SP change
very quickly (small TTSS) because the dynamics of mixing are fast. With an alternative control
valve type (less cost) and placement (hot side fluid flow to a product tank) shown in Figure 1.10,
inlet temperature TC487 PV will respond to a TC487 SP change slower (larger TTSS) than the con￾figuration in Figure 1.6 because E-420 A/B’s slower (than mixing) dynamics are incorporated into
TC487 PV’s response.
The process response curve in Figure 1.9 does not indicate the presence of deadtime – the depen￾dent variable’s response starts just after the independent variable changes at t = 0. Depending
upon its magnitude, CV–MV deadtime can make PID feedback control difficult and provide poor
control performance. In many cases, long deadtimes are best managed using a single or multiple
input – single output (e.g., multiple CVs and one MV) model-based control approach. To further our
analysis of CV–MV response dynamics, Figure 1.11 shows a comparison of two dependent variable
process response curves for changes in two different independent variables.
In Figure 1.11, unlike the process response curve for the change in the first independent variable
(X1), the process response curve for the change in the second independent variable (X2) contains
deadtime (𝜃2). TTSS2 is longer than TTSS1 for two reasons: the presence of the deadtime and the
slower, more ramp-like approach to its new steady state value after the deadtime expires.
Remember, CVs are dependent variables and MVs are independent variables, so now consider
the response curves in Figure 1.11 as CV responses to step changes in two different potential MVs,
starting from the same initial steady state value (Y1,SS1 = Y2,SS1). Qualitative but useful guidelines
to help judge whether an MV is suitable for the control of a specific CV are (i) the magnitudes of KP
and TTSS – the larger the KP value and the smaller the TTSS value, the more suitable the MV choice
and (ii) the existence and magnitude of deadtime in the CV response – the larger the deadtime, the
more troublesome closed-loop control. In Figure 1.11, the CV–MV1 pairing has a shorter TTSS and
no deadtime, both favoring it over MV2 as a potential MV. Notice that the TTSS includes the dead￾time duration, but the presence of deadtime is in itself an important factor above and beyond the
longer TTSS. As for the steady state gains, KP, they appear to have comparable magnitudes => with
ΔY1 > ΔY2 and ΔX1 > ΔX2, the ratios ΔY1/ΔX1 and ΔY2/ΔX2 will have similar magnitudes.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.5 Process Dynamics and Dynamic Responses 17
Independent
variable
X1(t), X2(t)
Dependent
variable
Y1 (t), Y2 (t)
X1,SS1
Y1,SS1, Y2,SS1
Y1 SS2
ΔY1
ΔX1
θ2
ΔY2
ΔX2
1 2
Time to steady state
(TTSS2)
Time to steady state
(TTSS1)
X2,SS1
Y2 SS2
X2,SS2
X1,SS2
Time → KP = ΔYi /ΔX t = 0 i
Figure 1.11 Dependent Variable Responses to Changes in Two Independent Variables
Another factor to consider in the CV–MV pairing issue is interactions among CVs and MVs. In
many cases, a specific MV will have impact on more than one CV and multiple MVs will have an
impact on a single CV. As discussed above, if multiple MVs have an impact on a single CV, process
analysis and plant testing facilitate making a reasonable MV choice. Assume CV1 is paired with
MV1 and CV2 is paired with MV2, but MV1 also impacts CV2 and MV2 also impacts CV1. Then CV2’s
control loop will be impacted anytime MV1 takes corrective action to control CV1. Likewise, CV1’s
control loop will be impacted anytime MV2 takes corrective action to control CV2. The two control
loops interact, and the performance of both loops will degrade. As we will observe when we present
and discuss industrial applications, multivariable interactions, and dynamic responses with long
deadtimes are often better managed by a multivariable constraint control (MVCC) method such
as DMC.
Now consider the CV response curves in Figure 1.11 as responses to step changes in two different
DVs (remember DVs are also independent variables), instead of two different MVs. Plant test data
can provide a qualitative guideline, which may be helpful, to assess whether feedforward control
is needed for a specific DV. If the CV–DV response curve has small KP and a long TTSS, the impact
of the DV’s change on the CV’s response would appear to be minor (small KP) and affect the CV
over an extended time period (long TTSS). If so, feedback control alone may be able to effectively
manage the upset, and feedforward control may not be necessary. Note: The detailed discussion of
feedforward control in Chapter 3 will indicate that in addition to the CV–DV response dynamics,
the CV–MV response dynamics impact the feedforward controller’s design.
Operators, who in their daily tasks constantly observe and interact with the process, normally
have a good “feel” for the effect changes in their units’ PVs have on process operations. They can
thus provide valuable input on dynamic cause and effect issues, e.g., response times and PV sensi￾tivities, and important upsets and their consequences. In almost all cases, discussing these issues
with operators is helpful.
1.5.2 First-Order Linear Continuous Model
Up to this point we have been using process response curves to describe and understand the
dynamic relationships among CVs, MVs, and DVs. Keep in mind the industrial control applications
presented in this book focus on the impact process configuration, operating objectives, and control Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License18 1 Process Dynamics and Process Control Overview
D
4
2
5 LC
475
TC
487
To reactor
R-401
Off gas to
fuel gas
header
Product
stripper
bottoms 
Reactor
feed
Feed
surge
drum
E-420 A/B
TV487 FI
477
FI
476
h
A
TI
479
A = Cross-sectional area
h = Distance between level taps
LC475 SP = 50%
Liquid hold-up = A * H * 50%
Established by process design
Fixed by operating conditions
Figure 1.12 D-425 Process Design and Operating Conditions That Define Process Dynamics
objectives have on a control strategy’s design. Control strategy design for the most part does not
depend on or need dynamic simulations to provide realistic, mathematically based results. Instead,
a less fundamental but still meaningful formulation of process dynamics is sufficient for control
strategy design. We now relate this formulation to the underlying concepts of process dynamics
provided visually by the process response curve.
We will use feed surge drum D-425, first introduced in the discussion of Figure 1.6, as the basis
for developing a simple (linear) dynamic model; Figure 1.12 shows D-425’s process configura￾tion. There is additional information included in Figure 1.12, but absent from Figure 1.6. The
cross-sectional area (A), the distance between level taps (h), and the level controller’s set point
(LC475 SP) are needed to calculate the liquid hold-up in D-425. Inlet (FI476) and outlet (FI477)
flows and outlet temperature (TI479) are needed (along with liquid inventory) for a D-425 heat
balance. Note that the cross-sectional area and distance between level taps are established by pro￾cess design, but the values of inlet and outlet flows, inlet and outlet temperatures, and the level
controller’s SP are set by process operating conditions.
We now derive an expression that mathematically describes the response of outlet temperature
TI479 PV (≡TOUT) to a change in the inlet temperature set point ΔTC487 SP (≡ΔTIN). We assume
D-425 is well mixed and is initially at steady state, e.g., there is no material (FI476 PV = FI477
PV ≡ F) or energy (TIN = TOUT) accumulation in D-425. With liquid holdup ≡ V = A * h * (LC475
SP), a D-425 unsteady state heat balance yields:
𝜏 ∗ dTOUT
dt = [TIN(t)] − [TOUT(t)] (1.1)
where: 𝜏 = V
F = Holdup
Throughput (1.2)
Equation (1.1) is a linear, first-order differential equation; the time domain solution, TOUT(t), to
a step change in TIN of strength ΔTIN is given by:
TOUT(t) = TOUT(0)+ΔTIN ∗ (
1 − exp [
−t
∕𝜏
]) (1.3)
where TOUT (0) is the value of TOUT when TIN changes. In Equation (1.3), 𝜏 is the first order time con￾stant, defined in Equation (1.2), which determines how fast the outlet temperature approaches its Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.5 Process Dynamics and Dynamic Responses 19
198
200
202
204
206
208
210
212
0 10 20 30 40 50 60 70
Outlet temperature 
Time since change in TIN
TOUT
τ =2
TOUT
τ = 5
TOUT
τ = 10
TOUT
τ = 20
Figure 1.13 D-425 Outlet Temperature Responses for Four Values of 𝜏 (Minutes)
new steady state value, and an indication of its TTSS. From its definition in Equation (1.2), the outlet
temperature response’s time constant (𝜏), and hence its TTSS, (i) increases with increasing holdup
or decreasing throughput and (ii) decreases with decreasing holdup or increasing throughput. Tem￾perature responses for four values of 𝜏 (2, 5, 10, and 20 minutes) are presented in Figure 1.13.
These responses were obtained for an inlet temperature TC487 SP change at t = 0 of 10 ∘C, from
200 → 210 ∘C. These results clearly indicate response times get slower, and TTSS gets longer, as 𝜏
increases. These results also indicate that each response’s TTSS can be estimated as approximately
equal to five time constants.
Note that in the above example, there is no chemical reaction or external heat source or sink to
change TOUT other than to respond to the TIN change. Therefore, KP ≡ 1, and in fact a 10∘ increase
in TIN results in a 10∘ increase in TOUT.
The linear, first-order differential equation in Equation (1.1) can be made more general by writing
it for any dependent variable, Y, for the change in any independent variable, ΔX, and including
steady state gain, KP, and deadtime 𝜃:
𝜏 ∗ dY(t)
dt = KP ∗ u(t − 𝜃)∗ΔX(t) − Y(t) (1.4a)
where the unit step change u (t–𝜃) = 0 for t < 𝜃 and u(t–𝜃) = 1 for t ≥𝜃. In effect, this shifts the
start of the independent variable’s step change, ΔX(t), 𝜃 units later in time. Given the properties of
the unit step u(t–𝜃), the product u(t–𝜃) * ΔX(t) ≡ 0 for t < 𝜃 and u(t–𝜃) * ΔX(t) ≡ ΔX(t) for t ≥𝜃;
this is indicated by writing this product as ΔX(t–𝜃). With this change in notation, Equation (1.4a)
becomes:
𝜏 ∗ dY(t)
dt = KP ∗ ΔX(t − 𝜃) − Y(t) (1.4b)
The time domain solution of Equation (1.4b) is:
Y(t) = YSS1 + KP ∗ ΔX(t − 𝜃) ∗ (
1 − exp [
−(t − 𝜃)
𝜏
]) (1.5a)
where ΔX ≡ XSS2–XSS1, and XSS1 and YSS1 are the steady state values of X and Y for t < 𝜃. Rearrang￾ing Equation (1.5a) to solve for ΔY ≡ Y(t) – YSS1 yields:
ΔY(t) = KP ∗ ΔX(t − 𝜃) ∗ (
1 − exp [
−(t − 𝜃)
𝜏
]) (1.5b) Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License20 1 Process Dynamics and Process Control Overview
Remember ΔX (t–𝜃) = 0 for t < 𝜃 and ΔX (t–𝜃) = ΔX(t) for t ≥𝜃. In effect, the presence of dead￾time shifts the dependent variable’s response 𝜃 units later in time, e.g., 𝜃 units of time after the
independent variable’s change at t = 0. Applied to the responses in Figure 1.13, all responses would
shift to the right, 𝜃 units later in time, but the steady state gain and shapes of the curves would be
unchanged.
An estimate for the first-order time constant, 𝜏, can be obtained from Equation (1.5b). In
Equation (1.5b), when t > 𝜃 and t = 𝜃 +𝜏:
If t > 𝜃∶ ΔX (t − 𝜃) = 𝛥X(t) = 𝛥X = XSS2 − XSS1
If t = 𝜃 + 𝜏∶
(
1 − Exp [
−(t − 𝜃)
𝜏
]) = (1 − exp [−1]) = 0.63
And, remember, KP * ΔX ≡ ΔY = YSS2 – YSS1, and Equation (1.5b) becomes:
ΔY(t = 𝜃 + 𝜏) = KP ∗ ΔX ∗ 0.63
ΔY(t = 𝜃 + 𝜏) = 0.63 ∗ ΔY = 0.63 ∗ (YSS2 − YSS1) (1.6)
Thus, for a first-order linear dynamic system, the time after the deadtime’s duration, or if 𝜃 = 0,
the time at which the dependent variable reaches 63% of its ultimate change (ΔY) is an estimate of
the first-order time constant, 𝜏.
True Deadtime
If, for some reason, the outlet temperature measurement sensor can only be placed well down￾stream of D-425’s outlet, TOUT would not start to change immediately after the change in TIN.
Instead, the start of the TOUT response would be delayed until the first elements of D-425’s effluent
stream with an elevated temperature reaches the sensor. This is an example of a “true” deadtime,
whose magnitude can be estimated from pipe geometry and D-425’s outlet flow:
𝜃 = (Pipe Cross − Sectional Area ∗ Distance to Sensor)∕Outlet Flow
Remember that with dead time present, all outlet temperature response curves appearing in
Figure 1.13 would be shifted 𝜃 time units to the right, but the steady state gain and shapes of the
curves would not change.
Assume there is no heat loss, reaction, or mixing (liquid is in plug flow) along the path to the tem￾perature sensor. Starting with Equation (1.5b), once again evaluate ΔY(t) when t > 𝜃 and t = 𝜃 +𝜏.
The term (1–exp [− (t–𝜃)/𝜏]) becomes (1–exp [−1]), which again is equal to 0.63. When t > 𝜃,
ΔX (t–𝜃) = ΔX(t), the magnitude of the independent variable’s step size, ΔX = XSS2–XSS1, and the
dependent variable’s new steady state value, ΔY, is equal to KP * ΔX. Equation (1.5b) becomes:
ΔY(t = 𝜃 + 𝜏) = 0.63 ∗ ΔY = 0.63 ∗ (YSS2 − YSS1) (1.7)
Thus, consistent with Equation (1.6), Equation(1.7) indicates the time after the deadtime’s dura￾tion at which the dependent variable reaches 63% of its ultimate change (ΔY = YSS2 − YSS1) is an
estimate of the first-order time constant, 𝜏. This is illustrated in Figure 1.14.
Apparent Deadtime
True deadtime is real and is present because of the process configuration. Apparent deadtime
will arise when a real process response curve is approximated by a first-order linear response. In
Figure 1.15, the dependent variable’s actual process response initially decreases, and then even￾tually turns and begins to increase; it continues to rise, and asymptotically approach its ultimate Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.5 Process Dynamics and Dynamic Responses 21
t = 0
0.63 * ∆Y
Independent
variable
X(t)
Dependent
variable
Y(t)
YSS1
XSS2
XSS1
YSS2
θ τ
ΔY = YSS2 – YSS1
KP = ΔY /ΔX Time →
Time →
ΔX = XSS2 – XSS1 
Figure 1.14 Estimating First-Order Time Constant (𝜏) for Response with Deadtime
t = 0
Time to steady state
(TTSS)
θ τ
0.63 * ∆Y
Linear, 1st order
approximation
Independent
variable
X(t)
Dependent
variable
Y(t)
YSS1
XSS2
XSS1
YSS2
KP = ΔY /ΔX
ΔY = YSS2 – YSS1
ΔX = XSS2 – XSS1 
Time →
Time →
Figure 1.15 Estimating Apparent Deadtime
steady state value. When a dependent variable’s response to a step change moves initially in one
direction but ultimately reverses and moves in the opposite direction before it approaches its new
steady state, the response is called an inverse response (Ref. [1]). If the dependent variable is a CV,
its MV control adjustments will initially be in the wrong direction, make the situation worse, and
negatively impact control performance. Of course, choosing to approximate this inverse response Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License22 1 Process Dynamics and Process Control Overview
with a first-order approximation will not improve closed loop control performance; however, the
first-order approximation’s model parameters (KP, 𝜏, and 𝜃) can be useful for PID tuning10 and
necessary for single input – single output model-based control.11
As shown in Figure 1.15, the first-order approximation substitutes an interval of deadtime for the
initial inverse response, and as discussed in Section 1.5.2.0 (True Deadtime), the first-order time
constant 𝜏 is estimated using the 63% guideline. The first-order approximation is not particularly
good for 0≤t ≤𝜃, but for t > 𝜃, it is reasonable. Also, the dependent variable’s ultimate steady state
value is not affected by the model errors at t ≤𝜃; thus, the first-order approximation can be made to
asymptotically approach the correct, new steady state value, and the approximation’s KP estimate
is reasonably accurate.
Apparent deadtime will often be observedin the plant because process operationsin the real world
are complex. The overall process responses observed in the plant are complex combinations of indi￾vidual unit, measurement, and actuator responses. Also, most processes are nonlinear, distributed
(PVs are functions of time and distance), and their dynamic responses are functions of operating
conditions. Therefore, in many cases, the observed responses are slow to start, and compared to the
initial fast rise in the dependent variable’s response in Figure 1.14, responses observed in the plant
will have more rounded initial rises. The initial portion of the response will often look like apparent
deadtime. As already noted, and as illustrated in Figure 1.15, a linear model used to approximate a
real-world process response will almost always substitute an interval of apparent deadtime for the
initial time interval where there is little observed changes in the dependent variable.
1.5.3 Transfer Function Representation
A transfer function is an empirical model that relates an output variable – a dependent variable, to
an input variable – an independent variable, not in the time-domain but in the Laplace domain,
or s-domain. As included in all undergraduate process control textbooks (Ref. [2, 3]), Laplace
transforms convert linear ordinary differential equations (with constant coefficients) to algebraic
equations. Examples would be unsteady state material and energy balances, with a structure like
Equations (1.4a) and (1.4b). Taking the Laplace transform of both sides of Equation (1.4b) yields:
𝜏 ∗ s ∗ Y(s) − Y(t < 𝜃) = KP ∗ exp(−𝜃s) ∗ X(s) − Y(s) (1.8)
Since Y (t < 𝜃) ≡ 0, it can be dropped from Equation (1.8); re-arranging and solving for Y(s):
Y(s) = [ KP ∗ exp(−𝜃s)
𝜏s + 1
]
X(s) (1.9)
The relationship between dependent (Y(s)) and independent (X(s)) variable Laplace transforms
is defined as the transfer function, G(s):
G(s) ≡ Y(s)
X(s) =
[ KP ∗ exp(−𝜃s)
𝜏s + 1
]
(1.10)
The process response curve in Figure 1.14 is an empirical, graphical representation of the solu￾tion (the dependent variable’s response) of a linear, ordinary first order differential equation (such
as Equation (1.4b) to a step change in an independent variable. Equation (1.5b) is an equivalent
analytical time domain representation of the solution of the linear first order ordinary differential
equation in Equation (1.4b), while Equation (1.10) is an equivalent representation of this solution
in the s-domain. Therefore, all three are equivalent representations of the dynamic response, e.g.,
the solution to Equation (1.4b).
10 See Section 2.4.7 for a discussion of PID tuning.
11 See Section 2.7.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.5 Process Dynamics and Dynamic Responses 23
There are times when a higher order linear approximation of plant dynamics is a better represen￾tation of those dynamics than the first order transfer function in Equation (1.10). A second order
transfer function includes additional dynamic parameters that enable it to better represent several
types of process responses, for example, those that include inverse response and/or overshoot. Here
is a common form of a second-order transfer function:
G(s) = Y(s)
X(s) = KP ∗ (1 + 𝜏3s) ∗ exp(−𝜃s)
(1 + 𝜏1s)∗(1 + 𝜏2s) (1.11)
The second order transfer function’s model parameters are the time constants 𝜏1, 𝜏2, and 𝜏3, the
deadtime 𝜃, and the steady state gain, KP. The 𝜏3 term in the numerator tends to speed the response,
while the 𝜏1 and 𝜏2 terms in the denominator tend to slow the response. If 𝜏3 <0, the second order
transfer function in Equation (1.11) can provide an initial inverse response for an independent
variable’s response; if 𝜏3 > 𝜏1 ≥𝜏2, it can provide an overshoot in an independent variable’s response
(Ref. [4]).
If 𝜏2 = 0 in Equation (1.11), the resulting transfer function is called a “lead-lag” and is the basis
for understanding the feedforward control algorithm:
G(s) = Y(s)
X(s) = KP ∗ (1 + 𝜏3s) ∗ exp(−𝜃s)
(1 + 𝜏1s) (1.12)
The time constant 𝜏3 in the numerator is called the “lead” time constant, while the time constant
in the denominator 𝜏1 is called the “lag” time constant. The effect these two time constants have on
the response in Equation (1.12), and their significance in the feedforward control algorithm, will
be explained and discussed in detail in Chapter 3.
1.5.4 First-order Linear Discrete Model
Up to now, we have represented process dynamics with continuous models in the time domain.
Equation (1.4b) is a first order linear ordinary differential equation with time-domain solution
given in Equations (1.5a) and (1.5b). The solution in the s-domain, equivalent to the time domain
solution in Equations (1.5a) and (1.5b), is the first order transfer function in Equation (1.10). In
addition, a second order transfer function, equivalent to the time domain solution of a second order
linear ordinary differential equation, is given in Equation (1.11).
In today’s DCS world, data issampled at a fixed frequency and process information is known only
at discrete times. This is illustrated in Figure 1.16:
The current value of the dependent variable at time step “n,” Yn, is considered constant between
sample times; as shown in Figure 1.16, the dependent variable becomes a “staircase” function,
as do independent variable inputs, e.g., MVs and DVs. Linear ordinary differential equations and
s-domain transfer functions are not valid in the discrete world, and a different, a discrete represen￾tation of the process reaction curve is needed. The discrete analogue of differential equations and
time domain solutions are recursive difference equations that contain dependent and independent
variable values at specific time steps, e.g., Yn, Yn−1, and Xn−1. The discrete analogue of s-domain
transfer functions are z-transforms. The difference equation representation of the process response
curve is the “inverse z-transform” just as the time domain expression in Equation (1.5b) is the
“inverse Laplace (s)-transform” of Equation (1.9).
The mathematical relationships among the sampled function (Yn), the continuous function
(Y(t)), the definition of the z-transform, the inverse z-transform, and the difference equation
representation of the process response curve are complex (Ref. [5]) and are not relevant to
real-world control strategy design. Therefore, only an important example is provided below, e.g.,
a first-order sampled data difference equation with deadtime, to introduce the recursive nature of Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License24 1 Process Dynamics and Process Control Overview
Dependent
variable
Yn
TS
Process response Y(t):
changes continuously
Discrete signal Yn:
changes only at sample
times
TS = Sample time
 = Time between data samples
Y(t)
Yn+3
Yn+2
Yn+1
Yn–1 Y Y n–2 n–3
Yn
Dependent
variable
Y(t)
n–3 n–2 n–1 n n+1 n+2 n+3
Time step
Time →
Figure 1.16 Continuous and Discrete Signals
the discrete representation of the process response curve. This will be helpful when the standard
PID control algorithm (Section 2.4) and the standard linear exponential filter (Section 2.5), both
recursive, difference equations, are presented and discussed.
Yn = b ∗ Yn−1 + (1 − b) ∗ KP ∗ Xn−1−Γ (1.13a)
b = exp (−TS∕𝜏) (1.13b)
(1 − b) = 1 − exp (−TS∕𝜏) (1.13c)
Γ = 𝜃∕TS (1.13d)
Sample times (TS) are normally chosen small enough that the ratio of deadtime to sample time,
Γ, can be assumed to be an integer. For example, with TS = 4 seconds and 𝜃 ≈87 seconds, then
Γ = 21.8 which can be rounded up to ≈22. To interpret the practical meaning of Equation (1.13a),
assume TS = 5 seconds and 𝜃 = 60 seconds; then, Γ = 12 and Equation (1.13a) becomes:
Yn = b ∗ Yn−1 + (1 − b) ∗ KP ∗ Xn−13
In words, the current value Yn depends upon its value one-time step ago, Yn−1, and to account
for the deadtime of 12 time steps, the value of input X 13 time steps ago; this is the last value of X
that has affected the value of Yn at the current time step, n.
In Section 2.5, measurement noise and the need for signal filtering will be discussed. Almost
all DCS’ include a linear exponential filter as a standard filter algorithm – the most widely used
filtering algorithm. It is very closely related to first order sampled data difference equation in
Equation (1.13a). For no deadtime (Γ = 0), KP = 1.0, and 𝜏 in Equation (1.13b) set equal to 𝜏f, the
filter time constant, Equation (1.13a) becomes:
Yn = b ∗ Yn−1 + (1 − b) ∗ Xn (1.14a)
b = exp (−TS∕𝜏F) (1.14b) Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.6 Plant Testing 25
With Y signifying the filtered value, and X the raw measurement, Equation (1.14a) is the
recursive difference equation for the linear exponential filter. Important: Unlike the standard first
order sampled data difference equation in Equation (1.13a), to let the filter respond faster to a
raw measurement change, the linear exponential filter in Equation (1.14a) uses the current raw
measurement, Xn, not the previous measurement, Xn−1.
1.6 Plant Testing
Many conventional control application designs are presented and discussed throughout this book.
The most important requirement for developing a good control strategy design is an in-depth under￾standing of the process – the unit configuration, operating objectives, economic drivers, control
objectives, and available measurements and control hardware (e.g., valves). In addition, potential
constraints, potential upsets, potential DVs, CVs, and MVs, and important interactions and sensi￾tivities among MVs, CVs, and DVs must be identified and understood.
Plant tests establish how planned changes in independent variables dynamically affect one or
more dependent variables. A plant test may be as simple as changing the SP of one independent
variable (an MV or a DV) and collecting response variable data for one dependent variable (a CV).
The dependent variable responses to changes in two independent variables shown in Figure 1.11
are examples. On the other hand, plant tests to develop a DMC model consist of a carefully planned
sequence of changes in multiple independent variables (both MVs and DVs) and the collection of
dynamic response data for multiple dependent variables (CVs).
1.6.1 Objectives
Plant tests are performed to increase the understanding of dynamic relationships among PVs in a
specific process area. Data collected during a plant test, and the data analysis that follows are used to
(i) identify important dynamic relationships among potential CVs, MVs, and DVs, (ii) identify and
assess potential control interactions, (iii) evaluate steady state sensitivities, and (iv) provide model
parameter values that are suitable for both model-based control and PID tuning. All such informa￾tion can be used to resolve relevant technical issues, and then help weigh and evaluate competing
control strategy designs. Although not directly relevant to process control, plant tests are rou￾tinely used to troubleshoot process problems and/or to identify the root-causes of process upsets.
Important: It is essential to check data collection hardware and software before testing begins to
ensure they are fully operational.
1.6.2 Work Process
Plant tests have an impact on plant operations and therefore it is essential that disruptions to pro￾cess operations are minimized. Plant test objectives and procedures should always be discussed
with console operators prior to the start of the test. Operator experience is invaluable when choos￾ing the move (step) size to ensure the dependent variable changes are large enough to be measured
and analyzed. Operators can also suggest a reasonable TTSS that ensures sufficient time is allotted
for the dependent variable to line out at a new steady state value. The basis for the plant test, e.g.,
the assumed relationships among PVs, should be discussed with process technical personnel.
Noise and filters will be discussed in Chapter 2, Section 2.5. However, if noise on a dependent
variable appears to be a problem, then filter the noisy signal before plant test data is collected. This
ensures 𝜏f, the filter time constant, is incorporated into the dependent variable’s dynamic response Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License26 1 Process Dynamics and Process Control Overview
and thus into the model’s dynamic parameter values. The signal-to-noise ratio, a parameter that
qualitatively estimates the strength of the base (process) signal versus the magnitude of the noise
will also be discussed in Section 2.5. If a dependent variable is noisy, even if it is filtered, the inde￾pendent variable’s step change magnitude must be large enough to ensure the dependent variable’s
response is indicative of the base signal and not the noise.12
It is best to work at the operator’s console with operators as the test proceeds. It is important that
operators not make routine process changes that impact the same dependent variable(s) whose
responses to planned independent variable step changes are being studied. In addition, tests should
be scheduled at a time when operations are normal – no feed rate or feed composition changes
expected, and process operations in the specific unit are initially at or close to steady state.
Lastly, control loops that have impact on the plant test’s dependent variables should be identified.
They must be on control (in Auto or Cascade mode), not wound-up, and tuned well. If not, these
problems should be resolved, controllers retuned if necessary, and put on control before commenc￾ing the plant test. If these problems are not resolved, the dependent variable’s response dynamics
will not incorporate the normal impact of the underlying controls. Consideration should be given
to monitor the underlying controller status and performance during the plant test. Also, it is ben￾eficial to identify potential process disturbances that can affect the dependent variable responses.
Their impact must be understood; if possible, take proper precautions, and decide what actions will
be taken if they occur. It is usually a good idea to collect data for all PVs of possible interest in the
plant test’s focus area.
1.6.3 In Process Control
Look again at Figure 1.11 – it illustrates how dependent variable (CV) responses to step changes in
two different independent variables (MVs) can provide useful guidelines for pairing a CV with an
MV. By comparing the two responses, the larger the KP value (better sensitivity) and the smaller the
TTSS value (faster the approach to a new steady state), the more suitable the MV choice. Also, the
larger the deadtime, the more troublesome closed-loop control will be. In Figure 1.11, the CV–MV1
pairing has a shorter TTSS and no deadtime, both favoring it over MV2 as a potential MV. Remember:
The KP and TTSS parameter estimates are dependent upon the CV approaching and lining out at
a new steady state value after the MV step change.
Also, look again at Figure 1.14; we previously discussed a simple graphical procedure to estimate
a first order linear model’s dynamic parameters, KP, 𝜏, and 𝜃. But the value of 𝜏 is based on only one
data point, the time at which the dependent variable reaches 63% of its ultimate change. Parameter
values estimated in this way are minimally suitable for model-based control but may be acceptable
to use to estimate PID tuning constants. More effective graphical methods are available that use
two points on the response curve to estimate 𝜏 and 𝜃 (Ref. [2, 3, 6, 7]). This two-point graphical
method can provide parameter estimates that are acceptable for single or multiple input – single
output model-based control, for tuning PIDs and for identifying feedforward controller lead time
and lag time constants.
Commercially available model identification tools (Ref. [8]), which use statistical curve fitting
techniques, are far more effective at obtaining accurate model parameter values compared to these
graphical methods. A model is a mathematical representation of a process response curve. A model
has a structure, e.g., linear, nonlinear, first or second order with or without deadtime, and a set
12 This depends on the signal-to-noise ratio, discussed in Section 2.5.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.6 Plant Testing 27
of dynamic parameters. Model identification tools find values for model parameters that provide
the “best” fit of a specific model to the plant test data. In many cases, plant tests are run and
model identification tools used to fit response data to a first-order (Equation (1.10)), or a second
order (Equation (1.11)) linear model. Model identification tools use various statistical methods to
calculate the best set of model parameters, but no matter the statistical methods used, they all
calculate and use the error, or residual between predicted PV values (Yi,Pred) and measured PV
values (Yi
)–Residuali ≡ (Yi − Yi,Pred). The curve-fitting technique calculates the best set of model
parameter values, i.e., the set of model parameter values that minimizes the sum of squares of the
residuals:
Minimum | Dynamic
Parameters
= ∑N
i=0
(Yi − Yi,Pred)
2 (1.15)
Yi = Dependent variable plant test data point
Yi,Pred = Model’s predicted value of Yi
N = Number of data points
The residuals are squared to ensure negative and positive values do not cancel when they are
summed. Figure 1.17 illustrates the graphical relationship among the test data (Yi
), the model pre￾dictions (Yi,Pred), and the residuals that appear in Equation (1.15). The best estimates of the model’s
dynamic parameters, e.g., KP, 𝜏, 𝜃 for a first-order model or KP, 𝜏1, 𝜏2, 𝜏3 and 𝜃 for a second-order
model, are calculated by a numerical optimization algorithm. Statistical calculations and “good￾ness of fit” criteria are used to estimate the uncertainties in the model. These first- and second-order
dynamic parameter values are far better estimates than parameter values determined graphically,
and they are used whenever possible.
If model predictions do not fit the data well, the model structure may be wrong (second-order
model more suitable than first-order model) or the plant data collected is poor, e.g., step change
magnitudes too small, data span too narrow, a new steady state was not reached, or the effects of
disturbances are included in the data. But note that, in many cases, when the data fit is poor, a
specific reason cannot be identified.
Yi
(t)
Yi,Pred
Model
prediction
Residuals Yi
(t) – Yi,Pred
Plant test data
Dependent
variable
Yi
(t)
Time →
Figure 1.17 Plant Data, Model Prediction and Definition of Residual
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License28 1 Process Dynamics and Process Control Overview
D2
M3 = 2 * M1
D1
M1
M2 = 3 * M1
Step durations = D1 < D2
M1 = Change magnitude1
M2 = Change magnitude2 = 3 * M1
M3 = Change magnitude3 = 2 * M1
Figure 1.18 Independent Variable Rectangular Double Pulse Input Change
If a statistical curve fitting routine is used to determine the dynamic parameters, the following
independent variable rectangular double pulse input change is desirable:
The independent variable’s input change pattern in Figure 1.18 is advantageous for the following
reasons:
● Both positive and negative step changes are executed; in part, this compensates for the effects of
nonlinearities.
● Three different sized step changes are performed; this also compensates for the effects of nonlin￾earities.
● Step duration D2 is chosen long enough for the dependent variable to approach and line out at a
steady state value. This requires a reasonable initial estimate of the TTSS.
● The change magnitude M1 is chosen large enough to overcome the negative consequences of
noise.
● Since the independent variable returns to its initial steady state value, the dependent variable
will also return close to or at its initial steady state value provided the system is close to linear.
1.7 Classification of Process Control Strategies
Process control strategies implemented in petrochemical plants can be ordered in a rational way
(via Levels) based on control need (Ref. [9]). Control strategies at the lowest levels are the most
critical, and control strategies at the higher levels less critical but more profitable. The most critical
process control need is safety protection at Level 1, followed from lower to higher levels by basic reg￾ulation at Level 2, advanced regulation at Level 3, conventional control applications – supervisory
controls at Level 4, and MVCC and online real-time optimization (RTO) at Level 5.
1.7.1 Control Strategy Hierarchy: Relative Costs, Resources, and Credits
The following table lists the five levels of process control strategies discussed in this section. The
relative magnitudes of the hardware costs, manpower costs, potential credits, and reliability needs Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.7 Classification of Process Control Strategies 29
are indicated for each level. Note that manpower costs are indicative of the control strategy’s
complexity and functionality requirements.
Control Strategy
Hardware
Costs
Manpower
Costs
Potential
Credits
Reliability
Needs
5 Advanced Control Applications
(MVCC and RTO)
Lowest Highest Highest Lowest
4 Conventional Control
Applications
3 Advanced Regulatory Controls
2 Basic Regulatory Controls
1 Safety Protection Highest Lowest Lowest Highest
At Level 1, safety protection strategies are implemented in standalone devices independent of
the DCS; they are critical and a prerequisite for operations to proceed. At Level 2, the basic reg￾ulatory controls provide the minimum control functionality that ensure operability, stability, and
on-specification products. Safety protection and the basic regulatory controls have the highest reli￾ability requirement and the highest hardware costs, but their maintenance manpower costs are
relatively low.
At Level 3, the advanced regulatory controls have essentially the same control objectives as the
basic regulatory controls, but their advanced features help improve control performance. Their
hardware costs and credit potential are closer to the basic regulatory controls at Level 2, but their
manpower costs and reliability needs are closer to conventional control applications at Level 4.
At Levels 4 and 5, conventional and advanced control application credit capture is the highest.
These applications require complex and, in some cases, cutting-edge functionality; their manpower
costs for implementation and maintenance are the highest. Their reliability is normally not a major
issue because the advanced and basic regulatory controls (at Levels 2 and 3) run regardless of the
advanced and conventional control application On/Off status. However, because their credit cap￾ture potential is usually quite high, periods of downtime will be reported, and issue resolution
encouraged by plant management.
For the most part, process data, control statuses, and equipment statuses are pulled up from
lower to higher levels, and calculated SPs and actuator positions (valve positions) are pushed down
from higher to lower levels. SPs calculated by MVCC and RTO at Level 5, conventional control
applications at Level 4, and advanced regulatory controls at Level 3 are stored to controllers at
lower levels but never to a safety protection device at Level 1. The DCS never outputs to a safety
protection device, and data from these devices (digital inputs and/or outputs) required for control
in the DCS (Levels 2–5) are hardwired to DCS process connected devices. The information flow
among advanced control applications (RTO and DMC), conventional advanced (supervisory)
control applications, advanced regulatory controls, and basic regulatory controls is shown in
Figure 1.19. Note that RTO applications almost always output to DMC external targets. However,
RTO will on occasion (but infrequently) output a SP to a conventional advanced (supervisory)
control application’s CV.
Important: For control strategies at any level to meet their control objectives, control strategies at
lower levels must be performing properly and achieving their control objectives.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License30 1 Process Dynamics and Process Control Overview
Conventional advanced (supervisory) control applications 
Advanced regulatory controls
External
targets (ET)
MV SPs
MV SPs
PV data
MV/CV limits
MV modes, control
and wind-up status’
MV/CV limits
MV/CV control status’
ET on/off
CV SPs
(infrequent)
MV SPs
MV SPs
MV OPs
PV data
MV/CV limits
MV SPs
MV OPs
PV data
MV/CV limits
MV modes, control
and wind-up status’
PV data
MV/CV limits
MV modes, control
and wind-up status’
PV data
MV/CV limits
MV SPs
MV OPs
Process connected devices All basic regulatory controls
Advanced control applications MVCC (DMC)
Advanced control applications RTO
Figure 1.19 Information Flow in the Control Hierarchy
1.7.2 Safety Protection
At the lowest level is the hardware and software that provide safety protection, safeguarding
equipment, the process units, and operating personnel. The safety protection system initiates
automatic shutdown and start-up systems after warnings/alarms indicate potentially hazardous
circumstances. They also prevent the start-up of equipment when applicable warnings/conditions
are detected. These systems are implemented in standalone, multi-redundant process connected
devices, Programmable Logic Controllers (PLCs) independent of the control system. The DCS
never outputs to the PLC. PLC information (digital inputs and/or outputs) required for control
are hard wired to DCS process connected devices; any direct connections to the DCS are for
operator information only. Safety protection equipment is normally configured, programmed, and
maintained by non-control engineer specialists.
Alarm systems are also safety protection devices. Alarms are prioritized according to their impor￾tance and potential impact on safety. Alarms that impact safety and require immediate operator
action are assigned to the emergency category and are implemented in hardware, independent of
the DCS. Emergency alarms are usually annunciated at the operator’s console and backlit alarm
windows. Other alarms are issued by process connected devices in the DCS or more complex control
strategies in process connected devices. Although control engineers are involved in the planning
and organization of the alarm management system, it is normally non-control engineers who are
responsible for its configuration and maintenance.
1.7.3 Basic Regulation: Basic Regulatory Control
The sample control loops presented and discussed in Section 1.4.3 are all examples of basic regu￾latory controls, the next higher control level just above the safety protection level. They provide
the minimum control functionality required to ensure operability, stability, and the production of
on-specification products. All single control loops, e.g., flow, level, pressure, and temperature con￾trollers and simple cascades such as Level → Flow, Temperature → Flow, Temperature → Pressure Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.7 Classification of Process Control Strategies 31
are included in this classification. Basic regulatory control loops are always implemented in pro￾cess connected devices that are redundant. They are typically configured and maintained by the
instrument maintenance group, although control engineers support the tuning of troublesome
loops – most often level and temperature controllers, and all control loops that have an impact
on more complex, advanced control strategies.
1.7.4 Advanced Regulation: Advanced Regulatory Control
Basic regulatory control is enhanced by the addition of one or several control components such as
ratio control, feedforward control, control of an important calculated process engineering PV (e.g.,
reboiler heat duty), etc. The enhanced control strategies that result are classified as advanced regu￾latory controls and reside in the next higher control level. They have the same control objectives as
the basic regulatory controls, i.e., operability and stability, but the advanced features help improve
control performance. An advanced regulatory control strategy example is presented next, but with
much of the design details omitted because this control strategy is presented in Section 10.3.2, and
all design issues and their resolutions are discussed there. In the discussion that follows, notice the
prominent role that the process’ configuration and operating objectives play in the development of
the control strategy’s design; this is an essential need for the design of most control strategies. This
will be reinforced throughout the book when numerous industrially important, advanced regula￾tory control and conventional control application strategies are presented and discussed.
To illustrate the advanced regulatory features, first look at the basic regulatory controls for the
bottom section of Deethanizer (DeC2) tower T-209 in Figure 1.20. Tray temperature TC261, an
inferential indicator of T-209 bottoms quality, is controlled by manipulating reboiler E-233’s hot
side bottom pumparound (BPA) bypass flow, via three-way bypass valve TV261, to either increase
E-233 duty (reduce bypass flow, increase flow to E-233) or decrease E-233 duty (increase bypass
flow, decrease flow to E-233). Temperature control via TC261 → TV261 is a basic regulatory con￾trol loop. Note: Maintaining TC261 constant in principle maintains bottoms C2 content constant,
but because TI261 is only an inferential indicator of bottoms quality, not necessarily at the desired
BPA
LC
235
TC
261
FI
213
E-233
T
2
0
9
Feed
TV261
TI
261
FI
261
AI
236
Btms C2
TI
244
TI
243
Figure 1.20 T-209 (DeC2) Tray Temperature Control – Basic Regulatory Controls
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License32 1 Process Dynamics and Process Control Overview
BPA from
E-233
TC261
QC261
BPA bypassing
E-233
Desired TC261
SP
SP
BPA to
E-233
BPA flow
to E-233
TI
261
TV261
E-233 BPA
outlet temperatures
FI
261 TI
244
TI
243 TIV243
TIV244
Validation
E-233 BPA
inlet temperature
Figure 1.21 T-209 (DeC2) Tray Temperature Control – With Reboiler Duty Control
value. Although not relevant to this discussion, with the bottoms C2 content measurement available
(AI236 PV), direct control of bottoms C2 content is possible.
E-233 BPA flow (FI261) and inlet temperature (TI243), and T-209 feed rate (FI213) are all set by
upstream or downstream unit operations. Changes in FI261 PV and TI243 PV directly affect E-233
duty and hence will upset tray temperature TC261 PV. Changes in FI213 PV will change the tower’s
L/V ratio, the tower’s separation and thus tray compositions, and ultimately, they will also cause
TC261 PV to deviate from TC261 SP. Therefore, upsets in any one of these three PVs will impact
TC261 PV, and corrective control action starts after deviations in TC261 PV from TC261 SP are
detected.
This is a classic example of where feedforward control for reboiler duty and feed rate upsets will
improve control performance. By calculating and controlling E-233’s duty and configuring TC261
to reset the duty controller’s SP, corrective action for reboiler duty upsets will be initiated before
TC261 PV deviates from TC261 SP. Figure 1.21 illustrates how the basic regulatory control strategy
in Figure 1.20 can be upgraded by adding reboiler duty control (QC261).
The advanced regulatory control components added to the basic TC261 regulatory control strat￾egy are enclosed in the shaded area and shown with green background. Because QC261 outputs
to a valve, and the relationship between heat duty and valve position is not linear, QC261 must be
configured as a PID controller; its PV is the calculated duty:
QC261 PV = Scale ∗ FI261 PV ∗ CP(BPA)∗(TIV243 PV − TIV244 PV) (1.16)
E-233 heat duty QC261 PV is calculated using hot side inlet (TI243) and outlet (TI244) tempera￾tures, and flow rate (FI261). TI243 and TI244 are both DTI inputs (externally multiplexed) and not
analog inputs (4–20 mA); they must be validated13 (in TIV243 and TIV244) before they are used in
the duty calculation. CP is the BPA’s heat capacity, assumed constant at a process technical services
(PTS) specified value. Scale is a unit conversion factor that ensures QC261 PV has the desired EUs.
Figure 1.22 illustrates how the advanced regulatory control strategy in Figure 1.21 is further
enhanced by adding feed rate feedforward control (FCG213) and heat duty to feed ratio control
(RC261):
13 See Chapter 8, Section 8.8.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.7 Classification of Process Control Strategies 33
BPA bypassing
E-233
Desired TC261
SP
SP
SP
BPA to
E-233
BPA flow
to E-233
TI
261
TV261
E-233 duty/feed
ratio control
FI
261
BPA from
E-233
FI
213 FCG213
Dynamic
compensation
Feed
rate
TIV243
TIV244
Validation
E-233 BPA
outlet temperatures
E-233 BPA
inlet temperature
TI
244
TI
243
QC261
RC261
TC261
FI
213
Figure 1.22 T-209 (DeC2) Tray Temperature Control – Reboiler Duty and Feed Rate Feedforward Control
These additional control components, e.g., feed rate feedforward and duty/feed ratio control, are
now also enclosed in the shaded area, this time shown with blue background. RC261 is the heat
duty/feed ratio controller whose PV is the calculated ratio:
RC261 PV = Scale ∗ QC261 PV
FI213 PV (1.17)
FI213 PV is the measured feed rate and QC261 PV the calculated reboiler heat duty. Scale is
another unit conversion factor that ensures RC261 PV has the desired EUs.
RC261 can be configured as a standard PID controller, but normally it is configured with a ratio
control algorithm14 that performs an arithmetic control calculation:
RC261 OP ≡ QC261 SP = RC261 SP ∗ FCG213 PV (1.18)
Note that RC261 PV has no impact on RC261’s control calculation in Equation (1.18) – it is
RC261’s “wild flow” input, FCG213 PV, the dynamically compensated feed rate, that RC261 SP mul￾tiplies in the control calculation. Dynamic compensation of the feed rate is required when the tray
temperature’s response dynamics (KP, 𝜃, and 𝜏) to a heat duty change are visibly different from the
tray temperature’s response to a feed rate change.15 The dynamic parameters of the two responses,
e.g., their KP, 𝜃, and 𝜏 values, are estimated using plant test data and are the feedforward controller’s
tuning constants.
Ratioing heat duty to feed is intuitively correct if, in the current operating region, the process
is close to linear. If so, the reboiler’s heat input requirement should be proportional to the feed
rate – e.g., if the feed rate goes up by 10%, the heat duty required to maintain the tray temperature
constant is expected to increase by roughly 10% as well.
Like almost all ratio feed rate feedforward and reboiler duty controls, there are several especially
important “what if” (e.g., measurement signal failures), initialization and wind-up issues that must
be managed by the configurations of FCG213, RC261, and QC261. For this specific control strategy,
these details are presented in Section 10.3.2. There are numerous other applications presented and
discussed in this book that include ratio feed rate feedforward and duty controls; all require these
same safeguards for proper control performance.
14 See Chapter 2, Section 2.6.
15 See Chapter 3, Section 3.3.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License34 1 Process Dynamics and Process Control Overview
1.7.5 Supervisory Control: Conventional Advanced Control Applications
Conventional advanced control applications, historically called supervisory controls, calculate and
output SPs to both advanced regulatory and basic regulatory controllers. They provide both PID
and model-based control of product quality, improve energy utilization, move operations closer
to and maintain them at constraints, and meet reactor conversion targets. A conventional control
application example is presented next, but again with much of the design details omitted because
this control strategy is presented in Section 10.2.4, and all design issues and their resolutions are
discussed there. Once again notice the prominent role that the process’ configuration and operat￾ing objectives play in the development of the control strategy’s design. And note again that many
other industrially important conventional control applications are presented and discussed in
this book.
To illustrate how a conventional control application’s design structure evolves, consider the basic
regulatory controls for the hydrodesulfurization (HDS) Product Stripper T-635 in Figure 1.23. The
HDS process is a fixed bed catalytic reaction system that removes feed sulfur, nitrogen, metals and
Conradson carbon and produces fluid catalytic cracking unit (FCCU) feed stocks and desulfurized
heavy fuel oils. The reactor effluent is separated into liquid and gas products, and the liquid prod￾ucts are heated and fed to a product stripper such as T-635 in Figure 1.23. Tail gas (uncondensed
overhead vapor), wild naphtha (distillate), wild gas oil sidestream (FCCU feed), and heavy fuel oil
(bottoms) products are separated.
D-611
T
6
3
5
LC
673
LC
635
FC
655
HDS reactor
liquid effluent
Wild gasoil
(FCCU Feed)
Heavy
fuel oil
Steam
Wild
naphtha
TI
653
VPS
bottoms
LC
631
TC
651
E-601
FI
621
Tail
gas
TV653
FC
675
TV651 LV635
FI
672
FI
660
FI
652
E-602
FV675
TC
653
LV631
TI
662
TI
663
Figure 1.23 Product Stripper Tower T-635 Configuration and Feed Preheat Control
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.7 Classification of Process Control Strategies 35
After H2S removal, the tail gas is sent to the treat gas and/or fuel gas systems. The wild naphtha
becomes either catalytic reformer feed or MOGAS blend stock. The wild gas oil product is a FCCU
feedstock. Preheat exchanger E-601 supplies the heat required to vaporize the components removed
as liquid products above the feed tray, and the liquid returned as reflux to insure good fractionation
above the sidestream draw-off. The higher the preheat duty, e.g., the higher the feed temperature,
the more vapor is sent overhead and thus the more reflux, wild naphtha and wild gas oil produced.
The overhead condenser E-602 capacity is sized to condense almost all the vapor produced in E-601
and not condensed by the tower’s internal reflux. Steam stripping below the feed tray removes lower
boiling (lighter component) hydrocarbons from the unvaporized feed, upgrading small amounts of
heavy fuel oil to wild gas oil.
There are five key T-635 basic regulatory control loops: (i) overhead temperature control (TC651)
manipulating reflux flow (via TV651) to set wild naphtha product (back-end) quality, (ii) reflux
drum D-611 level control (LC635) manipulating wild naphtha product flow (FI652) via LV635
which sets wild naphtha yield, (iii) complete draw-off tray level control (LC673) manipulating
sidestream draw off flow (FC675 SP) to set wild gas oil product yield, (iv) level control (LC631)
manipulating bottoms product flow (FI672) via LV631 which sets heavy fuel oil yield, and
(v) temperature control (TC653), manipulating feed preheat exchanger E-601 hot side (VPS
bottoms) bypass flow (via three-way bypass valve TV653), to set T-635 feed temperature.
The liquid hold-up on the draw-off tray, and thus the wild gas oil product yield, varies with the
amount of vapor produced in preheat exchanger E-601 (E-601 duty). TC653 SP determines the feed
preheat duty and thus the tower’s vapor loading. Because overhead temperature control (TC651)
manipulates reflux flow, E-601 duty also affects the tower’s liquid loading. Since the wild gas oil
is normally FCCU feed, the operating objective is to maximize gas oil yield by maximizing E-601
duty, i.e., maximizing TC653 SP, as limited by tower operating constraints. Operating experience
indicates the most likely constraints to limit feed preheat are a full open reflux valve (TV651) and/or
a full open distillate valve (TV635); neither wild gas oil draw-off valve (FV675) or heavy fuel oil flow
valve (LV631) becomes an active constraint before either the reflux or distillate flow valve becomes
limited. Clearly, to meet the wild gas oil yield maximization operating objective, TC653 SP must
be increased. However, TC653 SP cannot exceed its guideline maximum value specified by the PTS
group, and the reflux and distillate flow valve positions must stay in controlling range.
The control of T-635 feed temperature and E-601 duty can be enhanced by adding the same con￾trol components, e.g., reboiler duty control, feed rate feedforward control, and duty to feed ratio
control, added to Figures 1.21 and 1.22 in Section 1.7.4. These additions, and configuring TC653
to reset the duty/feed ratio controller’s SP will initiate corrective actions for feed rate and E-601
hot side inlet temperature and flow upsets before TC653 PV deviates from TC653 SP. Figure 1.24
illustrates how the basic regulatory control strategies in Figure 1.23 can be upgraded by adding
reboiler duty control (QC653), feed rate feedforward control (FCG621), and duty/feed ratio con￾trol (RC653) – all additions are enclosed in the shaded area, and shown in green. For this control
strategy, TC653 SP is an operator entered desired T-635 feed temperature.
E-601 heat duty controller QC653 outputs to a valve so it must be configured as a PID controller.
Its PV is calculated using Equation (1.16) written in terms of QC653 PV, E-601 hot side inlet (TIV663
PV) and outlet (TIV662 PV) temperatures, and E-601 hot side flow FI660 PV. The heat duty/feed
ratio PV (RC653 PV) is calculated using Equation (1.17) written in terms of duty QC653 PV and feed
rate FI621 PV. RC653 is configured with a ratio control algorithm; its control output is calculated
using Equation (1.18) written in terms of RC653 SP, the dynamically compensated feed rate FCG621
PV, and E-601 heat duty QC653 SP.
To achieve the tower’s primary operating objective – to maximize wild gas oil yield – the con￾trol strategy in Figure 1.24 requires operator action and attention, e.g., to increase TC653 SP and Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License36 1 Process Dynamics and Process Control Overview
RC653
Validation
Desired feed
temperature
SP
SP
TI
653
E-601
duty/feed
FI
621
Feed
rate
FCG621
Dynamic
compensation
QC653 
TIV662
SP
E-601
heat duty
TV653
TIV663
FI
660 VPS Btms
rate
VPS Btms
to E-601
VPS Btms
from E-601
TC653 
TI
662
TI
663
Figure 1.24 T-635 Feed Preheat Control – Reboiler Duty, Duty/Feed, Feed Rate Feedforward Control
monitor reflux and distillate flow valve positions. Even if the incentives are high, operators will
normally give a “constraint pushing” strategy a lower priority than those control strategies that
stabilize operations, confine operations to safe operating regions, or meet product quality targets.
The control strategy in Figure 1.24 can be improved to automate the “constraint pushing” part of
the strategy. The enhanced design, shown in Figure 1.25, converts the advanced regulatory control
strategy in Figure 1.24 to a typical supervisory control application, i.e., conventional constraint con￾trol16 with three constraint variables (T-635 feed temperature, reflux, and distillate valve positions)
and a single MV (E-601 three-way bypass valve position, TV653). The supervisory control addi￾tions – reflux valve position controller VTV651, distillate valve position controller VLV635, and the
low signal selector (LSS) – are enclosed in the shaded area and shown with green background, con￾nectors and text. Each constraint variable has its own dedicated PID controller (QC653, VTV651,
and VLV635) trying to adjust the one MV (TV653) to drive its PV value to its constraint limit, i.e.,
its PID’s SP (QC653 SP – as calculated by RC653, to drive TC653 PV to TC653 SP, VTV651 SP, and
VLV635 SP). Note that for this control strategy, TC653 SP is the PTS group’s desired maximum feed
temperature guideline value. Both valve position constraints are also maximum constraints.
With no constraint variable violating, an increase in preheat duty (MV = TV653) will drive all
three constraint variables toward their constraint limit. The lowest amount of preheat (after the
increase) will in principle drive the constraint variable closest to its limit (the active constraint) to its
limiting value without driving the other two constraint variables into violation. With all constraint
variables violated, the lowest amount of preheat (after the decrease) will drive the active constraint
(constraint variable farthest from its limit) to its constraint limit while moving the other two con￾straint variables out of, and away from, violation. Likewise, the same logic can be applied to cases in
which either one or two constraint variables are violated – the lowest amount of preheat (after the
decrease) will drive the active constraint variable to its limiting value without forcing any additional
violations. Thus, the three constraint variable PIDs in Figure 1.25 (QC653, VTV651, and VLV635)
16 Constraint control is discussed in detail in Chapter 7.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.7 Classification of Process Control Strategies 37
TV653
LSS
VTV651 VLV635
Max reflux valve position Max distillate valve position
SP SP
TV651 LV635
E-601
duty/feed
Feed rate
FCG621
FI
621 RC653
TC653
Max feed temperature
SP
Dynamic
compensation
SP
QC653 
E-601 TIV662 
heat duty
TIV663 
FI
660 VPS Btms
rate
Validation
TI
653
SP
VPS Btms
to E-601
VPS Btms
flow 
VPS Btms
from E-601
TI
662
TI
663
Figure 1.25 T-635 Feed Preheat Maximization
must output to a LSS, which chooses the smallest of the three PID outputs (the lowest preheat duty)
to send to TV653.17 This either satisfies the PTS group’s maximum feed temperature guideline value
(the max TC653 SP entered) via the TC653 → RC653 → QC563 cascade’s control action, or limits
E-601 duty and thus TC653 PV to ensure both valve positions remain in controlling range.
Like the control strategy in Figure 1.22, there are several especially important “what if” (e.g.,
measurement signal failures), initialization and wind-up issues that must be managed by proper
configuration of FCG621, RC653, QC653, VTV651, VLV635 and the LSS. Remember the control
strategy in Figure 1.25 is presented and discussed in detail in Section 10.2.5, where these configu￾ration features, as applied to this application, are explained. Also, a detailed discussion of conven￾tional constraint control design issues can be found in Section 7.8. Finally, there are numerous other
applications presented and discussed in the book that include conventional constraint control, and
all require these same important safeguards to achieve satisfactory control performance.
1.7.6 MVCC and RTO: Advanced Control Applications
Advanced control applications, e.g., MVCC and RTO applications, are far more complex than
the advanced regulatory and conventional advanced control applications discussed to this point.
17 As will be explained in Sections 7.3.4 and 7.4.4, criteria for choosing the selector (LSS or HSS) depend upon the
effect an increase in the MV has on all constraint variables – specifically, if an MV increase drives all constraint
variables towards violation, an LSS is the correct choice. Thus, for the strategy in Figure 1.25, this general criterion
provides the same answer as the analysis presented here.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License38 1 Process Dynamics and Process Control Overview
However, they are also far more profitable and capture a good share of the credits associated with
control applications.
MVCC applications such as DMC calculate and output multiple SPs to underlying controllers
resident at lower hierarchical levels – as indicated in Figure 1.19, to conventional advanced con￾trol applications, advanced regulatory and basic regulatory control strategies. In many cases, DMC
controllers replace some conventional control and advanced regulatory control applications by
incorporating their CVs and MVs into the DMC’s controller’s scope. DMC controllers hold the pro￾cess within or at constraint limits, as specified by the site’s operating plan and entered by operators,
although that operation may or may not be optimal. Remember: For a DMC controller to achieve its
control objectives, its underlying conventional control applications and advanced and basic regu￾latory control strategies must be on control and performing effectively.
RTO applications calculate the process conditions that either maximize or minimize a carefully
developed economic objective function, e.g., RTO either maximizes profit or minimizes total costs.
RTO applications provide optimal SPs for DMC CVs in one or more underlying DMC controllers;
these RTO calculated SPs are called external targets in DMC. For an RTO application to achieve its
optimization objectives, its underlying DMC controllers must be on control and must be able to
move plant operations to the optimal operating points calculated by RTO.
DMC controllers incorporate linear, dynamic models that quantify the dynamic relationships
among CVs and the MVs, and DVs that impact the CVs. DMC drives multiple constraint variables
(the CVs) to maximum or minimum constraint limits by simultaneously adjusting multiple MVs.
DMC is thus a truly multivariable controller that accounts for the real-world certainty that many
important CVs are affected by more than one MV and that some MVs impact multiple CVs. A
critical step in the DMC control calculation, as it is for all model-based controllers, is the update of
the DMC model. Prior to each control execution, DMC models are updated online in real time by
calculating CV prediction errors, which are then used to shift the model’s CV predictions to match
plant data at the current operating point.
RTO applications incorporate complex, nonlinear, first-principle, steady state models that are
solved as part of the optimization calculation. The model equations are updated online in real
time prior to each execution pass – some of the steady state model’s physical parameters (e.g., a
mass transfer coefficient) are configured to be back calculated to match the model predictions to
plant data at the current operating point. Because RTO models are valid only at steady state, the
RTO application’s calculation sequence includes a steady-state detection algorithm. An RTO appli￾cation’s optimization calculation is initiated only if the steady state detection algorithm declares
the process is at steady state.
Thus, the RTO application executes asynchronously – it is not scheduled to execute at a specific fre￾quency, but executes only when the process is declared at steady state. RTO execution frequencies
range from every hour to every four or more hours. Remember, an RTO application’s underlying
DMC controllers must be on control and performing effectively. This is important for many rea￾sons, but it is especially important for an RTO application that can execute only if the process is
declared to be at steady state. Therefore, DMC must not only move plant operations to the optimal
operating point calculated by RTO on its last execution pass, it must hold the plant steady there. If
not, steady state detection may fail, and if so, a new RTO optimization calculation cannot start.
Conventional control applications and advanced regulatory controls are the focus of the many
industrially important control strategies presented and discussed in detail in this book. The com￾plexity of the advanced control application technology underlying both DMC and RTO is well
beyond this focus, and neither DMC nor RTO applications are included. However, for many of
the conventional control applications discussed, process scenarios that suggest a potential need
for either DMC or RTO are identified and discussed. One example of such a conventional control Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.7 Classification of Process Control Strategies 39
D-15
TC
306
TC
324
TV306
Desalter
Crude
fractionator
E-170
E-173
TV324
Crude
Further
crude
preheat
T-109
top
pumparound
TI
344
TI
340
E-174
D-35
T
1
0
9
∞
Figure 1.26 Fractionator T-109 Feed Preheat Configuration Upstream of Crude Desalter
application is presented next. Because this conventional control strategy is presented and discussed
in Chapter 11 (Energy Conservation Controls) – Section 11.1.1, where design features and issues
are discussed, most of the design details are omitted here and the focus is on the potential need
for DMC.
Figure 1.26 shows the portion of a crude fractionator’s (T-109) preheat train upstream of the
crude desalter (D-15). Crude flows first to overhead condenser E-173, then to T-109 TPA exchanger
E-170, and to other exchangers before flowing to Desalter D-15. An increase in E-170 cold side
(crude) outlet temperature controller’s SP (TC324 SP) will reduce crude bypass in E-173 (via
three-way bypass valve TV324), and thus increase heat recovery to crude in E-173 and reduce
heat lost to air in E-174. Thus, an operating objective is to maximize heat recovery to crude in
E-173 and to minimize heat lost to air in E-174 by maximizing E-170 crude outlet temperature
(TC324 SP).
Crude exiting E-170 is heated further in other downstream exchangers before entering D-15.
Crude desalting is required to minimize downstream fouling, corrosion, and acid formation.
Desalter efficiency can be limited by high temperatures; for D-15, there is an operating tempera￾ture above which desalter efficiency is too low to ensure sufficient crude desalting. Thus, a second
operating objective is to maintain D-15’s inlet temperature (TI340 PV) below its maximum to
ensure acceptable desalting.
As E-173 duty increases, T-109 overhead vapor temperature (TI344 PV) decreases. However,
TI344 PV must remain above its dew point to minimize corrosion in the overhead line. Also, as
TI344 PV decreases, E-174 outlet temperature tends to decrease, and temperature controller TC306
reduces E-174 duty to maintain TC306 PV at its SP. Therefore, two other operating objectives are to
maintain TI344 PV above its minimum value to avoid corrosion in the overhead line, and to main￾tain E-174 outlet temperature controller TC306 in controlling range (TC306 OP above its minimum
value).
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License40 1 Process Dynamics and Process Control Overview
TC
324
TC340 VTC306
Desalter inlet
temperature
Max desalter
inlet temperature
SP SP
Ovhd
temperature
controller O/P
Min Ovhd
temperature
controller O/P
LSS 
E-170 outlet
temperature
SP
TV324
Crude flow
to E-170
E-173
bypass flow
Crude flow
from E-173
TV306 TIV340 TC344
SP
Ovhd
temperature
Min Ovhd
temperature
TIV344 TI
344
TI
340
Validation Validation
Figure 1.27 Maximization of Heat Recovery to Crude in T-109 Overhead Condenser E-173
To summarize, the control strategy must maximize E-170 cold side outlet temperature (TC324
PV) while satisfying maximum desalter inlet temperature (TI340 PV), minimum overhead tem￾perature (TI344 PV), and minimum TC306 control output (to maintain TC306 OP in controlling
range) constraints. The conventional constraint control strategy in Figure 1.27 achieves these
control objectives. The strategy’s design intent can be summarized as follows: By increasing
TC324 SP until one of the three constraint variables reaches its constraint limit, heat recovery to
crude in E-173 can be maximized.18 Remember, the discussion of design details for the strategy in
Figure 1.27 is deferred to Section 11.1.1 so that the focus here can be on process conditions that
could enlarge the scope of this control strategy and suggest the need for DMC or even RTO.
There are usually multiple heat exchangers in a fractionator’s pumparound circuit. However, in
Figure 1.26, other than E-170, no other information is provided about T-109’s TPA configuration.
The constraint control strategy in Figure 1.27 assumes that there are no adverse downstream pro￾cess or economic consequences for TPA operations as E-170 hot side (TPA) outlet temperature is
reduced to maximize heat recovery to crude in E-173. However, assume a TPA exchanger down￾stream of E-170 becomes constrained and is no longer able to satisfy its heat duty requirement, for
example, providing reboiler heat to meet a light-ends tower’s tray temperature control objective. If
so, heat recovery to crude in E-173 may need to be constrained further to maintain the light-ends
tower’s tray temperature controller’s output in controlling range. And the range chosen, e.g., out￾put less than 75% versus less than 85%, may impact other tower variables and thus further enlarge
the scope of the control strategy.
Although the control adjustments made to maximize heat recovery to crude in E-173 do not
affect TPA draw-off flow or temperature, the control strategy also assumes that TPA return temper￾ature is controlled and always remains at SP. A pumparound return temperature is almost always
18 In Figure 1.27, an LSS is the selector choice because an increase in TC324 SP (the MV) drives all three constraint
variables toward their constraint limits. See discussions in Sections 7.3.4 and 7.4.4.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License1.8 Benefits of Control Applications 41
controlled by manipulating a pumparound heat exchanger’s duty. Note that if TPA return temper￾ature is not held at SP, even with constant TPA draw off flow and temperature, TPA duty is not
constant and T-109 fractionation may be affected. Even though these fractionation upsets may not
have a significant impact on product yields, constant pumparound return temperature is almost
always the preferred operating strategy. For TPA return temperature to remain at SP, the return
temperature controller’s output must remain in controlling range. If this is not always true, heat
recovery to crude in E-173 may also need to be constrained further to maintain the return temper￾ature controller’s output in controlling range.
There is also no information provided about the hot side process streams that exchanges heat
with crude in heat exchangers downstream of E-170. Here, again, it is necessary to ensure that
any potential constraints that can impact heat recovery in E-173 are identified and considered in
the control strategy’s design. Note that process upsets in these exchangers may affect desalter inlet
temperature TI340 PV directly, and the E-173 heat recovery to crude control strategy must respond
effectively to these disturbances. These interactions may also increase the control strategy’s scope
and impact the heat recovery to crude possible in E-173.
This discussion illustrates how important it is to ensure all potential constraints are identified
and included in a control strategy’s scope – in fact, one of the first tasks in control strategy design is
to correctly define the strategy’s scope. This is important because as the number of control and/or
constraint variables increase, and even more importantly, if multiple MVs have significant control
and/or constraint variable sensitivities, a multivariable constraint controller such as DMC is by far
the best choice.
To look at an example where RTO may be needed, refer to Figure 1.23 in Section 1.7.5, which
presents the HDS product stripper’s (T-635) process configuration. As discussed there, the wild
gas oil, an FCCU feedstock, is the most important product. The operating objective is to maximize
wild gas oil yield by maximizing feed preheat. The maximization is subject to a maximum T-635
feed temperature (TC653) and maintaining the reflux (TV651) and distillate (LV635) flow valve
positions in controlling range.
To maximize the wild gas oil product yield, reboiler E-601 duty and the heat lost to cooling water
in overhead condenser E-602 are both maximized. Thus, for current operations, the energy-yield
trade-off must favor yield improvement, i.e., the incremental value of a wild gas oil yield increase is
greater than the incremental cost of the heat utilized and/or lost. However, there are many process
unit and plant operations in which the trade-off does not have a consistent winner, and numerous
competing energy-yield trade-offs must be resolved. For example, VPS bottoms, E-601’s hot side
fluid, no doubt exchanges heat with other upstream or downstream units, and its ability to supply
the heat needed by its other energy consumers is impacted by E-601 heat duty. So not only is E-601
heat duty traded off versus T-635 wild gas oil yield, it may also need to be traded off against other
VPS bottoms heat utilization needs. Hence the scope of the energy yield trade-off may be wider
than T-635 and include upstream and downstream units. If real-time assessments of energy-yield
tradeoffs are needed, RTO is the best choice.
1.8 Benefits of Control Applications
Control applications improve process control performance by reducing CV variability. Control
application benefits are captured when operations are moved closer to a product specification or
constraint limit to exploit the reduced variability. This requires changing an operating target, e.g.,
the CV’s SP; unless the SP is changed and the operation is moved closer to the specification or
constraint limit, the bulk of the application’s potential benefits are lost.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License42 1 Process Dynamics and Process Control Overview
To illustrate the basis for estimating the benefits of control applications, refer to the discus￾sion of product stripper T-635 in Section 1.7.5, e.g., its basic regulatory control (see Figure 1.23),
advanced regulatory control (see Figure 1.24), and conventional constraint control application (see
Figure 1.25). T-635’s operating objective is to maximize its sidestream’s yield (wild gas oil) by
increasing T-635 feed inlet temperature (TC653 SP). Feed inlet temperature cannot exceed the max￾imum allowed value specified by the PTS group. TC653 manipulates preheat exchanger E-601 duty
by adjusting E-601 feed bypass valve TV653. As TC653 SP, and hence E-601’s duty increase, reflux
and distillate valves are driven toward their maximum allowed openings. Thus, increases in TC653
may be limited by the need to maintain both valves in controlling range.
Figure 1.24 illustrates how the basic regulatory control strategy (TC653 → TV653) in Figure 1.23
is upgraded by adding three advanced regulatory control components, e.g., E-601 duty control
(QC653), feed rate feedforward control (FCG621), and duty/feed ratio control (RC653). These addi￾tions enable corrective actions for feed rate and E-601 hot side inlet temperature and flow upsets to
begin before TC653 PV deviates from TC653 SP. These feedforward enhancements improve control
performance, and feed temperature (TC653 PV) variability about its SP (TC653 SP) is reduced. The
reduced variability is an enabler for operators to increase TC653 SP and to move TC653 closer to
its PTS specified maximum target.
The control strategy in Figure 1.24 requires operator actions and attention, e.g., increasing (or
decreasing) TC653 SP, and reflux and distillate flow valve position constraint monitoring. The
control strategy in Figure 1.24 can be improved to automate the “constraint pushing” part of the
strategy; the enhanced design in Figure 1.25 converts the advanced regulatory control strategy in
Figure 1.24 to a typical conventional advanced control application, i.e., constraint control. Each
constraint variable has its own dedicated PID controller (QC653, VTV651, and VLV635) whose
outputs compete to adjust the one MV (E-601 three-way bypass valve TV653) to drive its PV to
its constraint limit, i.e., TC653 SP, the PTS group’s desired maximum allowable feed temperature
guideline value, and VTV651 SP and VLV635 SP, reflux and distillate valve position maximum open￾ing constraints.
Figure 1.28 is an illustration of how implementing the T-635 advanced regulatory control and
conventional constraint control applications discussed above will capture control benefits. With
only basic regulatory control (single loop control, TC653 → TV653), TC653 PV shows considerable
variation about its SP. As a result, to ensure no violations, operators enter TC653 SPs far away from
the PTS guideline max value. The difference between the actual SP and the PTS guideline value
represents a lost opportunity, i.e., the yield improvement credits if the feed temperature is raised to
the guideline maximum value, less the incremental cost of energy (if any); this is indicated as Lost
Opportunity #1 on Figure 1.28.
With the implementation of the advanced regulatory control application (Figure 1.24), TC653 PV
variations about its SP are markedly reduced. With operators increasing TC653 SP over the time
period shown in Figure 1.28, a portion of Lost Opportunity #1, identified during basic regulatory
control operations, is recovered; the credit basis for the portion recovered is indicated as Credit
Capture Basis #1 in Figure 1.28.
The conventional constraint control application automates the “constraint pushing” part of the
strategy. Instead of depending upon operators to increase TC653 SP, it drives TC653 up to the max
TC653 SP PTS guideline value unless or until limited by either the reflux or distillate flow valve
max opening constraint. Because some residual variations in TC653 PV remain, the temperature
SP entered in the constraint controller is typically somewhat below the max PTS guideline value to
ensure the guideline is not violated. As illustrated in Figure 1.28, a large portion of Lost Opportunity
#2, identified during advanced regulatory control operations, is recovered by implementing con￾straint control. The basis for the portion recovered by constraint control is indicated as Credit
Capture Basis #2, and Lost Opportunity #3 remains as the incentive to further increase TC653 SP.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons LicenseReferences 43
TC653 SP
Time →
Credit capture
basis #2
Basic regulatory control
TC653 SP
Commission
advanced regulatory control
TC653 SP
Max TC653 SP (PTS guideline)
Commission
conventional constraint control
Operators
increase
TC653 SP
Credit capture
basis #1
Advanced
regulatory control 
Lost opportunity #1 Lost opportunity #2
Lost opportunity #3
Figure 1.28 Basis for Control Application Benefits
References
1 Seborg, D.E., Edgar, T.F., Mellichamp, D.A., and Doyle, F.J. (2017). Process Dynamics and
Control, 4e, 88–89, 92–94. Hoboken, NJ: Wiley.
2 King, M. (2010). Process Control: A Practical Approach, 17–20. Chichester: Wiley.
3 Smith, C.L. (1972). Digital Computer Process Control, 138–141. Intext Educational Publishers.
4 King, M. (2010). Process Control: A Practical Approach, 27–28. Chichester: Wiley.
5 Deshpande, P.B. and Ash, R.H. (1988). Computer Process Control with Advanced Control
Applications, 87–99. Instrument Society of America.
6 Ziegler, J.G. and Nichols, N.B. (1942). Optimum settings for automatic controllers. Transactions
of the ASME 64 (11): 759–768.
7 Cohen, G.H. and Coon, G.A. (1953). Theoretical considerations of retarded control. Transactions
of the American Society of Mechanical Engineers 75 (5): 827–834.
8 PiControl Solutions LLC. (2024). PITOPS – system ID and primary/advanced process control tun￾ing, optimization and design software. www.picontrolsolutions.com, info@picontrolsolutions.com.
9 Seborg, D.E., Edgar, T.F., Mellichamp, D.A., and Doyle, F.J. (2017). Process Dynamics and
Control, 4e, 8–10. Hoboken, NJ: Wiley.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License44
2
Feedback Control Essentials
CHAPTER CONTENTS
2.1 Introduction
2.2 Single Loop Control, Simple, and Complex Cascades
2.3 Digital Control System (DCS) Work Environment
2.3.1 Control System Data Base Organization
2.3.2 PV Processing
2.3.3 Control Processing
2.3.4 Output Processing
2.3.5 Alarming
2.3.6 Limit Checking and Clamping
2.3.7 Operator Interface
2.3.8 History, Reports, and Trending
2.4 PID Control Algorithm Basics
2.4.1 Discrete Version of the PID
2.4.2 PID Control Direction
2.4.3 Output Direction and Control Valve Failure Mode
2.4.4 Proportional, Integral, and Derivative Control Contributions
2.4.5 PID Control Algorithm Options
2.4.6 PID and Cascade Initialization
2.4.7 PID Tuning
2.4.8 Tuning Cascaded Controllers
2.5 Noise, Filters, Plant Testing, and Closed-Loop Control
2.5.1 Signal-to-Noise Ratio
2.5.2 Filtering
2.5.3 Linear Exponential Filter Algorithm
2.6 Ratio Control
2.6.1 Ratio Controller Benefits
2.6.2 Ratio Control and Noise
2.6.3 Ratio Controller Initialization
2.7 Single Input–Single Output Model-Based Control (MBC)
2.7.1 Structure of the Model-Based Control Strategy
2.7.2 Tuning the Model-Based Controller
2.7.3 Filtering the “Raw” Bias
2.7.4 CV Set Point Response
2.7.5 Load Variable Response
2.8 Cascade Wind-up
2.8.1 What Causes Cascade Wind-up
2.8.2 Output and Set Point Clamps
2.8.3 Wind-up Directions
2.8.4 Wind-up Protection
References
Practical Process Control Design with Industrial Applications, First Edition. Alan M. Kugelman.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.1 Introduction 45
Process control strategies implemented in petrochemical plants maintain operations at desired
targets, meet changing operating objectives, attenuate or eliminate the effects of process upsets,
and maintain operations within and at constraints. Despite the penetration of multivariable con￾straint controllers such as DMC (Dynamic Matrix Control) and online optimization applications
(Real-Time Optimization – RTO), most process control is provided by single input (CV), single
output (MV) feedback controllers, either as single loops or in cascades.
Single loop controllers provide minimum control functionality by maintaining one controlled
variable (CV) at a desired set point by making direct adjustments to the process via an output to a
field actuator (e.g., a control valve). A control cascade broadens the scope of the control strategy by
incorporating additional control loops that output set points to a secondary. The ultimate secondary
is the controller that outputs to a field actuator (e.g., a valve), and the ultimate primary is the only
controller whose set point is an operator entry.
2.1 Introduction
This chapter begins by distinguishing between simple (one ultimate primary, one ultimate sec￾ondary) and complex (multiple ultimate primaries or multiple ultimate secondaries) cascades.
This distinction is important because it determines how cascades initialize, how controller wind-up
status and control status are determined, and how a status is communicated up the cascade to
the ultimate primary. These are essential control concepts that must be understood when control
strategies are designed and commissioned.
The digital control system (DCS) software is responsible for the cyclical execution of all DCS
data base resident tags. Each tag executes on a DCS cycle in a scheduled order, in most cases speci￾fied by the user, and performs its configured tasks. On each execution cycle, the DCS performs the
following tasks for DCS resident tags: PV processing, control processing, output processing, alarm￾ing, and limit checking. The essential actions that are part of each task, which are the framework
within which process control achieves its objectives in real time, are summarized.
The PID control algorithm is by far the most important control method used in operating plants.
Thus, this chapter focuses on the fundamentals of the PID algorithm – its analytical forms, its three
control modes and their contributions to the PID’s control calculation, its configuration and tuning
options, how it initializes, and the special role set point initialization plays in cascade initialization.
The important configurable parameter control direction has an essential role in the PID control
algorithm’s output calculation and in resolving a controller’s wind-up status. Many examples are
presented to demonstrate how to configure a PID controller’s control direction.
In a modern DCS, the assignment of control direction to an ultimate secondary is decoupled from
the valve’s failure mode (fail-to-open or fail-to-close – does the valve open or close when the con￾troller’s output increases) via another configurable parameter, output direction. How this is done
for every ultimate secondary and why it is important are explained.
The effects of noise – the random fluctuations superimposed on a process measurement and
filtering on plant testing, controller tuning, and control loop performance are explored for PID,
ratio, and model-based controllers. The linear exponential filter algorithm is presented as the filter
of choice, and the important relationship of its filter time constant and the scan time (execution
frequency) to noise rejection and signal distortion is discussed.
The fundamentals of ratio control – the various ways it is implemented and its initialization – are
also described. Ratio control maintains two process variables at a constant ratio and often has
energy conservation incentives, but its importance is mainly due to its use in multilevel cascades
to implement feedforward control.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License46 2 Feedback Control Essentials
The basic concepts of legacy non-DMC model-based control (MBC) strategies, e.g., single
input – single output (one MV, one CV) control strategies, are presented. The unique feature of
MBC feedback – prediction error and model bias updating, is explained, and its importance is
emphasized. The use of MBC strategies for CV–MV responses with long deadtimes is highlighted,
and its advantages over PID control for CV set point changes are explained. Unlike the PID and
ratio control algorithms, an MBC algorithm is not a standard DCS control algorithm, and its
implementation requires user-provided custom code and configuration.
Control initialization refers to the procedures that commission a single control loop, a portion of
a multilevel cascade, or the entire multilevel cascade without changing the final control element
(e.g., the valve) on the initialization pass – this is called bumpless transfer. The standard DCS fea￾tures that enable cascades to be commissioned bumplessly are explained.
This chapter concludes with an explanation of wind-up, with emphasis on the following essen￾tial issues: (i) the causes of wind-up, (ii) how/why/when a controller sets its own wind-up status,
(iii) wind-up direction, (iv) wind-up protection, and (v) how any secondary controller’s wind-up
status is propagated to its primary, and then up the cascade to the ultimate primary.
2.2 Single Loop Control, Simple, and Complex Cascades
The single loop controls presented and discussed in Section 1.4.3 (see Figures 1.4 and 1.5) are all
examples of basic regulatory controls; they provide the minimum control functionality required to
ensure operability and stability and the production of on-specification products. Almost all
single-loop controls are either flow, level, pressure, or temperature controllers; control of compo￾sition is nearly always implemented via a cascade. Single loop control (see Figure 2.1) maintains
one CV at a desired set point by (TC113) making direct adjustments to the process via an output
to a field actuator, e.g., to a control valve (TV113), to an air-cooled heat exchanger’s air louver
position, to a forced draft fan’s inlet guide vanes, to a turbine-driven compressor’s speed, etc.
A control cascade broadens the scope of the control strategy by incorporating additional control
loops. An example of a simple cascade appears in Figure 2.2; one controller, the primary (TC113),
manipulates the set point of a second controller (FC119), the secondary. The secondary FC113 is
called the ultimate secondary because its output directly affects the process (it moves the valve).
The primary (TC113) can also be called the ultimate primary because its operator-entered set point
FC
110
TI
118
TC
113
PI
120
FI
119
Fuel gas header
F-101
TV113
Figure 2.1 COT Control via a Single Loop
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.2 Single Loop Control, Simple, and Complex Cascades 47
Figure 2.2 COT Control via a Simple Cascade
FC
110
TI
118
TC
113
PI
120
FC
119
Fuel gas header
F-101
SP
FV119
(TC113 SP) represents the strategy’s most important control objective – to maintain F-101 coil outlet
temperature (COT) at its desired target.
Note that when pressure and/or composition variations in the fuel gas line affect fuel gas flow,
FC113 quickly adjusts FV113 to maintain constant flow; a fuel flow upset is avoided and hence
the effect on temperature TC113 PV is very small or nonexistent. The temperature response of the
single loop temperature controller in Figure 2.1 is slower because its response would not start until
the fuel gas flow upset affects the temperature and TC113 PV deviates from TC113 SP.
There are also multilevel simple cascades – an example is presented in Figure 2.3.
The AC95 → TC87 → FC86 cascade’s control objective is to maintain T-101 bottom’s (HVN) qual￾ity (5% distillation point) at an operator-entered set point (AC95 SP). Tower upsets such as a feed
rate change typically affect a tray temperature well before bottoms quality. Adjustments made to
the distillate flow’s set point FC86 SP by temperature controller TC87 will bring the temperature
back to its set point, TC87 SP. If the temperature response is relatively fast compared to the qual￾ity’s (AC95 PV) response, the quality will not change very much. The quality controller “trims”
the temperature controller’s set point, as necessary. Note that an AC95 → FC86 response would be
slower because its response would not start until the feed rate change affects the bottoms quality
and AC95 PV deviates from AC95 SP.
Temperature controller TC87 is both a primary (with flow controller FC86 its secondary)
and a secondary (with quality controller AC95 its primary). Flow controller FC86 is the
ultimate secondary since its output directly affects the process. And AC95 is the ultimate pri￾mary since its operator-entered set point (AC95 SP) represents the strategy’s principal control
objective – maintaining T-101 bottom’s product quality at its desired target.
Remember: No matter how many controllers are in a multilevel cascade, if there is only one ultimate
primary and one ultimate secondary, the cascade is still classified as a simple cascade.
Note: For the process configuration in Figure 2.3, the distillate flow (FC86) would almost certainly
be ratioed to T-85’s feed rate (FC87), with the ratio (RC86) maintained at set point by adjustments
to FC86 SP. RC86 implemented as above would provide steady-state feed rate feedforward control.
With RC86 included in the 5% distillation point strategy, TC87 would reset RC86 SP instead of FC86
SP – the strategy’s cascade structure becomes AC95 → TC87 → RC86 → FC86.
Cascades with one ultimate primary and multiple ultimate secondaries or multiple ultimate pri￾maries and one ultimate secondary are classified as complex cascades. Here are two examples of Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License48 2 Feedback Control Essentials
T
8
5
FC
87
TC
87
Virgin
naphtha
splitter
TI
88
FC
89
CDU
TPA
HVN to
catalytic
reforming
LC
80
FV89
FC
82
AC
95
5% dist
HVN storage point
SP
PC
77
LVN to
storage
FC
83
CW
FC
86
SP
FV86
E-88
TK-941
E-89
Figure 2.3 An Example of a Multilevel Simple Cascade
complex cascades – the first with one ultimate primary and two ultimate secondaries (Figure 2.4),
the other with two ultimate primaries and one ultimate secondary (Figure 2.5).
In Figure 2.4, level controller LC30 adjusts both FC35 and FC36 set points simultaneously to
control D-35’s inventory at its target value (LC30 SP). In Figure 2.5, there are two primaries – F-101
stack O2 (AC124 PV), which has a minimum constraint (AC124 SP) and F-101 firebox pressure
(PC123 PV), which has a maximum constraint (PC123 SP), but only one MV (stack damper posi￾tion). This application, natural draft fired heater combustion control, is an important example of
conventional constraint control – multiple constraint variables to satisfy, but with only one MV, only
one constraint variable can be maintained at its constraint limit, while all other constraint variables
are maintained on the safe side of their constraint limit. This combustion control strategy is an
important and widely implemented application and is used in Chapter 7 to explain the features of
conventional constraint control. There are currently many industrial applications of conventional
constraint control; many examples are presented and discussed throughout the book.
There are two commonly encountered regulatory control strategies that are complex cascades –
split range control (discussed in Chapter 5) and override control (discussed in Chapter 6). Split
range control strategies feature one ultimate primary and two (or more) potential ultimate sec￾ondaries, although at all times the one primary will output to only one secondary. Override con￾trol strategies feature two (or more) ultimate primaries outputting to a single ultimate secondary,
although at any time only one ultimate primary is outputting to the one ultimate secondary.
Why make the distinction between simple and complex cascades? The reason is related
to how cascades initialize, how an individual controller’s control status and wind-up status are Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.2 Single Loop Control, Simple, and Complex Cascades 49
FV35
FV36
FC
36
FC
35
LC
30
SP
SP
D-35
Figure 2.4 Complex Cascade – One Ultimate Primary, Two Ultimate Secondaries
AI
124
Stack
O2
PI
123
Firebox
pressure
FC
119
Fuel
flow
Combustion
air
Stack
damper
HSS
Stack
damper
AIV124 AC124 PC123
Validation
Minimum O2
Max firebox
pressure
SP SP
F-101
Figure 2.5 Complex Cascade – Two Ultimate Primaries, One Ultimate Secondary
determined, and how they are propagated up the cascade to the primary. In modern state-of-the-art
DCS’, cascade initialization, and wind-up protection are standard features that apply to only simple
cascades. For complex cascades, control initialization and wind-up protection are managed by
engineer provided custom code/logic/configuration. This is almost always a nontrivial effort, not
only when the strategy is designed, coded, configured, initially tested, and commissioned, but also Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License50 2 Feedback Control Essentials
for its long-term maintenance. Cascade initialization and wind-up are discussed in Section 2.4.6
(initialization) and Section 2.8 (wind-up).
2.3 Digital Control System (DCS) Work Environment
Measured inputs, calculated inputs, control loops, and calculated control outputs are all assigned
names in the DCS; the names assigned are called tag names. Depending upon the DCS, the terms
tag name, entity name, point record name, and control module name are used and are equiva￾lent. The term tag name or tag will be used throughout this book, and the tag naming conven￾tions used have already been presented in Section 1.3. All tags have tag attributes (many are called
parameters), properties, or values assigned a name or mnemonic in the DCS. There are hundreds
of tag attributes that are applicable to the numerous tag types in any DCS. However, discussions
throughout this book will only reference a small subset of typical attributes that are control-related
and important, e.g., PV, SP, OP, Mode, etc. This book’s use of tag attributes, when referencing a tag
and its attributes, has also been discussed in Section 1.3.
2.3.1 Control System Data Base Organization
All tags and their numerous attributes reside in the DCS memory, and tags (or point records)
make up the DCS data base. All references to tags and point records in the data base is via the
tag name and the assigned attribute (or parameter) mnemonic. Using standard DCS software
(e.g., the “File Builder” in TDC3000, the “Control Builder” in Experion PKS), template or
fill-in-the-blank driven procedures allow additions, deletions, and changes to the data base. For
tags in a control cascade, the PV input source, control algorithm, and supporting logic (e.g.,
control direction), alarm types and priority, controller output destination and supporting logic
(e.g., output direction), and connections among tags needed to structure the control cascade are
all specified. In a state-of-the-art DCS, additions, deletions, and changes to the data base are done
graphically.
Any tag’s record can be retrieved, examined, updated, or changed via console entries and saved
back to the data base. Some tag attributes cannot be changed at an operator’s console (e.g., a con￾troller’s output destination), but anything can be changed using the standard build software pro￾vided the tag’s processing (e.g., PV value update, control algorithm execution) is stopped. Methods
to stop tag processing are DCS dependent, but some examples are to take the tag Off Scan, or make
it Inactive.
In addition to database construction, support, and maintenance, there are other major control
related tasks performed by the DCS. The DCS software is responsible for the execution of all tags.
All tags are scheduled to run at a user specified, fixed frequency. Tags are assigned to a “worklist”
and on each list, tags are executed in a fixed order determined by the tag’s frequency (its scan
rate, TS) and other user-specified configuration parameters. Focusing only on control related tasks,
as the DCS executes each tag on each worklist on a cyclic basis, it performs the following tasks:
PV processing, control processing, output processing, alarming, and limit checking for each tag
on each list. The essential actions that are part of each task are highlighted in the sections that
follow. Note: The specific actions (e.g., PV high/low alarming) within each task (e.g., PV process￾ing) described below represent an overview of the more important steps executed when control
strategies are implemented but do not necessarily apply to any specific DCS.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.3 Digital Control System (DCS) Work Environment 51
2.3.2 PV Processing
PV input processing provides the current value of a measured or calculated PV. Most importantly,
it ensures the measured or calculated input value is suitable as a control input, e.g., a CV.
In addition, PVs are prepared for inclusion in standard operations and process technical daily,
weekly and monthly reports.
If the PV is measured, the PV source is identified and “connected” to the appropriate input
location. If the PV is not an individual measurement, but it must be calculated from other mea￾surements and parameters, some DCS’ provide standard PV algorithms (e.g., add, divide, average,
etc.) that can be used. In state-of-the-art DCS’, there are standard function blocks that can be
combined to provide auxiliary calculations to develop the PV input. If these standard methods are
not appropriate, engineer-provided custom-coded program(s) are the default option. The standard
PV algorithms, function blocks and/or user-provided custom-coded programs are executed each
pass through PV processing to develop the calculated PV input. Important: Because they are easier
to use, build, test and maintain, standard algorithms and standard function blocks are always the
preferred options for calculated PVs.
The “raw” input’s value, either measured or calculated, is checked to ensure it is within its high
and low engineering range; if not, the PV status is declared “Bad,” and it is not available for any
further use on this execution pass. Although typically not recommended for a CV, in some DCS’ an
engineer-specified configuration parameter will allow the input PV value to be clamped at its high
or low range limit, instead of declaring it “Bad.” Some DCS’ store the last good PV value to a tag
attribute (e.g., LastGoodPV) on every execution pass for use as needed on a subsequent execution
pass when the PV is declared “Bad” and using the last good value is acceptable. Note that using the
PV’s last good value does not skew the PV’s history (e.g., 6 minutes, hourly averages) – the “Bad”
value, not the constant last good value, is stored in the DCS resident history data base for the time
period the PV remains unavailable.
The PV input value is also checked against operator- or engineer-entered PV high and low limits.
If it violates a high or low limit, the PV input can be alarmed, and the tag’s high or low alarm flag
set True. When the PV input once again is within its PV high and low limits, the PV high and
low alarm flag is reset to False. Whether or not to alarm, alarm priority (if and how the alarm is
annunciated), and alarm limits are engineer specified.
To enhance PV high/low alarm functionality, many DCS’ provide an optional PV high/low
alarm deadband that can be specified in the tag build. Referring to the PV high alarm example
in Figure 2.6, the optional deadband applies only on the return from an alarm state. After
an upset, temperature TC144 PV starts to deviate from its set point (250 ∘C), increases and
reaches its PV high limit (270 ∘C) at time A, returns below its PV high limit at time B, but
because of the 3 ∘C dead band, TC144 PV comes out of alarm and returns normal (267 ∘C) at
time C.
The dead band prevents the temperature from going in and out of alarm (nuisance “chattering”)
whenever the PV crosses the alarm limit, as illustrated in Figure 2.7.
If configured at tag build, a PV rate-of-change check is performed, and an alarm is issued if
the absolute difference (PVn – PVn−1) exceeds an engineer entered maximum allowed value.
Depending upon the magnitude of the rate-of-change max limit, a maximum PV rate-of-change
alarm can indicate an invalid input measurement or calculation, or for a controller, an invalid
SP entry, an unintentional mode change to manual, or a final control element failure (e.g., a
stuck valve).
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License52 2 Feedback Control Essentials
TC144 SP = 250 °C
PV Hi alarm = 270 °C
Upset
occurs
Temperature
in alarm
3 °C Deadband
(DB)
Time →
PV Hi alarm - DB = 267 °C
TC144 PV Temperature
(°C)
A B C
Figure 2.6 PV High Alarm Limit with Deadband
PV Hi alarm
In
In Out
Out
Out In
In
Figure 2.7 PV High Alarm Limit without Alarm Deadband
If a filter is specified in the tag build (see Section 2.5.2) and a (nonzero) filter time constant has
been entered, the PV input is filtered before it becomes the control calculations PV input.
2.3.3 Control Processing
During control processing, the control algorithm is executed, and the control output is calculated.
If set point ramping has been specified, and if ramping is needed, the SP’s value for the current
execution pass is calculated. Control calculations can be implemented using standard DCS
control algorithms, using standard DCS function blocks, or as a default option, via user-developed
custom-coded program(s). In state-of-the-art DCS’, the function blocks provided include both
mathematical and logical operations; therefore, even logical checks and logical results can be
configured using standard DCS function blocks. Standard algorithms and standard function blocks
are always preferred options for the control calculation because they are easier to use, build, test,
and maintain.
Important: As discussed in Section 2.2, in state-of-the-art DCS’, cascade initialization and wind-up
protection are standard DCS features (so-called “cascade rules”) that apply to simple cascades but
not to complex cascades. Even if the control strategy is a simple cascade, using a nonstandard
approach to implement a control calculation requires additional thought, and perhaps logic and
code, to ensure standard cascade rules apply to cascade initialization and wind-up protection.
Note: Model-based control algorithms are nonstandard, and their use requires user-provided cus￾tom code/configuration; model-based controller initialization requires custom code/configuration
as well.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.3 Digital Control System (DCS) Work Environment 53
If configured at tag build, a maximum controller deviation check is executed during control
processing, and a deviation alarm is issued if the difference between a controller’s PV and SP (con￾troller error) exceeds its maximum allowed value. A max deviation alarm can indicate a tuning
problem, an invalid set point, an invalid PV measurement or calculation, omission of a secondary
set point or output clamp limit, or an inoperable final control element (e.g., a stuck valve). The
value of the max deviation limit must be chosen carefully – controller outputs that reflect a valid
set point change or a large but valid upset must not be alarmed. Therefore, the decision to use a
max deviation alarm and the choice of the max deviation alarm limit should be made carefully and
only after discussion with appropriate plant personnel (operations, process technical specialists).
2.3.4 Output Processing
Output processing validates the control algorithm’s calculated output prior to sending it to its
destination – the secondary controller’s SP, or if outputting to a valve, the analog output (A/O)
block.
If outputting to a secondary’s SP, the controller output must be within the secondary’s operator or
engineer entered SP high and low limits. These SP “clamps” are the secondary’s maximum or min￾imum allowed SP values, and almost always relate to a process constraint. If outputting to a valve,
the control output must be within the operator or engineer entered OP high and low limits. These
OP “clamps” are a controller’s maximum or minimum allowed outputs to a field actuator (e.g.,
a control valve) and thus are almost always related to a physical constraint (e.g. a full open/closed
valve position). Whether constrained by the secondary’s SP or the controller’s own OP clamps, the
controller’s output is clamped at the violating high or low limit, and the controller’s wind-up status
(discussed in Section 2.8) is set to either High or Low. This is one example of how a control loop’s
integrity can be protected, and potential upsets avoided, without operator intervention.
Before a primary controller outputs a new set point to its secondary, the mode of the secondary
must be checked; if not in Cascade mode, the output cannot be sent to the secondary’s SP. This
sets the primary controller’s wind-up status to HighLow, or “output indisposable,” e.g., indicating
it cannot send its output to the secondary’s SP, whether it increases the SP or decreases the SP.
In addition to the secondary’s mode, the primary also checks the secondary’s wind-up status.
If normal, there are no secondary set point or output constraints, and both can be changed in
either direction. If the secondary is wound-up high, its set point cannot be increased, but it can
be decreased. If wound-up low, its set point cannot be decreased, but it can be increased. Based on
the wind-up status of its secondary and its own control direction, the primary controller’s wind-up
status is set.1
With the secondary’s wind-up status known, and the controller’s own wind-up status resolved,
if the controller is itself a secondary, its newly resolved wind-up status is passed up to its primary;
if necessary, the primary will reset its wind-up status the next time it executes. A newly resolved
wind-up status will continue to be passed up the cascade, from controller to controller, with each
controller resolving its own wind-up status, until the cascade’s ultimate primary sets its wind-up
status.
If configured to do so, a controller output rate-of-change check is also performed during output
processing. The difference between the current and last execution pass’ control outputs must
be greater than a minimum difference and smaller than a maximum difference. The maximum
rate-of-change limit is chosen to prevent an upset in downstream units, while the minimum rate-of￾change limit is chosen to prevent nuisance adjustments. If either the minimum or maximum
rate-of-change limit is violated, the current output is clamped at a value that does not violate either
1 The dependency of wind-up status on control direction is discussed in Section 2.8.3.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License54 2 Feedback Control Essentials
the minimum or maximum rate-of-change limit. The most likely cause for an active maximum
output rate-of-change alarm is an invalid SP entry, e.g., a new set point too different from the
current set point. Therefore, the value of the max output rate-of-change limit must be chosen
carefully to ensure controller outputs are not suppressed after a valid set point change, or a large
but valid upset. Note that the secondary’s current wind-up status is read and considered before
limiting the controller’s output to satisfy the max or min rate-of-change limit.
When a controller’s output is rate-of-change limited, the controller’s wind-up status is not set.
This is especially important if the controller is itself a secondary. While rate-of-change limited out￾puts are being sent to its secondary’s SP, the controller may not be able to satisfy its own SP. If so,
because its primary continues to change its SP, its own SP may slowly wind-up. Depending upon
the process and the loop’s control objective, a high output rate-of-change violation can become
problematic. Therefore, the decision to use output rate-of-change checks and the choice for the
output rate-of-change clamps must be made carefully and only after discussion with appropriate
plant personnel (operations, process technical specialists).
Note that in some DCS’, an output rate-of-change (maximum) violation can be alarmed. If so, the
potential wind-up problem described above will be brought to the attention of operators quickly
and should reduce the violation’s potential consequences. If the DCS supports a maximum output
rate-of-change alarm, use of this functionality should be considered on a loop-by-loop basis for high
output rate-of-change violations.
2.3.5 Alarming
Alarms are used only for situations that require operator intervention or follow-up. As discussed
in Section 1.7.2, alarms are prioritized according to their importance and potential impact on
safety. Alarms that impact safety and require immediate operator response are assigned to the
emergency priority category and are implemented in safety protection hardware, independent of
the DCS. Emergency alarms are audibly and visually (via back-lit alarm windows) annunciated
at the operator’s console. These hardwired alarms are specified initially by process designers.
Additions, deletions, and general maintenance are the responsibility of alarm management and
instrument specialists, with input from process technical personnel.
There are several standard DCS alarms that are useful in process control and, on a limited basis,
are incorporated by control engineers into a control strategy’s design. However, care must be taken
to ensure any control application-related alarming is consistent with the site’s Alarm Manage￾ment procedures. Sites routinely limit the number of process control-related alarms because too
many alarms will reduce operator attention to all alarms. Therefore, before including an alarm in
a control strategy, it is best to seek consent by discussing its rational and importance with alarm
management, operations, and process technical personnel. Control engineers are involved in devel￾oping and then keeping the alarm management system current. Alarm management specialists,
normally with control engineering experience, are responsible for the alarm management system’s
organization and long-term maintenance.
From among the many available alarms provided by a typical DCS, the most used alarms in sup￾port of control strategies have already been discussed: PV high and low alarms in Section 2.3.2, PV
rate-of-change alarms and controller deviation alarms in Section 2.3.3, and output-rate-of-change
high and low alarms in Section 2.3.4. Typical alarm priorities assigned to DCS resident alarms are
High, Low, and log only. Alarms are annunciated at operator consoles by color changes or other
display indications (blinking character) on the schematic display used by operators as an interface
and/or to monitor the control strategy. Other than fired heater flood alarms, there are normally no
DCS control-related alarms assigned an emergency priority. All alarms, no matter their priority, are
logged into process history with date and time stamps.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.3 Digital Control System (DCS) Work Environment 55
2.3.6 Limit Checking and Clamping
Limit checking and clamping affect control performance without operator attention or inter￾vention. The most important control-related limit checking, and clamping are associated with
controller set points and outputs. An output clamp usually relates to a physical constraint (e.g.,
valve, damper, and air-fin louver positions) while a set point clamp usually relates to a process
constraint. As will be discussed in Section 2.8, set point and output clamps play a central role in
the resolution of controller and cascade wind-up.
The roles of set point and output clamping in output processing have already been discussed in
Section 2.3.4 and are summarized below.
● Set point high and low clamps limit a controller’s SP to an allowable range, for both
operator-entered set points and set points calculated by a secondary’s primary controller.
● Controller output high and low clamps limit a controller’s output to an allowable range, for both
operator-entered outputs or outputs calculated by controllers in a cascade, from the ultimate
primary to the ultimate secondary.
● Controller output-rate-of-change high and low clamps limit a controller’s current output to a
value that does not violate either the minimum or maximum allowable change in controller out￾put, between the current and last calculation passes.
Output and set point clamps are used frequently by control engineers during online testing and
tuning of new control applications. Before a new application can be commissioned, i.e., always
expected to be in control, it must be tested online to ensure it meets its design/control objectives.
All PID controllers must be tuned. All logic paths must be tested to confirm the logic executes as
expected. Cascade initialization and wind-up protection must be tested. To prevent process upsets
or movement too far from the current operating point, in many cases, tight set point and/or output
clamps are initially placed on the ultimate secondary. As the testing progresses and confidence
builds for the application’s reliability, the clamps are slowly relaxed. If the ultimate secondary’s
original clamp values are real process constraints, they must be returned to their original values.
2.3.7 Operator Interface
Schematic displays provide a highly effective interface to both plant operations and control applica￾tions and are universally accepted as the best user interface for operators. Operations schematics,
which are P&ID type displays, present process data that describe a unit’s current operations, includ￾ing active alarms, active constraints, and various control related status’, all superimposed on a flow
diagram representation of the process configuration. Application schematics present an applica￾tion’s control cascade structure, e.g., all inputs and the links between primaries and secondaries.
They display the application’s On/Off status, and all application-related information (process data,
process calculations, and control status’) needed by and/or propagating up/down the application’s
cascade. All sites have schematic display standards, developed in conjunction with the operations
staff and/or the DCS vendor, that must be used by all who design and/or build schematics.
As the primary operator interface, operations schematics are used by operators to monitor and
assess a unit’s status, to make routine console entries that change current operating conditions, and
to respond to alarms and console messages. Controller set points, outputs and modes are changed,
as well as high and low PV, set point, and output clamp limits, and other necessary entries (e.g., the
number of fired heater burners in service). Historical data can be recalled and displayed at the
console in tabular form or in preconfigured trends. Standard reports that summarize environmental
data, energy and steam utilization, lab data history, active alarms/inhibited alarms, feed/product Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License56 2 Feedback Control Essentials
tank inventory and content, specific unit operations, and many others can be demanded; some can
be displayed at the operator’s console.
There are two general categories of operations schematics. Overview type operations schematics
present a “big picture” view of a process unit, while detailed type operations schematics focus on
smaller sections of the process and include a far more in-depth view of current operating conditions.
The overview and detailed operations schematics are logically linked, and precoded targets allow
operators to move from one display to another and obtain a more complete set of process conditions
to help them assess their unit’s operating status. Links to related control application displays are
often included in both.
Experienced operators and other operations staff are important resources when operations
schematic designs are specified, e.g., they provide advice on layout, scope, information content,
and linkages. Operations schematics are typically built and maintained by specially trained
experienced operators and/or DCS vendor display specialists.
Application schematics present the control strategy’s cascade structure, e.g., controller input
(SP and PV) and output values, modes, control initialization status’, wind-up status’, alarm sta￾tus’, high/low clamp values, active constraints, and other applicable logical states, superimposed
on a scaled down representation of the process configuration. Application schematics serve as the
operator interface to applications – e.g., for turning them on and off, entering ultimate primary
set points, changing modes, changing constraint high/low limits, etc. Where needed, targets are
provided for operators to enter application specific items such as his/her choice for a secondary
or approval for a fresh validated lab result to be used in control (e.g., to update a model-based
controller’s bias). These schematics also contain targets to allow easy navigation to other related
displays that help an operator assess the application’s current impact and performance.
At many sites, an application On/Off software switch is provided for operators to use when
they commission and decommission more complex applications. If so, the application schematic
includes a target that is linked to the switch and allows an operator to activate the On (if Off) or Off
(if On) logic. Before turning the application on, the switch logic ensures all conditions required to
allow commissioning (as specified by the control engineer) are true. In most cases, the application
is turned on by transferring the ultimate secondary’s mode to Cascade. The switch logic runs on
a regular frequency in background mode and does status and consistency checks to determine
whether the application should be turned off. If it detects a condition which warrants decom￾missioning (also specified by the control engineer), it turns the application off, in most cases by
transferring the ultimate secondary’s mode to Auto or perhaps Manual. The switch logic normally
can only automatically decommission an application; only an operator activating the switch via the
schematic’s dedicated target can commission the application.
The primary responsibility for the application schematic’s design rests with the control engineer
who will commission the application. Pre-commissioning input and post-commissioning feedback
from experienced operators are always sought to improve the schematic’s layout and functionality.
Long term, maintenance needs are specified by the responsible control engineer; update of the
schematic itself is usually the responsibility of the person(s) maintaining the operations schematics.
2.3.8 History, Reports, and Trending
The DCS collects process data (spot values) and routes the data to an outboard computing
environment such as Honeywell’s Uniformance PHD (Process Historian Database) for averaging
(6-minute and hourly averages) and historization. Complex process calculations – emissions
monitoring and control, environmental stewardship, inferential property prediction, and process
unit performance summaries are performed and historized on the outboard computing envi￾ronment. Typically, only control-related monitoring and/or process calculations are done in the Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.4 PID Control Algorithm Basics 57
DCS. Other outboard environment applications such as Laboratory Information Management
System (LIMS) collect laboratory data and make the data available to the outboard computing
environment for historization. Available methods enable lab data to be downloaded from the
LIMS to the DCS for display and for use in control (almost always MBC).
Historical data is organized into standard reports on the outboard computing platform for various
purposes and customers. For example, reports are configured to gather historical data for envi￾ronmental monitoring (SOX, NOX, CO, Flares), process monitoring (heat exchanger performance,
FCCU coke balance), material balance monitoring (H2 balance, LPG balance), energy monitoring
(cooling tower efficiency, steam utilization, plant-wide energy utilization) and plant performance
(active and inhibited alarms, active constraints, DMC service factor summaries). Customers for
these reports are operations personnel, control and process engineers, instrument and analyzer
maintenance engineers, and plant management. Reports are sometimes printed but always made
available electronically on a shift, daily or monthly basis, depending upon its intended use. Some
reports, with time sensitive information that operators routinely use, can be called up at a console
and used by operators.
Trends can be configured to include both DCS spot values and historical data. Preconfigured
trends can be displayed on a screen dedicated to trends or from a schematic using a target that calls
up a trend display. Temporary trends can also be user-configured “on the spot” by operators and
process and control engineers.
2.4 PID Control Algorithm Basics
To introduce the PID control algorithm discussion, consider the simple control loop example and its
basic control features, as shown in Figure 2.8. Tower temperature TC138 PV is the CV, steam flow
valve position TV138 is the MV and tower feed rate FI187 PV is a disturbance variable (DV). The
loop’s control objectives are (i) to maintain TC138 PV at its set point (TC138 SP) despite changes
in tower feed rate FI187 PV and (ii) to move tower operations (TC138 PV) to a new operating point
when TC138 SP is changed. The tower temperature control loop’s block diagram representation
in Figure 2.9 graphically indicates how the controlled, manipulated, and disturbance variables are
related.
As shown in Figure 2.9, temperature controller TC138 outputs to control valve TV138, but it is
the steam flow changes caused by the TV138 adjustments that affect the temperature. This is true
for any ultimate secondary that outputs to a valve – it is the flow change that affects the CV. And
when feed rate FI187 PV changes, it is the combined effect of the feed rate’s change on TC138 PV
and the control adjustments to TV138 that determine the steam flow (FI189 PV) corrections that
establish the value of temperature.
In the classical approach to process control, a PID controller occupies the feedback control box in
Figure 2.9. The PID controller is a “black box,” i.e., it has and requires no knowledge of the process
and does not anticipate needed adjustments. As the feedback path in Figure 2.9 demonstrates,
TC138 control adjustments begin after the feed rate changes affect TC138 PV – after it begins to
deviate from TC138 SP and its controller error [PV – SP] ≠ 0. The magnitude and sign of the control
adjustments are a function of the magnitude and sign of error, tuning parameter values, and how
the controller is configured.2 A controller’s tuning parameters are adjusted to obtain the desired
control performance,3 and then (ideally) fixed. Discussions to follow will show that knowledge of
the process dynamics is helpful when tuning the PID. Controller performance can be improved by
2 PID configuration options are discussed in Sections 2.4.5.
3 PID tuning is discussed in Section 2.4.7.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License58 2 Feedback Control Essentials
T
1
6
9
E-89
TI
188
FI
187
TC
138
TV138
FI
189
HP
steam
TI
138
Tower
feed rate
Figure 2.8 Tower Temperature Feedback Control Loop
Process unit
configuration
Feedback
control
TC138 PV
MV
(TV138 →
FI189 PV)
Actuator
hardware
Measurement
hardware
+
CV
(TC138 PV)
TC138
TC138 SP
Process unit
DV configuration
(FI187 PV)
FI187 PV’s
effect on
TC138 PV
FI189 PV’s
effect on
TC138 PV FI
189
Reboiler
steam flow
TV138
Figure 2.9 Tower Temperature Control Loop Block Diagram
including process knowledge; the most common method4 used is to combine PID feedback control
with feedforward control (illustrated conceptually in Figure 1.2).
The PID algorithm provides three control modes or actions: proportional (P), integral (I), and
derivative (D) action. Although there are some applications of P-only and I-only control, the most
common PID controller is the PI, followed by the full PID. The analog control devices of the past
worked in the time domain and therefore they used the continuous-time version of the PID algo￾rithm given below:
Proportional Integral Derivative
M(t) = M(0) + KC * [E(t) + E(w)dw + τD ⌠
⌡ ]
dE(t)
dt
1
τI
t
w = 0
(2.1)
4 Feedforward control essentials are discussed in Chapter 3.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.4 PID Control Algorithm Basics 59
where:
M(t) – controller output
M(0) – controller output when controller transferred to Auto mode
E(t) – controller error = PV – SP
KC – proportional gain (in CV engineering units/MV engineering units)
𝜏I – integral time (min)
𝜏D – derivative time (min)
The PID algorithm in Equation (2.1) is the full-valued, noninteracting (or ideal) form of the algo￾rithm. The full-valued form calculates the current controller output or MV value directly, M(t), not
the change in the output or MV, ΔM(t). The noninteracting form’s integral and derivative actions
are independent; the noninteractive form is also called the ideal form. Notice that KC scales all
three modes. Tuning a PID controller refers to adjusting the tuning parameters, KC, 𝜏I, and 𝜏D,
until the control variable’s response meets a consensus performance criterion.
There is a second version of the PID, the interacting (or nonideal or real) form available in some
older DCS’ – a remnant of the PID algorithm used in analog controller hardware. The interacting
form of the PID contains an additional term multiplied by the ratio 𝜏D/𝜏I. Therefore, the integral
and derivative control actions are not independent, making tuning more difficult. If there is no
derivative action (𝜏D ≡ 0), the noninteractive and interactive algorithms are the same. Because it is
available in all DCS’ and by far the preferred form, only the noninteracting form is used in this book.
Our modern control systems are digital, i.e., data is sampled at a fixed frequency, the sample
time TS, and process information is known only at discrete-time intervals of width TS. Therefore,
the continuous-time version of the PID algorithm is invalid in a DCS, and only the discrete time
version of the PID control algorithm is suitable for use in a DCS.
2.4.1 Discrete Version of the PID
The starting point for deriving the discrete time version of the PID is the continuous-time,
full-valued, noninteracting form of the algorithm in Equation (2.1). Converting the proportional
action to its discrete version is straightforward:
KC ∗ E(t) = KC ∗ En (2.2)
where En is the value of error at time step n. However, converting the integral of error and derivative
of error terms in Equation (2.1) to discrete versions requires approximations for each. Starting with
the integral term, Figure 2.10 shows how the integral of error term (the area under the E(t) versus
time curve) is approximated by a summation:
∫
t
w=0
E(w)dw ≈ ∑n
i=0
Ei ∗ Δt = ∑n
i=0
Ei ∗ TS = TS ∗ [E0 + E1 + E2 … En+3 … En] (2.3)
Note that TS, the sample time or the time between time steps,5 has replaced Δt in Equation (2.3).
From Equation (2.1):
1
𝜏I ∫
t
w=0
E(w)dw ≈ TS
𝜏I
∗
∑n
i=0
Ei (2.4)
For the derivative term, Figure 2.11 shows how the derivative of error term is approximated.
Instead of the exact derivative, e.g., the slope of the tangent at a discrete time at an interval of
5 TS will also denote a tag’s scan rate – its frequency of execution.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License60 2 Feedback Control Essentials
Time →
Error
En
En–2 En–1
En+1
En+2
En–3
En+3
TS
TS = sample time = ∆t
 = time between data samples
n–4 n–3 n–2 n–1 n n+1 n+2 n+3 n+4
Time step
Figure 2.10 Approximating Integral Control Action
Error Time →
n–2 n–1 n
dE
dt ≈ @ n
dE
dt ≈ @ n–1
En–1
En En–2
TS TS
TS = sample time
Time step
Figure 2.11 Approximating Derivative Control
Action
sample time TS, the derivative is approximated by the difference in error at two time steps, n and
n−1, that are TS time units apart.
At time step n:
dE
dt
@n ≈ En − En−1
TS
(2.5)
Again, TS has replaced Δt in Equation (2.5). From Equation (2.1):
𝜏D
dE
dt ≈ 𝜏D
TS
∗ (En − En−1) (2.6) Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.4 PID Control Algorithm Basics 61
Substituting Equations (2.2), (2.4) and (2.6) into Equation (2.1) yields the discrete time,
full-valued, noninteracting form of the PID algorithm:
Mn(%) = M0(%) + KC ∗
[
En +
TS
𝜏I
∗
∑n
i=0
Ei + 𝜏D
TS
∗ (En − En−1)
]
(2.7)
In our modern-day DCS’, the PID algorithm executes with PV and SP in percent of range of the
CV’s engineering unit (EU) range and the MV is calculated as a percent of range of the MV’s EU
range. Therefore, in Equation (2.7), Mn (%) is the current controller output in % of range of the MV’s
EU high/low values (MVH and MVL – see Equation (2.8a)) and M0 (%) is the controller output in
% of range of the MV at time step n = 0 when the controller was transferred to Auto mode. The PV
input and set point entries used to calculate error (En, En−1, etc.) are in percent of range of the CV’s
EU high/low values (CVH and CVL – see Equation (2.8b)):
Mn(%) = (MVn − MVL)
(MVH − MVL) ∗ 100% (2.8a)
PVn(%) or SPn(%) = (PVn or SPn − PVL)
(PVH − PVL) ∗ 100% (2.8b)
En = SPn(%) − PVn(%), En−1 = SPn−1(%) − PVn−1(%),… E0 = SP0(%) − PV0(%) (2.8c)
MVn, PVn, and SPn in Equations (2.8a) and (2.8b) are in EUs. Equation (2.8c) indicates the error
terms, En, En−1 … E0, in percent of range of the CV are differences between PVn (%) and SPn (%).
The PID algorithm in Equation (2.7) is the full-valued algorithm, i.e., it directly calculates the
controller output at the current time step, Mn (%), in % of range of the MV. However, most control
engineers consider the change in MV from one time step to the next time step as a more mean￾ingful indication of the control loop’s intent. The incremental form of the PID algorithm can be
developed by writing the discrete-time full-valued form of the PID algorithm in Equation (2.7) at
time steps n and n−1, and then subtracting the two results.
For time step n:
Mn(%) = M0(%) + KC ∗
[
En +
TS
𝜏I
∗
∑n
i=0
Ei + 𝜏D
TS
∗ (En − En−1)
]
(2.9a)
and for time step n−1:
Mn−1(%) = M0(%) + KC ∗
[
En−1 +
TS
𝜏I
∗
∑n−1
i=0
Ei + 𝜏D
TS
∗ (En−1 − En−2)
]
(2.9b)
When Equation (2.9b) is subtracted from Equation (2.9a), the M0 (%) term in each equation and the
E0, E1 through En−1 terms in both integral mode sums cancel. The result is the discrete, incremental,
noninteracting form of the PID algorithm:
ΔMn(%) = KC ∗
[
(En − En−1) +
TS
𝜏I
∗ En + 𝜏D
TS
∗ (En − 2 ∗ En−1 + En−2)
]
(2.10)
ΔMn (%) is the change in controller output in % of range of the MV at time step n. The current
value of the controller output in % of range of the MV at time step n, Mn (%), is calculated by
adding the change in output calculated in Equation (2.10), ΔMn (%), to the last time step’s output
value, Mn−1 (%):
Mn(%) = Mn−1(%) + ΔMn(%) (2.11) Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License62 2 Feedback Control Essentials
PID algorithm
MV MVn
% of range → EU
EU
EU → % of range
CV PV
Mn (%) = Mn–1 (%) + ∆Mn (%) ∆Mn (%) Mn (%)
SP (%)
Mn (%)
EU =Engineering units
CVH = CV EU range high
CVL = CV EU range low
MVH = MV EU range high
MVL = MV EU range low
Note:
Mn (%) is controller OP
in % of range of MV
CV SP
(PV – CVL) * 100%
(CVH – CVL)
(SP– CVL) * 100%
(CVH – CVL)
PV (%)
EU
SP (%)
PV (%)
Equation (2.8b)
Equation (2.10) Equation (2.11)
Equation (2.12)
Mn (%) * (MVH –MVL)
100%
+ MVL
Figure 2.12 PID CV and MV EU Range and % Range Conversions
Note: The last time step’s output value, Mn−1 (%), is always available because the current control
pass’ output value, Mn (%), is stored to a last value location for use on the next pass, e.g., Last
Value = Mn (%) and on the next pass, Mn−1 (%) = Last Value. The current value of the MV in EUs,
MVn, is calculated using Equation (2.8a) re-arranged to solve for MVn:
MVn = (MVH − MVL)
100% ∗ Mn(%) + MVL (2.12)
Remember that the PID algorithm executes with the PV and SP in percent of range of the CV’s
EU range. The MV is calculated as a percent of range of the MV’s EU range, and then converted
to EUs. Thus, unit conversion calculations are a necessary part of the PID algorithm’s execution.
The calculation steps and information flow on each control pass, from inputs (PV and SP in EU)
to outputs (controller output in % of range of MV, and MV in EU) are illustrated in Figure 2.12.
Each calculation references the equation in the text that describes the boxes’ computation.
Note: The calculation overview in Figure 2.12 does not necessarily mirror a specific DCS but is
meant to conceptually illustrate the steps involved in a generic PID execution pass. Some DCS’ use
the incremental version of the PID algorithm, apply the ΔMn (%) result to calculate the full-valued
controller output and MV value in EU, Mn (%) and MVn, but do not make the value of ΔMn (%)
available for further control engineer use, or for display.
Remember: We will continue to use the notation displayed in Figure 2.12 – (i) PVn and SPn are in
EU, (ii) PVn (%) and SPn (%) are in % range of the CV, (iii) MVn and ΔMVn are in EUs, and (iv) Mn
(%) and ΔMn (%) are in % of range of the MV.
Important: Because the PID algorithm’s calculations are done with CV and MV in percent of their
EU range e.g., (MVH – MVL) and (CVH – CVL), the proportional gain, KC, is scaled by the CV and
MV EU ranges, e.g. (MVH – MVL)/(CVH – CVL). As a result, the proportional gain tuning parameter
that the control engineer adjusts is unitless. This has a desirable unintended consequence – the
values of KC typically have reasonable magnitudes.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.4 PID Control Algorithm Basics 63
Equation (2.10) features derivative action based on error:
KC ∗ 𝜏D
TS
∗ (En − 2 ∗ En−1 + En−2) (2.13a)
When an operator changes the set point, there is a step change in the error. For derivative action
on error in Equation (2.13a), this can cause an unnecessarily large initial change in ΔMn (%)
and complicate the normal reliance on proportional action to respond to a set point change. By
configuring derivative action on PV instead of error, set point changes do not directly affect deriva￾tive action:
KC ∗ 𝜏D
TS
∗ (PVn(%) − 2 ∗ PVn−1(%) + PVn−2(%)) (2.13b)
By comparing Equations (2.13a) and (2.13b), derivative action for a load upset (constant set point)
is the same for either the error or PV option, provided the tuning parameters (KC, 𝜏I, and 𝜏D) and
scan time (TS) are identical. Therefore, provided the DCS offers a derivative on PV option (true for
most modern-day DCS’), the PV option is the recommended choice. If derivative action is desired,
the PID algorithm in Equation (2.10), updated to reflect derivative action on PV, is the PID version
almost always used in practice:
P-I-D
ΔMn(%) = KC ∗
[
(En − En−1) +
TS
𝜏I
∗ En + 𝜏D
TS
∗ (PVn(%) − 2 ∗ PVn−1(%) + PVn−2(%)]
(2.14)
In practice, derivative action is used for some temperature control loops (e.g., tower tray tem￾perature control) and for control loops whose control variable’s response to MV changes include
quantifiable deadtime (e.g., some product quality and composition controllers). The most used
form of the PID algorithm is the proportional-integral (P-I) controller:
P-I
ΔMn(%) = KC ∗
[
(En − En−1) + Ts
𝜏I
∗ En
]
(2.15)
Other forms of the PID algorithm used in special situations are the proportional-only (P-only) and
integral-only (I-only) controllers:
P-only
ΔMn(%) = KC ∗ [(En − En−1)] (2.16)
I-only
ΔMn(%) = KC ∗ TS
𝜏I
∗ En (2.17)
In Section 2.4.4, the contributions proportional, integral, and derivative actions make to the con￾troller response are summarized, and in Section 2.4.5, another PID algorithm option – the propor￾tional on PV option, is described.
2.4.2 PID Control Direction
Inspection of Equations (2.14)–(2.17) indicates the sign of the proportional gain, KC, determines
whether the MV change, ΔMVn, is positive or negative, and referring to Equation (2.11), whether
the controller output, Mn (%), increases or decreases on this control execution pass.
Figure 2.13 below shows two control cascades, a T-115 bottoms level controller (LC131) manip￾ulating bottoms flow rate (FC126) and a T-115 tray temperature controller (TC136) manipulating
reboiler steam flow (FC155).
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License64 2 Feedback Control Essentials
FI
126
TC
136
TI
136
FC
155
Steam
LC
131
FV155
FC
126
FV126
T
1
1
5
Figure 2.13 Tower T-115 Bottoms Level and
Tray Temperature Controls
If LC131 PV is increasing toward or exceeding LC131 SP, LC131 must increase bottoms flow
FC126 SP to return level back to set point. Assume LC131 is a PI controller (Equation (2.15)). If
level LC131 PV is increasing with no change to LC131 SP, the proportional term, En – En−1, is
positive. Since an increasing level is either exceeding or will eventually exceed its setpoint, the
integral term, En, is also positive. With KC positive, ΔMn (%) is positive, Mn (%) is greater than
Mn−1 (%), MVn is greater than MVn−1, FC126 SP is increased and in response, bottoms flow FC126
correctly increases.
Now look at the tray temperature control loop and go through the same thought sequence. If
TC136 PV is increasing toward or exceeding TC136 SP, TC136 must decrease reboiler steam flow
FC155 SP to return the tray temperature back to set point. Again, assume TC136 is a PI controller.
If tray temperature TC136 PV is increasing with no change to TC136 SP, using equivalent reasoning
as above for LC131, the proportional term, En – En−1 and the integral term, En, are both positive.
With KC negative, ΔMn (%) is negative, Mn (%) is less than Mn−1 (%), MVn is less than MVn−1, FC155
SP is decreased and in response, steam flow FC155 correctly decreases.
Most DCS’ allow a negative proportional gain to be entered at the console and allow its use in
the PID calculation. However, if KC is negative, as is necessary for TC136 above, and the nega￾tive sign is mistakenly omitted when a new value of KC is entered for TC136, positive feedback
follows. With a positive value of KC entered, the ΔMn (%) calculated is positive, Mn (%) is greater
than Mn−1 (%), MVn is greater than MVn−1 and steam flow increases. With steam flow increasing,
TC136 PV increases. Therefore, instead of reducing TC136 PV’s deviation from TC136 SP, the con￾trol adjustments increase them. Because there is no inherent self-correction, this continues until
steam rate reaches its maximum value.
To avoid the use of negative proportional gains, modern DCS’ provide a PID algorithm
parameter – control direction, either Direct or Reverse, that must be configured at controller tag
build time. Control direction specifies whether a controller’s output should increase (Direct) or
decrease (Reverse) when its PV is increasing toward or exceeding its set point. In the two examples
above, LC131’s control direction would be configured as Direct (increase output when PV is
increasing), while TC136’s control direction would be configured as Reverse (decrease output
when PV is increasing).
The correct control direction must be assigned to every controller in a cascade. The analysis
needed, described above for LC131 and TC136, is typical for all PID controllers, including ultimate Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.4 PID Control Algorithm Basics 65
secondaries FC126 and FC155. However, as discussed next, assigning a control direction to ultimate
secondaries outputting to a control valve, such as FC126 to FV126 and FC155 to FV155, needs
further clarification.
2.4.3 Output Direction and Control Valve Failure Mode
Control valves such as FV126 and FV155 have a failure mode – loss of the actuator signal
(instrument air) results in either a full-closed valve (an air-to-open valve), or a full-open valve
(an air-to-close valve). The valve type is a design decision, based on the valve’s process service
and site safety protocols; thus, it is known when the ultimate secondary’s control direction is
configured. To determine FC126’s control direction, use this reasoning – if FC126 PV is increasing
toward or exceeding FC126 SP, then FC126’s output to valve FV126 must close the valve to return
FC126 PV to its set point. But whether FC126 OP must increase or decrease to close FV126 depends
upon the valve type – if air-to-open, FC126 OP must decrease, if air-to-close, FC126 OP must
increase. It appears that assigning a control direction to FC126 requires knowledge of FV126’s
valve type. However, this is not true – in a modern DCS, ultimate secondary outputs are connected
to an output block or an AO block, and the AO block’s configurable output direction (Direct or
Reverse) parameter manages the valve’s failure mode, independent of the ultimate secondary’s
control direction.
As primary (and non-ultimate secondary) controllers, the control directions of LC131 and
TC136 were determined, knowing their secondary’s set points increase (or decrease) as their
outputs (LC131 OP and TC136 OP) increase (or decrease). Because DCS functionality manages
a valve’s failure mode via an AO block, independent of the ultimate secondary, an ultimate
secondary can have any control direction and still achieve its control objective no matter the
valve’s failure mode. This means the ultimate secondary’s control direction can be specified by
assuming the valve % opening increases (decreases) as the ultimate secondary’s output increases
(decreases). This provides an important principle – for an ultimate secondary, output always
means % open, and therefore, an increase in output opens the valve and a decrease in output closes
the valve.
Given its process service, FV126 is almost certainly an air-to-close valve that fails open to empty
T-115 bottoms inventory on loss of instrument air. Let us return to the determination of FC126’s
control direction. Figure 2.14 illustrates how FC126’s control direction and FV126’s AO block’s
output direction, chosen independently, manage an FC126 OP decrease from 40% to 30%.
Now that we know that any controller’s output, including an ultimate secondary, means % open,
if FC126 PV is increasing, then FC126’s output must decrease to close valve FV126. Thus, FC126’s
control direction is Reverse. As shown at the top, right in Figure 2.14, air-to-close valve FV126 is full
open at FV126 OP = 0% and fully closed at FV126 OP = 100%. Because FV126 is an air-to-close
valve, FV126’s AO block’s output direction configuration is Reverse. Assume FC126 OP decreases
from 40% to 30%; this indicates FC126 wants to close the valve, from 40% open to 30% open. The
40% → 30% valve closing desired by FC126 (in FC126 OP) is converted to a FV126 % open valve
position change from 60% → 70%. But as shown at the bottom, right in Figure 2.14, this correctly
closes the valve (decrease % opening by 10%) and FC126 PV is reduced.
To determine FC155’s control direction, assume FV155 is an air-to-open valve, i.e., it fails closed
and shuts off steam to T-115 on loss of instrument air. Figure 2.15, equivalent to Figure 2.14 but for
FC155, illustrates how FC155’s control direction and FV155’s AO block’s output direction, chosen
independently, manage an FC155 OP increase from 30% to 40%.
Since FC155 OP means % open, if FC155 PV is increasing, then FC155’s output must decrease
to close valve FV155. Thus, FC155’s control direction configuration is Reverse. As shown at the top, Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License66 2 Feedback Control Essentials
FV126
FC
126 FC126
Control direction
configuration:
reverse
FV126
%
Open
100%
100% 0%
0%
FV126: Air-to-close
Reverse
Direct
Output
direction
Air-to-open
FC126
PID Algo
OP (%)
100 - %OP
Air-to-close
I/P
AO input
connection
AO output
connection
FV126
Output direction
configuration:
reverse FC126 O/P
FC126 PV
increasing 
60% 70%
0% 100%
OP: 40% →
 30%
OP: 60% → 70%
AO block
FV126
Output to field
FV126
% Open
100%
0%
30%
40%
Figure 2.14 Control Direction, Output Direction, Valve Characteristics for an Air-to-Close Valve
FV155
FC
155 FC155
Control direction
configuration:
reverse
50%
FV155
%
Open
100%
100% 0% 0%
FV155: Air-to-open
Reverse
Direct
Output
direction
Air-to-open
FC155
PID Algo
OP (%)
100 - %OP
Air-to-close
I/P
AO input
connection
AO output
connection
FV155
Output direction
configuration:
direct
OP: 30% →
40%
OP: 30% → 40%
AO block
FV155
Output to field
50%
FC155 O/P
FV155
% open
FC155 PV
increasing
30% 40%
100%
100%
0%
0%
30%
40%
Figure 2.15 Control Direction, Output Direction, Valve Characteristics for an Air-to-Open Valve
right in Figure 2.15, air-to-open valve FV155 is full-closed at FV155 OP = 0% and fully open at
FV155 OP = 100%. Because FV155 is an air-to-open valve, FV155’s AO block’s output direction
configuration is Direct. As indicated in Figure 2.15, FC155 OP increases from 30% to 40%; this means
FC155 wants to open the valve, from 30% to 40% open. The 30% → 40% valve opening desired by
FC155 (in FC155 OP) is unchanged by the AO block (output direction = direct) and as shown at Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.4 PID Control Algorithm Basics 67
the bottom, right in Figure 2.15, a FV155 % open valve position increase from 30% → 40% is sent to
the field.
2.4.4 Proportional, Integral, and Derivative Control Contributions
We now look at the individual contributions proportional, integral, and derivative control actions
make to the overall PID response.
Proportional Control Action
Proportional action, ΔMn (%) = KC * (En −En−1), is a control adjustment directly proportional to
the change in error. Proportional action has two important characteristics:
1) When error is constant but not zero i.e., En ≈ En−1 ≠0, proportional control action stops
(ΔMn (%)≈0).
2) If proportional action is based on error, a set point change causes a step change in the MV.
Proportional action based on error, and PV, and when one option is preferred over the other, is
discussed in Section 2.4.5.
To demonstrate characteristic #1, refer to Figures 2.16 and 2.17. In Figure 2.16, D-306 level is
controlled by P-only controller LC301 manipulating outlet flow FC301; D-306 inlet flow is con￾trolled by FC300. Figure 2.17 shows a typical level response to a step change in inlet flow FC300.
Because LC301 is a P-only controller, when LC301 error lines out, at a nonzero value, LC301 does
not change FC301 SP even though LC301 PV≠LC301 SP. Thus, P-only control leads to a nonzero
CV error at steady state called offset. Offset can be reduced but not eliminated by increasing KC;
like P-I and P-I-D control loops, KC cannot be increased indefinitely because the response will
eventually become oscillatory and perhaps unstable.
Integral Control Action
Offset is eliminated, without oscillations, by adding integral control action, e.g., configuring LC301
as a P-I controller. Integral action, ΔMn (%) = KC * (TS/𝜏I) * En, is a control adjustment proportional
to error and continues to provide a nonzero control adjustment if error is nonzero. Figure 2.18
shows a typical level response to a step change in inlet flow with LC301 configured as a P-I con￾troller. As shown, and always true, integral control action eliminates offset.
Figure 2.16 LC301 → FC301 Control Cascade
D-306 LC
301
FV301
FC
301
SP
FC
300
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License68 2 Feedback Control Essentials
∆ FC300 SP FC300
Offset
LC301
LC301 SP
FC301
Error
≈ Constant ≠ 0 
t = 0
Figure 2.17 Inlet Flow Upset – LC301 P-Only
Control
t = 0
FC300
LC301
LC301 SP
FC301
∆ FC300 SP
Figure 2.18 Inlet Flow Upset – LC301 P-I Control
Combining proportional and integral modes yields the P-I control algorithm presented in
Equation (2.15). As illustrated in Figure 2.18, integral action eliminates offset and is the main
reason for the CV’s approach to set point after a set point change or return to set point after a
load upset. Proportional action reduces response time, but remember KC cannot be increased
indefinitely because the response will eventually become oscillatory. Figure 2.19 shows typical
closed-loop CV responses to a set point change as a function of proportional gain KC at constant
integral time 𝜏I. As KC increases, response times are reduced, but notice that as KC increases, the
responses begin to show signs of oscillatory behavior. Note: In practice, the integral time, 𝜏I, is
usually adjusted at some point as KC is changed. For example, increasing integral time (reducing
integral action) at the onset of oscillations may allow KC to be increased further.
Figure 2.20 shows typical closed-loop CV responses to a set point change for a P-I controller as
a function of integral time 𝜏I. Notice that to increase integral action, 𝜏I must be reduced because
integral action is proportional to (1/𝜏I). Slow approach to set point is an indication that there is not
enough integral action. Like proportional gain increases, response times are reduced, and responses
begin to show signs of oscillatory behavior, as 𝜏I is decreased. Note: In practice, to help avoid the
onset of oscillations, KC is usually reduced at some point as 𝜏I is decreased.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.4 PID Control Algorithm Basics 69
Old SP
New SP
Time →
Increasing
KC
Constant τI
Controlled
variable
Figure 2.19 Typical Closed-Loop P-I Set Point Responses for Various Proportional Gains KC
Old SP
New SP
Time →
Decreasing
τI
Constant KC
Controlled
variable
Figure 2.20 Typical Closed-Loop P-I Set Point Responses for Various Integral Times 𝜏I
Derivative Control Action
Proportional control action is directly proportional to the change in error, and integral control
action is directly proportional to the error; neither correction considers how fast the error or the
control variable’s PV is changing. Derivative action is proportional to the rate of change of error
or the rate of change of the control variable’s PV if, as recommended, the PV option is selected for
derivative action. Thus, derivative action is helpful when a PV tends to change rapidly. Consider
the TC136 → FC155 tower tray temperature control cascade in Figure 2.13 once again, but this
time, assume TC136 is configured as a P-I-D controller. Assume the TC136 response to a change
in FC155 SP includes considerable deadtime. As shown in Figure 2.21, although the TC136 SP is
changed at t = 0, TC136 PV does not begin to change until the TC136 – FC155 response deadtime Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License70 2 Feedback Control Essentials
TC136
TC136 SP
Deadtime
expiration
FC155
TC136
FC155
t = 0 Time →
Figure 2.21 Typical P-I-D Set Point Response for CV–MV Response with Deadtime
expires. However, MV FC155 begins to change immediately, at t = 0, in response to its set point
changes calculated by TC136.
The initial jump in steam rate FC155 is the proportional “kick” caused by the step change
in controller error when proportion action is based on error.6 With TC136 PV constant until
the deadtime expires, the “ramp” increase in FC155 is integral action with constant error, e.g.,
KC * (TS/𝜏I) * (TC136 PV (%) – TC136 SP (%)). When TC136 does begin to respond, it responds
rapidly. Because derivative action is proportional to the rate of change of PV (in this case, its
increase), it can limit further FC155 set point increases that were initially driven by the propor￾tional “kick,” and then by integral action with constant error. Derivative action in principle helps
moderate FC155 set point increases and allows TC136 to approach and reach its new set point
with no overshoot.
Derivative action is most useful for control loops with deadtime; therefore, P-I-D control is most
often used for temperature and composition control loops. As illustrated by the typical responses
in Figure 2.22, when derivative control is useful, increasing derivative time 𝜏D reduces response
times and tends to reduce oscillations. Although only set point responses are shown in Figure 2.22,
when useful, derivative action will also reduce response times for load upsets. Note: In practice,
when 𝜏D is increased, at some point simultaneous changes in KC (normally an increase) and 𝜏I
(normally a decrease) are typical.
If the control variable’s measurement is noisy, the random fluctuations superimposed on the pro￾cess signal can make the CV’s rate of change significant and erratic, directly affecting the derivative
action’s magnitude and direction. The derivative action’s erratic contributions impact the PID’s
output and are transmitted to the MV. Depending upon the MV’s role in the process, unit oper￾ations, sometimes downstream, can be adversely affected. Most modern DCS’ provide a helpful
optional “fix” – the derivative action’s contribution is filtered before it is incorporated into the PID’s
final output. However, the amount of filtering may be fixed, e.g., the filter time constant cannot be
changed by the user, although in some cases derivative filtering can be turned off. If there is no
other reason to filter the CV, the derivative filter is preferred over a traditional PV filter algorithm.7
6 Proportional control action based on error and PV, and proportional “kick,” are discussed in Section 2.4.5.
7 PV filtering is discussed in Section 2.5.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.4 PID Control Algorithm Basics 71
Controlled
variable
New SP
Old SP
Increasing
τD
Time →
Constant KC,τI
Figure 2.22 Typical Closed-Loop P-I-D Set Point Responses versus Derivative Time 𝜏D
2.4.5 PID Control Algorithm Options
As explained in Section 2.4.1, if the DCS offers a derivative on PV option (true for most modern
DCS’), the PV option is the recommended choice to avoid a derivative jump on set point changes.
If derivative action is desired, the PID algorithm in Equation (2.14), reflecting derivative action on
PV, is the preferred PID version to use.
We now look at another important PID option, choosing proportional control action on either
error or PV (Ref. [1]). First, here is the proportional action for both options:
Proportional on Error: ΔMn(%) = KC ∗ [(En − En−1)] (2.18)
Proportional on PV: ΔMn(%) = KC ∗ [(PVn(%) − PVn−1(%))] (2.19)
Note: As is apparent in Equations (2.18) and (2.19), the error option includes the set point while
the PV option does not. Thus, the set point responses of P-I or P-I-D controllers configured with
proportional on error and proportional on PV are different, no matter the values of the tuning
parameters. However, the load responses of P-I or P-I-D controllers configured with either the error
or PV options are identical, provided the proportional gains, integral times, and if derivative action
is included, derivative times are the same.
If fast response to a set point change is the desired control objective, proportional on error is the
recommended option. After a set point change on control pass n, there is a step change in error,
and the proportional action on pass n, ΔMn (%), features a proportional “kick”:
Control pass n∶ En = [PVn(%) − SPn(%)]
Control pass n − 1∶ En−1 = [PVn−1(%) − SPn−1(%)]
Prop action, pass n∶ ΔMn(%) = KC ∗ [En − En−1]
ΔMn(%) = KC ∗ [PVn(%) − PVn−1(%)] + KC ∗ [SPn−1(%) − SPn(%)]
On the next control pass, n+1, and all subsequent control passes until the set point is changed
again, proportional action is no longer affected by the set point since SPn = SPn+1 = SPn+2:
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License72 2 Feedback Control Essentials
Control pass n + 1∶ En+1 = [PVn+1(%)] − SPn+1(%)]
Control pass n∶ En = [PVn(%) − SPn(%)]
Prop action, pass n + 1∶ ΔMn+𝟏(%) = KC
∗[En+1 − En] = KC
∗[PVn+𝟏(%)] − PVn(%)]
The “best” tuning of a P-I or P-I-D controller configured with proportional on error provides a
KC value [KC (E)] that accounts for proportional “kick” on set point changes, e.g., its magnitude
is limited so that set point responses are not too fast, and do not contain unacceptable overshoot
and/or unwanted oscillations.
If fast response to a load upset is the desired control objective, proportional on PV is the rec￾ommended option. Unlike proportional on error, the “best” tuning of a P-I or P-I-D controller
configured with proportional on PV does not need to account for proportional “kick” in the KC
value (KC (PV)). In addition, a PV responds slowly to load upsets and a control loop tuned for fast
load response can allow more proportional gain. Therefore, KC (PV) is always greater than KC (E).
Because the PV option allows a proportional gain larger than the error option’s proportional gain,
a faster load response is achieved. However, the PV option’s set point response is slower than the
error option’s set point response because it does not provide a proportional “kick” on the first con￾trol pass after the set point changes.
To demonstrate the basis for the error versus PV option, refer to the Naphtha Splitter tower
(T-106) tray temperature control strategy, TC35 → FC37, in Figure 2.23.
T
1
0
6
PC
37
E-109
FC
37
LC
39 FC
35
LC
30
FI
34
TC
35
Reformer
effluent
Light virgin naphtha
(LVN)product
Heavy virgin naphtha
(HVN) product
∞
FI
36
Tower
feed
Naphtha
splitter
TI
31
HVN
5% distillation
point
Lab value FC
30
D-119
E-118 TI
44
Figure 2.23 Naphtha Splitter Tray Temperature Control
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.4 PID Control Algorithm Basics 73
New FC37 SP
Old TC35 SP
New TC35 SP
Old FC37 SP
TC35 PV
prop on PV
TC35 PV
prop on error
FC37 SP
TC35 prop on PV
FC37 SP
SP TC35 prop on error
change
Prop on PV
KC ≈0.9
τI≈6.0
τD ≈1.2
Prop on error
KC ≈0.5
τI≈6.5
τD ≈09
Time →
Figure 2.24 Typical TC35 Set Point Response with Proportional on Error versus PV
T-106 splits its feed into a light virgin naphtha (LVN) overhead product and a heavy virgin naph￾tha (HVN) bottoms product. After further processing, LVN either becomes an isomerization unit
feedstock or a MOGAS blend component. HVN becomes a catalytic reforming unit feedstock or
a MOGAS blend component. Tray temperature TC35 is an inferential indicator of the HVN 5%
distillation point; the 5% point is not measured, but a value becomes available periodically via a
laboratory analysis. The operating objective is to upgrade as much LVN as possible to the more
valuable HVN product (this makes HVN lighter and thus lowers the HVN 5% point), as limited by
the minimum desired HVN’s 5% distillation point.
TC35 is maintained at target by manipulating reboiler E-109’s hot side flow, FC37, the catalytic
reformer unit’s reactor effluent. Disturbances to E-109 hot side inlet temperature TI31 PV occur
whenever there are upsets in the catalytic reformer unit. TI31 PV upsets cause reboiler duty changes
which eventually affect TC35 PV. Note that E-109’s hot side outlet temperature is not measured.
If it were measured and available online, E-109’s duty could be calculated, and its control incor￾porated into the TC35 control strategy to provide feedforward corrections for TI31 PV upsets.8
Operators will periodically change TC35’s set point, e.g., when a fresh HVN 5%-point lab result
is received that warrants a tray temperature correction. But the control strategy must also respond
to TI31 PV upsets in a timely manner.
Figure 2.24 compares typical “best” tuned P-I responses to a TC35 set point change with TC35
configured with proportional action on error and with proportional action on PV. The P-I-D tuning
parameters for each option are shown on the right of the figure.
Clearly, despite the lower gain, the error option’s proportional “kick” provides the faster TC35
set point response. Now, let us look at TC35’s load response. Figure 2.25 compares typical “best”
tuned P-I responses to a reformer effluent temperature (TI31 PV) upset with TC35 configured with
proportional action on error and on PV.
Undoubtedly the PV option’s higher gain speeds TC35’s response to the E-109’s hot side inlet
temperature TI31 PV upset. The recommended proportional on error or PV option for TC35, and
other specific cascade ultimate primaries, is discussed next.
8 Feedforward compensation for tower reboiler duty upsets is discussed in Section 3.7.1.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License74 2 Feedback Control Essentials
New FC37 SP
TC35 SP
Old FC37 SP
TI31 PV
Upset
occurs
FC37 SP
TC35 prop on PV
FC37 SP
TC35 prop on error
TC35 PV
prop on PV
TC35 PV
Prop on error
Time →
Prop on PV
KC ≈0.9
τI≈6.0
τD ≈1.2
Prop on error
KC ≈0.5
τI≈6.5
τD ≈09
Figure 2.25 Typical TC35 Load Response to TI31 Upset, with Proportional on Error versus PV
Guidelines: Proportional Action on Error or PV
The proportional on error or proportional on PV choice must be made on a loop-by-loop basis.
Of course, the control objective, e.g., best set point response or best load response, is the most
important issue to consider. There are several guidelines that are valid for many controller types,
but some control loops require an examination of operating objectives, and an analysis of control
objectives before a decision can be made. General guidelines for choosing the proportional option
are listed below. The first four guidelines are self-explanatory and generally applicable as described.
Guidelines #5 and #6 identify the kinds of control loops that require process and control strategy
analysis as a prerequisite for choosing the proportional option.
1) For any ultimate secondary that has a primary controller resetting its set point, tuning for best
set point response with proportional on error is the preferred option.
2) Level controller set points, whether a single loop controller outputting to a valve or a cascade
primary, are almost never changed. Therefore, tuning for best load response with proportional
on PV is the preferred option for all level controllers.
3) Like level controllers, the set point of a controller maintaining product quality at a desired tar￾get (always a cascade primary) will be changed infrequently. Therefore, tuning for best load
response with proportional on PV is the preferred option.
4) Operators frequently change single loop flow controller set points, and flow controllers typi￾cally respond quickly to load upsets (e.g., line pressure variations, valve anomalies). Therefore,
tuning for best set point response with proportional on error is the preferred option for all flow
controllers.
5) Temperature and pressure controllers, whether a single loop controller or a cascade primary,
often require analysis of unit operating objectives and their control objectives before a propor￾tional option is chosen. Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.4 PID Control Algorithm Basics 75
6) For a controller that is both a secondary and a primary in a multilevel cascade, unit operating
objectives and control objectives must be weighed before a final decision on the proportional
option is made.
The examples that follow discuss some control loops that fall under the last two guidelines and
introduce a third proportional option that is a useful compromise between tuning for best set point
response with proportional on error and tuning for best load response with proportional on PV. This
third option, tuning for best set point response with proportional on PV, provides faster response to
load upsets than tuning for best set point response with proportional on error, and faster set point
response than tuning for best load response with proportional on PV.
Examples: Choosing a Proportional Control Option
In Figure 2.23, T-106 overhead pressure is controlled by the single pressure control loop PC37
adjusting overhead condenser (E-118) duty. A Naphtha Splitter’s operating pressure is not changed
very often; thus, operators normally do not change PC37’s set point. However, E-118 is air-cooled,
and weather changes (e.g., rainstorms) can cause large duty upsets, affecting reflux temperature
(TI44 PV) and causing significant tower upsets. In addition, reboiler E-109 duty upsets, and
operator-entered reflux rate changes (FC35 SP) affect the tower heat balance and thus tower
pressure is affected. Therefore, the preferred choice for PC37 is to tune for best load response,
proportional on PV. Note: Tower overhead pressure control via PC37 would be improved by adding
internal reflux control9 to reset reflux flow (FC35) and thereby provide feedforward corrections
for reflux temperature (TI44 PV) upsets.
An interesting example of a single temperature control loop is TC653, discussed earlier in Section
1.7.5 with the help of Figure 1.23. Referring to Figure 1.23, TC653 controls product stripper tower
(T-635) feed inlet temperature (TI653 PV) by manipulating the flow of VPS bottoms (FI660 PV) to
reboiler E-601 via three-way bypass valve TV653 – hence E-601 duty. T-635’s operating objective
is to maximize its sidestream product yield (wild gas oil) by maximizing TI653 PV via TC653. Oper￾ators will thus periodically increase, or if necessary, to relieve a tower constraint, decrease TC653 SP
to meet this operating objective. However, reboiler heating medium (VPS bottoms) flow (FI660 PV)
and inlet temperature (TI663 PV) upsets, as well as T-636 feed rate (FI621 PV) upsets will all affect
TC653 PV which can cause tower upsets. Therefore, for TC653, the compromise third option is
best, e.g., tuning for best set point response with proportional on PV to provide faster response to
load upsets than tuning for best set point response with proportional on error, and faster set point
response than tuning for best load response with proportional on PV.
Note: In Section 1.7.5, an advanced regulatory control strategy presented in Figure 1.24 includes
feedforward corrections for reboiler E-601 duty and T-636 feed rate upsets that compensate for the
three major upsets that the single loop temperature controller (TC653) in Figure 1.23 must manage.
Hence, with this advanced regulatory control strategy implemented, TC653 could be tuned for best
set point response with proportional on error.
An example of a temperature control loop that is a cascade ultimate primary is the tray temper￾ature controller TC35 in Figure 2.23; it resets reboiler E-109 hot side flow rate FC37. TC35 must
respond well to tower upsets, such as a feed rate (FI34 PV) disturbance, or an operator-entered
reflux rate set point (FC35 SP) change. And as an inferential indicator of HVN 5% point, operators
will make as needed changes to TC35 SP after fresh 5% point lab sample results become avail￾able. Depending upon how often fresh values of the 5% point become available, how stable the
9 Tower internal reflux control is discussed in Section 3.7.2.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License76 2 Feedback Control Essentials
feed rate is, and how often operators adjust reflux rate, either the proportional on error (tuning for
best SP response) or proportional on PV (tuning for best load response) option may be acceptable.
However, the compromise option, tuning for best set point response with proportional on PV is also
a reasonable choice for TC35. In cases like this, discussions with operators are helpful.
An example of a pressure control loop that is a cascade ultimate primary is the overhead pressure
controller PC77 in Figure 2.3; it resets T-85’s reflux flow FC83 SP. Like the previously discussed
Naphtha Splitter (T-106) in Figure 2.23, T-85 (another Naphtha Splitter) overhead pressure con￾troller set point (PC77 SP) is not changed very often. However, reboiler (E-89) duty upsets, and
depending upon how often feed rate (FC87 SP) is changed, feed rate changes can both cause trou￾blesome T-85 overhead pressure upsets. Consequently, the preferred choice for PC77’s proportional
option is to tune for best load response with proportional on PV. Note: E-88 is a flooded condenser10
and, unlike an air-cooled condenser, is not prone to weather upsets. A flooded condenser’s duty
is very responsive to reflux flow adjustments and will have good control rangeability. For these
reasons, PC77’s control performance should be better than PC37’s performance, manipulating an
air-cooled exchanger’s duty in Figure 2.23.
For a controller that is both a secondary and a primary in a multilevel cascade, refer to the
AC95 → TC87 → FC86 cascade in Figure 2.3 and look specifically at temperature controller TC87.
In principle, tuning for best set point response with proportional on error seems appropriate since
good product quality depends upon TC87 satisfying the set points that AC95 calculates. However,
the major reason to include TC87 in the quality control cascade is to attenuate or eliminate the
effects of tower upsets before the product’s quality (AC95) is affected. Thus, tuning for best load
response with proportional on PV also seems appropriate. However, the compromise option, tuning
for best set point response with proportional on PV, by its very nature, is most likely the best choice.
It will manage both set point changes and load upsets – faster load response than tuning for fast
set point response with proportional on error and faster set point response than tuning for fast load
response with proportional on PV.
2.4.6 PID and Cascade Initialization
Control initialization refers to the procedures that commission a single control loop, a portion of a
multilevel cascade, or the entire multilevel cascade, to allow the controller or the cascade to make
control adjustments. When a single control loop or a multilevel cascade is commissioned without
any changes to the final control element (e.g., the valve position), the procedure is called bump￾less transfer. Bumpless transfer is an essential, required element of control strategy design – to
ensure the process is not upset on the control initialization pass. All modern DCS’ provide standard
features, some automatically, others by configuration, that ensure bumpless transfer.
The multilevelsimple cascade, AC95 → TC87 → FC86, shown in Figure 2.3, will be used to explain
the standard DCS features used to initialize the PID algorithm and the initialization procedure that
enables a cascade to be commissioned bumplessly. As a reminder, these standard DCS features are
only applicable to simple cascades and are not applicable to complex cascades. The cascade’s ulti￾mate primary, AC95, maintains the bottoms product (HVN) 5% distillation point at a desired target,
AC95 SP. Tray temperature controller TC87 is reset by AC95; it is an inferential indicator of 5% point,
and helps reduce the impact of tower upsets. Thus, it helps decrease the number and severity of
5% distillation point disturbances. Note that TC87 is both a secondary (AC95 is its primary) and a
primary (FC86 is its secondary). The ultimate secondary, the distillate product’s (LVN) flow rate,
FC86, is reset by TC87.
10 Control applications implemented on towers with flooded condensers are discussed in Section 12.3.4.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.4 PID Control Algorithm Basics 77
Table 2.1 Controller Mode Changes and Output Indisposable Status
Mode
Cascade Segment
on Control AC95 TC87 FC86
1 AC95 → TC87 → FC86 Auto Cascade Cascade
2 AC95a)→ TC87 → FC86 Auto Autob) Cascade
3 AC95a)→ TC87a)→ FC86 Auto Cascade Autob)
4 AC95a)→ TC87a)→ FC86a) Auto Cascade Manualc)
a) Output Indisposable – Cannot output to secondary or valve.
b) Auto → Cascade will commission full cascade.
c) Manual → Cascade will commission full cascade.
Important: By discussing the initialization of an ultimate primary (AC95), a controller that is both
a primary and a secondary in a multilevel cascade (TC87), and an ultimate secondary (FC86),
most controller roles are covered and therefore the methods described in this section have wide
applicability.
For the AC95 → TC87 → FC86 cascade, Table 2.1 illustrates (i) how a controller’s mode
determines the cascade segment commissioned, (ii) the controller mode change that commissions
the full cascade, and (iii) which controllers cannot output to its secondary (Output Indisposable)
after the indicated mode change.
With AC95 in Auto mode, and both TC87 and FC86 in Cascade mode, the full cascade is commis￾sioned (Line 1); the desired 5% distillation point target, AC95 SP, is an operator entry. Transferring
TC87 to Auto mode decommissions AC95 control; AC95 cannot output a new set point to TC87,
and thus it is Output Indisposable.
11 Only the TC87 → FC86 cascade is commissioned; the desired
tray temperature target, TC87 SP, is an operator entry (Line 2). Transferring FC86 to Auto mode
leaves only flow control commissioned (Line 3); the desired distillate product flow rate, FC86 SP,
is an operator entry. AC95 remains Output Indisposable, and since TC87 cannot output a new
set point to FC86, TC87 is now Output Indisposable. Finally, transferring FC86 to Manual mode
decommissions all closed-loop control; to change the valve % opening, operators manually enter
the new FC86’s output, FC86 OP, or a new FV86 OP (Line 4). The full cascade is recommissioned by
transferring TC87 from Auto to Cascade mode (Line 2) or transferring FC86 from Auto to Cascade
(Line 3) or Manual to Cascade (Line 4) modes.
Manual Steps Performed by Operators to Commission a Cascade Bumplessly
To gain insight into cascade initialization and bumpless transfer procedures, here are the
steps an operator would perform manually, in the analog control world, to commission the
AC95 → TC87 → FC86 cascade bumplessly. These same steps are mimicked by the standard DCS
features (presented next) that enable all simple cascades to be commissioned bumplessly. For now,
assume the starting point for commissioning is all controllers are in Manual mode:
1) With FC86 in Manual mode, set FC86 SP = FC86 PV; this is called set point initialization.
2) Transfer FC86 to Auto mode; this commissions flow control.
3) With TC87 in Manual mode, (i) set TC87 OP, in % of range of FC86, equal to FC86 SP and (ii)
set TC87 SP = TC87 PV (set point initialization).
11 In Section 2.8, it is explained that a controller with wind-up status = HighLow is Output Indisposable – it cannot
increase or decrease its secondary’s SP or valve position.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License78 2 Feedback Control Essentials
4) Transfer TC87 to Auto mode and FC86 to Cascade mode; this commissions the TC87 → FC86
cascade bumplessly.
5) With AC95 in Manual mode, set AC95 OP, in % of range of TC87, equal to TC87 SP.
6) For bumpless transfer, set AC95 SP = AC95 PV (set point initialization).
7) Bumpless transfer via set point initialization is optional for a cascade’s ultimate primary (or
any single loop) such as AC95. Without set point initialization, AC95 control action bumps
(e.g., changes) TC87 SP on the initialization pass, and could cause a tower upset. However, if
AC95 SP is a guideline value, despite the bump to TC87 SP, closed-loop control initializes with
the guideline quality target. Important: Use of set point initialization to achieve bumpless trans￾fer (Step #6) is often a valid choice, provided adjustments to AC95 SP are made to return it to its
guideline value (see Step #9).
8) Transfer AC95 to Auto mode, and TC87 to Cascade mode. If set point initialization is chosen for
AC95, this commissions the full cascade bumplessly.
9) If AC95 SP was set equal to AC95 PV (Step #6), and AC95 SP is a guideline value, operator￾entered AC95 SP adjustments are needed to return AC95 SP to its desired, guideline value.
The closed-loop response is monitored to ensure AC95 PV returns to its guideline value.
Bumpless Transfer via Standard DCS Features
We now return to the digital world and explain how standard DCS features mirror the above steps
and enable simple cascades to be commissioned bumplessly. Initialization is best understood by
initially focusing on Equation (2.11), introduced in Section 2.4.1, which applies to all controllers.
It relates the current time step’s controller output in % of range, Mn (%), to the last time step’s
controller output in % of range, Mn−1 (%), and as calculated by the PID algorithm, the current time
step’s change in controller output in % of range, ΔMn (%). Equation (2.11) is repeated below for
easier reference:
Mn(%) = Mn−1(%) + ΔMn(%) (2.11)
Equation (2.11) is recursive, requiring the storing of historical values of Mn−1 (%) for use on sub￾sequent control passes. Applying Equation (2.11) to the initialization pass (time step n = 0), the
controller output in % of range is given by:
M0(%) = M−1(%) + ΔM0(%) (2.20)
To initiate the discussion of the standard DCS features that enable bumpless transfer, assume
that in response to an upset, FC86 is transferred to Auto mode so that an operator can make flow
set point changes. As indicated in Table 2.1, AC95 and TC87 both become Output Indisposable,
i.e., AC95 cannot output a new set point to TC87 and TC87 cannot output a new set point to FC86.
Then, with the upset over and operations stable once again, the operator wants to re-commission
the entire cascade. With TC87 still in Cascade mode and AC95 still in Auto mode, the operator
transfers FC86 to Cascade mode. Assuming FC86 PV ≈ FC86 SP, FC86 OP will not change when
FC86 is transferred to Cascade mode. As soon as FC86 is transferred to Cascade mode, TC87 is no
longer Output Indisposable so it is ready to output a new set point to FC86. However, when FC86
is transferred to Cascade mode, FC86 communicates an initialization request and an initialization
value, e.g., a set point value, to TC87 (its primary) for initialization of its control calculation. AC95
remains Output Indisposable until TC87 initializes and sends a request to its primary, AC95, to
initialize its control calculation.
The standard DCS features that enable bumpless transfer are presented first for TC87 and then
for AC95. Refer to Equation (2.20) and look at how the equation’s three terms relate to TC87’s
initialization pass (time step n = 0):
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.4 PID Control Algorithm Basics 79
M0 (%) TC87 output, in % of range, on TC87’s initialization pass.
M−1 (%) A valid value of TC87 OP for the last time step does not exist on an initialization pass. As a standard
DCS feature, when a secondary (FC86) is transferred to Cascade mode, it sends an initialization
request, and its set point, FC86 SP0 in % of range, to its primary as an initialization value. FC86 SP0
in % of range, stored to M−1(%), is FC86’s set point in % of range when it is transferred to Cascade
mode.
ΔM0 (%) Change in controller output in % of range, calculated by TC87’s PID algorithm on the initialization
pass.
As described above, M−1 (%) is set equal to FC86’sinitialization value (FC86 SP0 in % of range) – sent
to TC87 when FC86 is transferred to Cascade mode. Then, from Equation (2.20), if the value of
ΔM0 (%) calculated by TC87’s PID algorithm is zero on the initialization pass, TC87’s initial output,
M0 (%) will not change FC86’s set point because M0 (%) = M−1(%)+(0) ≡ FC86 SP0 in % of range.
Therefore, for the TC87 → FC86 segment of the cascade, achieving bumpless transfer centers on
answering a simple question: how can ΔM0 (%), calculated by TC87’s PID algorithm, be forced to
have a zero value on the initialization pass?
To answer this question, start with Equation (2.14), first introduced in Section 2.4.1 and repeated
below for ease of reference, the discrete, incremental, noninteracting form of the PID algorithm,
with proportional action on error and derivative action on PV:
ΔMn(%) = KC ∗
[
(En − En−1) +
TS
𝜏I
∗ En + 𝜏D
TS
∗ (PVn(%) − 2 ∗ PVn−1(%) + PVn−2(%))]
(2.14)
The PID algorithm is recursive, and thus historical values (e.g., En−1, PVn−1) are stored for use on
subsequent control passes. Applying Equation (2.14) to the initialization pass (at time step n = 0),
the change in controller output in % of range is given by:
ΔM0(%) = KC ∗
[
(E0 − E−1) +
TS
𝜏I
∗ E0 + 𝜏D
TS
∗ (PV0(%) − 2 ∗ PV−1(%) + PV−2(%))]
(2.21)
Valid PID historical values (e.g., E−1, PV−1(%), PV−2(%)) are unavailable on the initialization pass.
To force ΔM0(%) = 0 on an initialization pass, standard DCS features initialize the PID algorithm’s
calculation by applying the following equalities:
1) E0 =PV0 (%) – SP0 (%)
2) E−1 = E0
3) PV−1 (%) = PV0 (%)
4) PV−2 (%) = PV0 (%)
5) E−2 = E0
where PV0 (%) and SP0 (%) are the (known) values of PV and SP on the initialization pass. After
substituting these equalities in Equation (2.21), these conclusions follow:
● With proportional on error, equality #2 eliminates proportional control action
● With proportional on PV, equality #3 eliminates proportional control action
● With derivative control on PV, equalities #3 and #4 eliminate derivative control action
● With derivative control on error (not recommended), equalities #2 and #5 eliminate derivative
control action
Thus, equalities #2 through #5 eliminate both proportional and derivative control actions on
the initialization pass. However, these equalities do not establish the value of controller error,
E0, the difference between PV0 (%) and SP0 (%) on the initialization pass. Unless E0 = 0 [SP0
(%) ≡ PV0 (%)], integral action on the initialization pass is not zero. If E0 ≠0, ΔM0 (%)≠0, M0 (%) Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License80 2 Feedback Control Essentials
in Equation (2.20) is not constant (not equal to the initialization value received from its secondary)
and bumpless transfer does not take place. Clearly, if SP0 (%) is set equal to PV0 (%) on the
initialization pass, E0 is forced equal to zero, integral action is eliminated, ΔM0 (%) = 0, and thus
bumpless transfer occurs.
Set Point Initialization (SP Init)
As introduced earlier, setting a controller’s set point equal to its PV on an initialization pass is
called Set Point Initialization (SP Init). Depending on the DCS, the terms PV Tracking and SP
Tracking are used and are very similar to SP Init. Set point initialization is a configurable parameter
assigned a value of Yes (or True) or No (or False) at controller build time. If SP Init (or PV Track￾ing) = Yes, the controller’s PV value will be stored to its set point attribute whenever the controller
is in Manual mode or is executing on an initialization pass. Note: Some DCS’ do not allow the set
point to be set equal to the PV if the PV is outside the allowable set point range (high/low set point
limit clamps).
Therefore, if TC87 is configured for SP Init = Yes, then on an initialization pass, E0 ≡0, and
integral control action≡0. With the standard DCS PID algorithm initialization equalities forcing
proportional and derivative control actions to zero, and SP Init = Yes forcing ΔM0 (%)≡0, M0 (%)
is constant (equal to FC86 SP0 in % of range), and for the TC87 → FC86 segment of the cascade,
bumpless transfer occurs.
Is there a downside for choosing SP Init = Yes? Potential problems can arise when the initialized
set point value is not the operator-entered (desired) value or an offline established guideline value.
Here are a few examples that illustrate the tradeoffs that sometimes must be made before a final
decision on SP Init is reached. Discussion with operators and/or process technical personnel are
recommended and always helpful:
1) Whether it is a single control loop or a cascade primary, level controller set points are rarely
changed, and are normally integers, e.g., 45%, 55%, very often 50%. SP Init considerations must
assess a possible bump in the level loop’s MV, and subsequent unit upset versus a set point of
51.6% instead of the desired 50%. Level controllers are typically configured for SP Init = No.
2) Likewise, the set point of a cascade primary maintaining a product quality at a desired target is
almost never changed. SP Init considerations must assess a possible bump in the control loop’s
MV, and subsequent unit upset versus a product’s 5% distillation point set point of 138.4 ∘C
versus the desired 145.0 ∘C. Quality controllers are typically configured for SP Init = No.
3) For a single loop flow controller that sets a light-ends tower’s desired feed rate, SP Init considera￾tions must assess a possible bump in the feed rate and potential tower upset versus an initialized
feed rate set point that is not the throughput guideline. The SP Init decision must be made on a
specific loop-by-loop basis.
4) If it is an inferential indicator of quality, and an ultimate primary, a tower tray temperature
controller’s set point is normally periodically specified offline to satisfy the quality requirement.
SP Init considerations must assess a possible bump to the temperature loop’s MV and potential
tower upset versus a tray temperature set point that is not the guideline value. Like #3 above,
the SP Init decision must be made on a specific loop-by-loop basis.
Based on the above, here are important guidelines for specifying SP Init:
● All cascade secondary controllers (FC86 and TC87 in our example cascade) should always be
configured for SP Init =Yes.
● For a multilevel cascade, configuring all secondaries for SP Init = Yes (including the cascade’s
ultimate secondary) ensures bumpless transfer up to the ultimate primary.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.4 PID Control Algorithm Basics 81
● The one shortcoming of choosing SP Init =Yes for primary (or single loop) controllers is the
initialized set point value will almost certainly not be the operator desired value or the offline
specified guideline value.
● However, SP Init =Yes can be combined with user-provided code and/or logic to slowly ramp
the initialized set point back to the desired operator or guideline value.
Note: Set point ramping is a standard feature in some modern DCS’ and can be specified at con￾troller build-time by configuration. Either the ramp rate in EU/time or the ramp time in minutes
can be specified by control engineers, or by an operator entry. Absolute deviations between SP and
PV that are too large – an indication that the ramping rate is too fast, can be configured to stop the
ramping until the deviation is within the maximum allowed range.
TC87’s Initialization, and Bumpless Transfer of TC87 → FC86
Figure 2.26 summarizes the calculation steps executed, standard DCS features used and the
information flow of the TC87 initialization pass that enables the TC87 → FC86 segment of the
AC → TC87 → FC86 cascade to be commissioned bumplessly. It condenses the preceding detailed
discussion of initialization and bumpless transfer into a single pictorial summary.
1) Starting in the upper left, TC87’s inputs – (PV0 and SP0 in EU) are first converted to % of range,
PV0 (%) and SP0 (%), using Equation (2.8b).
2) With SP Init =Yes, SP0 (%) is set equal to PV0 (%). The PID algorithm, Equation (2.21), initializes,
using the DCS’ initialization equalities to assign values to PID error and PV history locations.
The PID’s initialized result, ΔM0 (%), the change in TC87 OP0 in % of range of FC86, is then
equal to 0.
3) In the upper right, the initialization value, MV SP−1, provided by FC86 to TC87 when FC86
was transferred to Cascade mode (FC86 SP0 in EU), is converted to % of range, M−1 (%), using
Equation (2.8a). It is added to the initialized PID’s output, ΔM0 (%) = 0, in Equation (2.20) to
generate M0 (%), TC87 OP0 in % of range of FC86.
4) M0 (%) is converted to EU using Equation (2.12) to yield MV SP0 (=FC86 SP0), TC87’s output
(TC87 OP0) to FC86’s set point on the initialization pass.
5) In summary, the TC87 → FC86 cascade initializes bumplessly because: (i) ΔM0 (%) = 0
(SP Init =Yes), and (ii) TC87 OP0 is forced equal to FC86 SP0 in % of range, where FC86 SP0 is
the initialization value provided to TC87 by FC86 when FC86 is transferred to Cascade mode.
AC95’s Initialization and Bumpless Transfer of AC96 → TC87 → FC86
We now discuss the initialization of the cascade’s ultimate primary, AC95, and the re-commission￾ing of the entire AC95 → TC87 → FC86 cascade. As a reminder of how far we have come, the starting
point was line 3 in Table 2.1, FC86 in Auto mode, TC87 in Cascade mode but Output Indisposable,
and AC95 in Auto mode and Output Indispensable. Then, when FC86 was transferred to Cascade
mode, FC86 communicated an initialization request and an initialization value, e.g., its set point,
to its primary, TC87. And as discussed above and illustrated in Figure 2.26, both TC87 and the
TC87 → FC86 segment of the cascade are recommissioned bumplessly.
The recommissioning process description continues with the initialization of AC95, in Auto
mode but Output Indispensable. As soon as TC87 initializes, and with TC87 in Cascade mode, AC95
is no longer Output Indisposable, so it is now ready to output a new set point to TC87. However,
when TC87 initializes, it communicates an initialization request and an initialization value, e.g.,
its (initialized) set point, to its primary, AC95, forcing AC95 to initialize its control calculation.
The calculation steps executed, standard DCS features used and the information flow of the AC95 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License82 2 Feedback Control Essentials
PID algorithm
MV
MV SP0
% of Range → EU
EU
EU → % of range
MV SP–1
(MV SP–1 – MVL) * 100%
(MVH – MVL)
∆M0 (%)≡0
M0 (%)≡ M–1 (%)
M–1 (%)
M0 (%)
History initialization
equalities
PV0 (%)
=SP0 (%)
EU → % of range
PV0
SP0
(SP0 – CVL) * 100%
(CVH – CVL)
(PV0 – CVL) * 100%
(CVH – CVL)
EU
SP0(%)
PV0(%)
Equation (2.8b)
M0 (%) = M–1 (%) + ∆M0 (%)
M–1(%)
M0(%) * (MVH – MVL)
100%
+ MVL FC86 SP0
SP0 (%)
PV0 (%)
SP0 = TC87 SP0
PV0 = TC87 PV0
MV SP–1 = FC86 SP0
M–1(%) = FC86 SP0 in % range
M0(%) = FC86 SP0 in % range
MV SP0 = FC86 SP0
AC95 TC87 FC86 SP SP
Equation (2.21)
Equation (2.20)
Equation (2.12)
Equation (2.8a)
EU
Initialization value
FC86 to TC87
FC86 SP0
S
P
I
N
I
T
Figure 2.26 Primary and Secondary Controller TC87’s Bumpless Initialization
initialization pass are identical to that of TC87 with one important exception. Because AC95 is
a cascade primary maintaining a product quality at a desired target, and its set point is almost
never changed, configuring AC95 SP Init = No is reasonable. For TC87, with SP Init = Yes, the
PID algorithm’s initialization yields the result ΔM0 (%) = 0 and bumpless transfer is achieved.
For AC95, with SP Init = No, E0 ≠0, and referring to the PID algorithm in Equation (2.21), ΔM0
(%) includes integral action only – KC * (TS/𝜏I) * E0. Recommissioning of the full cascade will not be
bumpless – on the initialization pass, the AC95 control adjustment will be an integral only control
correction.
Figure 2.27 summarizes the calculation steps executed, standard DCS features used and the
information flow of the AC95 initialization pass. In concept, other than the choice for SP Init = No,
its initialization is equivalent to TC87’s initialization process, as illustrated in Figure 2.26.
2.4.7 PID Tuning
This book’s focus is on control strategy design. The detailed designs and associated design issues
for a variety of realistic control applications in important refinery and chemical plant units are
presented in Chapters 9–14. Thus, in the PID discussions to this point, the focus has been on
technical issues to resolve and choices to be made during the control strategy’s design phase:
(i) CV – MV pairing, interactions and sensitivities, (ii) CV – DV sensitivities, (iii) PID control
action – Direct or Reverse, (iv) output direction – Direct or Reverse, (v) proportional action on
error or PV, (vi) derivative action on error or PV, and (vii) SP Init Yes or No. Note that the last five
of these seven items can be changed up to or during commissioning, but their importance justifies
attention during design. Although PID tuning is very important and is frequently a major work
effort and a concern during implementation, it is not a design issue. Therefore, only an overview
of PID tuning is presented, with an emphasis on available methods, recommended approaches,
their underlying basis, and consensus tuning guidelines.
PID tuning means choosing values for the PID tuning parameters – proportional gain, integral
time, and derivative time (if derivative is included), that provide satisfactory set point and/or load Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.4 PID Control Algorithm Basics 83
PID algorithm
MV
% of range → EU
EU
∆M0 (%)
M0 (%)
History initialization
equalities
Equation (2.8a)
M0 (%) = M–1 (%) + ∆M0 (%)
M–1 (%)
M–1 (%)
M0 (%)
M0 (%) * (MVH – MVL)
100%
+ MVL
SP0 =AC95 SP0 EU
PV0 =AC95 PV0
MV SP–1 TC87 SP0
M–1(%) = TC87 SP0 in % range
M0(%) = TC87 SP0 in % range
MV SP0 = TC87 SP0
AC95 TC87 FC86
SP SP
SP Init = No
Equation (2.21)
Equation (2.20)
Equation (2.12)
MV SP0
TC87 SP0
Equation (2.8b)
(MV SP–1 – MVL) * 100%
(MVH – MVL)
EU → % of range
MV SP–1
Initialization value
TC87 to AC95
TC87 SP0
SP0 (%)
PV0 (%)
PV0
SP0
EU
EU → % of range
SP0(%)
PV0(%)
(SP0 – CVL) * 100%
(CVH – CVL)
(PV0 – CVL) * 100%
(CVH – CVL)
Figure 2.27 Primary Controller AC95 Initialization
responses. The starting point is the tuning objectives – (i) fast/best set point response or fast/best
load response, (ii) is MV overshoot OK and if so, how much, (iii) is CV overshoot OK and if so,
how much and (iv) are small amounts of MV and/or CV oscillations OK. Many combinations of
tuning parameter values provide acceptable control performance, and judging performance is ini￾tially the control engineer’s responsibility. However, it is the operator who ultimately decides – if
control performance does not meet expectations and/or cause operational problems, the operator
will decommission the strategy.
Overview of PI and PID Tuning Recommended Practices
The starting point is a list of recommended practices that can guide a control engineer who is tuning
a PI or a PID controller. The list is a summary of practical conclusions taken from the descriptions
of the various tuning methods that will be presented later in this section. For the most part, these
discussions reference process control textbooks and published journal articles that provide com￾plete descriptions of each major tuning method, its basis, and its key tuning rules. In the discussions
that follow, reference is made to CV and MV overshoot, and in some cases, a specific amount of over￾shoot, for example 15% MV overshoot, is a constraint for acceptable tuning. Figure 2.28 illustrates
how % CV and % MV overshoot are defined.
The recommended practices for tuning a PI or a PID controller are summarized below – details
follow the summary:
● Almost all flow and pressure controllers that output to a valve, whether a single loop or a cas￾cade’s ultimate secondary, respond very quickly, and are tuned by trail-and-error, or by using
common control loop tuning guidelines with fine-tuning via trial-and-error.
● Most level controllers, whether a cascade’s ultimate primary or a single control loop, are tuned
using well-established level controller tuning rules.
● Like flow and pressure controllers, many temperature controllers that output to a valve and
respond relatively quickly with minimal deadtime (𝜃/𝜏 <1), can be tuned using common control
loop tuning guidelines with fine-tuning via trial-and-error.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License84 2 Feedback Control Essentials
Time →
Time →
CV Ovsh
∆CV
ΔMV
CV
MV
% CV Overshoot = [ CV Ovsh/ ΔCV ] * 100%
% MV Overshoot = [ MV Ovsh/ ΔMV ] * 100%
MV Ovsh
Figure 2.28 Calculation of % CV and % MV Overshoot
● For control loops with slower dynamics and moderate deadtimes (1 < 𝜃/𝜏 < 2), trial-and-error
tuning is not practical – it becomes time-consuming and random plant disturbances can
distort CV – MV and CV – DV response characteristics. Many temperature controllers and
most composition controllers are in this category, and using published tuning rules is the best
approach. Due to loop deadtimes, the PID (not PI) tuning rules are frequently preferred for
these loops.
● Most tuning rules are presented as correlations of tuning parameter values versus linear dynamic
model parameters. Thus, a reliable first- or second-order plus deadtime model, developed via
plant testing, is often needed to effectively use the most important tuning rules.
● For some troublesome control loops, controllers in similar services in similar process units can
sometimes provide passable tuning parameter values. Reasonable, typical PID parameter values
can sometimes be obtained from published tables. Important: This approach is especially helpful
when initial tuning parameters are chosen before the start-up of a grass-roots process unit.
● There are a limited number of third-party online software tools available to use for online
PID tuning. The most effective online PID tuning tools available are provided by the dominant
DCS vendors. They offer a variety of tools integrated with their DCS control hardware/software
that support automated PID controller tuning.
● If deadtimes are significant, i.e., 𝜃/𝜏 >2, a model-based approach is typically the best practical
approach. If there are significant interactions among multiple CVs, MVs and DVs, DMC is often
the best approach.
Tuning Guidelines for Common Control Loops
There are hundreds, and in some cases over a thousand basic regulatory control loops imple￾mented for continuous operations in an operating plant. A large majority of PI and PID controllers –
common basic regulatory control loops, are easily tuned, do not cause operational problems, and
rarely need re-tuning. An overview of tuning guidelines for these loops is presented below.
Almost all flow controllers adjusting a valve position respond very quickly to set point changes,
and corrections are fast and effective. Therefore, flow controllers are tuned manually via
trial-and-error. They are PI controllers; derivative action is almost never needed.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.4 PID Control Algorithm Basics 85
Gas pressure control via valve position adjustments is similar to flow control, provided vapor
flow in or out of the vessel is manipulated. If so, set point and load responses are relatively fast,
manual tuning by trial-and-error is straightforward, and derivative action is almost never needed.
There are exceptions, e.g., when a tower pressure loop’s MV is the duty of an air or water-cooled
overhead condenser or the tower’s reflux flow. In these cases, the pressure – MV response
dynamics can be slow, even include some dead time. Although PI control is usually sufficient,
there are cases where some derivative action may be helpful. Note that upsets are common (e.g.,
weather changes) and can cause disturbances which are difficult to correct quickly. Feedforward
methods that help reduce the impact of these particular upsets are discussed in Sections 3.7.2
and 3.7.3.
Tuning level controllers manually can be time consuming, but if a level controller’s MV is either
the flow rate into or out of the vessel, it can be tuned relatively easily using well-established tun￾ing rules (Refs. [2–5]). As will be explained in Section 9.6, a level controller’s tuning objective
depends upon the level being controlled, the level controller’s MV, and the process configuration.
In some cases (tight level control), the level is controlled as closely as possible to setpoint regardless
of the variations in the MV. In other cases (averaging level control), the level PV is allowed to deviate
from setpoint, within the level’s alarm limits, to minimize the MV’s flow variations. In either case,
the level controller is a PI; derivative action is very rarely used.
The level controllers discussed above feature relatively fast dynamics between MV changes
(inlet or outlet flow) and the level’s response. However, there are level control applications with
significant deadtimes and dynamic effects between MV and level. These normally involve an
upstream MV, with other processing units between the MV and the controlled level’s measurement.
Tuning is difficult, level control performance is usually poor, and in many cases, a model-based
approach (e.g., DMC) is justified.
Temperature control is used in a wide variety of process alignments, each with its own unique
characteristics. Tower tray temperature, reactor inlet or outlet temperature, and fired heater or
heat exchanger outlet temperature control must manage diverse control needs in various process
environments. Temperature control loops with relatively fast dynamics and minimal deadtime
(𝜃/𝜏 <1) can be tuned manually. For those with slower dynamics and moderate deadtimes
(1 < 𝜃/𝜏 < 2), the best approach is to use published tuning rules. Because derivative control
action helps manage loop deadtimes, PID tuning rules are preferred. Other than including
derivative action, there are no general guidelines available to help tune a temperature con￾troller. When there are longer deadtimes (𝜃/𝜏 >2), a model-based approach is typically the best
approach.
Except for fired heater stack O2 control, composition control is usually not considered a basic
regulatory control loop. In most cases, the composition controller’s PV input is an online analyzer
measurement, which presents unique control issues:
● Analyzer measurements are often unreliable and they must be validated before they are used in
control (see Section 8.8).
● The analyzer’s sampling system and the analyzer’s installation location relative to the process
unit can introduce significant deadtime in the composition control loop.
● In some cases, fresh analyzer measurements are not available on a regular frequency and/or they
are available on a slow frequency.
Because composition responses to any potential MV change are slow, trial-and-error tuning is
not practical. Using the published tuning rules is a far more practical approach. Like temperature
control, the tuning rules that include derivative action are preferred for composition controllers
with slower dynamics and moderate deadtimes (1 < 𝜃/𝜏 < 2). However, if deadtimes are significant
(𝜃/𝜏 >2), a model-based approach is usually the best approach.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License86 2 Feedback Control Essentials
Overview of PID Tuning Methods Used in Operating Plants
The four methods used historically in an operating plant to tune PID controllers are listed below – a
brief discussion of the four approaches will follow:
● Manually via trial-and-error.
● Tuning rules developed using online, closed-loop data – this is no longer used in practice.
● Perform plant tests to obtain reliable dynamic model parameters, and use published tuning rules
that correlate tuning parameter values with the model parameters.
● Commercially available software tools, especially those tools developed by DCS vendors who
have integrated them into their process-connected DCS hardware.
Important: If using any published tuning rule, it is essential to make sure the tuning rule chosen
is valid for the user’s application – it must align with the specific set of conditions adopted when
the rule was derived. Here are the most important conditions to check for alignment before using
a tuning rule:
– Tuning objective: Fast/best set point response or fast/best load response
– Proportional action: On error or PV
– Derivative action: On error or PV, filtered or not filtered
– Controller type: PI or PID
– PID version: Interactive (nonideal) or noninteracting (ideal)
– Model utilized to correlate tuning parameters versus model parameters: Same structure, e.g.,
the same model parameters as user’s plant test-developed model
– MV overshoot OK and if so, how much (see Figure 2.28)
– Performance criteria (if any) used, i.e., IAE, ISE or ITAE – see the discussions of
Equations (2.26a), (2.26b), and (2.26c) later in this section.
Choosing tuning parameters for controllers in a grass-roots unit or a plant expansion, before
start-up, present a unique problem. Prior to start-up, trial-and-error tuning, the use of online soft￾ware, and plant tests to obtain process response dynamic parameters are not possible; thus, the
tuning rules cannot be used. One method used to specify controller tuning parameters for a new
unit is to seek out tuning parameters currently used in operating controllers in similar service
in similar units. This method will usually provide adequate (e.g., stable) tuning parameter esti￾mates for the start-up, and as the start-up proceeds, loops can be manually fine-tuned (if necessary)
to improve performance. Reasonable initial values can also be obtained from published tables of
typical PID parameter values; acceptable ranges for each setting as well as the expected scan times
for each type of loop are sometimes included (Ref. [6]).
Trial-and-Error Tuning Guidelines
In an operating plant, trial-and-error tuning is effective only for relatively fast control loops, when
the CV response lines out in a relatively short time interval after a set point or load change. The
effects of tuning parameter changes are observed quickly, and a performance assessment can be
made in a relatively short time. For slower loops, longer time periods are needed for this assess￾ment, and the probability that an undetected disturbance will unknowingly affect the CV response
increases.
There are many tuning guidelines discussed in numerous process control textbooks that can
be applied when using the trial-and-error approach to tuning. Some of these have already been
discussed in Section 2.4.4, where the individual contributions made by proportional, integral, Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.4 PID Control Algorithm Basics 87
and derivative control actions to the PID response were discussed. Here are important guidelines
reported to be useful:
● If PV noise is judged problematic, filter before tuning begins (see Section 2.5).
● If tuning an ultimate secondary, use tight output clamps to initially constrain movement of the
final control element. As tuning progresses and confidence grows, loosen the clamps and when
tuning is complete, return them to their original values.
● If tuning a primary controller outputting to a secondary’s set point, use tight output clamps
and/or tight secondary controller set point clamps to initially constrain the movement of the
secondary’s set point. As tuning progresses and confidence grows, loosen the clamps and when
tuning is complete, return them to their original values.
● If best set point response is desired, make set point changes. If best load response is desired,
a suitable DV must be sought to change; feed rate is often the easiest to change. A CV’s response
dynamics for DV changes are DV dependent. Therefore, if possible, test controller performance
for the most important DV(s).
● Loop response is very sensitive to increases in KC, and sensitive to decreases in 𝜏I, e.g., it is best
to make small changes when increasing KC or reducing 𝜏I.
● Increase KC to decrease response time, but a KC too large can cause loop overshoot and/or oscil￾lations.
● Use 𝜏I to reduce offset and decrease TTSS, but too much integral action (𝜏I too small) can cause
loop overshoot and/or oscillations.
● Use 𝜏D to reduce overshoot and TTSS, but if 𝜏D is too large, noise can lead to erratic responses.
If derivative action is necessary, use a derivative filter if available; if not, consider a PV filter.
● Start trial-and-error tuning with PI control only, with no derivative action (τD ≡ 0).
● With 𝜏I fixed, adjust KC to obtain the desired response time. With KC fixed, adjust 𝜏I to obtain
the desired approach to steady state, i.e., the desired TTSS.
● If 𝜏D is added, it is normally best to increase KC and 𝜏I simultaneously.
● The following published tuning guidelines (Ref. [7]) are especially helpful:
– As 𝜃/𝜏 increases from 0 to 4, the ratio 𝜏D/𝜏I ranges between 0.1 and 0.4. Therefore, consider
𝜏D ≈ 0.25 * 𝜏I a reasonable initial 𝜏D value.
– To improve loop responses as 𝜃/𝜏 increases, decrease proportional action (smallerKC), decrease
integral action (larger 𝜏I), and increase derivative action (larger 𝜏D).
– To improve loop responses as scan rate (TS) increases (control at slower frequency), decrease
proportional action (smaller KC), increase integral action (smaller 𝜏I), and increase derivative
action (larger 𝜏D).
Tuning Rules Developed Using Online, Closed-Loop Data
The Ziegler–Nichols (Ref. [8]) online, closed-loop approach forces the unit into stable, sustained
oscillations with constant amplitude. This is achieved by slowly increasing the proportional gain
of a P-only controller. These tuning rules are analytic expressions that relate PI and PID tuning
parameters to the experimentally determined ultimate gain, KU (the value of KC that achieves
sustained oscillations), and the ultimate period of the CV’s oscillation, PU. However, these tuning
rules are considered too aggressive (too much oscillation and overshoot), and forcing the plant into
sustained oscillations is considered unacceptable. Thus, the Ziegler–Nichols closed-loop tuning
rules are not used today.
The Relay Auto-Tuning method (Ref. [2]) replaces Ziegler–Nichols’ P-only controller with an
“On-Off” controller, sometimes called a “bang-bang” controller, that also forces the CV’s response
into a sustained oscillation, from which KU and PU can be determined. KU and PU are then Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License88 2 Feedback Control Essentials
used with the Ziegler–Nichols tuning rules or other published rules (Ref. [2]) to generate tuning
parameters. These tuning rules are also considered too aggressive, and although the input signal
used is different, forcing the plant into sustained oscillations is still unacceptable.
Tuning Rules Developed Using Simulated Process Response Data
Ziegler–Nichols’ also presented an open-loop technique (Ref. [8]) based on a CV’s open-loop
response to a step change in the MV. They assumed a first-order plus deadtime linear model and
presented a graphical method to determine the model parameters, KP, 𝜏, and 𝜃. The tuning rules
developed for both PI and PID controllers, relate the tuning parameters (KC, 𝜏I, and 𝜏D) to the
model parameters. In a related approach, a set of tuning rules were developed by Cohen and Coon
(Ref. [9]) based on process response data generated by a simulated first-order plus deadtime linear
model. They developed PI and PID tuning rules that correlate the tuning parameters with the model
parameters used to generate the closed-loop responses. However, these two approaches have the
same downside – the tuning is too aggressive, e.g., too much oscillation and too much overshoot.
Model-Based Tuning Rules
There are vast numbers of tuning rules available that are model based (Ref. [10]). These are the
four most important model-based tuning methods:
● Design Synthesis
● Internal Model Control (IMC)
● Lambda Tuning
● Offline Optimal Tuning Parameters
In addition to Ref. [10], more complete discussions, and representative tuning rules for each of
the methods listed above and discussed below can be found in several process control textbooks
(Refs. [11–14]).
The Design Synthesis Method (Ref. [15]) uses a process model, and a desired closed-loop response,
to derive an analytic form of the controller’s transfer function, GC(s). The starting point is a block
diagram of the feedback control loop in Figure 2.29. GC(s) and GP(s) are the s-domain controller
and process transfer functions, respectively.
Assuming no disturbances (DV(s) ≡ 0), the closed-loop transfer function that describes the set
point response – Y(s)/YSP(s), where Y(s) is the CV’s PV in the s-domain and YSP(s) is the CV’s SP
in the s-domain, is obtained using standard s-domain algebra:
Y(s)
YSP(s) = GP(s) ∗ GC(s)
[1 + GP(s) ∗ GC(s)] (2.22)
Solving Equation (2.22) for the controller, GC(s):
GC(s) = 1
GP(s) ∗
⎧
⎪
⎨
⎪
⎩
( Y(s)
YSP(s)
)
[
1 −
( Y(s)
YSP(s)
)]
⎫
⎪
⎬
⎪
⎭
(2.23)
MV(s) GC (s)
Y(s)
DV(s)
YSP (s)
GP + (s)
–
E(s) +
+
Figure 2.29 s-Domain Block Diagram of a Feedback Control Loop
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.4 PID Control Algorithm Basics 89
A process model and a desired closed-loop response are the focus of the design synthesis
method – this is also true for the IMC and Lambda tuning methods. Substituting the assumed
process model’s transfer function GM(s) for GP(s), and the desired closed-loop response’s transfer
function Yd(s) for Y(s)/YSP(s) in Equation (2.23), the design synthesis method’s controller transfer
function results:
GC(s) = 1
GM(s)
∗ { Yd(s)
[1 − Yd(s)]}
where Yd(s) = ( Y(s)
YSP(s)
)
desired (2.24)
The design synthesis method’s controller GC(s) in Equation (2.24) is a function of the process
model, GM(s), and the desired closed-loop responses, Yd(s). This method’s more important tuning
rules have been developed with GM(s) assumed to be either a first- or second-order plus deadtime
model and the desired closed-loop response’s transfer function, Yd(s) chosen as a first-order plus
deadtime model:
Yd(s) = [ exp(−𝜃s)
𝜏Cs + 1
]
(2.25)
In Equation (2.25), 𝜏C is the desired closed-loop response’s time constant. It is an additional
tuning parameter that can be varied to directly adjust CV closed-loop response times and MV
overshoot – by increasing 𝜏C, the CV’s closed-loop response times are increased and MV overshoot
is reduced. Once the expressions for GM(s) and Yd(s) are substituted into Equation (2.24), and
Equation (2.24) is transformed to reveal its PID structure (Refs. [13, 16]), the tuning rules relating
the PID tuning parameters (KC, 𝜏I, and 𝜏D) to the model parameters (KP, 𝜃, and 𝜏) and the desired
closed-loop response’s time constant (𝜏C), can be identified (Ref. [10, 15]).
IMC (Ref. [17]), like the design synthesis method, is also based on an assumed process model, and
a desired closed-loop response, although IMC’s desired closed-loop response is somewhat different.
However, the desired response is first order and includes a desired closed-loop response time con￾stant, 𝜏C, that provides the same functionality as the design synthesis method – an additional tuning
parameter adjusted to change CV response times and MV overshoot. Note that the IMC GC(s) can
be identical to the design synthesis GC(s) if the assumed model has the same order (first or sec￾ond order, with deadtime), and the desired closed-loop response is the same. Some IMC tuning
rules are reported in Refs. [15–17]; a comprehensive summary of IMC tuning rules can be found
in Ref. [10].
Lambda Tuning (Refs. [18, 19]) is a special case of IMC with a first-order process model – this
means Lambda tuning and IMC produce identical tuning rules for PI and PID control for
first-order plus deadtime models (Ref. [13], pg. 211). The term “lambda tuning” refers to adjusting
a parameter (𝜆) that directly impacts the control loop’s desired closed-loop response, e.g., the CV’s
response time and the MV’s overshoot. This makes 𝜆 equivalent to the design synthesis and IMC’s
𝜏C – increasing 𝜆 increases CV response times and decreases MV overshoot, while decreasing 𝜆
decreases CV response times and increases MV overshoot.
The offline optimal tuning parameter approach (Refs. [1, 7]) uses a feedback control system
simulation with a linear process model, most often first or second order with deadtime, to generate
closed-loop CV responses for PI or PID calculated MV adjustments. As shown in Figure 2.30,
an optimizer is linked to the simulation, and for a given set of model parameters, it calculates
optimal PID tuning parameters by minimizing an objective function that is a function of the
closed-loop response’s accumulated (e.g., integral over time) controller error, E = (SP – PV) – see
Equations (2.26a), (2.26b), and (2.26c).
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License90 2 Feedback Control Essentials
Process
model
Load
MV
SP
+
CV
KC, τI
 , τD
+
– PV
Model parameters
KP, θ, τ
PV
MV
+
Controller
(PI or PID)
SP
Optimizer
Figure 2.30 Feedback Control System with PI or PID Controller and Process Model Linked to Optimizer
The calculations performed using the procedure illustrated in Figure 2.30 have included the
following options:
+ First- and second-order plus deadtime process models
+ PI and PID controllers with proportional on both error and PV
+ PID controllers configured with derivative on both PV and error
+ Ideal and nonideal versions of the PID
+ Fast/best set point and load responses.
For a given set of first-order plus deadtime model parameters, KP, 𝜃, and 𝜏, a closed-loop response
and an objective function value is generated for the set of tuning parameters (KC, 𝜏I, 𝜏D). The opti￾mization algorithm decides on the next best set of tuning parameters to try and the calculation
continues in this way until it finds the optimal set that minimizes the objective function for the
chosen KP, 𝜃, and 𝜏 values. Optimal tuning parameters are calculated for other sets of model param￾eters to cover the full range of possible model parameters. For first-order plus deadtime models,
optimal tuning parameters have been correlated analytically versus model parameters for 𝜃/𝜏 ≤1
(Ref. [7]) and graphically versus the model parameters for 0≤𝜃/𝜏 ≤4 (Ref. [10]).
The most frequently used objective functions are the following:
IAE = ∫
∞
o
abs(E) ∗ dt (2.26a)
ISE = ∫
∞
0
E2 ∗ dt (2.26b)
ITAE = ∫
∞
0
t ∗ abs(E) ∗ dt (2.26c)
IAE and ISE try to eliminate controller error as soon as possible after a set point change or a load
upset. This can cause large MV changes that may lead to unwanted MV (and CV) overshoot and/or
MV oscillation. Any nonzero value of error (E2 or Abs(E)) increases all three objective function
values, but multiplying Abs(E) by time (t) gives ITAE two advantages: it de-emphasizes the effect
of error at very small times, but a nonzero error a “long time” after the set point change or the load
upset makes ITAE even bigger. Thus, it tends to be more conservative initially, but it penalizes pro￾longed oscillations. Therefore, tuning rules generated by minimizing ITAE are usually preferred.
Note that one investigator (Ref. [7]) has added a maximum MV % overshoot penalty function to
the ITAE to make the closed-loop responses more acceptable for online operations. Important: Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.4 PID Control Algorithm Basics 91
Using ITAE to measure control loop performance for online tuning is not practical because of the
consequences of noise, unmeasured DV upsets, and random upsets.
Like all other model-based tuning methods, the offline optimal tuning studies for the most part
did not include the effect of scan time on the tuning rules. There is one exception – the graphical
correlations reported by King (Ref. [7]) that include how the PID parameters vary with scan rate,
TS. His significant results indicate tuning parameters that consider the controller’s scan time
provide acceptable PID performance even when TS ≈𝜏. This has important consequences for
some complex cascades when an ultimate primary must do control at a relatively slow frequency
(e.g., most analyzer and some tower temperature controllers). Also, performance shortcomings in
some DCS’ require more complex and slower responding segments of a cascade to be implemented
in nonprocess connected devices where scan rates must be slow.
Another important implication of King’s results re/TS relates to how KC, 𝜏I, and 𝜏D correlate
with TS – optimal values of KC increase (more proportional action), while 𝜏I values increase (less
integral action) and 𝜏D values decrease (less derivative action) as TS decreases from TS = 𝜏 to
TS = 0. Because of the unambiguous relationship between KC and response times – increasing KC
decreases response time, it follows that faster responses (with larger KC) can be achieved at lower
(faster) control frequencies (TS ≪ 𝜏), and less integral and derivative action is needed to prevent
too much CV response overshoot or oscillation.
Software Tuning Tools
Many software packages are available that provide tuning functionality (Ref. [20]). However, among
these software packages, only a small subset support online operations, e.g., data collection, online
tuning, etc. An example offline tool (Ref. [21]) uses process data resident in the plant historian
to develop dynamic transfer function models offline; plant tests to capture cause and effect rela￾tionships are not necessary. A companion offline tool uses the model to simulate the plant, and
with typical set point changes, noise, and disturbances, the PID tuning is optimized (by reducing
oscillations and speeding up sluggish control) for the custom simulation. This method’s success
depends upon (i) how much accurate real-time plant dynamics are imbedded in the historized
plant data and ultimately (ii) the developed model’s fidelity.
Online tools typically require a time-domain model (not a frequency response model), and the
model parameters are used in the tuning parameter calculations. IMC and lambda tuning are
the most widely used online tuning methods, and therefore, most of these commercial software
packages offer IMC and lambda tuning parameters, described earlier, that users adjust to attain
the closed-loop response that meets their application’s requirements. Microsoft Windows is cur￾rently the most important supported platform that enables data exchange with online applications.
The most important public (non-DCS vendor specific) interface supported for online operations
(Ref. [22]) is Microsoft’s OLE (Object Linking and Embedding) for Process Control (OPC).
The leading DCS vendors, e.g., ABB, Emerson, Invensys (Foxboro), Honeywell, and Yokogawa
provide software tools integrated with their hardware modules that feature automated con￾troller tuning; their functionality and capabilities are marketed with their DCS hardware. These
vendor-supplied tuning tools are the most effective online tuning tools available. Automated
tuning is mainly implemented using two approaches: either (i) tuning on demand with upset
or (ii) adaptive tuning. Tuning on demand with upset determines PID parameters by generating
a planned process upset; the response is measured and analyzed, and the calculated dynamic
parameters are used to calculate the appropriate controller parameters. Adaptive tuning determines
the PID parameters without a planned process upset. The adaptive tuning tools are configured
to monitor the targeted control loops and if oscillations are detected, the application attempts to
remove them by adjustments to the PID parameters.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License92 2 Feedback Control Essentials
Closure: Controller Tuning Rules
Ref. [10] presents an exhaustive summary of PI and PID tuning rules developed over the years for
both self-regulating and nonself-regulating single input–single output processes with deadtime.
Tuning parameters are presented in tabular form for a variety of PI and PID versions and options,
six different model structures, e.g., first-order plus deadtime, and are classified into one of these
five methodologies:
● From process response curve
● Minimizing performance criteria e.g., ITAE
● Achieving a specified closed-loop response
● Ultimate cycling methods
● Gain/phase margins (frequency domain)
The tables have four or five columns, depending on whether the controller considered is a PI or
PID. The first column presents the rule’s author and a reference to its source. The final column,
labeled “Comment,” contains useful information about the tuning rule’s use and application. The
PI and PID parameter formulas are presented in the remaining two (PI) or three (PID) columns.
As mentioned earlier, it is essential to make sure the user’s tuning circumstances align with the
specific set of conditions adopted when the rule was derived. For example, does the rule apply to
best set point or load response, to proportional on PV or error, etc. In many cases, these condi￾tions are not addressed in the tuning rule’s presentation in the table. If so, it is advisable to check
the tuning rule’s original source to ensure it is applicable to the user’s current need. In some cases,
the tuning rule calculation details are rather complex, and clarification on applicability can again
be sought from the original source.
2.4.8 Tuning Cascaded Controllers
The tuning guidelines and tuning rules presented and discussed above are applicable to all control
loops, whether they are in a simple or complex multilevel cascade or a single control loop. Here are
additional guidelines that apply when tuning cascaded controllers:
● To tune any controller, the cascade is broken between the CV and MV.
● Always start with the ultimate secondary. Tune for best set point response, proportional on error,
and configure for SPInit =Yes.
● Starting at the bottom and working up the cascade, as each loop is tuned and commissioned,
proceed to tune its primary. All secondaries are tuned for best set point response, proportional
on error, and configured for SPInit =Yes. If the controller must also provide fast response to load
upsets, then tune for best set point response but with proportional on PV.
● For several typical process unit control strategies (e.g., tower tray temperature and quality control,
reactor conversion control), the need to include derivative action increases as controller tuning
moves up the cascade. Derivative action is always on PV.
● Each secondary’s tuning and its closed-loop response to set point changes contribute to the
dynamic response of its primary and all controllers above its primary. Therefore, if a secondary
is re-tuned, all primaries above it in the cascade may have to be re-tuned as well.
● The ultimate primary’s CV type, e.g., level, temperature, composition, etc., determines if it is
tuned for fast set point response or fast load response, its proportional option, and whether it is
configured for SPInit =Yes or No.
To illustrate how controllers in a multilevel cascade are tuned, we will again use as an example
the multilevel simple cascade, AC95 → TC87 → FC86, shown in Figure 2.3. We review the control Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.5 Noise, Filters, Plant Testing, and Closed-Loop Control 93
objective of each controller and then explain how the above guidelines are applied to this specific
cascade.
As the ultimate secondary, FC86 is tuned first. The tuning guidelines and tuning rules presented
earlier are all applicable when FC86 is tuned – as a PI controller, tuned tightly for fast/best SP
response with proportional on error, and SPInit = Yes. Typical flow controller tuning parameter
values are good first estimates, and in auto mode, FC86 is easily fine-tuned using trial-and-error
set point increases and decreases.
TC87 likely has relatively slow dynamics and moderate deadtime, and thus it is best to use an
appropriate tuning rule to generate the initial tuning values. Because TC87 must respond to both
set point changes and load upsets it is best to tune for fast/best SP response with proportional on
PV. As a cascade secondary, configure SPInit = Yes to ensure bumpless transfer on an initialization
pass. And because derivative control action helps manage loop deadtimes, a PID tuning rule is
preferred. With FC86 tuned and in auto mode, FC86 SP is changed, and TC87 PV response data is
recorded to identify a TC87 – FC86 dynamic model. Fitting a first- or second-order plus deadtime
model to the data provides the model parameter values needed to calculate tuning parameters using
an appropriate tuning rule.
Fine-tuning TC87 using trial-and-error is more time-consuming than FC86 but probably still
manageable. With FC86 in cascade mode and TC87 in auto mode, TC87 SP changes provide the
closed-loop TC87 PV responses to judge tuning suitability, and if necessary, to improve tuning. It is
best to change TC87 SP in both directions, with different magnitudes. Since TC87 must also reject
disturbances, including a load upset (perhaps tower feed rate, FC87 SP, or reboiler hot fluid flow,
FC89 SP) is advisable to assess TC87’s ability to manage disturbances.
Trial-and-error tuning is certainly not practical for AC95. If its response to TC87 set point changes
indicate slow dynamics and moderate deadtimes (but 𝜃/𝜏 < 2), then using the tuning rules should
be acceptable. However, if deadtime is significant (𝜃/𝜏 >2), then a model-based approach is
preferred to PID control. In either case, plant testing is required to either tune AC95 as a PID
(only responses to TC87 SP changes are required), or for the model-based approach, to develop a
reliable AC95 – TC87 dynamic model, with perhaps other (DV) inputs (e.g., feed rate) that require
additional plant tests.
Only the PID option is considered here. Since AC95 is an ultimate primary and has a product
quality target, its set point will be changed infrequently. Thus, it is best to tune AC95 for fast/best
load response with proportional on PV, and configure SPInit = No. Then, with the TC87 → FC86
cascade tuned, TC87 in auto mode and FC86 in cascade mode, TC87 SP changes generate AC95
PV dynamic response data. An appropriate dynamic model is developed, and the model’s dynamic
parameter values used in an appropriate tuning rule (which includes derivative action) to calculate
AC95’s initial tuning parameter values.
Fine-tuning AC95 using trial-and-error will be difficult, much more time consuming than TC87,
and may not be useful. If attempted, since AC95 SP will be changed infrequently, AC95 set point
changes are not relevant, and a load variable, perhaps tower feed rate (FC87 SP) and/or tower
overhead pressure (PC77 SP), must be changed to evaluate and if necessary, improve AC95’s tuning.
2.5 Noise, Filters, Plant Testing, and Closed-Loop Control
Noise refers to the random fluctuations that are superimposed on a process measurement. As
this section will emphasize, noise can impact plant test data and affect closed-loop controller
performance. Noise on a CV is only a problem if an excessive amount of the noise is transferred to
its MV. Filtering is the common method used to reject noise (smoothing the signal), and the linear Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License94 2 Feedback Control Essentials
exponential filter is by far the most frequently used filtering algorithm. However, filtering also
distorts the signal, e.g., slows it down, and thus, filtering adds additional lag to the control loop.
As noise rejection improves via increased filtering, signal distortion also increases, and filtering
often becomes a trade-off between noise rejection and signal distortion. Therefore, normally only
CVs need filtering, and the objective is to filter CVs only enough to reduce the noise transferred to
the MV to an acceptable level.
This section starts with a discussion of the signal-to-noise ratio, a somewhat quantitative indica￾tion of the extent to which noise distorts the basic process signal. The effects of noise and filtering
on plant testing, controller tuning, and control loop performance are examined next. This section
concludes with a discussion of the linear exponential filter algorithm, and how its filter time con￾stant, τF, and the scan time, TS, affect noise rejection and signal distortion.
2.5.1 Signal-to-Noise Ratio
The signal-to-noise ratio is an indicator of the extent to which noise distorts the base process signal.
Estimating the signal-to-noise ratio is an important prerequisite to planning a plant test, i.e., it
helps choose an independent variable step change magnitude that ensures the dependent variable’s
base process signal is clearly captured in the data. If so, the dependent variable’s response data will
show clear trends and contain sufficient dynamic content to allow acceptable model parameter
estimates to be made.
To calculate the ratio, estimates of the noise’s magnitude (N) and the dependent variable’s
base signal’s change (S) must be made; the method used to estimate these quantities is shown in
Figure 2.31.
Figure 2.31 shows the open-loop response of a measured, noisy potential CV to either a load (DV)
change or a change in a potential MV’s set point. From its initial steady state value, the CV increases
and lines out at a new steady state, “S” units above the original value. Also indicated in the figure
is how to estimate the noise’s magnitude, “N.” The ratio S/N is the signal-to-noise ratio, and in
this case, the underlying base signal’s movement is not concealed by the measured signal’s noise.
If this was plant test data collected to determine the CV – DV or CV – MV response dynamics,
there is enough dynamic content in the data to determine the model’s dynamic parameters either
graphically or via a more sophisticated regression program. As the S/N decreases, changes in the
actual process signal will become concealed by the noise, and the data collected will contain little
useful information. Obviously, a suitable S/N ratio is extremely important for plant testing.
S
N Signal-to-noise ratio =
N
S
Old steady state
New steady state
Measured
PV
Time → Upset
occurs
Figure 2.31 How to Calculate the Signal-to-Noise Ratio
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.5 Noise, Filters, Plant Testing, and Closed-Loop Control 95
The smaller the S/N ratio, the more important it is to manage the noise and the more difficult
it may be to achieve good closed-loop control performance. The effects of noise and filtering on
controller tuning and control loop performance are considered next.
2.5.2 Filtering
CV noise is not a problem unless the CV’s control output transfers excessive amounts of noise to
its MV. Filtering the CV will reject the noise, smooth controller outputs, and reduce the amount
of noise transferred to the MV’s setpoint or to a valve’s movements. However, filtering distorts
the CV signal and adds an additional lag to the closed-loop response. This slows the closed-loop
response and can lead to control performance problems. Thus, the CV should be filtered only
enough to reduce, to an acceptable level, the amount of CV noise transferred to the MV.
Remember: Derivative control action is very sensitive to noise, and when the DCS provides a filter
for derivative action, its use is recommended. And depending upon the proportional gain’s magni￾tude, proportional control action can also be sensitive to noise, but to a lesser extent than derivative
action.
It is important to filter a noisy CV measurement, before plant testing, when identifying dynamic
model parameters to use in tuning parameter calculations. Assume the CV is a noisy signal, but a
plant test is carried out without a filter. As shown in Figure 2.32, the control loop is broken at the
controller’s output, and the MV’s set point is changed to generate the CV’s response. The collected
data reflect the dynamic relationship between the MV and the CV implicit in the process transfer
function, GP(s). In s-domain jargon, the open-loop transfer function between CV and MV is GP(s).
After the noisy CV data is collected, the CV – MV response is fit to a linear model, GM(s), and
GM(s)’s dynamic parameters are used to calculate the initial tuning parameters for GC(s). GM(s) is
essentially an approximation for the MV–CV process relationship represented by GP(s).
However, if before the loop is closed there is concern that the CV’s controller output will transfer
excessive noise to the MV, and a CV filter is added to reject the noise, the closed loop is as shown
in Figure 2.33.
The s-domain structure of the closed loop in Figure 2.33 demonstrates the problem that arises by
adding a filter after the plant test. GC(s)’s tuning parameters were based on the model parameters
MV(s) GC (s) 
CVSP (s) GP + (s)
–
E(s) CV(s)
Figure 2.32 Open Loop Plant Testing Without Filter
MV(s) GC(s)
CVSP (s) GP + (s)
–
E(s) CVF CV(s) (s)
Filter
GF(s)
Figure 2.33 Closed Loop Control with Filter Added
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License96 2 Feedback Control Essentials
of the approximation for the CV–MV process relationship (GP(s)), identified using CV–MV data
collected without the filter (in Figure 2.32). The collected data reflect only the open-loop transfer
function between CV and MV, i.e., GP(s). However, with the filter GF(s) included in the closed loop
in Figure 2.33, controller GC(s)’s input is CVF(s), (= CV(s) * GF(s)), not CV(s). CVF(s) is the lagged
version of CV(s), since it is altered by the dynamics of filter GF(s), and therefore, the GC(s) tuning
parameter basis (GP(s)) is not aligned with the actual open-loop dynamics (GP(s) * GF(s)). Again,
in s-domain jargon, the set of data needed to calculate GC(s)’s tuning parameters must be based on
the open-loop transfer function that includes the filter, i.e., GP(s) * GF(s). Therefore, with the filter
added after the plant test, control performance may not be acceptable and controller re-tuning may
be necessary.
Ultimately, control performance with the misaligned initial tuning constants will depend upon
the amount of filtering used – the magnitude of the filter time constant, 𝜏F, and how 𝜏F’s magnitude
compares to the process’ dominant time constant, 𝜏P. The larger 𝜏F and the larger the ratio 𝜏F/𝜏P,
the more likely performance will not be acceptable and re-tuning will be necessary.
Even if filtering precedes plant testing, filtering will affect closed-loop performance. The filter,
GF(s), is an additional lag in the closed-loop, and hence it will slow the closed-loop response.
Increasing the filter time constant, 𝜏F, increases noise rejection but also adds additional lag to the
loop, further distorts the CV’s signal, and slows the closed-loop response. How much signal distor￾tion occurs is dependent on the ratio 𝜏F/𝜏P. As the ratio increases, there is more noise rejection, but
eventually, the ratio reaches a value where signal distortion becomes more observable. Therefore,
because a filter cannot be perfect, filtering often becomes a trade-off between noise rejection and
signal distortion.
2.5.3 Linear Exponential Filter Algorithm
We have already introduced the linear exponential filter in Chapter 1, Section 1.5.4 (in Equations
(1.14a) and (1.14b) repeated below) as an algorithm very closely related to a first-order sampled
data difference equation with deadtime:
Yn = b ∗ Yn−1 + (1 − b) ∗ Xn (1.14a)
b = exp (−TS
𝜏F
)
(1.14a)
Yn is the filtered value on the current pass, Yn−1 is the filtered value on the last pass, and Xn is
the current raw measurement. As presented in Section 1.5.4, to convert the first-order sampled
data difference equation shown in Equation (1.13) to the exponential filter in Equation (1.14a), the
steady-state gain, KP, is set equal to one, the deadtime equal to zero, and to increase its sensitivity
to changes in the raw measurement, the current input (the raw measurement), Xn, has replaced
the previous input, Xn−1. Note that in many publications, and in some DCS documentation, the
exponential filter weighting factors, b and (1−b), are replaced by the more historical P and (1−P);
with this substitution, the linear exponential filter becomes:
Yn = P ∗ Yn−1 + (1 − P) ∗ Xn (2.27a)
P = exp (−TS∕𝜏F) (2.27b)
Equation (2.27a) is the discrete time version of the filter transfer function GF(s) that is included
in Figure 2.33. Notice that Equation (2.27b) relates the weighting factor P to both 𝜏F and Ts and
thus TS, in addition to 𝜏F, has impact on the amount of filtering and noise rejection. Note that TS, Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.6 Ratio Control 97
𝜏F, and weighting factor b are related in the same way in Equation (1.14b). In some older DCS’,
the user enters a P value, where 0 < P <1 and in other, newer DCS’, the user enters the filter time
constant, 𝜏F, directly, and the DCS calculates P internally using the filtering tag’s scan time, TS.
P values range from about 0.6 to about 0.9, but remember that many combinations of 𝜏F and TS
can give the same value of P.
From Equations (2.27a) and (2.27b), as 𝜏F increases at any TS, P increases and less weight is
placed on the raw measurement; thus, as P approaches one, maximum filtering is approached.
Likewise, as 𝜏F decreases, P decreases, and more weight is placed on the raw measurement; thus,
as P approaches zero, minimum filtering is approached. TS’s effect on the amount of filtering can
also be assessed from Equations (2.27a) and (2.27b). At constant 𝜏F, as TS decreases, P increases,
and as it approaches one, maximum filtering is approached; as TS increases, P decreases, and as it
approaches zero, minimum filtering is approached. Therefore, scanning a variable faster (decreas￾ing TS) will increase noise rejection, and if the filtered variable is a CV, reduce noise transferred to
the MV. And because changes in TS do not affect signal distortion, scanning faster to increase noise
rejection has no signal distortion trade-off.
Because scanning faster increases noise reduction, it follows that filtering the raw measurement
in a process-connected device (e.g., TDC3000’s APM or Experion’s C300), where scan times are
fastest, will provide the best noise rejection. However, despite the noise, some sites still want to
preserve the raw measurement in a dedicated tag for operator displays and/or history. If so, a paral￾lel tag can be built with the same raw measurement input, but with filtering, for use in the control
strategy.
Note: Scan times are normally chosen to satisfy a process control need or to satisfy a control hard￾ware/software constraint and are rarely chosen to maximize noise reduction. However, most DCS’
provide functionality that allows fast scanning to more efficiently filter but allows a “slow down”
in the tag’s control processing, e.g., the control algorithm executes at a frequency slower than the
scan time, to satisfy the process control need.
2.6 Ratio Control
Maintaining the ratio of two process variables constant is a common operating objective. Here are
some frequently controlled ratios that are implemented in the indicated process unit:
● Heat fired/feed, combustion air/heat fired – in fired heaters
● Reboiler duty/feed, reflux flow/feed, distillate flow/feed – in light-ends towers
● Sidestream draw-off flow/feed, pumparound duty/feed, stripping steam flow/bottoms flow – in
fractionators
● Stripping steam flow/sidestream draw-off flow – in sidestream steam strippers
● Treat gas flow/hydrocarbon feed – in gas oil hydrofiners (Gofiner)
● Steam/carbon in feed, furnace duty/carbon in feed – in steam reformers
Using stripping steam flow/bottoms flow ratio control as an example (see Figure 2.34), the ratio
controller’s set point, RC90 SP, is the desired steam flow/bottoms flow ratio, and RC90 resets the
steam flow controller’s set point FC90 SP to satisfy the ratio set point. Therefore, whenever the
bottoms flow changes, the ratio controller will calculate a new value of steam flow to maintain the
ratio constant.
In addition to its set point, ratio controller RC90 has two other inputs. The bottoms flow, FC92,
is called the wild flow input, while the steam flow FC90 is called the controlled flow. The ratio Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License98 2 Feedback Control Essentials
RC90
SP
SP
Steam/bottoms
ratio 
Desired
steam/bottoms
ratio 
Steam
FC
92
FC
90
FV90
Bottoms
flow
Steam
flow
Note:
FC92 = Wild flow
FC90 = Controlled flow
Figure 2.34 Fractionator Bottoms Stripping
Steam/Bottoms Flow Ratio Control
controller’s PV is calculated as the ratio (in EUs) of wild flow to controlled flow (in our case, FC90
PV/FC92 PV):
Ratio controller PV ≡ Controlled flow PV
Wild flow PV (2.28)
and the ratio controller’s output (RC90 OP) is the controlled flow’s set point (FC90 SP), in percent
of range of FC90’s EUs. The control calculation is most often a simple, arithmetic calculation:
Ratio controller OP ≡ Controlled flow SP = Ratio SP ∗ Wild Flow (2.29)
RC90 OP is calculated in both the controlled flow’s (FC92) EUs, and in % of range of the controlled
flow’s EU high/low values.
The calculation steps and information flow on each ratio control execution pass, from inputs
to outputs, are illustrated in Figure 2.35. The inputs are the wild and controlled flow PVs, the
ratio controller’s SP and possibly (see Section 2.6.2) the wild flow controller’s SP, all in EU. The
outputs are the ratio controller’s output in % of range of the controlled flow, and the controlled
flow’s set point in EU. The calculation overview in Figure 2.35 does not necessarily mirror a spe￾cific DCS but is meant to conceptually illustrate the steps involved in a generic ratio controller
execution pass.
EU =Engineering units
X1 PVn = Wild flow PV
X1 SPn = Wild flow SP
X2 PVn = Controlled flow PV
X2 SPn = Controlled flow SP
Ratio SPn = Ratio set point
X2 PVH =X2 PV EU range high
X2 PVL =X2 PV EU range low
X2 PVn
EU
Ratio PV
calculation Ratio PVn
EU
X1 PVn
Ratio control
calculation
(X2 SPn – X2 PVL) * 100%
(X2 PVH – X2 PVL)
X2 SPn
EU
Ratio OPn(%)
EU → % of range Ratio SPn
EU
Ratio controller
X1 PVn
or
X1 SPn
Figure 2.35 Ratio Controller PV and Output Calculations
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.6 Ratio Control 99
Note 1: We have used the terms wild flow and controlled flow in the above discussions. However,
both the wild flow and controlled flow can be something other than a measured or calculated
“flow.” For example, there are control strategies that include fired heater heat duty as a wild “flow”
input and reboiler heat duty as a controlled “flow.” In addition, there are control strategies imple￾mented in reaction systems that have ratio controllers with a composition (e.g., % H2 in recycle,
molar carbon in feed) as a nonflow wild “flow.”
Note 2: When the relationship between the ratio and the CV is nonlinear, ratio control is best imple￾mented as a standard PID controller, with the controlled flow/wild flow ratio the PID’s PV input.
For example, control strategies are presented later that control a light-ends tower’s reflux/feed ratio,
one by manipulating the overhead temperature and the other by manipulating the overhead pres￾sure. In both cases, the reflux/feed ratio is a nonlinear function of the MV, and thus, the ratio
controller is implemented as a PID controller.
Important: When the ratio controller’s output calculation is algebraic (Equation (2.29) and in
Figure 2.35), the ratio controller’s PV – the ratio of controlled flow to wild flow, is calculated for dis￾play, historization and reports generation purposes only. In Equation (2.29), the ratio controller’s
PV does not impact the ratio controller’s control calculation – the calculation uses only the ratio
controller’s set point and the wild flow’s PV or SP. Therefore, there is no feedback and in effect
ratio control is not a traditional feedback controller. However, cascade initialization and wind-up
protection for ratio controllers are managed via standard DCS features as if they were traditional
feedback controllers. As illustrated in Chapter 3, and in many examples presented in later chapters,
ratio control is incorporated into many common and important control strategies.
2.6.1 Ratio Controller Benefits
Ratio control strategies, with a ratio controller as ultimate primary, frequently have energy conser￾vation incentives. For example, maintaining a constant stripping steam to tower bottoms flow ratio
(as in Figure 2.34) helps reduce stripping steam utilization. Without steam/bottoms ratio control,
operators typically use more steam than necessary to insure sufficient steam for the entire expected
range of bottoms flow. This over-stripping reduces the amount of time operators spend monitoring
the tower’s operation but wastes steam at all bottoms flow rates below the highest expected rates.
Similar energy savings are captured by the other ratio controller examples listed above – steam
savings (e.g., steam/carbon in feed in steam reformers), process heat utilization (e.g., light-ends
tower reboiler duty/feed controls), and compressor savings (Gofiner treat gas/hydrocarbon feed).
In multilevel cascades, ratio control is almost always used to introduce feedforward control. Feed￾forward control is discussed in detail in Chapter 3 but for now be aware that many feedforward
control loops in advanced regulatory and supervisory cascades include ratio control. An example
of an advanced regulatory application is presented below to illustrate the typical role played by ratio
control in feed rate feedforward control, a common and important feedforward loop. In Figure 2.36,
fired heater (F-302) COT (TC323) is controlled by manipulating fuel gas flow (FC319); this strategy
is upgraded to include feed rate feedforward control in Figure 2.37.
Like most fired heaters, feed rate (FC330) is almost certainly an important F-302 DV. However,
unlike inlet temperature (TI318, another potential DV), feed rate is normally controlled (FC330)
and thus its changes are not random upsets. When this is true, no matter the process unit, feed rate
is usually an ideal feedforward variable. Increases in feed rate will drive F-302 COT (TC323 PV)
down, and feed rate decreases will drive TC323 PV up. When FC330 SP is changed, because TC323
is a feedback controller, it starts to respond only after TC323 PV deviates from its set point (TC323 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License100 2 Feedback Control Essentials
FC
330
TI
318
TI
323
PI
320
FC
319
Fuel gas (FG) header
F-302
SP
FV319
TC323 
COT
control
FG flow
control
Feed flow
control
Figure 2.36 COT Feedback Control
RC319 
FC
330
TI
318
TI
323
PI
320
FC
319
FG header
F-302
SP
FV319
TC323 
SP
COT
control
FG/feed
ratio control
Feed flow
control
FCG319 
Dynamic
compensation
FG flow
control
Figure 2.37 COT Feedback Control with Ratio FF Control
SP). Feedforward control actions, as implemented in Figure 2.37, start immediately (via RC319)
after the feed flow set point is changed, reducing both the time TC323 PV deviates from its set point
and the deviation’s maximum magnitude. TC323’s fuel gas flow set point (FC319 SP) adjustments
(via RC319) continue until TC323 PV returns to its set point.
Figure 2.37 indicates the dynamic response of TC323 PV to changes in feed rate and fuel
gas are different, e.g., they have different dynamic response parameters. FCG319 dynamically
compensates12 the feed rate input using these two sets of dynamic parameters to ideally cancel
fuel gas and feed rate effects on TC323 PV (via RC319). If the dynamic responses of TC323 PV to
changes in feed rate and fuel gas flow had about the same dynamics, dynamic compensation would
12 Dynamic compensation is explained in Section 3.3.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.6 Ratio Control 101
not be necessary, and FCG319 would be excluded from Figure 2.37. The strategy in Figure 2.37,
with FCG319 excluded, would then be an example of steady-state ratio feedforward control (see
Section 3.2).
More insight into the fired heater’s feed rate response can be gained by looking at F-302’s
steady-state heat balance. Assuming there are no chemical reactions, no changes of phase and no
heat losses, Equation (2.30) below is F-302’s steady state heat balance that equates heat absorbed
by the process fluid to F-302’s heat fired:
FC330 PV ∗ CP ∗ (TC323 PV − TI318 PV) = Scale ∗ FC319 PV ∗ LHV (2.30)
Scale is a constant factor to ensure heat absorbed and heat fired have the same, desired EUs, CP
is the process fluid’s heat capacity and LHV is the fuel gas lower heating value (both assumed
constant). Solving Equation (2.30) for the temperature difference yields:
(TC323 PV − TI318 PV) = Scale ∗
[
LHV
CP
]
∗
[FC319 PV
FC330 PV
]
(2.31)
From Equation (2.31), at steady state, and with inlet temperature (TI318 PV) constant, COT TC323
PV will be constant if the fuel gas/feed flow ratio is held constant. The benefit of holding the fuel
gas/feed rate ratio constant motivates the control strategy in Figure 2.37.
Thus, maintaining the fuel gas/feed ratio constant, at steady state via Equation (2.31), TC323 PV
is ideally maintained constant. However, the dynamic response parameters used in the dynamic
compensation calculations are determined by fitting plant test data to linear models and thus
are susceptible to model error. Therefore, dynamic compensation is not perfect, and the feed￾forward corrections alone are not capable of holding TC323 PV constant, although temperature
deviations (without feedback) are typically still kept relatively small. To compensate for model
error, TC323 makes trim feedback adjustments to RC319 SP to return the temperature PV back
to its set point. Because model error is inevitable, feedforward control is always combined with
feedback control.
Like all feed rate feedforward control loops, the major advantage of including fuel gas/feed ratio
control in the fired heater example is to enable the corrective actions to start before the temper￾ature deviates from its set point, and with reasonable linear models, the temperature deviations
are kept small. In general, the most important aspect of feedforward control is the structure of
the dynamic compensation tag (FCG319 in our example). The dynamic compensation algorithm is
derived in Section 3.3, and many important dynamic and steady-state feedforward control design
and implementation issues are explored in Sections 3.3–3.6.
2.6.2 Ratio Control and Noise
PID control loop performance is adversely affected by excessive noise, especially the PID’s deriva￾tive control action, and to a lesser extent, its proportional gain’s magnitude. For PIDs, control
variable filtering, derivative control action filtering, or elimination of derivative control are the
common ways used to manage noise problems. For a ratio controller, the major source of noise is
the wild flow input. Since the wild flow is a control algorithm input (see Equation (2.29)), exces￾sive noise in the wild flow will be transferred to the controlled flow, and depending upon the unit’s
configuration, perhaps to other process units.
If the wild flow is uncontrolled, filtering is the only way to reduce the effect of noise. If the wild
flow is a CV, the best approach is to use the wild flow controller’s set point as the control algorithm’s
input. This will work well if the set point is a valid value for the current wild flow PV. This is true
when the controller is in Auto (or Cascade) mode and not wound-up, or when the controller is in Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License102 2 Feedback Control Essentials
Manual mode and SPInit = Yes (or, depending on the DCS, PV Tracking or SP Tracking = Yes).
If the wild flow controller13 is an ultimate secondary, it is already configured for SPInit = Yes.
However, if the controller is a single loop controller, the choice for SPInit is not clear-cut – if SP Init
is chosen Yes, the advantages of using its set point for the ratio controller’s wild flow input must
be assessed versus an initialized flow set point that may not be an offline specified guideline or an
operator’s preference. However, this problem can be resolved by user-provided custom code, or via
configuration, to slowly ramp the wild flow controller’s set point back to its guideline value after it
is transferred into Auto mode and it initializes.
2.6.3 Ratio Controller Initialization
A ratio controller must initialize in two circumstances: (i) to support bumpless transfer in a mul￾tilevel cascade and (ii) after the wild flow PV becomes available (“Good”) after being unavail￾able (“Bad”). Initialization to support its cascade’s bumpless transfer is managed by standard DCS
features. However, initialization after the wild flow PV’s return to available (“Good”) status must
be managed by user-provided custom code and logic.
When a ratio controller is forced to initialize, and its SP Init attribute is configured = Yes, the
ratio controller back-calculates its set point on the initialization pass using current values of the
controlled flow’s set point and the wild flow’s PV or SP, whichever has been configured as the wild
flow input (we assume here that the wild flow’s SP is the configured wild flow input):
Ratio SPInit Pass = (Controlled Flow SPInit Pass)
(Wild Flow SPInit Pass) (2.32)
This ensures the ratio controller’s set point is current as ratio control restarts. On the first con￾trol calculation after the initialization pass, i.e., n = Init Pass+1, the ratio’s control calculation
(Equation (2.29)) will look like this:
Controlled Flow SPInit Pass+1 = Ratio SPInit Pass ∗ (Wild Flow SPInit Pass+1) (2.33)
or
Controlled Flow SPInit Pass+1 = (Controlled Flow SPInit Pass)
(Wild Flow SPInit Pass) ∗ (Wild Flow SPInit Pass+1) (2.34)
Equation (2.34) indicates that if the wild flow set point is constant (Wild Flow SPInit Pass+1 ≡ Wild
Flow SPInit Pass), the controlled flow’s set point will equal its n = Init Pass value (Controlled Flow
SPInit Pass) and the ratio controller’s initialization will be bumpless. However, if the wild flow set
point has changed, then the controlled flow set point will also change to satisfy the initialized value
of the ratio’s set point.
Note: When the wild flow is uncontrolled, and its PV is the configured wild flow input, there will
likely be a (small) change in the controlled flow’s set point because normal measurement variations
will cause small differences between the n = Init+1 and n = Init wild flow PV values. However, if
a process change or an upset occurs that affects the wild flow, the PV’s variation may not be small.
The COT control cascade in Figure 2.37, TC323 → RC319 → FC319, is now used as the basis
to discuss how ratio controller initialization (in this case, RC319) supports bumpless transfer in a
multilevel cascade. With the full cascade operational – TC323 in Auto mode and both RC319 and
13 Remember the wild “flow” may not be a flow, e.g., it could be heat fired in a combustion air/firing ratio
controller, but use of the heat fired controller’s set point is still recommended.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.6 Ratio Control 103
FC319 in Cascade mode, assume FC319 is transferred into auto mode. RC319 can no longer output
to FC319 SP, TC323 can no longer output to RC319 SP – they are both output indisposable, and
COT control is decommissioned. When FC319 is transferred back to cascade mode with RC319 in
cascade mode and TC323 in auto mode, COT control is recommissioned after all three controllers
initialize. When transferred to cascade mode, FC319 sends an initialization request and an initial￾ization value, e.g., its current, set point, FC319 SPInit Pass, to RC319. Provided SP Init = Yes, the
initialization request from FC319 forces RC319 to initialize its set point, by using FC319 SPInit Pass
in Equation (2.32):
RC319 SPInit Pass =
[
FC319 SPInit Pass
FC330 SPInit Pass ]
(2.35)
After RC319 initializes its set point, as shown in Equation (2.35), it sends an initialization request
and an initialization value, RC319 SPInit Pass, to its primary, TC323. When RC319 runs on its next
execution pass, n = Init Pass+1, its output is calculated using Equation (2.33):
RC319 OPInit Pass+1(EU) ≡ FC319 SPInit Pass+1 = RC319 SPInit Pass ∗ (FC330 SPInit Pass+1) (2.36)
Then, substituting RC319 SPInit Pass given in Equation (2.35) into Equation (2.36) yields:
FC319 SPInit Pass+1 =
[
FC319 SPInit Pass
FC330 SPInit Pass ]
∗ (FC330 SPInit Pass+1)
Thus, with wild flow FC330 SP unchanged, FC319 SPInit Pass+1 ≡ FC319 SPInit Pass, and the
RC319 → FC319 segment of the cascade initializes bumplessly. Whether the entire cascade is
commissioned bumplessly depends upon whether TC323, a PID controller, is configured for
SPInit = Yes or No.
Avoiding a bump when the wild flow PV becomes available (“Good”) after being unavailable
(“Bad”), is managed by user-provided custom code/logic. The COT control cascade in Figure 2.37
is now used to explain (i) how the feedback path from TC323 to FC319 SP via RC319 remains
in operation when the wild flow’s PV becomes unavailable and (ii) how the wild flow’s return to
available recommissions feedforward control bumplessly. User-provided custom code/logic must
be included to enable the last good value of either the wild flow PV or SP (the last wild flow SP before
its PV became unavailable) to be used when FC330’s PV becomes unavailable, i.e., it is declared
“Bad.” If not, COT control, the more important feedback control loop, would be decommissioned by
a ratio controller’s wild flow problem. This logic should always be included in all control strategies
that contain a ratio controller. By using the wild flow’s last good PV or SP value, the feedback path
from TC323 to FC319 SP via RC319 remains in operation and hence COT control continues – the
adjustments to RC319 SP calculated by TC323 continue to change FC319 SP:
FC319 SP = RC319 SP ∗ [Last Good FC330 PV or SP]
but the ratio controller’s constant wild flow input (Last Good FC330 PV or SP) has no effect. The net
result is that only the ratio controller’s wild flow (feedforward) corrections stop; the more important
feedback control corrections, via TC323’s adjustments to RC319 SP, continue.
When FC330 PV becomes available, user-provided custom code/logic must initialize RC319.
This prevents a bump when the last “Good” wild flow PV’s value is different from the new
(returned), “Good” wild flow PV or SP value. The custom code must provide the following actions:
retrieve the current value of FC319 SP and the returned “Good” value of FC330 PV (or set point if
FC330 SP is the wild flow input), set RC319’s control initialization status to True (which triggers
an initialization request and an initialization value to be sent to TC323) and execute the set
point initialization calculation in Equation (2.32). After standard DCS functionality handles the
initialization of TC323, full COT control restarts with ratio control recommissioned bumplessly
with the recently returned good value of FC330 PV or SP.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License104 2 Feedback Control Essentials
2.7 Single Input–Single Output Model-Based Control (MBC)
In today’s process control world, there is a strong tendency to associate MBC with multivari￾able control and then with multivariable constraint control using DMC. And rightfully so,
since most of the MBC strategies implemented today are DMC controllers. Most DMC control
applications address, among other issues, the following: (i) CVs whose responses to one or
more independent variables (MVs and DVs) have long deadtimes, (ii) CVs that are affected
by multiple independent variables, and (iii) independent variables that affect multiple CVs.
Pre-DMC applications of MBC were for the most part implemented to overcome those same
issues – long deadtimes and management of dynamic interactions – but because of deficient DCS
computing capabilities and technology shortcomings, the scope of these control strategies was
limited.
In this section, the basic concepts of legacy non-DMC single input (the MV), single output (the
CV) MBC strategies are discussed. The discussion is limited to the basic structure of these control
strategies: the feedback control mechanism, the role of prediction error in model update, the role
of model error, how noise is managed, and why a model-based controller’s CV set point response
outperforms a PID controller’s CV set point response when there is considerable loop deadtime
(𝜃/𝜏 >2).
Important: Although these MBC basics are introduced and discussed within a non-DMC frame￾work, many of the basic concepts discussed are applicable to DMC control as well. A discussion of
DMC technology is beyond this book’s scope. However, where appropriate, some control strategies
discussed in subsequent chapters that use conventional control approaches but are better suited
for DMC are identified.
2.7.1 Structure of the Model-Based Control Strategy
The starting point for the discussion of single input–single output MBC is a block diagram that
presents an overview of a model-based controller’s feedback control loop. The block diagram
representation in Figure 2.38 is in generic format (CV PV, MV SP, etc.); an explanation of the
terms used, and each block’s function follows. After the discussion of Figure 2.38, model-based
controller tuning, filtering, closed-loop CV set point response, and closed-loop load response are
discussed.
Model-based
controller
Update model
bias
Measured
CV PV
Disturbance and
load variables
PID
controller
Process
MV
control
MV SP MV OP
– +
MV PV
CV SP
CV – MV
dynamic
model
CV PV
MV PV prediction
Bias
filter
Filtered
prediction error
“Raw” model
bias calculation
“Raw” bias,
i.e., prediction error
New model bias
Figure 2.38 Single Input – Single Output Model-Based Control Cascade Structure
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.7 Single Input–Single Output Model-Based Control (MBC) 105
The following comments help explain terms used and the function of each block in Figure 2.38:
● MV control is via a standard PID controller that responds to changes in its PV, either due to the
MV adjustments it calculates (MV OP) or due to a load disturbance.
● A CV PV prediction is calculated based on the current value of MV PV. The dynamic model in
block CV-MV Dynamic Model, developed using plant test data, predicts the dynamic effect of MV
PV on CV PV.
● For now, assume the generic single input (MV PV), single output (CV PV), and dynamic model
in Equation (2.37) is applicable. On each control pass, the Bias term is updated (a new value is
calculated) to align the model prediction with the actual plant measurement. This is commonly
called bias updating and will be explained further in the discussions that follow:
CV PV Predictionn = f(MV PVn) + Biasn (2.37)
● On pass n, the predicted value of CV PV, CV PV Predictionn, calculated in Equation (2.37), and
the latest (valid) measured value, Measured CV PVn, are differenced in the “Raw” Model Bias
Calculation block to calculate the prediction error:
Prediction Errorn = Measured CV PVn − CV PV Predictionn (2.38)
● The prediction errorn, or “raw” bias, represents the correction required on this execution pass
to bring the model’s prediction into agreement with the plant measurement. However, the
prediction error is first filtered using the linear exponential filter algorithm (in Equation (2.27a)).
This helps attenuate the effects of model error but limits the amount of model error cor￾rected on each pass. For example, referring to Equation (2.27a), with Xn the “raw” prediction
error in Equation (2.38), Yn−1 its last filtered value and Yn the current filtered value, if P =0.7,
only 30% of the current prediction error is used to correct the model error on each control
execution.
● The filtered prediction errorn is input to the Update Model Bias block, where the new model bias
is calculated:
New Model Bias ≡ Biasn = LastBias − Filtered Prediction Errorn (2.39)
LastBias is the Bias calculated on the last execution pass. Equation (2.39) is recursive, requiring
the storing of Biasn for use on the next control pass (to calculate Biasn+1): LastBias = Biasn.
● The new model bias, Biasn, is the input to the Model-Based Controller block, where the
control calculation, developed by inverting Equation (2.37) to solve for the MV, yields the new
MV SP.
As described above, the new (updated) model bias – the filtered prediction error, provides feed￾back to the model-based controller. Thus, filtering the prediction error also limits the control
action taken on each pass. In a standard PID control loop, the measured CV PV provides the
feedback for the PID’s control calculation. Like a PID controller, the measured PV is configured to
be the model-based controller’s PV, and its approach to set point is important to display. Unlike
the PV’s role in a PID controller, the model-based controller’s PV impacts the control calculation
indirectly through prediction error and bias. However, configuring the measured PV as the
model-based controller’s PV input is important because (i) it ensures control stops when the CV
PV becomes unavailable (“Bad”) and (ii) control initialization occurs when the CV PV becomes
available (“Good”) once again.
Note: Assuming there are no further changes to the MV and no load upsets, substituting the
current values of the MV PV and Bias into Equation (2.37) provides an estimate of the future
steady-state value of CV PV. This is often useful information for operators and is therefore usually
displayed at the console.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License106 2 Feedback Control Essentials
CV = KP * MV + Bias0
Slope = KP
∆CV
∆MV =
Model is
reasonable in
this region
MV
CV
Bias0 = CV@MV = 0
MV = 0 MVSS
CVSS
Plant data
Model
Figure 2.39 Linear CV – MV Steady State Model, Initial Bias Evaluation
To understand the significance of the updated bias in the MV’s set point calculation, instead of
the generic model in Equation (2.37), a specific (and simple) prediction model is introduced to
serve as the basis for the discussions that follow. This linear, steady-state relationship between the
CV and MV has been used successfully in some light-ends tower applications (Ref. [23]), and its
simplicity favors its use in the discussions that follow:
CV PV = KP ∗ MV PV + Bias0 (2.40)
In Equation (2.40), KP is the steady state gain, equal to ΔCV/ΔMV, determined from the same
plant test data set collected to develop the CV–MV dynamic model used in the CV–MV Dynamic
Model block. Bias0 is the initial value of the bias.
Figure 2.39 is a graphical illustration of the hypothetical relationship of the linear approximation
in Equation (2.40) to a set of typical plant data and how the initial value of the bias, Bias0, which can
be negative or positive but typically not zero, is represented. Note that in some cases, the initial value
of the bias is determined when historical steady-state plant data is used to statistically evaluate KP.
Figure 2.39 also indicates the region in which the model is a reasonable representation of the
plant’s operations. As plant operations move away from the specific steady-state values, CVSS and
MVSS, the model’s ability to predict the CV degrades. This underlines the importance of limiting
a model’s use to the operating region in which the model mirrors the actual plant behavior. In
Figure 2.39, at any value of MV, the vertical distance between the predicted PV (model) and the
measured PV (plant data) is the prediction error. Monitoring the magnitude and trend of prediction
error over time is a common method employed to assess MBC (including DMC) performance.
The calculation of the prediction error and how the model is shifted to bring the predicted value
and plant value into alignment is illustrated in Figure 2.40. For convenience and for ease in graph￾ically presenting the bias update concept, the prediction error, i.e., the raw updated bias, is used to
shift the model in Figure 2.40, not the filtered value, and thus the entire prediction error is corrected
each time the bias is updated. However, prediction error filtering does not change the model bias
update procedure being described – it just affects how much the model is shifted vertically, up,
or down.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.7 Single Input–Single Output Model-Based Control (MBC) 107
CVn = KP * MVn + Biasn–1
MV = 0
Plant data
Prediction error
Measured CV PV n
n
Predicted CV PVn
CVn+1 = KP * MVn+1 + Biasn
Biasn–1
Biasn
MV
CV
CVSS
MVSS MVn
Figure 2.40 Model Prediction, Plant Data, Prediction Error, and Model Bias Update
The fundamental relationships illustrated in Figure 2.40 among the measured CV PV, the CV PV
prediction, the prediction error, and the updated model bias are as follows:
Prediction Errorn = Measured CV PVn − Predicted CV PVn (2.41a)
Biasn = Biasn−1 + Prediction Errorn (2.41b)
As illustrated in Figure 2.40, the prediction error in Equation (2.41a) is negative, the updated
bias (Biasn) in Equation (2.41b) is less than the previous bias (Biasn−1), and the model is shifted
downward with constant model slope (KP) until CV PV predictionn equals measured CV PVn. If the
prediction error is filtered, the updated bias is less negative, the downward shift of the model is
smaller, and the CV PV prediction is still greater than the measured CV PV but less so.
Once the new (updated) model bias (Biasn) is determined, the MV set point is calculated. Replac￾ing MV PV with MV SP and CV PV with CV SP, Equation (2.40), in recursive form, is inverted to
solve for MV SPn+1:
MV SPn+1 = [CV SPn+1 − Biasn]∕KP (2.42)
To summarize, on every execution pass, n, through the MBC loop in Figure 2.38, the following tasks
are completed:
● CV PV predictionn is calculated in the CV–MV Dynamic Model block, using the CV–MV dynamic
model and the current value of MV PVn
● The current measured CV PVn is read
● Prediction errorn is calculated – the difference between the measured CV PVn and the CV PV
predictionn
● Prediction errorn is filtered – the filtered prediction error is used to calculate the new (updated)
model bias, Biasn
● The updated bias for this pass is stored (LastBias = Biasn) for use on the next control pass (to
calculate Biasn+1)
● Using the new (updated) model bias, Biasn, the new MV SP, MV SPn+1, is calculated using
Equation (2.42).
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License108 2 Feedback Control Essentials
2.7.2 Tuning the Model-Based Controller
Unlike the PID algorithm and DMC controllers, there are no specific tuning parameters asso￾ciated with this single input–single output model-based controller. For non-DMC model-based
controllers, model fidelity is the most important influence on control performance. This is true for
DMC controllers as well, but DMC’s tuning parameters (move suppression factors, equal concern
errors, etc.) help overcome model inaccuracies. For non-DMC MBC, problems arise when the
prediction model’s structure (e.g., first-order plus deadtime, second-order plus deadtime, etc.) is
not able to match the real-time nonlinear plant operations, or, due to changes in the operating
region, the model parameter values no longer accurately reflect the process response. Online,
trial-and-error tuning to find model parameter values that improve controller performance is
difficult and time-consuming (remember, most MBC must manage long response deadtimes) and
not likely to be successful. Effective model identification, e.g., carefully planned and executed
plant tests and the use of good model identification tools, is the best way to develop a robust
model-based controller.
“Raw” bias variability, i.e., the prediction error’s variability, is an indicator of model fidelity
because, by definition, it is a direct measure of how well the model is predicting plant operations.
However, any change in a measured or unmeasured DV that affects the CV and is not included
in the model will also affect the bias. So, in addition to model error, the effects of unmodelled DV
changes and other upsets impact the bias. Monitoring the “raw” bias over time can help identify
model error, but bias monitoring can also help reveal the impact of specific DVs on the bias.
In practice, monitoring and plotting the online calculated values of the bias versus key DVs can
help correlate a specific, significant bias change with a particular load upset, and if the root cause of
the upset is a measured DV, that DV becomes a candidate to be added to the model as an additional
input (independent) variable. This of course would enlarge the model-based controller’s scope and
require further plant testing and model identification. Bias variability that cannot be correlated
against changes in known disturbance variables, other measurements (other potential independent
variables), random process upsets, or noise are probably due to model error, and if so, resolution
will likely require further plant testing.
2.7.3 Filtering the “Raw” Bias
Filtering the “raw” bias places a user-specified limit on the amount of model error corrected on
each execution pass. Although filtering the prediction error also limits the control action taken
on each pass, it is an essential online tool to help attenuate the undesirable effects of model error.
Remember it is the filtered prediction error that is used in Equation (2.39) to calculate the new
(updated) model bias. Consequently, bias filtering not only attenuates the effects of model error
but also reduces the propagation of the measured CV’s noise to the bias and subsequently to the
MV’s set point via Equation (2.42).
Remember: Unlike CV PV filtering, bias filtering does not reduce the CV measurement’s noise
level – it does reduce the propagation of CV noise to the bias, and subsequently, to the MV’s set
point.
However, just like CV PV filtering, bias filtering introduces an additional lag in the control loop.
Whether to help manage model error or reduce CV noise propagation to the MV, it also distorts
(slows down) the CV response. Therefore, bias filtering, like CV PV filtering, is a trade-off – between
model error attenuation (bias filtering only), reduced noise propagation to the MV, and signal dis￾tortion. If the CV noise level is a concern, and the bias filter is tuned (by varying the P-parameter)
to minimize its effect on the MV, then look at the MV and/or the bias, not the CV, to assess noise
rejection, but look at the CV response to assess signal distortion.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.7 Single Input–Single Output Model-Based Control (MBC) 109
Bias updating always includes filtering the “raw” bias – filtering the prediction error – because it
is the most effective way to reduce the undesirable effects of model error. Because bias filtering also
reduces the propagation of CV noise to the MV, in MBC, the preferred way to reduce the propagation
of CV noise to the MV is via filtering the “raw” bias, not via CV PV filtering. However, if the noisy
CV PV is used by another control strategy, and its noise level is a problem for that strategy, a parallel,
second database tag can be built to filter that CV for the other strategy. Bias filtering for the MBC
loop proceeds using the still available “raw” (noisy) process signal as its measured CV input source.
If CV PV filtering is used to manage CV noise (not recommended), the filter must be added before
plant testing to identify the CV–MV dynamic model for the same reasons discussed previously for
pre-PID tuning plant tests – adding the filter after model identification will introduce a lag into
the control loop not considered in the model identification. For the model-based controller, this
creates additional model error. CV PV filtering reduces both the CV measurement noise, and via
Equation (2.42), the propagation of CV noise to the MV via the bias. But remember, (i) even with
CV PV filtering, bias filtering is still necessary to attenuate the undesirable impact of model error
and (ii) both bias filtering and CV PV filtering change the loop’s dynamics and thus distort the CV’s
closed-loop response.
2.7.4 CV Set Point Response
Historically, the most common applications of non-DMC MBC were fractionator and two-product
light-ends tower product quality controls. The fractionator applications were multivariable, inter￾active, and subject to many constraints that were not easily managed with conventional control
methods. Fractionator product quality controls are the subject of Chapter 13, where it is made
clear that their multivariable and interactive nature makes DMC the more suitable control tech￾nology for these applications. The light-ends tower applications were more manageable, especially
when only one product quality was controlled. Light-ends tower MBC applications were justified
by their ability to handle CV–MV response deadtimes. However, except for light-ends towers that
are not tightly integrated with other towers or major process units, light-ends tower non-DMC MBC
applications are uncommon today.
The AC95 → TC87 → FC86 cascade shown in Figure 2.3 maintains the naphtha splitter bottom’s
product (HVN) quality (5% distillation point) at an operator-entered set point (AC95 SP). Tower
upsets normally affect the tray temperature before bottoms quality. The temperature response
(adjustments to FC86 SP) is relatively fast compared to the quality’s (AC95 PV) response, and
thus helps reduce the upset’s effect on tower operations before significant quality deviations
occur. However, since the AC95–TC87 dynamic response likely includes considerable deadtime
(𝜃/𝜏 >2), PID control may need to be detuned, and adjustments made by AC95 to TC87 SP would
be slow to bring AC95 PV back to its set point. Therefore, for this cascade, implementing AC95 as a
model-based controller (Equation (2.40)) is a reasonable design basis. The model-based controller
in Equation (2.40) applied to the AC95 → TC87 segment of the HVN quality (5% distillation point)
cascade is:
AC95 PVn = KP ∗ TC87 PVn + Biasn (2.43)
The AC95 → TC87 → FC86 cascade, with AC95 as a model-based controller, is now used as an
example to explain how the model-based controller in Figure 2.38 responds to CV SP and load
changes.
Figure 2.41 shows the AC95 → TC87 → FC86 cascade in the model-based control framework of
Figure 2.38. The ultimate primary – the HVN 5% point controller AC95, is a model-based controller,
outputting a set point to tray temperature controller TC87, which resets the distillate rate (FC86 SP).
Figure 2.41 shows only the AC95 → TC87 segment of the strategy; the distillate flow controller
(FC86) is embedded in the Process block. FC86 is assumed to be in cascade mode, not wound-up, Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License110 2 Feedback Control Essentials
AC95
model-based
control
“Raw” model
bias calculation
Disturbance and
load variables
TC87 PID
Control Process TC87 SP TC87 OP
–
+
TC87 PV
AC95 SP
CV–MV
dynamic
model 
AC95 PV
prediction
“Raw” bias,
Bias i.e., prediction error
filter
Filtered
prediction error
Update model TC87 PV
bias
New model bias
Measured
AC95 PV Measurement
valid?
Do not
update bias
No
Yes
Figure 2.41 Model-Based Control Framework for AC95 → TC 87 → FC86 Cascade
and always able to meet the set point calculated by TC87. TC87’s PID PV input (TC87 PV) is sourced
in the Process block and is TC87’s feedback signal.
Important: Analyzer measurements such as AC95 PV are less reliable than a standard A/I signal,
and therefore the signal is validated before it is used in the control calculation. As indicated in
Figure 2.41, the model bias is updated only if AC95 PV is declared valid. When AC95 PV is declared
invalid, the bias is not updated and, as would be the case for a PID, feedback control is suspended.
Input signal validation, including actions to take when an invalid input measurement is detected,
and when it returns valid, are discussed in Section 8.8.
To illustrate the ideal response of the AC95 cascade and compare its response to a PID control
loop’s response, we assume the entire cascade is commissioned, there are no model errors, no load
changes, and no CV noise. Assume an operator changes the AC95 set point14 on the nth execution
pass, e.g., from AC95 SPn → AC95 SPn+1. The new TC87 SP, for the next (n+1) execution pass,
TC87 SPn+1, is calculated using Equation (2.42):
TC87 SPn+1 = [AC95 SPn+1 − Biasn]
KP
(2.44)
With no model error, no load changes, and no CV noise, the AC95 PV prediction, AC95 PV
Predictionn+1, is equal to the measured value of AC95 PV, Measured AC95 PVn+1, and thus from
Equation (2.41a), the prediction error is zero:
Prediction Errorn+1 = Measured CV PVn+1 − CV PV Predictionn+1 ≡ 0
With the prediction error = 0, from Equation (2.41b), the bias remains constant:
Biasn+1 = Biasn + Prediction Errorn+1 ≡ Biasn
Then, on the next execution pass – n+2, with the AC95 SP unchanged (AC95 SPn+2 ≡ AC95 SPn+1)
and the bias unchanged (Biasn+1 ≡ Biasn), the TC87 SP calculated on the n+2 execution pass, TC87
SPn+2, is also unchanged. From Equation (2.42):
TC87 SPn+2 = [AC95 SPn+2 − Biasn+1]
KP
= [AC95 SPn+1 − Biasn]
KP
≡ TC87 SPn+1
With no model errors, no load changes, no CV noise, and no further AC95 SP changes, TC87 SP will
remain constant, equal to TC87 SPn+1. Therefore, for these ideal conditions, the closed-loop response
to the AC95 SP change is identical to the open-loop response of AC95 PV to a step change in TC87 SP.
14 Like a PID controller, operators manually enter the model-based controller’s set point in auto mode.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.7 Single Input–Single Output Model-Based Control (MBC) 111
PID
Time →
Deadtime
expiration
TC87 SP
t = 0
MBC
PID
MBC AC95 PV
AC95 SP
Figure 2.42 Comparison of PID and MBC SP Responses
Figure 2.42 compares the MBC set point response described above to a typical PID controller’s
set point response when there is considerable deadtime (𝜃/𝜏 >2). Even with proportional action
on error, the PID response is slower than the model-based response because the PID’s control
actions must be detuned to avoid CV overshoot after the response deadtime expires. As shown in
Figure 2.42, with AC95 SP changed at t = 0, AC95 PV does not begin to change until the AC95–TC87
response deadtime expires. However, TC87 SP changes immediately (with characteristic propor￾tional kick), in response to the AC95 set point change. But until the response deadtime expires,
AC95’s error (AC95 SP–AC95 PV) remains constant. The TC87 SP ramp response, from its initial
change at t = 0 up to the deadtime expiration, is due only to the integral control action with constant
error, since proportional, and derivative control actions are both zero when error is constant.
Remember: The model-based controller’s set point response in Figure 2.42 is the ideal response –
there is no model error, no load upsets and/or no noise. In the real world, model error exists, load
changes occur, and/or noise is present. If so, any one of the three will impact the bias, and thus,
the control adjustments to TC87 SP are calculated by Equation (2.44). “Waves” of change, such
as those appearing in the PID’s TC87 PV response, will first appear in the bias, then the TC87
SP, the TC87 PV, and finally the AC95 response. However, despite this real-world expectation, a
well-designed and implemented model-based controller with a reasonable model and effective bias
filtering should, in principle, still be able to outperform an adequately tuned PID when there is
considerable deadtime (𝜃/𝜏 >2).
2.7.5 Load Variable Response
Feed rate is a common DV that can have an important impact on the performance of a light-ends
tower control strategy such as the AC95 → TC87 → FC86 cascade in Figure 2.3. Changes in feed
rate (FC87 in Figure 2.3) directly affect both the tray temperature, TC87 PV, and the HVN 5%
point quality, AC95 PV. Tray temperature TC87 PV is an inferential indicator of the HVN 5% point,
and at constant feed composition, maintaining AC95 PV at its set point after a feed rate change
does not require the tray temperature (TC87 SP) to change. However, if AC95 is a PID controller, Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License112 2 Feedback Control Essentials
AC95 begins to make TC87 SP adjustments as soon as the feed rate change affects AC95 PV, and
AC95 PV deviates from AC95 SP. These TC87 SP adjustments made by AC95 as a PID create fur￾ther control problems for AC95, even if the direct effects of the feed rate change on AC95 PV are
diminishing. Thus, AC95 as a PID controller makes additional, and for the most part, unnecessary
adjustments to TC87 SP. And because there is considerable deadtime in the AC95 – TC87 response,
the temperature and composition loops line out at their set point values rather slowly.
Note that implementing AC95 as the single input–single output model-based controller in
Equation (2.43), embedded in the control cascade in Figure 2.41, does not eliminate AC95’s
unnecessary TC87 SP adjustments. The AC95 model-based controller in Figure 2.41 begins to
make TC87 SP adjustments as soon as the feed rate set point change affects AC95 PV. Since
the effect of feed rate is not included in Figure 2.41’s CV–MV Dynamic Model block, the block’s
output, AC95 PV Prediction, continues to deviate from the Measured AC95 PV value because
AC95 measurements incorporate feed rate change effects. Prediction errors (Equation (2.41a))
are thus nonzero, and the updated (new) bias values (Equation (2.41b)) change. Since the bias
is the model-based controller’s feedback mechanism, the model-based controller output calcula￾tions change TC87 SP (in Equation (2.42)), which, like the PID controller’s adjustments, are all
unnecessary.
A model-based controller’s response to any measured or calculated DV upset can be improved
by including the DV at the upset’s root cause in the controller model. The single input–single
output model in Equation (2.43) must be expanded to include a second input, the DV. However,
conventional MBC capabilities are limited by dimensionality, and thus, increasing the number of
inputs in Equation (2.43) becomes impractical very quickly.
Closing Remarks: Single Input-Single Output Model-Based Control
The PID algorithm is a standard DCS component that includes supporting functionality to
manage initialization. If configured for set point initialization, a PID controller will initialize
properly and achieve bumpless transfer. In contrast, the MBC algorithm is not a standard control
algorithm; thus, building a model-based controller, and managing its initialization, requires
custom code/logic. Both tasks are nontrivial, and in a modern DCS, achievable via many different
design approaches. However, any site with several running non-DMC model-based controllers
would likely have a standard approach to implement and maintain all such controllers.
2.8 Cascade Wind-up
As described in Section 2.3.4, cascade wind-up plays an important role in output processing, one of
the important tasks the DCS routinely executes on a cyclic basis for all tags in its database. Wind-up
status is an essential attribute of the DCS “Cascade Rules” that, via standard DCS features, manage
commissioning/decommissioning, initialization, output clamping, and set point clamping for
simple cascades but not for complex cascades. Complex cascades require custom code/configuration
to manage these important and complicated control actions. As already emphasized, avoiding
custom code/configuration helps minimize application development, testing, commissioning, and
maintenance resources; thus, avoiding complex cascades is also advisable.
In this section, the basic concepts of wind-up presented in Section 2.3.4 are explained in more
detail with emphasis on the following major considerations: (i) how/why a controller sets its
own wind-up status, (ii) wind-up direction and wind-up protection, and (iii) how a secondary
controller’s wind-up status is propagated to its primary and up the cascade to the ultimate
primary.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.8 Cascade Wind-up 113
Fuel gas
upset occurs Time →
TC113 PV
FV119
FC119 PV
FC119 SP 
PI120 PV
100%
TC113 SP
Fuel gas
upset over
Fuel gas valve
full open
FC119 SP 
TC113 PV
FC119 PV
FC119 SP
wound-up
here
Figure 2.43 Effect of Constrained Ultimate Secondary Without Wind-up Protection
2.8.1 What Causes Cascade Wind-up
Cascade wind-up occurs when a secondary controller reaches an output limit, and the primary
controller does not know its secondary’s output is limited. Thus, changes in the primary’s output
may have no effect on its PV. Wind-up can be explained using the fired heater COT → fuel gas
control strategy discussed in Section 2.2 and presented in Figure 2.2. The control objective is to
maintain F-101’s COT, TC113 PV, at its set point by adjusting fuel gas flow set point, FC119 SP.
We assume no output clamps on either FC119 or FV113, and there is no DCS-provided wind-up
protection. With both TC113 PV and FC119 PV at set point, a disturbance in the fuel gas line causes
fuel gas availability to become limited as the fuel pressure PI120 PV suddenly drops. Figure 2.43
illustrates the control system’s closed-loop response.
In Figure 2.43, FC119 PV decreases rapidly as fuel gas pressure PI120 PV suddenly drops. In
response, FC119 opens FV119 to increase fuel flow. However, with insufficient fuel gas availability,
FC119 PV cannot recover and FC119 continues to open FV119 until it eventually goes full open.
With insufficient fuel gas (FC119 PV remaining below FC119 SP), TC113 PV decreases below TC113
SP, and in response, TC113 increases FC119 SP. With no output clamps and no wind-up protection,
TC113 does not know that FC113 cannot increase fuel gas flow, so TC113 continues to increase
FC119 SP while fuel gas availability is limited. From the time FV119 goes full open until fuel gas
becomes available once again, TC113 “winds-up” FC119 SP, i.e., with TC113 PV below TC113 SP,
TC113 continues to increase FC119 SP even though FC119 PV cannot increase.
The fuel gas supply then becomes normal once again as fuel gas pressure PI120 PV recovers.
With FV119 full open and FC119 SP wound-up by TC113 and much above FC119 PV, the fuel gas
flow FC119 PV suddenly increases. With fuel gas flow increasing rapidly, TC113 PV also starts to
rise rapidly; TC113 responds by reducing FC119 SP as TC113 PV continues to increase. However, Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License114 2 Feedback Control Essentials
TC113 must first “unwind” the increases in FC119 SP it asked for after FV113 became full open,
and before the fuel gas upset ended and fuel gas availability returned to normal. The wind-up of
FC119 SP by TC113 causes a major disturbance to the temperature loop because it takes additional
time for TC113 to “unwind” the fuel gas set point and for FC119 PV to start to decrease.
As shown in Figure 2.43, and referring to FC119 PV, FC119 SP, and TC113 PV responses in blue
font, preventing TC113 from increasing FC119 SP when FV113 becomes full open, reduces the
temperature upset. This is the functionality provided by standard DCS wind-up protection.
The root cause of TC113’s wind-up of FC119 SP in Figure 2.43 is that TC113 does not know that
FC119 cannot increase fuel gas flow FC119 PV, and TC113 continues to increase FC119 SP even
though fuel gas availability remains limited. Whether provided by standard DCS features or custom
code/configuration, wind-up protection broadcasts these limitations upwards to all controllers in
the cascade.
2.8.2 Output and Set Point Clamps
Output clamps restrict a controller’s output to an allowable range, i.e., less than or equal to a max￾imum value, greater than or equal to a minimum value. The most common use of an output clamp
is to constrain the valve position of an ultimate secondary, i.e., to define when the valve is full
open and/or full closed. In the example above, if FC119 (or the analog output block FV119) had an
output high clamp of 90%, the valve position would have been equal to 90%, not 100%, during the
time interval that TC113 was winding up FC119 SP. However, whether the fuel gas valve is full open
or clamped at 90% open, unless TC113 knows the fuel gas valve is limited, it will continue to wind
up FC119 SP. Therefore, output clamps do not have impact on cascade wind-up without standard
DCS (or custom coded) wind-up protection that “announces” to TC113 that FC119 cannot increase
its output.
Output clamps usually relate to a physical constraint, e.g., a valve position, damper position,
air-fin louver position, etc. They are most often operator chosen and operator entered, although,
for more complex control strategies, output clamps may be engineer specified. Since controller
outputs are in percent of range of the secondary, for cascaded controllers other than the ultimate
secondary, it is easier and much more common to use clamps on the secondary’s set point, which
are in EUs, instead of its own output clamps.
Set point clamps restrict a controller’s set point to an allowable range, i.e., less than or equal to
a maximum value, greater than or equal to a minimum value. Set point clamps usually relate to a
process constraint. Some common examples are a maximum pressure clamp to protect against a
safety valve rupture, a minimum flow clamp to prevent coking in a fired heater’s tubes, and a max￾imum outlet temperature clamp to prevent fired heater tube coking or prevent undesired catalyst
deactivation in a fixed bed reactor.
When output and/or set point clamps are used in simple cascades, the following conditions cause
wind-up:
– A valve goes full open or full-closed at an output high or output low clamp value
– Any controller below the ultimate primary reaches a set point high or set point low limit
– Any controller’s output reaches an output high or output low limit
Whether constrained by a secondary’s SP clamp or the controller’s own OP clamps, the controller’s
output is clamped at the violating high or low limit, and the controller’s wind-up status is set
to either High or Low depending upon whether its own output and/or set point can increase or
decrease.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.8 Cascade Wind-up 115
Remember: Remember: Wind-up protection for complex cascades must be provided by custom
code/logic.
2.8.3 Wind-up Directions
Controller wind-up has a direction – it can be wound-up High, or it can be wound-up Low. When
a controller is wound-up high, its set point and/or output cannot be increased. When a controller
is wound-up low, its output or set point cannot be decreased. A third wind-up status – HighLow,
indicates the controller’s set point and/or output cannot be changed in either direction, indicating
the controller is output indisposable. And finally, when a controller’s set point and output can both
be changed in either direction, its wind-up status is Normal.
In simple cascades, standard DCS features determine the wind-up status of every controller, and
as will be explained, a controller’s wind-up status depends upon its control direction. Remember
that control direction specifies whether a controller’s output should increase (Direct) or decrease
(Reverse) when its PV is increasing.
To review control direction, consider the two tray temperature control cascades in Figures 2.44
and 2.45. In Figure 2.44, temperature controller TC87 manipulates reboiler steam flow (FC78 SP)
to maintain its desired target, TC87 SP. It is configured with control direction = Reverse because
it must decrease steam flow when TC87 PV is increasing and approaching or exceeding TC87
SP; TC87 control output (TC87 OP) decreases to decrease FC78 SP. In Figure 2.45, temperature
controller TC47 manipulates reflux flow, FC43 SP, to maintain its desired target, TC47 SP. It is
configured with control direction = Direct because it must increase reflux flow when TC47 PV is
increasing and approaching or exceeding TC47 SP; TC47 control output (TC47 OP) increases to
increase FC43 SP.
For a PID controller configured for control direction = Reverse, its set point and output move in
the same direction – when the set point is increased (decreased), its output increases (decreases). In
Figure 2.44, to increase tray temperature TC87 PV, steam flow FC78 PV must increase. Therefore,
after TC87 SP is increased and TC87 PV must increase, TC87 OP increases, and its output to FC78
SP increases steam flow. To decrease TC87 PV, steam flow must decrease and therefore, after TC87
SP is decreased, TC87 OP decreases and its output to FC78 SP decreases steam flow. Thus, with
Figure 2.44 Tray Temperature Controller,
Control Direction = Reverse
Steam
T
9
5
E-97
LC
80
TC
87
C3/C4
splitter
FC
82
AI
93 C3
C4
product
FC
78
FI
87
FV78
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License116 2 Feedback Control Essentials
T
4
4 FI
47
C3/C4
splitter
CW
TC
47
FC
43
AI
44 C4
FC
46
E-48
C3
product
PC
47
FV43
Figure 2.45 Tray Temperature Controller, Control Direction = Direct
TC87 as an example, for a PID controller configured for control direction = Reverse, its set point
and output move in the same direction.
For a PID controller configured for control direction = Direct, its set point and output move in the
opposite direction – when the set point is increased (decreased), its output decreases (increases).
In Figure 2.45, to increase tray temperature TC47 PV, reflux flow FC43 PV must decrease. Therefore,
after TC47 SP is increased and TC47 PV must increase, TC47 OP decreases, and its output to FC43
SP decreases reflux flow. To decrease TC47 PV, reflux flow must increase and therefore, after TC47
SP is decreased, TC47 OP increases and its output to FC43 SP increases reflux flow. Thus, with
TC47 as an example, for a PID controller configured for control direction = Direct, its set point and
output move in opposite directions.
Why this is all relevant to resolving a controller’s wind-up status is now explored. First, consider
both ultimate secondaries in Figures 2.44 and 2.45, steam flow FC78 and reflux flow FC43. As
conventional flow controllers, both are configured with control direction = Reverse. For either FC78
or FC43, assume FC78 OP or FC43 OP is constrained high and valves FV78 or FV43 cannot open
any further. As established above, if control direction = Reverse, set point and output move in the
same direction. Thus, if FC78 OP or FC43 OP is constrained high and cannot increase, then both
FC78 SP and FC43 SP cannot be increased, but both can be decreased. Thus, the wind-up status
of FC78 and FC43 are both High. Likewise, if either FC78 OP or FC43 OP is constrained low, and
valves FV78 and FV43 cannot close any further, neither FC78 SP nor FC43 SP can be decreased,
although both can be increased. Thus, the wind-up status of FC78 and FC43 are both Low.
Now consider how the wind-up status of TC87 (control direction = Reverse) is resolved when
FC78 is either wound-up high or wound-up low and repeat the explanation for TC47 (control direc￾tion = Direct) when FC43 is either wound-up high or wound-up low.
With FC78 wound-up high, FC78 SP cannot be increased, and consequently, TC87 OP cannot
increase. If TC87 SP is increased to increase TC87 PV, TC87 OP must increase FC78 SP to increase
steam flow, but this is not permitted when FC78 is wound-up high. If TC87 SP is decreased to
decrease TC87 PV, TC87 OP must decrease FC78 SP to decrease steam flow, which is permit￾ted when FC78 is wound-up high. Thus, with TC78 configured for control direction = Reverse, it
is wound-up high when FC78 is wound-up high.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License2.8 Cascade Wind-up 117
Now assume FC78 is wound-up low, FC78 SP cannot be decreased, and consequently, TC87 OP
cannot decrease. If TC87 SP is decreased to decrease TC87 PV, TC87 OP must decrease FC78 SP to
decrease steam flow, but this is not permitted when FC78 is wound-up low. If TC87 SP is increased
to increase TC87 PV, TC87 OP must increase FC78 SP to increase steam flow, which is permit￾ted when FC78 is wound-up low. Thus, with TC78 configured for control direction = Reverse, it is
wound-up low when FC78 is wound-up low.
Now, look at how the wind-up status of TC47 is resolved when FC43 is either wound-up high
or wound-up low. With FC43 wound-up high, FC43 SP cannot be increased, and consequently,
TC47 OP cannot increase. If TC47 SP is increased to increase TC47 PV, TC47 OP must decrease
FC43 SP to decrease reflux flow, which is permitted when FC43 is wound-up high. However, If
TC47 SP is decreased to decrease TC47 PV, TC47 OP must increase FC43 SP to increase reflux
flow, which is not permitted when FC43 is wound-up high. Thus, with TC47 configured for control
direction = Direct, it is wound-up low when FC78 is wound-up high.
With FC43 wound-up low, FC43 SP cannot be decreased, and consequently, TC47 OP cannot
decrease. If TC47 SP is decreased to decrease TC47 PV, TC47 OP must increase FC43 SP to increase
reflux flow, which is permitted when FC43 is wound-up low. However, if TC47 SP is increased
to increase TC47 PV, TC47 OP must decrease FC43 SP to decrease reflux flow, which is not per￾mitted when FC43 is wound-up low. Thus, with TC47 configured for control direction = Direct, it is
wound-up high when FC78 is wound-up low.
The table below summarizes the relationship between each primary’s control direction, its sec￾ondary’s wind-up status, and the resolution of its own wind-up status.
TC87 FC78 TC47 FC43
TC87 FC78 TC47 FC43
Cascade position Primary Secondary Primary Secondary
Control direction Reverse Reverse Direct Reverse
Wind-up status High High Low High
Low Low High Low
These results are applicable to other primary and secondary cascade controllers. The wind-up status
of any primary controller configured for control direction = Direct will be:
1) Wound-up low when its secondary is wound-up high
2) Wound-up high when its secondary is wound-up low
and the wind-up status of any primary controller configured for control direction = Reverse will be:
3) Wound-up high when its secondary is wound-up high
4) Wound-up low when its secondary is wound-up low
As an example, assume the C3 in C4 online analyzer measurement in Figure 2.44, AI93 PV, is
the CV, and a C3 in C4 controller, AC93, manipulates the tray temperature controller’s set point
(TC87 SP). AC93 is configured with control direction = Direct because it must increase tray tem￾perature when AC93 PV is increasing and approaching or exceeding AC93 SP (bottoms product
getting too light – less pure). Using relationships #1 and #2 above (AC93 is configured with control Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License118 2 Feedback Control Essentials
direction = Direct), AC93’s wind-up direction is resolved below when (i) FC78 is wound-up high
and (ii) FC78 is wound-up low.
AC93 TC87 FC78
AC93 TC87 FC78
Cascade position Primary Secondary Secondary
Control direction Direct Reverse Reverse
Wind-up status Low High High
High Low Low
FC78 is wound-up high. If AC93 SP is increased to increase AC93 PV (more C3 in C4 product),
AC87 OP decreases TC87 SP and TC87 would decrease steam flow, which is permitted when FC78
is wound-up high. If AC93 SP is decreased to decrease AC93 PV, AC87 OP increases TC87 SP
and TC87 would want to increase steam flow, but this is not permitted when FC78 is wound-up
high. Thus, with AC93 configured for control direction = Direct, it is wound-up low when FC78 is
wound-up high.
FC78 is wound-up low. If AC93 SP is increased to increase AC93 PV (more C3 in C4 product)
AC83 OP would decrease TC87 SP, and TC87 would then want to decrease steam flow, but this is
not permitted when FC78 is wound-up low. If AC93 SP is decreased to decrease AC93 PV, AC83
OP increases TC87 SP and TC87 would then increase steam flow, which is permitted when FC78
is wound-up low. Thus, with AC93 configured for control direction = Direct, it is wound-up high
when FC78 is wound-up low.
2.8.4 Wind-up Protection
Referring once again to Figure 2.43, FC119 SP is wound-up by TC113 from the time FV119 goes
full open until fuel gas becomes available again. During this time interval, the difference between
TC113 SP and TC113 PV, the controller’s error, is nonzero and essentially constant. For nonzero
but constant controller error, proportional and derivative actions are zero, but the integral action
ramps the controller’s output. This is similar to the CV’s closed-loop response when a CV–MV
open-loop response has a long deadtime. After the CV’s set point is changed, the MV’s set point
changes immediately, and from the initial MV set point change until the deadtime expires, the
MV set point is ramped by the CV controller’s integral control action (see Figures 2.21 and 2.42).
For these cases, to avoid excessive overshoot, the CV’s PID controller must be detuned, slowing the
closed-loop response; this response characteristic can often justify MBC.
Detuning to attenuate the effects of an unpredictable disturbance is unreasonable. Instead, the
essential feature of standard DCS wind-up protection is remarkably simple: to stop the primary’s
PID integral action whenever its secondary’s output or set point is limited. The primary knows
its secondary is limited by the secondary’s wind-up status, High or Low, which is broadcast to
it on every execution pass. Proportional and derivative control continue, but with the controller
error constant, they make an insignificant contribution to the controller’s calculated output.
Stopping integral action to prevent wind-up has historically been called “anti-reset wind-up.”
DCSs that allow set point and output clamps universally provide anti-reset wind-up protection for
primaries whose secondary reach a set point or output limit.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons LicenseReferences 119
References
1 Smith, C.L. (1972). Digital Computer Process Control, 169–181. Intext Educational Publishers.
2 Astrom, K.J. and Hagglund, T. (1984). Automatic tuning of simple regulators with specifica￾tions on the gain and phase margins. Automatica 20: 645–651.
3 Friedman, Y.Z. (1994). Tuning averaging level controllers. Hydrocarbon Processing 73 (12):
101–104.
4 King, M. (2010). Process Control: A Practical Approach, 97–105. Chichester: John Wiley &
Sons, Ltd.
5 Smith, C.A. and Corripio, A.B. (2006), Averaging Level Control). Principles and Practices of
Automatic Process Control, 256. John Wiley & Sons Inc.
6 McMillan, G.K. (2015). Tuning and Control Loop Performance, 4e, 24. New York: Momentum
Press.
7 King, M. (2010). Process Control: A Practical Approach, 65–76. Chichester: John Wiley &
Sons, Ltd.
8 Ziegler, J.G. and Nichols, N.B. (1942). Optimum settings for automatic controllers. Transactions
of the ASME 64 (11): 759–768.
9 Cohen, G.H. and Coon, G.A. (1953). Theoretical considerations of retarded control. Transactions
of the American Society of Mechanical Engineers 75 (5): 827–834. Taylor Instrument Company’s
Bulletin. TDS-10A102.
10 O’Dwyer, A. (2009). Handbook of PI and PID Controller Tuning Rules. London: Imperial Col￾lege Press.
11 King, M. (2010). Process Control: A Practical Approach, 52–65. Chichester: John Wiley &
Sons, Ltd.
12 McMillan, G.K. (2015). Tuning and Control Loop Performance, 4e, 27–40. New York: Momentum
Press.
13 Seborg, D.E., Edgar, T.F., Mellichamp, D.A., and Doyle, F.J. Process Dynamics and Control, 4e,
201–212. Hobokan, NJ: John Wiley & Sons, Inc.
14 Smith, C.L. (1972). Digital Computer Process Control, 172–179. Intext Educational Publishers.
15 Chien, I.L. and Fruehauf, P.S. (1990). Consider IMC tuning to improve controller performance.
CEP 86: 33–41.
16 King, M. (2010). Process Control: A Practical Approach, 85–89. Chichester: John Wiley &
Sons, Ltd.
17 Garcia, C.E. and Morari, M. (1982). Internal model control: a unifying review and some new
results. Industrial & Engineering Chemistry Process Design and Development 21: 308.
18 Dahlin, E.B. Designing and tuning digital controllers. Instruments and Control Systems 2 (6):
77–83.
19 Olsen, T. and Ito, N. (2013). Implement an effective loop tuning strategy. CEP 109: 42–48.
20 Ang, K.H., Chong, G.C.Y., and Li, Y. (2005). PID control system analysis, design and technology.
IEEE Transactions on Control Systems Technology 13 (4): 559–576.
21 PITOPS (2023). System ID and Primary/Advanced Process Control Tuning, Optimiza￾tion and Design Software. PiControl Solutions LLC www.picontrolsolutions.com,
info@picontrolsolutions.com.
22 OPC Foundation. (2002). The OPC Foundation—Dedicated to Interoperability in Automation.
[Online] http://www.opcfoundation.org.
23 Bartman, R.V. (1981). Dual composition control in a C3/C4 splitter. CEP 77: 58–62.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License120
3
Feedforward Control Essentials
CHAPTER CONTENTS
3.1 The Role of Feedforward Control
3.2 Ratio Control and Steady-State Feedforward Control
3.3 Dynamic Compensation via the Lead-Lag Algorithm
3.4 Ratio Control and Dynamic Feedforward Control
3.5 Incremental Steady-State Feedforward Control
3.6 Incremental Dynamic Feedforward Control
3.7 Engineering Relationships That Provide Feedforward Corrections
3.7.1 Tower Reboiler Duty Control
3.7.2 Tower Internal Reflux Control
3.7.3 Pressure Compensation of Tower Temperature
References
We have already presented and discussed the reasons why feedforward control improves the per￾formance of a feedback control strategy. Without presenting too many details, we established that
feedforward corrections are model-based and frequently include dynamic compensation. In the
discussion of ratio control in Section 2.6, we established that feedforward corrections are frequently
combined with ratio control to implement feed rate feedforward control, which helps attenuate
the effects of unit feed rate changes. Its specific role in a typical light-ends tower product quality
control strategy and a fired heater coil outlet temperature (COT) control strategy was explained.
This chapter begins with a discussion of the role and scope of a feedforward controller. We revisit
ratio control and take a detailed look at important applications of ratio feedforward control. Then,
various aspects of feedforward control implementation are explained – steady-state versus dynamic
feedforward control, dynamic compensation via the lead/lag algorithm, and full valued versus
incremental feedforward control. There are important calculated process variables that by their
very nature provide feedforward corrections when included in a feedback control strategy – tower
reboiler heat duty, tower internal reflux flow, and pressure-compensated tower temperature.
These calculations are explained, and a typical control application is presented for each.
3.1 The Role of Feedforward Control
When an upset occurs, a feedback controller’s corrective actions begin after the upset causes the
CV’s process variable (PV) value to deviate from its set points (SP); the nonzero error is the driving
force for the feedback controller’s control adjustments. Feedforward control provides corrective
Practical Process Control Design with Industrial Applications, First Edition. Alan M. Kugelman.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License3.1 The Role of Feedforward Control 121
actions – new manipulated variable (MV) values, as soon as a disturbance variable (DV) change is
detected and before the CV begins to deviate from its SP. When combined with a feedback controller,
it almost always improves a control strategy’s performance. Because the DV’s PV is the feedforward
controller’s input, feedforward control is possible only for DVs that are measured or DVs that can
be calculated or inferred from measured PVs.
To make control corrections based only on the DV’s PV values, the feedforward controller must
be able to “anticipate” the DV’s effect on the CV and then “know” how MV changes affect the
CV. Because the DV–CV and MV–CV relationships can (and often do) have different dynamics
and steady-state gains, the feedforward controller’s MV adjustments must be time synchronized
to the DV’s effect on the CV; in feedforward control terminology, this is called dynamic compensa￾tion. Consequently, the feedforward controller corrections are model-based, using (linear) dynamic
models of the CV’s response to DV and MV changes, with models developed using plant-test data.
If the feedforward corrections are “perfect,” i.e., there are no model errors, and no other load upsets
and no noise, the CV does not change, i.e., it remains at its set point after the DV upset. However,
as we have stressed throughout Chapter 2, in any model-based approach, there will always be some
model error. Thus, feedforward control is always combined with feedback control to compensate
for the inevitable presence of model error. The many examples to follow will demonstrate that both
the feedback and feedforward corrections contribute to the MV changes that bring the CV back
to SP.
To illustrate the CV–DV and CV–MV dynamic response roles in the feedforward control correc￾tions, we will use a typical fired heater, F-300, shown in Figure 3.1 as an example. A fired heater
was also used in Section 2.6.1 to illustrate the role played by ratio control in feed rate feedforward
control. The ratio controller’s PV calculation, control calculation, susceptibility to noise, and its
initialization were explained there. Assuming no heat losses, vaporization, or reaction, a steady
state process side heat balance established that holding the fuel gas/feed ratio constant when
the feed rate changes maintained the fired heater’s COT constant. This fundamental finding, i.e.,
holding the ratio constant when the feed rate changes, is validation for the feed rate feedforward
strategy. The concepts of time synchronization and dynamic compensation, as well as the typical
feed rate feedforward cascade structure (in Figure 2.37), were also introduced. The discussion that
follows focuses on the CV–DV and CV–MV dynamic response issues that arise when a feedforward
controller is designed. It explains the important contrast between steady-state and dynamic feedfor￾ward control and sets the stage for the discussion in Section 3.3 of the role of the model parameters
in the lead-lag control algorithm that is at the core of the dynamic feedforward controller’s
design.
In Figure 3.1, F-300 COT (CV) is controlled by manipulating the fuel gas flow (MV), while the
feed rate is F-300’s most important DV. A feed rate feedforward controller will supplement the COT
feedback controller by minimizing the effects of feed rate changes on the COT. The COT – fuel gas
and COT – feed rate response dynamics play a central role in the feedforward controller’s design and
hence the first step and most important design task is to plant test and do the model identifications
necessary to determine these parameter values. The significant roles these CV–DV and CV–MV
response dynamics play in the implementation of feedforward control, specifically in dynamic com￾pensation and the lead-lag algorithm, are covered in Section 3.3.
For now, we temporarily ignore specific knowledge of the process dynamics but consider typ￾ical open-loop COT – feed rate and COT – fuel gas dynamic responses and ask what happens if
we increase the feed rate set point, which will decrease COT and simultaneously increase the fuel
gas set point, which will increase COT, and examine the COT response to these two, simultane￾ous changes. Assuming the Principle of Superposition for linear systems applies, the COT response
(in blue) to the two simultaneous set point changes is the sum of the two individual responses Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License122 3 Feedforward Control Essentials
(in black). The combined open-loop COT response (in blue) to the two simultaneous set point
changes shown in Figure 3.2 hint at the roles the two sets of dynamic model parameter values
will ultimately play in the feedforward controller’s design:
● The COT’s initial increase indicates the fuel gas increase was made too early, i.e., before the feed
rate change first affects the COT, and thus, the fuel gas set point increase must be delayed.
FC TI
FC
Fuel gas header
F-300
SP
COT
control
Fuel gas
flow control
Feed rate
flow control
TC
SP
DV → Feed rate (FD)
MV → Fuel gas (FG)
CV → COT
Figure 3.1 Fired Heater F-300 CV (COT), MV (Fuel Gas) and DV (Feed Rate)
COT 
COT - FG open-loop response
COT - FD open-loop response
FG SP
FD SP
Combined FG, FD open-loop response
t = 0
Time →
FG
FD
[KDV, τDV, θDV]
[KMV, τMV, θMV]
Figure 3.2 Fired Heater F-300 Combined FG, FD Open-Loop COT Responses
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License3.1 The Role of Feedforward Control 123
● The COT response lines out at a steady-state value above its initial steady-state value, and thus,
the fuel gas set point change was too large.
● Feed rate and fuel gas changes in the same direction (both up in Figure 3.2) drive the two COT
responses in the opposite direction, but in Figure 3.2, these simultaneous set point changes are
not able to maintain the COT at its initial steady-state value. To do so, the fuel gas adjustments
must be time synchronized to the feed rate’s effect on the COT. Here is the control requirement:
Make fuel gas flow adjustments up to the reestablishment of steady state such that the effect of
the fuel gas flow changes on the COT cancels the effect of the feed flow changes on the COT.
As will be discussed in Section 3.3, the CV–DV and CV–MV response dynamics are essential to
the dynamic compensation calculations that time synchronize the MV adjustments.
If the fuel gas set point is changed at the “correct” time relative to the feed rate set point change,
and the magnitude of the fuel gas change is “correct,” would the two open-loop COT responses
exactly cancel at all values of time after the set point changes? The answer is no unlessthe COT – fuel
gas and COT – feed rate response dynamics are about the same. If the response dynamics are
about the same, time synchronization, i.e., dynamic compensation, is not needed and steady-state
feedforward control is suitable. However, if the fuel gas and feed flow COT responses have different
dynamics, dynamic compensation is needed, and only dynamic feedforward control is suitable.
Figure 3.3 shows a comparison between COT responses to a feed rate change with steady-state
and dynamic feed rate feedforward control only – there is no COT feedback control. In Figure 3.3,
the final steady-state fuel gas set point value for both steady-state and dynamic feedforward con￾trol are the same, and with no model error, they both return the COT to its original steady-state
value. However, the steady-state feedforward fuel gas set point correction begins too early, and
the COT initially increases, but then it turns and starts to decrease and eventually returns asymp￾totically to the initial steady-state COT value. As shown, the dynamic feedforward fuel gas cor￾rections include a deadtime that delays and time-dependent changes that shape the fuel gas flow
increases that essentially cancel the predicted effects of the feed rate change on COT. The dynamic
Steady state
feedforward
Steady state
feedforward
COT
COT - FG open-loop response
COT - FD open-loop response
FG SP
FD SP
t = 0 Dynamic
feedforward
Dynamic
feedforward
Figure 3.3 Fired Heater F-300 Steady-state and Dynamic Feed Rate Feedforward Control Responses
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License124 3 Feedforward Control Essentials
feedforward control corrections are almost perfect, and the COT hardly deviates from its initial
steady-state value.
Both steady-state and dynamic feed rate feedforward controls are implemented using ratio con￾trol. Ratio control’s role in the implementation of each is discussed in detail in Section 3.2 (steady
state) and Section 3.4 (dynamic). The only difference in design between the two is a dynamic
compensation tag in the dynamic feedforward control cascade, placed between the feed flow
controller and the ratio controller’s wild flow input. This typical dynamic feed rate feedforward
cascade structure was introduced in Section 2.6.1 and presented in Figure 2.37. The dynamic
compensation tag contains the lead-lag control algorithm, which dynamically shapes the ratio
controller’s wild flow input as the precursor to the calculation of the feedforward controller’s MV
adjustments.
The structure of the lead-lag control algorithm and the important role played by the model
dynamic parameter values in the algorithm’s control calculations are explained in Section 3.3.
Excluding model error and process nonlinearities, the reliability of the dynamic parameter values
is solely responsible for the dynamic feedforward controller’s control performance.
3.2 Ratio Control and Steady-State Feedforward Control
Section 2.6 considered two broad uses of ratio control in plant operations, i.e., (i) to capture energy
conservation (ENCON) credits by minimizing steam, fuel, and reactor treat gas and reactor recycle
gas utilization, and (ii) to support feedforward control loops in multilevel cascades. Note that in
many cases (the three examples below), a ratio control strategy can accomplish both – capture
ENCON credits and support feedforward control. In Figure 3.4, three ratio control applications are
presented in the cascade format characteristic of a ratio control strategy:
Notice the familiar ratio controller nomenclature – the ratio controller’s MV is the controlled
flow, and the ratio controller’s wild flow input (used in its control calculation) is either the wild
flow’s PV (noise not a problem) or SP (noise is a problem), and the controlled flow and wild flow
PVs are inputs and used to calculate the ratio controller’s PV (controlled flow PV/wild flow PV
LE tower tray temp.
Reactor partial pressure
Kero initial boiling point
Primary controller’s CV
Stripping steam/Btms
(Kero)
Reboiler steam/tower
feed
Treat gas/reactor
feed
Ratio controller CV
Reactor feed flow
LE tower feed flow
SS stripper Btms
(Kero) flow
Wild flow (DV)
SS stripper stripping
steam flow
Reboiler steam
flow
Treat gas flow
Controlled flow (MV)
Ratio
controller
Primary
controller
Controlled
flow
SP SP SP
PV
PV
SP
Wild flow
(DV)
Wild flow
input PV or SP
logic
Figure 3.4 Steady-state Ratio Feedforward Control
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License3.2 Ratio Control and Steady-State Feedforward Control 125
ratio) – see Figure 2.35 in Section 2.6. The ratio controller’s control calculation and its management
of noise and initialization are described in Section 2.6 (control calculation), Section 2.6.2 (Noise),
and Section 2.6.3 (Initialization). All three control strategies provide feedforward corrections in
response to a wild flow (disturbance variable) change before the primary’s CV is affected. In each
case, the feedforward action is to change the controlled flow’s set point immediately as the wild
flow change (the disturbance) is detected – there is no dynamic compensation. Thus, ratio control,
as depicted in Figure 3.4, is an example of steady-state feedforward control. And note that the
ratio controller’s set point, calculated by the ratio controller’s primary, or if the ratio controller is
a primary, operator entered, is, in effect, the feedforward gain since it determines the magnitude
of the feedforward correction – see Equation (2.29), the ratio controller’s control calculation,
in Section 2.6.
When steady-state ratio feedforward control is implemented, and the ratio controller is the cas￾cade primary, the feedback and feedforward control adjustments are seamlessly combined, and
ensuring the feedback control stays operational when there is a feedforward loop problem is not
an issue. However, this issue is considerably more important when the ratio controller, as shown
in Figure 3.4, is a secondary controller. We now discuss this issue for steady-state ratio feedforward
control when the ratio controller is a secondary, and the feedback control must remain operational
when there is a feedforward loop problem. This issue will also be examined in Section 3.4, where
dynamic ratio feedforward control is discussed. In these cases, the ratio controller almost always
has a primary whose control objective is important and must be achieved despite a feedforward
loop problem.
For steady-state ratio feedforward control, if the wild flow measurement, the ratio controller’s
wild flow input, becomes unavailable (declared “Bad”), the ratio controller will become output
indisposable – it cannot perform its control calculation and thus cannot output a set point to its sec￾ondary. If so, the feedforward input problem will also disable the feedback control loop, violating
a required feedforward control standard. Therefore, user-provided custom code/configuration is
required to keep the feedback loop operational when the feedforward input becomes unavailable.
This is best achieved by making a stored, “last good wild flow value” the feedforward input source.
The ratio controller’s control calculation, Equation (2.29), on every control execution pass, uses
the stored “last good wild flow value,” and the current wild flow input (when it is “Good”) is
stored to the “last good wild flow value” location for use on the next pass. If/when the feedforward
input is declared “Bad,” Equation (2.29) continues to use the stored “last good wild flow value,”
but it cannot and does not store a fresh value to the “last good wild flow value” location. Thus, for
as long as the feedforward input remains “Bad,” the “last good wild flow value” remains constant,
and the ratio controller’s control calculation executes normally using a constant “last good wild
flow value.” The ratio controller continues to respond to set point changes calculated by its
primary, using the constant wild flow input in its control calculation (Equation 2.29), e.g., without
feedforward corrections. Thus, feedback control continues even when the feedforward input is
not available.
Custom code/configuration is also needed to initialize the ratio controller when the feedforward
input returns “Good” after being unavailable (declared “Bad”). Since this first “good wild flow
value” may be very different from the current stored “last good wild flow value,” initializing the
ratio controller – which also forces the ratio controller’s primary to initialize (via standard DCS
functionality), will allow the feedforward control corrections to resume bumplessly.
Finally, if the wild flow is controlled, and the SP (not the PV) is the feedforward input chosen,
the wild flow controller must either be configured for SP Init = Yes, or custom logic/configuration
must be added to enable the use of the wild flow PV as the feedforward input when the wild flow
controller is in manual mode or is wound-up.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License126 3 Feedforward Control Essentials
FC
174
AI
197
Kero IBP
control
RC174
AC197 AIV197
Stm/Btms
ratio
Steam
Desired kero IBP
SP
SP
SP
Validation
Kero
IBP
FI
175
T-306
Btms rate
R
3
0
1
FC
173
TC
184
AI
197
FC
174
FI
175
LC
190
TI
183
Stripping Kerosene IBP
steam
Kerosene
to tankage
APS
Side stream 1
drawoff
Kerosene
H/F
Kerosene
steam stripper
Vapor return
to APS
LI
190
LV190
T
3
0
6
Figure 3.5 Kerosene Product Initial Boiling Point (IBP) Control
To serve as a typical example, Figure 3.5 illustrates the cascade structure for one of the conven￾tional steady-state ratio feedforward control strategies illustrated in Figure 3.4 – the kerosene initial
boiling point (IBP) → stripping steam/bottoms ratio → stripping steam flow cascade.
T-306 bottoms flow (FI175) is set by level controller LC190 adjustments to valve LV190 as LI190
PV varies with the sidestream draw-off rate (FC173). Although FC173 has an important effect on
the kerosene back-end properties (i.e., final boiling point), it has a minor effect on its front-end
properties (e.g., flash point, IBP). The Kerosene IBP response to changes in the steam rate is fairly
fast, and with the IBP analyzer (AC197) located in T-306’s bottoms stream, loop deadtime is not
a problem. Also, T-306 bottoms flow, FI175 PV, has no impact on Kerosene IBP. Therefore, the
purpose of ratioing steam to bottoms is to ensure the stripping steam efficiency needed to remove
the lightest components from the kerosene product is maintained constant as the bottom flow
changes. Thus, as shown in Figure 3.5, steady-state ratio feedforward control – ratio control with
no dynamic compensation – is all that is necessary.
As explained previously, this steady-state ratio feedforward control strategy must be enhanced
(via custom code/logic) to enable Kerosene IBP control AC197 to continue when the bottoms flow
rate FI175 PV becomes unavailable. This is accomplished by maintaining RC197’s wild flow input
constant, at its last good value, stored in a “last good wild flow value” storage location, until FI175
PV becomes available once again, i.e., returns “Good.”. This allows RC197 to respond to the set
point changes calculated by AC197 and continue to reset the steam rate FC174 SP without the
feedforward corrections. And when FI173 PV becomes available again, the custom code/logic must
initialize RC197 prior to its first output after FI173 PV returns “good.” Standard DCS features will
then force AC197 to initialize, and full control functionality will be restored bumplessly.
3.3 Dynamic Compensation via the Lead-Lag Algorithm
When controlled and wild flow dynamics (e.g., CV–MV and CV–DV) are about the same, the correct
feedforward action is to change the controlled flow as soon as the wild flow changes. And even if Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License3.3 Dynamic Compensation via the Lead-Lag Algorithm 127
the two responses have different steady-state gains (almost always), it is the ratio controller’s set
point that determines the feedforward correction’s magnitude. However, when controlled and wild
flow dynamics, e.g., CV–MV and CV–DV responses, are different, dynamic feedforward control is
needed.
The dynamic compensation tag, the entity that differentiates steady state from dynamic feedfor￾ward control, executes the lead-lag control algorithm, which dynamically shapes the tag’s input
(measurement or calculated) to determine the dynamic feedforward controller’s MV adjustments.
The lead-lag algorithm is a standard DCS control algorithm or a standard function block. Its inputs
are the CV–MV and CV–DV dynamic response parameters which are used to time synchronize
the feedforward MV adjustments with the DV’s effect on the CV. We now derive the lead-lag algo￾rithm’s analytical form; the role played by the CV–MV and CV–DV response parameters, and how
they affect the algorithm’s control adjustments, are both revealed.
We start with a block diagram of a feedback control loop, which includes a feedforward controller.
All process models, controller transfer functions, and PVs in Figure 3.6 are expressed in terms of
s-domain Laplace variables.
GDV(s) and GMV(s) are transfer functions – the s-domain representation of the CV–DV and
CV–MV 1st order plus deadtime s-domain models; both models, with dynamic parameters, are
included in the figure. DV(s), MV(s), and CV(s) denote CV, MV, and CV deviations from steady
state. We will derive an analytical expression for GFF(s), the feedforward controller’s s-domain
transfer function, which relates the MV adjustments to the DV change. Although the lead-lag
control algorithm implemented in a modern-day DCS is a discrete time expression related to
the z-transform domain, working in the s-domain greatly simplifies the mathematics necessary
to obtain the result we seek. Note that the mechanics of the DCS discrete time calculations are
transparent to the user, and the lead-lag algorithm can be configured and implemented correctly
without knowledge of the discrete time formulation’s calculation details. To use the discrete lead-lag
algorithm, it is only necessary to correctly specify its inputs – the required CV–DV and CV–MV
dynamic response parameters. In deriving the lead-lag algorithm’s s-domain transfer function,
the relationships between the dynamic response parameters and the discrete time algorithm’s
parameter inputs are revealed.
In short, a transfer function G(s) is an empirical model that relates an output variable – a depen￾dent variable Y(s), to an input variable – an independent variable X(s) in the Laplace s-domain.
DV(s)
CV(s)
CV(s MV(s) ) SP
+
CV(s)
Feedforward
controller
Feedback
controller
GFF(s)
GDV(s)
GMV G (s) C + (s)
Manual
Auto
DV Effect
on CV = CVDV(s)
MV Effect
on CV = CVMV(s)
+
– Error(s)
GDV = KDV * e–θ
DVs
τDV * s + 1
GMV = KMV * e–θ
MVs
τMV * s + 1
Figure 3.6 Block Diagram to Derive Lead-lag Algorithm’s Transfer Function
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License128 3 Feedforward Control Essentials
V3 (s) = V1 (s) + V2 (s) 
V1(s) + V3(s)
V2(s)
G(s)
X(s) Y(s)
Y(s) = G(s) * X(s)
Figure 3.7 Standard s-Domain Algebra for
Transfer Functions and Sums of s-Domain
Variables
The desired s-domain expression for the feedforward controller GFF(s) in Figure 3.6 is obtained
using two standard s-domain algebraic operations Ref. [1] and successive substitutions. In
Figure 3.7, these two s-domain algebraic operations are illustrated: (i) a transfer function’s rela￾tionship to its output (the dependent variable – Y(s)) and its input (the independent variable – X(s))
and (ii) the sum of two s-domain variables to yield a third:
With the feedback controller in Figure 3.6 transferred to manual mode, only feedforward con￾trol is active in the control loop. Assume a step change in the DV occurs – we first calculate the
effect of the DV’s change on the CV (Equation (3.1)), and then the effect of the MV’s feedforward
adjustments, calculated in response to the DV’s change, on the CV (Equation (3.2)):
CVDV(s) = GDV(s) ∗ DV(s) (3.1)
CVMV(s)=−GMV(s)∗[GFF(s) ∗ DV(s)] (3.2)
By summing Equations (3.1) and (3.2), the combined effect of the DV change, CVDV(s), and the
MV adjustments, CVMV(s), on the CV is determined:
CV(s) = GDV(s) ∗ DV(s) − GMV(s) ∗ GFF(s) ∗ DV(s)
CV(s)=[GDV(s) − GMV(s) ∗ GFF(s)] ∗ DV(s) (3.3)
For CV(s), the change in CV, to be equal to zero for any value of DV(s), the expression in paren￾thesis in Equation (3.3) must be zero:
[GDV(s) − GMV(s) ∗ GFF(s)] ≡ 0 (3.4)
Equation (3.4) is solved for GFF(s), the feedforward controller whose adjustments exactly cancel
the effects of the DV change:
GFF(s) = [ GDV(s)
GMV(s)
]
(3.5)
Equation (3.5) indicates the feedforward controller’s analytical form depends only on the
CV–DV and CV–MV dynamic model transfer functions. Substituting these transfer functions (as
they appear in Figure 3.6) into Equation (3.5), and after rearrangement, the analytical expression
for the ideal feedforward controller’s transfer function is obtained:
GFF(s) = [ KDV
KMV ]
∗
[
𝜏MV ∗ s + 1
𝜏DV ∗ s + 1
]
∗ exp[−(𝜃DV − 𝜃MV) ∗ s] (3.6)
The lead-lag algorithm’s analytical form, written in terms of the algorithm’s input parameters, is
shown below in Equation (3.7):
GFF(s)=[KFF] ∗ [
𝜏Lead ∗ s + 1
𝜏Lag ∗ s + 1
]
∗ exp[−𝜃FF ∗ s] (3.7) Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License3.3 Dynamic Compensation via the Lead-Lag Algorithm 129
The equivalencies among the CV–DV and CV–MV dynamic response parameters and the algo￾rithm’s input parameters are revealed by comparing Equation (3.7) to Equation (3.6):
➢ Feedforward Gain = KFF =[KDV/KMV], the ratio of the steady-state gains.
➢ Lead Time Constant = 𝜏LEAD = 𝜏MV =CV–MV dynamic response first order time constant.
➢ Lag Time Constant = 𝜏LAG = 𝜏DV =CV–DV dynamic response first order time constant.
➢ Feedforward deadtime = 𝜃FF =(𝜃DV – 𝜃MV) = the difference between the CV–DV dynamic
response and CV–MV dynamic response deadtimes.
The lead-lag control algorithm in Equation (3.7) dynamically compensates an input signal based
on user-entered lead and lag time constants, 𝜏MV and 𝜏DV, both determined via plant tests and
model identification. The feedforward deadtime, 𝜃FF, is normally implemented with a deadtime
PV algorithm or a deadtime function block in PV processing before the feedforward control calcu￾lation is executed. As already mentioned in Section 3.2, the feedforward gain, KFF, is not a required
input for ratio feedforward control. The ratio controller’s set point is, in effect, the feedforward
gain – in the ratio controller’s control calculation (see Equation (2.29) in Chapter 2, Section 2.6), the
wild flow input is multiplied by the ratio controller’s set point, and hence the set point determines
the magnitude of the feedforward corrections. Depending upon DCS specifics, this may require
entering a value of unity for the gain – either as a (lead-lag) control algorithm input or as the ratio
controller’s wild flow PV-input multiplier.
Feedback control outputs are by nature full-valued and, therefore, as shown in Figure 3.6, with
the feedforward correction (GFF(s) * DV(s)) subtracted from the feedback controller’s output,
GC(s) * (Error(s)), the feedforward controller’s output must be incremental. Therefore, with no
ratio SP to determine the magnitude of the feedforward corrections, the feedforward gain is a
required input for incremental feedforward control. Incremental feedforward control is discussed
in detail in Section 3.5, but for now, we focus on the feedforward gain’s role in incremental
feedforward control.
Important: With the lead-lag algorithm derived and formulated as shown in Equation (3.6), when
it is used in a control strategy’s design, the lead – lag algorithm’s calculated output must be sub￾tracted from the feedback controller’s output as shown in Figure 3.6.
The actual sign ofKFF, the feedforward gain in the lead-lag algorithm (in Equation (3.7)), depends
upon the signs of the two individual steady-state gains, KDV and KMV. For example, for fired heater
F-300 in Figure 3.1, KDV <0 – COT decreases when the feed rate is increased, and KFG >0 – COT
increases when fuel gas is increased. Thus, the ratio KDV/KFG <0 and for the lead-lag algorithm for￾mulation in Equation (3.6), KFF <0. However, as shown in Figure 3.6, when a negative feedforward
correction is subtracted from the feedback controller’s output, it gets added to the feedback correc￾tion, which correctly increases fuel gas flow when the feed rate is increased. Note that when the
two steady-state gains have the same sign, the feedforward correction will decrease the MV when
the DV increases, and when the steady-state gains have different signs, the feedforward correction
will increase the MV when the DV increases.
As shown in Figure 3.8, the lead-lag algorithm’s time domain output, with no feedback con￾trol, has important response characteristics related to the CV–DV and CV–MV dynamic response
parameter values.
The initial MV change depends upon the magnitude of the 𝜏LEAD/𝜏LAG ratio – the larger the
ratio, the larger the initial change, and if the ratio is greater than one, there is MV overshoot. In
most cases, operators do not like to see excessive overshoot. Therefore, if the MV’s response is
much slower than the DV’s response, i.e., 𝜏LEAD is much larger than 𝜏LAG, the 𝜏LEAD/𝜏LAG ratio
can be reduced to achieve acceptable overshoot, despite some reduction in control performance. In
addition, if 𝜃FF is less than zero, i.e., 𝜃MV > 𝜃DV, the MV’s response must start before the disturbance Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License130 3 Feedforward Control Essentials
θFF
Disturbance variable
Lead-lag algo output
τLEAD /τLAG > 1
τLEAD /τLAG > 1
∆DV
KFF * ∆DV
Time →
Time →
∆MV
t = 0
Figure 3.8 Lead-lag Algorithm Time
Domain Response Characteristics
variable changes. Since this is not possible, under these circumstances, 𝜃FF should be set equal to
zero to achieve the best feedforward response possible. And finally, remember, in ratio feedforward
control, the ratio controller’s set point, not the steady-state gain, KFF, determines the MV’s ultimate
steady-state value.
3.4 Ratio Control and Dynamic Feedforward Control
The same three ratio control applications discussed in Section 3.2 are presented below in Figure 3.9,
in the cascade format characteristic of a dynamic ratio feedforward control strategy. The only dif￾ference between the steady-state ratio feedforward control strategy presented in Figure 3.4 and
LE tower tray temp.
Reactor partial pressure
Kero initial boiling point
Primary controller’s CV
Stripping steam/Btms
(Kero)
Reboiler steam/tower
feed
Treat gas/reactor
feed
Ratio controller CV
Reactor feed flow
LE tower feed flow
SS stripper Btms
(Kero) flow
Wild flow (DV)
SS stripper stripping
steam flow
Reboiler steam
flow
Treat gas flow
Controlled flow (MV)
Ratio
controller
Primary
controller
(CV)
Controlled
flow (MV)
SP SP SP
Dynamic
compensation
PV
CV → MV first order time constant, τMV ( = τLEAD)
CV → DV first order time constant, τDV ( = τLAG)
Feedforward deadime, θFF ( = θDV – θMV)
Wild flow
input
Lead-lag
inputs
PV
SP
Wild flow
(DV)
Feedforward
input PV or SP
logic
Figure 3.9 Dynamic Ratio Feedforward Control
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License3.4 Ratio Control and Dynamic Feedforward Control 131
the dynamic ratio feedforward control strategy in Figure 3.9 is the dynamic compensation tag. The
dynamic compensation tag hosts the lead-lag control algorithm, and hence, it provides the dynamic
ratio feedforward control functionality. Although it provides feedforward control functionality, it
is not a controller in the “classical” feedback sense – it does not have a set point and does not
send its control calculation result to another controller. Instead, its control calculation result (the
dynamically compensated input) is stored internally, and the ratio controller is configured to make
it the source of its dynamically compensated wild flow input.1 Hence, no standard DCS features
exist to manage the initialization of the feedforward controller or the coupling of the feedforward
controller to the ratio controller, i.e., the strategy’s feedback segment. The discussion that follows
summarizes the control functionality provided by the dynamic compensation tag.
The feedforward input is the ratio controller’s “raw” wild flow PV or SP. If PV noise is not a
problem or if the wild flow is uncontrolled, the “raw” wild flow’s PV is chosen as the input. If
the wild flow is controlled, and either PV noise is a problem or minimizing input variability is an
objective, then the wild flow controller’s SP is chosen. If the SP is the chosen input, then the wild
flow controller must either be configured for SP Init = Yes, or custom logic/configuration must
be added to use the wild flow PV as input when the wild flow controller is in manual mode or is
wound-up.
The feedforward input is then dynamically compensated by two calculations in series. The first
delays the feedforward input by an amount equal to the feedforward deadtime, 𝜃FF. Depending
upon the DCS, this is implemented using the deadtime PV algorithm or the deadtime function
block. After the input is delayed, the lead-lag calculation is executed by the dynamic compensa￾tion tag using the standard DCS lead-lag control algorithm or function block. The lead and lag
time constants (𝜏LEAD and 𝜏LAG) and the feedforward deadtime (𝜃FF) are engineer-entered values.
The internally stored dynamic compensation tag’s control calculation result is the ratio controller’s
(dynamically compensated) wild flow input source.
In most cases, feedforward On/Off is implemented analogously to a feedback controller, i.e., by
a mode change. Although the dynamic compensation tag is not a feedback controller, feedforward
control is turned on by transferring the dynamic compensation tag to auto mode and turned Off by
transferring it to manual mode. In auto mode, the lead-lag control algorithm executes, and in man￾ual mode, it does not execute. Therefore, when the dynamic compensation tag is transferred to man￾ual mode, the internally stored lead-lag control algorithm calculation result – the ratio controller’s
dynamically compensated wild flow input source, remains constant. The ratio controller contin￾ues to use the same constant, dynamically compensated wild flow input as it responds to set point
changes calculated by its primary – until the feedforward controller is recommissioned and starts
refreshing the wild flow input source value. This satisfies the important feedforward control design
requirement – decommissioning feedforward control does not decommission feedback control.
Depending on DCS functionality, the dynamic compensation tag may not have a mode, and if so,
feedforward On/Off is managed with a software On/Off switch. When the On/Off switch position
is changed by an operator’s console entry, user-provided custom On/Off logic executes, and the
appropriate On/Off action steps are completed. Identical to a dynamic compensation tag with a
mode attribute, the last valid value of the dynamically compensated feedforward input is saved on
each normal feedforward control execution pass, and this stored value is the ratio controller’s wild
flow input source. When feedforward control is off, this stored value of the dynamically compen￾sated feedforward input is not updated, and the value of the ratio controller’s wild flow PV input
1 In Section 2.6, Figure 2.35, the ratio controller PV and output calculations are displayed, and this input is either
X1 PVn or X1 SPn.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License132 3 Feedforward Control Essentials
remains constant. The ratio controller continues to use this same constant wild flow input as it
responds to set point changes calculated by its primary. Thus, even if the dynamic compensation
tag is without a mode attribute, feedback control continues when feedforward control is off.
With or without dynamic compensation tag mode attribute, user provided custom code and/or
function block configuration must force the ratio controller to initialize (discussed in Section 2.6.3)
whenever feedforward control is commissioned. The last stored lead-lag control calculation
result – the last saved valid value of the dynamically compensated feedforward input prior to
decommissioning, can be quite different from its current value as feedforward control is com￾missioned. Forcing the ratio controller to initialize, and the subsequent initialization of the ratio
controller’s primary, prevents a bump to the ratio’s secondary on the first control execution pass
after recommissioning and ensures the full control cascade’s functionality is restored bumplessly.
When the feedforward input (e.g., the wild flow PV) becomes unavailable, the dynamic compen￾sation tag’s PV is declared “Bad,” regardless of its mode attribute. The lead-lag control algorithm
or the lead-lag function block does not execute the lead-lag control calculation. The last lead-lag
control calculation result stored – the last saved valid value of the dynamically compensated
feedforward input, remains constant. The ratio controller continues to respond to the set point
changes calculated by its primary, while its wild flow input remains constant. Thus, feedback
control remains in control when feedforward control is disabled.
And as was the case when feedforward control is commissioned, when the feedforward input
(e.g., the wild flow PV) becomes available (returns “Good”) after being unavailable (“Bad”),
user-provided custom code and/or function block configuration must force the ratio controller to
initialize. Forcing the ratio controller to initialize, and the subsequent initialization of the ratio
controller’s primary, prevents a bump to the ratio’s secondary on the first control execution pass
after the wild flow input returns “Good” and ensures the full control cascade’s functionality is
restored bumplessly.
Figure 3.10 illustrates the cascade structure for a tray temperature → reboiler steam/feed →
reboiler steam flow cascade, one of the conventional dynamic ratio feedforward control strate￾gies referenced in Figure 3.9. The feed rate feedforward control changes the reboiler steam flow
as soon as the feed rate change is detected, thus minimizing its effect on the slower responding tray
temperature. FCG113, the dynamic compensation tag, is required because the dynamic response
of the tray temperature to a change in feed rate (FC113) has quite different dynamic parameter
FC
113
T
1
4
3
E-144
FC
117
TI
111
LC
114
FI
114
TI
116
Steam
T-143 feed TI
116 TC116
SP
Tray
temperature
Steam
to E-144
FC
117
SP
Desired tray
temperature
FC
113 RC117 FCG113
Dynamic
compensation
SP
Steam/feed
control
T-143
feed rate
Figure 3.10 Tray Temperature Control with Dynamic Feed Rate Ratio Feedforward Control
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License3.5 Incremental Steady-State Feedforward Control 133
values compared to its dynamic response to a steam rate change – the tray temperature response
to feed rate is much slower than its response to steam flow. Since the feed rate is controlled, the
feedforward input can be configured as either FC113 PV (OK if measurement noise is not a prob￾lem) or FC113 SP (preferred choice – to minimize input variability but remember FC113 must be
configured for SP Init = Yes). Dynamic compensation and hence feedforward control is commis￾sioned by transferring FCG113 to auto mode and is decommissioned by transferring FCG113 to
manual mode.
Important: In the process configuration illustrated in Figure 3.10, the open loop amount of steam
required to raise the tray temperature by 1∘ is proportional to the feed rate – the larger the feed rate,
the more steam is required. In closed-loop, this is equivalent to adjusting TC116’s proportional gain
as a function of T-143’s feed rate. But note that ratio feed rate feedforward control does this – the feed
rate multiplies the control adjustment to RC117 SP calculated by PID temperature controller TC116.
This is generally true for all feed rate ratio control – not only the dynamic feed rate ratio feedforward
control in Figure 3.10 but also steady-state feed rate ratio feedforward control, the control strategy
in Figure 3.10 without dynamic compensation (FCG113). Thus, both steady-state and dynamic feed
rate ratio feedforward control have an intrinsic advantage – adaptive PID proportional gain.
3.5 Incremental Steady-State Feedforward Control
In response to a change in a DV, an incremental feedforward adjustment to the MV is calculated
that is proportional to the DV change; the proportionality constant is the feedforward gain, KFF:
ΔMV = KFF ∗ ΔDV (3.8)
where KFF is the ratio of the DV (KDV) and MV (KMV) steady-state gains:
KFF = KDV
KMV
=
[
ΔCV∕ΔDV]
[
ΔCV∕ΔMV] =
(ΔMV
ΔDV
)
(3.9)
In Equation (3.8), ΔDV is the feedforward input. If CV–DV and CV–MV response dynamics
are different, incremental dynamic feedforward control is preferred; if so, ΔDV is dynamically
compensated before it is multiplied by KFF. If the response dynamics are similar, then dynamic
compensation is unnecessary, and incremental steady-state feedforward control is appropriate.
An application of incremental steady-state feedforward control is shown in Figure 3.11. Fired
heater F-42 is a dual-fuel fired heater, with the COT controller TC233 manipulating fuel gas flow
FC250, and fuel oil flow FC240 base loaded. When necessary, operators change the fuel oil flow set
point FC240 SP to (i) maintain the fuel gas control valve FV250 in controlling range, (ii) ensure fuel
gas pressure PI231 remains above its minimum and below its maximum allowable value, and/or
(iii) help ease a fuel oil tank inventory limitation. To avoid a bump to the COT whenever FC240
SP is changed, an incremental, steady-state feedforward control adjustment is combined with the
COT controller’s output before the FC240 SP is reset. TC223 responds to disturbances such as feed
rate (FC231), coil inlet temperature (TI220), and fuel gas heating value changes, while the feedfor￾ward control only corrects for operator-entered fuel oil flow set point changes. TC223’s feedback
adjustments also attenuate residual COT disturbances caused by a fuel oil flow change, which are
not eliminated by the feedforward adjustments.
Steady-state feedforward is appropriate for this situation because the COT responses to fuel gas
and fuel oil flow set point changes have similar dynamics, although the steady-state gains are
different. Both steady-state gains are positive, i.e., an increase in either fuel’s flow rate increases
the COT, and thus KFF, defined in Equation (3.9), is also positive. For a fuel oil set point increase, Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License134 3 Feedforward Control Essentials
FC
TI
233
FC
250
Fuel gas header
SP
FC –
240
Fuel
oil
FO Flow = FC240 SP
SP
TC233
TI
F-42
Fuel
gas
From FO
tank
PV
TC233 PID
algo result
KFF* ∆FC240 SP
TC233
PID FF control algo
Figure 3.11 Application of Incremental Steady State Feedforward Control
ΔFC240 SP>0, and with KFF >0, the feedforward correction, KFF * ΔFC240 SP, is positive. The
feedforward correction is in fuel gas (FC250) EUs. Depending upon the specific DCS, it is either
subtracted from the TC233 PID algo result (feedback control adjustment) in fuel gas EUs or con￾verted to fuel gas % of range and subtracted from the TC233 PID algo result in fuel gas % of range.
The TC233 PID algo result, in EUs and in % of range, are both routinely calculated by the PID
algorithm and are available internally after the TC233 PID control algorithm executes. In either
case, to maintain the COT constant, the feedforward fuel gas flow correction will correctly reduce
the fuel gas flow demanded by the feedback controller (note the negative sign in Figure 3.11) to
compensate for the fuel oil flow increase.
As indicated in Figure 3.11, TC223’s control algorithm is PID FF, a special standard PID control
algorithm, or standard function block, supported by all modern-day DCS’. It combines standard
PID feedback control with incremental feedforward control. The discussion that follows presents
the calculations performed by the PID FF control algorithm. It does not necessarily present the
progression of steps executed by any specific DCS’ PID FF algorithm – rather, it is meant to illustrate
the algorithm’s generic inputs and outputs and the scope of its computations.
Note 1: Like TC223’s PID tuning parameters, the feedforward gain, KFF, is a TC233 engineer entry.
Note 2: In the equations developed below, the subscript “FB” denotes the feedback control correc￾tion (PID control algorithm result), the subscript “FF” denotes the feedforward control correction,
and the subscript “FB+FF” denotes the combined feedback and feedforward control correction.
On every control execution pass, TC223’s PID FF control algorithm or function block calculates
the change in its feedforward input and the incremental feedforward correction. The current feed￾forward input is stored as the last feedforward input value for the calculation of the incremental
feedforward correction on the next control execution pass. The incremental feedforward correc￾tion is calculated, multiplied by the feedforward gain (KFF), and combined with the standard PID
feedback control result. TC223 has three configurable inputs, its PV and SP for the PID control algo￾rithm calculation, and its feedforward input – in our example, the current fuel oil flow set point Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License3.5 Incremental Steady-State Feedforward Control 135
FC240 SP.2 Each TC223 PID control algorithm calculation result is the fuel gas flow demanded by
only feedback control. When there is no feedforward control, e.g., ΔDV = 0 or if TC223’s control
algo is PID instead of PID FF, it would be the output sent to the fuel gas controller’s set point,
FC250 SP.
As presented in Equation (3.8), an incremental feedforward adjustment to the fuel gas flow is
calculated – it is the change in fuel gas flow (ΔFC250 SPn,FF) needed to maintain the firing rate and
thus COT constant after the fuel oil flow change:
ΔFC250 SPn,FF = KFF ∗ (FC240 SPn − FC240 SPn−1) (3.10)
FC240 SPn is the current (new) fuel oil set point, and FC240 SPn−1 is the fuel oil flow set point on
the last feedforward execution pass. The current feedforward fuel gas increment (ΔFC250 SPn,FF),
calculated in Equation (3.10), is in EU and is subtracted3 from the standard PID feedback control
algorithm result in EUs, FC250 SPn,FB, to provide the PID FF control calculation result:
FC250 SPn,FB+FF = FC250 SPn,FB − ΔFC250 SPn,FF (3.11)
where:
ΔFC250 SPn,FF =Current feedforward control incremental correction (see Equation (3.10)).
FC250 SPn,FB = Desired fuel gas flow set point calculated by TC233’s PID algorithm.
FC250 SPn,FB+FF = Desired fuel gas flow set point, includes feedback, feedforward
corrections.
The PID FF control calculation result, FC250 SPn,FB+FF, is TC223’s control output sent to the
fuel gas flow set point FC250 SP. TC223 output in % of range, TC223 OP (%), is calculated and is
displayed as TC223’s controller output:
TC223 OPn,FB+FF(%) = (FC250 SPn,FB+FF − FC250L)
(FC250H − FC250L) ∗ (100%) (3.12)
In Equation (3.12), FC250H and FC250L are the fuel gas EU high/low limits, and TC223 OPn,FB+FF
(%) is the new fuel gas setpoint in fuel gas EU % of range.
The PID FF algorithm’s last task is to store the current feedforward input, i.e., the fuel oil set￾point FC240 SPn, for use on the next control execution pass (n+1th) as the feedforward input
value on the last feedforward execution pass, i.e., on the n+1th execution pass, FFn−1 = FC240
SPn. Thus, until FC240 SP is changed, the incremental feedforward correction will be constant and
equal to zero.
An overview of the PID FF control algorithm’s calculations and information flow is presented
in Figure 3.12. Included in the figure is an example of the custom On/Off logic needed to allow
feedforward control to be commissioned and decommissioned without impacting feedback
control. Again, Figure 3.12 is not intended to be a description of how the PID FF control algorithm
is implemented in any specific DCS. Instead, it is meant to conceptually illustrate the inputs,
outputs, supplemental logic and calculation steps involved in a standard PID FF execution pass.
Note that the normal incremental version of the PID algorithm is used (the PID calculates ΔMn
(%)), and the nomenclature utilized is the same as that used in Chapter 2, Section 2.4 (PID Control
Algorithm Basics). For the key standard PID control algorithm calculations, a reference to the
2 When FC240 PV is noisy, it is best to use FC240 SP as the FF input source (provided SPINIT = Yes). See Section
2.6.2 for details.
3 It is necessary to check whether or not this is the standard PID FF algorithm’s formulation for a specific DCS, e.g.,
confirm the incremental FF correction is subtracted from, and not added to, the feedback controller’s correction.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License136 3 Feedforward Control Essentials
PV
SP
SP
ΔMn(%) Mn–1(%)
Mn(%) = Mn–1(%) + ΔMn(%) Equation (2.11)
MVn (EU) = PID algo OP in EU - KFF* (FFn – FFn–1)
Primary controller (TC233) with PID FF control algo
PID algo OP in EU
PID FF OP in % of range of MV
Equation (2.10)
Equation (2.12)
Equation (3.12)
Primary’s PID control calculation
KFF
Last FF input value
Is FF control status = ON?
FF control
status
Yes
Exit
Was FF control status
= On last pass?
No
Initialize primary
controller 
Yes
PID FF algo
FF input value:
source
Store “Raw” FF input
value to PID FF algo
FF input value source
“Raw” FF input from
FF input source
(FC240 PV or SP)
No
Custom on/off logic
MV controller
(FC250)
Store on
pass n
For use on
pass n+1
Figure 3.12 Incremental Steady-state Feedforward Control Using PID FF Algo
equation in Chapter 2 that describes that computation is included in Figure 3.12. The calculation
that combines feedforward and feedback corrections is in MV EUs. Alternatively, the feedforward
and feedback corrections can also be combined with both in % of range of the MV. Although the
calculation order may be different, in both cases the same calculations are performed internally
by the PID FF algorithm, and the control results are equivalent.
The PID control algorithm’s result, in % of range, ΔMn (%) (Equation (2.10)), is added to
Mn−1 (%), the full-valued controller output on the last execution pass, to yield the current PID
output value in % of range, Mn (%) (Equation (2.11)). Mn (%) is converted to MV EUs. (Equation
(2.12)), the feedforward increment is calculated in engineering units, KFF * (FFn – FFn−1), and
is subtracted from it to provide the PID FF control algorithm’s output in MV EUs. (=MV’s set
point). The PID FF output in % of range (the primary controller’s displayed output) is obtained
using Equation (3.12). The current feedforward input, FFn, is stored as the last feedforward input
value FFn−1 for use on the next control execution pass, i.e., FFn−1 = FFn for use on execution
pass n+1.
Neither the PID FF control algorithm nor the PID FF function block provides a standard method
to commission and/or decommission the feedforward control independent of the feedback control.
Therefore, supplemental custom code and/or function block configuration is needed to provide
feedforward On/Off functionality that does not impact the feedback control. The FF control status
(On or Off) is a user-provided custom software On/Off switch position, set by an operator’s console
entry, or by a store from another control strategy. Referring to Figure 3.12, the current measured
or calculated feedforward input value is obtained from the feedforward input source (FC240 SP).
When the feedforward control status is On, the FF input value is fetched and stored to the PID FF
algo’s feedforward input value’s source location and is used in the calculation of the feedforward
correction. When the feedforward control status is set to Off (feedforward decommissioned), the
On/Off logic maintains the PID FF algorithm’s FF input value constant by bypassing the fetch and
store of the “raw” current FF input value. The current measured or calculated feedforward input
value is ignored for as long as control is off. This maintains the current (Fn) and last (FFn−1) feedfor￾ward input values constant and equal, and the PID FF controller’s feedforward control correction
becomes equal to and remains zero. But remember – feedback control continues uninterrupted
without the feedforward component.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License3.6 Incremental Dynamic Feedforward Control 137
When feedforward control is recommissioned, the measured or calculated feedforward input is
again fetched and stored to the PID FF algo’s feedforward input value’s source for as long as the
control status remains on. Current feedforward input values (FFn) and refreshed last feedforward
input values (FFn−1) are used to calculate the feedforward correction (FFn – FFn−1) and thereby
contribute to the MV’s set point calculation.
Because the PID FF algo’s FF input value (FFn) remains constant when feedforward control is
Off, the last FF input value (FFn−1) also remains constant, both equal to the FF input value on the
last control execution pass before the controller was decommissioned. Therefore, when feedfor￾ward control is recommissioned, the current last FF input value (FFn−1) and the current FF input
value (FFn) may be very different. Consequently, as shown in Figure 3.12, on the control execution
pass that recommissions feedforward control, the primary controller is initialized. Standard PID
FF algorithm initialization features set the last FF input value (FFn−1) equal to the current FF input
value (FFn), making the feedforward control correction (FFn – FFn−1) equal to zero on the initial￾ization pass. This ensures there is no feedforward control bump on this first control execution pass
after feedforward control is recommissioned.
When the feedforward input (measured or calculated) becomes unavailable, i.e., declared “Bad,”
the PID FF algo’s FF input value source will be “Bad” and standard DCS PID FF functionality
will set the feedforward correction to zero. This decommissions the feedforward control, but the
feedback control remains on control. When the feedforward input becomes available once again
(declared “Good”), the PID FF algo’s FF input value source will be “Good” once again and standard
DCS PID FF functionality will set the last feedforward input (FFn−1) equal to the current feedfor￾ward input (FFn): FFn−1 = FFn. The feedforward correction (FFn – FFn−1) is zero, and there is no
feedforward control bump on the first control execution pass after the feedforward input returns
“Good.”
In summary, here are the significant characteristics of steady-state incremental feedforward con￾trol when implemented using the PID FF algorithm:
● The incremental feedforward correction issubtracted from the feedback controller’s MV demand;
both must either be in MV EUs or in % of range of MV EUs.
● The PID FF OP in % of range of the MV is the normally displayed primary’s output (TC223 OP
in our example). The PID FF OP in MV EUs is the MV set point.
● PV and SP are the normal PID control algorithm inputs used to calculate the PID algo’s result. A
third input is the feedforward input, needed by the PID FF algorithm to calculate the feedforward
input’s change and the incremental feedforward correction.
● User-provided custom code and/or function block configuration is needed to provide a method
for operators or other applications to commission and decommission the feedforward control
while allowing feedback control to continue.
● To ensure there is no feedforward control bump when feedforward control is recommissioned,
user provided custom code and/or function block configuration is needed to initialize the primary
controller on the first control execution pass after the control status is changed to On.
● Standard DCS PID FF functionality manages the unavailability of the feedforward input
(declared “Bad”) and its return to “Good” status without impacting the feedback control.
3.6 Incremental Dynamic Feedforward Control
If the CV–DV and CV–MV response dynamics are different, then incremental dynamic feedforward
control is necessary. If so, the feedforward input must be dynamically compensated before it is used Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License138 3 Feedforward Control Essentials
FI
103
TI
123
FC
154
Fuel gas header
SP
SP
TC123
(PID FF
Ctl algo)
F-54
Fuel
gas
TI
102
CIT COT
TIG102 Dynamic
compensation
PV
FF
input
Figure 3.13 Application of Incremental Dynamic Feedforward Control
in the incremental feedforward control calculation. Like dynamic ratio feedforward control, the
dynamic compensation tag hosts the lead-lag control algorithm and provides the dynamic feedfor￾ward control functionality. And like ratio feedforward control, incremental dynamic and incremen￾tal steady-state feedforward control differ only in the inclusion of the dynamic compensation tag.
An application of incremental dynamic feedforward control is presented in Figure 3.13. For
fired heater F-54, the COT is controlled by TC123, manipulating fuel gas flow setpoint, FC154 SP,
with incremental dynamic feedforward control adjustments for coil inlet temperature (CIT) distur￾bances. Because the dynamic response of COT to changes in CIT and fuel gas flow is different, the
CIT measurement (TI102 PV) is dynamically compensated in TIG102, using the lead and lag time
constants and feedforward deadtime parameters obtained via plant testing. The lead and lag time
constants and feedforward deadtime parameters are TIG102 engineer entries.
As indicated in the figure, PID FF is TC123’s configured control algorithm – it calculates the
incremental feedforward correction using the dynamically compensated CIT feedforward input
(with the dynamic compensation tag’s lead-lag algorithm’s calculation result as its source), and
subtracts the feedforward correction from the PID’s control algorithm’s calculated result to generate
the combined feedback/feedforward control’s fuel gas set point, FC154 SP. The feedforward gain,
KFF, needed to calculate the feedforward increment, is also obtained via plant testing and is a TC123
engineer entry.
The feedforward control only corrects for CIT (TI102) upsets, while TC123 responds to other
disturbances such as feed rate (FI103 PV) and fuel gas heating value changes. TC123’s feedback
adjustments also correct residual COT deviations caused by the CIT change that are not eliminated
by the feedforward adjustment.
The functionality of dynamic compensation tag TIG102 in Figure 3.13 is equivalent to the func￾tionality described in Section 3.4 for dynamic compensation in dynamic ratio feedforward control
(see Figure 3.9). Similarly, the PID FF control algorithm’s role in incremental dynamic feedforward
control (the left side of Figure 3.14) is equivalent to its role in incremental steady-state feedforward
control discussed in Section 3.5 (the left side of Figure 3.12). A functional overview of the control
strategy implemented in Figure 3.13, featuring the PID FF control algorithm’s calculations and
information flow coupled with the dynamic compensation tag, is presented in Figure 3.14.
Comparing Figures 3.12 (incremental steady-state feedforward control) and 3–14 (incremental
dynamic feedforward control), the information flow and the PID FF algorithm calculations are
very similar. However, the dynamic compensation tag, in most cases, can eliminate the need for
the supplemental On/Off logic included in Figure 3.12. Like dynamic ratio feedforward control Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License3.6 Incremental Dynamic Feedforward Control 139
MV SP = PID FF OP in EU
(FC154 SP)
PID algo OP in EU
PID FF OP in % of range of MV
Equation (2.10)
Equation (2.11)
Equation (2.12)
Equation (3.12)
PID Control Calculation
PV
SP
KFF
Primary controller (TC123) with PID FF control algo
Compensated
FF Input
Uncompensated
FF input
(TI102 PV) PV algo = deadtime
Ctl algo = lead/lag
Lead/lag calc result
Dynamic compensation
(TIG102)
τLEAD, τLAG, 𝜃FF
Last FF input value
Is FF control status = ON?
FF control
status
Yes
Exit
Was FF control status
= On last pass?
No
Initialize primary
controller 
Yes
No
ΔMn(%) Mn–1(%)
Mn(%) = Mn–1(%) + ΔMn(%)
MVn (EU) = PID algo OP in EU – KFF* (FFn – FFn–1)
Store on
pass n
For use on
pass n+1
Figure 3.14 Incremental Dynamic Feedforward Control Using PID FF algo – Dynamic Compensation Tag
has Mode Attribute
(Section 3.4), when the dynamic compensation tag in Figure 3.14 has a mode attribute, incremental
dynamic feedforward control On/Off is accomplished by changing the dynamic compensation tag’s
mode. In auto mode, the lead-lag control algorithm executes, the lead-lag calculation results are
updated, and the newly calculated values become the PID FF algorithm’s compensated feedforward
input. With feedforward control On, when feedforward corrections are nonzero, they impact the
MV’s set point calculation. In manual mode, the lead-lag control algorithm does not execute, the
lead-lag calculation’s result is not refreshed, the compensated feedforward input does not change,
current and last FF input values remain the same, feedforward corrections remain at zero and
feedforward control is Off.
When feedforward control is recommissioned after being Off (TIG102 transferred to auto), the
current compensated FF input value on the initialization pass may be quite different compared
to the compensated FF input value stored on the last pass that the feedforward control was On.
Therefore, referring to Figure 3.14, the primary controller (TC123) is initialized when the feedfor￾ward control is recommissioned. Standard PID FF algorithm features will set the last dynamically
compensated input value (FFn−1) equal to the current dynamically compensated input value (FFn),
making the feedforward control correction (FFn – FFn−1) zero. This ensures no feedforward bump
on the first control execution pass after feedforward control is recommissioned. On all subsequent
control passes, with TIG102 in auto mode, the lead/lag control calculation result, the feedforward
input value source, is once again calculated on each control pass.
If DCS functional shortcomings do not allow the dynamic compensation tag to be built with a
mode attribute, custom logic and a software On/Off switch are needed to manage the feedforward
control On/Off functionality. Figure 3.15 conceptually illustrates representative On/Off logic and
its interface to the incremental dynamic feedforward control strategy presented in Figure 3.14.
This On/Off logic has a structure that is similar in concept to the On/Off logic presented in
Figure 3.12 for incremental steady-state feedforward control. Because the dynamic compensation
tag in Figure 3.15 does not have a mode attribute, like Figure 3.12, the FF control status (On or Off)
is a user-provided custom software On/Off switch position, set by an operator’s console entry, or Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License140 3 Feedforward Control Essentials
MV SP = PID FF OP in EU
(FC154 SP)
PID algo OP in EU
PID FF OP in % of range of MV
Equation (2.10)
Equation (2.11)
Equation (2.12)
Equation (3.12)
PID control calculation
PV
SP
KFF
Primary controller (TC123) with PID FF control algo
Compensated
feedforward input
Last FF input value
Uncompensated
feedforward input
(TI102 PV)
PV algo = Deadtime
Ctl algo = Lead/lag
Dynamic compensation
(TIG102)
Lead/lag calc result
Is FF control status = ON?
FF control
status
Yes
Exit
Was FF control status
= On last pass?
No
Initialize primary
controller 
Yes
PID FF algo
FF input value:
source
Store lead/lag calc
result To PID FF algo
FF input source
No
Custom on/off logic
ΔMn(%)
Mn–1(%)
Mn(%) = Mn–1(%) + ΔMn(%)
MVn (EU) = PID algo OP in EU – KFF* (FFn – FFn–1)
Store on
pass n
For use on
pass n+1
τLEAD, τLAG, 𝜄
FF
Figure 3.15 Incremental Dynamic Feedforward Control Using PID FF Algo – Dynamic Compensation tag
Does not have a Mode Attribute
by a store from another control strategy. Referring to Figure 3.15, with feedforward control On, the
lead/lag calculation result on each control execution pass is fetched and stored to the PID FF algo’s
feedforward input value’s source location and is the PID FF algorithm’s dynamically compensated
feedforward input. Thus, feedforward corrections on each execution pass are calculated and com￾bined with the feedback control correction. When the feedforward control status is set to Off, the
On/Off logic maintains the PID FF algorithm’s FF input value constant by bypassing the fetch and
store of the lead/lag algo’s calculation result. The current lead-lag calculation result is ignored for
as long as control is off. The current (FFn) and last (FFn−1) FF input values are maintained constant
and equal, and the PID FF controller’s feedforward control correction remains zero. Feedforward
control is Off, but feedback control continues uninterrupted.
As was the case for incremental steady-state feedforward control (see Figure 3.12), because the
PID FF algo’s FF input value remains constant (fetch and store of the current lead-lag algo’s cal￾culation result is bypassed) when feedforward control is Off, the last FF input value (FFn−1) also
remains constant and equal to FFn, the lead-lag algorithm’s calculation result on the last control
pass before the controller was decommissioned. Therefore, when feedforward control is recommis￾sioned, the current last FF input value (FFn−1) and the current FF input value (FFn) may be very
different. Consequently, as shown in Figure 3.15, on the control execution pass that recommissions
feedforward control, the primary controller is initialized. Standard PID FF algorithm initialization
features will set the last FF input value, FFn−1, equal to the current FF input value, FFn (the current
lead-lag algo’s calculation result), making the feedforward control correction (FFn – FFn−1) equal
to zero on the initialization pass. This ensures there is no feedforward control bump on this first
control execution pass after feedforward control is recommissioned.
As described in Section 3.5 for incremental steady-state control in Figure 3.12, standard DCS
PID FF functionality manages the unavailability of the feedforward input (declared “Bad”) and
its return to “Good” status without impact on the feedback control. However, for incremen￾tal dynamic feedforward control (in Figure 3.14), this requires the dynamically compensated Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License3.7 Engineering Relationships That Provide Feedforward Corrections 141
feedforward input value (the dynamic compensation tag’s lead-lag control calculation result) to
be “Bad” when the uncompensated feedforward input is declared “Bad,” and the compensated FF
input status to be reset to “Good” when the uncompensated feedforward input returns “Good.”
State-of-the-art DCS standard deadtime PV and lead-lag control algorithms or function blocks will
almost certainly provide this functionality. If not provided by standard DCS features, additional
user custom code/configuration must duplicate this functionality. In either case, standard PID
FF algorithm functionality is enabled to manage the feedforward input’s unavailability/return to
“Good” without impact on feedback control.
In summary, here are the significant characteristics of incremental dynamic feedforward control
when implemented using the PID FF algorithm:
● The functionality of the dynamic compensation tag is equivalent to its functionality in dynamic
ratio feedforward control. Similarly, the PID FF control algorithm’s role is equivalent to its role
in incremental steady-state feedforward control.
● The dynamic compensation tag, in most cases, can eliminate the need for user-provided supple￾mental On/Off logic. Like dynamic ratio feedforward control, when the dynamic compensation
tag has a mode attribute, incremental dynamic feedforward control On/Off is accomplished by
changing the dynamic compensation tag’s mode, e.g., to auto (On) or manual (Off).
● When feedforward control is recommissioned after being Off, the current last FF input value
(FFn−1) and the current FF input value (FFn) may be very different. Consequently, on the control
execution pass that recommissions feedforward control, the user-provided code must initial￾ize the primary controller. Standard PID FF algorithm initialization features ensure there is no
feedforward control bump on this first control execution pass after feedforward control is recom￾missioned. Whether or not the dynamic compensation tag has a mode attribute, the primary
controller must be initialized when feedforward control is recommissioned.
● Whether or not the dynamic compensation tag has a mode attribute, standard DCS PID FF func￾tionality manages the unavailability of the feedforward input (declared “Bad”) and its return to
“Good” status without impact to the feedback control. However, this requires the dynamically
compensated feedforward input value (the dynamic compensation tag’s lead-lag control calcu￾lation result) to be “Bad” when the uncompensated feedforward input is declared “Bad,” and
the uncompensated FF input status to be reset to “Good” when the uncompensated feedforward
input returns “Good.” If this functionality is not provided by the DCS as a standard feature (highly
unlikely), additional user custom code/configuration must be provided to duplicate it.
3.7 Engineering Relationships That Provide Feedforward
Corrections
There are important calculated process variables that, by their very nature, provide feedforward
corrections when included in a feedback control strategy – tower reboiler heat duty, tower internal
reflux flow, and pressure-compensated tower temperature. These calculations are explained in this
section, and a typical control application is presented for each.
The calculation of a light-ends tower’s reboiler duty includes the hot side flow and hot side inlet
temperature. If not controlled, both will vary with upstream or downstream upsets; the reboiler
duty upset that follows can often have a negative effect on tower operations, i.e., upsetting either
the tray temperature being controlled as an inferential indicator of product quality or the product
quality directly. Calculating, and controlling reboiler duty to maintain it constant despite these
upsets, provides feedforward corrections for these upsets and improves the quality control strategy’s
control performance.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License142 3 Feedforward Control Essentials
Similarly, the calculation of a light-ends tower’s internal reflux flow includes the reflux return
temperature. The reflux return temperature is difficult to control effectively, and it will vary with
tower energy balance upsets but, most significantly, with weather upsets. Internal reflux flow
upsets cause tower overhead pressure, and material balance upsets that cause fractionation
and product quality upsets. Calculating, and controlling internal reflux flow to maintain it
constant despite these upsets, provides feedforward corrections for reflux temperature changes
and improves the product quality control strategy’s control performance.
Finally, when not controlled, the thermodynamic equilibrium effects of a light-ends tower’s pres￾sure variations can cause tray temperature upsets and degrade a tower product quality control
loop’s control performance. Pressure affects the tray temperature – composition equilibrium rela￾tionships, and consequently, the calculation of feedforward corrections for pressure variations is,
as explained in Section 3.7.3, more complex than either reboiler duty or internal reflux control and
includes a number of simplifying engineering assumptions.
3.7.1 Tower Reboiler Duty Control
Reboiler duty is frequently manipulated to control a light-ends tower product quality, either directly
or by controlling a tray temperature that is an inferential indicator of product quality. One such case
is illustrated in Figure 3.16. In Figure 3.16, reboiler E-467 hot fluid inlet temperature (TI431), set by
either upstream or downstream unit operations, is subject to upsets. Upsets in TI431 directly affect
E-467 duty, tower T-464’s vapor boil-up, its liquid/vapor flow (L/V) ratio, its fractionation, and ulti￾mately, the tray temperature, TC435 PV. TC435 PV, an inferential indicator of T-467 bottoms quality,
is controlled at a set point TC435 SP that maintains the bottoms product quality at a desired target.
TC435 manipulates reboiler E-467’s hot fluid flow, FC437 SP, which varies E-467 duty. Although
TI431 upsets affect E-467 duty quickly, it takes some time before the TI431 upset impacts tray tem￾perature TC435 PV. Since corrective control action starts only after TC435 PV deviates from TC435
SP, the TC435 PV response is delayed relative to the initial duty upset.
T
4
6
4
E-467
FC
437
TI
431
TI
432
LC
430
FI
438
FI
434
TC
435
Hot fluid
to/from E-467
T-464 feed
TI
435
FV437
Figure 3.16 Typical Light-ends Tower Reboiler Configuration
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License3.7 Engineering Relationships That Provide Feedforward Corrections 143
TI
431
TI
432
TI
435
TIV431
TIV432
TC435
QC437
SP
SP
E-467
duty
T-464 tray
temperature
Hot fluid
from E-467
FC
437
SP
Validation
Desired tray temperature
FV437
E-467 hot side
inlet temperature
E-467 hot side
outlet temperature
Figure 3.17 Tower T-464 Tray Temperature Control with Reboiler Duty Control
This is a classic example of where feedforward control for reboiler duty will improve control
performance. By calculating and controlling reboiler E-467’s duty and configuring TC435 to reset
the duty controller’s set point, corrective action for a TI431 PV upset is initiated before TC435
PV deviates from TC435 SP. Figure 3.17 illustrates how the basic regulatory control strategy in
Figure 3.16 (TC435 → FC437 → FV437) can be upgraded by adding reboiler duty control (QC437).
E-467 heat duty QC437 PV is calculated using hot side inlet (TI431) and outlet (TI432) tempera￾tures, and flow rate (FC437):
QC437 PV = Scale ∗ FC437 SP ∗ CP ∗ (TIV431 PV − TIV432 PV) (3.13)
Since FC437 is an ultimate secondary, it is configured for SPInit = Yes. Thus, FC437 PV will
be used to calculate QC437 PV when FC437 is transferred to manual mode or is wound-up. This
maintains the calculation of reboiler duty for the history database, but TC345’s control status will
either be wound-up (FC437 wound-up) or output indisposable (FC437 in manual mode). TI431 and
TI432 are both multiplexed measurements and not high-level analog inputs (4–20 mA); they must
be validated4 (in TIV431 and TIV432) before they are used in the duty calculation. CP is the hot
fluid’s heat capacity, assumed constant at a process technical services (PTS) specified value. Scale
is a heat unit conversion factor that ensures QC437 PV has the desired engineering units.
If the current value of inlet temperature TI431 PV is validated by TIV431, TIV431 stores this latest
valid value of hot fluid inlet temperature as its PV, TIV431 PV; this is the configured input source
for hot side inlet temperature in the reboiler duty calculation. This has an important consequence:
when TI431 PV does not pass its validation tests, TIV431 PV is not updated, and the same value
of TIV431 PV, used on the previous execution pass, is input to the reboiler duty calculation on
the current pass. Thus, the reboiler duty’s PV, QC437 PV, remains “Good,” reboiler duty control
continues, and the feedback corrections calculated by tray temperature controller TC435 continue
to change the reboiler duty’s set point, and then the hot fluid flow set point. This maintains the
more important tray temperature feedback control loop commissioned when the reboiler hot fluid
inlet temperature is invalid.
4 See Chapter 8, Section 8.8 for a detailed discussion of validation functionality.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License144 3 Feedforward Control Essentials
TI
431
TI
432
TIV431
TIV432
QC437
SP
E-467
duty
Hot fluid
from E-467
FC
437
SP
Validation
Desired tray temperature
FV437
E-467 hot side
inlet temperature
E-467 hot side
outlet temperature
TI
435 TC435
SP
Tray
temperature
RC437
SP
E-467 duty/feed
ratio control
FIG434
Dynamic
compensation
FI
434 T-464 feed
Figure 3.18 Tower T-464 Tray Temperature Control with Reboiler Duty and Feed Rate Feedforward Control
When TI431 PV becomes valid again, the new, valid temperature measurement may be quite dif￾ferent from the last valid value used to calculate reboiler duty since TI431 PV was declared invalid.
To prevent a bump to the tray temperature control loop on the first pass after TI431 PV is declared
valid once again, TIV431 functionality (via custom code and/or function block configuration) must
initialize the QC437; standard DCS features will initialize TC435 when QC437is forced to initialize.
Note that T-464’s feed rate, FI434, is uncontrolled and is set by an upstream (or downstream)
process unit. If upstream/downstream process adjustments or upsets cause troublesome feed rate
variations on a routine basis, then the control strategy in Figure 3.17 can be enhanced by adding
feed rate feedforward control (FIG434) and heat duty to feed ratio control (RC437) as illustrated in
Figure 3.18.
The strategy in Figure 3.18 assumes the CV (TC435 PV)–DV (FI434 PV) and CV–MV (QC437
SP) response dynamics are different, and dynamic feedforward control (FIG434) is necessary. If
not, steady-state feed rate feedforward control is implemented by eliminating the dynamic com￾pensation tag (FIG434) and connecting the feedforward input (FI434 PV) directly to RC437. Since
FI434 is uncontrolled and its set point is not available, if FI434 PV measurement noise is a prob￾lem, it must be filtered to minimize the propagation of noise to E-467’s hot side fluid flow. Finally,
plant testing to obtain the TC435 PV – FI434 PV response dynamics may not be straightforward,
depending upon the upstream/downstream unit adjustments necessary to change FI434 PV and
the specific dynamic effects those adjustments have on FI434 PV.
Important: Because QC437 resets flow controller FC437 SP, its control algorithm is configured to
be an algebraic equation, i.e., as Equation (3.13) rearranged to solve directly for FC437 SP, with
QC437 PV replaced with QC437 SP:
FC437SP = QC437 SP
[ Scale ∗ CP ∗ (TIV431 PV − TIV432 PV)] (3.14) Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License3.7 Engineering Relationships That Provide Feedforward Corrections 145
If the reboiler duty controller outputs to a valve and not a flow controller, it must be configured as
a PID controller because the relationship between heat duty and valve position is not linear. Thus,
replacing FC437 SP with FV437 in Equation (3.14) would not be valid.
3.7.2 Tower Internal Reflux Control
A two-product light-ends tower has five potential MVs available to control one or both tower prod￾uct qualities: condenser heat duty, reflux flow, distillate flow, reboiler heat duty, and bottoms prod￾uct rate. As will be discussed in Chapter 12 (Tower Product Quality Controls), these five MVs are
typically available to control up to five CVs: distillate and bottoms product quality, tower pressure,
bottoms inventory (tower bottoms level), and overhead drum inventory (reflux drum level). As will
be discussed in Chapter 12, the tower’s process configuration and operating objectives determine
the most suitable CV–MV pairings. We now use one specific tower control strategy to explain the
feedforward response of internal reflux control to an important tower disturbance variable – much
like the feedforward response of reboiler duty control to a reboiler hot side inlet temperature upset.
Figure 3.19 illustrates a light-ends tower overhead configuration with an air-cooled overhead
condenser. One T-542 operating objective is to minimize the C5 components lost to the overhead
product – this helps maximize the C5+ sent to the bottom product (a reactor feed). The C5 in the
distillate product is measured online, so C5 control is enabled. As shown in Figure 3.20, the reflux
rate FC551 is manipulated to control the C5 composition in the distillate product. Analyzer inputs
such as AI556 PV are not as reliable as high-level analog inputs (4–20 mA) and thus it must be
validated (in AIV556) before it becomes AC556’s PV.5
T
5
4
2
D-542
PC
570
LC
590
FC
551
FC
541
To treat gas
system
E-545
FI
556
TI
510
TI
521
AI
556
To stabilizer
(DeC4)
T-542 feed
Distillate
product C5
FV551
∞
Figure 3.19 Light-ends Tower T-542 Overhead Configuration with Air-cooled Overhead Condenser
5 Section 8.8 presents typical validation tests, and actions that would be taken when (i) AIV556 declares AI556 PV
invalid, and (ii) when AI556 returns valid once again.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License146 3 Feedforward Control Essentials
FC
551
AI
556 AC556 AIV556
Validation
SP
SP
External
reflux
Distillate
product C5
C5 distillate
control
Desired
Distillate C5
Reflux flow
control
Figure 3.20 T-542 Distillate C5 Control with MV = External Reflux Flow
A major upset for a light-ends tower with an air-cooled overhead condenser is a sudden ambient
air temperature change, for example, due to a sudden rainstorm. This increases condenser
E-545’s duty and decreases overhead pressure, and although PC570 reduces E-545’s duty to
recover pressure, the reflux return temperature, TI521 PV, decreases and becomes more subcooled
(further below its saturation temperature). When the more subcooled reflux enters the tower, more
top tray vapor is condensed, overhead vapor flow is reduced and the flow of liquid leaving the top
tray increases. The liquid flowing downward in the tower is called internal reflux. The internal
reflux increases in response to the reflux temperature’s decrease because the reflux becomes more
subcooled and additional vapor is condensed. Note that whenever external reflux is subcooled, the
internal reflux is greater than the external reflux.
With less vapor flow overhead, less condensate enters the reflux drum D-542, and its inventory
decreases; in response, level controller LC590 reduces distillate flow FI556 PV. As the distillate
flow is decreased, the distillate C5 composition decreases,6 and AC556 responds by decreasing the
reflux rate to increase AC556 PV and return it to its set point. The reduction in reflux rate even￾tually increases D-542 inventory, and in response, LC590 increases the distillate rate FI556 PV. As
steady-state is approached once again, the preupset tower material balance – distillate and bottoms
flow rates, is reestablished.
The tower’s response to this energy balance upset causes a transient upset to the tower’s mate￾rial balance – less feed removed as distillate product and more feed removed as bottoms product.
However, since the feed rate and feed composition are unchanged, the distillate rate adjustments
are unnecessary. In fact, the only correction needed to keep the distillate product’s C5 on target is
to reduce the reflux flow rate. The reduction in reflux rate is necessary to maintain the internal
reflux about the same. Internal reflux sets the fractionation in the tower, and if the tower’s material
balance is sustained, constant internal reflux maintains the distillate product quality close to its
target.7
The tower material balance upset described above can be avoided by enhancing the distillate C5
control strategy in Figure 3.20 to include the calculation and control of internal reflux. By calcu￾lating and controlling the internal reflux flow in T-542’s rectifying section and configuring AC556
to reset the internal reflux controller’s set point, corrective action for a TI521 PV upset is initiated
before AC556 PV deviates from its set point. Thus, including internal reflux provides feedforward
6 See Chapter 12, Sections 12.1–12.6, for a detailed discussion of tower separation fundamentals.
7 See Section 12.6.3 for an explanation of tower fractionation.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License3.7 Engineering Relationships That Provide Feedforward Corrections 147
FC
551
TI
510
TI
521 TIV521
FC521
Validation
SP
External
reflux flow
Internal reflux (IR)
control
TI510TYP Ovhd
temperature
Reflux return
temperature
SP
AI
556 AC556 AIV556
Validation
SP
Desired
distillate C5
C5 distillate
control
Distillate
product C5
TIV510
Typical value Validation
Ovhd temp
FV551
Figure 3.21 T-542 Distillate C5 Control with Internal Reflux Control
corrections for any upset that changes reflux temperature.8 Figure 3.21 illustrates how to upgrade
the basic regulatory control strategy in Figure 3.20 (AC556 → FC551) by adding internal reflux
control (FC521).
Details and control issues related to the specific control strategy in Figure 3.21 will be presented
and discussed below but first internal reflux control is discussed generically to clarify its calcula￾tion. Internal reflux is a function of the external reflux flow and the temperature difference across
the overhead condenser – the difference between the overhead and reflux temperatures. A heat
balance at the tower overhead relates these process variables to each other. The subcooled external
reflux (ER) returned to the tower must be heated to the temperature of the tower’s top tray. The
heat required (Q) to raise the ER’s temperature from the reflux temperature, TR, to the top tray’s
temperature, TOH, is given by:
Q = Scale ∗ ER ∗ CP ∗ (TOH − TR) (3.15)
where CP is the ER’s specific heat (heat per mass or per mole per degree), and Scale is a
user-provided constant that ensures Q has the desired EUs. The heat source for Q is the heat
released when additional top tray vapor is condensed by the subcooled reflux:
Vapor condensed = Q
𝜆 = Scale ∗ ER ∗ CP ∗ (TOH − TR)
𝜆 (3.16)
where 𝜆 is the overhead vapor’s latent heat of vaporization (heat per mass or per mole). The internal
reflux (IR) is the sum of the subcooled ER entering the tower and the amount of vapor condensed
to liquid above the top tray:
IR = ER +
Scale ∗ ER ∗ CP ∗ (TOH − TR)
𝜆
IR = ER ∗ [1 + Scale ∗ (CP∕𝜆)∗(TOH − TR)] (3.17)
In Equation (3.17), CP and 𝜆 are normally provided by the PTS group, manually entered by an
engineer, and maintained constant. The IR calculated using Equation (3.17) is the internal reflux
controller’s PV.
8 Internal reflux control is normally recommended for any light-ends tower with an air-cooled condenser.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License148 3 Feedforward Control Essentials
The IR controller’s output is the external reflux flow controller’s set point; it is calculated by
rearranging Equation (3.17) to solve for ER:
ER = IR
1 + Scale ∗ (CP∕𝜆)∗(TOH − TR) (3.18)
Equation (3.18) is the IR controller’s control algorithm’s output. In Figure 3.21, AC556 resets the
IR flow controller’s set point, FC521 SP. With Equation (3.18) configured as the internal reflux
controller’s arithmetic control algorithm, IR would be set equal to the internal reflux controller’s set
point, the desired internal reflux flow value calculated by AC556. The IR controller then calculates
the ER flow using Equation (3.18) and sends the result (i.e., ER) to the ER controller’s set point
(FC551 SP in Figure 3.21).
The measurements needed to calculate the IR controller’s PV using Equation (3.17) and its con￾trol output, the ER controller’s set point using Equation (3.18), are available for T-542. Referring to
Figure 3.19, the calculation of the IR controller’s PV is given by:
FC521 PV = FC551 SP ∗ [1 + Scale ∗ (CP∕𝜆)∗(TI510TYP–TIV521 PV)] (3.19)
where:
FC521 PV = IR, T-542 rectifying section
FC551 SP = T-542 external reflux flow rate
TI510TYP =“Typical” value of overhead temperature
TIV521 PV = validated value of reflux temperature, TI521 PV
CP =external reflux-specific heat
𝜆 =overhead vapor latent heat of vaporization
Scale = scale factor to ensure FC521 PV has the desired EUs (if necessary)
Likewise, referring to Figure 3.19, the calculation of the IR controller’s output, the ER controller’s
SP using Equation (3.18) is given by:
FC551 SP = FC521 SP
1 + Scale ∗ (CP∕𝜆)∗(TI510Typ − TIV521 PV) (3.20)
Because reflux temperature TI521 is not a high-level A/I measurement, i.e., it is a digital tem￾perature indicator (DTI) point, it is validated (in TIV521) before its use in the internal and external
reflux flow calculations. Since FC551 is an ultimate secondary, it is configured for SPInit = Yes.
Thus, FC551 PV will be used to calculate FC521 PV (using Eqn (3.19)) when FC551 is transferred
to manual mode or is wound up. This maintains the calculation of IR for the history database, but
AC556’s control status will either be wound-up (FC551 wound-up) or output indisposable (FC551
in manual mode).
Note: Like a reboiler duty controller, if the IR controller outputs to the reflux valve and not the
reflux flow controller, it must be configured as a PID controller because the relationship between
IR and valve position is not linear. Thus, replacing FC551 SP with FV551 in Equation (3.20) would
not be valid.
Important: Instead of a validated overhead temperature measurement TIV510 PV (TI510 PV is a
multiplexed measurement and should be validated), a typical value of TI510 PV (TI510TYP) is used
in both calculations – this prevents positive feedback when the overhead temperature changes.
Suppose the validated measured temperature, TIV510 PV, is used in Equation (3.20), and it sud￾denly increases. The response of the reflux return temperature to the increase in overhead temper￾ature is very slow because of condenser E-545’s heat transfer dynamics and especially the hold-up
in reflux drum D-542. The temperature difference across E-545 and D-542 will initially increase, Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License3.7 Engineering Relationships That Provide Feedforward Corrections 149
and Equation (3.20) will decrease the ER flow. This change is in the wrong direction – reducing ER
will increase the overhead temperature further. There is no internal mechanism that can reverse
these corrections so the temperature will continue to increase, and the ER will continue to decrease.
There are a few ways to choose TI510TYP – it can be a design value, a true typical value, or a
validated value of the measured overhead temperature (TIV521 PV) when the IR controller FC521
initialized last. If the design value or a true typical value is used, it is engineer entered and main￾tained constant. Note that if the value of TC510TYP on FC521’s last initialization pass is used, for as
long as T-542 operations remain relatively steady after the initialization pass, the IR flow calculated
can be a reasonable order of magnitude estimate of the actual IR flow.
The current value of reflux temperature TI521 PV is validated by TIV521, and TIV521 stores this
latest valid value as its PV, TIV521 PV; this is the configured input source for FC521’s PV and output
calculations using Equations (3.19) and (3.20). This has an important consequence: when TI521 PV
does not pass its validation tests, TIV521 PV is not updated, and the same value of TIV521 PV, used
on the previous execution pass, is input to FC521’s calculations on the current pass. Thus, the IR
PV, FC521 PV, remains “Good,” IR control continues, the feedback corrections calculated by AC556
continue to change FC521 SP, and FC521 continues to reset FC551, the ER flow set point. This
maintains the more important C5 composition temperature feedback control loop commissioned
(without reflux temperature feedforward corrections) when the reflux temperature is invalid.
When TI521 PV becomes valid again, the new, valid reflux temperature may be quite different
from the last valid value used in the IR controller’s calculations since TI521 PV was declared invalid.
To prevent a bump to the composition control loop on the first pass after TI521 PV is declared
valid once again, TIV521 functionality (via custom code and/or function block configuration) must
initialize IR controller FC521; standard DCS functionality will initialize AC556 when FC521 is
forced to initialize.
For many light-end towers, feed rate changes can cause operational upsets that affect the tower
and perhaps downstream units. In addition, because of slow dynamics, return to steady-state can
be sluggish. Therefore, feed rate feedforward control is very commonly implemented on light-end
towers. T-542’s feed rate, FC541, is measured, and controlled. If feed rate changes cause tower
upsets and/or the feed rate is changed often, the control strategy in Figure 3.21 can be enhanced,
as illustrated in Figure 3.22, by adding feed rate feedforward control (FIG541) and IR to feed ratio
control (RC551).
The strategy in Figure 3.22 assumes the CV (AC556 PV)–DV (FC541 SP) and CV–MV (FC551 SP)
response dynamics are different, and dynamic feedforward control (via the dynamic compensation
tag FIG541) is necessary. If this is not the case, then steady-state feed rate feedforward control is
implemented by eliminating the dynamic compensation tag (FIG541) and connecting the feedfor￾ward input (FC541 SP or PV) directly to RC551’s wild flow input location. Since FC541 is controlled,
if FC541 PV noise is a problem, or minimizing feedforward input variability is an objective, then
FC541 SP is the best choice for the wild flow. If the SP is the chosen input, then FC541 must either
be configured for SP Init = Yes, or custom logic/configuration must be added to FCG541 to use
FC541 PV as the input when FC541 is in manual mode or is wound up. Plant testing is required to
identify the CV–DV and CV–MV response dynamics, i.e., the engineer entered (in FCG541) lead,
lag, and feedforward deadtime parameter inputs.
3.7.3 Pressure Compensation of Tower Temperature
Because tray temperatures often provide a good inference of product quality, light-ends tower prod￾uct quality control strategies commonly maintain a tray temperature constant in the absence of an Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License150 3 Feedforward Control Essentials
FC
551
TI
510
TI
521 TIV521
FC521
Validation
SP
External
reflux flow
Internal reflux (IR)
control
TI510TYP Ovhd
temperature
Reflux return
temperature
SP
AI
556 AC556 AIV556
Validation
Dynamic
compensation
SP
Desired
distillate C5
C5 distillate
control
IR/feed
control
Distillate
product C5
Tower
feed
TIV510
Validation
SP
FC
541 RC551 FCG541
Figure 3.22 T-542 Distillate C5 Control with Internal Reflux, and Feed Rate Feedforward Control
online measurement. Tray temperatures correlate with liquid bubble points at equilibrium and
hence, the equilibrium relationships sustained on the trays promote the correlation of temperature
and composition.
However, tower pressures also play an important role in the temperature–composition equilib￾rium relationships. As tower pressure changes, the value of the tray temperature that will maintain
the quality on target also changes. This can be important for a tower whose pressure is uncon￾trolled and drifts on the tower’s heat balance closure and/or a downstream unit’s pressure. It also
can become an issue when a tower’s pressure is controlled but pressure is being minimized, i.e., the
pressure controller’s set point is being manipulated, to either improve fractionation and improve
yield or save reboiler energy utilization (discussed in Section 11.3.4).
Correcting the controlled tray temperature as the pressure changes, to prevent quality
upsets, is called pressure compensation of temperature; its theoretical basis is thermodynamics’
Clausius-Clapeyron equation Ref. [2]:
dT
dP = ΔHv
R ∗ T ∗ (vg − vl
) (3.21)
where:
T =absolute temperature
P =equilibrium vapor pressure of liquid
ΔHv = molar latent heat of vaporization at temperature T
R =ideal gas constant
vg = molar volume in the gaseous state at temperature T
vl = molar volume in the liquid state at temperature T
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License3.7 Engineering Relationships That Provide Feedforward Corrections 151
Assuming ΔHv is constant, vg ≫ vl
, and the vapor behaves ideally, Equation (3.21) can be integrated;
the result, called the Clapeyron modification, is as follows:
( 1
TC
)
= R
ΔHv
∗ ln [ P
PC
]
+
( 1
T
)
(3.22)
where:
TC = pressure compensated temperature
PC = pressure for pressure-compensated temperature TC
In Equation (3.22), PC is a reference pressure; it can be a design value, a typical tower pressure
or a pressure that is linked to a product quality target at a specific tray temperature. Even though
Equation (3.22) is easier to apply than the Clausius–Clapeyron relationship in Equation (3.21), to
use it correctly requires knowledge of the variation of ΔHv with temperature.
For small changes in tower pressure, the following linear approximation of Equation (3.22)
has been reported to be satisfactory Ref. [3] for pressure-compensating tray temperatures in most
light-end towers:
TC = T −
(dT
dP
)
∗ (P − PC) (3.23)
The temperature sensitivity to a change in pressure (dT/dP) must be evaluated from plant data,
either historical or via plant testing. For example, if collected historical data exists and can be used
to develop an inferential model for the product quality, q (T, P), i.e.:
q (T, P) = b0 + b1
∗ T + b2
∗ P (3.24)
where the bi i = 0 . . . .2 are constant coefficients determined by the model’s data fitting method.
Differencing both sides of Equation (3.24) yields:
Δq (T, P) = b1
∗ ΔT + b2
∗ ΔP (3.25)
For any change in P, ΔP, the change in T, ΔT, that maintains the quality constant is calculated by
setting Δq = 0 in Equation (3.25):
(dT
dP
)
≈ ΔT
ΔP = −b2
b1
(3.26)
If, as is the most likely case, historical data is not suitable to develop an inferential model such
as Equation (3.24), plant tests can be performed to “experimentally” estimate the temperature
sensitivity to pressure changes. The procedure involves making a change in tower pressure, and
either letting the quality controller bring its PV back to set point in closed-loop or manually
adjusting the tray temperature set point until the quality returns to its target. This should be
done for at least three values of pressure. The temperature–pressure plant-test data are correlated
linearly, and the linear correlation’s slope is the temperature sensitivity to a change in pressure
(e.g., ΔT/ΔP).
The historical Cox Chart is one of the most widely used methods to present linear plots
of equilibrium (vapor) pressure versus temperature at various normal boiling points for pure
component hydrocarbons Ref. [2]. It graphically illustrates the application of the Clapeyron
equation (Equation (3.22)) to pure component hydrocarbons at pressures low enough for the
ideal gas law to apply to the vapor. Although not truly valid for the real-world complexity of
tower tray temperature–pressure–composition equilibrium, it does illustrate how pressure, Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License152 3 Feedforward Control Essentials
1.0
0.5
0.2
10
5
2
0.1
∆T
Increasing
normal boiling points
(heavier components)
P1
P2
T2 T
P2,T2, Bpt1
P1,T1, Bpt1
P2,T1, Bpt2
∆P
Ln vapor
pressure
Bpt1 Bpt2
Temperature
Figure 3.23 Typical Light-ends Tower Temperature, Pressure and Normal Boiling Pt Equilibrium
Relationships
temperature and composition are related at equilibrium, and it provides a graphical explana￾tion of how temperatures must change to maintain a constant composition when pressures
change.
Figure 3.23 presents a Cox Chart configured plot of typical (ideal) light-ends tower temperature,
pressure, and boiling point equilibrium relationships.
In Figure 3.23, plots of the normal boiling points of various hydrocarbons versus equilib￾rium pressures and temperatures are presented. The thermodynamic relationships depicted in
Figure 3.23, when applied to tower tray equilibrium, are qualitatively aligned with the func￾tionality of Equation (3.22) but align with the linear approximation in Equation (3.23) only for
small changes in tower pressure. Each temperature–pressure pairing on a specific normal boiling
point straight line represents a constant equilibrium composition. For example, at pressure P1,
maintaining tray temperature at T1 the normal boiling point is Bpt1 which corresponds to a given
product quality. Now consider what happens when tower pressure decreases to P2. If the tray
temperature is maintained constant at T1, the boiling point increases from Bpt1 to Bpt2, the tray’s
equilibrium composition will change (it gets heavier) and product quality will deviate from its
desired target. However, if the temperature is pressure compensated – it is decreased from T1 to
T2 after the pressure decreases, the boiling point remains constant at Bpt1, the tray’s equilibrium
composition remains constant, and the product’s quality remains constant as well. The pressure
compensation of temperature calculation in Equation (3.23) similarly estimates, for small changes
in pressure, the change in temperature required to maintain the tray’s equilibrium composition,
and hence the product quality constant when pressure changes.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License3.7 Engineering Relationships That Provide Feedforward Corrections 153
Tray temperature controller
PV algo = Calc
Ctl algo = PID
SP
Pressure compensated
tray temperature
controller
Tray temperature
secondary
Pressure
compensation
calculation
TI
PC
Tray
temperature
measurement
Tower
PV or SP pressure
AC AIV AI
Validation SP
Desired
quality
target
SP
Quality
controller
Quality
measurement
TC
PC
ΔT
ΔP
Figure 3.24 Pressure Compensated Tray Temperature Control with Analyzer Feedback
An uncompensated tray temperature controller, without a quality controller’s feedback
adjusting its set point, will not be corrected for pressure changes, and the product quality will
deviate from its target for as long as the tray temperature set point remains fixed. If the tower’s
product quality is measured online and is controlled at target by resetting the tray temperature
controller, the product quality controller’s tray temperature set point adjustments will return
the product quality to its target. However, the loop response may be slow, and control perfor￾mance may be poor if there is considerable deadtime in the A → T loop. In effect, the feedback
controller adjustments that change the tray temperature controller’s set point compensate the
tray temperature PV for the pressure change. If instead the tray temperature controller’s PV
is pressure compensated directly using Equation (3.23) as shown in Figure 3.24, the pressure
compensation calculation is a feedforward correction for pressure changes, with analyzer feedback
trimming any feedforward model errors due to the thermodynamic approximations made applying
Equation (3.23).
If there is no analyzer feedback, the tray temperature’s pressure compensation calculation will
maintain the tray’s equilibrium composition and the product quality more constant than control of
the uncompensated temperature, but because there is no feedback to trim the model errors associ￾ated with using the approximation in Equation (3.23), quality deviations will occur.
Pressure measurements are normally very noisy. If the pressure is not controlled, then it is best to
filter the pressure measurement before it is used as the pressure compensation calculation’s input.
If the pressure is controlled, it is best to use the pressure controller’s set point as input for the
pressure compensation calculation – choosing the set point reduces the propagation of noise to the
temperature loop. And as highlighted earlier for other applications, if the pressure SP is the pressure
compensation input chosen, the pressure controller must either be configured for SP Init = Yes, or
custom logic/configuration must be added to use the pressure PV as the pressure compensation
input when the pressure controller is in manual mode or is wound-up.
Pressure measurements are reasonably reliable, but depending upon the specific application, it
may be necessary to validate the measurement before using it in the compensation calculation.
This will ensure tray temperature control continues (without pressure compensation) when the
pressure measurement becomes unavailable. Like the management of invalid hot fluid inlet and Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License154 3 Feedforward Control Essentials
outlet temperatures in reboiler duty control, this is achieved by basing pressure compensation
on the last good value of pressure. When the pressure measurement is available, the last good
value is updated. When the pressure measurement is unavailable, the last good value is used in
the calculation, but it is not updated. When the measurement becomes available once again, the
tray temperature controller must be initialized. Standard DCS functionality will then initialize the
temperature controller’s primary – the quality controller.
References
1 Seborg, D.E., Edgar, T.F., Mellichamp, D.A., and Doyle, F.J. Process Dynamics and Control, 4e,
176–180. Hobokan, NJ: John Wiley & Sons, Inc.
2 Schmidt, A.X. and List, H.L. (1962). Material and Energy Balances, 40–43. NJ: Prentice-Hall
Englewood Cliffs.
3 Smith, C.L. (2012). Distillation Control, 88–91. Hoboken, NJ: John Wiley & Sons.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License155
4
Process Analysis and Understanding
CHAPTER CONTENTS
4.1 Business Drivers, Operating Plans, and Operational Objectives
4.2 Obtaining Useful Information
4.2.1 Interactions with Operators
4.2.2 Plant Testing
4.2.3 Technical Support from Process Engineering Specialists
4.2.4 Economic Support from Planning/Coordination Staff
4.3 Use of Process Analysis
4.3.1 Identifying Basic Regulatory Control Enhancements
4.3.2 Identifying Constraints and Disturbances
4.3.3 Identifying Feedforward Control Opportunities
4.3.4 Identifying Control Loop Interactions and Their Consequences
4.3.5 Identifying CVs, MVs, and DVs for Light-ends Tower Product Quality Controls
As already emphasized in Chapter 1 (Process Dynamics and Process Control Overview), process
unit operating environments are dynamic, and are characterized by changing operating objectives,
random process upsets, instrument and equipment failures, and the avoidance of constraint limit
violations. Given these real-world circumstances, it is the basic regulatory control’s responsibility
to smoothly return process variables to desired targets after an upset, and to manage smooth and
stable transitions from one steady-state operation to another. Advanced regulatory controls are basic
regulatory controls that are enhanced by one or more complementary control features such as feed￾forward controls. The enhanced control strategies that result have the same control objectives as
the basic regulatory controls, i.e., to improve operability and stability, but the additional control
features upgrade control performance. Conventional advanced control applications have advanced
control features that help reduce the variability of important process variables. This allows opera￾tions closer to product specifications and/or constraint limits that locally optimize unit operations.
A plant’s suite of process control strategies must always be aligned with the real-time operations
environment created by the site’s business drivers, the operating plan developed to manage business
driver effects, and the plan’s operational objectives. This operations environment is strongly depen￾dent upon the site’s process units, their configuration, and their capability to profitably produce
desired products. Therefore, understanding the process units’ configuration, its operating objec￾tives, and the specifics of how its operating objectives are achieved is a fundamental prerequisite
for identifying, designing, and successfully implementing profitable control strategies.
This chapter focuses on the importance of process analysis, process understanding, and the oper￾ational objectives as a new control application or an enhancement to an existing control strategy is
identified and designed.
Practical Process Control Design with Industrial Applications, First Edition. Alan M. Kugelman.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License156 4 Process Analysis and Understanding
4.1 Business Drivers, Operating Plans, and Operational Objectives
The control objectives of any new control strategy, or planned enhancements to an existing control
strategy, must be consistent with the unit’s operating objectives. If so, they will also be consistent
with the site’s current business drivers. A site’s business drivers – product values, market demands,
feed availability and cost, available unit capacities, etc., impact both profitability and operating
costs. The site planning/coordination staffs, using various offline tools, analyze the impact of busi￾ness driver changes on site operations, and with input from operations, maintenance, and technical
specialists, produce an operating plan. An operating plan is normally produced on a weekly basis
but, if necessary, more frequently to manage unforeseen changes in business drivers. The operating
plan defines the site’s operational objectives, for example, maximize crude distillation unit (CDU)
third sidestream product yield. But most importantly, it includes specific process variable targets to
achieve these operational objectives, e.g., unit feed rates, product yields, reactor conversion targets
(reactor inlet and outlet temperature targets), product specifications, and other important flow,
pressure, and temperature targets.
Once the plan is authorized, the operations staff then implements it. After explanations and dis￾cussions in daily meetings, the plan is implemented by console operators who: (i) adjust CV and
MV setpoints, (ii) adjust CV and MV high and low limits, (iii) as needed, switch secondary con￾trollers, shut/open block valves, bring control valves (or other instrument hardware) into or take
them out of service, etc., and (iv) make other specified adjustments that drive the plant toward
achieving its operational objectives. Note that with the current widespread penetration of RTO and
DMC technology, many of the operating plan’s specific MV and CV high and low constraint limits
and targets are transferred digitally to the appropriate RTO applications and DMC controllers.
Control engineers may have some input into the operating plan’s development. However, for
the most part, their exposure to the operating plan is via the daily control house meetings, where
specific elements of the plan are discussed with operations and technical staff. Follow-up discus￾sions with console operators, other operations personnel, and unit contact engineers, can identify
additional, and clarify remaining, issues.
4.2 Obtaining Useful Information
Observing plant operations at an operator’s console, discussions with console operators, focused
plant testing, and discussions with technical specialists are effective methods control engineers
use to help them understand a unit’s process configuration and its operating objectives.
4.2.1 Interactions with Operators
When operations are normal, and assuming the operator has given his/her permission, sitting at an
operator’s console, and observing unit operations as operators make routine process adjustments,
is perhaps the best way to become familiar with how a unit is run. An operator in many cases can
provide insight into what is happening (although often not why it is happening) and the appropri￾ate actions taken in response. Through their daily observations and experiences, they acquire an
intuitive understanding of process variable interactions, steady-state sensitivities, and the times to
steady state (TTSS) for the unit’s major dynamic responses. They are usually aware of the regulatory
loops that are most troublesome, the unreliable and noisy measurements, troublesome analyzer sig￾nals, and malfunctioning valves. They also know the important upsets the unit experiences, how
often they occur, whether their impact is managed, and if yes, how.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License4.2 Obtaining Useful Information 157
4.2.2 Plant Testing
There are many occasions that control engineers will work with console operators while perform￾ing a plant test. Plant testing is most frequently performed to generate the dynamic responses of
dependent variable (CVs) to changes in selected independent variables (MVs and DVs) to help tune
PID controllers (see Section 2.4.7) and feedforward controllers (see Section 3.3), or to identify a
model-based controller’s CV–MV and CV–DV response dynamics (see Section 2.7.2).
However, plant testing can also be very helpful in a control strategy’s development stage, when
the potential CVs, MVs, and DVs are being evaluated for inclusion in the control strategy. While
working with and consulting with console operators, focused plant testing can provide real-time,
dynamic test data to confirm whether any of the process variable responses in the control strategy’s
scope exhibit any of the following characteristics:
● Interactions among potential MVs and CVs – i.e., a single MV has an important impact on more
than one CV and/or multiple MVs have an important impact on a single CV
● Potential DVs that have an important impact on potential CVs
● Strong or weak sensitivities among potential CVs and potential MVs and DVs
● CV–MV pairings that have very slow responses and/or feature long deadtimes
● CV–MV interactions that appear to be nonlinear.
The assessment of these plant test results can have a significant impact on a control strategy’s
design and scope.
4.2.3 Technical Support from Process Engineering Specialists
While console operators know “what happens” but not necessarily “why,” process engineering
specialists and unit contact engineers usually know “why it happens.” They are excellent resources
who often clarify technical issues associated with a unit’s operations. In addition, they provide
useful guidance on the following control application design-related matters:
● Important engineering calculations used in control – reactor H2 partial pressure, fixed bed reactor
equivalent isothermal temperature (EIT), tower tray temperature pressure compensation, tower
internal reflux, flow compensation, etc.
● Important physical and chemical properties used in control-related calculations – heat capacities,
heats of vaporization, fuel gas and fuel oil heating values, heats of combustion, etc.
● How setpoints and guideline values are established for numerous primary controllers – tower
tray temperatures, reactor treat gas/feed ratios, tower steam/bottoms ratios, fixed bed reactor
delta temperatures, reactor partial pressure, tower external and internal reflux/feed ratios, and
reboiler duty/feed ratios.
● Establishing standard validity checks for analyzer signals and externally multiplexed tempera￾ture measurements (DTI points).
● Establishing CV and MV maximum and minimum constraint limits.
● Deciding whether a specific tower tray temperature should be pressure compensated.
● Deciding whether a specific cascade primary should be configured for SPInit =Yes to avoid a
bump on an initialization pass. If yes, should the set point be ramped back to its PTS-established
target? At what ramp rate?
4.2.4 Economic Support from Planning/Coordination Staff
Although control engineers may provide some input to the operating plan’s development, their
daily responsibilities do not require much interaction with the site’s planning and coordination Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License158 4 Process Analysis and Understanding
staffs. However, the planning and coordination staffs are a valuable resource to support activities
that include an economic calculation needing current raw material and energy costs and/or product
values and yields. There are two such control engineer tasks for which this kind of assistance may
be helpful: (i) prioritizing the control group’s work plan activities and (ii) justifying investments
(e.g., a new control valve or flow measurement) needed to enhance an existing control strategy or
implement a new control strategy.
If needed to help prioritize tasks in the control group’s work plan, current business data – product
values, energy costs, feed availability, unit capacities, etc., are best obtained from the plan￾ning/coordination staff. This data is used to estimate the relative economic importance of each
control-related work task and helps the control group schedule work tasks for the upcoming
planning period. Although economic justifications may not be strictly followed, they do provide a
helpful quantitative justification for performing some tasks over others.
If a control strategy’s enhancement or a new control strategy’s implementation requires new
hardware, the new hardware’s return on investment (ROI) must at least clear the site’s minimum
ROI requirement. To calculate the ROI, the control strategy’s incentives must be estimated, and
again, the current business inputs (costs, product yields, and values) are best obtained from the
planning/coordination staff. They can also provide help to ensure the financial calculations are
valid and accurate.
4.3 Use of Process Analysis
The best starting point for the development of an enhanced or new control strategy is a simpli￾fied process drawing showing all related process equipment and instrumentation. The conceptual
designs of many advanced regulatory and conventional advanced control applications are presented
in this book. In every instance, the control strategy’s discussion begins with a description of the
process configuration using a simplified process drawing. All associated process equipment, instru￾mentation, measurements, and final control elements are included, as well as all relevant process
variables, both dependent (potential CVs) and independent variables (potential MVs and DVs).
Communications with operators and engineering specialists and focused plant tests as described
previously are very helpful when preparing such drawings. Additional resources for these drawings
are (i) the site’s detailed design piping and instrumentation drawings, P&IDs, (ii) design documents
and discussions with process design engineers, (iii) personal observations of process operations,
and discussions with operators at an operator’s console, and (iv) the schematic displays that are
part of the unit’s operator interface.
The effort to prepare an accurate, simplified process drawing logically focuses the control
engineer’s attention on the unit’s process configuration and the understanding of its operating
objectives. In the remainder of this chapter, several advanced regulatory and conventional
advanced control application opportunities are presented. Like the advanced regulatory and con￾ventional advanced controls discussed throughout this book, the discussion of each opportunity
in this chapter is based on the analysis of a typical simplified process diagram. The objective is to
gather and assimilate relevant process and operations-related information and incorporate it into
the process drawing. The drawing, and the knowledge gained, is then used to assess the need for
either an enhancement to an existing strategy or a new control strategy, and if justified, to identify
the enhanced or new strategy’s important design features.
The examples that follow identify both control strategy enhancements and new control strat￾egy opportunities. If found to be true during preliminary process analysis, any of the following
characteristics will have a major impact on the enhanced or new control strategy’s design features: Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License4.3 Use of Process Analysis 159
● Potential CVs, MVs, and DVs needed to achieve the control objective(s) of a new control strategy
are available, i.e., are measured.
● Process and/or control loop interactions exist.
● Potential MV(s) and DV(s) are in upstream and/or downstream units.
● Potential constraints are measured or can be calculated.
● Feasible approaches exist to maintain operations within constraint limits.
Remember that in some cases, the enhancement or new strategy will need additional instrument
and/or hardware investments, which may require justification.
4.3.1 Identifying Basic Regulatory Control Enhancements
The process configuration upstream of Naphtha Hydrofiner (NHF) R-61 is shown in Figure 4.1.
Virgin naphtha from the CDU overhead is feed to naphtha splitter T-53, whose bottoms product,
heavy virgin naphtha (HVN), is one feed stream to R-61. T-53 overhead (C5−), is fed to the naph￾tha debutanizer T-52, where light virgin naphtha (LVN), the second R-61 feed stream, is taken as
bottoms product while T-52 overhead (C4−) is sent to the LPG pool. The HVN and LNV products
are combined, mixed with pressure-controlled (by PC68) treat gas before reactor preheat in E-60
and E-61, and then enter R-61. The desulfurized reactor effluent is routed to the catalytic reformer
(after processing to remove C5 components) for conversion to MOGAS and light fuel oil.
Naphtha hydrofiner R-61 is a fixed bed reactor that removes feed sulfur via several catalyzed
reactions that convert the organic sulfur to hydrogen sulfide (H2S). The two most important pro￾cess variables that determine reactor conversion (reactor effluent sulfur content) are reactor tem￾perature and reactor H2 partial pressure. Reaction rates and conversion increase with increasing
R
6
1
E-61
Naphtha
H/F
D-61
TI
63
FI
68
Reformer
effluent
Treat gas from
recycle gas
compressor
PC
68
To amine
scrubber
Reformer feed,
To DeC4 tower
E-60
Separator
drum
T
5
3
D-53
Naphtha
splitter
E-53
E-56
FI
12
LC
12
LV12
T
5
2
LVN
To LPG
pool
Naphtha
debutanizer
D-56
To FG
system
E-51
E-532
Virgin naphtha
from CDU
overhead
HVN
Treat
gas
LC
13
FI
13
LV13
C4-
C5-
∞ ∞
Figure 4.1 Crude Light-ends Process Configuration Upstream of Naphtha Hydrofiner R-61
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License160 4 Process Analysis and Understanding
temperatures but catalyst deactivation and catalyst coking increase as well. However, as H2 partial
pressure increases at a given temperature, desulfurization reaction rates increase. Thus, the temper￾atures required to achieve a given desulfurization conversion are reduced as H2 partial pressures
increase. Operating at lower temperatures decreases catalyst deactivation and coking rates, and
thus helps extend the catalyst run. Although we concentrate here on controlling H2 partial pressure,
as the discussions in Chapter 14 will stress, control of reactor bed temperature is most important.
The treat gas is hydrogen rich and is the H2 source that supports the hydrogenation reactions.
Because treat gas is used in excess of the hydrogenation reactions stoichiometric requirements,
it has an important impact on reactor H2 partial pressure. H2 partial pressure is a function of
total reactor pressure, the treat gas H2 purity, and the treat gas/hydrocarbon feed ratio. The treat
gas/hydrocarbon feed ratio is almost always controlled at an offline calculated ratio set point to
help maintain a target reactor H2 partial pressure. Referring to Figure 4.1, although treat gas to
R-61 is measured (FI68), the flow of treat gas to R-61 is on pressure control (PC68) to satisfy a
recycle compressor operating requirement. Therefore, the current process configuration does not
allow the treat gas flow to be controlled, and consequently, treat gas flow cannot be ratioed to R-61’s
hydrocarbon feed (FI12 PV + FI13 PV).
Provided the incentives to control treat gas/feed justify the new hardware and its installation
costs, the revised process configuration in Figure 4.2 illustrates the new hardware required to con￾trol R-61 treat gas flow and enable treat gas/hydrocarbon feed ratio control: (i) a new R-61 treat gas
flow measurement (FI61), (ii) a new process tie-in to bypass treat gas to separator drum D-61, and
(iii) a new control valve (FV61) to regulate treat gas bypass flow to meet the desired R-61 treat gas
flow target.
Although not required to control the treat gas/hydrocarbon feed ratio, both level control loops in
Figure 4.2 have been upgraded to level → flow cascades. Both LVN and HVN flows are measured
R
6
1
E-61
Naphtha
H/F
D-61
TI
63
FI
68
Reformer
effluent
Treat gas from
recycle gas
compressor
PC
68
To amine
scrubber
Reformer feed,
to DeC4 tower
E-60
Separator
drum
T
5
3
D-53
Naphtha
splitter
E-53
E-56
FI
12
LC
12
LV12
T
5
2
LVN
To LPG
pool
Naphtha
debutanizer
D-56
To FG
system
E-51
E-532
Virgin naphtha
from CDU
overhead
HVN
LC
13
FI
13
LV13
C4-
C5-
Treat gas
to R61
Treat gas
bypass to D-61
FV61
FI
61
FC
12
FC
13
∞ ∞
Figure 4.2 Process Configuration with Piping Tie-In, New Control Valve, and Flow Measurement
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License4.3 Use of Process Analysis 161
FC
12
FC
13
E-61
D-61
FI
68
Treat gas from
recycle gas
compressor
PC
68
To amine
scrubber
Reformer feed,
to DeC4 tower
E-60
Separator
drum
R
6
1
Naphtha
H/F
LVN
from T-52
HVN
from T-53
Treat gas
to R61
Treat gas
bypass to D-61
Desired
treat gas/oil feed
ratio
RC61
SP
SP FV61
FC1213
Oil
feed
FI
61
Reformer
effluent
Total oil feed 
SP or
PV FC
61
TI
63
Figure 4.3 Revised Process Configuration with Advanced Regulatory Control Strategy
(FI12 and FI13), and each can be controlled using an existing control valve, LV12 and LV13:
by converting the LC12 → LV12 single loop level controller to a LC12 → FC12 → LV12 control
cascade, and converting the LC13 → LV13 single loop level controller to a LC13 → FC13 → LV13
control cascade. After converting each to a level → flow cascade, any HVN and LVN line pressure
and/or composition disturbance is quickly attenuated by the flow controller’s fast response before
it affects level. In addition, with FI12 and FI13 controlled (FC12, FC13), it is much easier for
operators to change or fix their flow rates. Unlike the new hardware in Figure 4.2, these level–flow
cascade changes involve only software configuration and some control house wiring changes,
and the costs would normally not be large enough to require justification. These changes could
very easily be included as a “no-cost add-on” to the project that enables control of treat gas flow
to R-61.
Note: Assuming there is sufficient surge capacity at T-53 and T-52 bottoms, R-61 hydrocarbon feed
flow rate changes can be smoothed by tuning both LC12 and LC13 for averaging level control.1
The treat gas/hydrocarbon feed ratio control strategy is shown in Figure 4.3. With T-52 and T-53
bottoms flows controlled, RC61’s wild flow – R-61 total flow FC1213, can be calculated by sum￾ming either the flow controller SPs or their PVs. It is usually best to use the set points to minimize
wild flow noise propagation to the treat gas flow MV, FC61 SP. Since FC12 and FC13 are cascade
secondaries, they are already configured for SP Init = Yes and thus the ratio feedforward control
calculation will remain valid when either is transferred to Manual mode.
Note that treat gas bypass valve FV61 must remain in controlling range, for example 15–85%, to
allow treat gas flow to be controlled and thereby maintain the treat gas/hydrocarbon ratio at its
1 Level controller tuning, including averaging level control tuning, is discussed in Chapter 9, Section 9.7.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License162 4 Process Analysis and Understanding
offline established target value. PC68 SP adjustments can make either more or less treat gas avail￾able at R-61 inlet and thus can help with this task. This can be done manually by operators based
on displayed valve saturation indications or automatically by enhancing the treat gas/hydrocarbon
feed ratio control strategy. However, discussions with process specialists and operations person￾nel are recommended to approve automatic PC68 SP adjustments. Whether done automatically or
manually by operators, these same specialists must also define the acceptable PC68 SP adjustment
magnitudes and range.
4.3.2 Identifying Constraints and Disturbances
Figure 4.4 shows a portion of a CDU’s (T-121) preheat train upstream of the CDU preheat heater
F-100. This portion of the preheat train features a crude flow split between E-112, exchanging heat
with T-121 4th sidestream and E-111, exchanging heat with T-121 bottom pumparound (BPA).
Operators occasionally adjust valves HV-112 and HV-111 manually to redistribute crude flow
between E-112 and E-111. The objective of these adjustments is to increase the combined heat
recovery to crude in both exchangers in order to increase F-100 inlet temperature, TI019, and thus
reduce fuel consumption in F-100.
These adjustments are made infrequently because operators know that several constraints may
undermine their adjustments, and they rarely have time to verify the adjustment’s impact, e.g., has
TI019 PV increased or decreased. Therefore, finding a way to automate this manual procedure could
be advantageous, but first, some preliminary analysis is needed. The first steps are to (i) estimate
E-113 E-112
T-121
BPA
E-111
TI
025 FI
017
TI
016
TI
018
E-135
LC
022
T-121 Btms to
VPS preheat
heater
T121
4SS
T-121
T-121 Btms
to light gas oil
H/F 
E-114 TI
019
Crude to preheat
heater F-100
Crude from upstream
preheat exchangers
HV
111
HV
112
T-121 4SS
to light GO
tankage
TK-84
APS
tower
TI
021 FC
020
TI
024
∞
TC
022
Figure 4.4 CDU T-121 Feed Preheat, Upstream of Preheat Fired Heater
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License4.3 Use of Process Analysis 163
by how much fuel consumption in F-100 can be lowered, (ii) estimate the potential incentives to
do so and establish if they justify the effort, and (iii) gain a better understanding of the constraints
and disturbances that may impact incentives capture.
The starting point is plant testing to estimate the incentives to automate this procedure. First,
estimates of exchanger E-112 and E-111 duty sensitivities to valve position changes (ΔHV112 and
ΔHV111) must be obtained, i.e., how large must ΔHV112 and ΔHV111 be to obtain numerically
significant exchanger duty changes, ΔE-112 and ΔE-111. And how long does it take for any numer￾ically significant changes to appear? Then, for acceptable changes in ΔHV112, ΔHV111, and the
subsequent changes in E-112 and E-111 duties, estimate the anticipated decrease in F-100 inlet tem￾perature, TI019. The anticipated decrease in TI019 is then used to estimate the decrease in F-100
fuel gas consumption and the energy savings that result.
Next, there are a number of potential constraints and disturbances that need to be considered
in the automated procedure. As established by the PTS group, one potential constraint that must
be managed is an E-113 hot side (CDU 4th sidestream – light gas oil rundown to tankage, TK-84)
outlet temperature (TI025) minimum constraint. Crude flow (cold side) adjustments to E-112 will
impact E-112 hot side (light gas oil) outlet temperature (TI016). For a given hot side inlet tempera￾ture (TI018) and flow (FI017), when E-112 cold side (crude) inlet flow increases, the hot side (light
gas oil) outlet temperature (TI016) will decrease. With a minimum allowable light gas oil run￾down temperature (TI025), E-112 crude flow increases must not drive the light gas oil rundown
temperature into violation.
In addition, for given E-112 hot side (4th SS) inlet temperature (TI018) and flow (FI017), when
E-112 cold side (crude) flow is decreased, the hot side outlet temperature (TI016) increases; this
will tend to increase heat lost to ambient air in air-cooled exchanger E-113. Thus, redistribution of
crude flow to E-112 and E-111 affects not only E-112 and E-111 duties, it also affects E-113 duty.
The three exchanger duties can be calculated since, as indicated in Figure 4.4, all hot side flow and
inlet/outlet temperature measurements are available. For given ΔHV112, ΔHV111, the increase
in heat recovered to crude = [ΔE-112 duty+ ΔE111 duty] must be significantly larger than the
increase in heat lost to air = [ΔE-113 duty]. Even if true, any increase in heat lost to air in E-113
must be included as a debit in the approach’s energy savings calculation.
E-112 and E-111 cold side outlet flows are combined, and the combined stream is heat integrated
with T-121 bottoms in E-114. Thus, HV112 and HV111 valve position changes not only impact
E-112 and E-111 cold side (crude) outlet temperatures, but they also impact E-114 hot side (T-121
bottoms) outlet temperature (TI024). From E-114, T-121 bottoms flow is then routed to E-135,
where it is heat integrated with crude. TI024 is E-135’s hot side (T-121 bottoms flow) inlet tem￾perature, and consequently, E-135 cold side (crude) outlet temperature is impacted. Thus, HV112
and HV111 changes will first impact E-112 and E-111 crude outlet temperatures, and then via the
heat integrations in E114 and E-135, their crude inlet temperatures as well. This may introduce
additional dynamic effects on TI019’s response to the valve position changes. Thus, a planned plant
test to determine the magnitudes of any E-112 and E-111 cold side inlet temperature changes for
typical HV112 and HV111 changes would be useful.
To clarify how crude flow changes to E-111 impact its hot side (T-121 BPA), it is necessary to look
more closely at T-121’s BPA’s process configuration displayed in Figure 4.5. First, look at the BPA
return temperature, TC022, a very important CDU process variable. It is controlled by manipulating
BPA flow to and around E-111 via three-way valve TV022. As crude flow to E-111 increases, TC022
PV tends to decrease, and TC022 responds by decreasing BPA bypass flow and increasing BPA
feed flow to E-111 via TV022. Because control of TC022 is very important, TV022 must remain in
controlling range as crude flow to E-111 is changed (increased), e.g., able to provide the E-111 BPA
feed and bypass flows necessary to maintain TC022 at set point.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License164 4 Process Analysis and Understanding
FC
020
Reflux
Crude
E-111
FC
010
T
1
2
1
TC
022
E-113
2SS
3SS
TPA
draw-off
1SS
Overhead
From
APS preheat
heater
TPA
return
4SS
BPA
return
APS
crude feed
BPA
draw-off
To
VPS preheat
heater
Crude
E-114
Crude
E-135
LC
022
Crude
E-112 TI
025
TI
021
TV022
T-121 Btms
∞
Figure 4.5 T-121 Bottom Pumparound (BPA) Configuration and Regulatory Controls
Also relevant are the common upsets, and adjustments made to a CDU pumparound circuit to
meet CDU control objectives. The following are BPA process variable upsets or changes that impact
E-111 duty and hence heat recovered to crude:
● BPA draw-off temperature TI021 upsets – TC022 PV is affected, and TC022 responds
by adjusting TV022 to change E-111 duty and maintain return temperature at its set
point.
● BPA return temperature set point TC022 SP is changed by an operator or a control application –
TC022’s responds by adjusting TV022, and E-111 duty changes to satisfy TC022’s new set
point.
● BPA return flow FC020 SP is changed by an operator or a control application – TC022 PV is
affected, and TC022 responds by adjusting TV022 to change E-111 duty and maintain return
temperature at its set point.
In summary, the process analysis described above has identified the following constraints to
honor:
● Minimum light gas oil rundown temperature, TI025.
● The increase in heat recovered to crude (ΔE-112 duty+ ΔE-111 duty) must be greater than the
increase in heat lost to air (ΔE-113 duty).
● TV022 valve position must remain in controlling range.
The following are disturbances that must be managed:
● E-112 and E-111 crude inlet temperature changes when HV112 and HV111 are changed
● T-121 BPA draw-off temperature (TI021 PV) upsets
● T-121 BPA return temperature changes (TC022 SP)
● T-121 BPA return flow set point changes (FC020 SP)
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License4.3 Use of Process Analysis 165
Assume the estimated energy savings justify proceeding. The most important potential roadblock
to maximizing heat recovery to crude in E-112 and E-111 are the T-121’s pumparound circuit upsets
and adjustments listed above. It is therefore essential to assess their frequency and their impact.
In many cases, advanced control applications will have pumparound return temperature and/or
pumparound draw-off or return flows as MVs to meet a CDU fractionation, internal reflux, yield,
or quality control objective. If so, their effects on E-111 duty may very well be more important than
the effect of redistributing crude between E-112 and E-111.
Last Thoughts
This analysis focused on a portion of the CDU preheat train upstream of the crude preheat heater,
F-100. However, it is also advisable to investigate the frequency and impact of preheat train upsets
further upstream of E-112 and E-111 and, specifically, their impact on E-112 and E-111 crude inlet
temperatures. The mix of upstream and downstream heat integrations and other process inter￾actions that are common in any CDU preheat train often suggests the need for a multivariable
controller such as DMC, and perhaps when there are important energy-yield trade-offs, an RTO
application. And note, whether this is a dynamic or steady-state control problem depends upon
how long it takes for E-112 and E-111 duties to reach a new steady state after HV112 and HV111
valve positions are changed.
4.3.3 Identifying Feedforward Control Opportunities
The instrumentation and hardware in Figure 4.6 for naphtha splitter T-285 are the typical control
loops specified by process designers and included on the design team’s P&IDs, for a grass-roots
light-ends tower.
T
2
8
5
E-289
TI
288
TI
289
LC
280
TC
287
CDU top
pumparound
(TPA)
Virgin
naphthasplitter
TV287
TI
287
FC
282 AI
295
HVN to
catalytic
reforming
5% dist
point
HVN to
storage
TK-241
PI
212
LC
212
FI
287
D-122
LVN To
storage
LV212
Figure 4.6 Typical Light-ends Tower Basic Regulatory Controls Specified by Designers
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License166 4 Process Analysis and Understanding
In most cases, during the design phase, control engineers will identify opportunities to improve
the basic regulatory controls specified by designers. These enhancements are either implemented
at start-up or soon after start-up when the unit or plant has lined out at a normal operating
point. The conceptual designs of light-ends tower advanced regulatory controls and conventional
advanced control applications are presented and discussed in detail in Chapter 12, and many
specific examples are included throughout this book. Therefore, the focus in this section is only on
the identification of common light-ends tower basic regulatory control enhancements. Although a
naphtha splitter is used in this discussion, the control enhancements presented are also applied
to a C3/C4 splitter in Section 4.3.5, and are generally applicable to a wide range of light-ends
towers.
Naphtha splitter T-285 in Figure 4.6 separates LVN as an overhead product and HVN as the
bottoms product. The LVN is routed to tankage and becomes an isomerization unit feedstock. A por￾tion of the HVN is sent to tankage, but most becomes a catalytic reformer feedstock. The reformer
effluent product is routed to tankage and becomes an aromatics plant feedstock. Because it has an
important impact on reformer feed composition, meeting a bottoms product HVN 5% distillation
point target is an important tower operating objective. Although a 5% distillation point measure￾ment is available (AI295), in the design basis, the 5% point target is met inferentially by maintaining
tray temperature TC287 at an offline calculated tray temperature set point. The tray temperature is
an inferential indicator of the 5% point, and thus TC287 SP is specified offline to ideally maximize
the HVN components that are converted to aromatics in the reformer and/or exclude components
that crack, and coke the catalyst. TC287 is controlled by manipulating reboiler duty – by making
hot fluid (CDU TPA) flow adjustments via TV287.
The TC287 → TV287 basic regulatory control strategy in Figure 4.6 can be enhanced by adding
the feedforward control components discussed in Sections 3.7.1 (reboiler duty control), 3.4 (ratio
feedforward control), and 3.7.3 (pressure compensation of temperature):
● Reboiler (E-289) duty control – compensates for hot fluid inlet temperature (TI288 PV) and flow
rate disturbances.
● Ratio feed rate feedforward control – compensates for tower feed rate (FI287 PV) changes and
upsets.
● Pressure compensated (PI212 PV) tray temperature control – compensates for tower pressure
upsets.
The importance of each addition depends upon the frequency, magnitude, and impact of reboiler
hot fluid inlet temperature and flow, feed rate, and tower pressure upsets. Note in the design basis
in Figure 4.6, the reboiler’s hot fluid flow is not measured, and since it is a heat duty calculation
input (in addition to the hot fluid inlet and outlet temperatures), E-289 duty cannot be calculated.
Therefore, to implement reboiler duty control, new hardware that provides a hot fluid flow mea￾surement (FI288) is required. The new field hardware and installation costs will most likely need
to be justified, by estimating the incremental benefits (improved 5% point quality, or HVN yield
improvement) of including reboiler duty in the tray temperature control strategy.
Note that with T-285 feed rate measured (FI287), T-285 feed rate can be controlled using existing
control valve LV212 and converting the LC212 → LV212 control loop to a level (LC212) → flow
(FC287) → Valve (LV212) cascade. With T-285 feed rate (FC287) on flow control, level control per￾formance improves, and it is easier for operators to make feed rate changes – a flow set point
entry versus a valve % open entry. Unlike the new hot fluid flow measurement, this enhance￾ment requires only software configuration and some control house wiring changes – minimal costs
that normally do not require justification, although operations acceptance and PTS approval are
needed.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License4.3 Use of Process Analysis 167
T
2
8
5
E-289
TI
288
TI
289
LC
280
TC
287
CDU top
pumparound
(TPA)
Virgin
naphthasplitter
TV287
TI
287
HVN to
catalytic
reforming
5% Dist
point
FC
282
AI
295
HVN to
storage
TK-241
PI
212
LVN to
Storage
LC
212
FC
287
D-122
FI
287
LV212
FI
288
Figure 4.7 New Flow Measurement and D-122 Level Control
The new measurement hardware and reconfigured level control cascade are shown in Figure 4.7,
and Figure 4.8 illustrates the advanced regulatory control strategy that controls pressure com￾pensated tray temperature TC287, with feed rate feedforward and reboiler duty control, and the
upgraded D-122 inventory control configured, e.g., with control of T-285 feed flow.
In Figure 4.8, the hot inlet (TI288) and outlet (TI289) temperatures are multiplexed measure￾ments and therefore they are validated before their use in the duty calculation. To enable the
feedback control to continue when either TI288 PV or TI289 PV is invalid, the reboiler duty calcu￾lation is based on the last good value of each.2 When valid, the last good value is updated, and when
invalid, the last good value is used but not updated. When either temperature returns valid after
being invalid, QC288 must be initialized; standard DCS features will then manage the initialization
of RC288 and TC287. T-286 tray temperature TI287 is a high level, analog input (4–20 mA) signal
and does not require validation.
With tower feed (FC287) on flow control, the ratio controller’s (RC288) wild flow input can either
be FC287 SP (recommended to reduce the propagation of measurement noise to FC288) or FC287
PV. Since FC287 is LC212’s secondary, it is already configured for SPInit = Yes; thus, feed rate feed￾forward compensation will still be valid, although perhaps noisy, when FC287 is in Manual mode.
Although the reboiler’s hot fluid flow measurement FI288 PV is required to calculate the reboiler
duty’s PV (QC288 PV), duty control can be implemented whether or not the hot fluid flow is con￾trolled. If it is controlled, (as it is in Figure 4.8) the duty controller can be configured with an
algebraic control algorithm that calculates the flow set point directly from the temperature inputs
and the heat duty set point (as shown in Equation (3.14) in Section 3.7.1). There is also an FC288
SP or PV flow input option for the reboiler duty calculation. FC288 SP is normally preferred to
2 Input validation and use of last good values in reboiler duty control is shown in Figure 8.5 and discussed in
Section 8.8.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License168 4 Process Analysis and Understanding
FC
288
TIV288
FCG287
QC288
RC288
Dynamic
compensation
Validation
SP
SP
E-289
duty/feed
control
E-289 duty
control
FI
288
TIV289
Pressure compensated
tray temperature
control
TC287
SP
Desired tray
temperature
Pressure
compensation
calculation
PI
212
TI
287
T-285 tray
temperature
T-285 overhead
TI287 pressure Comp
TI
288
TI
289
FC
287
T285
feed rate
E-289
hot fluid (CDU TPA)
inlet temperature 
E-289
hot fluid (CDU TPA)
outlet temperature 
SP or PV
CDU TPA
to E-289 TV287
SP
Figure 4.8 T-285 Pressure Compensated Tray Temperature Advanced Regulatory Control
minimize noise propagation to QC288 PV’s calculation. However, the FC288 SP or PV choice is
not relevant here because neither FC288 SP nor PV would impact the algebraic control algorithm’s
calculation of FC288 SP via Equation (3.14).
If hot fluid flow is not controlled, the duty controller must be configured as a PID controller, with
tuning (and perhaps plant testing) required, because, unlike the linear relationship between flow
and duty, the relationship between duty and valve % open is nonlinear. In this case, the FC288 SP
is the recommended choice for the reboiler duty’s PV calculation input because noise propagation
to QC288 PV impacts the PID control calculation and, therefore, can propagate noise to the MV.
Note 1: Since control valve TV287 is already installed, once the flow measurement hardware costs
are justified, hot fluid flow control can be implemented with only software configuration and some
control house wiring changes, but with essentially no incremental investment.
Note 2: Because the 5% distillation point is measured (AI295), the strategy in Figure 4.8 can be
upgraded further by adding closed loop 5% distillation point control, using either PID control or
model-based control. An example of closed-loop control, based on an online product quality mea￾surement, is presented, and discussed later in this chapter, in Section 4.3.5 (see Figure 4.14).
4.3.4 Identifying Control Loop Interactions and Their Consequences
In the discussion in Section 4.3.2, one of the observations made was that exchanger E-111’s cold side
(crude) flow adjustments via HV111 had an impact on an E-111 hot side temperature controller
(TC022) and maintaining TV022 in controlling range was identified as a constraint to honor as
crude is redistributed between E-112 and E-111. This specific control interaction arises because
the CDU’s crude feed and the CDU’s TPA are heat integrated in E-111.
Another process area that features numerous heat integrations is reaction systems, where
hot reactor effluent exchanges heat with the reactor’s feed stream so that feed is heated to a
high enough temperature to initiate the desired reactions. A typical example of reaction system Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License4.3 Use of Process Analysis 169
R301
HC feed
TC
319
TI
319 E-324 A/B
R-301
D-312
E-304 E-305
TV335A
TV335B
TV319A
TV319B
H2 richTreat gas
To product
stabilizer
To recycle
gas scrubber
R301 EIT
control
SP
FC
355
FC
311
TC
340
TI
340
F-340
FC
315
R-302
TC
335
TI
335
R302 EIT
control
SP
From recycle
gas compressor
Figure 4.9 Desulfurization Reaction System with Reactor Feed/Effluent Heat Integrations
heat integration is shown in Figure 4.9, a two-stage fixed bed hydrodesulfurization reaction
system where the second stage (R-302) reactor effluent provides the feed preheat for both the
first- (R-301) and second-stage reactors. R-302’s effluent is first reheated in the radiant section
of heater F-340 and is then routed to feed/effluent heat exchangers E-304 and E-305, where it
preheats R-302 feed and then to feed/effluent heat exchangers E-324 A/B where it preheats R-301
feed.3 Note that H2-rich treat gas is preheated in heater F-340’s convection section before it is
routed to both R-301 and R-302. The reactor inlet temperatures are controlled by manipulating
the bypass flow around the reactor feed/effluent heat exchangers. As will be explained below,
the reactor inlet temperature controllers play a major role in meeting the reactor’s conversion
targets.
For most hydrodesulfurization reactors, the two most important process variables that determine
reactor conversion – the reactor effluent’s sulfur content, are reactor temperature and reactor H2
partial pressure. Reaction rates and hence conversion increase with increasing temperature, but
catalyst deactivation and coking rates also increase. The treat gas, routed to each reactor from the
recycle gas compressor, is hydrogen rich and not only supports the hydrogenation reactions, it also
effects reactor H2 partial pressure. At a given temperature, as H2 partial pressure increases, desul￾furization reaction rates increase. Thus, the temperature required to achieve a given conversion is
reduced as H2 partial pressures increase, and by allowing reactor operations at lower temperatures,
catalyst coking rates decrease.
The discussion of a similar reaction system in Section 4.3.1 focused on maintaining sufficient
treat gas flows (via the treat gas/hydrocarbon flow ratio) to provide satisfactory reactor H2 partial
3 In fixed bed reaction systems, extensive heat integrations link feed preheat directly to reactor operations. This is
discussed in detail in Section 14.2.3.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License170 4 Process Analysis and Understanding
pressures. In this section, the focus is on the reactor preheat heat integrations and their effect on
reactor temperature control. Specifically, the focus is on how heat integrations cause temperature
control loop interactions and why control valve constraints arise.
In both first- and second-stage reactors, the hydrodesulfurization reaction heat effects cause
catalyst bed temperatures to rise from reactor inlet to reactor outlet.4 It is not practical to con￾trol a temperature profile to produce specific rates of reaction across the catalyst bed to achieve
the desired conversion. A practical approach, utilized to control conversion in many fixed bed
reaction systems, is to calculate and control a single representative temperature at an appropriate,
offline-determined target that will generate an average bed reaction rate that achieves the desired
reactor conversion. For reactors such as R-301 and R-302 with a single catalyst bed, an equivalent
isothermal temperature (EIT), calculated as a weighted average of the reactor bed inlet and outlet
temperatures, is typically used.5 Calculating and then controlling reactor EITs at an offline speci￾fied guideline value to meet a conversion target normally yields conversions that are in line with
the actual conversion achieved by the reactor’s temperature profile.
For fixed bed reactors with one catalyst bed, EIT is usually controlled by manipulating the reac￾tor’s inlet temperature. Because the catalyst slowly deactivates with time-on-stream, reactor tem￾peratures, i.e., the EIT, must be increased from start-of-run to end-of-run to achieve the desired
conversion over the entire catalyst run. In response to EIT controller setpoint increases, inlet tem￾perature controller setpoints are on average increased. This unfortunately also increases the rate
of catalyst coking, which over time can further reduce conversion, increasing the need to regener￾ate/replace the catalyst. Catalyst run lengths for hydrodesulfurization reaction systems are typically
1–3 years. Because catalyst activation/replacement requires a reactor shutdown, this is often sched￾uled for a normal refinery turnaround.
Referring to Figure 4.9, R-301 inlet temperature (TC319) is maintained at a desired target by
manipulating the bypass flow around feed/effluent preheat exchangers E324 A/B. The bypass flow
is changed by adjusting both the bypass valve (TV319A) and main feed valve (TV319B) simulta￾neously – for example, to increase TC319 PV, opening TV319B while closing TV319A. The R-301
EIT is calculated, and the EIT controller then resets the inlet temperature controller’s set point
(TC319 SP). Likewise, the second-stage reactor R-302 inlet temperature (TC335) is maintained at a
desired target by manipulating the bypass flow around feed/effluent preheat exchangers E304 and
E-305. Like R-301 inlet temperature control, the bypass flow is changed by adjusting both valves
simultaneously – opening/closing main feed valve TV335B while closing/opening the bypass valve
TV335A. The R-302 EIT is calculated, and the EIT controller then resets the inlet temperature
controller’s set point (TC335 SP).
Notice that the TC335 controller adjustments that control the second-stage reactor inlet temper￾ature also affect the first-stage reactor’s inlet temperature (TC319 PV). TC335 adjustments change
the combined duty of preheat exchangers E-304 and E-305. This changes E-304’s hot side outlet
temperature, and since it becomes E-324 A/B’s hot side inlet temperature, R-301’s inlet temperature
TC319 PV can also be affected.
To better understand how the bypass and main feed valve positions are adjusted to control TC335
PV and how the wind-up status of TC335 is related to valves TV335A and TV335B max/min open￾ings, the dual-acting valve characteristics of TV335A and TV335B are presented in Figure 4.10.
These same dual-acting valve characteristics apply to TV319A, TV319B, and TC319 OP, and the
discussion that follows also applies to them.
4 There are also reaction systems, e.g., catalytic reforming, that feature a temperature drop from reactor inlet to
reactor outlet.
5 EIT is defined, and its use in reactor conversion control discussed, in Chapter 14, Section 14.2.3.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License4.3 Use of Process Analysis 171
TC335 O/P
0%
100%
0%
100%
TC335
OPCL
0% 100%
To increase TC335 PV
Bypass valve
TV335A
% open
Main feed valve
TV335B
% open
TC335
OPCH
Allowable
control
range
TV335B
TV335A
TV335A
TV335B
Figure 4.10 TV335A and TV335B Dual Acting Valve Characteristic
A valve in exchanger bypass service will almost always be specified to fail open, i.e., specified
as an air-to-close valve. A valve in exchanger main feed service will almost always be specified
to fail closed, i.e., specified as an air-to-open valve. The TV335A and TV335B valve characteris￾tics in Figure 4.10 display that behavior – as TC335 OP increases from 0% to 100%, bypass valve
TV335A goes from full open (≈100%) to full closed (≈0%) and main feed valve TV335B goes from
full closed (≈0%) to full open (≈100%). Thus, as TC335 OP increases (moving from left to right in
Figure 4.10), TC335 PV increases. Also shown in Figure 4.10, an allowable control range for TC335
OP can be established using engineer-specified TC335 OP high (TC335 OPCH) and low (TC335
OPCL) clamps. Standard DCS features will then limit TC335’s output to always be within its high
clamp (TC335 OPCH) and low clamp (TC335 OPCL) limits.
When TC335 PV is increasing toward or exceeding TC335 SP, referring to Figure 4.10, to reduce
TC335 PV, TC335 OP must decrease to open TV335A and close TV335B. Thus, TC335 is configured
with control direction = Reverse. Likewise, using the same reasoning, TC319’s control direction must
also be Reverse. Both TC335 and TC319 are cascade secondaries and thus, in principle, both are con￾figured for SPInit = Yes, and tuned for best SP response with proportional on error. However, EIT set
points are changed infrequently over the catalyst run, and fast TC335 or TC319 responses to meet
a new EIT SP target is not important. But fast TC319 and TC335 responses to reactor load upsets
are important, and thus, with SPInit = Yes, tuning both for best load response with proportional on
PV is the better choice.
As the catalyst run proceeds and reactor temperature setpoints are increased, TC335 controller
outputs will, on average increase; the preheat exchanger bypass valve (TV335A) will tend to close
and the main feed valve (TV335B) will tend to open. However, the combined duties of E-304 and
E-305 will reach a maximum value when TC335 OP reaches its output high clamp (TC335 OPCH).
Referring to Figure 4.10, this corresponds to bypass valve TV335A’s opening limited low, and main
feed valve TV335B’s opening limited high. With TC335 OP at its high clamp limit, TC335 will be
wound up high, unable to either close TV335A or open TV335B further to increase TC335 PV.
Therefore, unless TC335 OP and both valve positions are brought back into controlling range,
R-302’s EIT cannot be increased.
Because R-302’s effluent is reheated in heater F-340 before it preheats R-302’s feed in E-305
and E-304, F-340 COT (TC340 SP) is an available degree of freedom to maintain TV335A and Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License172 4 Process Analysis and Understanding
SP
VTV335A
Min
TV335A
SP
TV335A
TC
340
FC
315
FV315
Fuel
gas
F-340
COT
control
F-340
fuel gas
control
TC340 SP high and low
clamps keep COT within
allowable operating limits 
Figure 4.11 E-304 and E-305 Bypass Valve
(TV335A) Position Control
TV335B in controlling range. At the start-of-run and for some time afterward, the catalyst is fresh
and reactor conversion targets can be met at relatively lower reactor temperatures. TC340 SP is
able to be maintained at a value that safely sustains F-340’s operability, while minimizing its fuel
utilization and energy consumption. However, as reactor temperatures (e.g., EIT controller set￾points) are increased to maintain the desired conversion as the catalyst run continues, TC335 SP’s
increase, TC335 OPs increase, TV335B opens further and TV335A closes further. If and when
TC335 OP reaches a high clamp limit, or TV335B cannot open further, or TV335A cannot close
further, TC335 becomes wound-up high. R-302 EIT control then becomes wound-up high, and
R-302 EIT cannot be increased. However, if F-340’s COT (TC340 SP) is increased, E-304 and E-305
hot side (R-302 effluent) inlet temperatures increase, and the driving force for heat transfer in
each exchanger increases. Their cold side (R-302 feed) outlet temperatures increase, and because
R-302’s inlet temperature (TC335 PV) has increased, TC335 responds by decreasing its output to
open TV335A and close TV335B and thus moves away from a high limit clamp. Thus, TC335’s
wind-up status is reset to normal, and the R-302 EIT controller’s wind-up status is also reset to
normal.
A control strategy that manipulates F-340’s COT setpoint (TC340 SP) to maintain TV335A
and TV335B in controlling range will enable the R-302 EIT → TC335 cascade to operate effec￾tively as the catalyst run proceeds toward its end-of-run. Such a control strategy is presented in
Figure 4.11.
The strategy in Figure 4.11 features an E-304 and E-305 bypass valve position controller,
VTV335A, whose PV is the bypass valve position (% open), TV335A. The VTV335A setpoint
should in principle be as low as possible to minimize F-340 energy consumption, while still
providing TC335 enough controlling range to manage normal control disturbances without
saturating the bypass valve. VTV335A is a PID controller, and if TV335A (VTV335A’s PV input)
is increasing or above VTV335A SP, bypass valve TV335A is open too much, and F-340’s fuel
consumption can be reduced. To reduce VTV335A PV, VTV335A OP must decrease to decrease the
COT setpoint TC340 SP – thus, VTV335A control direction = Reverse. Since it is a primary whose
setpoint will almost never be changed, VTV335A is tuned for fast load response, and configured
with proportional on PV and SPInit = No.
VTV335A control actions have three distinct outcomes depending upon bypass valve TV335A’s
% opening relative to its minimum opening value, VTV335A SP – see Figure 4.12.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License4.3 Use of Process Analysis 173
TC335 OPCL
TC335 OPCH
TC335 OP = 100%
TC335 OP = 0%
1
2
TC335 OP full
control range 
TC335 OP allowable
control range
End-of-run
Start-of-run
VTV335A drives TC340 SP to
TC340 SP low clamp.
VTV335A is wound-up low
with TV335A >> VTV335A SP
As TV335A approaches VTV335A SP,
VTV335A starts to increase TC340 SP.
TC340 no longer wound-up low.
VTV335A no longer wound-up low
TC340
wound-up low
TC340
increasing
VTV335A continues to increase TC340 SP
to maintain TC335A ≈ VTV335A SP
with TC335 in controlling range →
TC335 OP < TC335 OPCH
Figure 4.12 E-304 and E-305 Bypass Valve Position Controller’s Control Actions
1. TV335A is far away from (well above) VTV335A SP (TC335 OP range 1 on Figure 4.12)
At the start-of-run, with conversion targets achievable at relatively lower reactor temperatures,
bypass valve TV335A is well above (open more than) VTV335A’s set point. When VTV335A
is commissioned, with control direction = Reverse, VTV335A OP will immediately decrease
to decrease TC340 SP and bring VTV335A PV down to its setpoint (min TV335A). However, a
TC340 SP low clamp, with a value equal to the PTS specified start of run value that minimizes
F-340 energy consumption and sustains safe F-340’s operations, does not allow VTV335A to
reduce COT any further, and VTV335A is and remains wound-up low (outcome throughout
range 1).
2. TV335A approaches VTV335A SP (TC335 OP transitions from OP range 1 → OP range 2 on
Figure 4.12)
As the catalyst run proceeds, eventually, the reactor EIT controller setpoint increases are
sufficient to drive TV335A close enough to VTV335A SP (via TC335 control adjustments) for
VTV335A to begin to slowly increase TC340 SP. TC340 and VTV335A are no longer wound up
low, and for the remainder of the catalyst run, TV335A ≈VTV335A SP.
3. TV335A maintained at VTV335A SP (TC335 OP range 2 in Figure 4.12)
VTV335A slowly and continuously increases F-340’s COT SP to maintain TV335A = VTV335A
SP and maintain TC335 OP in controlling range – with TC335 OP<TC335 OPCH. An operator
entered, offline specified TC340 SP high clamp prevents VTV335A from over-firing F-340.
Last Thoughts
On average, first-stage reactor temperatures are lower than second-stage reactor temperatures. It is
therefore very improbable that as the catalyst run proceeds, TC319 will become wound-up high, i.e.,
TV319A at a minimum allowable % open and/or TV319B at a maximum allowable % open, before
TC335 becomes wound-up high. If this were to become a more than infrequent occurrence, the
control strategy in Figure 4.11 would need to be modified so that both TC335 OP (i.e., TV335A)
and TC319 OP (i.e., TV319A) can be maintained in controlling range. The enhanced strategy would
be a conventional constraint control strategy with valve position controller VTV335A and a second Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License174 4 Process Analysis and Understanding
valve position controller, VTV319A, both outputting to a high signal selector, that would choose
one of the controller outputs (the bypass valve dynamically closest to its minimum opening or
dynamically farthest into violation) to send to TC340 SP. Conventional constraint control’s cascade
structures and design issues will be presented and discussed in Chapter 7.
4.3.5 Identifying CVs, MVs, and DVs for Light-ends Tower Product Quality Controls
This section’s focus is on two light-ends towers – a C3/C4 splitter and a propylene splitter, both
included in an oil refinery’s unsaturated light-ends section. The process configurations, including
instrumentation and basic regulatory control loops, for the C3/C4 splitter (T-465) and the propylene
splitter (T-466) are presented in Figure 4.13.
The regulatory control loops shown are normally specified by process designers, and documented
in the design team’s P&IDs. The discussion that follows is focused on T-465, how the basic regula￾tory controls in Figure 4.13 can be improved, and how the MVs and CVs in these enhanced T-465
control strategies span both towers. The section starts with an overview of the two tower’s role in
the unsaturated light-ends section.
Reactor effluent from conversion processes – FCC units, fluid and delayed cokers and hydro￾crackers, is separated into several boiling range sidestream products in a product fractionator.
The feed to the unsaturated light-ends section is primarily fractionator overhead liquid and vapor
products. In a series of light-ends towers, a number of lighter components are separated. In the
absorber/deethanizer (DeC2), the lead tower, the fractionator overhead is separated into a C2−
overhead product, and a C3+ bottoms product. After the removal of H2S, the DeC2’s C2− overhead
C3/C4
splitter
T
4
6
5
D-466
FC
473
LC
474
FC
470
TI
471
E-469
PC
470
E-468
TI
470
TI
472
TV471 Fractionator
TPA
FI
475
LC
470
Propylene
splitter
TC
471
T
4
6
6
LC
453
PC
436
FC
432
S
CW
FI
434
FV433
E-471
E-469
C-422
C3= product
C4
in C3
C3= product
purity
C3 product AI
466
C3 product spec
FC
474
AI
469
C4 product
C3
in C4
C4 product spec
C3= product spec
C4- from
debutanizer
overhead
C3=, C3, C4, C2
C3, C4
D-466
FC
433
PC
437
To FG
header
LC
450
PV437
AI
461
C3=, C2
FC
472
FV474
LV453
Figure 4.13 C3/C4 Splitter (T-465), Propylene Splitter (T-466) Configurations
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License4.3 Use of Process Analysis 175
product is sent to the fuel gas system. The DeC2’s C3+ bottoms product is routed to the debutanizer
(DeC4), where C4− overhead and C5+ bottoms products are separated. The DeC4’s C5+ bottoms
product is fed to the naphtha splitter, where an overhead product (a MOGAS blend stock) and
bottoms product (either a catalytic reformer feedstock or a MOGAS blend stock) are separated.
After the removal of H2S, the DeC4’s overhead C4− product is sent to the C3/C4 splitter, where
butane (C4) rich bottoms and propane (C3) rich overhead products are separated. The C3/C4 split￾ter’s bottoms, the butane product, is routed to tankage; it has a max C3 content specification. The
C3/C4 splitter’s propane (C3) rich overhead is the propylene splitter’s feed, where it is separated
into two other LPG products – an overhead propylene (C3=) product and a bottoms propane (C3)
product.
Referring to Figure 4.13, one C3/C4 Splitter (T-465) operating objective is to limit overhead C4
carryover to the Propylene Splitter (T-466). Because any C4 in T-466’s feed will be removed in the
C3 product (T-466 bottoms), adjustments in T-465 are required to meet a max C4 content limit in
T-466’s C3 product (the C4 in C3 product is measured, AI466). The second T-465 operating objec￾tive is to honor the max C3 content limit in its own bottoms C4 product (the C3 in C4 product is
measured, AI469). T-466’s operating objective is to meet the propylene product’s C3= purity spec￾ification (the C3 in C3= product is measured, AI461). The three quality measurements are used to
help satisfy each product’s specification. They are used initially by operators to guide their man￾ual adjustments to meet these specifications. However, if these measurements prove reliable, they
enable product specifications to be satisfied using closed-loop control.
Light-ends tower control strategy design features and issues are discussed in detail in Chapter
12, and in many specific examples included throughout this book. Therefore, the focus here is
instead on (i) the conventional advanced control application features that can be added to the basic
regulatory controls to more effectively maintain products on specification, and (ii) the pairing of
CVs and MVs, as these control strategy enhancements are designed.
Referring again to Figure 4.13, in both T-465 and T-466, bottoms inventory is managed via level
control – in both cases, bottoms product flows are manipulated. In both T-465 and T-466, manage￾ment of reflux drum inventory is also via level control – for T-465, the distillate flow is manipulated
while for T-466, the reflux flow is manipulated. Designers specify a reflux drum inventory man￾agement strategy based on reflux drum surge capacity, the distillate’s downstream destination, and
reflux and distillate flow rangeabilities. After a reflux drum level controller’s MV is specified, the
flow not chosen is an available degree of freedom to meet other control objectives, most promi￾nently, a product quality specification.6
For T-465, both reboiler duty (via TV471) and reflux flow (FC473 SP) are potential MVs to control
the C3 in C4 quality (AI469) at T-465 bottoms. In Figure 4.13, the design basis for controlling the C3
in C4 product is a basic regulatory control loop that maintains a stripping section (e.g., below the
feed tray) tray temperature (TC471 PV) at an offline specified tray temperature set point (TC471
SP) that infers the C3 content in the C4 product, by adjusting reboiler E-468 duty (via TV471).
The choice of reboiler duty, and not reflux flow, as the quality loop’s MV is a decision made by
designers. If observed control performance via reboiler duty adjustments is unsatisfactory, use of
reflux flow would be the first alternative MV considered. However, this basic operating change
requires discussions with process specialists and operations personnel. Plant tests may be required
to generate, collect, and analyze appropriate open-loop dynamic responses to help establish reflux
flow as an acceptable alternative MV. Closed loop testing and visible and/or calculated control per￾formance improvements may be necessary to justify the change. And ultimately, the final decision
must be approved by operations and process specialists.
6 Light-ends tower inventory controls are discussed in Sections 9.7.1 and 9.7.2, and in Sections 12.3 and 12.4.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License176 4 Process Analysis and Understanding
The tray temperature control strategy in Figure 4.13 that controls the C3 content in T-465’s
C4 product can be enhanced by adding the advanced regulatory control features included (in
Figure 4.8) for the virgin naphtha splitter in Section 4.3.3 – in this case, with no additional
investment:
● Reboiler (E-468) Duty Calculation and Control (see Section 3.7.1). The reboiler’s hot side inlet
(TI470) and outlet (TI472) temperatures, and flow rate (FI475) are all measured.
● Ratio Feed Rate Feedforward Control (see Section 3.4). Since feed rate (FC470) is controlled, either
FC470 SP (to minimize noise propagation to E-468 duty) or FC470 PV can be the ratio controller’s
wild flow input.
● Control of Pressure-Compensated Tray Temperature (see Section 3.7.3). Helpful if tower pressure
control (PC470) is poor or tower pressure is changed frequently.
● C3 in C4 Product Quality (AI469) PID or Model-based Control. This enhancement’s feasibility
depends upon the analyzer measurement’s reliability, the analyzer’s service factor, its sample
time, and the time between samples.
The C3 in C4 closed-loop control strategy, which includes pressure compensated tray tempera￾ture (TC471), feed rate feedforward (RC471), and reboiler duty (QC471) controls, is presented in
Figure 4.14.
Whether AC469 is a PID or model-based controller, the C3 in C4 measurement (AI469 PV)
is validated before its use in control, and the C3 in C4 controller is configured to reset the
pressure-compensated tray temperature controller’s set point, TC471 SP. With closed-loop
product quality control implemented as in Figure 4.14, pressure compensation of TC471 PV
provides feedforward corrections for tower pressure upsets and/or changes. With no pressure
FI
475
TI
470
TI
472
FC
470
TIV470
TIV472
FCG470
QC471
RC471
Dynamic
compensation
Validation
SP
SP
E-468 duty/
feed
E-468
Duty
Fract. TPA
flow to E-468
Fractionator TPA
bypassing E-468
TV471
TC471
SP
Pressure compensated
tray temperature
control
AI
AC469 AIV469 469
SP
Validation
Pressure
compensation
calculation
PC
470
TI
471
T-465 tray
temperature
T-285 Ovhd
TI471 pressure Comp
SP or
PV
T465
feed rate
SP or
PV
E-468 hot fluid
inlet temperature 
E-468 hot fluid
outIet temperature 
E-468 hot fluid
flow 
C3 in C4
Desired
C3 in C4
C3 in C4
control
Figure 4.14 C3 in C4 Closed-Loop Quality Control with Advanced Regulatory Controls
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License4.3 Use of Process Analysis 177
FC
470 RC473 FCG473
Dynamic
SP compensation
T-465
reflux/feed
ratio control
T-465
reflux flow
T-465
feed rate
SP or
PV
SP
Desired
C4 in C3
AI
466
T-466
C4 in C3
control
AC466 AIV466
SP Validation
T-466
C4 in C3
FC
473
T-465
reflux flow
Figure 4.15 Propylene Splitter T-466 Bottoms C4 in C3 Product Quality Control
compensation – if AC469 resets the uncompensated tray temperature controller, the AC469
feedback adjustments will correct for any pressure changes or upsets, but more slowly and with
more quality deviations. Note (in Figure 4.13) that E-468’s hot side flow is measured (FI471) but
is not controlled; thus, the heat duty controller QC471 in Figure 4.14 must be configured as a PID
controller.
Any C4 in T-465’s overhead product, routed to T-466 as feed, will be removed in the C3 product
(T-466 bottoms). There are no T-466 adjustments that can effectively impact the C4 impurity in
the C3 product. This means the C4 content of the C3 product must be controlled by adjustments in
T-465; T-465’s control adjustments must minimize the C4 content of its overhead product, T-466’s
feed stream. With T-465’s reboiler duty paired with its bottoms product’s C3 in C4 content, T-465’s
reflux flow (FC433) is an available degree of freedom that impacts its overhead product’s C4 content.
Thus, T-465 reflux rate adjustments impact T-465’s overhead C4 content, T-466’s feed, and ulti￾mately the C4 in C3 product quality (AI466). The C4 in C3 product control strategy, which includes
T-465 ratio feed rate feedforward control, is presented in Figure 4.15. As shown in Figure 4.15, for
a reflux flow MV, feed rate feedforward control is (RC473) reflux to feed ratio control.
Note: The C4 in C3 content (AI466 PV) response dynamics to T-465 reflux rate changes will be very
slow and have considerable deadtime. Therefore, AC466 configured as a PID controller will almost
certainly perform poorly, and a well-designed model-based controller will no doubt provide better
control performance.
Closing Remarks
Given the multivariable and interactive nature of the T-465 and T-466 unit configuration in
Figure 4.13, a more effective approach to satisfy all T-465 and T-466 control objectives would
be to utilize multivariable constraint control (i.e., DMC). Typically, the DMC controller’s scope
is chosen to be much wider than just these two towers – to include the FCC unit’s reactor,
regenerator, main fractionator, and the entire unsaturated light-ends section. However, this is a
resource-intensive task that must be justified by an estimate of the potential incentives to improve
control performance. If justified, it would almost certainly achieve unsaturated light-ends section
unit control objectives more effectively.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License178
5
Split Range Control
CHAPTER CONTENTS
5.1 Split Range Control Overview
5.2 Split Range Control Applications
5.2.1 Hot Oil Heater Feed Surge Drum Pressure Control
5.2.2 Reactor Feed Surge Drum Pressure Control
5.2.3 Alkylation Plant Iso-Stripper Tower Overhead Pressure Control
5.2.4 Propylene Splitter Differential Pressure Control
5.2.5 Catalytic Reformer Discharge Pressure/Treat Gas System Pressure Control
5.2.6 Tower Inlet Temperature Control
A split range controller maintains one control variable at its setpoint by manipulating two or more
manipulated variables, one at a time, in a predetermined order. In most (but not all) cases, the split
range controller outputs directly to final control elements, i.e., control valves.
We first describe the general features and cascade structure of split range controls. We then
present and discuss a number of process configurations whose operating objectives require split
range control and examine the control strategy designs that achieve these operating objectives.
5.1 Split Range Control Overview
As described above, the general structure of a split range controller with two MVs outputting
directly to two control valves appears in Figure 5.1. As shown, for this case, the controller
manipulates valve A when its control output is in its lower output range between 0% and 50% and
valve B when the control output is in its higher output range between 50% and 100%.
The four possible controller output characteristics for a split range controller manipulating two
control valves are shown in Figure 5.2. The following characteristics are common to all four cases:
● Only one valve is manipulated within the lower output range (0–50%), while the other valve is
manipulated in the higher output range (50–100%).
● Each valve goes from fully closed to fully open or fully open to fully closed as controller output
increases or decreases over either the lower or upper output range.
● With controller output below 50% and increasing, valve A is either driven fully closed or fully
open (at controller output = 50%) before the split range controller begins to adjust valve B
(at controller outputs >50%).
Practical Process Control Design with Industrial Applications, First Edition. Alan M. Kugelman.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License5.1 Split Range Control Overview 179
Figure 5.1 Split Range Controller Overview
Controller
MV1 MV2
OP = 0–50% OP = 50–100%
CV PV
CV SP
Valve A Valve B
50%
0%
Valve A
%
Open
Controller OP
0% 100%
0%
Valve B
%
Open
100% 100%
50%
0%
Valve A
%
Open
Controller OP
0% 100%
0%
Valve B
%
Open
100% 100%
50%
0%
Valve A
%
Open
Controller OP 
0% 100%
0%
Valve B
%
Open
100% 100%
50%
0%
Valve A
%
Open
Controller OP
(a) (b)
(c) (d)
0% 100%
0%
Valve B
%
Open
100% 100%
Figure 5.2 Split Range Controller Output Characteristics
● With controller output above 50% and decreasing, valve B is either driven fully closed or fully
open (at controller output = 50%) before the split range controller begins to adjust valve A
(at controller outputs <50%).
● Controller output = 50% is the “boundary” between upper and lower output ranges. This is not a
requirement, and if needed, the valves can be calibrated to have another output boundary value
(e.g., lower range = 0–25%, and upper range = 25–100%).
Notice there is no “overlap” at the lower/upper range boundary (50%) in Figure 5.2. For example,
in Figure 5.2a, with controller output increasing, valve B begins to open only after valve A is com￾pletely closed. This is also not a requirement and if needed, the valves can be calibrated so that there
is a small “overlap” at the boundary to help smooth transitions. In Figure 5.3, the controller output
characteristic illustrated in Figure 5.2a includes a small “overlap.” With the calibrated “overlap,”
as controller output increases, valve B begins to open (at controller output = 49%) before valve A
is completely closed (51%). As controller output decreases, valve A begins to open (at controller Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License180 5 Split Range Control
50%
0%
Valve A
%
Open
Controller OP 
0% 100%
0%
Valve B
%
Open
100% 100%
49% 51%
Figure 5.3 Split Range Controller Output
Characteristic in Figure 5.2a, with Overlap
output = 51%) before valve B is fully closed (at 49%). Note that for both valves, the rate of change of
valve position with respect to controller output is somewhat smaller at all controller output values.
Also, notice that the controller output characteristics in Figure 5.2 seem to indicate the valve
failure mode design (“air-to-open” or “air-to-close”). For example, in Figure 5.2a, the output char￾acteristic indicates valve A is an air-to-close valve (fail open) and valve B is an air-to-open valve
(fail closed). However, remember that controller outputs are generated as % open, and controller
outputs are sent to an analog output block whose configured output direction (Direct or Reverse)
handles the valve’s failure mode design.1 And if a PID, and the ultimate secondary, the split range
controller’s control direction is configured without considering either valve’s failure mode. Thus,
like any other controller, we assume the split range controller’s output is sent to an analog output
block, but in this case, the same controller output is sent to two analog output blocks, one each for
valves A and B. One analog output block’s output direction ensures that valve A closes (via calibra￾tion, for OP <50%), and the other’s output direction ensures valve B opens (via calibration, for OP
>50%) as controller output increases. We will include the relationship among controller direction,
output direction, and valve failure modes in many of the discussions that follow.
Design Notes and Features
1. Once the valve failure modes are specified and the output characteristic (Figure 5.2a–5.2d) is
set by valve calibration and analog block configuration, it is the process unit’s design and the
relationship among control and manipulated variables that establishes whether the controller’s
PV increases or decreases as the controller output increases. Ultimately, this determines whether
the split range controller’s control direction is configured to be Direct or Reverse. As explained
above, the analog output blocks make this task independent of each valve’s failure mode design.
2. Remember that the two control valves are manipulating two different MVs. If the control vari￾able’s dynamic response to changes in the MVs is visibly different, then tuning problems are
possible. However, when all the split range controller outputs are direct to valves, proper valve
sizing (process design) and subsequent calibration, in most cases, prevents tuning problems.
When one or more split range controller outputs are directed to a secondary controller’s set￾point, the secondary engineering ranges may be different. If so, the controller will have to handle
different manipulated variable/control variable process gains. At a minimum, the controller’s
proportional gain must be changed when the controller output crosses (in either direction) the
lower/upper output range boundary.
1 The relationship between a PID controller’s control direction, an output block’s output direction and a valve’s
failure mode was explained in Chapter 2, Section 2.4.3.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License5.2 Split Range Control Applications 181
3. In the split range control overview discussion presented above, the divide between the controller
output’s upper and lower output ranges was specified at an output equal to 50%. The upper and
lower ranges are determined by valve calibration and therefore the discussion above and those
to follow are valid for any specified upper and lower output range.
5.2 Split Range Control Applications
A number of applications that illustrate when split range control is implemented are now pre￾sented; they feature commonly encountered instances of pressure and temperature split range
control. Included are two cases in which dual acting valves can be alternatives to using split range
control.
5.2.1 Hot Oil Heater Feed Surge Drum Pressure Control
Two applications, in which a drum’s pressure is maintained at times by venting vapor, and at other
times by importing vapor to the drum are now presented.
Hot oil is circulated in a closed loop in order to provide heat input to process streams in several
heat exchangers. As shown in Figure 5.4, the circulating hot oil is returned to hot oil surge drum
D-151 before being routed back to the hot oil fired heater for reheat. Hot oil temperatures in the
circuit ensure there is always some vapor in the drum and thus pressure control is needed. Drum
D-151 pressure PI136 PV is maintained at target by split range controller PC136 (see Figure 5.5),
which preferentially manipulates N2 import flow via PV136A. If PV136A becomes completely
closed, and drum pressure increases further, drum pressure is controlled at target by venting gas
to the flare system via PV136B. When pressure falls, PV136B is closed first, and when PV136B
is completely closed, and drum pressure continues to decrease, PC136 manipulates (closes) N2
import flow via PV136A.
PC136’s split range output characteristic is shown in Figure 5.6. Increasing controller output
either closes the import valve (PV136A) or opens the vent to flare valve (PV136B). Thus, for PC136
OP to increase from left to right in Figure 5.6, PC136 PV must be increasing. With this output
Figure 5.4 HO Surge Drum Configuration
PI
136
N2
import
To
flare
Hot oil
surge drum
PV136A PV136B
Hot oil to
hot oil heater
Hot oil
return
LC
135
D
1
5
1
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License182 5 Split Range Control
PI
136
PV136A PV136B
PC136
0–50% 50–100%
To
flare
N2
import
Figure 5.5 HO Surge Drum Split Range Pressure
Control
100% 100%
50%
0%
PV136A
%
Open
PC136 OP
0% 100%
0%
PV136B
%
Open
N2
Import
Vent to
flare
If PC136 PV is increasing, then
PC136 O/P
Figure 5.6 PC136 Split Range Output Characteristic
characteristic, if pressure is increasing and/or is above set point, PC136 OP must increase to either
close the import valve (OP<50%) or open the vent to flare valve (OP>50%). This means PC136
has control direction = Direct.
Note: In Figure 5.6, PC136’s output characteristic corresponds to the characteristic in Figure 5.2a,
and in this configuration, both valves are fully closed at PC136 OP = 50%. In addition, this output
characteristic indicates the import valve is air-to-close (fail open) while the vent valve is air-to-open
(fail closed). Given each valve’s service, these failure modes are likely the preferred choices.
Remember, the DCS handles PV136A and PV136B failure modes and subsequent output signal
conditioning external to the PID output calculations. Controller outputs such as PC136 OP are gen￾erated as % open. As shown in Figure 5.7, PC136 OP is sent to two analog output blocks, PV136A
(in PC136 OP’s lower output range) and PV136B (in PC136 OP’s upper output range). Assuming
both valves are properly calibrated, the output block output directions ensure PC136’s output char￾acteristics presented in Figure 5.6 are realized: (i) for PC136 OP<50%, a PC136 OP decrease opens
PC136A and a PC136 OP increase closes PC136A and (ii) for PC136 OP>50%, a PC136 OP decrease
closes PC136B and a PC136 OP increase opens PC136B.
Important: PV136A is calibrated to move from full open to full closed as PC136 OP transitions from
0% → 50%, and PV136B is calibrated to move from full closed to full open as PC136 OP transitions
from 50% → 100%. These calibrations are equivalent to the following two analytical expressions:
PC136 OP 0–50%∶ PV136A = −2∗PC136 OP + 100% (5.1a)
PC136 OP 50–100%∶ PV136B = 2∗PC136 OP − 100% (5.1b)
We will now use Equations (5.1a) and (5.1b) to help understand how each AO block’s % output
value is converted to the field’s PV136A and PV126B valve positions, as shown in Figure 5.7.
The effects on both valves of an increase and decrease in PC136 OP, in PC136’s lower and upper
output ranges, are shown in Figure 5.7. For a change in PC136 OP from 10% → 20% (lower output Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License5.2 Split Range Control Applications 183
Reverse
Direct
Output
direction
Air-to-open
PC136
PID algo
OP (% open)
100-%OP
Air-to-close
PV136A
Input
connection
Output direction
Configuration:
Direct or reverse
Reverse
Direct
Output
direction
Air-to-open
100 - %OP
Air-to-close
PV136B
Input
connection
Output direction
Configuration:
Director reverse
PV136B
Control direction
reverse or direct
PC136 OP: 10% → 20%
PC136 OP: 40% → 30%
PC136 OP: 60% → 70%
PC136 OP: 90% → 90%
PC136
Lower output
range
0% → 50%
PC136
Upper output
range
50% → 100%
PC136 OP
OP: 90% → 80%
OP: 60% → 70%
PC136A
Output
connection
PV136A
I/P
PV136A
OP to field: 80% → 60%
OP to field: 20% → 40%
OP: 60% → 70%
OP: 90% → 80%
I/P
PV136B
PC136B
Output
connection
OP to field: 20% → 40%
OP to field: 80% → 60%
Calibration
Calibration
Figure 5.7 Split Range Controller PC136 Analog Output Block Configuration
range), air-to-close valve PV136A (output direction = reverse) AO block’s output moves from
90% → 80%. However, PC136A’s field calibration forces PC136A to span its full output range
(0–100%) for only PC136 OP’s lower output range (0–50%). Therefore, the calibrated output forces
the valve to close from 80% → 60% (by substituting 90% and 80% into Equation (5.1a)). Similarly,
for a change in PC136 OP from 60% → 70% (upper output range), air-to-open valve PV136B (output
direction = direct) AO block’s output moves from 60% → 70%. PC136B’s field calibration forces
PC136B to span its full output range (0–100%) for only PC136 OP’s upper output range (50–100%).
Therefore, the calibrated output forces the valve to open from 20% → 40% (by substituting 60% and
70% into Equation (5.1b). Results for a PC136 OP decrease (40% → 30%) in its lower output range
and a PC136 OP decrease (90% → 80%) in its upper output range are also presented in Figure 5.7.
Note: The dynamic response of pressure PI136 to changes in either valve position is similar. Assum￾ing the valves are sized properly, the same PC136 tuning constants can be used to manipulate
both valves.
5.2.2 Reactor Feed Surge Drum Pressure Control
It is very common to accumulate reactor feed in an upstream surge drum in order to meet changing
reactor feed rate requirements, and if necessary, allow multiple feed sources to be combined so
that the reactor feed is delivered as one process stream. As shown in Figure 5.8, reactor feed first
flows to feed drum D-305 before it flows to the reactor on level control. Feed drum D-305 pressure
PI336 is maintained at target by split range controller PC336 (see Figure 5.9), which preferentially
manipulates treat gas import flow via PV336A. If PV336A becomes completely closed and pressure
continues to increase, feed drum pressure is controlled by venting gas to the sour fuel gas system
via PV336B. When pressure falls, PV336B closes first, and if pressure continues to decrease, PC336
manipulates (increases) treat gas import via PV336A. PI336’s dynamic response to changes in either Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License184 5 Split Range Control
D-305
PI
336
Reactor
feed drum
To sour
fuel gas
system
Treat gas
import
Reactor feed
Reactor
feed
PV336A
PV336B
FC
356
LC
355
Figure 5.8 Feed Drum D-305 Configuration
PI
336
PV336A PV336B
PC336
0–50% 50–100%
To sour fuel
gas system
From treat
gas system
Figure 5.9 D-305 Split Range Pressure Control
50%
0%
100%
PV336A
%
open
PC336 O/P
0% 100%
0%
100%
PV336B
%
open
TG
import
Vent to
FG
If PC336 PV is increasing, then
PC336 O/P
Figure 5.10 PC336 Split Range Output
Characteristic
valve’s position is very similar, and with the valves sized properly, a single set of PC336 tuning
constants is sufficient to manipulate both valves.
The split range controller output characteristic of PC336 is shown in Figure 5.10. Similar to
PC136’s output characteristic in Figure 5.6, increasing controller output either closes the treat gas
import valve (PV336A) or opens the vent valve (PV336B). Thus, for PC336 OP to increase from left
to right in Figure 5.10 (treat gas import valve closes or vent gas valve opens), PC136 PV must be
increasing. With this output characteristic, if pressure is increasing and/or above set point, PC336
OP increases to close the import valve (OP<50%) or open the vent valve (OP>50%). Thus, PC336
has control direction = Direct. Note that PC336’s output characteristic in Figure 5.10 corresponds Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License5.2 Split Range Control Applications 185
Figure 5.11 PC336 Split Range Output
Characteristic with Overlap
50%
0%
100%
PV336A
%
open
0% 100%
0%
100%
PV336B
%
open
48% 52%
TG
import
Vent to
FG
PC336 O/P
If PC336 PV is increasing, then
PC336 O/P
to the characteristic in Figure 5.2a, and in this configuration, both valves are fully closed at PC336
OP = 50%.
As discussed in Section 5.1, the valves in split range service can be calibrated so that there is a
small “overlap” at the upper/lower output region boundary (50% in Figure 5.10) to help smooth
transitions. In Figure 5.11, the PC336 output characteristic includes a small “overlap.” With the
“overlap” calibrated, as PC336 OP increases, PV336B begins to open (at PC336 OP = 48%) before
PV336A is completely closed (52%). As PC336 OP decreases, PV336A begins to open (at PC336
OP = 52%) before PV336B is fully closed (at 48%).
Note that, like Figure 5.6 (for PC136), PC336’s output characteristic in Figure 5.10 implies the
import valve is air-to-close (fail open) and the vent valve is air-to-open (fail closed), failure modes
that are likely the preferred choices. As discussed earlier for PV136A/B, no matter the valve failure
modes, each valve’s analog output block’s output direction can be configured (see discussion of
Figure 5.7) to ensure the PC336 OP characteristics (with proper valve calibrations) in Figure 5.10
(or Figure 5.11) are attained.
5.2.3 Alkylation Plant Iso-Stripper Tower Overhead Pressure Control
Alkylation reactor effluent is fed to an Iso-Stripper where iC4 is removed overhead and recycled
to the alkylation feed section. Iso-Stripper bottoms flow to a debutanizer where nC4 is removed as
an overhead product, and via additional processing, the nC4 is converted to iC4. The debutanizer
bottoms is the alkylate product.
An Iso-Stripper’s (T-889) simplified overhead configuration is presented in Figure 5.12. T-889
overhead pressure PI863 is maintained at target by split range controller PC863 (see Figure 5.13),
which preferentially manipulates overhead condenser E-876 bypass flow via PV863A. As overhead
pressure increases, if PV863A becomes completely closed, PC863 opens and eventually manipu￾lates PV863B, venting vapor to the fuel gas system. When pressure falls, PV863B closes first, and
if PV863B closes completely and pressure continues to decrease, PC863 will open and eventually
manipulate E-876 bypass flow via PV863A.
PC863 PV’s dynamic response to changes in PV863A and PV863B may be somewhat different,
depending upon the effects of E-876 heat transfer dynamics and separator drum D-835 hold-up. If
so, a change in tuning parameters may be appropriate when PC863 transitions between its upper
and lower output ranges. Online testing, e.g., collecting PC863 PV response data vs changes in
each valve position, should indicate whether the response dynamics are close enough to indicate a
single set of tuning constants would provide satisfactory control performance. If a change in tuning
parameters appears to be appropriate, the split range control strategy must be enhanced to enable
a tuning parameter switch when PC863 transitions between its upper and lower output ranges.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License186 5 Split Range Control
D-835
T
8
8
9
From
alkyl
reactor iC4
recycle
To FG
PI system
863
PV863A
PV863B E-876
CW
Isostripper
Figure 5.12 Iso-Stripper Overhead Configuration
PI
863
PV863A PV863B
PC863
0–50% 50–100%
To FG
system
E-876
Bypass
Figure 5.13 PC893 Split Range Pressure Control
50%
0%
100%
PV836A
%
open
PC863 O/P
0% 100%
0%
100%
PV836B
%
open
E-876
Bypass
Vent
to FG
If PC863 PV is increasing, then
PC863 O/P
Figure 5.14 PC863 Split Range Controller Output
Characteristic
The PC863 split range controller’s output characteristic is shown in Figure 5.14. Increasing PC863
OP either opens the bypass valve (PV863A) or opens the vent valve (PV863B). Opening either valve
decreases pressure, and therefore, for PC863 OP to increase from left to right in Figure 5.14 (E-876
bypass valve opens for OP<50%, or vent gas valve opens for OP>50%), PC863 PV must be increas￾ing. With this output characteristic, if the pressure is increasing and/or above its set point, PC863
OP must increase to open E-876 bypass valve (OP<50%) or open the fuel gas vent valve (OP>50%).
Likewise, if the pressure is decreasing and/or below its set point, PC863 OP must decrease to
close the bypass valve (OP<50%) or close the vent valve (OP>50%). Thus, PC863 has control
direction = Direct.
Note that PC863’s output characteristic in Figure 5.14 corresponds to the characteristic in
Figure 5.2c, and in this configuration, both valves are full open at PC863 OP = 100%, and both Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License5.2 Split Range Control Applications 187
valves are fully closed at PC863 OP = 0%. And remember, earlier comments re/control direc￾tion, output direction, and valve failure mode also apply to PC863, PC863 OP, and A/O blocks
PV863A/B.
5.2.4 Propylene Splitter Differential Pressure Control
The next split range controller discussed is implemented in a more complex process configura￾tion, although the split range controller itself is no more complex than those already presented.
In Figure 5.15, the Propylene Splitter (T-230) and upstream Naphtha Splitter (T-228) are heat inte￾grated via shared heat exchanger E-216, e.g., E-216 is T-230’s reboiler, while it also condenses T-228
overhead vapor.
T-230 differential pressure (PDI230) is maintained at target by split range differential pressure
controller PDC230 (see Figure 5.16); it manipulates E-216’s feed valve PV230A and E-216 bypass
valve PV230B to route T-228 overhead vapor through and around E-216, T-230’s reboiler. This sets
vapor load in T-230, and thus its fractionation, and also sets E-216 duty. However, E-216 is also
condensing T-228 overhead vapor. Because E-216 duty is set externally, and independent of T-228’s
overhead condensing requirements, T-228’s supplemental condenser E-217 duty is manipulated by
PC
229
LC
238
FI
229
FC
228
T
2
2
8
PDV230B PDV230A
E-217
CW
Naphtha
splitter
FC
230
LC
238
T
2
3
0
PDI
230
FI
231
Propylene
splitter
D-215
E-216
Figure 5.15 Propylene Splitter Reboiler and Naphtha Splitter Condenser Heat Integration
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License188 5 Split Range Control
PDV230A PDV230B
E-216
Bypass flow
Flow to
E-216
PDI
230 PDC230
T-230
differential
pressure
SP
Desired
differential
pressure
0–50% 50–100%
Figure 5.16 PDC230 Split Range Differential Pressure Control
PDV230B
%
open
PDC230 O/P
PDV230A
%
open
50%
0%
0% 100%
0%
100% 100%
E-216 Feed
valve
E-216 Bypass
valve
If PDC230 PV is decreasing, then
PDC230 O/P
Figure 5.17 PDC230 Split Range
Controller Output Characteristic
T-228 overhead pressure controller PC229 to insure T-228’s total condensing duty is met. Although
this process design reduces capital investment costs, operational changes, and upsets in either
tower affects the other’s operations.
The PDC230 split range controller’s output characteristic is shown in Figure 5.17. A PDC230
OP increase either opens exchanger feed valve PV230A (OP<50%) or closes the bypass valve
PV230B (OP>50%); both increase E-216 duty and because T-230’s differential pressure PDC230
PV increases with increasing E-216 duty, PDC230 PV also increases. Therefore, for PDC230 OP
to increase from left to right in Figure 5.17 (E-216 feed valve opens if OP<50% or E-216 bypass
valve closes if OP>50%), E-216 duty and hence PDC230 PV must be decreasing. With this output
characteristic, if PDC230 PV is increasing and/or is above set point, PDC230 OP must decrease to
close exchanger feed valve PV230A (if OP<50%) or open bypass valve PV230B (if OP>50%) to
decrease E-216 duty and thus decrease differential pressure. Likewise, if PDC230 PV is decreasing
and/or is below set point, PDC230 OP must increase E-216 duty; hence, PDC230 OP must
increase to open PV230A (if OP<50%) or close PV230B (if OP>50%). Thus, PDC230 has control
direction = Reverse.
If desired, low E-216 bypass and high E-216 feed flow limitations can be enforced by using low
PDV230B and high PDV230A % open clamp limits. The PDV230A % open high limit is implemented
using an output high clamp on PDV230A. PDC230 does not go into wind-up when PDV230A Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License5.2 Split Range Control Applications 189
reaches its % open high limit as PDC230 OP is increasing. When PDC230 OP reaches the value
that clamps PDV230A at its high limit, PDC230 begins to adjust PDV230B (which starts at 100%
open) to allow PDC230 to satisfy its set point. Without the high PDV230A % open limit, PDV230A
is fully open when the switch to PDV230B takes place. Thus, the output high clamp on PDV230A
establishes the lower/upper output region transition point for PDC230 OP. This means PDV230B
must be calibrated over the high PDV230A clamped PDC230 OP value and PDC230 OP = 100%.
The low limit on PDV230B can be implemented via a PDC230 OP high or a PDV230B low output
clamp. However, in this case, PDC230 becomes wound-up high when PDC230 OP reaches its high
clamp limit, or when PDV230B % open reaches its low clamp limit. Figure 5.18 shows the PDC230
output characteristic for a case where PDV230B % open is clamped low, and PDV230A % open is
clamped high.
Notice that PDC230’s output characteristic in Figure 5.17 corresponds to the characteristic in
Figure 5.2b, and in this configuration: (i) one valve is fully open over the entire PDC230 OP range,
bypass valve PDV230B when OP<50%, and feed valve PDV230A when OP>50%, and (ii) both
valves are fully open at PDC230 OP = 50%. In contrast, in Figures 5.6 and 5.10 (which correspond
to the characteristic in Figure 5.2a): (i) one valve is fully closed over the entire controller output
range, and (ii) the two valves are never fully open at the same time, although both are fully closed
at OP = 50%. And in Figure 5.14, PC863’s output characteristic corresponds to the characteristic
in Figure 5.2c, and in this configuration, both valves are full open at PC863 OP = 100%, and both
valves are fully closed at PC863 OP = 0%.
Split range controllers with the characteristic illustrated in Figure 5.17 (e.g., Figure 5.2b) can
also be implemented using dual acting control valves. This approach is often the preferred alter￾native for this heat exchanger outlet/bypass valve configuration since it provides better regulation
of exchanger feed and bypass flows, and both valves are calibrated for the controller’s full output
range (0–100%). If PDC230 is implemented with dual acting valves, PDC230’s output characteris￾tic is as shown in Figure 5.19. When PDC230 OP is 0%, PDV230B is fully open, and PDV230A is
fully closed, i.e., all naphtha splitter (T-228) overhead vapor bypasses E-216, and E-216 duty is at a
minimum value. As PDC230 OP increases, PDV230B closes (bypass flow decreases), and PDV230A
opens (feed flow to E-216 increases) simultaneously. When PDC230 output reaches 100%, there is
maximum feed flow, and no bypass flow, and E-216 duty is at its maximum. Hence, with both
valves manipulated over the entire PDC230 OP’s range, this is the same “end game” that results
when PDC230 is a split range controller (compare Figure 5.17 to Figure 5.19).
PDV230B
%
open
PDC230 OP
PDV230A
%
open
0%
0% 100%
0%
100% 100%
Min
PDV230B
Bypass
valve
Feed
valve
Max
PDV230A
Max
PDC230 OP If PDC230 PV is decreasing, then
PDC230 OP
Lower OP
range
Upper OP
range
Figure 5.18 PDC230 Split Range Controller Output Characteristic with Valve High/Low Limits
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License190 5 Split Range Control
0%
100%
0%
100%
PDV230B
%
open
0% PDC230 OP 100%
E-216 feed
valve
PDV230A
%
open E-216 bypass
valve
If PDC230 PV is decreasing, then
PDC230 O/P
Figure 5.19 PDC230 Dual Acting Valve Control Output Characteristic
0%
100%
0% 100%
0%
100%
PDC230 OP
Feed
valve
Bypass
valve
PDV230B
%
open
PDV230A
%
open
Max
PDV230A
% open PDC230 OP
@Max PDV230A
Min
PDV230B
% open PDC230 OP
@ Min PDV230B
If PDC230 PV is decreasing, then
PDC230 O/P
Figure 5.20 PDC230 Dual Acting Valve Control Output Characteristic with Valve High/Low Limits
High and low limits on E-216 bypass and feed flows can also be enforced if dual acting valves are
used (see Figure 5.20). A high limit on PDV230A and/or a low limit on PDV230B % open can be
implemented using PDV230A high and/or PDV230B low output clamps. If either a low PDV230B
% open or a high PDV230A % open clamp limit becomes active, the unconstrained valve is manipu￾lated to maintain PDC230 at set point. If PDC230 OP becomes limited by the remaining valve’s high
or low output limit, then PDV230A and PV230B are at their % open high/low limits, and PCD230
becomes output indisposable, e.g., its wind-up status is HighLow. In Figure 5.20, PDV230B’s low %
open limit is reached first; however, whether PDV230A or PDV230B becomes limited first depends
upon their actual valve characteristics and the min/max output clamp limit choices.
5.2.5 Catalytic Reformer Discharge Pressure/Treat Gas System Pressure Control
Hydrofining reactions take place in the presence of a large excess of H2 rich treat gas. The excess
treat gas is typically recycled to reactor inlet, but H2 rich make-up gas is required to replace the H2
consumed in the hydrofiner desulfurization reactions so that the treat gas H2 purity is maintained Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License5.2 Split Range Control Applications 191
C-102
D
1
4
3 Off gas to
reformer
reactors
Reformate
from last
reformer
reactor
To flare
system
PI
106
PV106C PV106A
To fuel gas
system
Off gas to
treat gas
header
PV106B
Recycle gas
compressor
Reformer
separator
drum
Reformate
to stabilizer
Figure 5.21 Catalytic Reformer Recycle Gas Compressor Configuration
PV106A PV106B PV106C
PC106
0–25% 25–50% 50–100%
Desired discharge
pressure
SP
To flare
system
To
fuel
gas
To
fuel
gas
PI
106
Figure 5.22 Reformer Discharge Pressure Split Range Control
at its desired target. The primary source of hydrofiner make-up gas is catalytic reformer off gas not
recycled back to the reformer reactors (see Figure 5.21).
Reformer separator drum (D-143) pressure (PI106) is maintained at target by split range con￾troller PC106 (see Figure 5.22), which preferentially manipulates gas vented to the fuel gas system
via small vent valve PV106A. When PV106A becomes fully open, and drum pressure continues
to increase, D-143 pressure is controlled by venting gas to the fuel gas system via large vent valve
PV106B. If pressure continues to increase and if PV106B goes fully open, PC106 manipulates the
gas flow vented to flare via vent to flare valve PV106C. When discharge pressure decreases, PC106
first reduces gas vented to flare until PV106C is fully closed. Then, it controls pressure by manip￾ulating the flow of gas vented to the fuel gas system via PV106B; when PV106B is fully closed, the
flow of gas vented to the fuel gas system via PV106A is manipulated.
PC106’s split range output characteristic is shown in Figure 5.23. Increasing PC106’s output first
opens small vent to fuel gas valve PV106A, then it opens large vent to fuel gas valve PV106B, and Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License192 5 Split Range Control
0%
100%
%
Open
PC106 O/P
25% 100%
0%
100%
PV106A
%
Open
50%
PV106B PV106C
0%
If PC106 PV is increasing, then
PC106 O/P
Figure 5.23 PC106 Split Range Controller Output Characteristic
last opens the vent to flare gas valve PV106C. Thus, for PC106 OP to increase from left to right in
Figure 5.23, separator drum pressure PC106 PV must be increasing. With this output characteristic,
if PC106 PV is increasing and/or is above set point, PC106 OP increasesto open PV106A (OP<25%),
or open PV106B (25%< OP<50%) or open the vent to flare gas valve (OP>50%). Likewise, if the
pressure is decreasing and/or is below set point PC106 OP must decrease to close the vent to flare
gas valve (OP>50%), or close the fuel gas valves PV106B (25%< OP<50%) or PV106A (OP<25%).
Thus, PC106 has control direction = Direct.
Remember: The DCS handles PV106A, PV106B, and PV106C failure modes and subsequent output
signal conditioning external to PC106’s PID output calculations. PC106’s output is generated as %
open, and PC106 OP is sent to three analog output blocks, PV106A, PV106B, and PV106C. The ana￾log output blocks’ output directions ensure that PC106’s output characteristics (with proper valve
calibrations) presented in Figure 15.23 are attained.
5.2.6 Tower Inlet Temperature Control
In Figure 5.24, tower T-112 inlet temperature (TI12) is maintained at target by split range controller
TC12 (see Figure 5.25), which adjusts preheat exchanger E-101A/B duty by manipulating the flow
TI
12
T
1
1
2
LC
15
E-101 A/B
TV12A
TV12B
Figure 5.24 Tower T-112 Feed Preheat
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License5.2 Split Range Control Applications 193
Figure 5.25 T-112 Inlet Temperature Split Range Control TI
12
TV12A
TV12B
TC12
E-101 A/B
bypass flow
Flow from
E-101 A/B
0–50% 50–100%
of feed to (TV12A) and around (TV12B) E-101A/B. TV12B (exchanger bypass flow) is initially fully
open and remains fully open as the T-112 feed temperature is controlled by manipulating TV12A
to vary the flow to exchangers E-101 A/B. This continues until TC12 opens TV12A fully. When
TV12A becomes fully open, and TC12 PV is still too low, T-112 inlet temperature is then controlled
by manipulating (decreasing) the feed bypass flow via TV12B (to increase E-101 A/B duties). When
inlet temperature increases, TC12 first increases the feed bypass flow until TV12B is fully open.
Then, TC12 controls temperature by manipulating the flow of feed to the exchanger via TV12A.
The TC12 split range controller’s output characteristic is shown in Figure 5.26. Increasing
TC12 OP either opens the exchanger’s feed flow valve (TV12A) while the exchanger’s bypass
valve (TV12B) is fully open (TC12 OP<50%) or closes TV12B while TV12A is full open (TC12
OP>50%). Opening TV12A and closing TV12B both increase TC12 PV. Thus, for TC12 OP to
increase from left to right in Figure 5.26, T-112 inlet temperature must be decreasing. If T-112 inlet
temperature is increasing and/or is above set point, TC12 OP must decrease to open the bypass
valve (OP>50%) with TV12A full open or close the exchanger’s feed flow valve (OP<50%) with
TV12B full open. Likewise, if T-112 inlet temperature is decreasing and/or is below set point,
TC12 OP must increase to close the bypass valve (OP>50%) with TV12A full open or open the
exchanger’s feed flow valve (OP<50%) with TV12B full open. Thus, TC12 should be configured
for control direction = Reverse.
If needed, a high flow limit on E-101 A/B feed and/or a low flow limit on E-101 A/B bypass flows
can be enforced with a high clamp limit on TV12A % open, and a low clamp limit on TV12B %
Figure 5.26 TC12 Split Range Controller
Output Characteristic
0%
100%
TV12A
%
open
0% 50% 100%
TC12 OP
0%
100%
TV12B
%
open
E-101 A/B
Feed valve
E-101 A/B
Bypass valve
If TC12 PV is decreasing, then
TC12 OP
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License194 5 Split Range Control
open. The TC12 split range controller output characteristic with valve high/low limits would be
analogous to the characteristic shown in Figure 5.18 for PDC230 in Section 5.2.4.
Also, like PDC230 discussed in Section 5.2.4, the TC12 valve characteristic in Figure 5.26 indicates
that: (i) one valve is fully open over the entire TC12 OP range, bypass valve TV12B in the lower
output range and feed valve TV12A in the upper output range, and (ii) both valves are fully open at
TC12 OP = 50%. Therefore, like PDC230, TC12 can also be implemented with dual acting valves,
which, for a heat exchanger outlet/bypass valve configuration such as in Figure 5.24, provides better
regulation of exchanger and bypass flows and is the preferred design approach. Both valves are
calibrated for the controller’s full output range (0–100%). TC12’s output characteristic would be
analogous to the characteristic shown in Figure 5.19 (without valve high/low % open limits) and
Figure 5.20 (feed valve high % open limit/bypass valve low % open limit) for PDC230.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License195
6
Override Control
CHAPTER CONTENTS
6.1 Override Control Overview
6.2 Override Control Applications
6.2.1 Fractionator Sidestream Stripper Bottoms Level Control Override
6.2.2 Crude Distillation Unit (CDU) Overhead Quality Control with High-Pressure Override
6.2.3 CDU Overhead Quality Control with Low-Level Override
6.3 From Override Control to Conventional Constraint Control
Override controls involve two control variables and one shared manipulated variable. When
operations are normal, one control variable (CV1) is maintained at setpoint by adjustments to the
shared manipulated variable (MV1); the other control variable (CV2) does not make changes to
MV1. CV2 can either be uncontrolled, or controlled by adjustments to a second manipulated vari￾able (MV2). If changing operations, process upsets, day/night variations, or controller rangeability
problems cause CV2 to approach a maximum or minimum allowable value (if CV2 is controlled,
MV2 has become limited), control of CV2 “overrides” control of CV1 and it begins to adjust MV1
to prevent a minimum or maximum CV2 limit violation. When operations become normal again,
CV2 moves away from its limiting value, control of CV1 “overrides” control of CV2, CV1 control
resumes with adjustments to MV1, and control of CV2 resumes with adjustments to MV2 as it
regains rangeability.
The general features and cascade structure of override control are described first. A number of
process configurations whose operating objectives require override control are then presented and
discussed, and the control strategy designs that achieve these operating objectives are examined.
6.1 Override Control Overview
Override control involves two control variables, each with a dedicated feedback controller (almost
always a PID), one shared manipulated variable and a selector block. There are two common control
scenarios that are managed using override controls. In both cases, the control strategy is a complex
cascade and logic/code must be provided to resolve and broadcast initialization/wind-up statuses
for both controllers. The first control scenario is shown in Figure 6.1.
During routine, normal operations (Figure 6.1), one control variable (CV1) is maintained at
its desired value (Controller A’s SP = CV1 SP) by adjusting one MV (MV1). The second control
Practical Process Control Design with Industrial Applications, First Edition. Alan M. Kugelman.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License196 6 Override Control
Selector
Controller A Controller B
SP = Max or min CV2
CV1 SP CV2 SP
PV CV
2
CV
1
PV
MV
1
MV
2
SP
SP
PV
Controller C
Normal control
Controllers A and C in control
 → CV1 PV ≈ CV1 SP using MV1
 → CV2 PV ≈ CV2 SP using MV2
Figure 6.1 Override Control Overview I: Normal Control
variable (CV2) is maintained at its desired value (Controller C’s SP = CV2 SP) by adjusting a
second manipulated variable (MV2). Both Controller A and Controller C are normal, regulatory
control loops with a dedicated CV – MV pairing. Controller B, on the other hand, is an override
controller that manipulates MV1 only when Controller C can no longer hold CV2 at its set point
and CV2 approaches its max or min value (Controller B’s set point). Custom logic/code must be
provided to ensure Controller B does not wind up, e.g., to ensure a valid Controller B output is
calculated during normal operations when the selector block chooses Controller A’s output. When
process conditions force Controller C into wind-up or into initialization, CV2 is uncontrolled, and
if it approaches (or violates) a limiting value (min or max allowable value), Controller B, whose
setpoint is CV2’s desired max or min value, overrides Controller A via the selector block and adjusts
MV1 SP to maintain CV2 at its min or max value. When the override is active (see Figure 6.2),
CV1 is uncontrolled, and its value varies with changing process conditions. Custom logic/
code must be provided to ensure Controller A does not wind up, e.g., to ensure a valid Controller
A output is calculated when the override is active, and the selector block chooses Controller
B’s output.
As operations become normal again, CV2 moves away from its limiting value, and Controller A
overrides Controller B via the selector block and once again can maintain CV1 at its setpoint
(CV1 SP). As CV2 approaches its normal operating window, Controller C again takes over control
of CV2 and maintains it at its desired value (CV2 SP) by adjusting MV2. The control strategy has
returned to the normal control cascade structure displayed in Figure 6.1.
The Selector block is either a high or a low selector. Whether it is a high or low selector depends
upon the CV2 – MV1 sensitivity, which is determined by the process configuration. If an increase
in MV1 drives CV2 away from violation, e.g., if CV2 SP is a max (min) limit, an increase in MV1
decreases (increases) CV2 PV, then the override strategy’s signal selector is a high signal selector
(HSS). Alternatively, if an increase in MV1 drives CV2 toward violation, e.g., if CV2 SP is a max
(min) limit, an increase in MV1 increases (decreases) CV2 PV, then the override strategy’s signal
selector is a low signal selector (LSS).
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License6.1 Override Control Overview 197
Selector
Controller A Controller B
SP = Max or min CV2
CV1 SP
Controller C
CV2 SP
PV CV
2
CV
1
PV
MV
1
MV
2
SP
SP
PV
Override active
MV2 becomes wound-up
CV2 PV approaches CV2 min/max value
Controller B overrides A to adjust MV1
→ CV2 PV ≈ Max or min CV2
CV1 PV uncontrolled, CV1 PV ≠ CV1 SP
Figure 6.2 Override Control Overview I: Override Active
Figure 6.3 Override Control Overview II:
Normal Control
Selector
Controller A Controller B
SP = Max or min CV2
CV1 SP
CV PV
1
MV
1
SP
CV
2
PV
Normal control
Controller A in control
→ CV1 PV ≈ CV1 SP using MV1
→ CV2 PV uncontrolled, but comfortably
 above/below min/max CV2
The second common override control scenario is illustrated in Figure 6.3. During routine,
normal operations, one control variable (CV1) is maintained at its desired value (Controller A’s
setpoint = CV1 SP) by adjusting MV1. The second control variable (CV2) is uncontrolled, and
its value varies with process conditions, comfortably above or below its minimum or maximum
allowable value. In this case, Controller A is a normal regulatory control loop with a dedicated
CV – MV pairing. Controller B is an override controller that manipulates MV1 only when CV2,
normally uncontrolled, approaches (or violates) its max or min limit value (Controller B’s set
point). Custom logic/code must be provided to ensure Controller B does not wind up, e.g., to Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License198 6 Override Control
Selector
Controller A Controller B
SP = Max or min CV2
CV1 SP
PV CV
2
CV
1
PV
MV
1
SP
Override active
CV2 PV approaches CV2 min or max value
Controller B overrides A to adjust MV1
→ CV2 PV ≈ Max or min CV2 using MV1
CV1 PV uncontrolled, CV1 PV ≠ CV1 SP
Figure 6.4 Override Control Overview II:
Override Active
ensure a valid Controller B output is calculated during normal operations, when the selector block
chooses Controller A’s output.
When process conditions force CV2 to approach a limiting value (e.g., min or max allowable
value – Controller B’s SP), Controller B overrides Controller A via the selector block, and Con￾troller B maintains CV2 at its min or max value (Controller B’s SP) by adjusting MV1 SP. CV1 is
now uncontrolled, and its value varies with changing process conditions (see Figure 6.4). Custom
logic/code must be provided to ensure Controller A does not wind up, e.g., to ensure a valid Con￾troller A output is calculated when the override is active, and the selector block chooses Controller
B’s output.
As operations become normal again and CV2 moves away from its limiting value, Controller A
overrides Controller B via the selector block and once again can maintain CV1 at its setpoint (CV1
SP) by adjusting MV1 SP. CV2 is again uncontrolled and varies with process conditions. The control
strategy has returned to the normal control cascade structure displayed in Figure 6.3.
6.2 Override Control Applications
Three fractionator distillate product back-end quality (e.g., 95% distillation point) control strategies
that include either a high overhead pressure or a low reflux drum level override are discussed.
Note: A very important control strategy that includes an override will be discussed in Chapter
10 (Heat Input/Heat Removal Controls). In Section 10.4.3, the COT basic regulatory control loop
(COT → Fuel Gas cascade) shown in Figure 10.26d includes a low fuel gas pressure override.
This override component is often included in fired heater firing control applications when the
fuel gas flow controller is the firing control cascade’s ultimate secondary – details are presented
in Sections 10.4.4–10.4.8.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License6.2 Override Control Applications 199
6.2.1 Fractionator Sidestream Stripper Bottoms Level Control Override
Figure 6.5 shows fractionator T-105, with a sidestream draw-off configuration typical of many
crude distillation units (e.g., CDU) and reaction system (e.g., FCCU) main fractionators. T-105’s
third sidestream product contains some low-boiling components which are stripped from the
sidestream product in steam stripper T-106; the recovered light components and steam are
returned to T-105 above the third SS draw-off tray as vapor. Although not shown, the second
sidestream is also stripped in a similar manner.
In normal operations, the second sidestream draw-off flow (FC60) is manipulated to meet a sec￾ond sidestream 95% endpoint specification. As FC60 changes, liquid loading below the second
sidestream draw-off tray, flow through LV75, and ultimately T106 sidestream stripper bottoms level
(LC75) are affected. LC75 maintains level by adjusting the third sidestream draw-off flow via valve
LV75. When LV75 approaches full open, and stripper level is decreasing or below setpoint, there is
not enough internal reflux below the second sidestream draw-off tray, i.e., FC60 is too large. This
adversely affects the fractionation between the two draw-offs, but even more importantly, it could
lead to a P-70 pump cavitation if T-106 bottoms level is lost.
Note: Assuming third sidestream flow (FC59 SP) is not an MV being used to control another
CV – for example, a third SS quality, the stripper level can be recovered by decreasing FC59 SP.
Although this will in most cases prevent pump P-70 cavitation, it has almost no effect on T-105’s
liquid loading, and hence fractionation between second and third sidestreams.
The control strategy design shown in Figure 6.6 protects against pump P-70 cavitation and avoids
situations in which low liquid loading between T-105’s second and third sidestreams adversely
affects fractionation. The principal component of this inventory control strategy is override con￾troller LC75L – its use is justified by avoidance of a pump P-70 cavitation, almost certainly more
important than control of the second SS 95% distillation point.
During routine, normal operations, LC75 PV is maintained at its desired value (LC75 SP) by
adjusting the third sidestream draw-off via LV75. The second sidestream’s quality is maintained
T
1
0
5
T
1
0
6
TV36
P-70
FV60
LV75
Pumparound return
To T-105
2nd
Sidestream
drawoff
3rd
Sidestream
drawoff End point
(95% Dist Pt)
2nd
Sidestream
drawoff
3rd
Sidestream
drawoff
FC
59
AI
36
FC
60
TC
60
LC
75
From 95% Pt
Quality control loop
P-50
E-18
P-60
Figure 6.5 Fractionator Sidestream Steam Stripper and Sidestream Flow Configuration
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License200 6 Override Control
FV60
From 2nd SS 95% Pt
Quality control loop
LV75
3rd SS
Drawoff
2nd SS
Drawoff
FC
60
LI
75
LC75L
SP
LSS
LC75
SP = Min
LC75 PV
SP = Desired
LC75 PV
Figure 6.6 Sidestream Steam Stripper Bottoms Level Control with Second Sidestream Quality Control
Override
at its desired value by adjusting the second sidestream draw-off flow (FC60 SP). When process
conditions force LC75 into wind-up (e.g., LV75 full open), LC75 is uncontrolled, and if LC75 PV’s
decrease persists, and it approaches its specified minimum allowable value (override level con￾troller LC75L SP), LC75L overrides the quality control loop and adjusts FC60 SP to control LI75 PV
at the desired minimum value. To provide an early warning for operators, a level low alarm (on
LC75 PV) would normally be issued; a level deviation (PV – SP) low alarm (too negative) may also
be issued. Standard DCS display features will indicate that LC75 is wound-up high and that LV75
is at its maximum opening. When the override is active, the second sidestream quality is uncon￾trolled, and its value varies with changing process conditions. Since an increase in FC60 drives
LC75 PV toward violation, e.g., LC75 is a min limit, and an increase in FC60 decreases LC75 PV,
the override strategy’s signal selector is an LSS.
As LC75L decreases FC60 SP to recover T-106 bottoms level, internal reflux above T-105’s third
sidestream draw-off tray begins to increase and move T-105’s operations closer to normal. As LI75
PV moves away from its minimum value, second-sidestream quality control overrides LC75L and
once again maintains second-sidestream quality at set point by manipulating FC60 SP. And as LI75
PV approaches its normal operating window, LC75 takes over control of LI75 PV and maintains it
at its desired value (LC75 SP) by once again adjusting LV75.
LC75 and LC75L are tuned for their individual manipulated variable dynamics – for LC75, LI75
PV’s response to LV75 changes, and for LC75L, LI75 PV’s response to FC60 changes. If LC75 is
decreasing and/or below set point, LC75 OP must increase (to open LV75); thus, LC75 is configured
with control direction = Reverse. If LC75L is decreasing and/or below set point, LC75L OP must
decrease (to reduce FC60 SP); thus, LC75L is configured with control direction = Direct.
Since the strategy in Figure 6.6 is a complex cascade, custom logic/code must be provided to
ensure (i) LC75L does not wind up during normal operations – a valid LC75L output is calculated
when the second SS 95% point quality control loop’s output is chosen by the selector block and
(ii) the second SS 95% point quality control loop’s output does not wind-up – a valid second SS 95%
point quality control loop output is calculated when the override is active, and the selector block
chooses LC75L’s output.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License6.2 Override Control Applications 201
6.2.2 Crude Distillation Unit (CDU) Overhead Quality Control with High-Pressure
Override
Another fractionator override strategy, a high-pressure override of a CDU overhead product quality
control loop, is now presented. The process configuration is displayed in Figure 6.7.
In Figure 6.7, CDU T-121 overhead vapor is partially condensed by heat exchange with crude (in
E-116), and with air in air fin trim cooler E-117. The liquid distillate (virgin naphtha) is collected
in reflux drum D-122; a portion is returned to T-121 as reflux (FI011), and the remainder is routed
to the recontacting drum via level controller LC012. The uncondensed overhead vapor leaving
D-122 is cooled, compressed, and also routed to the recontacting drum, where the liquid (catalytic
reforming feedstock, e.g., virgin naphtha) and crude gas products are separated. Overhead pressure
(PI026) is uncontrolled but must remain below an offline specified maximum allowable value. If
there is sufficient air fin cooling capacity (E-117), D-122 vapor temperature (TC022) is maintained
at its desired value (TC022 SP); overhead pressure then normally remains below its maximum
allowable value. E-117 cooling capacity is strongly influenced by anything that affects the amount
of overhead vapor – the ambient temperature has the most important impact. Thus, during day￾light hours, especially during summer, E-117 cooling capacity can become limited, and when it
does, overhead pressure will increase and can approach and exceed its maximum allowable value.
Naphtha yield is determined by meeting its endpoint (95% distillation point, AI601) target. CDU
overhead vapor temperature, TI021, is an excellent inferential indicator of the naphtha’s 95% point
and is normally controlled to maintain the desired 95% point target. TI021 is best maintained at its
desired target by manipulating the reflux return flow (FI011), e.g., via a TC021 → FC011 control cas￾cade. However, as shown in Figure 6.8, with an online naphtha 95% distillation point measurement
available (AI601), a more effective control strategy can be designed to control the 95% distillation
point.
The strategy is enhanced by the addition of a naphtha 95% point controller (AC601) resetting
TC021 and by including two feedforward corrections: pressure compensation of the overhead
FC
010
LC
012
FI
011
To
Recontacting
drum
FI
012
TI
021
AI
601
Naphtha
95% Pt
Crude
PI
026
TC
022 E-118 C-110 A E-119
T-121
FC
011
TC
021
T-121
feed
∞ ∞
E-117
D-122
E-116
Figure 6.7 CDU Overhead Configuration with Potential High-Pressure Override
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License202 6 Override Control
RC011 Reflux/feed
ratio
Reflux
rate
T-101 Reflux
flow
SP
SP
Overhead
temperature
Naphtha 95%
control AC601 AIV601
Desired
Naphtha 95% Pt
SP
Validation
Naphtha
95% Pt
TC021
Pressure compensated
Ovhd temperature
control
Overhead
pressure
FC
010
FI
011
FC011
FCG010
Dynamic
compensation
SP
FV011
Feed
rate
TI
021
AI
601
PI
126
Figure 6.8 CDU Overhead Product (Naphtha) 95% Distillation Point Control
temperature1 and reflux to feed (FC010) ratio control (RC011). With overhead pressure
uncontrolled, pressure compensation improves control performance by providing feedforward cor￾rections for pressure variations. Likewise, including RC011 improves control performance by pro￾viding feedforward compensation for changes in the (dynamically compensated) feed rate (FC010).
The overhead temperature is a high-level A/I, and thus, validation is not necessary. However, the
AI601 measurement must be validated (in AIV601) to improve the control cascade’s robustness.
Under normal operating conditions, the naphtha 95% point control cascade is commissioned,
and the naphtha 95% point is controlled at its target (AC601 SP) by manipulating the reflux flow
(FC011). However, when E-117 becomes capacity-limited, and overhead pressure starts rising and
approaching its maximum allowable value, a reflux rate increase is the most effective way to stop
the increase in pressure and avoid an overhead pressure maximum limit violation. Thus, to control,
and thus maintain overhead pressure below its maximum value when E-117’s duty is limited high,
a high-pressure override controller is needed to override the naphtha 95% point control cascade
and manipulate reflux flow. Such an override control strategy is presented in Figure 6.9.
There are several important design issues that must be resolved when the naphtha 95% point
control strategy in Figure 6.8 is combined with the override as shown in Figure 6.9. The product
quality control strategy will be discussed in detail in Chapter 13 (Fractionator Product Quality
Control) where primary fractionator product quality controls are explained. The focus here is on
how the override control strategy in Figure 6.9 responds to changes in overhead pressure. Max
overhead pressure override controller PC126 will override the naphtha 95% point control loop
when overhead pressure PI126 PV begins to approach its maximum allowable value, PC126 SP.
Normally, this will only occur when E-117 cooling capacity is limited, and D-122 vapor temperature
controller TC022 becomes wound-up high. While PC126 manipulates the reflux flow rate to avoid
a max pressure limit violation, the naphtha 95% point will be uncontrolled and float on tower
1 Discussed in Chapter 3, Section 3.7.3
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License6.2 Override Control Applications 203
RC011
Reflux
rate
T-101 Reflux
flow
SP
PI
126
Overhead
pressure
FI
011
FC011
HSS
PC126
Max Ovhd
pressure
SP SP
Naphtha 95% Pt
control loop
Max Ovhd
pressure
override
Figure 6.9 CDU Overhead Product (Naphtha) 95% Distillation Point Control with High-Pressure Override
operations. Since an increase in reflux flow drives PC126 PV away from violation, e.g., PC126 SP is a
max limit, and an increase in FC011 SP decreases PC126 PV, the override strategy’s signal selector is
an HSS.
When E-117 cooling capacity recovers, and TC022 is once again able to maintain D-122 vapor
temperature at target, pressure begins to decrease, the naphtha 95% point control loop will override
PC126 and naphtha quality will again be controlled by manipulating the reflux flow.
Since the override control strategy in Figure 6.9 is a complex cascade, custom code/logic must be
provided to ensure (i) PC126 does not wind up – a valid PC126 output is calculated during normal
operations, when the selector block chooses RC011’s output and (ii) RC011 does not wind-up – a
valid RC011 output is calculated when the override is active, and the selector block chooses PC126’s
output.
6.2.3 CDU Overhead Quality Control with Low-Level Override
The override application presented in this section is similar to the strategy discussed in the last
section – a CDU overhead quality control loop, with a reflux drum low level override instead of a
max pressure override. Figure 6.10 shows the overhead configuration of CDU T-132.
Overhead vapor is partially condensed by heat exchange with crude (in E-136), and with
air in air fin trim cooler E-137. Liquid distillate is collected in reflux drum D-138, and the
condensed liquid is returned to tower T-132 as external reflux (FC131). As in the last section,
the overhead temperature (TI131) is an excellent inferential indicator of the distillate prod￾uct’s quality – in this case, intermediate virgin naphtha (IVN) 95% distillation point (AI801).
Without the IVN 95% point measurement, overhead temperature is controlled by TC131
manipulating reflux flow FC131; TC131 SP is chosen to meet the desired IVN 95% point
target. However, with the IVN 95% point measurement (AI801 PV) available, a control strat￾egy identical to the strategy shown in Figure 6.8 maintains the IVN 95% point at target: an
AC801 → TC131 → RC131 → FC131 cascade. Since pressure is controlled tightly (see below), pres￾sure compensation of overhead temperature is not needed. However, feed rate feedforward control
(via reflux/feed ratio control, RC131) is included, as well as analyzer validity checks to enhance
robustness.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License204 6 Override Control
LC
FC 135
131
To fuel gas
system
TI
131
AI
801
IVN
95% Pt
Intermediate
virgin
naphtha (IVN)
Crude
PC
132 LC
136
LV135
T-132
∞
D-139
E-138 C-130 B
E-136 E-137
D-138
C-130 A
Figure 6.10 CDU Overhead Configuration with Potential Reflux Drum Low Level Override
Any liquid not returned to T-132 accumulates in D-138. Level controller LC135 maintains D-138
inventory by manipulating trim cooler E-137 duty (air louvers, LV135). Uncondensed overhead
vapor leaving D-138 is compressed and cooled, and routed to naphtha accumulator drum D-139
where the liquid (IVN) and vapor (fuel gas) are separated. Overhead pressure (PC132) is controlled
via compressor C-130A adjustments; D-139 level (LC136) is controlled via adjustments to IVN prod￾uct flow. When there is sufficient air fin (E-137) cooling capacity, D-138 liquid inventory (LC135
PV) is controlled at setpoint, safely above its minimum allowable value. Similar to the discussion in
the previous section, air fin trim cooler E-137 cooling capacity is strongly influenced by the ambient
temperature and thus during daytime, especially in summer, E-137 cooling capacity can become
limited. If so, LC135’s wind-up status is set to High, and with E-137 duty limited high and LC135
PV uncontrolled, drum inventory tends to fall, and LC135 PV may eventually approach a minimum
operating value.
Under normal operating conditions, the quality cascade is commissioned, and the IVN 95% point
is controlled at its target (AC801 SP) by manipulating the reflux flow (FC131 SP). When E-137
becomes capacity-limited high, and LC135 becomes wound-up high, D-138 inventory will tend to
decrease, and LC135 PV may approach its minimum operating value. Manipulation of the reflux
rate is the only practical way to avoid a level-low limit violation (and an empty drum and/or a pump
cavitation). Thus, to prevent a D-138 low level violation, avoid the potential loss of drum level, and
then maintain D-138 level safely above its minimum value, a low level override controller is needed
to override IVN 95% point control and manipulate reflux flow. Such an override control strategy is
presented in Figure 6.11.
The focus is again on the override portion of the control strategy in Figure 6.11 and defer
discussion of the quality control strategy to Chapter 13 where primary fractionator product
quality controls are discussed. Similar to the override strategy in Figure 6.9, the IVN quality
control cascade’s reflux/feed ratio controller (in this case, RC131) and the (low level) override
controller (in this case, LC135L) “compete” for the ultimate secondary (reflux flow, FC131).
LC135L will override the IVN 95% point control loop when level LC135 PV begins to approach its
minimum operating value (LC135L SP). This will eventually occur when E-137 cooling capacity
is limited, and LC135 cannot maintain D-138 level at setpoint.2 While LC135L manipulates
2 The more complete discussion of this override strategy in Chapter 13 (Section 13.3.5) points out that E-137’s
cooling capacity will almost certainly reach its high limit before LC135 PV approaches its low limit (LC135L SP).
Thus, LC135L’s override of IVN 95% point control is not activated until LC135 PV is approaching or even below its
minimum allowable value. This prolongs the “on” status of IVN 95% point control, and ensures LV135L will
eventually control D-138’s level at its minimum value, but LV135 PV is uncontrolled until it does.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License6.3 From Override Control to Conventional Constraint Control 205
T-132 Reflux
flow
SP
FC
131
E-137
LV135
Reflux drum
D-138
Level control
Overhead
condenser
LSS 
LC135L
Low LC135 PV
override control
Min
LC135 PV
SP SP
LC
135
LI135 PV RC131
SP
IVN 95% Pt
Control loop
LI
135
Desired 
LC135 PV
∞
Figure 6.11 CDU Overhead IVN 95% Point Control with Reflux Drum Low Level Override
reflux flow to recover level control, the IVN 95% point will be uncontrolled and float on tower
operations.
Since an increase in FC131 drives LC135 toward violation – LC135L SP is a min limit and an
increase in FC131 SP decreases LC135 PV, the override strategy’s signal selector is an LSS. To pro￾vide an early warning for operators, a level low alarm (on LC135 PV) would normally be issued; a
level deviation (PV–SP) low alarm (too negative) may also be issued. Standard DCS display features
will indicate that LC135 is wound-up high and that all air louvers are open and/or all fans are on
(LV135 is at its maximum).
When E-127 cooling capacity recovers, and LC135 is once again able to control D-138 level at
target by adjusting E-127’s air louvers, the IVN 95% point control loop will override LC135L, and
IVN quality will again be controlled by manipulating the reflux flow.
Since the override control strategy in Figure 6.11 is a complex cascade and “cascade rules” do
not apply, custom code/logic must be provided to ensure (i) LC135L does not wind-up – a valid
LC135L output is calculated during normal operations, when the selector block chooses RC131’s
output and (ii) RC131 does not wind-up – a valid RC131 output is calculated when the override is
active, and the selector block chooses LC135L’s output.
6.3 From Override Control to Conventional Constraint Control
In the next chapter, conventional constraint control strategies and common and important applica￾tions of this technology are presented and discussed. Constraint control applications drive multiple
CVs toward their minimum or maximum constraint limits by manipulating one MV. With only one
MV, just one CV – the active constraint, can be held at its constraint limit by manipulating the MV.
All other CVs are maintained above their minimum or below their maximum constraint limit. As
process conditions change, if another CV becomes closest to, or violates its constraint limit, an
active constraint switch occurs, and that CV becomes the active constraint.
In override control, during normal operations, one CV is maintained at its desired value
by manipulating one MV. Another CV is uncontrolled but is above its minimum or below its Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License206 6 Override Control
Active constraint = CV1
Controller A in control, using MV1
Controller A Controller B
PV CV
1
Selector
MV
1
SP
CV
2
PV
CV1 SP = 
Max or min CV1
CV2 SP = 
Max or min CV2
Figure 6.12 Constraint Control with CV1 the
Active Constraint, Adjusting MV1
maximum allowable value (Figure 6.3). When process conditions force the uncontrolled CV
to approach or violate a min or max allowable value, an override occurs, and the previously
uncontrolled CV is then in control and maintains its CV at its min or max value by adjusting the
MV (Figure 6.4). As operations return to normal, and the uncontrolled CV in normal operations
moves away from its limiting value, the CV in control during normal operations transitions back
to being in control (Figure 6.3).
To identify the important similarities and differences between override control and conventional
constraint control, a typical conventional constraint control strategy, with two CVs (CV1 and CV2)
and one MV (MV1), is presented in Figure 6.12 (CV1 is the active constraint) and Figure 6.13 (CV2
becomes the active constraint after an active constraint variable switch). Comparing Figure 6.3
(normal control) to Figure 6.12 (active constraint is CV1), and Figure 6.4 (override active)
to Figure 6.13 (active constraint is CV2), the constraint control and override control cascade
structures are identical – two primary controllers, each calculating and sending a desired MV1 SP
Active constraint = CV2
Controller B in control, using MV1
Controller A Controller B
PV CV
1
Selector
MV
1
SP
CV
2
PV
CV1 SP= 
Max or min CV1
CV2 SP= 
Max or min CV2
Figure 6.13 Constraint Control with CV2 the
Active Constraint, Adjusting MV1
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License6.3 From Override Control to Conventional Constraint Control 207
value to a signal selector, and the selector sending one of the two controller outputs to MV1 SP.
However, there is one very significant difference – in Figures 6.12 and 6.13, both CV1 and CV2 set
points (CV1 SP, CV2 SP) are max or min values of CV1 PV and CV 2 PV.
So, unlike the override control strategy in Figures 6.3 and 6.4, neither Controller A nor Controller
B in Figures 6.12 and 6.13 is expected to be in control, but both represent a normal operation, each
with a CV at its limiting value – Controller A in Figure 6.12 and Controller B in Figure 6.13. Either
CV1 PV or CV2 PV, whichever is closest to or is violating its min or max value, 3 is maintained at
its max or min value. In Figure 6.12, CV1 PV is maintained at its min or max limit by manipulating
MV1; CV1 is the active constraint variable. When operating conditions change, and CV2 moves
closest to or violates a max or min limit, an active constraint switch occurs – CV2 becomes the
active constraint, and as shown in Figure 6.13, Controller B maintains CV2 at its min or max limit
by manipulating MV1.
In summary, conventional constraint control strategies have the same cascade structure as the
common override control strategy presented in Figures 6.3 and 6.4. However, because their CV set
point value mix is different, constraint control and override control strategies have very different
control objectives. Despite this, Chapter 7 will show that the design of conventional constraint
control strategies follows directly from the override strategies discussed in this chapter, and they
present similar design and implementation issues.
3 The closeness to a min/max constraint limit is based on the magnitudes of the controller outputs sent to the signal
selector. Therefore, as emphasized in Chapter 7 (Conventional Constraint Control), the closeness judgement is
made dynamically, as each controller responds to process upsets, and/or adjustments made to the single MV.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License208
7
Conventional Constraint Control
CHAPTER CONTENTS
7.1 DMC’s Role in Multivariable Constraint Control
7.2 Introduction to Conventional Constraint Control
7.3 Natural Draft Heater Combustion Control via Conventional Constraint Control
7.3.1 CVs, the MV, and CV–MV Relationships
7.3.2 CV Controller Output – MV Relationships
7.3.3 Choosing the Controller Output and the Active Constraint Variable
7.3.4 Signal Selector Configuration
7.4 Maximizing Heat Recovery
7.4.1 CVs, the MV, and CV–MV Relationships
7.4.2 CV Controller Output – MV Relationships
7.4.3 Choosing the Controller Output and the Active Constraint Variable
7.4.4 Signal Selector Configuration
7.5 Conventional Constraint Control Cascade Structure
7.6 Alternate Signal Selector Locations in Constraint Control Designs
7.7 Active Constraint Variable Switches
7.8 Constraint Control Design Issues
Real-world process operations are nonlinear, multivariable, and dynamically interactive. Despite
real-world nonlinearities, the linear control theory underlying the feedback and feedforward con￾trol essentials presented and discussed in Chapters 2 and 3, respectively, have been and will con￾tinue to be used extensively in the successful implementation of basic regulatory control, and as
is illustrated in the numerous examples presented in this book, in advanced regulatory control
and conventional advanced control applications. In many situations, process nonlinearities present
operational problems that do not have a clear cause and effect, i.e., they are indistinguishable from
other random issues that may be degrading control performance. Although there is cutting-edge
nonlinear control technology available today (with more to follow), in most cases, nonlinearities
are ignored in today’s real-world approach to process control.
On the other hand, it is obvious that real-time plant operations are multivariable and dynami￾cally interactive – many dependent variables (potential CVs), are affected by several independent
variables (e.g., potential MVs and DVs), and many potential MVs and DVs affect several CVs.
For example, in a light-ends tower, reboiler duty adjustments can impact both the distillate and
bottoms product qualities, and both reboiler duty and reflux flow rate can affect the distillate
Practical Process Control Design with Industrial Applications, First Edition. Alan M. Kugelman.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License7.1 DMC’s Role in Multivariable Constraint Control 209
product quality.1 And depending upon the process configuration, the dynamics of a CV’s response
to changes in different MVs and DVs can be noticeably different. For example, the dynamic
response of distillate product quality to a change in tower feed rate will be slower than its response
to either a condenser duty upset or a reflux flow rate change.
In many cases, good process analysis and proper CV–MV pairing can attenuate, but not eliminate,
these dynamic response problems. Good PID tuning, effective feedforward control for important
upsets, and efficient use of multiple input, single output model-based control all help improve con￾trol performance or limit control performance degradation. Therefore, in many cases, dynamic
interactions and the multivariable environment can be managed with conventional approaches.
However, when dynamic interactions and the multivariable environment cannot be managed with
conventional control methods, multivariable control, implemented using DMC, is without ques￾tion the preferred control technology to drive multiple CVs to their operating targets and/or to
their limiting constraints by adjusting multiple MVs simultaneously.
7.1 DMC’s Role in Multivariable Constraint Control
Conventional constraint control drives multiple CVs toward minimum or maximum allowable
constraint limits by manipulating one MV. With one MV, only one CV is held at a constraint
limit, while all other CVs are maintained above their minimum or below their maximum
allowable value. This control strategy is well suited to handle small-scale control problems
using conventional PID controllers (and, on occasion, single input-single output model-based
controllers). However, its use has a critically important requirement: operating and control
objectives must be achieved by manipulating only one independent variable, i.e., there can only
be one MV.
In contrast, DMC drives multiple CVs to their operating targets and/or to their limiting con￾straints by adjusting multiple MVs simultaneously. The DMC model incorporates all dynamic
interactions and process sensitivities (steady state gains) among the CVs, MVs, and DVs in
the controller’s scope. Operator and engineer entered MV and CV high and low constraint
limits define the feasible operating region for constraint management. The DMC control cal￾culation contains a steady-state LP/QP solution algorithm and a dynamic move calculation.
The LP/QP solution determines the “best” steady state solution at the end of a specified
time horizon – the process’ time to steady state (TTSS). The dynamic move calculation deter￾mines the time-dependent MV moves over the time horizon (e.g., the TTSS) that minimize
CV deviations from the steady state targets calculated by the LP/QP. DMC-specific tuning
parameters are engineer specified, and impact both the LP/QP solution and the move calcu￾lation. Their values are determined offline using DMC’s user-friendly interface to its realistic
offline simulation environment. Tuning parameters are chosen to prioritize control objec￾tives, drive solutions to desired operating points, achieve economic objectives, limit how
fast MVs can move, and determine how tightly CVs are held within a desired range or at a
setpoint.
In short, DMC is a very powerful cutting-edge control technology that uses proven technology
and well-understood and field-tested software tools to achieve multiple operating and control objec￾tives for very large multivariable control problems. It is truly a multivariable control technology,
managing the responses of multiple dependent variables (CVs) to changes in multiple independent
variables (MVs and DVs).
1 Distillation tower product quality controls are presented and discussed in Chapter 12.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License210 7 Conventional Constraint Control
7.2 Introduction to Conventional Constraint Control
DMC always adds value when used properly, but there are still incentives associated with
small-scale constraint control applications that can be implemented relatively quickly using con￾ventional technology. These applications drive multiple CVs toward their minimum or maximum
constraint limits by manipulating one MV. With only one MV, just one CV – the active constraint,
can be held at its constraint limit. All other CVs are maintained in a “not violated state,” e.g., above
minimum, or below maximum constraint limits. If process conditions change, and a different
CV becomes closest or is about to violate or has already violated its constraint limit, the active
constraint switches.
Conventional constraint control was often implemented successfully before the introduction and
widespread penetration of DMC technology. In many cases over the years, the control objectives
achieved by these heritage constraint control applications were absorbed into a new DMC con￾troller’s wider scope. However, the discussion of conventional constraint control presented in this
chapter has both historical significance and relevance to today’s control world. The technology is
proven, and many such applications are still in use. When a small-scale constraint controller is jus￾tified, and most importantly, when adjustments to only one MV can achieve the control objectives,
this technology is still profitably implemented today.
This discussion of conventional constraint control uses two important and widely implemented
control application examples to introduce the characteristics and attributes of conventional con￾straint control strategies. The first control application is a natural draft heater combustion control
strategy that holds either stack excess O2 at its minimum constraint limit or firebox pressure at its
maximum constraint limit, while maintaining the other CV out of violation. The second application
maximizes the heat recovered to a specific process stream (e.g., crude feed), subject to maximum
and/or minimum constraint limits on other heat balance-related process variables (e.g., measured
temperatures). Based on these two applications, the underlying features of conventional constraint
control are identified, and its standard cascade structure is discussed. This will confirm the impor￾tant similarities and differences between conventional constraint control and override control iden￾tified at the conclusion of Chapter 6.
The important function of the control cascade’s signal selector is explained – at each time step,
it chooses the active constraint variable when it sends that CV’s controller output to the selector’s
secondary, the MV. It is shown that by varying the signal selector’s location in the constraint control
cascade, alternative, and equally effective constraint control designs are enabled. How a process
upset or operational change that has an unequal effect on CVs causes an active constraint variable
switch is illustrated. Design issues common to all conventional constraint control applications are
identified, and their management is described.
7.3 Natural Draft Heater Combustion Control via Conventional
Constraint Control
Natural draft heater combustion control is the most important and widely implemented con￾ventional constraint control application in present-day petrochemical operations. Along with
other heater combustion control strategies, a natural draft heater combustion control’s cascade
structure is presented and discussed in detail in Chapter 11 – see Figure 11.16 in Section 11.2.2.
The strategy’s design features are presented there, with a focus on its impact on heater operations
and its interactions with other heater control strategies. In this section, the focus is not on the
finer points of combustion control but rather on the control objectives, and design features Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License7.3 Natural Draft Heater Combustion Control via Conventional Constraint Control 211
Figure 7.1 Natural Draft Heater Combustion
Control
FI
211
Fuel
flow
AI
201
Stack
oxygen PI
236
Firebox
pressure
Combustion
air
Stack
damper
AIV201 AC201 PC236
Validation
SP
Minimum
stack O2
SP
Max firebox
pressure
Stack
damper
M201
M201
Signal
selector
common to all conventional constraint control strategies. Natural draft heater combustion control,
a well-understood and relatively simple control strategy, is used as a basis for this discussion. The
strategy presented in Figure 7.1 is used for this purpose.
Referring to Figure 7.1, the natural draft heater combustion controls include firebox pressure
control (PC236) and if a reliable online O2 measurement is available, stack excess O2 control
(AC201). The MV, the damper position M201, affects both AC201 PV and PC236 PV. When the
damper closes (damper position decreases), AC201 PV decreases and PC236 PV increases. When
the damper opens (damper position increases), AC201 PV increases, and PC236 PV decreases.
AC201 and PC236 are standard PID controllers, and the excess O2 measurement AI201 PV is
validated (in AIV201) before it is used in control. Given the relationship between AC201 PV and
damper position M201, AC201 must be configured with control direction = Reverse, i.e., if AC201
PV is increasing and/or is above its setpoint, AC201 must close the damper, and thus AC201 OP
must decrease. Using similar reasoning, PC236 must be configured for control direction = Direct,
i.e., if PC236 PV is increasing and/or is above its setpoint, PC236 must open the damper, and thus
PC236 OP must increase. Although there are two CVs – excess O2 and firebox pressure, there is
only one MV (M201) available for control. With only one MV, the conventional constraint control
strategy in Figure 7.1 can only maintain one CV, either excess O2 or firebox pressure, at its setpoint.
There are important heater operating constraints associated with both CVs that must be man￾aged by the combustion controls. High and low stack excess O2 must be avoided – high stack O2
is inefficient and wastes fuel while low (the more important constraint) stack O2 operations can Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License212 7 Conventional Constraint Control
lead to inefficient operations, incomplete combustion, and in some cases, a dangerous operating
condition – heater flood. High and low firebox pressures also must be avoided – high (the more
important constraint) firebox pressure is dangerous because it can cause the escape of hot combus￾tion gases, while low firebox pressure is inefficient because air leakage into the firebox can increase.
For the combustion controls in Figure 7.1, the O2 controller’s setpoint, AC201 SP, is the minimum
desired stack excess O2, the more important of the two (max/min) O2 constraints. Likewise, the
firebox pressure’s setpoint, PC236 SP, is the maximum desired firebox pressure, the more important
of the two (max/min) firebox pressure constraints. With both controller setpoints equal to a desired
max/min constraint limit, the constraint control strategy in Figure 7.1 maintains either excess O2
or firebox pressure at a desired constraint limit, while maintaining the other CV out of violation.2
Note: Draft pressure, the difference between firebox pressure and atmospheric pressure, PA, e.g.,
[PC236 PV–PA], can be a combustion control CV instead of firebox pressure – combustion controls
are effectively implemented with either. However, draft pressures are negative – in fact, a positive
draft pressure is a safety issue. To avoid confusion over correctly specifying the max/min, high/low,
and increase/decrease of a negative PV, for this discussion of constraint control, the combustion
control strategy design in Figure 7.1 includes firebox pressure control.
With one MV available – the stack damper position (M201), only one controller output can reset
the damper position. That is why both controller outputs, AC201 OP and PC236 OP, are sent to
the Signal Selector as inputs. The signal selector’s task is to decide which output it should send
to its secondary – the damper position. The signal selector’s functionality is based on the CV–MV
process relationships and the magnitudes and physical interpretation of the two controller outputs.
The constraint variable whose controller output is sent to the damper by the signal selector is the
CV being held at or closest to its constraint limit. It determines the MV’s value, in this case the
damper position, and is called the active constraint or active constraint variable.
7.3.1 CVs, the MV, and CV–MV Relationships
As is required by conventional constraint control, one MV – stack damper M201, affects both con￾straint variables – stack excess O2 (AC201 PV) and firebox pressure (PC236 PV). Increasing the
damper position M201 (damper opens further) increases AC201 PV and decreases PC236 PV, while
decreasing M201 (the damper closes further) decreases AC201 PV and increases PC236 PV. Thus,
closing the damper (MV decrease) decreases excess O2 and drives it toward violation (it has a min￾imum constraint), while firebox pressure increases and is also driven toward violation (it has a
maximum constraint). On the other hand, opening the damper (MV increase) increases excess O2
and drives it away from violation, while firebox pressure decreases and is also driven away from
violation. Table 7.1 summarizes these relationships for future reference.
Two essential properties of the natural draft heater’s CV–MV relationships that are central to this
constraint controller’s ability to achieve its control objective are revealed in Table 7.1: (i) when the
MV (damper position M201) decreases (closes further), both CVs are driven toward violation and
(ii) when the MV increases (opens further), both CVs are driven away from violation.
7.3.2 CV Controller Output – MV Relationships
How does the signal selector decide which controller output it should send to the damper?
Remember that both PID controller outputs are calculated as damper % opening. Therefore, an
2 This re-enforces the override control – constraint control comparison made at the conclusion of Chapter 6.
Although the cascade structure of the combustion control strategy in Figure 7.1 is identical to the override control
strategy in Figure 6.3, instead of one CV in control during normal operations, either constraint variable’s CV can be
in control, maintained at its limiting constraint, during normal operations.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License7.3 Natural Draft Heater Combustion Control via Conventional Constraint Control 213
Table 7.1 Natural Draft Heater CV–MV Relationships
CV CV Type
When MV
Increases
When MV
Decreases
When MV
Increases
When MV
Decreases
AC201 PV Minimum CV increases CV decreases CV moves away
from violation
CV moves
toward violation
PC236 PV Maximum CV decreases CV increases CV moves away
from violation
CV moves
toward violation
AC201 OP = 60% means AC201 wants the damper position to be 60% open to achieve its control
objective (drive/maintain AC201 PV toward/at AC201 SP). Likewise, a PC236 OP = 25% means
PC236 wants the damper position to be 25% open to achieve its control objective (drive/maintain
PC236 PV toward/at PC236 SP). Given the two CVs (AC201 PV and PC236 PV) and their two
statuses (in violation or not in violation, i.e., normal), the selector must assess one of four possible
CV-Status combinations each time it makes a controller output decision. These four possible
CV-Status combinations are summarized below, and are shown graphically in Figure 7.2a through
Figure 7.2d:
● Both AC201 PV and PC236 PV are normal – no constraint limit violations. See Figure 7.2a.
● Both AC201 PV and PC236 PV are in violation of their constraint limits. See Figure 7.2b.
● AC201 PV is in violation of its constraint limit, PC236 PV is normal. See Figure 7.2c.
● PC236 PV is in violation of its constraint limit, AC201 PV is normal. See Figure 7.2d.
The information in Table 7.1 can be used to establish whether AC201 OP and PC236 OP increase
or decrease for each CV-Status combination illustrated in Figure 7.2a–7.2d. For example, in
Figure 7.2a, both CVs are normal – AC201 should decrease AC201 PV to drive it closer to its
desired minimum (AC201 SP) and PC236 should increase PC236 PV to drive it closer to its desired
maximum (PC236 SP). From Table 7.1, both AC201 and PC236 should close the damper (AC201
OP and PC236 OP both decrease) to decrease AC201 PV and increase PC236 PV respectively. The
information contained in Table 7.1 is applied to each of the CV-Status combinations in Figure 7.2
and is summarized in Table 7.2.
In Figure 7.2a (Status 1), both CVs are normal – there are no constraint limit violations. For
either CV, its controller’s output will decrease to close the damper further. In Figure 7.2b (Status
2) both CVs are in violation, and for either CV, its controller’s output will increase to open the
damper further. In Figures 7.2c and 7.2d (Status 3 and Status 4), one CV is in violation, and the
other is normal. When either CV is in violation, that CV controller’s output will increase to open
the damper further. When either CV is normal, that CV controller’s output will decrease to close
the damper further.
To help explain the combustion control strategy’s signal selector’s functionality, a hypothetical,
numerical example is developed that illustrates how the strategy’s signal selector decides which CV
controller’s output, AC201 OP or PC236 OP, to send to the secondary. To begin the analysis, assume
that at the current time step, n, the secondary, damper position M201 is equal to 50%, although
the conclusions are independent of the assumed initial current damper position. Also, as will be
explained later in this chapter, one of the design features that must be included in all conventional
constraint control strategies is the reset of all nonactive constraint variable controller outputs to
the current time step’s active constraint variable controller’s PID output. This helps avoid sluggish
control action when an upset or an operations change causes an active constraint variable switch
(see Section 7.7). This is equivalent to the slow response of a wound-up controller as it reverses the Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License214 7 Conventional Constraint Control
Min constraint
Max constraint
PC236 PV
AC201 PV
(a) (b) (c) (d)
PC236 PV
AC201 PV
Min constraint
Max constraint
Min constraint
Max constraint
AC201 PV
PC236 PV
Min constraint
Max constraint
PC236 PV
AC201 PV
Figure 7.2 Natural Draft Heater Combustion Control CV-Status Combinations
Table 7.2 Heater Combustion Control CV-Status Combinations
Status Figure AC201PV AC201 OP PC236 PV PC236 OP
1 7.2a N Decreases N Decreases
2 7.2b V Increases V Increases
3 7.2c V Increases N Decreases
4 7.2d N Decreases V Increases
N, normal; V, violation.
Table 7.3 Typical CV Controller Output Responses When CV is in Violation and is
Normal
AC201 PV AC201 OP M201 PC236PV PC236 OP M201
Normal N 50% → 45% 50% → 45% N 50% → 47% 50% → 47%
Violation V 50% → 55% 50% → 55% V 50% → 53% 50% → 53%
unnecessary changes made to its output when it was being wound-up. So, in all that follows, AC201
OP and PC236 OP are both equal to 50% at the current time step, no matter which output was the
last output chosen by the signal selector.
With both CV controller outputs = 50%, we look at each of the four CV-Status combinations pre￾sented in Table 7.2. We first assume typical CV controller responses for each CV when in violation,
and different typical CV controller responses for each CV when not in violation. These four typical
CV controller responses, one for each CV when violated and one for each CV when not in violation,
are presented in Table 7.3.
The information presented in Tables 7.2 and 7.3 is now combined to yield a summary, presented
in Table 7.4, of CV controller output responses for the four CV-Status combinations:
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License7.3 Natural Draft Heater Combustion Control via Conventional Constraint Control 215
Table 7.4 CV Controller Outputs, Damper Results for Each CV-Status Combination
Status AC201 PV AC201 OP M201 PC236PV PC236 OP M201
1 N 50% → 45% 50% → 45% N 50% → 47% 50% → 47%
2 V 50% → 55% 50% → 55% V 50% → 53% 50% → 53%
3 V 50% → 55% 50% → 55% N 50% → 47% 50% → 47%
4 N 50% → 45% 50% → 45% V 50% → 53% 50% → 53%
Note: The use of typical CV controller responses in Table 7.4 is acceptable for this hypothetical
example because the assumed AC201 OP and PC236 OP results are compared only to illustrate
how the signal selector chooses the controller output to send to the secondary. The output values
in Table 7.4 have been chosen arbitrarily to generate all possible situations the signal selector could
encounter. Since we are not calculating real-time control performance, their actual values are not
important. It is the relative magnitudes of the CV controller outputs, not their actual values, and
whether a CV controller’s output increases or decreases when it is in violation or is normal, that
are critical.
7.3.3 Choosing the Controller Output and the Active Constraint Variable
We now look at each of the four possible CV-Status combinations in Table 7.2 (and illustrated
in Figure 7.2) and describe how the signal selector chooses the appropriate controller output for
each combination. The initial damper position at the current time step is assumed to be 50% open,
although the conclusions are independent of the assumed initial current damper position. Also,
as mentioned previously, to avoid slowing a (currently) nonactive constraint variable controller’s
response if/when it becomes the active constraint variable, all nonactive constraint variable con￾troller outputs are reset equal to the current time step’s active constraint variable controller’s PID
output. Therefore, AC201 OP and PC236 OP are both 50% at the current time step.
For each situation in Table 7.2, we review how each CV’s PID algorithm responds to its current
violated or normal status. The net effect of sending each CV’s PID output to the damper is then
described. The basis for the signal selector’s final decision in each case is explained. The signal
selector’s choice of output for each of the four CV-Status combinations allows a general standard
to be identified that applies to all four cases.
Both CVs Normal, Not in Violation
Referring to the first line in Table 7.4 (Status 1), and as illustrated in Figure 7.2a, both CVs are
normal and not in violation. When both CVs are not in violation, the signal selector’s objective is to
choose controller outputs that drive each CV toward its constraint limit or maintain one CV at its
constraint limit, without pushing either CV into violation. Referring to the first line in Table 7.2,
both AC201 OP and PC236 OP should decrease to decrease AC201 PV and increase PC236 PV and
drive both toward their constraint limits (AC201 SP and PC236 SP). Referring to Table 7.4, AC201
OP decreases, from 50% to 45%, and wants a less open damper position. In Table 7.4, PC236 OP
also decreases, from 50% to 47%, and wants a less open damper position. If the selector chooses
AC201 OP (45%), with PC236 wanting a damper position of only 47% open, it is very possible that
PC236 PV could be driven above its maximum value and into violation. However, if the selector
chooses PC236 OP (47%), with AC201 wanting a damper position of 45% open, it is unlikely that
AC201 PV would be driven below its minimum value and into violation.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License216 7 Conventional Constraint Control
Therefore, when both CVs are normal and not in violation, the signal selector’s best option is to
choose the largest controller output.
With both CVs normal and not in violation, the CV whose controller output is chosen – in this
case, PC236 PV, is closer to its limiting constraint than the other unviolated CVs – in this case,
AC201 PV, because its output will not drive the other unviolated CV (AC201 PV) into violation.
Therefore, at the current time step, the CV closest to its limiting constraint – in this case, PC236
PV, is the active constraint variable or the limiting constraint.
Both CVs in Violation
Referring to the second line in Table 7.2 (Status 2), and as illustrated in Figure 7.2b, both CVs are
in violation. When both CVs are in violation, the signal selector’s objective is to choose controller
outputs that drive both CVs closer to their limiting constraints and out of violation. Referring to
the second line in Table 7.2, both AC201 OP and PC236 OP should increase to increase AC201
PV and decrease PC236 PV and drive both toward their constraint limits (AC201 SP and PC236
SP) and out of violation. Referring to Table 7.4, AC201 OP increases from 50% to 55% – it wants
a more open damper position. Again, in Table 7.4, PC236 OP increases from 50% to 53% – it also
wants a more open damper position. If the selector chooses PC236 OP (53%), with AC201 wanting
a damper position of 55% open, it is possible that AC201 PV would remain in violation. However,
if the selector chooses AC201 OP (55%), with PC236 wanting a damper position of 53% open, it is
unlikely that PC236 PV would remain in violation.
Therefore, when both CVs are in violation, the signal selector’s best option is to choose the largest
controller output.
With both CVs in violation, the CV whose controller output is chosen – in this case, AC201 PV,
is more violated, i.e., farther from its limiting constraint than the other violated CVs – in this case,
PC236 PV; its output could drive the other violated CV (PC236 PV) out of violation. Therefore, at
the current time step, the CV most violated and farthest from its constraint limit – in this case,
AC201 PV, is the active constraint variable or the limiting constraint.
AC201 PV in Violation, PC236 PV Not in Violation
Referring to the third line in Table 7.2 (Status 3), and as illustrated in Figure 7.2c, PC236 PV is nor￾mal – not in violation, but AC201 PV is in violation of its desired minimum value (AC201 SP). When
one CV is in violation and other CVs are not in violation, the signal selector’s objective is to choose
controller outputs that drive the violated CV out of violation without pushing the not violated CVs
into violation. Referring to the third line in Table 7.2, AC201 OP should increase (damper posi￾tion more open) to drive AC201 PV toward AC201 SP and out of violation. Referring to Table 7.4,
AC201 OP increases from 50% to 55% – it wants a more open damper position. Also in Table 7.4,
to increase PC236 PV and drive it toward its max constraint limit, PC236 OP decreases from 50%
to 47% – it wants a less open damper position. This presents a clear choice – the selector must pri￾oritize AC201 PV’s constraint violation and choose the higher AC201 OP – the more open damper
position to drive AC201 PV toward its minimum constraint and out of violation. This choice of out￾put decreases PC236 PV and thus drives PC236 PV away from its constraint limit and further from
violation. On the other hand, if the selector were to choose PC236 OP (47%), closing the damper
from 50% to 47% would drive AC201 PV further into violation. Clearly, this choice is not feasible.
Therefore, when one CV is in violation and the other CV is normal – not in violation, the signal
selector’s best (and only) option is to choose the largest controller output.
With one CV in violation and others not in violation, the one CV in violation is the active con￾straint variable or the limiting constraint and will remain so until it is again close to its constraint
limit or is no longer in violation.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License7.3 Natural Draft Heater Combustion Control via Conventional Constraint Control 217
PC236 PV in Violation, AC201 PV Not in Violation
Referring to the fourth line in Table 7.2 (Status 4), and as illustrated in Figure 7.2d, AC201 PV is
normal – not in violation, but PC236 PV is in violation. As just described above, when one CV is
in violation and the other CVs are not in violation, the signal selector’s objective is to choose con￾troller outputs that drive the violated CV out of violation without pushing the not violated CVs into
violation. Referring to the fourth line in Table 7.2, PC236 OP should increase, to open the damper,
to drive PC236 PV toward PC236 SP and out of violation. Referring to Table 7.4, PC236 OP increases
from 50% to 53% – it wants a more open damper position. Also, in Table 7.4, to decrease AC201 PV
and drive it toward its desired minimum constraint limit (AC201 SP), AC201 OP decreases from
50% to 45% – it wants a less open damper position. The choice is again clear – the selector must
prioritize the PC236 PV constraint violation and choose the larger PC236 OP, e.g., the more open
damper position. This choice of output drives PC236 PV toward its constraint limit and out of vio￾lation, while AC201 PV increases and is driven away from its constraint limit and further from
violation.
Therefore, as above, when one CV is in violation and the other CVs are normal – not in violation,
the signal selector’s best (and only) option is to choose the largest controller output.
So again, with one CV in violation and the others not in violation, the one CV in violation is the
active constraint variable or the limiting constraint and will remain so until it is at least close to its
constraint limit again or is no longer in violation.
7.3.4 Signal Selector Configuration
The signal selector in Figure 7.1 has two inputs, AC201 OP and PC236 OP, and it sends one of these
two inputs to the ultimate secondary, the damper M201. Signal selector functionality – choosing
one of several inputs to send to a single secondary, is provided as a standard feature by all
major DCS venders. For example, in Honeywell’s Experion DCS, it is provided by the OVRDSEL
function block, and in their TDC3000 DCS, it is provided by the ORSEL control algorithm. The
signal selector is configured at file build time, by an engineer specified configuration parameter,
to either chose the largest or smallest input. If the signal selector is configured to choose the
input with the largest magnitude, it is called a high signal selector (HSS), and is indicated by
“HSS.” If it is configured to choose the input with the smallest magnitude, it is called a low
signal selector (LSS), and is indicated by “LSS.” Designating the signal selector as either an
HSS or an LSS is a critical component of every constraint control strategy’s design. As revealed
in Section 7.3.3, for the heater combustion control strategy’s two CVs, there are four possible
CV-Status combinations, and in each case, the larger of the two CV controller outputs was
chosen. Thus, for the heater combustion control strategy in Figure 7.1, the signal selector is
an HSS.
The CV whose CV controller’s output is chosen by the signal selector on each time step is
called the active constraint variable or the limiting constraint. The signal selector’s criteria for
choosing the CV output ensures the active constraint is either the CV closest to its limiting
constraint when all CVs are normal and not in violation, or the CV most violated and farthest from
its constraint limit if one or more CVs are violating a constraint limit.
Is there any underlying element or “rule” embedded in the above discussion of the signal selec￾tor’s configuration that can be applied to a wide range of conventional constraint control designs – a
constraint control strategy with any number of constraint variables, and any mix of minimum and
maximum constraints? And is there ever a need to use an LSS in a constraint control application
strategy? The answer to both questions is yes.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License218 7 Conventional Constraint Control
First, the underlying element or “rule” is the effect an increase in the MV (e.g., damper position
M201) has on all constraint variables (e.g., AC201 PV and PC236 PV):
If an increase in the MV drives all CVs away from violation, then a HSS is the correct choice.
This rule applies not only to the heater combustion control strategy but to the design of any con￾ventional constraint control strategy whose CVs and MV satisfy the indicated CV–MV relationship.
Applying this rule to the combustion control example, increasing the MV, i.e., opening the damper,
increases AC201 PV (which has a minimum constraint) and decreases PC236 PV (which has a max￾imum constraint). Thus, both CVs move away from violation when the MV is increased, and thus,
the above rule confirms the signal selector must be an HSS.
And what about the use of an LSS in a constraint control application. A control strategy that
maximizes the heat recovered to a crude oil stream in an APS preheat train, subject to maximum
and/or minimum constraint limits on other heat balance-related process variables (e.g., measured
temperatures), is used as a basis to investigate the use of an LSS. This strategy’s MV affects multiple
CVs, but unlike the natural draft heater’s CV–MV relationships, an increase in the MV causes all
CVs to move toward violation. We now employ the same detailed analysis used for the combustion
control strategy to the heat recovery maximization strategy and show that in this case the signal
selector must be a LSS.
7.4 Maximizing Heat Recovery
Figure 7.3 shows T-109, a CDU, and its crude preheat train upstream of the crude desalter
D-15; the focus is on how heat recovery to crude in exchanger E-173 can be maximized. After
exchanging heat with T-109 overhead vapor in E-173, the crude exchanges heat with T-109 TPA
in exchanger E-170 and is then routed to other exchangers for further warming before flowing
to D-15. The heat recovery to crude in E-173 is determined by E-173’s duty, and E-173’s duty is
established by the adjustments to three-way valve TV324 made by TC324 to control E-170 cold side
outlet temperature (TC324 PV). Increasing TC324 SP increases heat recovery to crude in E-173;
three-way valve TV324 responds to the increase in TC324 SP by simultaneously increasing the
crude feed to E-173 and decreasing the bypass flow around E-173. Thus, to maximize heat recovery
to crude in E-173, the operating objective is to increase TC324 SP to maximize E-170 crude outlet
temperature.
However, heat recovery to crude in E-173 is limited by the need to maintain related PVs below
or above a maximum or minimum constraint limit. Crude exiting E-170 is heated further in other
downstream exchangers before entering the desalter (D-15). Desalting of refinery crude feedstocks
minimizes fouling and corrosion on downstream heat transfer surfaces and removes dissolved met￾als that cause catalyst deactivation in downstream reactor systems. Desalting efficiency depends
upon crude density and viscosity, both functions of temperature. Increasing temperatures lower
both density and viscosity, improving desalting efficiency. However, desalting efficiency eventu￾ally levels off and begins to decrease above a crude-dependent temperature. Therefore, to ensure
efficient desalting, desalter inlet temperatures must be maintained below an offline calculated max￾imum value. When TC324 is increased to increase heat recovery to crude in E-173, desalter inlet
temperature (TI340 PV) will tend to increase. Thus, a second operating objective is to maintain
TI340 PV below the maximum temperature that ensures acceptable desalting continues.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License7.4 Maximizing Heat Recovery 219
D-15
D-35
TC
306
TI
340
TI
344
Desalter
Crude
fractionation
unit
E-174
E-173
TV324
Crude
Further
crude
preheat
T-109
Top P/A TC
324
E-170
TC306 OP
∞
T
1
0
9
Figure 7.3 CDU Crude Preheat and Overhead Vapor Cooling Configuration
Also, as E-173 duty increases, T-109 overhead vapor (E-173 hot side outlet) temperature (TI344)
decreases. To avoid corrosion in the overhead line, TI344 PV must remain above the overhead
vapor’s dew point, a minimum temperature constraint. In addition, as TI344 PV decreases, reflux
drum (D-35) temperature controller TC306’s corrections reduce E-174 duty to maintain TC306 PV
at setpoint. Thus, it is also necessary to ensure TC306 OP stays in controlling range – it does not
become wound-up low, e.g., a TC306 OP minimum constraint.
Therefore, the operating objective for the CDU crude preheat and overhead vapor cooling config￾uration in Figure 7.3 is to maximize heat recovery to crude in E-173 by maximizing E-170 cold side
outlet temperature (TC324 SP), subject to maximum desalter inlet temperature (TI340 PV), mini￾mum overhead vapor temperature (TI344 PV) and minimum TC306 control output constraints. The
conventional constraint control strategy applicable to this process configuration and its operating
objectives is presented in Figure 7.4.
Figure 7.4’s conventional constraint control strategy and the process configuration in Figure 7.3
are discussed in detail in Chapter 11 (in Section 11.1.1)3 where the strategy’s design details are
presented in full. Therefore, most design details are omitted here and instead, like the previous
discussion of the heater combustion control strategy, the focus is on the constraint control cascade’s
structure – its CVs and the MV, CV constraint types, CV responses to MV changes, and how the
signal selector is configured.
Referring to Figure 7.4, the MV – TC324 SP (E-170 cold side outlet temperature controller set￾point) affects the three constraint variables – desalter inlet temperature TI340 PV, overhead vapor
3 A discussion of the output characteristic of three-way valve TV324, defining the relationship between TC324 OP
and the crude flow split to and around E-173, is included in this discussion.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License220 7 Conventional Constraint Control
TC
324
TC340
Desalter inlet
temperature
Max desalter
inlet temperature
SP
TC344
SP
Min overhead
temperature
E-170 outlet
temperature
SP
TV324
Crude flow
to E-170
E-173
bypass flow
Crude flow
from E-173
TIV340 VTC306
SP
D-35
temperature
controller O/P
TC306 OP TI
340
Overhead
temperature
TIV344
TI
344
Signal
selector
Validation Validation
Min
TC306 OP 
Figure 7.4 Maximizing Heat Recovery to Crude in CDU Preheat Exchanger E-173
temperature TI344 PV and reflux drum temperature TC306 output (TC306 OP). All three PIDs,
TC340, TC344, and VTC306 are standard PID controllers, and TI340 PV and TI344 PV are both
validated (in TIV340 and TIV344) before they are used in control. For all three PID controllers,
an increase in a constraint variable controller’s output increases TC324 SP (the MV) and therefore
E-173 duty; when output decreases, TC324 SP and E-173 duty both decrease. For TC340, when
TC340 PV is increasing and/or is above its setpoint, TC340 reduces TC324 SP, and thus TC340 OP
decreases; TC340 is thus configured with control direction = Reverse. For TC344, when TI344 PV is
decreasing and/or is below its setpoint, TC344 decreases TC324 SP to decrease E-173 duty. Thus,
TC344 OP decreases, and TC344 is configured with control direction = Direct. Lastly, for VTC306,
when TC306 OP is decreasing and/or is below the VTC306 setpoint, VTC306 decreases TC324 SP
to decrease E-173 duty. Thus, VTC306 OP decreases and VTC306 is configured with control direc￾tion = Direct.
Although there are three CVs, only one MV (TC324 SP) is available for control. With only one MV,
the conventional constraint control strategy in Figure 7.4 can only maintain one of the three CVs
at a setpoint. In all three cases, the constraint variable PID setpoint is the CV’s constraint limit,
TC340 SP = max TI340 PV, TC344 SP = min TI344 PV, and VTC306 SP = min TC306 OP. With
all three controller setpoints equal to a desired max/min constraint limit, the constraint control
strategy in Figure 7.4 maintains either TI340 PV, TI344 PV, or TC306 OP at its constraint limit,
while maintaining the other two CVs out of violation. With one MV available (TC324 SP), only one
controller can reset the one MV. As explained previously in the heater combustion control strategy
discussion, the controller outputs, in this case, TC340 OP, TC344 OP, and VTC306 OP, are all sent
to a signal selector as inputs, and the signal selector’s task is to decide which output to send to
secondary TC324.
The detailed analysis used previously to gain insight into the heater combustion control
strategy’s underlying principles is now applied to the heat recovery maximization application
in Figure 7.4. And fortunately, the insights and perspectives acquired performing the previous
analysis will facilitate the understanding of the working principles that underlie the strategy in
Figure 7.4.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License7.4 Maximizing Heat Recovery 221
Table 7.5 Heat Recovery to Crude Maximization CV–MV Relationships
CV CV Type
When MV
Increases
When MV
Decreases
When MV
Increases
When MV
Decreases
TI340 PV Maximum CV increases CV decreases CV moves
toward violation
CV moves away
from violation
TI344 PV Minimum CV decreases CV increases CV moves
toward violation
CV moves away
from violation
TC306 OP Minimum CV decrease CV increases CV moves
toward violation
CV moves away
from violation
7.4.1 CVs, the MV, and CV–MV Relationships
As is required by conventional constraint control, one MV – E-170 cold side (crude) outlet
temperature (TC324 SP), affects all three constraint variables – desalter inlet temperature (TI340
PV), overhead vapor temperature (TI344 PV) and reflux drum outlet temperature controller output
(TC306 OP). An increase in TC324 SP increases E-173 duty and thus E-173 cold side (crude) outlet
temperature. Thus, continuing to increase TC324 SP will continue to increase E-173 duty, and heat
recovery to crude in E-173. However, an increase in E-170 cold side (crude) outlet temperature
(TC324 PV) not only increases heat recovery to crude in E-173 but also increases desalter inlet
temperature (TI340 PV), decreases overhead vapor temperature (TI344 PV) and decreases reflux
drum temperature controller output (TC306 OP). And since TI340 PV has a maximum constraint,
and both TI344 PV and TC306 OP have minimum constraints, these CVs and their constraint limits
establish an upper bound on the amount of heat that can be recovered to crude in E-173. And
note that a decrease in TC324 SP decreases TI340 PV, increases TI344 PV, and increases TC306
OP – these CV–MV relationships will also be useful for the upcoming discussion.
Table 7.5 summarizes these CV–MV relationships for future reference. As was the case for the
previous heater combustion control strategy (see Table 7.1), the information displayed in the last
two columns of Table 7.5 reveals two essential properties of the CV-MV relationships that are cen￾tral to this constraint controller’s ability to achieve its control objective: (i) when the MV (TC324 SP)
increases, all three CVs are driven toward their constraint limit and (ii) when the MV decreases, all
three CVs are driven away from their constraint limit.
7.4.2 CV Controller Output – MV Relationships
With two CVs (AC201 PV and PC236 PV) and two CV controller outputs (AC201 OP, PC236 OP),
and the two statuses – in violation V or normal N (not in violation), the natural draft heater combus￾tion control strategy’s signal selector (in Figure 7.1) must assess one of the four possible CV-Status
combinations included on Table 7.2 and illustrated in Figure 7.2. However, for the heat recovery
maximization strategy in Figure 7.4, there are three CVs – TI340 PV, TI344 PV, and TC306 OP,
and thus three CV controller outputs (TC340 OP, TC344 OP, and VTC306 OP), with the same two
statuses – violation (V) or normal (N). Instead of the previous application’s four CV-Status combi￾nations to assess, as shown below in Table 7.6, there are eight possible CV-Status combinations that
the heat recovery maximization application’s selector must assess each time it chooses a controller
output. For each of the eight possible CV-Status combinations in Table 7.6, the output direction (an
increase or decrease) that each CV controller will calculate given its status (V, N), is indicated.
Status 1 is an instance with all three CVs normal – there are no constraint limit violations. For
all three CVs, the CV controller’s output will increase to increase the TC324 SP. In Status 2–4, one Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License222 7 Conventional Constraint Control
Table 7.6 Heat Recovery to Crude Maximization CV-Status Combinations
Status TI340 PV TC340 OP TI344 PV TC344 OP TC306 OP VTC306 OP
1 N Increases N Increases N Increases
2 V Decreases N Increases N Increases
3 N Increases V Decreases N Increases
4 N Increases N Increases V Decreases
5 V Decreases V Decreases N Increases
6 N Increases V Decreases V Decreases
7 V Decreases N Increases V Decreases
8 V Decreases V Decreases V Decreases
N, normal; V, violation.
CV is in violation of its constraint limit, and the other two are normal. When in violation, the CV
controller’s output will decrease to decrease TC324 SP. For CVs not in violation, the CV controller’s
output will increase to increase TC324 SP. In Status 5–7, two CVs are in violation, and the other CV
is normal. Again, when the CV is in violation, the CV controller’s output will decrease to decrease
TC324 SP, and when the CV is normal, the CV controller’s output will increase to increase TC324
SP. And finally, Status 8 is an instance with all three CVs in violation, and for all three CVs, the CV
controller’s output will decrease to decrease TC324 SP.
A hypothetical example is again employed, this time to explain the heat recovery maximization
strategy’s signal selector functionality. In the analysis presented below, the relationship between
a CV controller’s output and the secondary’s setpoint (TC324 SP), shown in Equation (7.1) below,
plays an important role. At every time step (n), each constraint controller’s PID output is the TC324
SP in the percent of range of TC324, each controller’s secondary4:
CV OPn(%) = (TC324 SPn − TC324L)
(TC324H − TC324L) ∗ (100%) (7.1)
In Equation (7.1), CV OPn (%) is a CV controller’s current output in % of range of TC324’s engi￾neering unit high (TC324H) and low (TC324L) values. Solving Equation (7.1) for TC324 SPn yields:
TC324 SPn = (TC324H − TC324L)
100% ∗ CV OPn(%) + TC324L (7.2)
We now illustrate and describe how the heat recovery maximization strategy’s signal selector
decides which CV controller’s output to send to the secondary. Assume that at the current time
step, n, TC324 SPn is equal to 110 ∘F, TC324L = 50 ∘F, and TC324H = 200 ∘F. Remember that at
every time step, all nonactive constraint variable controller outputs are reset equal to the active
constraint variable controller’s PID output. With TC324 SPn = 110 ∘F, Equation (7.1) generates a
controller output value of 40%. Thus, no matter which was last chosen by the signal selector, at the
current time step, n, the three CV controller outputs – TC340 OPn, TC344 OPn, and VTC306 OPn,
are equal to 40%.
With TC324 SPn = 110 ∘F and the three CV controller outputs = 40%, we look at each of the eight
CV-Status combinations in Table 7.6. We first assume typical CV controller responses for each CV
when in violation, and different typical CV controller responses for each CV when not in violation.
These six typical CV controller responses, one for each CV when violated and one for each CV
when not in violation, are presented in Table 7.7; the corresponding values of TC324 SP, calculated
4 See Equation (2.8a) in Chapter 2, Section 2.4.1.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License7.4 Maximizing Heat Recovery 223
Table 7.7 Typical CV Controller Output Responses When CV is in Violation and is Normal
TI340
PV
TC340
OP
TC324
SP
TI344
PV
TC344
OP
TC324
SP
TC306
OP
VTC306
OP
TC324
SP
Normal N 40% → 44% 110 → 116 N 40% → 42% 110 → 113 N 40% → 47% 110 → 121
Violation V 40% → 37% 110 → 106 V 40% → 35% 110 → 102 V 40% → 38% 110 → 107
Table 7.8 CV Controller Outputs, TC324 SP Results for each CV-Status Combination
Status
TI340
PV
TC340
OP
TC324
SP
TI344
PV
TC344
OP
TC324
SP
TC306
OP
VTC306
OP
TC324
SP
1 N 40% → 44% 110 → 116 N 40% → 42% 110 → 113 N 40% → 47% 110 → 121
2 V 40% → 37% 110 → 106 N 40% → 42% 110 → 113 N 40% → 47% 110 → 121
3 N 40% → 44% 110 → 116 V 40% → 35% 110 → 102 N 40% → 47% 110 → 121
4 N 40% → 44% 110 → 116 N 40% → 42% 110 → 113 V 40% → 38% 110 → 107
5 V 40% → 37% 110 → 106 V 40% → 35% 110 → 102 N 40% → 47% 110 → 121
6 N 40% → 44% 110 → 116 V 40% → 35% 110 → 102 V 40% → 38% 110 → 107
7 V 40% → 37% 110 → 106 N 40% → 42% 110 → 113 V 40% → 38% 110 → 107
8 V 40% → 37% 110 → 106 V 40% → 35% 110 → 102 V 40% → 38% 110 → 107
using Equation (7.2), are included in Table 7.7. Tables 7.6 and 7.7 are combined in Table 7.8 to yield
a summary of the CV controller output responses and the resulting TC324 SP values for the eight
CV-Status combinations.
Note: Like the heater combustion control strategy analysis in Section 7.3.2, the use of typical CV
controller responses in Table 7.7 is acceptable because these hypothetical TC340 OP, TC344 OP, and
VTC306 OP values are compared only to illustrate how the signal selector chooses the controller
output to send to the secondary. Remember: For this analysis, two factors are critical: (i) the relative
magnitudes of the CV controller output, not their actual values, and (ii) whether a CV controller’s
output increases or decreases when in violation and when normal.
7.4.3 Choosing the Controller Output and the Active Constraint Variable
We now look at each of the eight possible CV-Status combinations in Table 7.8 and describe how
the signal selector chooses the appropriate controller output for each. Remember, for this analysis,
at the current time step, n, TC324 SPn = 110 ∘F, and TC340 OPn = TC344 OPn = VTC306 OPn = 40%.
For each situation in Table 7.8, we first analyze how each CV’s PID algorithm responds to its
violated or normal status at the current time step. Then, the expected net effect of sending each
CV’s PID output to secondary TC324 SP is described and assessed. And finally, the basis for the
signal selector’s final decision in each case is explained. Again, the signal selector’s choice of output
for each of the eight CV-Status combinations allows a general standard to be identified that applies
to all eight cases.
All Three CVs Normal, Not in Violation
In the first row of Table 7.8, the three CVs are normal and not in violation. All three CV controllers
respond by increasing their outputs to increase TC324 SP to drive their CVs toward constraint
limits – to approach them more closely. When all CVs are not in violation, the signal selector’s Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License224 7 Conventional Constraint Control
objective is to choose a controller output that drives a CV toward its constraint limit without push￾ing any other CV into violation. Referring to the first row of Table 7.8, if the selector were to choose
VTC306 OP (47%) and increase TC324 SP to 121 ∘F, it is likely both TC344 PV and TC340 PV would
be driven into violation because TC344 OP (42%) wants TC324 SP to increase to only 113 ∘F and
TC340 OP (44%) wants TC324 SP to increase to only 116 ∘F. If it were to choose TC340 OP (44%)
to increase TC324 SP to 116 ∘F, it is likely TC344 PV would be driven into violation since TC344
OP (42%) wants TC324 SP to increase to only 113 ∘F. However, if the selector were to choose TC344
OP (42%) and increase TC324 SP to 113 ∘F, it is unlikely that either TC340 PV (TC340 OP → TC324
SP = 116 ∘F) or TC306 OP (VTC306 → TC324 SP = 121 ∘F) would be driven into violation.
Therefore, when all CVs are normal, and not in violation, the signal selector’s best option is to
choose the smallest controller output.
With all CVs normal and not in violation, the CV whose controller output is chosen (in this
example, TI344 PV) is closer to its limiting constraint than the other unviolated CVs (TI340 PV and
TC306 OP) since its output will not drive the other unviolated CVs into violation. Therefore, at the
current time step, this CV (TI344 PV) is the active constraint variable or the limiting constraint.
Two CVs Normal and not in Violation, the Other CV in Violation
In rows 2–4 in Table 7.8, two CVs are normal and not in violation while the third CV is in violation.
When any one CV is in violation and the other two CVs are not in violation, the signal selector’s
objective is to choose controller outputs that drive the violated CV out of violation, without pushing
the not violated CVs into violation. In these three situations, the CV constraint controllers for CVs
not in violation want to increase TC324 SP while the CV constraint controller for the CV in violation
wants to decrease TC324 SP. Therefore, the choice is clear – the selector must give the highest
priority to the one CV in violation. Since the violated CV’s controller wants to decrease TC324 SP,
the selector must choose the smallest CV controller output to decrease TC324 SP and help drive the
violated CV out of violation. Note: Decreasing TC324 SP helps drive the violated CV out of violation,
but also drives the other two CVs away from their constraint limits, farther from violation.
Important: It is not feasible for the selector to choose one of the normal CV’s controller outputs,
since in either case TC324 SP would increase, and drive the violated CV further into violation.
Therefore, when one CV is in violation, and the other CVs are normal and not in violation, the
signal selector’s best (only) option is to choose the smallest controller output.
With one CV in violation and the others not in violation, the one CV in violation is the active con￾straint variable or the limiting constraint and will remain so until it is again close to its constraint
limit or is no longer in violation.
One CV Normal and not in Violation, the Other Two CVs in Violation
In rows 5–7 in Table 7.8, two CVs are in violation while the third CV is normal and not in violation.
When any two CVs are in violation and the other CVs are not in violation, the signal selector’s
objective is to choose controller outputs that drive both violated CVs out of violation but does not
push the not violated CVs into violation. In rows 5–7, the CV constraint controller for the CV not in
violation wants to increase TC324 SP, while the CV constraint controllers for the CVs in violation
want to decrease TC324 SP. The selector must give the highest priority to the CVs in violation. It
cannot choose the normal CV’s controller output since that would increase TC324 SP and drive the
other two CVs further into violation.
Looking at row 5 in Table 7.4, TI340 PV and TI344 PV are the two CVs in violation. VTC306 OP
is not in violation, and as discussed above, its CV controller’s output (VTC306 OP = 47%) cannot
be the selector’s choice. The selector’s choice must be either TC340 OP (37%) or TC344 OP (35%). Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License7.4 Maximizing Heat Recovery 225
In either case, TC324 SP decreases, which will drive the not violated CV (TC306 OP) further away
from its constraint limit, and further from violation. If the selector were to choose TC340 OP (37%)
and decrease TC324 SP to 106 ∘F, TI340 PV would be driven toward a less violated state and perhaps
(eventually) out of violation. But TI344 PV would likely remain in violation since TC344 OP (35%)
wants TC324 SP to decrease further, to 102 ∘F. If the selector chooses TC344 OP (35%) and TC324 SP
decreases to 102 ∘F, TI344 PV would be driven toward a less violated state and perhaps (eventually)
out of violation, and since TC340 OP wants TC324 SP = 106∘F, it is unlikely that TI340 PV would
remain in violation.
Therefore, when one CV is normal and not in violation, and the other CVs are in violation, the
signal selector’s best option is to choose the smallest controller output.
With one CV normal and the other CVs in violation, the CV in violation whose CV controller’s
output was chosen by the selector is the CV farthest from its constraint limit (most violated) since it
drives the other violated CVs toward their constraint limit and perhaps out of violation. Therefore,
at the current time step, it is the active constraint variable or the limiting constraint.
Three CVs in violation
In the last row of Table 7.8, the three CVs are all in violation. All three CV controllers respond by
decreasing their outputs to decrease TC324 SP and drive their CV toward their constraint limits and
out of violation. When all CVs are in violation, the signal selector’s objective is to choose controller
outputs that drive each CV toward their constraint limit and out of violation. If VTC306 OP (38%)
was chosen and TC324 SP decreased to only 107 ∘F, it is likely that both TI344 PV and TI340 PV
would remain in violation, since TC344 OP (35%) desires TC324 SP = 102 ∘F while TC340 OP (37%)
desires TC324 SP = 106 ∘F. If TC340 OP (37%) was chosen and TC324 SP decreased to 106 ∘F, TC306
OP could be driven out of violation, but since TC344 OP (35%) desires TC324 SP = 102∘F, it is
likely that TC344 PV could remain in violation. However, if the selector were to choose TC344 OP
(35%) and decrease TC324 SP to 102 ∘F, it is unlikely that either TI340 PV (TC340 OP desires TC324
SP = 106 ∘F) or TC306 OP (VTC306 desires TC324 SP = 107 ∘F) would remain in violation.
Therefore, when all CVs are in violation, the signal selector’s best option is to choose the smallest
controller output.
With three CVs in violation, the CV whose controller output is chosen by the selector is the CV
farthest from its constraint limit (i.e., the most violated CV) because its output could be sufficient
to drive all other unviolated CVs out of violation. Therefore, at the current time step, this CV is the
active constraint variable or the limiting constraint.
7.4.4 Signal Selector Configuration
In the discussion of the heater combustion control strategy, the CV–MV relationships provided a
standard “rule,” valid for a wide range of conventional constraint control designs, for choosing the
appropriate signal selector configuration:
If an increase in the MV drives all CVs away from violation, then the strategy’s signal selector is a
HSS.
5
Applied to the combustion control example, increasing the MV, i.e., opening the damper (M201),
increases the excess O2 (AI201 PV, which has a minimum constraint) and decreases firebox pres￾sure (PS236 PV, which has a maximum constraint). Thus, both CVs move away from violation when
5 If an increase in the MV drives all CVs away from violation, then a decrease in the MV drives all CVs towards
violation. Therefore, if a decrease in the MV drives all CVs towards violation, the strategy’s selector is also an HSS.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License226 7 Conventional Constraint Control
the MV is increased, and thus, the above rule confirms that the signal selector should be configured
as a HSS.
In the discussion of Figure 7.4’s heat recovery maximization strategy, the CV–MV relationships
discussed in Section 7.4.1 and summarized in Table 7.5 indicate that when the MV (TC324 SP)
increases, all three CVs are driven toward a violation. The discussion of this strategy’s signal selec￾tor configuration in Section 7.4.3 indicated the signal selector’s best option is to choose the smallest
of the three controller outputs for each of the eight CV-Status combinations in Table 7.8. Thus, the
signal selector in the heat recovery maximization control strategy in Figure 7.4 is an LSS. When
combined, these findings from Sections 7.4.1 and 7.4.3 provide the second standard “rule” for
choosing the appropriate signal selector configuration for any constraint control strategy:
If an increase in the MV drives all CVs toward violation, then the strategy’s signal selector is a LSS.
6
This rule applies not only to the heat recovery maximization control strategy but to the design
of any conventional constraint control strategy whose CVs and MV satisfy the indicated CV–MV
relationship. Applying this rule to the heat recovery maximization example, increasing the
MV, i.e., TC324 SP increases the desalter inlet temperature (TI340 PV, which has a maximum
constraint), decreases the CDU tower’s overhead temperature (TI344 PV, which has a mini￾mum constraint), and decreases the reflux drum temperature controller’s output (TC306 OP,
which has a minimum constraint). Thus, the three CVs move toward violation when the MV
is increased, and thus, the above rule confirms that the signal selector should be configured as
an LSS.
And for any constraint control strategy, the CV whose CV controller’s output is chosen at each
time step by the signal selector is called the active constraint variable or the limiting constraint.
The signal selector’s criteria for choosing the CV output ensures the active constraint is either
the CV closest to its limiting constraint when all CVs are normal and not in violation, or the CV
most violated and farthest from its constraint limit if one or more CVs are violating a constraint
limit.
7.5 Conventional Constraint Control Cascade Structure
The constraint control cascades discussed in detail in Sections 7.3 and 7.4 are specific examples of
the generic conventional constraint control cascade presented in Figure 7.5.
Each constraint variable has a dedicated PID controller that outputs to the signal selector. Since
there are multiple primary controllers and a single secondary, this is an important example of a
complex cascade for which DCS “cascade rules” do not apply. Thus, engineer-provided custom con￾figuration/code/logic must manage cascade initialization and wind-up (above the signal selector).
The PID controller set points are either the CV’s desired maximum or desired minimum constraint
limit; there can be any number of max/min set point combinations – from all max constraints to a
mix of max/min constraints to all min constraints. At any time step, the CV whose controller out￾put is sent to the secondary by the signal selector is the active constraint variable; it is either the CV
closest to its constraint limit when all CVs are not in violation, or the CV most violated and farthest
from its constraint limit if one or more CVs are in violation. There is only one MV, and it affects
each CV; this is one (of two) essential prerequisites for using conventional constraint control. The
6 An equivalent condition for a LSS: a decrease in the MV drives all CVs away from violation.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License7.5 Conventional Constraint Control Cascade Structure 227
PID 2
SP
PID X
SP
SP
CV 1
constraint
limit (max or min)
PID 1 PID 3
SP
CV
1
CV
3
CV
2
CV
X
SP
CV 2
constraint
limit (max or min) 
CV 3
constraint
limit (max or min)
CV X
constraint
limit (max or min)
PV PV PV PV
Secondary 
Signal selector = HSS or LSS,
depending upon CV–MV relationships
Secondary, most often
final control element or
single loop controller
Reset non-active CV
controller Ops to active
CV’s controller OP
Signal selector
Active CV
controller OP
… 
..… 
..… 
Figure 7.5 Conventional Constraint Control Cascade Structure
secondary in Figure 7.5 can be a final control element, i.e., a valve, damper (such as in Figure 7.2),
fan speed, etc., or a single loop controller, i.e., a flow, pressure, or temperature (such as Figure 7.4)
controller, or the primary of an underlying cascade.
The other essential prerequisite for using conventional constraint control is consistent CV
responses to unidirectional changes in the MV – for either an increase or decrease in the MV,
all CVs must either move toward violation or move away from violation. As revealed in the
discussions in Sections 7.3.4 and 7.4.4, the configuration of the signal selector as an LSS or an
HSS is directly related to whether (i) an increase in the MV drives all CVs toward (LSS) or away
from violation (HSS) or (ii) a decrease in the MV drives all CVs toward (HSS) or away from
violation (LSS).
After choosing the active constraint variable on the current time step, the signal selector
sends the active constraint variable controller’s PID output to the secondary and as shown on
Figure 7.5, also resets all nonactive CV controller outputs to the active CV controller’s PID output.
This is a necessary design feature, for all conventional constraint control strategies, that helps
avoid sluggish control action when a load upset causes an active constraint variable switch (see
Section 7.7). Since standard DCS features cannot provide this functionality for a complex cascade
such as constraint control, the custom code, logic, and configuration required must be engineer
provided.
In Figure 7.5, and in both constraint control strategies discussed earlier (Figures 7.1 and 7.4),
the two most common features of a conventional constraint control strategy’s cascade structure
are illustrated: (i) the signal selector’s secondary is either a final control element (Figure 7.1) or
a single loop controller (Figure 7.4) and (ii) the CV PID controller outputs are the signal selec￾tor’s inputs. Although less common, the signal selector’s secondary can also be the primary of an
underlying control cascade, and a signal selector’s input can be a non-PID controller output, e.g.,
a ratio controller whose primary is the CV’s PID controller. In the next section, an application is
described that maximizes a product stripper tower’s sidestream yield by maximizing the stripper’s
feed inlet temperature. Alternative constraint control designs are presented that include the two Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License228 7 Conventional Constraint Control
less common features described above. These alternative designs are enabled by varying the signal
selector’s location in the constraint control cascade.
7.6 Alternate Signal Selector Locations in Constraint Control
Designs
In Figure 7.6, product stripper T-63 separates its feed, hydrodesulfurization (HDS) reactor liquid
effluent, into wild naphtha (distillate), wild gas oil (sidestream) and heavy fuel oil (bottoms) prod￾ucts. The wild naphtha is sent to hydrotreating and typically becomes a MOGAS blend stock, while
the wild gas oil product becomes a FCCU feedstock. Feed preheat exchanger E-60 provides the heat
required to vaporize the feed components that are (i) removed as liquid products above the feed tray
or (ii) returned to the tower as external reflux to ensure good fractionation above the sidestream
draw-off tray. As E-60’s duty increases, more vapor is sent overhead, and more reflux, wild naphtha,
and wild gas oil are produced. Steam stripping below the feed tray removes lighter (lower boiling)
hydrocarbons from the unvaporized feed to improve the HFO front-end properties.
The quality of wild naphtha product is set by overhead temperature controller (TC61) manip￾ulating reflux flow via TV61. TC61 SP is an operator-entered guideline value that maintains wild
naphtha product quality on target. Wild naphtha yield is set by reflux drum D-61 level control
(LC65) manipulating wild naphtha product flow (FI65) via LV65 adjustments.
D-61
T
6
3
LC
65
FC
55
Tower
feed
Steam
TI
53
LC
31
TC
61
E-60
FI
21
TV53
TV61 LV65
FI
67
TI
62
TI
63
FI
60
FI
65
TC
53
LV31
Hot side
flow in
Hot side
flow out
LC
73
Wild gasoil
(FCCU feed)
FC
75
FV75
Heavy fuel
oil (HFO)
Wild
naphtha
Tail
gas
Figure 7.6 Product Stripper Tower T-63 Feed Preheat Configuration
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License7.6 Alternate Signal Selector Locations in Constraint Control Designs 229
E-60
duty/feed
Feed
rate
FI
21 RC53
TC53
Desired T-63
feed temperature
SP
TI
53
SP
Validation
Hot side
flow rate
SP
QC53 
TIV62 E-60
Heat duty
TIV63
FI
60 TI
62
TI
63
Hot side
temp in
Hot side
temp out
TV53
From
E-60
Hot side
fluid To
E-60
Figure 7.7 Stripper Tower T-63 Feed Temperature Control
The wild gas oil product is withdrawn from a complete draw-off tray via level control (LC73)
manipulating draw-off flow (FC75). The liquid hold-up on the draw-off tray, and thus the wild
gas oil product yield, varies with the amount of vapor produced in E-60 (E-60 duty). Since the
wild gas oil is FCCU feed, the operating objective is to maximize the sidestream product’s yield by
maximizing E-60 duty. However, there are two tower operating constraints that can limit E-60’s
duty: a full open reflux valve (TV61) and/or a full open distillate valve (LV65).
The control strategy in Figure 7.7 maintains the stripper’s feed inlet temperature (TC53) at an
operator-entered target by manipulating the heat duty/feed ratio (RC53 SP). RC53 provides FF
compensation for feed rate (FI21) upsets. RC53 then resets E-60 heat duty controller QC53 SP. E-60
heat duty is calculated using hot side inlet and outlet temperatures (TI63 PV, TI62 PV) and flow
rate (FI60 PV).7 A heat duty controller can calculate its control output algebraically when it resets a
hot side or cold side flow controller, since flow and duty are linearly related. However, in this case,
hot side flow FI60 PV is not controlled; thus, QC53 is the ultimate secondary, outputting to valve
TV53, and because the relationship between heat duty and valve position is nonlinear, QC53 must
be configured as a PID controller. Both temperatures (TI63 PV, TI62 PV) are externally multiplexed
DTI points and are validated (in TIV63 and TIV62) before their use in the duty calculation. Heat
duty control provides FF compensation for any upset that impacts the hot side inlet temperature
or flow rate.
TC53 SP establishes E-60’s duty and thus the tower’s vapor loading. Overhead temperature is
controlled (TC61) by manipulating reflux flow, and thus E-60 duty also affects the tower’s liq￾uid loading. To maximize wild gas oil yield, TC53 SP is increased up to a maximum allowable
offline specified guideline value, or until either the reflux flow (TV61) or distillate flow (LV65) valve
becomes limited high (i.e., almost full open). When either valve position approaches or exceeds its
max constraint limit, TC53 SP cannot be increased further and may need to be reduced.
7 See Section 3.7.1 for the calculation of reboiler heat duty.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License230 7 Conventional Constraint Control
E-60 
duty/feed RC53
TC53
Max T-63
feed temperature
SP
TI
53
SP
LSS
VLV65
Max
distillate VP
SP
LV65
VTV61
Max
reflux VP
SP
TV61
SP
QC53 E-60
Heat duty
TV53
From
E-60
Hot side
fluid To
E-601
Figure 7.8 Stripper Tower T-63 Feed Temperature Maximization
The strategy in Figure 7.7 requires operator attention and action (e.g., reflux and distillate flow
valve position monitoring) to achieve the tower’s primary operating objective (maximize wild gas
oil yield). In addition, TC53 SP is the operator entered, desired T-63 feed temperature. However,
conventional constraint control can automate the “constraint pushing” element of this strategy.
Figure 7.8 converts the strategy in Figure 7.7 to a constraint control strategy with three constraint
variables – T-63 inlet temperature, reflux valve position and distillate valve position, and a single
MV – E-60 duty QC53.8 Notice that in Figure 7.8, with reflux (TV61) and distillate flow (LV65) valve
position constraints included in the control strategy, TC53 SP is the offline specified maximum
value for T-63’s feed temperature.
The control components added to the scheme in Figure 7.7 to convert the strategy to a constraint
control strategy are the reflux valve position controller VTV61, the distillate valve position con￾troller VLV65, and the signal selector LSS. All three CVs – TI53 PV, TV61, and LV65, have maximum
constraint limits. An increase in the MV (E-60 duty) will increase all three CVs, and since all three
have maximum constraints, the MV increase will drive all three constraint variables toward their
constraint limit. Thus, the selector in Figure 7.8 is an LSS, with QC53 (still the control strategy’s
ultimate secondary) as its secondary.
Note that in this configuration, a non-PID controller, i.e., ratio controller RC53, is CV controller
TC53’s secondary, and RC53’s output is one of the signal selector’s inputs. The signal selector com￾pares the heat duties desired by each CV controller in response to its CV’s current constraint status.
TC53 OP is the heat duty/feed ratio TC53 desires in response to its current constraint status. The
8 Since they are not directly relevant to the constraint control cascade’s structure, QC53’s inputs (TI62, TI53) are
not shown in Figure 7.8.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License7.7 Active Constraint Variable Switches 231
ratio controller’s control output is calculated algebraically – it adds no dynamic elements to TC53
OP; it just scales (multiplies) TC53 OP by the current feed rate measurement (FI21 PV) to produce
the heat duty desired by TC53.
The same control objectives can be achieved if the LSS in Figure 7.8 is relocated so that its sec￾ondary is RC53, which then resets QC53 (still the ultimate secondary). In this configuration, each
CV PID controller output (TC53 OP, VTV61 OP, and VLV65) is the heat duty/feed ratio desired by
the CV (in % of range of RC53 EUs) to satisfy its current constraint status. Each CV controller’s
output is an LSS input, and the LSS sends the lowest heat duty/feed ratio to RC53 SP. The ratio
controller’s control calculation, the LSS’s output choice (the lowest desired heat duty/feed ratio)
multiplied by the current feed rate (FI21 PV), provides the desired heat duty, QC53 SP. The desired
heat duty, QC53 SP, in % of range of QC53 EUs, is RC53 OP.
Another alternative LSS location for the T-63 feed temperature maximization strategy is to place
it so that it outputs directly to the final control element, TV53, with QC53 as its primary. For
this strategy, unlike the strategies in Figures 7.7 and 7.8 (and when RC53 is the LSS’s secondary),
the operator’s interface for changing TV53’s valve position is the signal selector. To make manual
changes to TV53 “operator friendly,” i.e., make it comparable to changing a PID controller’s OP,
custom code and/or logic is almost certainly required. With the LSS in either of the two other
locations, QC53 is the ultimate secondary, and operators can change TV53 manually by trans￾ferring QC53 into manual mode (decommissioning all constraint variable PIDs) and changing
QC53 OP.
Other than this one difference, the three alternative cascade control performances are about
equivalent and are all capable of achieving T-63’s feed temperature maximization control objective.
Note: Unlike the other two alternatives, when the LSS outputs directly to TV53, QC53’s dynamics
(and tuning) do not underly the response of TV53 to VTV61 and VLV65 controller adjustments.
Hence, these response times may be somewhat faster than their responses when the LSS is placed
higher in the cascade, i.e., directly above QC53 or directly above RC53. However, given their loca￾tion at the tower overhead, the responses of TV61 and LV65 to a change in TV53 will be very slow.
Therefore, for this control strategy, the effect of QC53’s underlying dynamics on VTV61 and VLV65
control adjustments is not important.
7.7 Active Constraint Variable Switches
The primary cause of an active constraint variable switch is a process upset or operational change
that has an unequal effect on the CVs. One possible exception is a change in a CV controller’s
setpoint. CV controller setpoints are CV constraint limits, and they are rarely changed. However, if
a setpoint is changed, that CV’s controller output is immediately affected. Assuming the CV whose
setpoint is changed is not the limiting constraint, then depending upon (i) the magnitude of the
setpoint change and (ii) how dynamically close the other CVs are to their constraint limits, a change
in the active constraint may occur.
The constraint control strategy that maximizes heat recovery to crude in Figure 7.4, for the pro￾cess configuration in Figure 7.3, provides a realistic scenario for an active constraint variable switch
caused by a process upset that affects the CVs unequally. A thunderstorm that brings heavy rain
and a sudden drop in ambient air temperature will have an important effect on the overhead tem￾perature TI344 PV (and thus TC344 OP), on the overhead air condenser E-174 duty, and thus the
reflux drum temperature controller’s output TC306 OP, but very little effect on the desalter inlet
temperature TI340 (and thus TC340 OP).
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License232 7 Conventional Constraint Control
TI340 PV
Time →
Upset
occurs
Max
desalter inlet
temperature
Min
overhead
temperature
TI344 PV
TC340 SP
TC344 SP 
VTC306 SP 
Min
reflux drum
temperature
controller output
TC306 OP
Active constraint
variable switch
TC324 SP
TI340 PV
Active CV
TI344 PV
Active CV
TI340 PV
TI344 PV
TC306 OP
TC324 SP
Figure 7.9 Active Constraint Variable Switch – Max Heat Recovery to Crude
Assume the desalter inlet temperature is the active constraint variable being held at its
desired maximum value and both TI344 PV and TC306 OP are unviolated and above their
minimum allowable constraint limits – this situation is illustrated on the extreme left side of
Figure 7.9. Before the upset occurs, both TI344 PV and TC306 OP are unviolated and well above
their desired minimum values. TC344 OP and VTC306 OP thus want to increase the MV, TC324
SP, to drive TI344 PV and TC306 OP toward their minimum constraint limits. However, the active
constraint variable, TI340 PV, is being held at its desired max value, and an increase in TC324 SP
will drive TI340 PV into violation. Therefore, the signal selector, an LSS choosing the smallest CV
controller’s output, continues to choose TC340 OP because the other two CV controller outputs
continue to request an increase in TC324 SP.
Now consider how the situation changes as the upset occurs and the CVs are affected unequally.
As the rain begins to fall and the ambient temperature drops, both TI344 PV and TC306 OP begin
to decrease, moving toward their minimum constraint limits. As either TI344 PV or TC306 OP or
both come closer to a minimum constraint, their CV controller outputs, TC344 OP and VTC306
OP, begin to request a decrease in the MV, TC324 SP. The LSS then begins to choose one of these
outputs (whichever is smallest), TC324 SP begins to decrease, and that output’s CV becomes the
limiting constraint. Eventually, as the approach to a constraint limit by one of these CVs persists and
its output is consistently the smallest from among TC344 OP and VTC306 OP (the lowest TC324
SP desired), it remains dynamically closest to its constraint limit and becomes the new active con￾straint variable. In Figure 7.9, it is the overhead temperature, TI344 PV, that becomes the active
constraint variable and is maintained at its desired minimum value. TC306 OP lines out at a value Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License7.8 Constraint Control Design Issues 233
lower than its pre upset value but is not in violation. TI340 PV lines out at a value lower than its
pre upset value (at its maximum constraint limit), further away from its maximum limit, because
TC324 SP has decreased. If the ambient air temperature drop is not permanent but instead slowly
increases back to its pre upset value, an active constraint variable switch back to the desalter inlet
temperature is very likely to occur.
7.8 Constraint Control Design Issues
Conventional constraint control applications present unique design challenges that to a large extent
are met by user-provided configuration or custom code and logic. This is primarily due to the con￾trol strategy’s structure – it is a complex cascade, with multiple primaries and a single secondary,
and DCS “cascade rules” do not apply. As a result, one very important feature of every constraint
control application is user-provided custom configuration/logic/code to manage the initialization
and wind-up statuses of all controllers above the signal selector. The discussion that follows points
out the many other instances in which user-provided custom configuration/code/logic is needed
to include a desired design feature.
Each CV PID controller is tuned for its own response dynamics to changes in the signal selector’s
secondary. The signal selector’s secondary can be a final control element, a single control loop or a
cascade primary. CV PID controller set points are CV maximum or minimum constraint limits, and
therefore, they are rarely changed by operators. Therefore, almost all CV PID controllers are tuned
for fast load response, proportional on PV with SP Init = No. The CV controller is almost always
configured as either a PID or PI controller. Since derivative action is most useful for control loops
with deadtime, PID control is most often used for temperature and composition control loops.
If the CV’s measurement is noisy, the random fluctuations superimposed on the process signal
can make the CV PV’s rate of change significant and erratic, directly affecting the derivative action’s
magnitude and direction. The derivative action’s erratic contributions impact the PID’s output and
are transmitted to the controller’s secondary. For constraint variable PID controllers outputting
to the signal selector, if the CV is noisy, the erratic output values will complicate the selection
of the limiting constraint variable. Therefore, the active constraint variable will switch often and
randomly, resulting in poor controller performance.9
The first action to take to improve control performance in the presence of CV PV noise should
be to reduce the derivative action by decreasing derivative time, 𝜏D. As discussed in Chapter 2,
Section 2.5.2, filtering the noisy PV measurement will reduce (but not eliminate) these random
fluctuations, although it will also distort the CV signal and add an additional lag to the closed
loop response. As an alternative to PV-filtering, most modern, state-of-the-art DCSs offer a con￾figuration option to filter the derivative action’s contribution before it is used in the PID’s output
calculation. In cases where PV or derivative filtering and/or reduction in derivative action does not
adequately improve control performance, derivative action should be eliminated by replacing the
PID controller with a PI controller. Since proportional action is also adversely impacted by PV noise,
reducing proportional gain may also be helpful, although control performance may be adversely
affected. A “last resort” approach is to eliminate both derivative and proportional action by using
an I-only controller. However, because I-only controllers respond slowly to load upsets, including
those that cause an active constraint variable switch, this is best reserved for CVs that are rarely the
limiting constraint.
9 This is not a problem when a non-active CV is far from its constraint limit since the random fluctuations of its
controller’s output is far less likely to influence the signal selector’s choice of the active constraint variable.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License234 7 Conventional Constraint Control
When any CV PID controller’s PV input becomes unavailable, the CV PID controller’s PV must
be set to “Bad” to stop control action. This is done automatically by standard DCS features for a
configured PID algo or function block PV input, but not when an analyzer measurement or an
externally multiplexed input (DTI point) is declared invalid by a validity check program. If the
site’s standard input validity check program does not set the measurement’s status to Failed when
it becomes unavailable,10 then additional user-provided logic/code must do so to ensure all control
action stops and the invalid CV controller’s output is frozen.
When a CV controller’s PV input becomes unavailable and is set to “Bad,” its control action
stops and its output is frozen. If the unavailable constraint variable is considered essential to
achieving the constraint control strategy’s control objective, then the full constraint control
strategy should be decommissioned (via custom logic/code) until that constraint variable’s
measurement becomes available once again. Recommissioning can be done automatically by
user-provided logic/code or manually by informing the operator that the essential constraint
variable has become available once again and advising him/her to recommission the full
cascade.
As already mentioned, engineer-provided code/logic is necessary to enable the signal selector,
on every time step, to reset all nonactive CV controller outputs to the active constraint variable
controller’s PID output. This helps avoid sluggish control action when a load upset causes an active
constraint variable switch. This is much like standard DCS anti-reset wind-up protection for any
cascaded PID controller, which ensures a more rapid response when the controller’s wind-up status
returns to normal.
The operator interface should indicate the active constraint variable and the initialization status
and wind-up status of each CV’s controller. Because constraint variable noise can confuse the signal
selector and cause erratic active constraint variable switches, a constraint variable “switch history”
displayed at the operator’s console is useful to detect noise problems. As already discussed above,
reducing derivative and proportional action, constraint variable filtering, and/or I-only control for
CVs that are rarely the active constraint may be necessary to avoid these erratic switches.
If the unavailable constraint variable is not essential to achieving the constraint control strategy’s
control objective, and the full constraint control cascade remains on control, the possible conse￾quences are described below. The actions available to manage these consequences, which must be
provided by user-provided custom logic/code, are then described.
1. If the CV is the active constraint, the selector’s secondary (the MV) is frozen at its current value
until another CV becomes the active constraint or until the “Bad” PV returns “Good” and the
CV is again the active constraint variable.
2. If the CV declared “Bad” is not the active constraint variable, an active constraint variable’s con￾troller adjustments may drive the actual, but unknown, “Bad” CV’s PV toward or into violation.
3. If the active constraint variable’s controller adjustments force an active constraint variable
switch to the CV with a “Bad” input (by virtue of its frozen output either being the largest or
smallest among all current CV outputs), with an unknown PV value and a frozen controller
output, the MV will be frozen, and remains constant until either another active constraint
switch occurs or the “Bad” PV returns “Good.”
There are two actions that can be taken to manage these issues, and both must be provided by
custom logic/code: either (i) do not allow the CV controller with a “Bad” PV and frozen output to
be chosen by the signal selector, permitting the control strategy to remain commissioned with one
less constraint variable or (ii) decommission the entire cascade, with operators becoming respon￾sible for any necessary MV adjustments. Custom logic must also be provided to recommission the
10 See discussion of Figure 8.4 in Section 8.8.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License7.8 Constraint Control Design Issues 235
entire cascade bumplessly when the CV’s PV becomes available again – at a minimum, all CV con￾troller outputs must be initialized to the current value of the signal selector’s secondary. If preferred,
recommissioning can also be done manually by informing the operator that the CV’s PV is available
again and advising him/her to recommission the full cascade.
Discussions with operations and process engineer personnel are necessary to decide, on an indi￾vidual CV basis, the appropriate action to take when a CV becomes unavailable – decommission the
entire application, or remove the CV from consideration and allow the strategy to remain commis￾sioned with one less CV. The action taken may depend upon whether the CV whose PV has become
unavailable is the active constraint variable, or if not, is it considered an essential constraint vari￾able. And finally, a decision on how recommissioning takes place – automatically or by operator
action, requires discussions with operations personnel.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License236
8
Design Considerations
CHAPTER CONTENTS
8.1 First Steps: Process Understanding and Operating Objectives
8.2 Basic Control Attributes, Control Options
8.2.1 PID Control or Model-based Control (Section 2.7)
8.2.2 PID, PI, or I-only Control (Section 2.4.1)
8.2.3 PID Control Direction (Section 2.4.2), and Output Direction (Section 2.4.3)
8.2.4 PID Proportional Action on Error or PV (Section 2.4.5)
8.2.5 PID Derivative Action on Error or PV (Section 2.4.1)
8.2.6 Set Point Initialization (Section 2.4.6)
8.2.7 SP Clamps or Output Clamps (Section 2.8.2)
8.2.8 Filter PV or No Filter (Section 2.5)
8.2.9 Cascade Usage (Section 2.2)
8.2.10 Feedforward Control Opportunities (Sections 3.2–3.4 and 3.7)
8.3 Standard DCS Functionality
8.4 Corporate and Site Standards
8.4.1 Corporate Developed and Supported Control Packages
8.4.2 Site Developed and Supported Control Packages
8.4.3 Schematic Display Standards
8.5 Sample Time, Control Frequency and Controller Scheduling
8.6 Calculated Control Variables
8.7 Inferential Variables
8.7.1 Updating an Inferential Model’s Bias Using an Analyzer Measurement
8.7.2 Updating an Inferential Model’s Bias Using Laboratory Data
8.8 Input Validation
8.9 Flow Compensation
8.10 Cascade Initialization and Wind-up Protection
8.11 Alarming and Operator Messaging
8.12 Interactions with Other Control Strategies
8.12.1 Two-Product Light-ends Tower Quality Control
8.12.2 Heat Integrations
8.13 Testing to Judge Control Strategy Acceptability
References
For advanced regulatory control and conventional advanced control applications to achieve their
control objectives and capture benefits, they must remain commissioned. Factors that will help
achieve high service factors are: (i) control objectives are well understood by operators and aligned
with unit operating objectives and economic drivers, (ii) good operator training provided to
prepare operators for commissioning, (iii) good operator documentation provided to sustain high
service factors, and (iv) operator participation in the application’s pre-commissioning testing and
tuning. All factors help promote pre-commissioning operator understanding, enthusiasm, and
ownership of the application.
Practical Process Control Design with Industrial Applications, First Edition. Alan M. Kugelman.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License8.1 First Steps: Process Understanding and Operating Objectives 237
A control application will remain commissioned if its control performance does not attract oper￾ator attention. If operators observe erratic, incorrect, or limited control adjustments over time, they
eventually decommission the control application. Therefore, the strategy must perform well and be
widely accepted by operators to maintain a high service factor. However, even with a high service
factor, the control strategy may not be achieving its control objectives. This must be established by
the control engineer responsible for the strategy’s design, commissioning and/or its post commis￾sioning maintenance. A control strategy must achieve its control objectives in order to capture its
potential benefits.
Control strategies normally perform well when plant operations are close to those that existed
when the strategy was first tested, tuned, and commissioned. However, operating plans are
modified over time to manage changing business drivers, and as operating conditions change,
some maintenance may be needed to increase the strategy’s robustness. This kind of maintenance
is expected, and not easily avoided. However, ongoing maintenance not related to operational
changes is time-consuming and diverts control engineer effort away from more worthwhile
tasks. Therefore, the control strategy must have a high service factor, but also require mini￾mum post-commissioning maintenance. Good control engineer documentation is necessary to
efficiently support ongoing maintenance.
To summarize, a control application that is well designed will exhibit and/or possess the follow￾ing characteristics:
1. Widespread operator acceptance and high service factors – helped by effective pre￾commissioning operator training and good operator documentation.
2. Control objectives achieved, and potential benefits captured.
3. Post-implementation maintenance, supported by good control engineer documentation, kept to
a minimum.
These characteristics are broad goals that if achieved will validate the control application’s design.
However, the control technology and DCS functionality that underlie a control strategy’s design are
fundamental to achieving these broad goals. Also, considerable thought is required to choose the
control components, construct the logic, and develop the cascade structures needed to ensure a
suitable control strategy design.
As will be stressed throughout this chapter, here is a “first principle” to accept for the design of
a control strategy: it is always best to use the simplest, most reliable approach available. In practice,
this means use as many DCS standard features and proven standard control packages as possible.
Thus, the best starting point for designing a control strategy is to maximize the use of DCS stan￾dard features and functionality. If all control requirements cannot be managed using DCS standard
features, then it is best to use corporate developed and supported standard control packages. If still
more functionality is needed, then use site specific, standard control packages. Develop an applica￾tion specific custom approach to complete the design only if these three resources cannot provide
all required functionality.
This chapter explores how best to apply specific control features, options, DCS functionality,
and corporate or site standards to develop a well-designed control strategy that helps ensure the
previously listed three broad characteristics are achieved.
8.1 First Steps: Process Understanding and Operating Objectives
A process control application’s control objective must align with the plant’s real-time operational
environment. It must support the achievement of the process unit’s operational objectives, and the Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License238 8 Design Considerations
elements of the site’s business plan that are relevant to the unit. Therefore, understanding the pro￾cess unit’s configuration, its operating objectives, and the specifics of how its operating objectives
are achieved is a fundamental prerequisite for effective design. The very important role of pro￾cess analysis – how it impacts the understanding of the process and ultimately its influence on the
design of advanced control applications, was presented in Chapter 4.
Process analysis provides a better understanding of the unit’s operations and operating objectives,
and how its most important process variables are impacted by unit operations. It is the primary
mechanism used to identify the unit’s essential PVs, and then classifying them as likely MVs or
DVs – independent variables that can be changed, or as likely CVs – dependent variables that cannot
be changed but are impacted by the likely MVs and DVs. The integration of process knowledge and
the unit’s operating objectives enables the control objectives to be defined, and the control strategy’s
CVs, MVs, and DVs to be chosen and potential constraints to be identified. This is the first, and
perhaps the most important step in the design process.
Here are the most important process variable characteristics and issues that are normally con￾sidered and assessed when likely CVs, MVs and DVs are chosen:
● Interactions among likely MVs and CVs.
● Strong or weak sensitivities among likely CVs and MVs.
● CV–MV pairings that have very slow responses and/or feature long deadtimes.
● Are potential DVs with important impact on likely CVs measured, or if not, can they be calculated
or inferred.
● By how much and in what way do potential constraints bound the MV, CV region of feasible
operations.
● Are measurements and/or control valves needed to fully achieve the strategy’s control objec￾tive(s) unavailable or missing.
● Can the cost, both hardware and installation, of any new measurements and/or control valves be
justified by the control strategy’s estimated incentives.
The control strategy’s design, which incorporates the CVs, MVs, DVs, and constraints into a control
technology of choice, is heavily dependent upon these findings.
8.2 Basic Control Attributes, Control Options
There are a number of important controller related attributes (e.g., control direction) and options
(e.g., PID proportional action) that must be specified when a control strategy is designed and devel￾oped. These attributes and options, fundamental to proper control algorithm execution, have been
introduced, explained, and illustrated in many examples in Chapters 2 (Feedback Control Essen￾tials) and Chapter 3 (Feedforward Control Essentials). Guidelines were presented for assigning
appropriate attribute values and choosing appropriate options. These guidelines are summarized
below with chapter/section references for further explanation.
8.2.1 PID Control or Model-based Control (Section 2.7)
For almost all cases, the PID control algorithm is the preferred control technology for advanced
regulatory and conventional advanced control applications.
The only time single-input, single-output model-based control might be preferred over PID
control is for a control loop with considerable deadtime (e.g., quality control in a light-ends Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License8.2 Basic Control Attributes, Control Options 239
tower) or unusual dynamics (inverse response). However, experience indicates that a conventional
model-based controller’s practical scope is limited to 2 CVs and 2MVs – anything larger, especially
if there are MV constraint limits, becomes unmanageable and more suited for DMC. Currently,
virtually all conventional model-based controllers are limited to one CV and one MV, or possibly
one CV, one MV and one DV.
DMC is the clear choice when the numbers of CVs, MVs, and DVs, their interactions and/or the
number of potential constraints increase, and the scope of the control problem becomes larger than
2 CVs and 2 MVs or one CV, one MV, and one DV.
8.2.2 PID, PI, or I-only Control (Section 2.4.1)
PI is the most often used form of the PID algorithm. Almost all flow controllers are PI. Most pres￾sure controllers are PI as well; exceptions occur in some tower applications when condenser duty
or reflux flow rate is manipulated to control tower pressure. Whether tuned for tight or averaging
level control, or if it is a single loop or a cascade primary, a level controller rarely includes deriva￾tive action. The only exceptions are cases where there is significant deadtime and slow dynamics
between the MV and the level. The full PID algorithm is used to control some temperature con￾trol loops (e.g., tray temperature and COT control), and for control loops whose control variable’s
response to MV changes include deadtime, i.e., some temperature and many product quality (ana￾lyzer) controllers.
Measurement noise on a CV presents a problem for derivative action – the random fluctu￾ations superimposed on the process measurement make the rate of change of the CV erratic
and significantly affects the derivative action’s magnitude and direction. This propagates the
CV’s measurement noise to the MV, and perhaps to other portions of the process. If noise
propagation to the MV is not acceptable, then the PI algorithm is often used. However, most
modern state-of-the-art DCSs provide an option to filter the derivative term before it is added
to the PID controller’s output calculation. If derivative action is needed, and derivative fil￾tering is available as an option, derivative filtering is normally preferred over switching to
a PI.
The I-only algorithm is slow, but it is sometimes used in constraint control, especially if the
CV is infrequently the active constraint. The I-only algorithm is the least sensitive to noise, so
it is used when noise is so prevalent that proportional action, in addition to derivative action,
must be eliminated. Noisy PVs in a constraint control application (see Section 7.8) can cause
erratic and random switching of the active constraint; if so, the I-only algorithm is a good
option.
If the noisy measurement is a control variable, and noise propagation to the MV is unacceptable,
filtering the CV using the linear exponential filter is an option – see Section 8.2.8.
8.2.3 PID Control Direction (Section 2.4.2), and Output Direction (Section 2.4.3)
Control direction specifies whether a controller’s output should increase (Direct) or decrease
(Reverse) when its PV is increasing or is above its setpoint. In the two examples below in
Figure 8.1, (discussed previously in Chapter 2, Figure 2.13), LC131’s control direction would be
configured as Direct (increase output to increase bottoms flow when the level PV is increasing),
while TC136’s control direction would be configured as Reverse (decrease output to decrease the
steam rate when PV is increasing). In a model-based controller, the sign of the model’s process
gain determines the control direction.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License240 8 Design Considerations
T
1
1
5
FC
155
Steam
FI
126
LC
131
FC
126
TC
136
TI
136
FV155 FV126
Figure 8.1 Process Configuration for Assigning Control Direction to LC131 and TC136
Output direction applies only to ultimate secondaries, specifically PID controllers outputting
to a valve. Modern day DCS functionality handles a valve’s failure mode via an analog output
(AO) block, configured to receive the ultimate secondary’s output, independent of the ultimate
secondary’s control direction. The output direction’s value (Director or Reverse) is assigned to the
AO block depending upon whether the valve fails open, i.e., it is an air-to-close valve (output direc￾tion = Reverse) or the valve fails closed, i.e., it is an air-to-open valve (output direction = Direct).
Thus, an ultimate secondary with the correct control direction will achieve its control objective no
matter the valve’s failure mode. This means the ultimate secondary’s control direction can be spec￾ified assuming the valve opens (closes) as the ultimate secondary’s output increases (decreases).
In Chapter 2, Section 2.4.3, control and output directions for an ultimate secondary outputting to
an air-to-close valve (see Figure 2.14) and an air-to-open valve (see Figure 2.15) are presented and
discussed.
A model-based controller will never be an ultimate secondary, so configuring output direction is
not an issue.
8.2.4 PID Proportional Action on Error or PV (Section 2.4.5)
If fast response to set point changes is the desired control objective, proportional on error is the
recommended option. If fast response to load changes is the desired control objective, proportional
on PV is the recommended option. For all cascade secondaries and all single-loop flow controllers,
the recommended option is to tune for fast set point response, with proportional on error. Because
their set points are almost never changed, for all level controllers and all cascade primaries con￾trolling a product quality, the recommended option is almost always to tune for fast load response,
with proportional on PV. Temperature and pressure controllers, whether a single-loop controller
or a cascade primary, or a controller that is both a secondary and a primary in a multilevel cascade,
require analysis of unit operating objectives and their control objectives before a PID proportional
option can be assigned.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License8.2 Basic Control Attributes, Control Options 241
8.2.5 PID Derivative Action on Error or PV (Section 2.4.1)
If derivative action is on error, a set point change can cause an unnecessarily large initial change
in the controller’s output and complicate the normal reliance on proportional action to respond
to a set point change. However, by configuring derivative action on PV instead of error, set
point changes do not directly affect derivative action. Therefore, provided the DCS offers a
derivative on PV option (true for most modern-day DCSs), the PV option is the recommended
choice.
8.2.6 Set Point Initialization (Section 2.4.6)
Setting a controller’s set point equal to its PV on an initialization pass is called Set Point
Initialization (SP Init). Depending on the DCS, the terms PV Tracking, and SP Tracking are used
and are very similar to SP Init. Set point initialization is a configurable parameter assigned a
value of Yes (or True) or No (or False) at controller build time. If SP Init = Yes, the controller’s
PV value will be stored to its set point whenever the controller is in Manual mode or is executing
on an initialization pass. Note that SP Init is an issue for any feedback controller – PID, ratio,
model-based controller, and so on.
A primary controller whose set point is very rarely changed, i.e., a level controller, is nor￾mally configured for SP Init = No. Any cascade primary, including a model-based controller,
controlling a product quality whose set point is a PTS guideline target that is almost never
changed, is also normally configured with SP Init = No. All cascade secondaries are configured
for SP Init = Yes. Thus, for a multilevel simple cascade, configuring all secondaries for SP
Init = Yes (including the ultimate secondary) should ensure bumpless transfer up to the ultimate
primary. The SP Init decision for a primary controller (other than one whose setpoint is very
rarely changed) must be made on a loop by loop basis; discussion with operators and/or PTS
personnel are recommended. When a primary’s setpoint is a meaningful PTS guideline value, SP
Init = Yes can be chosen to provide bumpless transfer, but it is best if user configuration/logic
is also provided to slowly ramp the initialized set point back to the desired PTS guideline
value.
8.2.7 SP Clamps or Output Clamps (Section 2.8.2)
A secondary controller’s setpoint clamps and its primary controller’s output clamps accomplish
the same goal – they enforce a high and/or a low constraint limit on the value of the secondary’s
set point, and hence the secondary’s PV. SP clamps are in EUs of the secondary and therefore are
operator- and engineer-friendly. OP clamps are in % of range of the secondary and therefore less
meaningful to operators and less straightforward to change. Operators and control engineers usu￾ally prefer to use set point clamps.
When a secondary set point clamp is reached, the secondary’s wind-up status is set to either
High or Low. And the next time it executes, the primary’s wind-up status will also be set to
either High or Low. When a primary output clamp is reached, the primary’s wind-up status is set
to either High or Low; however, the secondary’s wind-up status is unchanged.
Tight secondary set point clamps and/or tight primary output clamps are often used when the
primary controller is being tuned. As tuning progresses, and more confidence in the primary’s
control performance builds, the clamps are widened. If secondary set point clamps are needed to
enforce real process constraints, when tuning is complete, they must be returned to their desired
values.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License242 8 Design Considerations
8.2.8 Filter PV or No Filter (Section 2.5)
To filter or not to filter is an issue when the noisy measurement is a control variable, and noise
propagation to the MV is unacceptable. The linear exponential filter is by far the most frequently
used filtering algorithm. However, filtering not only smooths the noisy signal it also distorts
it – slows it down and adds additional lag to the control loop. As noise rejection is improved by
increasing the exponential filter’s time constant (𝜏F), signal distortion also increases, and filtering
can become a trade-off between noise rejection and signal distortion. At constant 𝜏F, decreasing
the filtering scan time (TS) to filter faster increases noise reduction. Also, since changes in scan
time do not affect signal distortion, scanning faster to increase noise reduction has no signal
distortion trade-off. Therefore, if filtering is desired, the objective is to filter CVs only enough to
reduce the noise transferred to the MV to an acceptable level, while reducing signal distortion by
scanning as fast as practical to increase noise reduction and allow 𝜏F to be reduced.
Because filtering adds an additional lag to a control loop, if CV filtering is needed, it is impor￾tant to add the filter prior to doing plant tests, whether the purpose of the plant test is to identify
a dynamic model to help establish initial PID tuning constants, or to use it in a model-based con￾troller. If filtering is added after the control loop is commissioned, PID retuning may be necessary.
And in a model-based controller, additional model error will be introduced which may degrade
controller performance.
8.2.9 Cascade Usage (Section 2.2)
When used properly, cascades improve control loop performance. Cascade control is most effective
when there are differences in the CV–MV and/or CV–DV dynamic response parameters between
primary and secondary loop CVs. This provides enough time for the secondary to bring its PV back
to set point after an upset before the primary’s PV is affected. Cascades isolate fast disturbances, i.e.,
pressure – flow variations across a control valve, to a faster, lower loop (a flow controller) before the
slower primary loop (a level controller) is affected very much. This helps prevent large deviations in
the level, the main process variable, whose control response is much slower than a flow controller.
In addition, the cascade’s flow controller makes it easier for operators to fix the flow at a desired
rate – transfer the flow controller to Auto and enter the desired set point, instead of transferring
the level controller to Manual and changing the valve position.
In a light-ends tower, a tray temperature responds faster to a load upset, with less deadtime, than
an overhead or bottoms product quality analyzer measurement. Thus, if an analyzer controller is
cascaded to a tray temperature controller, the temperature controller can in principle correct for an
upset before the analyzer measurement is affected very much. Without the tray temperature con￾troller, MV control adjustments do not start until the quality measurement is affected and deviates
from its set point. And because of the longer deadtime, good control performance is more diffi￾cult to achieve. Also, when the analyzer feedback is disabled (measurement is declared invalid),
the quality can still be controlled inferentially by continuing to control the tray temperature at a
desired value that infers the product quality.
In modern-day DCSs, converting a CV → valve to a CV → flow → valve cascade (CV = level or
temperature) requires very little additional hardware or software resources if the flow measure￾ment is available. It is normally best to use cascades except for special control-sensitive loops, for
example, level → valve is a better choice than level → flow → valve when the vessel’s hold-up is
small, and the level controller must respond rapidly to upsets.
In modern-day state-of-the-art DCSs, cascade initialization and wind-up protection are standard
features, so-called “cascade rules,” that apply to only simple cascades – cascades with one ultimate Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License8.3 Standard DCS Functionality 243
secondary and one ultimate primary. For complex cascades – cascades with more than one ultimate
secondary and/or more than one ultimate primary, control initialization and wind-up protection
must be managed by user provided custom configuration/coding. To reduce engineering resources
and simplify testing, tuning, commissioning, and routine long-term application maintenance, it is
best, whenever possible, to design control strategies as simple cascades.
8.2.10 Feedforward Control Opportunities (Sections 3.2–3.4 and 3.7)
Feed rate feedforward control is almost always justified for light-ends towers, fractionators, fired
heaters, and reactors. Feed rate feedforward control is almost always full-valued – ratio control with
the feed rate the ratio controller’s wild flow input. If the feed rate is controlled, and PV noise is a
problem or minimizing input variability is an objective, the ratio controller’s wild flow input can
be configured to be the feed flow controller’s SP instead of the feed flow’s PV. However, if the SP
option is chosen, the feed flow controller must either be configured for SP Init = Yes, or custom
logic/configuration added to use the wild flow PV as input when the wild flow controller is in
Manual mode or is wound-up – when the feed rate’s PV and SP may be quite different.
Both steady-state and dynamic ratio feedforward control are used; the choice between the two
depends upon the relative magnitudes of the CV–MV and CV–DV dynamic response parameters
(first order time constants, deadtimes). In most tower, fired heater, and reactor applications, these
dynamic parameter magnitudes are different enough to require dynamic feedforward control. In
dynamic feed rate feedforward control, the feed rate is dynamically compensated, using deadtime
and lead/lag algorithms or function blocks, before it becomes the ratio controller’s wild flow input.
Steady-state ratio feed rate feedforward control is almost always used for fractionator or light-ends
tower steam/bottoms ratio control, sidestream stripper tower steam/bottoms or steam/feed ratio
control.
Due to the specific process variables used in their calculation, control of tower reboiler duty,
tower internal reflux, and a pressure compensated tower tray temperature all provide feedforward
compensation when included in a tower feedback control strategy. Reboiler duty calculation and
control provide feedforward corrections for upstream and downstream upsets that affect its hot
side’s flow and inlet temperature. Internal reflux calculation and control provides feedforward cor￾rections for tower energy balance upsets that impact the reflux return temperature, most notably
after weather upsets. Control of a pressure compensated tower tray temperature provides feed￾forward corrections for a light-ends tower’s pressure variations. Reboiler duty and internal reflux
controls are included in many tower advanced control strategies. Control of a pressure compen￾sated tower tray temperature is less common – only when tower pressure is uncontrolled, or tower
pressure minimization is implemented.
8.3 Standard DCS Functionality
To properly and efficiently design and implement a control strategy, the DCS work environment
described in Chapter 2, Section 2.3, must be well understood by the control engineer. The most
important functionality to master are (i) the DCS user interface to build, test and commission a
control application and (ii) DCS features that directly support control strategy design and imple￾mentation. Knowing how best to use DCS functionality to connect and/or link controllers to create
a control strategy structure is also necessary. Achieving the strategy’s control objectives with accept￾able control performance is the overall goal. However, the safeguards that must be provided to help Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License244 8 Design Considerations
prevent process upsets, avoid safety hazards, and to respect process constraints are also essential,
and their inclusion is usually a significant portion of the total effort.
When developing an advanced regulatory or a conventional advanced control application design,
it is always best to use the simplest, most reliable approaches available that will allow the control
strategy’s control objectives to be achieved. Therefore, extensive use of standard DCS features is
always recommended. Use DCS standard PV algorithms, control algorithms, function blocks, utili￾ties, and tools whenever possible. They have been used and are still being used worldwide by many
customers with unique control needs in many different environments, and countless problems,
bugs and functional shortcomings have almost certainly been identified and addressed over the
years. Because these standard features have proven functionality and reliability, initial debugging,
testing, and online check-out of control applications takes less engineering effort, over a shorter
time period. If all site control engineers use these common DCS approaches, not only is the original
design and commissioning work less manpower intensive, so is all long-term maintenance.
As discussed in Chapter 2 and referenced throughout this book, standard DCS features, called
“cascade rules,” manage cascade commissioning and decommissioning, cascade initialization, and
wind-up protection, and output and set point clamping for simple cascades – those with one pri￾mary and one secondary, but not for complex cascades – those with multiple primaries and/or
multiple secondaries. Thus, control strategy designs that are simple cascades are always strongly
recommended. Complex cascades require custom code/configuration to manage these important
and complex control actions, and avoiding them helps minimize application development, testing,
commissioning, and maintenance resources. Even if the control strategy is a simple cascade, using
any non-standard approach to implement a control calculation requires additional thought, and
perhaps logic and code, to ensure that DCS standard cascade rules still apply.
8.4 Corporate and Site Standards
In all cases, and as recommended in the last section, using as many standard DCS features as pos￾sible is always best. However, control scenarios periodically arise that cannot be managed with
standard DCS features alone.
8.4.1 Corporate Developed and Supported Control Packages
If a specific control scenario is encountered multiple times per site and across multiple sites, a
corporate designed, developed and supported standard control package has high return. It estab￾lishes a corporate best practice, provides a well-tested, proven control tool, and is a method for
the corporation’s central engineering organization to further unify affiliate site approaches to con￾trol application design and/or implementation. Note that in addition to an operating company’s
standard control practices, it is likely that DCS vendors and other contractors who provide onsite
advanced control services also have their own standard packages.
Based on the control strategies presented and discussed up to this point, some examples of possi￾ble corporate standards that would likely be widely applicable are listed below. Note that standard
control packages that support complex cascade structures and/or other non-standard control cal￾culations must provide bumpless transfer on initialization passes and correctly resolve cascade
wind-up issues.
● Input signal validation – to be discussed in Section 8.8.
● Laboratory sample result validation – to be discussed in Section 8.7.2.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License8.4 Corporate and Site Standards 245
● Steady-state and dynamic feed rate feedforward control.
● Multiple input (CVs) single-output (MV) constraint control (a very important example of a com￾plex cascade).
● Tower reboiler duty control.
● Tower internal reflux control.
● Fired heater duty control.
● Resolution of initialization and wind-up statuses for complex cascades – with more than one
ultimate primary and/or more than one ultimate secondary.
● On/Off switch for complex cascades.
● User-friendly set point ramping setup – ramp time or ramp rate, and final set point entry on an
application’s display.1
The functionality provided by many of these standard control packages have already been
included in many of the advanced regulatory and conventional advanced control application
designs presented and discussed to this point – many more application designs that use this
functionality are included in subsequent chapters.
8.4.2 Site Developed and Supported Control Packages
There are occasions in which use of a corporate standard control package does not completely sat￾isfy a site’s specific control need. In such cases, and if a revised version would be applicable multiple
times across the site, the site can create a site-specific version of the corporate standard. However,
the site’s use of custom logic/coding/configuration to develop their revision can require significant
checkout and debugging time during its development and add a long-term maintenance burden.
Because copying and using existing pre-tested and running code reduces the introduction of faulty
logic and other errors, sites typically incorporate as much as possible of the corporate standard’s
design and execution details into their site-specific version. This approach is also recommended
when a “one-of-a-kind” custom approach is needed – any code or logic that can be taken from a
corporate or site standard, or a similar, running application on another unit, will help reduce the
development and testing effort.
However, no matter how much of the corporate standard’s approach is preserved, a site-specific
version has an important downside – if and when the company standard is upgraded, it is the site’s
responsibility to upgrade their version. This can be especially troublesome when it is necessary to
change the code/logic to accommodate a DCS vendor’s software and/or hardware upgrade.
8.4.3 Schematic Display Standards
Schematic displays provide the operator interface to both plant operations and control applica￾tions and are universally accepted as the most effective and widely used operator user interface.
Application schematics present an application’s cascade structure and all process inputs, outputs,
calculations, and control statuses associated with its execution and performance. The primary
responsibility for the application schematic’s design rests with the control engineer who com￾missions the application; long term maintenance needs are the responsibility of the control engi￾neers that follow. All sites have schematic display standards, developed in conjunction with the
operations staff and/or the DCS vendor. Display standards ensure a consistent interface to both
operations schematics and applications schematics and their use by all who design and/or build
1 Set point ramping is a standard feature in most DCSs, but the ramp setup involves multiple operator console
entries.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License246 8 Design Considerations
schematics is required. Therefore, like other site standards, an application schematic designed by a
control engineer to support a new control strategy must be carefully aligned with the site’s display
standards.
8.5 Sample Time, Control Frequency and Controller Scheduling
Sample time, control frequency, and controller scheduling are less important in today’s control
world than in previous years. State-of-the-art DCS technology allows advanced regulatory and con￾ventional advanced control strategies to be built in process connected devices where scan rates are
extremely fast and numerous. In these process-connected devices, there are no important resource
limitations to prevent the scheduling of most resident controllers at very fast scan times, i.e., two
seconds or faster. At these fast scan rates, positioning controllers to execute in a specific order, is not
normally a concern – if primary and secondary controllers have one second scan rates, no matter
what their order of execution, a one second increase in loop deadtime will normally be insignificant.
However, for control cascades running in a computing module such as a TDC3000 AM, schedul￾ing is still an issue. Software and hardware resource limitations, and ultimately cost, restrict the
amount of fast scanning in these devices. Therefore, cascades are built with controllers having
different scan rates, and with scan rates decreasing (processing getting slower) from ultimate sec￾ondary (for example, TS = 4 seconds) to ultimate primary (for example, TS = 64 seconds). To help a
secondary controller achieve its objective – to make its PV ≈ SP before its setpoint is changed next
by its primary, a secondary controller is normally scheduled to execute two to four times before
the next primary execution. Also, to avoid slowing the control loop’s response, the secondary is
normally scheduled to execute immediately after the primary controller. Standard DCS attributes
such as before/after, phase, and variable processor ID, are assigned at controller file-build time to
implement the desired execution order.
Note that these attributes – before/after, phase, variable processor ID, etc. are still used today,
even in state-of-the-art DCSs, when needed to implement desired scheduling. Also, functional￾ity to “slow down” control execution while scanning fast to optimize filtering is widely available
and used.
8.6 Calculated Control Variables
Some important process variables needed for control are not measured (i.e., reboiler duty) but can
be calculated using other measurements (i.e., hot fluid flow, inlet and outlet temperatures), some￾times supplemented by physical properties (heat capacity, CP). In a modern-day DCS, the use of
calculated PVs and custom control algorithms do not usually pose a problem. However, problems
do arise using custom code/logic to develop PVs and/or control strategies in older DCS process
connected devices (e.g., TDC3000’s PM). In these older devices, hardware performance degrades
as more and more custom coded programs are loaded and run in real time. Software resource lim￾itations are encountered, and the cost of additional hardware/software can become an issue. Note:
State-of-the-art DCSs support and encourage the use of custom programs in process connected
devices (e.g., Experion’s C300), but many users are somewhat reluctant to do so because they still
fear performance degradation and resource limitations.
All DCSs normally provide standard operational algorithms (e.g., add, divide, multiply, and
average) that can sometimes be used to generate controller PV input values without custom code.
In state-of-the-art DCS’, standard function blocks that perform similar mathematical operations Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License8.7 Inferential Variables 247
can be connected to generate controller PV input values without custom programming. In addition,
the computation of common, calculated CVs like tower reboiler duty, tower internal reflux, heater
duty, and fractionator pumparound duty are usually available as standard packages used site-wide
(or company-wide, if appropriate). These standard calculation packages are normally available for
use in either advanced process connected devices such as TDC3000’s HPM or Experion’s C300,
and non-process connected (outboard) devices such as TDC3000’s AM and Experion’s ACE.
Likewise, control calculations are best implemented using standard DCS control algorithms,
standard DCS function blocks, or standard control packages; user developed custom coded pro￾grams are the default option when all else fails. In state-of-the-art DCS’, function blocks provide
both mathematical and logical operations (≤, ≠, ≥, max, min, and so on). Therefore, even user
developed control calculations that include logic checks and logic driven actions can be configured
using standard DCS function blocks.
Important: These function blocks permit CVs to be calculated, and reliably and safely controlled,
in a process connected device, with no programming or custom code. However, be aware that pro￾ducing effective documentation for such a control strategy, spread across a number of display pages
that feature fifty or more connected function blocks, is problematic and time consuming. This can
make a control strategy’s long-term maintenance more difficult and time consuming.
Remember: Because the control strategy will be easier to build, test, commission and maintain,
the use of standard algorithms and standard function blocks are always the preferred options for
developing a control strategy design. Engineer-provided custom coded program(s) and logic are
the default option when the standard approaches cannot provide the necessary functionality.
8.7 Inferential Variables
A steady-state inferential quality model, with model update using periodic lab data, can be useful
when control of a product quality has benefits but they are not large enough to justify the pur￾chase, installation, and maintenance of an online analyzer. However, even if there is an online
analyzer installed, there are situations when a steady-state inferential model’s prediction, with
model update using the online measurement, can be used effectively. This approach is especially
beneficial when analyzer sample times are very long, e.g., there are long time intervals between
quality measurements. In addition, this approach will also help if reliability or service factors are
below expectations, or a return to normal service can be delayed by poor maintenance. If the infer￾ential model provides a good estimate of the quality, effective control can still be achieved between
analyzer measurements or even when the analyzer is out of service (or its measurement is invalid).
This is the primary benefit of this approach.
If periodically collected lab samples are considered reliable, then fresh lab results can guide
operators when they make an online adjustment to better hold a quality at its desired target – for
example, a change in a light-ends tower tray temperature controller’s set point, to better meet the
tower’s product quality requirement. However, if lab samples can be captured and historized in
sufficient numbers over many time intervals, it is possible, although a difficult and resource inten￾sive task, to develop a steady-state inferential model using the historized lab data. If reliable, the
model can provide a reasonable estimate of quality between lab sample results. It could also be a
first step toward implementing a model-based control strategy that uses lab sample data to update
the model bias.
Significant amounts of operating data are needed to develop an effective inferential model. The
steady-state inferential model calculates a quality PV prediction from measured and calculated PVs Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License248 8 Design Considerations
that are known to have an important impact on the quality; these PVs are the model’s independent
variables. The inferential model is developed by correlating historized hourly averages of quality
measurements with historized independent variable hourly averages, using only data collected
when operations are at (or close to) steady state. When the quality is not measured, but lab sam￾ples can be collected and analyzed in sufficient numbers, it is the historized lab results that must
be correlated with the independent variable hourly averages. The inferential model is developed
by matching and correlating the historized lab sample results to the values of the historized inde￾pendent variable hourly averages just prior to the sample time, provided operations at the sample
times were at steady state.
The model development task is much more difficult using lab data compared to using online
quality measurements – there are issues with sampling frequency, establishing the actual sample
time, sample contamination, lab data result validation, mapping historized independent variable
values to sample time, and so on. Therefore, inferential model development using online analyzer
measurements will almost always provide a better prediction and better performance than model
development and bias updating based on lab data.
The discussions in this section are limited to how analyzer measurements and laboratory
results are used to update an inferential model. There are no discussions of the very challenging
model development task – however, there are numerous statistical methods available to develop
steady-state inferential models and confirm the model’s capabilities (Ref. [1]).
It is assumed the linear inferential model in Equation (8.1) below has already been developed
and validated. Other than the statistical correlation method’s dimensionality and/or data man￾agement restrictions, in principle, there is no limit to the number of independent variables that
can be included in an inferential model. For this discussion, it is assumed that correlating four
independent variables with quality provides a good prediction. The five model coefficients b0 .... b4,
calculated by a linear regression model building methodology, provide a best fit of data to the
linear correlation in Equation (8.1):
PV Prediction = b0 + b1 ∗ X1 +…+ b4 ∗ X4 (8.1)
In Equation (8.1):
PV prediction Quality prediction
b0 Leading model coefficient – assumes the role of model bias, and is
updated online
X1…X4 Independent variables
b1, …b4 Linear model coefficients for independent variables X1 … X4
The leading model coefficient, b0, is one of the five model coefficients that yield the best data
fit. However, whether the model is used online for prediction, monitoring, or control, b0 assumes
the role of the model bias and is updated periodically when a new, valid analyzer measurement or
a fresh, valid lab result becomes available. Note that in Equation (8.1) the model coefficients b1,
b2, … b4 play roles that are analogous to a steady-state gain – they are the change in the predicted
PV per unit change in an independent variable, ΔPV Predication/ΔXk. This is important because it
provides a magnitude and sign consistency check for the b1 … b4 – their relative magnitudes can be
judged as reasonable or not, but their sign, positive or negative, must be correct. If the model’s use
in an online control strategy is to be considered, among the four independent variables, X1…X4,
there must be a potential MV and perhaps potential DVs – an MV must be measured or calculated
and controlled, DVs must be measured or calculated.
To use Equation (8.1) online, whether in a control strategy or as a quality indicator for oper￾ator monitoring, requires quality PV – Xk dynamic response parameters for all Xk, k = 1, …4. Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License8.7 Inferential Variables 249
For example, assume a light-ends tower distillate product’s quality is measured but the analyzer
providing the measurement has a relatively low service factor. If the development of an inferential
model that predicts the quality is proposed, among the possible independent variables to include
would be reflux flow (a potential MV), and potential DVs feed rate, feed temperature and reflux
return temperature. But the distillate product quality’s dynamic response to changes in each of
these independent variables would be quite different – clearly the feed rate and feed temperature
responses would be slower than either the reflux flow or return temperature responses. There￾fore, the quality responses to changes in these independent variables require time synchronization
before the Xk values are used in the steady-state inferential model to predict quality.
Assuming first order plus deadtime models are adopted as the standard for the time synchroniza￾tion, a first order time constant (𝜏) and deadtime (𝜃) must be estimated for the quality’s response to
each independent variable. Plant tests, followed by data collection and parameter estimation, pro￾vide the necessary dynamic parameters (𝜃 and 𝜏). If the predicted quality is measured online, the
plant testing and data analysis that determine the quality PV – Xk dynamic response parameters
are straightforward. However, the analyzer must of course be in service when plant tests are per￾formed and the dynamic data collected. Also, only validated quality measurements can be included
in the data set used for model development.
If the predicted quality is not measured, lab data must be used to determine the quality PV – Xk
dynamic response parameters. For a suitable change in the independent variable, the quality’s
response is determined via the collection, analysis, and historization of lab samples obtained
frequently enough to accurately capture the quality’s response over the time interval needed
to approach the new steady state. As already mentioned, there are many potential problems
associated with the use of lab data in plant testing that can limit the test’s practicality. The most
important are (i) incorrect sample time stamps, (ii) planning and executing frequent sampling
and lab data analysis, (iii) poor sample handling that corrupts the sample, (iv) establishing the lab
analysis’ normal variability limits, i.e., its repeatability, and (v) the need to validate each lab value.
Remember: For these reasons, when an online quality measurement is not available, and plant
testing must use quality lab data, it is significantly more difficult to develop a useful inferential
model.
8.7.1 Updating an Inferential Model’s Bias Using an Analyzer Measurement
Figure 8.2 presents an overview of how a steady-state inferential model is used online to predict
quality, and how the inferential model is updated using online quality analyzer measurements:
The inferential model’s independent variables, X1 … X4, are time synchronized in the Indep.
Variable Time Synchronization block. These calculations lag and delay each independent variable,
Xk, using the first order+deadtime model parameters of their PV prediction – Xk’s responses.
These calculations are executed at normal control frequencies. The time synchronized indepen￾dent variables, X∗
j for j = 1, …4, are the Steady-State Inferential Model block’s inputs. This block
contains the inferential model introduced in Equation (8.1), with b0 designated as the model’s bias,
and all independent variables time synchronized:
PV Prediction = Current Bias + b1 ∗ X∗
1 + b2 ∗ X∗
2 + b3 ∗ X∗
3 + b4 ∗ X∗
4 (8.2)
The PV prediction calculation is executed at a normal control frequency, and thus it incorporates
the effects of changes in all independent variables. Each calculated PV prediction is time/date
stamped and historized.
When a valid analyzer measurement is used to update the inferential model bias, the current
predicted quality PV and the measured quality PV are differenced to calculate the raw bias, e.g., Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License250 8 Design Considerations
X Indep. variables 1, X2 ... X4
X1*, X2* ... X4* Indep. variables,
time synchronized
Steady state
inferential
model
Process
X2 X3
Indep. variable
time
synchronization
X1 X4
X2*
X4*
X1*
X3*
Valid result?
Measured quality PV
invalid or unavailable
Yes No
Measured
quality PV
Measured quality PV 
Predicted
quality PV
for online use
Independent
variable PVs
Updated
inferential
model bias
Predicted
quality PV
Inferential model bias update
Raw bias =
prediction error 
Bias
filter
Update model
bias?
Yes No
Do not update
model bias this pass
Figure 8.2 Steady-State Inferential Model Prediction, Model Bias Update via Analyzer Measurement
the prediction error:
Prediction Error = (Predicted Quality PV − Measured Quality PV) (8.3)
The updated inferential model bias is calculated after filtering the prediction error. It is a stored
input to the Steady-State Inferential Model block, and is used to predict the quality PV until the
model bias is updated once again. The Update Model Bias? block determines the model bias update
frequency – this block’s user-provided custom configuration determines when a model bias update
is performed.
Note that in addition to a predicted quality for monitoring or perhaps control, a future
steady-state quality can also be predicted. The predicted future steady-state quality is estimated
using the inferential model in Equation (8.1) with the current values of the independent variables
(without time synchronization) – X1, X2, X3, X4, and the current inferential model’s bias. Thus,
if the process remains relatively stable, and the model’s independent variables remain near their
current values, the quality will line out at this estimated steady-state value. The predicted future
steady-state value is usually displayed at the operator’s console to provide an indication of where
the quality will be if the process remains fairly steady.
8.7.2 Updating an Inferential Model’s Bias Using Laboratory Data
Figure 8.3 presents an overview of how a steady-state inferential model is used online to predict
quality, and how the inferential model is updated using lab data. The new functional blocks intro￾duced to enable lab data to be used to update the model are shown in yellow. The lab result must
first be validated before it is used to update the bias. The validation tests can include at a minimum
checking the following:
● The lab result is less than a maximum and above a minimum allowable value.
● The absolute difference between the lab result and the PV prediction at the sample time (obtained
from the DCS history data base) is below an engineer specified maximum allowable value. If not, Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License8.7 Inferential Variables 251
DCS History
Time PV prediction
------ 22.3
------ 20.6
------ 21.8
Sample time 20.9
------- 21.1
------- 22.3
. .
. Predicted quality PV
to history data base
Predicted quality PV
for online use
Updated
inferential
model bias
Steady state
inferential
model
X Indep. variables 1 ... X4
X1* ... X4* Indep. variables,
time synchronized
Independent
variable PVs
X1 X4
Process
X4*
X2*
X1*
New, valid
lab result
Lab result
Unmeasured
quality PV
Lab sample
Valid result?
Yes No
Latest result
is valid
Sample
time
Indep. variable
time
synchronization
X2 X3
Latest result
not valid
PV prediction
@ Sample time
Sample
time
X3*
Do not
update bias
Lab
result
Inferential model
bias update
Updated
inferential
model bias
PV prediction
@ Sample time
Figure 8.3 Steady-State Inferential Model Prediction, Model Bias Update via Laboratory Data
do not update the model, or limit the lab result so that the difference is equal to the maximum
allowable value.
● The absolute difference between the lab result and the PV prediction at the sample time is above
an engineer specified minimum allowable value. If not, the model is within the reproducibility
of the lab analysis, and therefore do not update the model.
● Important: The difference (not the absolute difference) between the lab result and the PV predic￾tion at the sample time is the prediction error – see discussion of Equation (8.4) below. Therefore,
the max/min allowable values chosen for these validation checks also limits the allowable model
bias change.
● The sample date/time and the model update date/time differ by less than a maximum allowable
time period.
On occasion, the operator may be given the ultimate responsibility to accept or reject the new
lab result via a console entry. When the lab result is declared valid, whether by the validity logic or
operator entry, the sample time and the lab result are historized and are inputs to the Inferential
Model Bias Update block.
Updating the model bias using a valid lab sample result requires retrieving the PV prediction at
the sample time from the DCS history data base. The fresh, valid lab result and its sample time
are two Inferential Model Bias Update block inputs. The third Inferential Model Bias Update block
input is the PV prediction at the sample time retrieved by searching the DCS history data base. This
is the same PV prediction value retrieved and used as described above to confirm that the absolute
difference between the lab result and the PV prediction at the sample time is less than/greater than
a maximum/minimum allowable value. The prediction error is the difference between the new lab
result and the historized PV prediction at the sample time:
Prediction Error = (PV Prediction @ Sample Time − Fresh Lab Result) (8.4)
As before, the prediction error is the “raw” model bias and represents the (full) correction
required on this execution pass to bring the inferential model’s prediction into agreement
with the current lab result. However, the amount of current model error eliminated on a
single-model update execution pass is always reduced by filtering the prediction error. But because Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License252 8 Design Considerations
lab sampling is infrequent and time intervals between prediction error calculations are long,
exponential filtering of the prediction error is not meaningful. Nevertheless, because of the
inherent imperfections of collecting, transporting, and analyzing lab samples, it is still advisable
to limit the amount of current model error eliminated on a single-model update execution pass.
This is commonly implemented (Ref. [2]) using a simple weighting factor, designated as K in
Equation (8.5):
Updated Inferential Model Bias = Current Bias − K ∗ Prediction Error (8.5)
where 0<K ≤1. Note that K = 1 corresponds to eliminating the entire prediction error on the
current model update execution pass (not recommended). The updated inferential model’s bias is
a stored input to the Steady-State Inferential Model block, where it is used to calculate the predicted
quality PV until a fresh, valid lab sample becomes available and the inferential model’s bias is once
again updated.
A comparison of the inferential model’s bias update calculations in Figures 8.2 and 8.3 shows
the complexities of using lab results versus using online measurements for the update. With
model-update via online measurements, there is no need to manage slow and random lab sample
frequencies, historizing lab results and sample times, and searching through the history data
base to match the sample time and lab result to a historized prediction. And, remember, the
development of an inferential model using lab data is significantly more complex and resource
intensive than model development using quality measurements.
Also, with model updating centered on lab data, timely lab sampling and analysis is always an
issue when the model is used online, e.g., to predict quality as shown in Figure 8.3. Typically, operat￾ing plants capture lab samples at best once a shift (e.g., every 8 or 12 hours) or once a day. Therefore,
in many cases there are long time intervals between model updates. Whether this is a problem or
not depends upon how the prediction is used. If used only for process monitoring, and not for
control, this is normally not a problem.
8.8 Input Validation
Here are the reasons less reliable control inputs, whether measured or calculated, are validity
checked before they are used in a control strategy:
● To prevent an erroneous control output when a feedforward or feedback control input fails.
● To enable feedback control to continue uninterrupted when a feedforward input fails.
● To ensure a control strategy is recommissioned bumplessly when a failed input returns valid.
Input validity checks are recommended for all analyzer measurements, all multiplexed analog
inputs, and externally multiplexed input devices like DTIs. Single-loop, high-level (4–20 mA) ana￾log inputs are almost always exempt from input validation. It is almost a certainty that a standard
input validity check package exists on a site-wide and/or company-wide basis. Because of its impor￾tance and its use in many major control strategies, there are usually many different viewpoints on
what tests should be done and how, and thus it is normal for the standard package to be revised
from time to time.
There are many possible validation tests – here are the most commonly employed:
● The PV is above its high limit or below its low limit – the high and low limits are normally
engineer specified.
● The PV’s change is too large (Jump Test). An option is sometimes included to wait an engineer
specified number of time steps before declaring the PV has jumped.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License8.8 Input Validation 253
● The PV’s change is too small (Freeze Test). Similar to the jump test, waiting for an engineer spec￾ified number of time steps before declaring the PV frozen is sometimes an option.
Discussions with operations and process specialists may be necessary to choose validity high and
low limit values for some essential applications. Note that standard DCS functionality will declare
a measured PV value “Bad” (unavailable) when it is not within the PV’s high and low engineering
units or instrument range. Also, standard DCS functionality will initialize a controller with an
unavailable (“Bad” PV) input when the input returns available (“Good” PV).
A validation tag does the validation tests and typically stores the following items: (i) the current,
valid input to a last good value storage location (LastGoodValue used in Figures 8.4–8.6), (ii) the
input’s status – Valid, Invalid, or one of two transitions – Failed (Valid → Invalid), or Returned
(Invalid → Valid), and (iii) the identity of the validity test that failed. The Failed status will be reset
to Invalid if the input is declared invalid on the validation tag’s next control execution pass while
the Returned status will be reset to Valid if the input is declared valid on the next control execution
pass. The LastGoodValue is the PV input source for any controller that uses the validated input. It
is updated each time the input passes all validity tests, but it is not updated when the input fails
at least one test. The LastGoodValue is thus a valid input, even if the current (raw) input value is
invalid. This is important for a feedforward control input, but the constant, last good value cannot be
used for PID control – with no feedback, the PID controller will wind-up its secondary’s set point.
Therefore, if the invalid (or failed) input is a PID controller’s PV input, the controller’s control
calculations and its outputs must be stopped.
If the measured input is a PID controller’s PV input, when the input’s status changes to Failed
(Valid → Invalid), and for as long as its Status = Invalid, the controller tag’s PV must be set “Bad”
(unavailable) and control processing must stop. Control algorithm processing is stopped until the
input’s status changes to Returned (i.e., Invalid → Valid). PV and control algorithm processing
restarts, the controller sets its initialization status to True, and control action restarts after the con￾troller initializes. By forcing the controller to initialize, a bump to the process is avoided if the new
valid input value is very different from the input’s last good value. No alarms are issued, messag￾ing is minimized but indicators on appropriate console displays are provided to reveal input and
control strategy statuses and status changes.
Figure 8.4 shows an analyzer measurement (AI505), being validated in validation tag AIV505,
and how the analyzer controller (AC505) retrieves AI505’s last good value and its input status, and
responds to status changes that require follow-up action. Note that the same approach is used when
an externally multiplexed input (a DTI point) is a PID PV input. Much of AIV505’s and AC505’s
status assessments and follow-up actions, as summarized next, are implemented via user provided
custom code/logic.
Input Validation Tag AIV505’s Action Steps
– AIV505 performs validity checks on AI505 PV, and declares the Input Status = Valid or Input
Status = Invalid. If Input Status has changed from Invalid to Valid, then it declares the Input Sta￾tus = Returned. If Input Status has changed from Valid to Invalid or unavailable, then it declares
the Input Status = Failed.
– If Input Status = Valid or Returned, AIV505’s PV algorithm executes, and stores the current, valid
value of AI505 PV to its PV, e.g., AIV505 PV = AI505 PV.
– If Input Status = Invalid or Failed, AIV505 aborts its execution and does not update its PV or
LastGoodValue, whether it is in Manual or Auto mode.
– If Input Status = Valid or Returned, and AIV505 is in Auto mode, its control algorithm executes.
The control algorithm stores AIV505 PV into LastGoodValue, AIV505’s assigned storage location Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License254 8 Design Considerations
Input status
AI505 PV validation
PV Algo: 
AIV505 PV = AI505 PV
AIV505 PV
LastGoodValue
Control algo:
AI
505
Exit Status = Invalid or failed
Status = Returned Initialize AC505
Quality controller
Secondary
controller
SP
PV = LastGoodValue
Control calculation
Status = Valid
AIV505
SP
AC505
Input validation
Auto or
manual Mode
Status
Auto last time?
Yes
Yes
AIV505 mode = Auto?
No
Do status
checks
Initialize
AC505
Set AC505 Wind-up
Status = Highlow
No
PV input
Invalid,
valid,
failed, or
returned
Figure 8.4 Quality Measurement Validation, and Quality Feedback Control
for the last valid value of AI505 PV, and the source for AI505 PV when needed in any control
calculation.
– If AIV505 is in Manual mode, it does all validity checks, updates its PV if Input Status = Valid
or Returned, but no matter the Input Status, its control algorithm does not execute and thus the
value stored in LastGoodValue remains the same.
Quality Controller Tag AC505’s Action Steps
– If AIV505 is in Manual mode, the LastGoodValue remains constant. To avoid winding-up
its secondary’s set point, AC505 sets its wind-up status = HighLow, stopping all control
outputs.
– If AIV505 is in Auto mode, but was not in Auto mode on AIV505 last execution, to prevent a
bump if the current LastGoodValue is very different from the last valid value in LastGoodValue,
AC505 sets its own initialization status to True. Its PV algorithm is executed, and then its control
algorithm initializes.
Assuming AC505 is in Auto mode:
– If AIV505 Input Status = Valid, AC505’s PV algorithm executes, and its control algorithm calcu￾lates and outputs the secondary’s new set point.
– If AIV505 Input Status = Returned, AC505 sets its own initialization status to True, executes its
PV algorithm, and its control algorithm initializes.
– If AIV505 Input Status = Invalid or Input Status = Failed, AC505 sets its PV to unavailable, which
aborts its processing – it does not calculate its PV or its secondary’s set point.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License8.8 Input Validation 255
Figure 8.5 Input Validity Checks in the
Calculation and Control of Reboiler Duty
SP
FC
270
E-289 duty/
feed RC235
SP Feed
rate
SP
TI
287
Tray
temperature
control
TC287 Tray
temperature
Mode
Mode
QC235
E-289 duty
control
FI235 input 
TI230 PV Input
No
Input status = returned? Yes
TI
231
No
Input status = returned? Yes
FC
235
SP
Control algorithm
FI
235
E-289
Hot fluid
flow In
E-289
TI
230
TI
231
TV287
FI
235
LastGoodValue
TI
230 TIV230
Input status
TIV231
LastGoodValue
Input status
TI231 PV input
Initialize
QC235
PV algorithm
No
TIV230 mode = Auto, and
= Manual on last pass?
TIV231 mode = auto, and
= Manual on last pass?
Yes
Auto or manual
Important: Note that the validation logic (in AIV505) does not execute any control related actions.
Because the measurement or calculated input may be used in more than one control strategy, the
appropriate control action may be control strategy specific. Therefore, actions that must be taken
when Input Status = Invalid or an input status changes from Valid → Invalid (Status =Failed) or
from Invalid → Valid (Status = Returned) are chosen individually by each impacted controller(s),
e.g., AC505.
When a feedforward controller’s input becomes invalid or unavailable, the use of the input’s
last good value ensures the more important feedback control corrections remain in operation.
The feedforward’s input source is a designated storage location that always contains a valid input
value – if the current input value is valid, it is stored there and used, if invalid, the last good value,
stored earlier, is still there for use. When the input is valid, feedforward and feedback control con￾tinue in tandem. When the input is invalid, using the constant, last good values mean there are no
feedforward corrections, but the more important feedback control corrections continue. The only
additional action that must be provided in these cases is the initialization of the feedforward control
calculation when the input’s status transitions from Invalid to Valid, e.g., when Status = Returned.
Figure 8.5 is an example of input validation for measurements that are used in a feedforward
calculation. It presents an overview of the input validity checks needed to calculate and control
reboiler duty (QC235), how the reboiler duty controller retrieves the last good value and status of
each temperature input, and its follow-up actions in response to a change in an input’s status.
The functionality of validation tags TIV230 and TIV231 in Figure 8.5 is the same as discussed
for AIV505 in Figure 8.4. However, the status checks and responses to status changes shown for
QC235 are quite different from those of AC505 in Figure 8.4 and reflect the differences in using
validated inputs in PID control vs in feedforward control. Each temperature’s last good value is the
temperature’s PV input source in the calculation of QC235’s PV (reboiler duty), whether or not the
current temperature measurement is valid or invalid. Using the last good value for an extended
amount of time while the actual input is invalid, presents no control problems other than having
no feedforward corrections for that input. QC235 PV’s calculation and QC235’s feedback control Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License256 8 Design Considerations
calculations (FC235’s set point) continue, no matter the status of either temperature measurement.
In all cases, full feedback control is provided, but the feedforward control provided depends upon
the status of the temperature measurements: if both temperatures are valid – full feedforward,
if one temperature measurement is invalid – partial feedforward, and if both temperatures are
invalid – no feedforward.
The feedback control adjustments made by QC235 are in response to changes in TC287 SP, TC287
PV upsets, and feed rate changes (FC270 SP or PV). Once QC235 SP is reset by RC235, QC235
calculates its secondary’s set point (FC235 SP), with feedforward corrections for any input whose
current input status is valid (one, two, or none). It is only when either input temperature’s status
changes to Returned that additional action is executed – QC235 sets its own initialization status to
True. By forcing QC235 to initialize, a bump to FC235 SP is avoided if the new valid temperature
input value is very different from the input’s last good value stored in LastGoodValue. Since the tray
temperature control strategy is a simple cascade, standard DCS functionality will then manage the
initialization of RC235 and TC287.
Although not important for measurements that are PID control PV inputs, but very important for
an input used in feedforward control, transferring TIV230 or TIV231 into Manual mode stops its
control algorithm from executing and thus the value stored to that input’s LastGoodValue remains
the same. There is no wind-up problem – with one or both input values constant, feedback con￾trol continues unaffected, although there are no feedforward corrections for the invalid input.
Therefore, transferring TIV230 or TIV231 to Manual mode decommissions the feedforward correc￾tions, and transferring TIV230 or TIV231 to Auto mode recommissions the feedforward corrections.
When either TIV230 or TIV231 is transferred into Auto mode, its LastGoodValue storage location
is again updated, and feedforward corrections begin again for that input. And again, to avoid a
bump to FC235 SP if the new valid input value is very different from the input’s value stored in
LastGoodValue, QC235 is forced to initialize.
Another, and very important, example of input validation for a feedforward input is illustrated
in Figure 8.6 – fired heater heating value validation and its use in the calculation of a fired heater’s
duty.
In Figure 8.6, QC112 controls a fired heater’s heat duty. The desired firing rate, QC112 SP, is
calculated by QC112’s primary, and its control algorithm calculates the fuel gas flow (FC112 SP)
needed to meet the QC112 SP. Its PV algorithm calculates the current heat duty, QC112 PV, using
Equation (10.10) – which will be discussed in Section 10.4.6:
QC112 PV = S3 ∗ AIV102 LasGoodValue ∗ FC112 PV (8.6)
QC112 PV Current fired heater heat duty
S3 Scale factor that ensures QC112 PV has the desired engineering
units
AIV102 LastGoodValue Either the current (AIV112 Input Status = Valid or Returned) or
last good value of fuel gas heating value (AIV112 Input
Status = Invalid or Failed)
FC112 PV Current fuel gas flow rate
The heating value in Equation (8.6) is the heating value currently in the designated heating value’s
source storage location, AIV102 LastGoodValue. The desired fuel gas flow, FC112 SP, is calculated
by replacing FC112 PV and QC112 PV by FC112 SP and QC112 SP in Equation (8.6), and solving
for FC112 SP:
FC112 SP = QC112 SP∕(S3 ∗ AIV102 LastGoodValue) (8.7)
Once again, the functionality of validation tag AI102 in Figure 8.6 is the same as discussed
for AIV505 in Figure 8.4 and TI230 and TIV231 in Figure 8.5. However, because AI102 PV, like Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License8.8 Input Validation 257
Fired heater
duty controller
HV
input
Mode
QC112
No
Input status = returned?
Yes
LastGoodValue
AIV102
Input status
Yes
SP
FC
112
FV112
AI
102
Fuel gas
FI
112 Fuel gas
heating value
Initialize
QC112
PV algorithm
Control algorithm
AIV102 mode = auto, and
= Manual on last pass? 
No
HV
FG PV
SP
Primary controller
Figure 8.6 Fired Heater Heat Duty Calculation Using Validated Fuel Gas Heating Value
TI230 PV and TI231 PV, is a feedforward control input, QC112’s status checks and responses to
status changes in Figure 8.6 are the same as those shown for QC235 in Figure 8.5. The control
algorithm in Equation (8.7) executes successfully whether AI102 PV is valid or invalid. AIV102 Last￾GoodValue remains constant when AIV102 is in Manual mode, or Status = Invalid or Failed, but
Equation (8.7) still responds to changes in QC112 SP. And as was the case for QC235 in Figure 8.5,
QC112 is initialized when AIV102 is transferred from Manual to Auto mode, and when AIV102
Status Input = Returned.
Control Output Checks
Standard DCS functionality, previously discussed in Section 2.3.4 and in Section 8.2.7, provides
many beneficial features that are used to check, e.g., validate calculated control outputs: set point
and output high/low limit clamps, and max/min output rate of change limit clamps.
Set point and output limits are normally set by operators via console entries. Because set point
limits are in engineering units, operators (and control engineers) almost always prefer to work with
them. However, there is one exception – for ultimate secondaries, output limits are always used to
limit outputs to final control elements (e.g., a valve).
For critical applications, checks are sometimes included, almost always via user provided custom
code/logic, on every control execution pass to ensure the control output does not move the ultimate
secondary’s setpoint too close to a unit’s safety setting. These checks are engineer specified, internal
to the control strategy and are independent of set point high or low limit clamps operators may
set. These types of output checks are control strategy–specific, and hence they are defined and
implemented as needed, on a case by case basis.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License258 8 Design Considerations
8.9 Flow Compensation
Flow orifices are sized based on design conditions for temperature, pressure, and molecular weight.
The instrument range configured in the DCS is initially established using calibration values of tem￾perature, pressure, and molecular weight; recalibration may be necessary periodically when the
orifice is in service (the use of smart sensors reduces the need for in-service calibrations and check￾out). Once in service, actual line conditions can vary over time and deviate from both design and
calibration conditions. As a consequence, the actual flow at line conditions and the flow measure￾ment are not equivalent.
Figure 8.7 provides an overview of how a flow MV is compensated and controlled. If a more
precise value of the flow measurement is desired, the measured flow is line temperature, pressure
and/or molecular weight compensated using a correction equation, with many variations, depend￾ing on the type of fluid flow and the process conditions:
FlowComp = FlowMeas ∗
√F[T, P, MW, T0, P0, MW0] (8.8)
FlowComp Compensated (corrected) flow, e..g, the actual flow
FlowMeas Measured flow, in volumetric units at standard conditions
P, T, MW Line pressure (psia), temperature (∘K), and molecular
weight
P0, T0, MW0 Calibration pressure (psia), temperature (∘K), and
molecular weight
F[T, P, MW, T0, P0, MW0] Correction equation
Flow compensation is most often used for the calculation of routinely reported and historized
environmental, energy utilization and material balance performance indicators. Compensated
flows are not commonly used in closed-loop control strategies – it is probably best to avoid using
compensated flows as manipulated variables. However, treat gas flow compensation in high
pressure, high temperature reaction systems are fairly common (see Section 14.4.2–Section 14.4.4).
In Figure 8.7, a flow MV’s compensation involves as needed input validations – each input’s
current, valid value is stored as its last good value, and the input’s last good value is the input
source for that input in the compensation calculation. Molecular weight or specific gravity mea￾surements and externally multiplexed temperature measurements must be validated before their
use in Equation (8.8). High level, 4–20 mA temperature measurements, do not need validation.
Pressure measurements may or may not need validation depending upon process and instrument
specifics – an instrument specialist and/or a process engineer should be consulted before deciding.
If an input’s measurement passes all validation tests, its validation tag stores the new, valid mea￾surement as its last good value, the input source for the flow compensation tag’s control calculation.
When an input measurement does not pass all validation tests, the validation tag’s last good value is
not updated, but the flow compensation calculation continues using the same last good value until
an input measurement passes all validity tests. When that input returns valid after being invalid
(Status = Returned), the flow compensation controller (FCZ100 in Figure 8.7) must initialize. As
before, when the validation tag is in Manual mode, its control algorithm does not execute and
the LastGoodValue location is not updated – this decommissions feedforward adjustments for that
input. When either input’s validation tag is transferred from Manual to Auto mode, the flow com￾pensation controller (FCZ100 in Figure 8.7) must initialize. Also, all controllers dependent on the
compensated flow (FCZ100 PV) must initialize when FCZ100 initializes – this avoids a bump to
their control loop if the difference between the last and new compensated flow PV is large. This Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License8.10 Cascade Initialization and Wind-up Protection 259
T, P, MW
compensated flow
control PI
105
FI
100
FV100
AI
110
Gas
flow
FCZ100 
SP
Primary
controller
Control algorithm
Pressure
PV input
Flow
PV input
MW
PV input
Mode
LastGoodValue
AIV110
Input status
Mode
TIV103
LastGoodValue
Input status
No Yes
AIV110 mode = Auto, and
= Manual on last pass? 
TIV103 mode = Auto, and
= Manual on last pass? 
AI110 PV
TI103 PV
PI PV
No
Input status = returned?
Yes
No
Input status = returned?
Yes
FI PV
Initialize
FCZ100
PV algorithm
Auto or manual
Temperature
PV input
TI
103
Figure 8.7 T, P, MW Flow Compensation, with Input Validation
requires all controllers dependent on the compensated flow’s PV to monitor the compensated flow
controller’s initialization status.
8.10 Cascade Initialization and Wind-up Protection
Cascade initialization was explained and discussed in Section 2.4.6 for PID controllers and
in Section 2.6.3 for ratio controllers. Control initialization are the actions that commission a
single-control loop, a portion of a multilevel cascade, or the entire multilevel cascade without
any changes to the ultimate secondary’s set point or output. Its purpose is to ensure the process
is not upset on the control initialization pass. When a single-control loop (transferred from
Manual to Auto mode) or a multilevel cascade (all secondaries transferred to Cascade mode) is
commissioned without any changes to the process (e.g., a valve position), it is called bumpless
transfer. All modern-day DCSs provide standard features, some automatically with no required
user input, others by user configuration, that ensure bumpless transfer. However, as emphasized
in all earlier discussions, DCS standard features that enable bumpless transfer are applicable Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License260 8 Design Considerations
to only simple cascades – cascades with one ultimate primary, one ultimate secondary and any
number of intermediate controllers.
As discussed in Sections 2.3.4 and 2.8, wind-up status and cascade wind-up protection manage
a cascaded controller’s ability to make control adjustments that will change a secondary’s output.
Without wind-up protection, when a secondary controller’s output or set point becomes clamped
high or low, the primary does not know its control adjustments will not change the secondary’s
output. Because the primary’s control adjustments do not have an effect on the secondary’s MV
(or valve position if it is an ultimate secondary), they also have no effect on its own PV. As a con￾sequence, as long as its PV ≠ SP, the primary will continue to output control adjustments to the
secondary that have no effect on its own PV – the control adjustments wind-up the secondary’s set
point. Standard DCS cascade wind-up protection, forsimple cascades only, transmits to the primary
whether the secondary’s set point can be increased or decreased or not changed at all.
Controller wind-up has a direction – High (the set point cannot be increased), Low (the set point
cannot be decreased), High Low (the set point cannot be changed in either direction), or Normal
(the set point can be changed in both directions). In simple cascades only, standard DCS function￾ality determines every controller’s wind-up status, starting with the controller whose set point or
output is limited. The wind-up status is read by that controller’s primary, who determines its own
wind-up status based on the secondary’s wind-up status and its own control direction. This contin￾ues up the cascade until the ultimate primary determines its own wind-up status.
Here are the rules, derived via examples in Section 2.8.3, that resolve a primary’s wind-up sta￾tus – refer to Section 2.8.3 for further explanations:
● The wind-up status of any primary controller configured with control direction = Direct will
be = Low, when its secondary is wound-up high, and = High, when its secondary is wound-up
low.
● The wind-up status of any primary controller configured with control direction = Reverse will
be = High, when its secondary is wound up high, and = Low, when its secondary is wound-up
low.
The standard DCS features that enable bumpless transfer on control initialization passes
and provide cascade wind-up protection are essential control functionality that support a large
percentage of advanced regulatory and conventional advanced control strategies implemented in
petrochemical plants worldwide. However, these standard features are not applicable to complex
cascades, i.e., cascades with multiple primaries and/or multiple secondaries. Complex cascades
require custom code, logic, and configuration to reproduce these features and manage their
important but complex control actions. They are among the most challenging control tasks to
replicate, and if they do need to be replicated and included in a control strategy’s design, applica￾tion development, testing, commissioning, and long-term maintenance resources will significantly
increase.
Very Important: As has been emphasized in several sections, although in many cases it may not be
possible, it is always best to design a control strategy that is structured as a simple cascade.
8.11 Alarming and Operator Messaging
Alarms are used almost exclusively for situations that require operator intervention or follow-up.
However, sites routinely limit the number of process control related alarms because too many
alarms of any kind will reduce operator attention to all alarms. On a very limited basis, control Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License8.12 Interactions with Other Control Strategies 261
engineers assign alarms to very important CVs and MVs, primarily in advanced regulatory control
strategies implemented in process connected devices. These alarms are not hardwired, and nor￾mally do not require immediate operator attention. The most used alarms in support of control
strategies are PV high and low alarms, PV rate-of-change alarms, controller deviation alarms, and
output-rate-of-change high and low alarms.2
With advances in alarm management and widespread use of schematics-based operator inter￾faces to monitor control applications, operator messaging is no longer a widely used or needed
functionality. For the most part, a control strategy’s input, output, alarm and control statuses,
control attributes, process inputs, process outputs, and related field hardware can be effectively
displayed on the application’s schematic and routine operator monitoring will detect almost all
indications of irregular or problematic behavior. As a result, the number of messages sent to an
operator’s console is usually small and are typically limited to situations in which operators must
respond to keep the control strategy commissioned. Also, improved DCS functionality now allows
many adjustments historically made manually by operators (e.g., relieve a constraint, switch ulti￾mate secondaries, or accept a new lab value) to be done automatically as part of an application’s
basic functionality. This further reduces the need for messaging.
Remember: The number of application-generated messages should be minimized. If used,
they should be brief, direct and contain minimal engineering or technical terminology. For a
single-process event, make sure the message frequency is limited. If a single event is alarmed
and annunciated at the operator’s console, the only messaging necessary is to suggest corrective
actions.
8.12 Interactions with Other Control Strategies
Interactions among control strategies are a direct consequence of process interactions. Therefore,
to design a new control strategy and assess potential interactions with other control strategies,
the first step is to understand the unit’s process configuration, the unit’s operating objectives,
and how existing control strategies impact process operations. These factors are the focus of
Chapter 4 – explaining the role of process analysis and understanding in any control strategy’s
design. To focus specifically on potential control strategy interactions, it is necessary to understand
how existing control strategy MVs will affect the new strategy’s potential CVs and DVs, and if the
new strategy’s MVs will affect the other control strategy’s CVs or DVs. After careful analysis, and
perhaps some focused plant tests, a judgment on whether these potential interactions will degrade
either strategy’s control performance can be made. As pointed out in the discussions in Chapter 4,
process analysis can identify PVs of interest being pushed toward a constraint limit by control
adjustments in another control strategy. If so, it is best to add these likely constraint variables to
the strategy that is driving them toward a constraint limit.
A number of commonly encountered control strategies that manage process interactions were
presented in Chapter 4. These discussions illustrate the key role that process analysis plays in con￾trol strategy design, and in particular, the relationship between process and control interactions.
The Chapter 4 discussions that involve process heat integrations are briefly highlighted below. A
classic interactive control problem – dual product quality control in a two-product light-ends tower,
is presented first. This control strategy’s historical evolution illustrates how interactive control
strategy design evolves into limited scope model-based control and then to multivariable control
via DMC.
2 See Chapter 2, Sections 2.3.2, 2.3.3 and 2.3.4
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License262 8 Design Considerations
8.12.1 Two-Product Light-ends Tower Quality Control
In a two-product light-ends tower, reflux flow and reboiler duty each affects both distillate and
bottoms product qualities. Thus, independent control strategies implemented to control each prod￾uct’s quality, one manipulating reflux flow, the other manipulating reboiler duty, will interact and
acceptable performance may be difficult to achieve. The conventional approach used to overcome
these interactions is to control one quality very close to set point (with tight tuning) and control
the other quality so that some CV deviations about its set point are tolerated (with loose tuning).
A somewhat better (conventional) solution, although not trouble-free and limited to 2 CVs and 2
MVs, is to implement a 2 × 2 model-based controller that manipulates both reflux flow and reboiler
duty simultaneously to control both qualities. However, custom code is needed to manage MV con￾straints, and the approach becomes impractical for control strategies larger than 2 × 2.
But as has already been emphasized in earlier discussions, the best solution is to widen the scope
of the control problem to include upstream and downstream units and implement a DMC controller
that achieves multiple control objectives – simultaneously manipulating numerous independent
variables and accounting for multiple constraints and important upsets.
8.12.2 Heat Integrations
In Chapter 4, Section 4.3.2, a proposed control strategy to distribute crude flow to two parallel flow
paths in a CDU’s feed preheat train is presented and discussed (see Figure 4.4). The control objective
is to maximize the preheat train’s preheat heater’s inlet temperature, but the shifting of crude flow
to two parallel flow paths interacts in a number of ways with the CDU’s BPA return temperature and
draw-off flow control strategies (see Figure 4.5). These specific control interactions arise because
the CDU’s crude feed and the CDU’s BPA are heat integrated in an exchanger in one of the parallel
crude paths. As mentioned in Section 4.3.2, the mix of upstream and downstream interactions that
are common in any CDU preheat train often suggests the need for a multivariable controller such
as DMC.
Another process area that features numerous heat integrations is fixed bed reaction systems.
One example was discussed in Chapter 4, Section 4.3.4 – a two stage fixed bed hydrodesulfuriza￾tion reaction system with the second stage reactor effluent providing feed preheat for both the
first and second stage reactors (see Figure 4.9). Calculating, and controlling reactor bed Equivalent
Isothermal Temperature (EIT) at an offline specified target normally yields conversions that are in
line with conversion targets. In the two-stage fixed bed reactor system discussed in Section 4.3.4,
each reactor’s EIT is controlled by manipulating the reactor’s inlet temperature. Because of the
preheat exchanger process configurations, exchanger duty adjustments made to control one reac￾tor inlet temperature affect other preheat exchanger duties, and thus they also impact the other
reactor’s inlet temperature. Hence, control adjustments to control the two reactor inlet tempera￾tures interact. These heat integration interactions also introduce additional constraints (exchanger
bypass valve positions) that must be incorporated into the overall control strategy. The interactions
and additional constraints make achieving good control performance more difficult.
Limited-in-scope model-based control could improve control performance, to some extent, in
heat integrated configurations. However, the best solution is to widen the scope of the control
problem and implement a DMC controller that includes both upstream and downstream process
units. By manipulating many more independent variables simultaneously and accounting for
important constraints and common upsets, many more control objectives can be achieved with
better control performance. However, these are resource-intensive efforts that would need to be
justified.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License8.13 Testing to Judge Control Strategy Acceptability 263
Note: Several control strategies implemented in other heat integrated process configurations are
presented in Section 10.3. These applications include control strategies that manipulate tower
reboiler duty or fractionator pumparound heat duty to meet various unit operating objectives.
Last Thoughts: Control Interactions
As advanced regulatory control and conventional advanced control strategies are implemented
plant-wide, it is inevitable that many control strategies will interact with others in one way or
another, and impact control performance. Real-world plant operations are inherently interactive
and therefore control strategies will by necessity be interactive. There are conventional approaches
that are sometimes effective in overcoming these interactions to some extent, but there are practical
limits to their ability to maintain effective control performance.
Important: Remember that in most cases, when control interactions are difficult to manage, replac￾ing advanced regulatory control and conventional advanced control strategies with wider scope
multivariable control – DMC, is the best approach.
8.13 Testing to Judge Control Strategy Acceptability
As can be deduced from discussions in this chapter, it is best to develop a control strategy design
based on some or all of the following activities: (i) careful process analysis, (ii) monitoring opera￾tions in real-time, (iii) analysis of operations history, and (iv) discussions with process technical and
operations personnel. There may be several feasible designs capable of achieving the control objec￾tives, and if so, preliminary offline testing of the alternatives may be necessary before a preferred
design is chosen. Discussions with experienced operators are always helpful, as are discussions with
process technical personnel. Once a preferred design is chosen, careful offline and online testing is
performed to enable a conclusive judgment to be made on the design’s suitability.
The following is an overview of a typical test sequence to establish an advance regulatory or
conventional advanced control application design’s acceptability. Note that within each test phase,
performance feedback is generated, which usually suggests additional functional adjustments and
testing:
● The control strategy is built/coded and configured in the DCS. Offline testing ensures responses
to typical scenarios are correct, e.g., a control input becomes unavailable, a control input returns
available, the strategy is commissioned and decommissioned bumplessly, controller wind-up sta￾tuses are set correctly, and cascade initialization occurs when specified events occur.
● The strategy’s functionality is tested online, interfaced to the process, and testing again ensures
responses to typical scenarios are correct. Outputs to the plant are limited and kept to a minimum
so that operations are not noticeably impacted. However, this step does include initial controller
tuning, with plant testing as needed.
● After this initial online testing, the strategy is conditionally commissioned, e.g., it is allowed to
impact plant operations in a relatively small, engineer-specified operating window about a nor￾mal steady-state operating point. With the assistance of console operators, as much functionality
as possible is tested, and control performance is monitored and initially evaluated. Further plant
testing may be necessary to improve controller tuning.
● Online testing proceeds as increased confidence in the strategy’s performance allows the strat￾egy’s operating window to be enlarged. With the assistance of console operators, monitoring and
evaluating control performance becomes the major effort.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License264 8 Design Considerations
● When its performance permits, the strategy is allowed to remain commissioned during normal
work hours when control engineers are in the control house but not necessarily at the operator’s
console. Operator documentation is prepared and is reviewed by experienced operators. Con￾sole operator training for all work shifts is presented, and control engineer documentation is
prepared.
With confirmation that the control strategy achieves its control objectives, its control perfor￾mance is judged acceptable, and operator documentation and operator training is complete,
the control strategy is then officially commissioned, e.g., it is expected to be in operation at all
times. Plant management documentation is prepared and is issued as part of the commissioning
announcement.
References
1 Montgomery, D.C. and Runger, G.C. (2013). Applied Statistics and Probability for Engineers, 6e.
Hoboken, NJ: John Wiley and Sons.
2 King, M. (2010). Process Control: A Practical Approach, 208–210. Chichester: John Wiley & Sons,
Ltd.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License265
9
Level Control
CHAPTER CONTENTS
9.1 Introduction
9.2 Single Loop Level Control
9.3 Light-ends Tower Inventory Control
9.3.1 Two Product Towers
9.3.2 Towers with One Sidestream
9.4 Level Controllers that Manipulate Multiple Flows
9.4.1 Manipulated Flows are Unmeasured
9.4.2 Manipulated Flows are Measured
9.5 More Complex Level Control Applications
9.5.1 Reactor Quench Flow Hold-up Drum Inventory Control with Secondary Switch
9.5.2 Reactor Feed Drum Inventory Control with Multiple Feed Sources
9.5.3 Reactor Feed Rate and Feed Mix Control
9.6 Averaging and Tight Level Controller Tuning
9.6.1 Light-ends Towers: Distillate Flow on Level Control
9.6.2 Light-ends Towers: Reflux Flow on Level Control
9.6.3 Feed Surge Drums
9.6.4 Fractionator Sidestream Stripper Bottoms Level Control
9.6.5 Fractionator Bottoms Level Control
References
Numerous examples of liquid inventories abound in chemical plant and refinery process units,
e.g., at light-ends tower and main fractionator bottoms, in reflux drums, feed drums, compressor
knock-out drums, high- and low-pressure separator drums, and steam drums. In almost all cases,
inventory control involves control of the liquid level in the vessel. The level controller’s manipu￾lated variable is almost always a flow that changes either the flow rate into or the flow rate out of
the vessel. Good control of these levels is essential to achieve smooth and stable process operations,
maintain overall unit material balance, and help advanced control applications meet their perfor￾mance expectations. Note: Since we are considering only liquid inventories in this chapter, we use
inventory control and level control interchangeably.
9.1 Introduction
As discussed in Chapter 1, Section 1.4.5, level control is a non-self-regulating loop. If the level con￾troller is in manual mode and the flow imbalance is positive (in>out) or negative (in<out), the
level (and liquid inventory) will rise or fall until the inventory “overflows” or “empties.” In addition,
Practical Process Control Design with Industrial Applications, First Edition. Alan M. Kugelman.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License266 9 Level Control
the level being controlled, the flow MV and the process configuration determine the level tuning
objective. In some cases (tight level control), the level is controlled as close as possible to setpoint
regardless of the variations in the MV. In other cases (averaging level control), the level can devi￾ate from setpoint, within alarm limits, to minimize the variations in the flow MV. Level controller
tuning objectives are discussed in Section 9.6.
Design Note: A level controller’s setpoint is not normally changed. Therefore, whether tuned
tightly or for averaging level control, choose proportional on PV and tune for best load response
(see Chapter 2, Section 2.4.5). In addition, since the setpoint is almost never changed, SP Init = No
is normally configured. However, before deciding on the level controller tuning objective, be sure
to discuss these options with operations personnel.
Inventory control can be very simple – a single level loop or a level → flow cascade. However,
there are several relatively common factors that can complicate level control:
● Multiple inlet flows or multiple outlet flows can simultaneously affect level.
● It is sometimes necessary to manipulate more than one flow to control level.
● If there are multiple inlet or outlet flows, it may be necessary to maintain inlet flows or outlet
flows at a fixed ratio while maintaining constant inventory.
● When control of unit feed rate and/or feed mix are important objectives, sometimes true for
reactor feed surge drums, these objectives strongly influence how inventory is controlled.
We begin the discussion of inventory control applications in Section 9.2 with single loop level
control. Section 9.3 presents several typical light-ends tower inventory control examples. Succes￾sive sections cover more complicated inventory control applications, and this chapter concludes in
Section 9.6, with further discussion of level control tuning objectives.
Note: The inventory control applications discussed in this chapter all feature relatively fast dynam￾ics between MV changes (inlet or outlet flow) and the level’s response. However, there are some
inventory control applications with significant deadtimes and dynamic effects between MV and
level. These normally involve an upstream MV, with other processing units between the MV and
the inventory variable controlled. This makes level controller tuning substantially more difficult,
and in these cases, a model-based approach (e.g., DMC) is often justified.
9.2 Single Loop Level Control
We begin with the simplest process configuration for level control, i.e., a drum with a single inlet
flow and a single outlet flow. In Figure 9.1, drum D-3 level (LC3) is controlled by manipulating D-3
outlet flow (FI3) – level controller LC3 directly adjusts valve LV3.
In Figure 9.2, drum D-12 level is controlled by manipulating D-12 inlet flow (FI132) – level con￾troller LC12 directly adjusts valve LV12.
Design Notes:
1. In Figure 9.1, when LC3 PV is increasing and/or is above its set point, LC3 OP must increase
to open LV3 and increase outlet flow FI3 PV; thus, LC3’s control direction is Direct. Remember:
We assume the DCS provides an analog output block (e.g., Honeywell TDC3000 APM) or an
AO function block (e.g., Honeywell Experion) that handles the valve characteristic and the
valve’s failure mode design (“air-to-open” or “air-to-close”) independent of the controller’s con￾trol direction. This guarantees LV3 opens when LV3 OP increases. Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License9.2 Single Loop Level Control 267
Figure 9.1 Simple Level → Valve Control,
MV = Flow Out
LC
3
FI
3
LV3
P-3
D-3
D-12
FV12
LV12
P-12
FC
12
FI
132
LC
12
Figure 9.2 Simple Level → Valve Control, MV = Flow In
Figure 9.3 Simple Level → Flow → Valve Cascade
D-3
FV3
P-3
LC
3
FC
3
2. In Figure 9.2, LC12’s control direction = Reverse since LC12 PV>LC12 SP requires a decrease in
LC12 OP to close LV12 to decrease inlet flow FI132 PV.
3. LC3 and LC12 are both tuned for best load response, proportional on PV, with SP Init = No.
The major drawback of the Level → Valve control loop is that the level controller must handle rel￾atively fast flow pressure disturbances after these disturbances have affected the level. In Figure 9.3,
drum D-3 level LC3 is controlled via a Level → Flow → Valve cascade. Flow controllers are always
(and easily) tuned tightly, and they execute at very high frequency (i.e., fast). Thus, flow controller
FC3 isolates high-frequency flow pressure disturbances to the fast flow loop and eliminates their Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License268 9 Level Control
effects before the LC3 level controller is affected. Both Level → Valve and Level → Flow → Valve
schemes are quite common, with cascade control normally preferred for the more important level
control loops.
Important: When the primary CV is critical (e.g., reactor inlet temperature) and the flow MV is
somewhat unreliable (quench flow), it is better to have the primary controller output directly to
the flow’s valve position.
9.3 Light-ends Tower Inventory Control
There are large numbers of light-ends towers in most chemical plants and all oil refineries. Tower
designs always include surge capacity at the tower bottoms, and in most cases, in a reflux drum for
accumulation of liquid condensed in the overhead condenser. Thus, inventory control is an integral
part of all tower designs, and consequently, there are normally many light-ends tower level control
loops in any petrochemical plant.
Unlike the levels in drums D-3 and D-12 in Figures 9.1–9.3, there are several potential manip￾ulated variables that can in principle be manipulated to control tower bottoms and reflux drum
levels. For most light-ends towers, there are other control objectives, in addition to the inventory
controls, that must also be satisfied. At unit design, there is “competition” for the available
manipulated variables that best achieve the other control objectives. Thus, light-ends tower
inventory control strategy design is linked to how other tower control objectives are achieved.
These other control objectives and the control strategies to achieve them, as well as the impor￾tance of tower cutpoint and fractionation, are presented and discussed in detail in Chapter 12,
Sections 12.1–12.6.
We will first look at inventory control strategies for a two-product tower, and then consider strate￾gies for a light-ends tower with one sidestream.
9.3.1 Two Product Towers
Two very common inventory control strategies for two-product light-ends towers are illustrated in
Figures 9.4 and 9.5. Two levels are controlled: the reflux drum level (LC55) and the tower bottoms
level (LC65). At steady-state, overall tower material balance must be satisfied; this requires the sum
of distillate and bottoms flow rates to be equal to the tower’s feed rate. Tower feed rate is almost
always set by upstream process conditions and thus it is not an independent variable available to
close the overall material balance. Thus, both distillate flow and bottoms flow cannot be fixed, i.e.,
at least one of these flows must be on level control to close the overall material balance.
In both Figures 9.4 and 9.5, bottoms level is controlled by manipulating bottoms flow rate via a
simple Level → Valve loop. A Level → Flow → Valve cascade (flow controller FC65 configured with
FI65 as its PV input) could in most cases be more effective. This depends on the bottoms hold-up,
and whether the flow control eliminates flow line upsets before the level is affected.
Bottoms level control can be difficult when the bottoms flow is very small in magnitude com￾pared to the liquid loading in the lower part of the tower. In this rare situation, reboiler heat input
(QR) could be manipulated to control bottoms level, but this can also be difficult to implement
effectively.
In Figure 9.4, reflux drum level is controlled by manipulating the reflux flow via the LC55 → LV55
loop. Note that a LC55 → FC53 → LV55 cascade could probably provide more effective control. If
this cascade strategy is implemented, LV55 would almost certainly be re-named FV53. Note that Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License9.3 Light-ends Tower Inventory Control 269
LV55
T
5
5
LC
55
FI
53
FI
65
LC
65
Feed
Fractionation
management
QR
P-55
LV65
Quality
loop
D-55
FC
55
FV55
TK-25
T
5
7
Heat
integrations
Figure 9.4 Light-ends Tower Inventory Control – Reflux Drum Level Control, MV = Reflux Flow
a quality loop is setting the distillate rate, which is on flow control. The bottoms flow is on level
control, which closes the tower material balance. The reboiler duty is being manipulated to manage
the tower fractionation. If there is a second quality specification, this product quality loop would
set the reboiler duty. The tower control strategy in Figure 9.4, with only one product flow on level
control (and the other available for product quality control), has historically been called a material
balance control scheme.
In Figure 9.5, the reflux drum level (LC55) is controlled by manipulating the distillate flow via the
LC55 → FC55 → FV55 cascade. A quality controller or the fractionation loop (or operator entry) can
set the reflux flow controller (FC53) setpoint. A tower fractionation or product quality controller
(or an operator entry) can also set the reboiler duty. Both distillate flow rate and bottoms flow
rate are on level control to close the tower material balance. This tower control strategy, with both
distillate and bottoms flows on level control, and reflux flow and reboiler duty available for product
quality control and/or to set fractionation, has historically been called an energy balance control
scheme.
The above discussion of light-ends tower inventory control illustrates that inventory control and
product quality control strategy designs are not independent. In most cases, designers specify the
best inventory control strategy based on surge capacity and reflux, distillate, and bottoms flow
rangeabilities. Manipulated variables that remain are available to meet the other control objectives.
In Chapter 12 (Tower Product Quality Controls), we further discuss various tower control strategies
and look more closely at how inventory control and product quality control strategies compete for
the available manipulated variables.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License270 9 Level Control
D-55
FC
53
LC
55
P-55
FV53
FV55
LV65
FI
65
FC
55
LC
65
T
5
5 Quality or
fractionation
loop
Feed
QR
Quality or
fractionation
loop
TK-25
Heat
integrations
T
5
7
Figure 9.5 Light-ends Tower Inventory Control – Reflux Drum Level Control, MV = Distillate Flow
9.3.2 Towers with One Sidestream
A sidestream adds one more potential manipulated variable for tower bottoms and reflux drum
level control. This provides additional flexibility when tower inventory control strategies are
designed. Like the two-product tower discussed in the last section, inventory control and product
quality control designs are not independent.
Figure 9.6 illustrates a method often used to implement inventory controls for towers with one
sidestream. There are two levels to control: the bottoms level (LC56) and the reflux drum level
(LC75). For this tower, there can be up to four product quality specifications to meet.1 As before,
the feed rate is almost always set by upstream process conditions. Thus, distillate, sidestream and
bottoms flows cannot all be fixed, i.e., at least one of these flows must be on level control to close the
overall material balance. In Figure 9.6, bottoms (FI56 via LV56) and distillate flow (FC75) rates are
manipulated to control the bottoms and reflux drum levels, while the sidestream flow (FC69) is
available to meet a product specification. Reflux rate and reboiler duty (QR) are available to meet a
product quality specification and/or manage tower fractionation.
Note that a low (or high) level alarm on LC56 and/or bottoms flow valve LV56 nearly fully closed
(or fully open) may indicate too little (or too much) liquid loading below the sidestream draw
off tray. This means the sidestream flow rate is too large (or too small) and must be reduced (or
increased). Custom code/logic can be provided to calculate and monitor the internal reflux below
1 A process variable summary – MVs, CVs, DVs, and calculated variables, along with CV–MV pairings for towers
with a side stream are presented and discussed in Chapter 12, Section 12.4.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License9.3 Light-ends Tower Inventory Control 271
P-75
FV37
FV75
T
7
5 FV69
Quality
loop
Quality or
fractionation
loop
FC
37
LC
75
FC
75
LC
56
FC
69
LV56
FI
56
Feed
QR
Quality or
fractionation
loop
D-75
Figure 9.6 Inventory Control, Tower with One Sidestream, MVs = Distillate and Bottoms Flow
the draw-off tray, and to either issue an operator warning or automatically override the sidestream
quality loop to re-establish tower material balance. The custom code/logic can also re-establish
normal quality control when material balance is recovered. Note: Changes in the reflux flow rate
(FC37), e.g., overriding the overhead quality or fractionation loop, will also affect bottoms level.
However, the response of bottoms level to changes in sidestream flow will be faster than its response
to changes in reflux rate. However, before choosing the preferred override strategy, the relative
importance/value of each product’s quality must be assessed.
Figure 9.7 illustrates a second inventory control strategy used for towers with one sidestream.
The reflux drum level is controlled by manipulating the reflux flow rate via valve LV85, while bot￾toms level is controlled by manipulating sidestream draw-off flow rate via valve LV57. Distillate
rate (FC85) and bottoms rate (FC58) are available to meet product specifications, and reboiler duty
is available to meet a product quality specification and/or manage tower fractionation. Because
bottoms level is controlled by sidestream draw-off rate, this inventory control strategy will typi￾cally maintain enough liquid loading below the sidestream draw-off tray. However, it is unusual to
choose both distillate and bottoms flows as quality loop MVs.
A third tower with sidestream inventory control strategy is shown in Figure 9.8 below. The reflux
drum level LC95 is controlled by manipulating the reflux flow, FC38, while bottoms level LC58 is
controlled by adjustments to tower bottoms rate, FI58 via LV58. Distillate rate (FC95) is available to
meet a product specification, while sidestream flow (FC79) and reboiler duty are available to meet
a product specification and/or manage tower fractionation. Adjustments to sidestream draw-off Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License272 9 Level Control
D-85
FI
39
LC
85
P-85
LV85
FV85
LV58
FC
58
FC
85
LC
57
T
8
5
FI
59
LV57
Quality
loop
Quality
loop
Feed
Quality or
fractionation
loop
QR
Figure 9.7 Inventory Control, Tower with One Sidestream, MVs = Reflux and Sidestream Flows
rate have a direct impact on internal reflux below the sidestream draw-off. Therefore, as shown in
Figure 9.8, internal reflux calculations can be incorporated into the quality or fractionation loop
manipulating the sidestream drawoff flow, FC79, but subject to calculated internal reflux flow
constraints. The internal reflux below the sidestream drawoff tray is calculated as the difference
between the internal reflux flow above the drawoff tray and the sidestream drawoff flow. Design
features ensure the internal reflux flow below the drawoff tray will remain above its minimum
allowable value whenever a new FC79 SP is calculated.
This discussion, which illustrates that inventory control and product quality control strategies
are not independent, and for towers with a sidestream may involve a quality override, is further
explored in Chapter 12, Section 12.8.3.
Last Thoughts
For towers with sidestreams, no matter how quality and/or fractionation (and inventory) control
loops are designed, all control loops strongly interact. Individual PID or model-based controllers
typically cannot effectively control quality. In addition, the multivariable nature of the control
problem makes constraint handling complex, and the constraint handling logic/code must be user
provided. Therefore, it is usually best to use multivariable constraint control (e.g., DMC) to achieve
the control objectives for towers with sidestreams. This includes the inventory controls. Levels are
frequently incorporated into a DMC controller as ramp variables which can be configured to always
be balanced (at steady state). Without CV–MV pairing, DMC can adjust multiple manipulated Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License9.4 Level Controllers that Manipulate Multiple Flows 273
D-95
FC
38
LC
95
P-95
FV38
FV95
LV58
FI
58
FC
95
LC
58
T
9
5
FC
79
FV79
Quality
loop
Internal reflux
below D/O tray
calculation
Feed
QR
Quality or
fractionation
loop
Quality or
fractionation
loop
TI
52
TI
53
Figure 9.8 Inventory Control, Tower with One Sidestream, MVs = Reflux and Bottoms Flows
variables to control levels and simultaneously satisfy other control objectives. Note that the DMC
controller’s scope is typically wider than the individual tower.
9.4 Level Controllers that Manipulate Multiple Flows
For some process units, designers provide more than one outlet stream for units with inventories
that must be controlled. In most cases, the streams either have different process destinations and/or
they provide unique opportunities to recover heat more efficiently. The following examples use an
accumulator drum for illustration, although the same control strategy design principles are valid
for other applications, e.g., fractionator bottoms inventory control.
9.4.1 Manipulated Flows are Unmeasured
Figure 9.9 shows accumulator drum D-35 with two outlet streams, a level indicator (LI30), and a
control valve in each stream, LV30A and LV30B; neither stream’s flow is measured. The control
strategy to maintain D-35 level (LC30) constant at its set point has LC30 manipulating both outlet
flows via the two control valves, LV30A and LV30B. Remember: Like the simple Level → Valve
control loops in Figures 9.1 and 9.2, LC30 must handle relatively fast flow pressure disturbances
after these disturbances have affected the level.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License274 9 Level Control
LV30A LV30B
LC30 LI
30
D-35
LV30A
LV30B
LI
30
Figure 9.9 Surge Drum (D-35) Level Control, Manipulated Flows Unmeasured
This control strategy’s structure appears to be quite simple. However, it is an example of a complex
cascade (see Chapter 2, Section 2.1), i.e., a single primary (LC30) outputting to multiple (in this
case two) secondaries. A complex cascade requires special functionality to handle initialization
and wind-up status because standard DCS functionality cannot correctly initialize the primary, or
set the primary’s wind-up status, using its “Cascade Rules” features (see Chapter 2, Section 2.8).
Design Notes and Features for Level Controller LC30 in Figure 9.9
1. LC30 Tuning and Configuration: Controller outputs are always calculated as % open. Thus,
if level LC30 PV is increasing and/or above LC30 SP, then LC30 OP must increase to open both
LV30A and LV30B to increase outlet flow; thus, control direction is Direct. LC30 should be tuned
for best load response, proportional on PV, with SP Init = “No.”
2. Valve Failure Mode Design: Since we assume the DCS provides functionality that handles
the valve’s failure mode design external to LC30 (e.g., via an AO block), LC30 can have control
direction = Direct and achieve its control objective no matter the valve’s failure mode, even if the
valves have different failure modes. For example, assume valve LV30A is air-to-close (fail open),
valve LV30B is air-to-open (fail closed), and LC30 calculates an output increase of 30% → 40%.
As shown in Figure 9.10a, air-to-close valve LV30A is fully open at LC30 OP = 0% and fully
closed at LC30 OP = 100%. With LV30A’s AO block’s output direction configuration = Reverse,
the 30% → 40% valve opening desired by LC30 OP is correctly converted to an LV30A change
from 70% → 60%. Likewise, in Figure 9.10b, air-to-open valve LV30B is fully closed at LC30
OP = 0% and fully open at LC30 OP = 100%. With LV30B’s AO block’s output direction configu￾ration = Direct, the 30% → 40% valve opening desired by LC30 OP opens LV30B from 30% → 40%.
3. LC30 Initialization: Logic/code must be provided to bumplessly initialize LC30 when control is
turned “On,” i.e., LC30 transferred from Manual to Auto mode. This involves the calculation of
both initialized output values, but not a new set point (SP Init = No) when control is turned On.
4. Setting LC30 Wind-up Status: Logic/code must be provided to set LC30’s wind-up status any￾time LV30A and/or LV30B reach a high or low limit. Note: The wind-up status of LC30 depends
upon whether one or both valves must reach an output limit to stop control (see “What If” issue
#1 below).
“What If” Issues
The resolution of each of the following issues must be incorporated into the final design:
1. Should level control stop (wind-up flag set to high/low, i.e., LC30 cannot output) only if one
valve reaches an output limit or only if both valves reach an output limit? Note: The process
destinations of the two streams, especially if they are different, will impact this decision.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License9.4 Level Controllers that Manipulate Multiple Flows 275
Reverse
Direct
Output
direction
Air-to-open
LC30
PID algo
OP (%)
100 -%OP
Air-to-close
I/P
LV30A input
connection
LV30A output
connection
LV30A
output direction
configuration:
reverse
LV30A
LV30A
LC30 OP: 30% → 40%
LV30B input
connection
OP to field:
70% → 60%
LV30A
% open
LC30 OP
60% 70%
100%
100%
0%
0%
30%
40%
LC30 OP decreasing,
LV30A opens
(a)
(b)
Reverse
Direct
Output
direction
Air-to-open
LC30
PID algo
OP (%)
100 - %OP
Air-to-close
I/P
LV30B input
connection
LV30B output
connection
LV30B
output direction
configuration:
direct LV30B
LV30B
LC30 OP: 30% → 40%
LV30A input
connection
OP: to field:
30% → 40%
LV30B
% open
100%
100%
0%
0%
30% 40%
30%
40%
LC30 OP
LC30 OP increasing,
LV30B opens
Figure 9.10 (a) Air-to-Close (LV30A), (b) Air-to-Open (LV30B) Valve Characteristics
2. If level control can continue with one valve, should the level controller’s gain be adjusted and if
so, how? Note: LC30 design must bumplessly transition to manipulate one valve when the other
valve becomes limited, and two valves when the valve at an output limit becomes unconstrained
once again.
Important: In Section 8.4.1, a potential corporate developed/supported control package to man￾age initialization and wind-up statuses for a primary outputting to multiple secondaries (complex
cascades) was identified. If such a package is available, it would manage, in a best practice manner,
the design and “what if” issues identified above for LC30 in the control strategy in Figure 9.9.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License276 9 Level Control
9.4.2 Manipulated Flows are Measured
If both flow measurements are available, as shown in Figure 9.11, a Level → Total Flow → Valve
cascade can be implemented. All controllers in this cascade are PIDs. This is a more effective con￾trol strategy (relative to the strategy in Figure 9.9) for several reasons. First, it provides the usual
advantages of cascade control. In addition, after transferring either or both flow controllers to auto
mode, operators can change either or both flows individually via setpoint changes (FC35 SP and
FC36 SP) instead of valve position changes (LV30a and LV30b). Since the cascade also includes
total flow controller FC30, operators can also change the total flow with one flow set point change
(FC30 SP).
The initialization and wind-up design notes and “What if” issues described earlier for the
Level → Valve strategy (in Figure 9.9) are for the most part applicable when flow measurements
are available. However, they must be updated somewhat when applied to the control strategy in
Figure 9.11.
Design Notes and Features for Level Controller LC30 in Figure 9.11
1. Tuning and Configuration: LC30 is tuned for best load response, proportional on PV, with
SP Init = No and control direction = Direct. FC30 is a cascade secondary; thus, it is tuned for
best SP response, proportional on error, with SP Init = Yes and control direction = Reverse. FC35
and FC36 are both cascade secondaries and thus are tuned for best SP response, proportional on
error, with SP Init = Yes and control direction = Reverse.
2. Initialization: Since the total flow controller is the “primary” with respect to the two secon￾daries, FC30 must be initialized bumplessly when the control is turned “On,” i.e., FC35 and/or
FC36 transferred from Manual or Auto to Cascade mode, FC30 transferred to Auto mode to
commission total flow control, or Cascade mode to also commission level control.
3. Wind-up: Like initialization, since total flow controller FC30 is the “primary” with respect to
two secondaries, its wind-up status must be set anytime FC35 and/or FC36 setpoints reach a
high or low limit or when FC35 and/or FC36 wind-up statuses are set high, low, or high/low.
Note: The wind-up status of FC30 and thus the wind-up logic/code depends upon whether one
or both flow controllers must be wound-up to stop control (“What If” issue #1 below).
D-35
FV35 FI
36
FI
35
LI
30
FV36
LC30
FC30
SP
FC36
SP SP
Total flow
control
LI
30
FI
36 FI
35
FV35 FV36
Desired D-35 level
SP
FC35
Figure 9.11 D-35 Level Control with Flows Measured, Total and Individual Outlet Flows Controlled
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License9.5 More Complex Level Control Applications 277
“What If” Issues
1. Instead of one or two valves reaching a limit, the issue is whether one or both flow controllers
must have a normal wind-up status, and whether one or both flow controllers must be in Cas￾cade mode for total flow control to continue.
2. Instead of the level controller’s gain, the issue is whether the total flow controller’s gain should
be adjusted if level control can continue with only one flow manipulated.
Important: A corporate developed/supported control package (in Section 8.4.1) that manages ini￾tialization and wind-up statuses for a primary outputting to multiple secondaries, applicable to
LC30 in the control strategy in Figure 9.9, is also applicable to the control strategy in Figure 9.11 – it
will manage all FC30 initialization and wind-up issues listed above.
9.5 More Complex Level Control Applications
For many level control applications, the control strategy design involves more than the manipula￾tion of one or more flows to control a level. We present examples below that require special design
features to achieve the control objectives.
The first application (Section 9.5.1) manages a hold-up drum’s inventory via a level control strat￾egy that has two possible manipulated variables, but the level controller manipulates only one flow
(as specified by an operator entry) at any one time. The second (Section 9.5.2) manages a reactor’s
feed drum inventory (with multiple inlet flows and a single outlet flow) via a level control strategy
that manipulates one inlet flow, and provides feedforward (FF) adjustments for non-manipulated
inlet, and outlet flow changes. The third application (Section 9.5.3) does not control a level – it
controls the feed mix and feed quality at the inlet to a reactor.
Note that depending upon the process configuration, an operational upset can cause a level con￾troller to become wound-up, and level can no longer be controlled. If so, an overflow (level rising) or
a pump cavitation on low flow (level falling) become potential risks. If the risk is real, and an oper￾ational hazard, a level control override can be implemented to mitigate the risk. Two examples of
level control override strategies were presented and discussed in Chapter 6 (Override Controls). In
both strategies, level controllers override a tower quality control loop; see Sections 6.2.1 and 6.2.3.
9.5.1 Reactor Quench Flow Hold-up Drum Inventory Control with Secondary Switch
Visbreaking is a thermal cracking process that converts crude distillation unit (CDU) or vacuum
pipestill bottoms products (e.g., residue) into more valuable cracked products for fuel oil blending.
After preheating, Visbreaker feed is routed to a fired heater, where the desired reactions to produce
the fuel oil blend components occur after the feed reaches the required (extremely high) cracking
temperature. To prevent coking in the downstream product fractionator, the fired heater effluent
(fractionator feed) is quenched to stop the cracking reactions before entering the fractionator. The
quench flow (FC39 in Figure 9.12) comes from a quench drum (D-108) and is injected into the fired
heater effluent. The combined reactor effluent and quench then flow to the fractionator where the
desired products (naphtha, gas oil) are separated.
Figure 9.12 shows the Visbreaker reactor quench drum D-108 with three quench flow sources,
one from the product fractionator (a small portion of the fractionator’s bottoms product) and the
other two from slop tanks. The reaction quench flow target (FC39 SP) is set by operator entry,
and fractionator flow to D-108 (FC25) is set by downstream (fractionator) process conditions. To
maintain D-108 inventory constant as FC39 and FC25 flows change, one of the other two sources Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License278 9 Level Control
D-108
LI
35
From product
fractionator
FV25
FC
25
TK-210
FV35
FC
35
TK-122
FV26
FC
26
Visbreaker
fired heater
FC
39
Reaction quench flow
Product
fractionator
Figure 9.12 Visbreaker Reaction Quench Flow Hold-up Drum Configuration
of quench material is manipulated. Via a console entry, operators specify the quench material
(FC35 or FC26) to manipulate. Unlike the strategies discussed in Section 9.4, this control strat￾egy has two potential manipulated variables, but the level controller manipulates only one at any
one time.
The D-108 inventory control strategy is shown in Figure 9.13. The level controller LC35
manipulates either FC35 or FC26, depending upon the operator’s entry. For either secondary,
LC35 is tuned for best load response, proportional on PV, with SP Init = No and control
direction = Reverse. If FC35 and FC26 flow ranges are about the same (as assumed below), LC35
tuning is the same for either manipulated variable; if not, LC35’s proportional gain may need to be
changed when an MV switch is made.
SP
FC
35
FC
26
LC35
LI
35
Secondary
switch
FV35 FV26
Auto
mode
Casc
mode
Casc
mode
Auto
mode
SP Operator entry:
desired secondary
Step 3
Step 4
Step 5
Figure 9.13 Quench Flow Hold-up Drum Inventory Control with Secondary Switch
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License9.5 More Complex Level Control Applications 279
The key component of this strategy is the secondary switch. The switch must mimic the actions
an operator would take to commission the level controller, starting with the specification of the
desired secondary.
For this example, let’s assume the daily operations directive changes the desired secondary:
instead of using FC26, use FC35 to maintain D-108 level. First, let’s examine the step-by-step
procedure the operator would have to follow in a modern DCS if he/she wanted to manually
change the secondary:
1. Check FC35 status – if in Auto mode, not wound-up, and not initializing, proceed.
2. Check LC35 status – if in Auto mode, not wound-up and not initializing, proceed.
3. Transfer FC26 from Cascade (Casc) to Auto mode.
→ The next time LC35 executes, it becomes output indisposable i.e., wound-up High/Low (see
Chapter 2, Section 2.8) – it cannot output to either secondary (standard DCS functionality).
4. Change LC35’s output destination from FC26 SP to FC35 SP
→ Important: In most DCS’, this is typically not possible directly from the operator’s console
unless enabled by engineer provided logic/code.
→ Since FC35 is still in Auto mode, LC35 remains output indisposable (wound-up High/Low)
but with its output’s destination correctly pointed to FC35.
5. Transfer FC35 from Auto mode to Casc mode.
→ The next time LC35 executes, its PID algorithm is initialized, its output is initialized to match
the current FC35 SP, and its wind-up status becomes normal (standard DCS functionality).
6. Check to make sure the cascade has been successfully commissioned.
For operator convenience, these steps are typically automated. The application’s design must
include the logic and code for bumpless switching and provide a method for operators to specify the
desired secondary via a console entry. In a modern-day DCS, this switch functionality can typically
be provided with minimal custom code using standard DCS features. Note: Once the LC35 → FC26
or LC35 → FC35 cascade is commissioned, initialization and wind-up statuses are resolved via
standard DCS functionality.
9.5.2 Reactor Feed Drum Inventory Control with Multiple Feed Sources
The Fluid Catalytic Cracking Unit (FCCU) is the most important gasoline producing process unit
in today’s oil refineries. This process converts heavy feedstocks, such as atmospheric residue (CDU
bottoms), vacuum residue (VPS bottoms) and vacuum gas oils (VGO – VPS sidestream products),
into more valuable products: gasoline blend components, middle distillate blend components and
light, highly olefinic gases.
The FCCU feed drum configuration shown in Figure 9.14 is typical. The FCCU feed consists of
multiple refinery streams, from both tankage (FC401, FC701 and FC301) and “off-the-unit” (FI501).
These streams are combined in feed surge drum D-601, and the FCCU’s feed stream is sent via
flow control (FC601) to the FCCU preheat heater. The lubes extract (by-product of lube oil produc￾tion) is set by upstream process units and cannot be regulated. Operators set the FCCU feed rate
by changing FC601 SP via a console entry. Operator entered FC401 SP, FC301 SP, and FC601 SP
changes, and lubes extract flow rate upsets (FI501 PV) will all affect D-601 inventory, indicated by
level measurement LI601 PV.
The control strategy in Figure 9.15 manages FCCU feed drum inventory via the LC601 → FC701 →
FV701 control cascade. The strategy has a feedback and an important FF component. The feed￾back and FF corrections are combined by configuring LC601 with the PID FF control algorithm
discussed in Chapter 3, Sections 3.5 and 3.6. FC5701 provides the FF input value for LC601’s PID
FF control algorithm.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License280 9 Level Control
TK-405
TK-705
Atm
residue
VGO
P-405
Lubes
extract
P-705
FV701
FC
401
FI
501
FC
701
TK-305
To FCCU
preheat heater
D-601
Vacuum
residue
P-305
FC
301 LI
601
P-600
FC
601
Figure 9.14 FCCU Feed Drum D-601 Flow Configuration
Operator entered changes to D-601 inlet flow (FC401, FC301) set points, FCCU feed flow (FC601)
set point, and lubes extract flow rate upsets (FI501 PV) will require LC601 control adjustments to
maintain D-601 inventory constant. The FF correction anticipates the effects of those flow varia￾tions on level, and via material balance, predicts the FC701 SP value required to maintain LC601
PV constant despite changes in any of the four other flow rates.
Referring to Figure 9.15, FC5701 calculates its PV as the predicted VGO feed flow rate that will
maintain D-601 inventory constant if any flow set points (FC401, FC301 and FC601) are changed by
an operator, or lubes extract flow upsets (FI501 PV) occur. Thus, on every execution pass n, a steady
state material balance calculates the predicted VGO feed flow rate, FC701 SPn,Pred, that closes the
material balance given the values of the other four flows:
[FC301SPn + FC401SPn + FI501PVn + FC701SPn,Pred]−[FC601SPn] = 0
FC701SPn,Pred = FC601SPn − [FC301SPn + FC401SPn + FI501PVn] (9.1)
FC5701 is configured with an appropriate PV algorithm or function block that performs the PV
calculation in Equation (9.1); thus, on every execution pass, FC5701 PVn =FC701 SPn,Pred. FC5701’s
control algorithm or function blocks store FC5701 PV, in EUs, to its output location, FC5701 OP.
Thus, FC5701 PV becomes FC5701’s control calculation result, in EUs, and on every execution pass,
FC5701 OPn (EUs) = FC5701 PVn (EUs). FC5701’s control calculation result, FC5701 OPn in EUs
(= FC5701 PVn), is the source for LC601’s PID FF control algorithm’s FF input.
In a modern-day DCS, all tag entities configured with a control algorithm such as FC5701
performs its control calculation only when it is in auto (or cascade) mode. Similar to the dynamic
compensation tag,2 LC601’s FF correction On/Off is managed by FC5701’s mode – it is On in
2 As explained in Sections 3.4–3.7.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License9.5 More Complex Level Control Applications 281
VGO to
drum D-601
FV701
FC
701
FC5701
FI
501
FC
301
FC
401
FC
601
SP
SP
SP
LC601 FF input
FC5701 PV
SP
LI
601
SP
Desired
D-601 level
LC601
(PID FF
Ctl Algo)
–
OP (EU)
Figure 9.15 FCCU Feed Drum D-601 Inventory Control
Auto mode, Off in Manual mode. In Manual mode, FC5701’s control algorithm does not execute,
and thus LC501’s FF input source, in FC5701 OP, is not updated and remains constant. This allows
the feedback control adjustments to continue when FF control is off and the FF input source is
constant.
In the LC601 control strategy, LC601’s PID FF control algorithm’s FF correction is:
ΔFF,n = (FC5701 PVn − FC5701 PVn−1) (9.2)
The current FF correction ΔFF, n is the predicted change in FC701 SP required to maintain D-601
inventory constant if any of the other four flows have changed since the last control execution
(n−1). FC5701 PVn is the current FF input value and FC5701 PVn−1 is the last FF input value. On
every control execution pass, the FF correction, calculated by the PID FF control algorithm, must
increase the MV value when the predicted VGO feed flow calculated in Equation (9.1) – FC5701
PVn, has increased (ΔFF,n >0), and decrease the MV value when FC5701 PVn has decreased
(ΔFF,n <0).
Equation (9.3) is LC601’s PID FF control algorithm’s control output calculation. The current
FF correction (ΔFF,n), calculated in Equation (9.2), is in EU and is added to LC601’s standard
PID feedback control algorithm result in EUs (PID Algo Output in EU), to yield the MV value,
FC701 SPn:
MVn in EU ≡ FC701 SPn = PID Algo Outputn in EU − KFF ∗ ΔFF,n (9.3)
To utilize the standard PID FF algorithm or function block calculation (in Figure 3.12,
Section 3.5), in Equation (9.3), the user entry, KFF, must be set = −1. In Equation (9.3):
ΔFF,n Current incremental FF correction, in EUs, as shown in
Equation (9.2).
PID Algo Outputn in EU Current feedback correction, in EUs, calculated by LC601’s PID
algorithm.
FC701 SPn Desired MV set point in EUs, the current LC601 output that
includes feedback and FF corrections.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License282 9 Level Control
Notice that as required, when FC5701 PVn calculated in Equation (9.1) increases (e.g., FC601 SP
increased, FC401 SP decreased), ΔFF,n in Equation (9.2) is positive, and in Equation (9.3), the FF cor￾rection increases the MV value. Likewise, when FC5701 PVn decreases (e.g., FC601 SP decreased,
FC401 SP increased), ΔFF,n is negative, and the FF correction decreases the MV value. And finally,
on every control execution pass, the current FF input value (FC5701 PVn) is stored as the last FF
input value for use on the next (n+1) control execution pass.
When FF control is re-commissioned after being Off (FC5701 transferred from Manual to Auto
mode), custom initialization logic must be provided to force LC601 to initialize. Standard PID FF
algorithm features will set the last FF input value equal to the current, initialization pass input
value, making their difference in Equation (9.2), the FF control correction, zero. This ensures there
will be no FF bump on the first control execution pass after FF control is re-commissioned.
The PID FF control calculation result FC701SPn, in Equation (9.3), is LC601’s control output sent
to the VGO flow controller’s set point, FC701 SP. LC601 output in % of range of the MV, LC601 OP
(%), is calculated and is displayed as LC601’s output:
LC601 OPn(%) = (FC701 SPn − FC701L)
(FC701H − FC701L) ∗ (100%) (9.4)
In Equation (9.4), FC701H and FC701L are VGO EU range high/low values, and LC601 OPn (%) is
the new VGO flow set point, FC701 SPn, in % of range of the VGO flow.
Note 1: Since LC601 SP will rarely be changed, and the only expected D-601 inventory upsets
are changes in the five (inlet and outlet) flows, the feedback component of the LC601 →
FC701 → FV701 cascade primarily corrects for inaccuracies in FC5701’s FF input calculation.
Note 2: Standard PID FF functionality manages the unavailability of the FF input (FC5701 PVn
declared “Bad”) and its return to “Good” status without impact to the feedback control.
Note 3: If the DCS does not support the PID FF control algorithm, the PID plus incremental FF
control strategy’s functionality must be user-provided using available DCS features.
Note 4: There is reasonable likelihood that the LC601 → FC701 feedback control loop can man￾age D-601 inventory without the FF corrections calculated by FC5701 if (i) FC301 SP, FC401 SP
and FC601 SP changes are made infrequently, (ii) user provided set point ramping functionality
is provided for these three set points, (iii) D-601 hold-up time is relatively large, and none of the
flow changes have significant impact on LC601 PV, and (iv) lubes extract flow upsets, FI501 PV, are
relatively infrequent and not large.
Design Notes and Features
1. LC601 is tuned for averaging level control (see Section 9.7), proportional on PV, with SP
Init = No, Control Direction = Reverse. Because operators do not like to see key level controller
set points that are expected to be ≈50% at say 51.4%, thought must be given to slowly ramping
LC601’s set point back to its desired target, probably = 50%, following LC601’s initialization.
2. If one or more flow measurements, i.e., FI501 PV, FC301 PV, FC401 PV or FC601 PV become
unavailable, it is best to decommission the FF corrections. LC601 feedback control will continue,
provided FC701 is not wound-up and is in Cascade mode, and level control performance will
almost certainly be acceptable.
3. Using FC601, FC301 and FC401 setpoints in the FF input calculation in FC5701 smooths the FF
calculation and helps LC601 meet its control objectives. If so, it is necessary to configure each
flow controller for SP Init = Yes. However, since FC601 (FCCU feed) is independent of LC601’s Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License9.5 More Complex Level Control Applications 283
control performance, use of the flow measurements instead of the set points is acceptable. This
should be discussed with operations before implementation.
4. The design ensures (i) level (feedback) control continues when the FF corrections calculated by
FC5701 are turned Off (FC5701 transferred to manual mode) and (ii) turning the FF control On
(FC5701 transferred to auto mode) does not affect the feedback loop.
5. To smooth flow setpoint changes and help ensure they do not cause downstream upsets, FC601
SP changes can be ramped to their final values. If setpoint ramping is a standard DCS feature,
no user provided coding/logic enhancements are necessary; if not, user provided logic/code is
needed. To ramp, where to ramp, and ramp rates should be discussed with operations before
implementation.
9.5.3 Reactor Feed Rate and Feed Mix Control
Hydrofiners are fixed-bed, catalytic reactor systems that remove sulfur and other impurities from
feed streams such as (i) virgin naphtha, kerosene and diesel boiling range sidestreams from crude
distillation units (a CDU) and (ii) higher boiling cracked distillates from FCCU separation units
(e.g., main fractionator). This is achieved by catalytic reactions that convert organic sulfur in the
hydrocarbon feed to hydrogen sulfide (H2S). A hydrogen rich treat gas provides a large excess of
hydrogen to promote the desired reactions. Reactor temperature and hydrogen partial pressure are
the most important process variables. They are key manipulated variables used to obtain the desired
conversion to meet the product sulfur specification. They also play a critical role in managing the
catalyst deactivation rate, and consequently the catalyst run length.3
Figure 9.16 shows the feed configuration for Naphtha Hydrofiner R-601. Virgin naphtha (stabi￾lized CDU overhead) and cat naphtha (from a FCCU fractionator) are mixed and then preheated
R
6
0
1
H2 rich
treat gas
Virgin
naphtha
(VN)
Cat
naphtha
(CN)
E-602 E-601
TV603
Naphtha
H/F
FI
601
FI
603
TC
603 FV603
FV601
Catalytic reformer
effluent
Catalytic reformer
effluent
Figure 9.16 Naphtha Hydrofiner Feed Configuration
3 The effects of temperature and H2 partial pressure on catalyst deactivation and reactor conversion are explained
in Chapter 14 (Reactor Conversion Control).
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License284 9 Level Control
by heat exchange (with catalytic reformer reactor effluent). The hydrocarbon – treat gas mixture
enters the reactor on temperature control. When there are multiple (in this case, two) feed sources
with different boiling ranges, feed rate changes can also change feed composition. For example,
cat naphtha (CN) is heavier than virgin naphtha (VN) and has a higher sulfur content. As the
feed mix gets heavier (more CN relative to VN), feed sulfur content increases, and desulfurization
becomes more difficult. To achieve the same amount of desulfurization, a higher reactor tempera￾ture is needed. However, higher temperatures increase the coke build-up on the catalyst, and the
catalyst deactivates more rapidly. The desulfurized naphtha (R-601 effluent) is used predominantly
as catalytic reformer feed, where high-octane gasoline components or aromatics plant (BTX) feed
stocks are produced.
This example does not control a level; instead, it controls the reactor’s feed rate, and feed quality
at the inlet to the reactor. This is a common requirement for many reactors and other process units.
The two main operating objectives at the reactor inlet are:
1. Maintain a constant, desired feed percent CN target (% CN Tgt) when the total hydrofiner feed
rate is changed. Note that % CN is defined as:
%CN ≡ CN in feed
Total feed ∗ 100% (9.5)
2. Because FC601 PV and FC603 PV combined become R-601’s feed, minimize noise propagation
to FC601 and FC603 flow set point calculations
The control strategy shown in Figure 9.17 maintains constant total reactor feed rate (FC600 SP)
while honoring the % CN feed mix target. To minimize noise propagation to R-601’s feed stream,
VN and CN flow set points (not PVs) are used in the calculation. Since both flow controllers are
secondaries and thus configured for SP Init = Yes, their set points should always be meaningful.
This is not true when FC601 PV or FC603 PV measurements are not available. However, if either
FC601 PV or FC603 PV becomes unavailable, the control strategy’s design decommissions total
flow control (see Design Notes and Features #4).
To meet the operating objectives, FC601 SP and FC603 SP must satisfy the following equations
simultaneously at every execution pass:
Overall Material Balance:
FC600 SPn = FC601 SPn + FC603 SPn (9.6)
FC600
Desired
% CN
Desired
total feed
SP
SP SP
FI
601
FC
601
FI
603
FC
603
FV601 FV603
Figure 9.17 Naphtha Hydrofiner Feed Rate and
Feed Mix Control
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License9.5 More Complex Level Control Applications 285
Feed Mix (from Equation (9.5)):
%CN Tgtn = FC603 SPn
FC600 SPn
∗ 100% (9.7)
The control algorithm is obtained by solving Equations (9.6) and (9.7) simultaneously for FC601
SP and FC603 SP. The results are expressions for virgin naphtha (FC601 SP) and cat naphtha (FC603
SP) flows, for any values of total flow (FC600 SP) and % CN (% CN Tgt):
FC601 SPn = FC600 SPn ∗ (100%−%CN Tgtn)
100% (9.8)
FC603 SPn = FC600 SPn − FC601 SPn (9.9)
Note that FC600 is not a PID controller – it is simply enforcing the overall material balance
at the current total flow setpoint and the desired feed split (using Equations (9.8) and (9.9)). For
the control strategy to achieve its operating objectives, VN and CN flow controllers – FC601 and
FC603 – must meet their own control objectives, i.e., PV≈SP. Therefore, not only must FC601 and
FC603 flow measurements be available, both component flow controllers must be in Cascade mode,
not wound-up, and have their PV≈SP. See Design Notes and Features #3–#5 for further details.
Design Notes and Features
1. To provide an indication of whether FC601 and FC603 controllers are operating normally,
FC600’s PV is calculated as the sum of FC601 PV and FC603 PV, not the sum of their set points.
If both flow controller secondary operations are normal – their PVs≈their SP, then FC600
PV≈FC600 SP.
2. FC600 is not a controller – on every execution pass, its function is to calculate the values
of FC601 SP and F603 SP that satisfy the relationships in Equations (9.8) and (9.9). These
calculations are easily provided using a standard DCS control algorithm or standard function
blocks.
3. FC600 Initialization: This strategy is another example of a complex cascade, e.g., one
primary outputting to two secondaries. Therefore, logic and/or code must be provided to
bumplessly initialize FC600 when control is turned On – FC600 transferred to Auto mode
and both FC601 and FC603 transferred to Cascade mode. On an initialization pass, FC600
SP and % CN target are back calculated (via Equations (9.6) and (9.7)) using the current
values of FC601 SP and FC603 SP. Both FC600 SP and % CN Tgt would normally be spec￾ified in the daily operations plan and if so, after initialization, they must be slowly ramped
back to their last, desired values, to ensure feed rate and feed mix control objectives are
satisfied.
4. Setting FC600 Wind-up Status: Logic and/or code must be provided to set FC600’s wind-up
status when either FC601 or FC603 is limited, at either a setpoint high/low or output high/low
limit. The FC600 wind-up status logic must consider whether both flow controller setpoints
can be satisfied. Total flow control must stop when either FC601 or FC603 is unavailable, not
in cascade mode, or has wind-up status that makes it impossible to meet either the total flow
setpoint or the feed split target4. A console message should alert the operator that the R-601 total
flow setpoint and/or the feed split target cannot be met.
4 The corporate developed/supported standard control package suggested in Section 8.4.1 to manage the
initialization and wind-up statuses of complex cascades, would be applicable to the control strategy in
Figure 9.17.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License286 9 Level Control
5. In principle, total flow control can continue when either FC601 or FC603 is transferred out of
Cascade mode or is wound-up. However, if that flow controller’s flow PV remains constant,
adjustments to the other controller’s flow to meet the total flow target will cause the feed
mix to deviate from its desired target. Whether or not total flow control should continue
when the feed mix target cannot be satisfied must be discussed with operations. This decision
has important impact on the logic/code that manages FC600 initialization and its wind-up
status.
9.6 Averaging and Tight Level Controller Tuning
As stated earlier, a level controller’s tuning objective is determined by the specific level being con￾trolled, the level controller’s manipulated variable and the process configuration. In almost all cases
of interest, the MV will be a flow. If the tuning objective is tight level control, the level is controlled
as closely as possible to setpoint regardless of the variations in the MV. If the tuning objective is
averaging level control, the level can deviate from setpoint – within alarm limits – to minimize the
variations in the flow MV.
Tight level control is much more common than averaging level control. Operators are more famil￾iar with tight level control and feel much more comfortable when levels are held close to setpoint.
Averaging level control is typically implemented on an as-needed basis, and only with operations
agreement. Averaging level control is advantageous when frequent and/or large changes in the
level controller’s MV can have adverse effects on downstream process units. However, a necessary
condition for effective averaging level control is sufficient surge capacity. When surge capacity is
provided and holdup time is large enough, deviations from setpoint are not critical. There is room
for the level to wander away from setpoint, approach alarm limits from time to time, but exceed
alarm limits only occasionally. When surge capacity is small, tight level control is the only choice,
even if MV changes cause adverse downstream upsets.
Surge capacity is quantified by the hold-up time, the time required for a wide-open valve to fill or
empty the volume between the level taps. Hold-up time is calculated as the volume between level
taps divided by the maximum inlet or outlet flow rate. The maximum inlet or outlet flow rate is
defined as one of the following:
● Measured flow through a wide-open valve.
● If the measurement is not available, a multiple (≈1.1 → 1.4) of the design flow rate.
● For a level → flow cascade, the flow measurement’s instrument range when the instrument range
is less than the flow through a wide-open valve.
For hold-up times less than ≈5 → 10 minutes, tight level control will almost always be necessary.
For hold-up times greater than ≈25 → 30 minutes, averaging level control will almost always be
achievable. Designers usually provide sizable surge capacity for reflux drum, light-ends tower bot￾tom, and feed drum inventories. Therefore, if justified, tuning for averaging level control for these
cases is normally feasible.
Since our emphasis is on design, not implementation, we will focus on the basis for deciding
on whether tight or averaging level control is appropriate. An examples-based discussion of level
controller tuning objectives follows, using some of the specific process configurations and level
controller designs presented earlier in this chapter. Level controller tuning, and both tight and
averaging level control tuning correlations and guidelines, can be found in the literature (Ref. [1])
and in recent process control textbooks (Refs. [2, 3]).
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License9.6 Averaging and Tight Level Controller Tuning 287
Design Note
Operator acceptance for averaging level control is easier to achieve in a grass-roots unit compared
to retuning an existing controller. Expect operators to be concerned with levels approaching alarm
limits, and especially if alarm limits are exceeded, even if infrequently. Thus, it is important
that the controller tuning brings the level back from an occasional alarm limit violation in a
timely manner.
9.6.1 Light-ends Towers: Distillate Flow on Level Control
Figure 9.5 (discussed in Section 9.3.1) shows distillate and bottoms flow manipulated to control
reflux drum and tower bottoms levels, and reflux flow and reboiler duty manipulated to set quality
and fractionation for light-ends tower T-55. The downstream destinations of distillate and bottoms
product flows are key factors when deciding on level tuning objectives for reflux drum D-55 and
T-55 bottoms level controllers (LC55 and LC65 respectively). Figure 9.5 indicates that T-55 distillate
product (FC55) is feed to downstream tower T-57, and T-55 bottoms product (FI65) flows to tankage
(TK-25).
In almost all cases, a stable tower feed rate is desirable. Since light-ends tower reflux drum designs
typically have enough surge capacity to support averaging level control, LC55 is a very good candi￾date for averaging level control tuning.
T-55’s bottoms rundown product exchanges heat with several process streams in a series of heat
exchangers, and then flows to TK-25 (Figure 9.5). As mentioned earlier, light-ends tower bottoms
inventory surge capacity is normally adequate to support averaging level control. Manipulation of
a product rundown flow to tankage would typically not need averaging level control. However, the
effects of bottoms flow variations on units that are heat integrated with the rundown stream need to
be assessed. If these effects are minor or are diminished by heat exchanger dynamics, LC65 tuning
will have little effect on downstream units. Since operators usually prefer tight level tuning, LC65
would probably be tuned for tight level control. However, if the heat integration effects are large
enough to cause undesirable exchanger cold side process upsets, then it would be best to tune LC65
for averaging level control.
9.6.2 Light-ends Towers: Reflux Flow on Level Control
Figure 9.4 (discussed in Section 9.3.1) shows reflux flow manipulated to control reflux drum level,
distillate rate manipulated to control quality and reboiler duty manipulated to manage fractiona￾tion for light-ends tower T-55. Quality adjustments to distillate flow are typically small in magni￾tude and made slowly since the quality loop’s primary controller frequency is normally no faster
than 30–60 seconds (when a tray temperature controller is the primary) and can be as slow as
20–30 minutes (when an analyzer controller is the primary). Therefore, a properly tuned qual￾ity loop will not normally upset the downstream tower (T-57) whose feed rate is the distillate
flow.
Note that the change in distillate rate will not affect T-55 fractionation until reflux drum D-55
level LC55 is affected and begins to adjust the reflux rate (FI53). Thus, it is best for LC55 corrections
to occur quickly. This makes tight level control advantageous. But sudden and/or large changes in
reflux flow rate can cause tower fractionation upsets which are almost always undesirable. This
makes averaging level control advantageous. How can this conflict be resolved?
In Figure 9.18, LC55 is tuned for averaging level control. It resets reflux flow controller FC53
SP, instead of directly outputting to valve FV53. This is necessary to facilitate the implementation Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License288 9 Level Control
D-55
LI
55
E-55
P-55
Quality
loop
LV53
FC
53
T
5
7
T
5
5 FV55
FC
55
SP
SP
Desired D-55 Level
LC55
(PID FF
Ctl Algo)
∆ [FC55 SP] –
SP
OP
Figure 9.18 Reflux Drum Averaging Level Control with Incremental FF Corrections for Distillate Flow
of the incremental FF correction to reflux flow rate shown in Figure 9.18, each time the quality
loop changes the distillate flow setpoint. Since an increase (decrease) in distillate rate will tend
to decrease (increase) LC55, and LC55 will decrease (increase) reflux rate to maintain constant
inventory, the incremental FF correction made to reflux flow is in the opposite direction to the
distillate flow rate change. This ensures an almost immediate effect on T-55 fractionation after the
quality loop changes the distillate rate. All other disturbances that affect level are handled by LC55,
and LC55 corrections are done slowly via the averaging level control tuning.
The level control plus incremental FF control strategy presented in Figure 9.18 features LC55
configured with the PID FF control algorithm discussed in Chapter 3, Sections 3.5 and 3.6, and
used in the configuration of LC601 in Section 9.5.2 (see Figure 9.15). Notice that because FC55 is a
cascade secondary, it is configured for SP Init = Yes. Thus, FC55 SP is meaningful even when FC55
is in Auto or in Manual mode, with the quality control loop off.
Note 1: As shown in Figure 9.18, LC55’s PID FF algorithm is the standard PID FF algorithm or
function block calculation (see Figure 3.12, Section 3.5), with user entry KFF =1. This means the
full FF correction, (FC55 SPn–FC55 SPn−1), is applied on every control execution pass. Much like fil￾tering prediction error, the full effect of the FF correction is often attenuated – by choosing KFF <1.
Note 2: Again, if the PID FF algorithm is not supported by the DCS, additional engineering effort
is needed to use other, standard DCS functionality/features to duplicate its functionality.
9.6.3 Feed Surge Drums
The roles of both the Visbreaker reactor quench hold-up drum (D-108) in Figure 9.12 and the FCCU
feed drum (D-601) in Figure 9.14 are to provide surge capacity for Visbreaker quench flow and Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License9.6 Averaging and Tight Level Controller Tuning 289
FCCU reactor feed respectively. Therefore, both drums would almost certainly be sized to provide
enough hold-up to allow levels LC35 and LC601 to be tuned for averaging level control.
In both cases, the manipulated flow rate is an upstream flow, coming directly from tankage.
Therefore, sudden and/or large changes in the manipulated flow rate have no effect on downstream
operations (other than the surge drum level). Therefore, tight level tuning is feasible, but the surge
capacity in both drums could certainly be used to maintain the level loosely around level setpoint
by implementing averaging level control.
Note that in both cases, flow rates leaving the drums (quench flow FC39 and FCCU feed rate
FC601) are set by operators and could include setpoint ramping to help prevent potential down￾stream Visbreaker fractionator and FCC unit upsets, and help keep quench and feed drum level
controller upsets at a minimum. If quench flow was manipulated to control Visbreaker quench
drum level or FCCU feed rate was manipulated to control FCCU feed drum level, the level con￾troller would certainly be tuned for averaging level control.
9.6.4 Fractionator Sidestream Stripper Bottoms Level Control
A crude fractionator (CDU) separates crude oil feedstocks into an overhead naphtha product,
and kerosene, diesel, light gas oil and heavy gas oil sidestream products. The sidestream products
contain lower boiling components which are removed by steam stripping in sidestream strippers
and returned to the CDU as vapor (see Figure 9.19). Sidestream steam strippers such as T-43 in
Figure 9.19 normally have small bottoms hold-up. To prevent a loss in level and possible pump
cavitation, steam stripper bottoms level controllers are almost always tuned for tight level control.
Erratic and/or large changes in CDU (T-35) draw-off flow caused by LC65’s tight tuning can have
undesirable effects on T-35 loadings, and thus on the tower’s fractionation. However, there is not
much that can be done if the stripper bottoms lacks surge capacity.
Main fractionators are routinely used to separate final products from reactor effluents for reac￾tion systems such as Visbreakers, FCCUs, Hydrocrackers, Delayed Cokers and Flexicokers. Main
fractionators, like CDUs, frequently include side stream steam strippers such as T-43 in Figure 9.19,
and have the same function as T-43 in Figure 9.19, i.e., to strip out light components in a sidestream
and return them to the main fractionator. Main fractionator side stream steam strippers also have
Figure 9.19 Primary Fractionator
Sidestream Steam Stripper Bottoms Level
Control
T
4
3
T
3
5
Sidestream
steam stripper
LC Steam
65
FC
60
Side stream
product
FC
69
P-37
Primary fractionator:
CDU or VPS
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License290 9 Level Control
Steam
Feed
T
5
5
Primary fractionator:
CDU or VPS
Bottoms
Product
FI
92
LC
95
Lowest
side stream
product
Figure 9.20 Primary Fractionator Bottoms Level Control
small bottoms hold-up, and their steam stripper bottoms level controllers must also be tuned for
tight level control to prevent loss in level and possible pump cavitation.
Note that the fractionator sidestream steam stripper bottoms level control application discussed
in Section 6.2.1 illustrates that a control strategy implemented to control a small hold-up’s volume
must sometimes override a competing control objective (meeting a sidestream quality specifica￾tion), in order to avoid a serious operating problem (pump cavitation).
9.6.5 Fractionator Bottoms Level Control
The CDU’s bottoms product contains the highest boiling components in the crude oil feed; its flow
is almost always manipulated to control CDU bottoms level. CDU bottoms product (atmospheric
residue) is the vacuum pipestill’s (VPS) main feed stream, and thus the VPS tower bottoms prod￾uct (vacuum residue) contains the heaviest portion of the CDU residue. Steam stripping below the
primary fractionator’s feed tray removes lower boiling hydrocarbons from the unvaporized portion
of the feed, upgrading small amounts of residue to the lowest sidestream product (see Figure 9.20).
To minimize coking in the CDU and VPS bottoms section, unit designs keep CDU and VPS tower
bottoms surge capacity very small, and CDU and VPS tower bottoms level control (e.g., LC95) nor￾mally must be tuned for tight level control.
Likewise, reaction effluent main fractionator bottoms products contain the heaviest components
of the reactor effluent. Because of the chemical reactions that have occurred, the bottoms contain
components with very high molecular weight, at very high temperatures. Minimizing coke forma￾tion in the bottoms section under these conditions is a major concern. Therefore, reaction system
main fractionator bottoms surge capacity is always kept at a minimum, and their bottoms level
controllers are always tuned for tight level control.
References
1 Friedman, Y.Z. (1994). Tuning averaging level controllers. Hydrocarbon Processing 73: 101–104.
2 King, M. (2010). Process Control: A Practical Approach, 97–110. Chichester: Wiley.
3 Smith, C.A. and Corripio, A.B. (2006). Principles and Practices of Automatic Process Control, 256.
Wiley.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License291
10
Heat Input/Heat Removal Controls
CHAPTER CONTENTS
10.1 Introduction
10.1.1 Heat Input/Heat Removal in a Light-ends Tower
10.1.2 Heat Utilization in Fixed Bed Catalytic Reaction System
10.1.3 Crude Preheat, Heat Integration, and Crude Distillation Unit (CDU) Heat Utilization
10.2 Feed Preheat Controls
10.2.1 Reactor Feed Surge Drum Inlet Temperature Control
10.2.2 Chloride Treater Inlet Temperature Control
10.2.3 Reactor Preheat Exchanger Duty Control
10.2.4 Product Stripper Inlet Temperature Control
10.3 Control Strategies in Heat Integrated Units
10.3.1 Crude Distillation Unit (CDU) Sidestream Stripper Overhead Temperature Control
10.3.2 Deethanizer Tray Temperature (Bottoms Quality) Control
10.3.3 Cat Naphtha Splitter Reboiler Duty Control
10.4 Fired Heater Firing Controls
10.4.1 Fired Heater Basics
10.4.2 Process Variable and Calculated Variable Summary
10.4.3 Basic COT Regulatory Control
10.4.4 Ratio Feed Rate Feedforward Control
10.4.5 Feedforward Control for Both Feed Rate and CIT
10.4.6 BTU Control: Feedforward Corrections for Fuel Gas Heating Value Upsets
10.4.7 BTU Control with Combined Feed Rate and CIT Feedforward Control
10.4.8 Dual Fuel Fired Heaters: Importance of BTU Control
Reference
Petroleum refineries and petrochemical plants use significant amounts of energy, in the form of
process heat, in almost all process areas and operating units. This chapter presents control strategies
that manage heat input and heat removal to meet a variety of operating objectives across many
process units. Included are examples of feed preheat control applications and control strategies in
heat integrated units. Since much of the process heat input is produced in fired heaters, we include
a discussion of fired heater firing controls.
10.1 Introduction
We begin with three examples of the role heat input/heat removal plays in typical process
operations. We then present and discuss control strategies for a wide range of process configura￾tions and/or operating objectives that (i) provide unit feed preheat (Section 10.2) and/or (ii) must
Practical Process Control Design with Industrial Applications, First Edition. Alan M. Kugelman.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License292 10 Heat Input/Heat Removal Controls
manage the intricacies of heat integrated process units (Section 10.3). We conclude by surveying
fired heater firing controls, focusing on common methods used to control coil outlet temperature,
COT (Section 10.4).
Control strategies that explicitly exploit heat integration to lower energy costs are presented in
Chapter 11 (Energy Conservation Controls). Included is a discussion of fired heater combustion
and firing controls, and their (beneficial) interactions (Section 11.2).
10.1.1 Heat Input/Heat Removal in a Light-ends Tower
For the light-ends tower shown in Figure 10.1, preheat exchanger E-100 heat duty sets the tower
feed’s inlet temperature, and reboiler E-101 heat duty sets the bottoms product quality. Heat is
removed in overhead condenser E-102 to generate liquid distillate product and tower reflux flows.
Changes in reflux flow affect overhead temperature, but via pressure control, condenser E-102
duty is manipulated to maintain heat balance and provide the reflux flow required for good tower
fractionation. The cooling medium in the condenser is normally air or cooling water; thus, this
heat is lost and not recoverable.
The preheat exchanger and reboiler hot side fluids are normally process streams whose
temperature is high enough to provide the driving force for heat transfer to the exchanger’s cold
side. This is an example of heat integration, e.g., when heat otherwise lost to air or cooling water is
recovered and transferred from a hot process stream to a cold process stream. Note that reboilers
sometimes use steam as the heating medium. In addition, when reboiler duty is especially large
(e.g., aromatics plant C8/C9 Splitter, in Chapter 12, Section 12.9.3), a fired heater provides the
CW
Fractionation
E-102
E-101
E-100 
Quality
TI
LC
LC
FI
PC
TI
TI
TI
TI
FC
FC
TC
FC
FC
AI
Figure 10.1 Light-ends Tower Heat Utilization – Heat Input and Heat Removal
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.1 Introduction 293
PC
TI
TC
Reactor feed
surge drum
Fuel
gas
FC
LC
Fixed bed
catalytic reactor
To product
fractionator
Preheat
fired heater
Reactor feed/effluent
exchanger
Reactor effluent/
fractionator feed
exchanger
To hot
separator
TI
F-300
E-301
E-300
TI
Figure 10.2 Heat Utilization in Fixed Bed Catalytic Reaction System
required reboiler duty. A comprehensive discussion of tower control strategies is presented in
Chapter 12 (Tower Product Quality Controls).
10.1.2 Heat Utilization in Fixed Bed Catalytic Reaction System
Figure 10.2 shows how heat is utilized in a packed bed catalytic reactor system supporting
exothermic reactions that yield the desired products. Although heat is generated and reactor bed
temperatures rise as the reactions proceed along the bed, the reactor feed must be preheated to a
high enough temperature to initiate the desired reactions. Therefore, the reactor inlet temperature
must be controlled at a set point that maintains the desired conversion.
As shown in Figure 10.2, the feed preheat is provided by fired heater F-300 and reactor
feed/effluent exchanger E-300. A normal operating objective is to maximize E-300 heat duty (close
the bypass until there is minimum bypass flow), and then meet the reactor inlet temperature
target by manipulating fired heater F-300 duty. Thus, to the extent possible, the heat generated
by the exothermic reactions is recovered (in E-300) before incurring fuel costs (in F-300). Because
the reactions are exothermic and generate recoverable heat, this fired heater’s duty, geometric
dimensions, and investment costs are not large. This example illustrates an important principle:
heat integration almost always presents opportunities to save energy and reduce investment costs.
We will explore many such opportunities to save energy in Chapter 11 (Energy Conservation
Controls).
10.1.3 Crude Preheat, Heat Integration, and Crude Distillation Unit (CDU) Heat
Utilization
Figure 10.3 shows how heat integrations are used in a simplified CDU crude feed preheat configura￾tion. The focus here is the fired heater; other aspects of CDU operations, e.g., product quality control
and fractionation management are addressed in Chapter 13 (Fractionator Product Quality Control). Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License294 10 Heat Input/Heat Removal Controls
Virgin naphtha
to naphtha
hydrofiner
Gas to LPG
recovery
Steam
Steam
Steam
Atm residue
to VPS tower
Kerosene
to kero
hydrofiner
Distillate to
distillate
hydrofiner
Crude
distillation
unit (CDU)
CDU top
pumparound 
Steam
stripper
Steam
stripper
CDU Btm
pumparound
CDU preheat
heater
Crude charge
Crude preheat
exchangers
Crude
CW
∞
∞
W
W
W
W
Figure 10.3 CDU Crude Feed Preheat, Heat Integration and Tower Heat Utilization
As shown, crude oil is first pumped through a series of heat exchangers, and then the fired heater,
to raise the crude temperature high enough to vaporize all tower products that are removed above
the feed tray (distillate product – virgin naphtha, and all sidestreams). Unlike the fired heater in
Figure 10.2 (exothermic reactor preheat service), a fired heater’s duty in CDU crude preheat service
is substantial, and its investment costs significant. This is true despite the substantial heat recovered
upstream by the heat integrations. The fired heater’s duty sets the heater’s outlet temperature (the
COT) and the crude feed’s CDU inlet temperature. The COT impacts sidestream yields, especially
the bottom sidestream’s yield, and the overhead condenser and pumparound duties. Tight control
of COT, for most fired heater applications, is an important control objective, but especially for high
duty services such as CDU preheat. The most common control strategies used to control COT are
presented in Section 10.4.
Crude preheat is highly heat integrated. For the simple case shown in Figure 10.3, CDU overhead,
a sidestream draw-off, top and bottom pumparounds, and atmospheric residue (CDU bottoms) all
exchange heat with the crude feed. In more realistic configurations, crude can also exchange heat
with streams generated in downstream units and various product rundown streams. This means
an upset in one of these downstream units can affect the preheat train, and hence the fired heater’s
coil inlet temperature (CIT). This makes control of a CDU’s preheat heater COT difficult. The fired
heater firing control strategies presented in Section 10.4 address potential upsets for all fired heater
services.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.2 Feed Preheat Controls 295
The liquid sidestream draw-offs and the liquid flow below the feed tray contain some low-boiling
components which, as shown in Figure 10.3, are removed by steam stripping in sidestream steam
strippers and via (bottoms) open steam, respectively. There are many other processing areas in
which steam is used to strip a gaseous component (light hydrocarbon, H2S, SO2, and so on) from a
liquid. Also, remember, reboilers sometimes use steam as the heating medium. Most steam needed
refinery-wide is produced in fired heaters by the combustion of fuel gas and/or fuel oil. Several
control strategies are presented in Chapter 11 (Energy Conservation Controls) that help reduce
steam utilization and hence fuel costs.
10.2 Feed Preheat Controls
In this section, control strategies are presented that focus on a variety of reaction system and tower
preheat control objectives. Each process configuration has specific operating objectives which are
the basis for control objective definition and control strategy designs.
10.2.1 Reactor Feed Surge Drum Inlet Temperature Control
Process designers normally provide a feed surge drum to smooth the effects of feed rate and feed
composition changes on reactor systems. In Figure 10.4, reactor R-201 feed rate (FI237) is set by feed
surge drum (D-235) level controller LC235. Note that LC235 is tuned for averaging level control to
exploit the available surge capacity and smooth reactor R-201 feed rate changes. Reactor feed from
D-235 is routed to the downstream preheat heater. After exiting R-201, the reactor effluent’s light
components (gas) are separated, and the remaining liquid is fed to the product stripper where the
final products are separated. Product stripper bottoms (hot side) and reactor feed (cold side) are
heat integrated in feed/stripper bottoms exchangers E-230 A/B.
To reactor
R-201
Product stripper
bottoms to
tankage
Product
stripper
bottoms E-230 A/B P-204 A/B
LC
235
TI
267
Off gas to
treat gas header
Reactor
feed
Feed
surge
drum
TV267 FI
237
TI
269
TI
268
D
2
3
5
Figure 10.4 Reactor Feed Surge Drum/Product Rundown Configuration
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License296 10 Heat Input/Heat Removal Controls
The purpose of D-235 inlet temperature control is to ensure that D-235 temperature does
not exceed its maximum allowable value. E-230 A/B duty can be adjusted to control D-235 inlet
temperature (TI267) by manipulating bypass valve TV267. By maintaining D-235 inlet temperature
at an appropriate target, the operating objective (avoid high surge drum temperature) is achieved.
However, there is an important second operating objective, i.e., to ensure there is enough cooling
in E-230 A/B to meet the net positive suction head (NPSH) requirement of rundown pumps P-204
A/B. Thus, a maximum allowable product stripper bottoms temperature (TI268 PV) at P-204 A/B
suction must also be honored.
E-230 A/B duty affects both D-235 inlet and P-204 A/B suction temperatures. However, an
increase in duty moves drum inlet temperature toward its constraint limit (max) but drives the
pump suction inlet temperature away from its constraint limit (max). Thus, conventional single
variable constraint control (Chapter 7, Section 7.5) – multiple constraint variables and a single
manipulated variable – cannot be used for this application.
Notice that a change in bypass valve position (TV267) will affect D-235 inlet temperature TI267
PV almost immediately (i.e., mixing dynamics are fast), while the response of P-204 A/B suction
temperature TI268 PV will be slowed by the dynamic lag inherent in heat exchanger E-230 A/B.
This observation impacts the control strategy’s design to meet the operating objectives.
In normal operations, the control strategy in Figure 10.5 achieves both operating objectives.
As discussed above, D-235 inlet temperature responds faster to changes in TV267 than P-204 A/B
suction temperature; thus, in Figure 10.5, TC267 is the cascade’s secondary and TC268 is the cas￾cade’s primary. This allows the faster loop (TC267) to respond to an upset before the slower loop
(TC268) is affected. The P-204 A/B suction temperature controller TC268 meets its temperature
target (TC268 SP, probably set slightly below the max constraint limit) while maintaining D-235
inlet temperature (TC267 SP) at or below its maximum allowable value. The maximum D-235 inlet
temperature constraint is honored by an engineer specified, operator entered setpoint high limit for
TC267 SP. Standard DCS features will clamp TC267 SP at this high limit, TC267’s wind-up status
will be set to “High”, and TC267 will broadcast its wind-up status to TC268, whose output will be
constrained to prevent any further increases in TC267 SP. When TC267 is not wound-up high, the
D-235 inlet temperature TC267 PV is at the setpoint TC268 has calculated, below its maximum
allowable value (TC267’s setpoint high limit, SPHL), while TC268 maintains P-204 A/B suction
Validation
Reactor feed
to D-235
Reactor feed
to E-230 A/B
E-230 A/B
bypass flow
SP
P-204 A/B
suction
temperature
SP
TI
267 TC267 D-235 inlet
temperature
TV267
TC268
Tl
268
Max P-204 A/B
suction temperature
TIV268
Figure 10.5 P-204 A/B Suction Temperature Control
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.2 Feed Preheat Controls 297
temperature at or below its maximum target (depending upon the TC268 SP value entered by
operators).
When TC267 is wound-up high, TC268 can still decrease TC267 SP. For example, if TC268 PV
is below setpoint, its control output must decrease preheat to return TC268 PV to setpoint. To
decrease preheat, TC268 must decrease TC267 SP – TC267 will then decrease preheat to decrease its
PV; the decrease in preheat then correctly increases TC268 PV toward its setpoint. However, sup￾pose an upset causes an increase in stripper bottoms temperature (TI269) and drives TC268 PV
above its set point. For TC268 to return its PV to setpoint, it must increase preheat by increasing
TC267 SP. But with TC267 wound-up high, TC267 SP is clamped (high), and standard DCS fea￾tures will not allow a TC267 SP increase – P-204 A/B suction temperature TC268 PV will remain
above TC268 SP in violation of its high constraint limit. Therefore, in effect, this strategy gives
the max TC267 constraint a higher priority than the max TC268 constraint. However, with TI267
responding faster than TI268 to TV267 changes, the loop dynamics do not allow the cascade order to
be reversed.
In summary, when operations are normal – both constraints honored, TC268 PV will be at its set￾point (at or below its actual max constraint limit depending upon the setpoint entered by operators),
while TC267 PV will be controlled at a set point lower than its max constraint (TC267 SP<TC267
SPHL). However, if TC268 PV is violating its maximum constraint, and TC267 is wound-up high,
TC267 SP cannot be increased to relieve the constraint, and thus TC268 PV will continue to violate
its max limit.
We now look at the (ideal) output characteristics of three-way valve TV267 – it changes flows in
E-230 A/B’s bypass and feed branchessimultaneously but in opposite directions. For every TC267 OP
change that increases (or decreases) the feed branch flow, the bypass flow will decrease (increase)
by about the same amount (for an ideal, linear valve characteristic). A three-way valve in exchanger
bypass service typically fails with the feed branch closed and the bypass branch open (max bypass
flow). This (ideal) TC267 OP characteristic is illustrated in Figure 10.6 – at TC267 OP = 0%, the
bypass branch is fully open, and the feed branch fully closed.
If TC267 PV is increasing and/or is above its set point, TC267 must decrease E-230 A/B duty to
lower TC267 PV. Remember that controller outputs such as TC267 OP are generated as % open.
Referring to the ideal TC267 OP characteristic presented in Figure 10.6, to decrease TC267 PV,
TC267 OP must decrease to open the bypass branch and close the feed branch – this decreases E-230
A/B duty. So, if TC267 PV is increasing and/or is above its set point, TC267 OP must decrease – thus,
TC267 control direction = Reverse.
Figure 10.6 TC267 OP Characteristic, TV267 Fails
with Feed Branch Closed, Bypass Branch Open
All flow bypassed No bypass flow
0%
100%
0%
TV267
bypass
% open
E-230 A/B
bypass
branch
E-230 A/B
feed
branch
TV267
feed
% open
0%
100%
TC267 OP 100%
TC267 PV increases
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License298 10 Heat Input/Heat Removal Controls
TV267
bypass
% open
TV267
feed
% open
All flow bypassed
0%
100%
0% TC267 OP
E-210 A/B
bypass
branch
E-210 A/B
feed
branch
0%
100%
100%
No flow bypassed
TC267 PV increases
Figure 10.7 TC267 OP Characteristic, TV267 Fails
with Feed Branch Open, Bypass Branch Closed
Via an analog output (AO) block, the DCS handles TV267’s failure mode and subsequent output
signal conditioning external to the PID output calculations. TC267 OP is sent to an analog output
block, TV267, whose output direction configuration manages the valve’s failure mode. Therefore,
TC267 can have control direction = Reverse and still achieve its control objective even if TV267
fails with the feed branch open and the bypass branch closed, the opposite of the TC267 OP char￾acteristic appearing in Figure 10.6 and discussed above. This alternative TC267 OP characteristic
is presented in Figure 10.7.
The AO block configuration for the ideal TC267 OP characteristic in Figure 10.6 (fail with feed
branch closed and bypass branch open) is shown below in the top half of Figure 10.8. TV267’s
output direction configuration is Direct. A TC267 OP change of 30% → 40% is sent to the field as a
TV267 OP change of 30% → 40%. Then, referring to the bottom half of Figure 10.8, the increase in
TC267 OP from 30% → 40% opens the feed branch from 30% → 40% and closes the bypass branch
from 70% → 60%.
TV267
bypass
% open
TC267
PID Algo
OP (%)
I/P
TV267 input
connection
TV267 output
connection
TV267
output direction
configuration:
direct
Reverse TV267
Direct
Output
direction
100 - %OP
TV267
TC267 OP:
30% → 40%
OP to field:
30% → 40%
All flow bypassed No bypass flow
OP to field
30% 40%
100%
0%
0%
TV267
feed
% open
100%
70%
60%
40%
30%
Figure 10.8 AO Block Configuration for TC267 OP Characteristic in Figure 10.6
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.2 Feed Preheat Controls 299
TV267
bypass
% open
OP to field
60%
100%
100%
0%
0%
TV267
feed
% open
70%
No flow bypassed All flow bypassed
40%
30%
70%
60%
TC267
PID Algo
OP (%)
I/P
TV267 input
connection
TV267 output
connection
TV267
output direction
configuration:
reverse
Reverse TV267
Direct
Output
direction
100 - %OP
TV267
TC267 OP:
30% → 40%
OP to field:
70% → 60%
Figure 10.9 AO Block Configuration for TC267 OP Characteristic in Figure 10.7
For the ideal TC267 OP characteristic presented in Figure 10.7 (fail with feed branch open and
bypass branch closed), at TC267 OP = 0%, the feed branch is fully open, and the bypass branch is
fully closed. TV267’s AO block configuration for this TC267 OP characteristic appears below in the
top half of Figure 10.9. TV267 OP’s output direction configuration is Reverse. A TC267 OP change of
30% → 40% is sent to the field as a TV267 OP change of 70% → 60%. Then, as shown in the bottom
half of Figure 10.9, the 30% → 40% increase in TC267 OP opens the feed branch from 30% → 40%
and closes the bypass branch from 70% → 60%.
The control action taken in the field for the 30% → 40% TC267 OP change is the same for the valve
failure modes in Figures 10.6 and 10.7: open the feed branch from 30% → 40% and close the bypass
branch from 70% → 60%. The only difference is the signal sent to the valve actuator in the field, e.g.,
for the “fail with the feed branch closed and the bypass branch open”, 30% → 40%, while for the
“fail with the feed branch open and bypass branch closed”, 70% → 60%.
Design Features and Notes
1. The control strategy is a simple cascade – cascade initialization and wind-up are both handled
by standard DCS features.
2. TI267 PV is a high level (4–20 mA) A/I and validation is not necessary. TI268 PV is an externally
multiplexed input (e.g., DTI) and must be validated before its use as TC268’s PV input.
3. For the ideal TC267 OP characteristic in Figure 10.6 (TV267 fails with the feed branch closed,
bypass branch open), if TC267 is increasing and/or is above its set point, TC267 OP must
decrease to increase E-230 A/B bypass flow and decrease E-230 A/B feed flow. Thus, TC267
control direction = Reverse.
4. The DCS manages a valve’s failure mode via an AO block, external to TC267 (Figures 10.8 and
10.9). Thus, with TC267 control direction = Reverse, it can achieve its control objective even if
TV267 fails with the feed branch open and bypass branch closed (Figure 10.7).
5. If TC268 is increasing and/or is above set point, it must increase E-230 A/B duty – TC268 must
increase TC267 SP. Thus, TC268 control direction = Direct.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License300 10 Heat Input/Heat Removal Controls
6. TC268 SP will rarely be changed – TC268 is tuned for best load response, proportional on PV
with SP Init = No. TC267 is a cascade secondary – it is tuned for best SP response, proportional
on Error with SP Init =Yes.
7. TI268 PV is TC268’s PV input. When TI268 PV is declared invalid (via logic in TIV268), it must be
set “Bad” to stop all TC268 control action (wind-up status = High/Low, e.g., Output Indiposable).
TC267 control continues at the last SP calculated by TC268.
10.2.2 Chloride Treater Inlet Temperature Control
We now present a control strategy which is implemented as a conventional constraint control
application. Figure 10.10 shows a chloride treater in a benzene product rundown stream. Because
motor gasolines (MOGAS) have a very low minimum benzene specification, benzene is separated
from reformates (catalytic reformer liquid product, an important MOGAS blend component) and
used (or sold) as feedstock to produce chemicals such as styrene and nylon. In this aromatics plant,
the benzene product is routed to a chloride treater (T-621), where organic chlorides are removed
before the benzene is cooled and sent to tankage.
Chloride removal in T-621 increases as inlet temperature (TI618 PV) increases in response to
increases in E-620 duty. However, eventually, the value of incremental chloride removal becomes
about equal to and then less than the incremental hot oil furnace fuel cost. Thus, the primary
operating objective is to maintain TI618 PV at an offline calculated max target that ensures ade￾quate chloride removal without incurring unnecessary fuel costs. In addition, the benzene’s run￾down temperature TI616 PV must remain below a maximum value – it is cooled in feed/effluent
exchanger E-621, and via water in E-624, before being sent to tankage. Thus, a second operating
objective is to ensure benzene’s rundown temperature remains below its maximum value.
E-620 duty affects both TI618 and TI616. An increase in E-620 duty increases both T-621 inlet
temperature and benzene rundown temperature and moves both toward their (max) constraint
limits. Thus, the conventional constraint control strategy shown in Figure 10.11 meets the two oper￾ating objectives described above. Each constraint variable (TI618 and TI616) has its own dedicated
PID controller (TC618 and TC616 respectively). Each PID tries to adjust the single manipulated
T
6
2
1
Hot
FI oil
636
TI
618
CW
Chloride
treater
Benzene
product
Benzene product to tankage
E-620
E-621
E-624
FV636
TI
616
Figure 10.10 Chloride Treater Feed Preheat Configuration
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.2 Feed Preheat Controls 301
TI
618 TC618
SP
Desired T-621
inlet temperature
TC616 TIV616
Validation
Max benzene
rundown temperature
SP
FC
636
LSS 
SP
Hot oil
to E-620
FI
636
FV636
TI
616
Figure 10.11 Chloride Treater Inlet Temperature Control
variable (E-621 hot oil flow via FV636) to drive its PV value to its constraint limit (TC618 SP and
TC616 SP respectively).
Note: An increase in E-620 duty (via an increase in hot oil flow – the MV) increases both TI618
PV and TI616 PV, and thus drives both constraint variablestoward violation. Consequently, the low
signal selector included in Figure 10.11’s constraint control strategy follows directly from the rules
developed in Chapter 7, Section 7.4.4.
Design Notes and Features
Note: Many of the items included below are common to most conventional constraint control appli￾cations, and therefore further discussion of these issues can be found in Chapter 7, Section 7.8.
1. The control strategy in Figure 10.11 is a complex cascade and custom logic must be provided
to handle cascade initialization and wind-up above the LSS.
2. Each PID is tuned for its own response dynamics to changes in FC636 SP. Because their SPs are
almost never changed, both TC618 and TC616 are tuned for best load response, proportional on
PV with SP Init = No.
3. For both TC616 and TC618, when its PV is increasing and/or above its set point, controller
output must decrease hot oil flow to decrease E-620 duty. Therefore, both controllers are con￾figured with control direction = Reverse.
4. TI618 is a high level (4–20 mA) A/I while TI616 is not – thus, validation is necessary for TI616,
but not for TI618.
5. TI616 is TC616’s PV input and thus must be set “Bad” when TI616 is declared invalid (via logic
in TIV616). All TC616 control action stops, and its output is frozen.
6. A console display indication to inform operators that TI616 PV has failed a validity check is
normally included in the operator interface.
7. When TI616 returns valid, TC618 OP and TC616 OP must be initialized and set equal to the
current value of FC636 SP by user provided custom logic.
8. Logic must be provided to reset the non-active CV controller’s output to the active constraint
variable’s PID output to prevent the wind-up of the non-active CV controller’s output.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License302 10 Heat Input/Heat Removal Controls
9. The operator interface includes an indication of which temperature is the active constraint.
10. Because constraint variable noise can confuse the LSS and cause erratic switches, a constraint
variable “switch history” display is useful to detect noise problems.
11. Custom logic must be provided to manage the control and wind-up statuses of TC618 when
TI616 PV is declared invalid and all TC616 control actions stop. The major issue is whether
TC618 control should continue, or should the entire cascade be decommissioned – e.g., block
any potential TC618 control actions.
• If TC616 is the active constraint, and TC618 continues on control, hot oil flow set point is
frozen at its current value unless TC618 becomes the active constraint – if TC618 OP becomes
less than the frozen TC616 OP.
• If TC618 is the active constraint, and continues on control, (i) TC618 control action may
force the unavailable and unknown TC616 PV above its maximum value and (ii) an active
constraint switch to TC616 can occur if TC618 OP becomes greater than the frozen TC616
OP. Hot oil flow/E-620 duty remain fixed, and there is no TC618 or TC616 control until TI616
PV becomes available or TC618 becomes the active constraint once again.
These outcomes strongly suggest it is best to decommission the entire control strategy, although
this must be discussed with operations personnel before final design.
10.2.3 Reactor Preheat Exchanger Duty Control
Cat naphtha is the name given to a naphtha boiling range sidestream product from the Fluid
Catalytic Cracking Unit’s (FCCU) main fractionator. Light, intermediate, and heavy cat naphtha
(LCN, ICN, and HCN respectively) are all important MOGAS blend stocks. We now consider a
hydrofiner reactor system that is fed cat naphtha and catalytically removes sulfur to help meet a
MOGAS blend stock minimum sulfur requirement.
The reactor configuration in Figure 10.12 is fed high sulfur cat naphtha directly from the
FCCU fractionation section. Sulfur is removed via solid catalyzed reactions in the presence of a
hydrogen-rich treat gas that provides a large excess of hydrogen to promote the desired reactions.
Treat gas is mixed with the hydrocarbon feed upstream of both the guard (R-305A) and main
(R-305B) reactors. Guard reactor R-305A removes some sulfur, but its main objective is to remove
R-305B catalyst poisons and preheat exchanger fouling precursors. Almost all sulfur removal from
the cat naphtha feed occurs in main reactor R-305B. Although the major reactions are exothermic,
the reactor’s feed inlet temperature must be raised to initiate the exothermic reactions; its operating
target (TC389 SP) is set to meet a sulfur removal (conversion) target. The control strategy discussed
focuses on main reactor R-305B inlet temperature control (TC389), and the feed preheat provided
by feed/effluent (E-349) and feed/hot oil (E-342) exchangers.
In Figure 10.12, R-305B inlet temperature (TC389) is controlled by manipulating hot oil bypass
flow around feed/hot oil exchanger E-342 via three-way bypass valve TV389. Temperature control
is effective provided bypass valve TV389 can be maintained in controlling range, e.g., TV389 feed
branch % open below its maximum opening, and bypass branch % open above its minimum open￾ing. Here are the operational changes that have the largest impact on TC389 and hence on TV389:
● R-305B’s catalyst deactivates slowly with time. Hence, reactor inlet temperature is increased
from lower temperatures at start-of-run (catalyst activity high) to higher temperatures toward
the end-of-run (catalyst activity low).
● Reactor feed rates are adjusted over the catalyst run – also to compensate for reduced catalyst
activity.
● Hot oil circuit temperature and flow upsets effect E-342 duty, hence reactor inlet temperature.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.2 Feed Preheat Controls 303
R
3
0
5
B
R
3
0
5
A
TC
389
FI
612
FC
632
E-345
E-349
E-342
TV314
TV389
Hot oil
Cat naphtha
from FCCU
Main
reactor
Guard
reactor
Feed
preheat
Treat gas
To separator drum
and product stripper
TI
680
TI
689
TI
690
Figure 10.12 Hydrofiner Reactor Preheat Exchanger Configuration
The primary operating objective is to effectively control main reactor R-305B inlet temper￾ature over the catalyst run by ensuring TV389 (and hence E-342 duty) remains in controlling
range. Feed/effluent exchanger E-349 bypass valve (TV314) establishes the duty of E-349, which
determines R-305B feed temperature at E-342 inlet (TI680 PV). It is E-349’s duty and TI680 PV
that ultimately determine the hot oil bypass flow, e.g., TV389’s valve position, needed to satisfy
R-305B’s inlet temperature target (TC389 SP). For example, as E-349 duty increases (E-349 bypass
flow through TV314 decreases), TI680 increases, TC389 PV tends to increase, and E-342 hot oil
bypass flow can be increased to satisfy TC389 SP. This is the mechanism to shift heat duty between
E-342 and E-349, and hence to maintain TV389 in controlling range.
As shown in Figure 10.13, E-349 duty is manipulated (via bypass valve TV314) to maintain E-342
duty (QC314 PV) at its target (QC314 SP). QC314 SP is reset by RC314, the E-342 duty/R-305B
feed ratio controller . RC314 provides feedforward (FF) adjustments for feed rate (FC632) changes.
The feed rate is dynamically compensated (in FCG632) before its use in the cascade. RC314 SP
values are provided by the process technical service (PTS) group, operator entered, and are known
to normally keep TV389 (e.g., E-342 duty) in controlling range.
QC314 PV is calculated using E-342 hot oil flow (FI612), and inlet (TI689) and outlet (TI690)
temperatures – see Equation (10.1). Because both temperatures are externally multiplexed inputs
(DTI points), each is validated before its use in the calculation. In Equation (10.1), TIVnnn PV is Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License304 10 Heat Input/Heat Removal Controls
TV314
RC314
QC314
FC
632
FI
612
TIV689
TIV690
FCG632
SP
R-305B effluent
flow to E-349
E-349
bypass
flow 
Effluent
from R-305B
to E-349
SP
Desired
E-342 duty/feed ratio
E-342
duty/feed
E-342
duty
Validation
Dynamic
compensation
E-342 hot
oil flow
TI
690
TI
689
R-305 A/B
feed rate
E-342 hot
oil inlet
E-342 hot
oil outlet
Figure 10.13 Hydrofiner Reactor Preheat Exchanger Duty Control
the validated value of TInnn, and CP is a typical value of hot oil heat capacity provided by the PTS
group. Note: For implementation, a scale factor (Scale) is included to ensure QC314 PV has the
desired engineering units.
QC314 PV = Scale ∗ FI612 PV ∗ CP ∗ (TIV689 PV − TIV690 PV) (10.1)
QC314 adjusts bypass valve TV314 directly, to change E-349 duty, to meet the E-342 duty controller’s
setpoint. Because the relationship between QC314 PV and bypass valve position TV314 is nonlinear,
QC314 must be configured as a PID controller.
Here is how the control cascade works to meet the control objective – maintain R-305B inlet
temperature at target over the catalyst run by ensuring TV389 (E-342 duty) remains in controlling
range. Assume TC389 SP is increased – a normal adjustment made over the catalyst run as the
catalyst slowly deactivates.
● In response, TC389’s output to three-way valve TV389 decreases E-342 hot oil bypass flow and
increases E-342 hot oil feed flow.
● QC314 PV, E-342’s duty, increases and with FI612 PV and TIV689 PV constant, hot oil tempera￾ture at E-342 outlet (TI690 PV) decreases (see Equation (10.1)).
● With QC314 SP constant (feed rate FC632 and RC314 set points have not changed), and QC314
PV higher, QC314’s output to three-way valve TV314 reduces E-349 reactor effluent bypass flow
and increases reactor effluent flow to E-349. This increases both E-349 duty and E-349 cold side
outlet temperature TI680 PV as well as E-342’s cold side inlet temperature.
● TI680 PV increasing tends to drive TC389 PV up, and in response, TC389 can cut back on its
earlier E-342 hot oil bypass flow decreases and E-342 hot oil feed flow increases.
● Hot oil temperature at E-342 outlet (TI690) will now tend to increase, QC314 PV will return
to QC314 SP, and the hot oil sensible heat contribution required to meet the new TC389 SP is
reduced.
The net result is that an increase in E-349 duty increases E-342 cold side inlet temperature (TI680
PV), and, as a result, less process heat must be provided by hot oil in E-342. Thus, by increasing Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.2 Feed Preheat Controls 305
E-349 duty, a low bypass flow limitation in TV389 can be avoided (or mitigated) as reactor inlet
temperatures are increased over the catalyst run.
Desired E-342 duty/feed ratios (RC314 SP) are established offline by the PTS group, and manually
entered by operators. Over the catalyst run length, an occasional daily operations directive will
specify a new RC314 target when R-305B’s inlet temperature target must be increased. In addition,
current process conditions may require operators to make RC314 SP adjustments. For example, at
the start of run, RC314 SP may need to be increased (to decrease E-349 duty and ultimately reduce
E-342 hot oil bypass flow) if E-342 bypass flow is too large. Likewise, as the catalyst run proceeds,
RC314 SP may need to be decreased (to increase E-349 duty and ultimately increase E-342 hot oil
bypass flow) if E-342 bypass flow is too small.
Design Notes and Features
1. This control strategy is a simple cascade – cascade initialization and wind-up are both handled
by standard DCS features.
2. E-342 duty controller QC314 is the ultimate secondary (outputs directly to bypass valve TV314)
and because the relationship between QC314 PV and bypass valve position TV314 is nonlinear,
QC314 must be configured as a PID controller.
3. Three-way valve TV389 is manipulated by TC389 to vary E-342 duty to maintain TC389 PV at
set point. A three-way valve in exchanger bypass service typically fails with the feed branch
closed and the bypass branch open (max bypass flow). However, as explained in Section
10.2.1, Figure 10.6 through Figure 10.9, proper configuration of TV389’s analog output block’s
output direction ensures TC389’s control direction can be specified independent of TV389’s
failure mode. Thus, with TC389 OP characteristic as shown in Figure 10.6, if TC389 PV is
increasing and/or is above its set point, TC389 OP must decrease to decrease E-342 duty, e.g.,
increase TV389 bypass % open and decrease TV389 feed branch % open. Thus, TC389’s control
direction = Reverse.
4. If E-342 duty, QC314 PV, is increasing and/or is above its set point, it must increase E-349
duty to reduce QC314 PV. With QC314 manipulating three-way bypass valve TV314, QC314
OP characteristic is also as shown in Figure 10.6. Therefore, if QC314 PV is increasing and/or is
above its set point, and QC314 must increase E-349 duty, QC314 OP must increase – to decrease
TV349 bypass % open and increase TV349 feed branch % open. Thus, QC314 control direction
is Direct.
5. QC314 is a cascade secondary and thus it is tuned for best SP response, proportional on error,
with SP Init = Yes.
6. E-342 hot side inlet (TI689 PV) and outlet (TI690 PV) temperatures are externally multiplexed
DTI points and are validated before they are used in the duty calculation in Equation (10.1).
7. RC314 is not a PID and requires no tuning. Since it is a cascade primary, and its setpoint value
is established by the PTS group, setting SP Init = No is in principle acceptable. However, this
may cause a bump to QC314 SP on an initialization pass. See design note # 11 below for an
approach that avoids a bump to QC314 SP when RC314 initializes with SP Init = No.
8. If FC632 SP (instead of FC632 PV) is configured as the dynamic compensation calculation’s
(FCG632) wild flow input to minimize feed rate noise propagation, it is best to configure FC632
for SP Init = Yes. If FC632 is itself a cascade secondary, it is already configured for SP Init = Yes.
If FC632 is not a secondary, and SP Init =Yes, reactor operations that are not at the desired
throughput may result. Discuss this issue with operations before implementation.
9. Custom logic must be provided to ensure the FB loop is unaffected by a feedforward (FF)
loop problem. Potential FF loop problems are: (i) the reactor’s feed measurement (FC632 PV)
becomes unavailable, (ii) the hot oil flow measurement (FI612 PV) becomes unavailable, and Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License306 10 Heat Input/Heat Removal Controls
(iii) either E-342 hot side inlet (TI689 PV) or outlet (TI690 PV) temperature is declared invalid.
Since these four measurements are in FF loops, if any one of the four fails, its last “Good” value
can be used to ensure feedback control continues.
10. FF control is turned Off by transferring FCG632 to manual mode, FCG632’s lead-lag algorithm
does not execute, and RC314’s dynamically compensated wild flow input remains constant.
Unless an operator changes RC314 SP, RC314 does not change QC314 SP.
11. Custom logic must be provided to initialize ratio controller RC314 when (i) feed rate FF is
turned On and (ii) an unavailable feed measurement (FC632 PV) becomes available again. If
a new RC314 SP is not back calculated on the initialization pass (SP Init = No), QC314 SP
will (almost certainly) be bumped on the initialization pass. If RC314 SP Init = Yes, on the
initialization pass, a new RC314 SP will be back calculated based on the current feed rate and
QC314 SP values. QC314 SP will not be bumped on the initialization pass, but RC314 SP will
not be the PTS guideline value. Thus, it is usually best to provide additional logic to slowly
ramp the initialized RC314 SP back to the last PTS guideline SP value.
12. Likewise, when (i) either E-342 hot side inlet (TI689 PV) or outlet (TI690 PV) temperature
returns valid after being declared invalid or (ii) the hot oil flow measurement (FI612 PV)
becomes available after being unavailable, custom logic must be provided to initialize heat
duty controller QC314. Since QC314 is configured as a PID controller, its initialization
calculations are managed by standard DCS features. When QC314 initializes, it sends an
initialization request to its primary, RC314; standard DCS features then initialize RC314.
10.2.4 Product Stripper Inlet Temperature Control1
Hydrodesulfurization (HDS) is a packed bed catalytic reactor system that removes feed sulfur,
nitrogen, metals, and Conradson carbon. It produces good quality FCCU feed stocks and desulfu￾rized heavy fuel oils. HDS feeds are vacuum gasoils (VGO, vacuum pipestill sidestream products)
and heavier gasoils (reaction system main fractionator sidestream products). Like the reactor sys￾tem discussed in Section 10.2.3, a hydrogen rich treat gas provides a large excess of hydrogen to
promote the desired reactions. The reactor effluent is separated into liquid and gas products in
hot and cold separator drums. The liquid products (separator bottom streams) are heated and then
fed to a product stripper where tail gas (uncondensed overhead vapor), wild naphtha, wild gasoil
(FCCU feed) and heavy fuel oil products are separated. Unlike the previous section, where the
reactor controls were the focus, in this section the focus is on the product stripper controls.
In Figure 10.14, the HDS Product Stripper (T-635) separates the stabilized HDS reactor effluent
into wild naphtha (distillate), wild gasoil (sidestream) and heavy fuel oil (bottoms) products. After
amine treatment to remove H2S, the tail gas is sent to the treat gas and/or fuel gas systems. The wild
naphtha is normally sent for hydrotreating and becomes either catalytic reformer feed or MOGAS
blend stock. The wild gasoil product is sent to the FCCU as a feedstock. Preheat exchanger E-601
supplies the heat required to vaporize the feed components removed as liquid products above
the feed tray, and the liquid returned as reflux to insure good fractionation above the sidestream
draw-off tray. The higher the preheat duty, the more vapor is sent overhead and thus the more
reflux, wild naphtha and wild gasoil are produced. Overhead condenser E-602 capacity must be
sufficient to condense almost all the vapor produced in E-601 and not condensed by the tower’s
internal reflux. Steam stripping below the feed tray removes lower boiling (lighter component)
hydrocarbons from the unvaporized feed, upgrading small amounts of heavy fuel oil to wild gasoil.
The wild naphtha (FI652) product’s quality is set by the overhead temperature controller (TC651)
manipulating reflux flow. TC651 SP is an operator entered PTS guideline value that maintains wild
1 This control strategy was used previously, in Sections 1.7.5 and 7.6, to introduce control concepts discussed in this
section, but unlike this section, with no design details.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.2 Feed Preheat Controls 307
D-611
T
6
3
5
LC
635
FC
655
Heavy fuel oil
Steam
Wild
naphtha
TC
651
Tail gas
TV651 LV635
FI
672
FI
652
E-602
LC
673
Wild gasoil
(FCCU feed)
FC
675
FV675
HDS reactor
liquid effluent
TI
653
VPS
bottoms
LC
631
E-601
FI
621
TV653
FI
660
TI
662
TI
663
Figure 10.14 Product Stripper Tower Feed Preheat Configuration
naphtha product quality on target. Wild naphtha yield is set by reflux drum level control (LC635)
manipulating wild naphtha product flow via LV635 adjustments.
The wild gasoil product is withdrawn from a complete draw-off tray via level control (LC673)
manipulating draw-off flow (FC675). The liquid hold-up on the draw-off tray, and thus the wild
gasoil product yield, varies with the amount of vapor produced in preheat exchanger E-601
(E-601 duty). Since the wild gasoil is normally FCCU feed, the operating objective is to maximize
gasoil yield by maximizing E-601 duty, as limited by tower operating constraints. Operating
experience indicates the most likely constraints to limit feed preheat are a full open reflux
valve (TV651) and/or a full open distillate valve (LV635); wild gasoil draw-off valve (FV675)
does not become an active constraint before either the reflux or distillate flow valve becomes
limited.
The control strategy in Figure 10.15 maintains the stripper inlet temperature (TC653) at an
operator entered target by manipulating the E-601 heat duty/stripper feed ratio (RC653 SP). RC653
provides FF compensation for stripper feed rate (FI621) upsets. The feed rate is dynamically
compensated (in FIG621) before it becomes the ratio controller’s wild flow input. RC653 then
resets E-601 heat duty controller QC653 SP. E-601 heat duty is calculated using hot side (VPS
bottoms) temperatures (TI662 PV, TI663 PV) and flow rate (FI660 PV). QC653 provides FF
compensation for VPS tower upsets that affect either E-601 hot side inlet temperature (TI663) Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License308 10 Heat Input/Heat Removal Controls
TC653
RC653
Validation
Desired T-635
feed temperature
SP
SP
TI
653
E-601
duty/feed
FI
621
Feed rate
FIG621
Dynamic
compensation
QC653
TIV662
SP
E-601
heat duty
TIV663
FI
660 VPS Btms
rate
TV653
VPS Btms
to E-601
VPS Btms
flow 
VPS Btms
from E-601
TI
663
TI
662
Figure 10.15 Product Stripper Feed Temperature Control
or flow rate (FI660). Both temperatures are externally multiplexed DTI points and are validated
before their use in the duty calculation. In the heat duty calculation shown below, TIV663 PV and
TIV662 PV are validated values of TI663 and TI662, and CP is a typical value of VPS bottoms heat
capacity provided by the PTS group and assumed constant. Remember that for implementation, a
scale factor may be needed to insure QC653 PV has the desired engineering units.
QC653 PV = Scale ∗ FI660 PV ∗ CP ∗ (TIV663 PV − TIV662 PV)
TC653 SP determines the feed preheat duty and thus the tower’s vapor loading. Because overhead
temperature control (TC651) manipulates reflux flow, E-601 duty also affects the tower’s liquid
loading. To meet the wild gasoil yield maximization operating objective, operators increase TC653
SP up to a maximum allowable guideline value specified by the PTS group, or until either the reflux
or distillate flow (wild naphtha) valve becomes limited high (i.e., almost full open). When either
valve position constraint approaches or exceeds its limit, operators do not increase, and may reduce
TC653 SP.
Design Notes and Features (For the Control Strategy in Figure 10.15)
1. The control strategy is a simple cascade – cascade initialization and wind-up are both handled
by standard DCS features.
2. Stripper feed temperature, TI653, is a 4–20 mA (high level) A/I and validation is not necessary.
3. E-601 duty controller QC653 is an ultimate secondary outputting to bypass valve TV653 and
must be configured as a PID controller.
4. QC653 is a cascade secondary – it is tuned for best SP response, proportional on error, with SP
Init = Yes.
5. Three-way valve TV653 is manipulated by QC653 to vary E-601 duty to maintain QC653 PV at
set point. A three-way valve in exchanger bypass service typically fails with the feed branch
closed and the bypass branch open (max bypass flow). However, as explained in Section Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.2 Feed Preheat Controls 309
10.2.1, Figure 10.6 through Figure 10.9, proper configuration of TV653’s analog output block’s
output direction ensures QC653’s control direction can be specified independent of TV653’s
failure mode. Thus, with QC653 OP characteristic as shown in Figure 10.6, if QC653 PV is
increasing and/or is above its set point, QC653 OP must decrease to decrease E-601 duty, e.g.,
increase TV653 bypass % open and decrease TV653 feed branch % open. Thus, QC653’s control
direction = Reverse.
6. RC653 performs an algebraic control calculation:
RC653 OP(%) = RC653 SP ∗ FIG621 (Lead∕Lag Algo result)
where the Lead/Lag algorithm’s calculation result is the dynamically compensated feed rate
(FI621). Control direction does not apply to RC653, but it is a cascade secondary and therefore
SP Init = Yes. Note: RC653 OP (%), in engineering units, RC653 OP (EU), becomes QC653 SP.
7. TC653 is a cascade primary whose SP is changed from time to time by operators to improve
wild gasoil yield. But it must also respond to load upsets (e.g., T-635 feed rate and feed
composition changes, E-601 hot side upsets not completely rejected by the E-601 heat duty
controller, and so on). Whether to tune for best load (proportional on PV) or best SP (propor￾tional on error or proportional on PV) response must be discussed with operations. TC653
control direction = Reverse – if temperature is increasing and/or is above its set point, it must
reduce the duty/feed ratio.
8. Because the TC653 SP value is established by the PTS group, SP Init = No is in principle accept￾able, but if so, RC653 SP will be bumped if TC653 PV≠TC653 SP when TC653 initializes. If the
RC653 SP bump is unacceptable, then set TC653 SP Init = Yes and add code to ramp TC653 SP
back to its last (PTS guideline) value.
9. FF loop problems must not adversely affect the feedback (temperature) control. Potential FF
loop problems are: (i) a feed measurement (FI621 PV) becomes unavailable, (ii) E-601 VPS
bottoms flow measurement (FI660 PV) becomes unavailable, and (iii) either E-601 hot side inlet
(TI663 PV) or outlet (TI662 PV) temperature declared invalid. Since these four measurements
are in FF loops, if any one of the four fails, its last “Good” value can be used.
10. Temperature control must continue if feed rate FF is turned Off. FF control is turned Off by
transferring FIG621 from Auto to Manual mode and On by transferring FIG621 from Manual
to Auto mode.
11. Suitable logic must be provided to initialize ratio controller RC653 when (i) feed rate FF is
turned On and (ii) an unavailable FI621 PV measurement becomes available. After RC653 ini￾tializes, standard DCS features initialize TC653.
12. Likewise, when (i) either E-601 hot side inlet (TI663 PV) or outlet (TI662 PV) temperature
returns valid after being declared invalid or (ii) the VPS bottoms flow measurement (FI660
PV) becomes available after being unavailable, custom logic must be provided to initialize heat
duty controller QC653. Since QC653 is a PID controller, once it is requested to initialize, its
initialization is managed by standard DCS features. After QC653 is initialized, standard DCS
features initialize RC653 and TC653.
The control strategy in Figure 10.15 requires operator action (e.g., increase/decrease TC653 SP,
reflux, and distillate flow valve position constraint monitoring) to achieve the tower’s primary
operating objective (maximize wild gasoil yield). Even if the incentives are high, operators will
normally give a “constraint pushing” strategy a lower priority than control strategies that stabilize
operations, confine operations to safe operating regions or meet product quality targets.
The control strategy in Figure 10.15 can be augmented to automate the “constraint pushing”
part of the strategy. The enhanced design, shown in Figure 10.16, converts the strategy in Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License310 10 Heat Input/Heat Removal Controls
Figure 10.15 to a conventional constraint control strategy with multiple constraint variables
(T-635 inlet temperature, reflux, and distillate valve positions) and a single manipulated variable
(E-601 bypass valve position, TV653). The additions - reflux valve position controller VTV651,
distillate valve position controller VLV635 and the low signal selector (LSS) – are indicated by
grey shading. Each constraint variable has its own dedicated PID controller (TC653, VTV651, and
VLV635), tuned for its own dynamics (its response to changes in TV653 valve opening), trying to
adjust the one manipulated variable (TV653) to drive its PV value to its constraint limit, i.e., its
PID’s SP. Note that in this conventional constraint control strategy, TC653 SP is the PTS group’s
desired maximum allowable feed temperature guideline value. Both valve position constraints are
maximum constraints.
Remember: Both valve position constraints are maximum constraints. An increase in preheat duty,
the MV (less bypass flow and more feed flow), drives all three constraint variablestoward violation.
Consequently, the low signal selector included in Figure 10.16’s constraint control strategy follows
directly from the rules developed in Section 7.4.4 (Signal Selector Configuration).
As previously pointed out (Figure 10.15 discussion, design note #5), the DCS handles TV653’s
failure mode via output signal conditioning external to all three controller output calculations. Con￾troller outputs QC653 OP, VTV651 OP and VTV635 OP are calculated as % open. The output chosen
by the LSS is sent to analog output block TV653 whose output direction ensures the following: (i)
when the chosen controller’s output decreases, flow in the bypass branch increases and flow in the
VTV651
Max reflux valve position SP
TV651 VLV635
Max distillate valve position SP
LV635
LSS
TV653
TC653 
RC653 
Validation
SP
SP
TI
653
E-601
Duty/feed
FI
621
Feed rate
FIG621
Dynamic
compensation
QC653
TIV662
SP
E-601
heat duty
TIV663 
FI
660 VPS Btms
rate
TI
663
TI
662
VPS Btms
to/from E-601
Max feed temperature
(PTS guideline value)
Figure 10.16 Product Stripper Feed Temperature Maximization
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.3 Control Strategies in Heat Integrated Units 311
feed branch decreases and (ii) when the chosen controller’s output increases, flow in the bypass
branch decreases and flow in the exchanger feed branch increases.
Design Notes and Features (for the Control Strategy in Figure 10.16)
1. The control strategy is a complex cascade, and cascade initialization and wind-up above the LSS
cannot be resolved by standard DCS features and requires custom logic. However, once QC653
initialization and wind-up statuses are established by the custom logic, standard DCS features
will resolve RC653 and TC653 initialization and windup statuses.
2. To prevent the wind-up of the non-active CV controller outputs, custom logic must be provided
to reset the non-active CV controller outputs to the active constraint variable’s PID output.
3. Design notes 2 through 6 and 8 through 11, relevant to the control strategy in Figure 10.15, are
also applicable to this strategy’s common components above the LSS: heat duty, QC653, heat
duty/feed, RC653, dynamic compensation, FIG621, and feed temperature, TC653.
4. Since the constraint variable PID SPs will almost never be changed, all constraint variable PIDs
(TC653, VTV651 and VLV635) should be tuned for best load response, proportional on PV with
SP Init = No.
5. The operator interface includes an indication of which constraint variable is active.
6. Because constraint variable noise can confuse the LSS and cause erratic switches, a constraint
variable “switch history” display is useful to detect noise problems.
7. When QC653 PV becomes unavailable or is set “Bad”, QC653 control action stops and its output
is frozen. Because QC653 is essential to achieve the control strategy’s objective, user provided
logic/code must decommission the full constraint control strategy. A console display indication
must be provided to inform operators. When QC653 returns to normal, a console display indi￾cation must inform operators. Re-commissioning can be done automatically by user-provided
logic/code, or manually by operators.
Last Thoughts and Closing Remarks
The LSS in Figure 10.16 can also be placed higher in the cascade – above ratio controller RC653.2
If so, TC653 OP (not QC653 OP), VTV651 OP and VLV635 OP, each controller’s desired value of
RC653 SP, are the outputs sent to the LSS; the LSS sends the smallest of the three values to RC653 SP.
All three PIDs are tuned for their dynamic responses to changes in RC653 SP. Heat duty controller
QC653 once again becomes the ultimate secondary, with its output pushed directly to TV653.
This alternative LSS placement does provide an advantage. Operators can more easily change
E-601 bypass flow, e.g., by transferring QC653 from cascade to manual mode (decommissioning
all constraint variable PIDs) and changing QC653 OP. For the cascade shown in Figure 10.16,
an operator must work with the LSS to change TV653. Depending upon the specifics of the DCS
system’s Override algorithm (the LSS design’s most important component), custom configuration
and/or logic may be required to make this “operator friendly”, i.e., comparable to changing a PID
controller’s OP.
Note: For the cascade in Figure 10.16, QC653 dynamics (and tuning) do not underly the response
of TV653 to VTV651 and VLV635 controller adjustments – they adjust TV653 directly. Hence, these
response times are somewhat faster than they would be in the LSS above RC653 design.
10.3 Control Strategies in Heat Integrated Units
Unit process designs incorporate heat integrations to recover process heat, and ultimately reduce
energy utilization. Although heat integration has proven operating and investment cost advantages,
2 In Section 7.6 (Figure 7.16), the control strategy with the LSS placed above the heat duty controller is discussed.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License312 10 Heat Input/Heat Removal Controls
it increases process interactions and can make unit operations less stable and more prone to upsets.
The process interactions and potential upsets also make process control more difficult, and effec￾tive control strategies more complicated. In this section, control strategies implemented in
typical heat integrated process configurations are presented; these include control strategies that
manipulate reboiler and fractionator pumparound heat duties to meet various unit operating
objectives.
Control strategies that exploit heat integration to minimize energy costs are presented in Chapter
11 (Energy Conservation Controls).
10.3.1 Crude Distillation Unit (CDU) Sidestream Stripper Overhead Temperature
Control
Tower reboilers provide heat to generate vapor boil-up and thus enable the tower to meet its
separation objectives. Liquid leaving the tower’s bottom tray is routed to the reboiler, heated to its
boiling point, partially vaporized, and the vapor returned to the tower. The heat source is normally
another process stream, an important example of heat integration. Note that a reboiler’s heat
source can also be steam, or the heat of combustion provided by a fired heater. We now explore an
application that has a reboiler heat integrated with another process stream and several other unit
operations.
In Figure 10.17, a CDU’s first sidestream stripper (T-205) is reboiled by CDU bottom pumparound
(BPA) in E-118. Stripper T-205 removes the lightest components from its feed. The light compo￾nents leave T-205 with the overhead vapor, flowing directly to naphtha splitter T-257, where light
virgin naphtha (LVN), a MOGAS blend stock, and heavy virgin naphtha (HVN), catalytic reformer
feed, are separated as naphtha splitter distillate and bottoms products respectively. T-205 bottoms
product becomes kerosene hydrofiner (Kero H/F) feed.
BPA not only reboils T-205 in E-118, it also is the heat source for two other heat exchangers
immediately upstream of E-118:
● Debutanizer (DeC4) reboiler E-376, with heat duty set by DeC4 tray temperature controller TC136
● Kero H/F feed preheat exchanger E-131, with heat duty set by H/F feed inlet temperature
controller TC151.
Operational changes and upsets in these two upstream BPA heat consumers cause temperature
upsets in E-118. DeC4 and Kero H/F operations routinely produce TC136 and/or TC151 control
adjustments to E-376 and/or E-131 heat duties; these adjustments affect E-118 BPA inlet tempera￾ture TI148. If this upsets E-118 duty, T-205 operations are impacted, causing overhead temperature
(TI206) upsets. Note that any other upset (or operational change or control application adjust￾ment) that affects BPA draw off temperature and/or flow (FC146) can cause E-118 upsets and hence
impact T-205 operations as well.
Maintaining a stable overhead temperature is the most important T-205 operating objective. This
temperature, at constant pressure, is a good indicator of C6 components and hence it has an impact
on the downstream naphtha splitter bottoms (HVN) 5% boiling point quality. Although the HVN
5% boiling point control strategy is implemented at the naphtha splitter, stabilization of the C6
components in T-205 overhead improves the HVN 5%-point control loop’s performance.
A control strategy to maintain overhead temperature at the PTS specified guideline target is
shown in Figure 10.18. The most important component of this strategy is the E-118 heat duty
controller, QC206, which provides FF compensation for any upset or operational change that
affects E-118 inlet temperature (TI148) or BPA flow rate (FC146). E-118 heat duty is calculated
using hot side (BPA) temperatures (TI148, TI144) and flow rate (FC146). Both the inlet and outlet Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.3 Control Strategies in Heat Integrated Units 313
T
2
0
5
LC
203
FC
106
CDU
1st side stream
draw-off
CDU
1st side stream
stripper
E-118
E-131
Naphtha
splitter T
2
5
7
HVN
5% Pt
BPA
from CDU
BPA return
to CDU
To
kero H/F
Kero H/F inlet
temperature
control
TC
151
TC
136
DeC4 tray
temperature
control
FC
146
E-376
LVN
AI
246
PI
233
TI
206
TI
144
TI
FC 148
206
TV206
Figure 10.17 CDU Sidestream Stripper Reboiler Configuration
temperatures are externally multiplexed DTI inputs and must be validated before they are used in
the duty calculation. For implementation, a scale factor may be needed to insure QC206 PV has
the desired engineering units.
QC206 PV = Scale ∗ FC146 SP ∗ CP ∗ (TIV148 PV − TIV144 PV) (10.2)
QC206 SP is calculated and reset by RC206, the E-118 heat duty/tower feed ratio controller.
RC206 provides FF compensation for T-205 feed rate (FC106) changes. The feed rate is dynami￾cally compensated (in FCG106) before its use in the cascade. Finally, T-205 overhead temperature,
TC206, resets RC206 SP. TC206 SP is an operations directive that is specified by the PTS group to
help meet the downstream HVN 5%-point specification. The overhead temperature measurement,
TI206, is an externally multiplexed DTI measurement and must be validated before it becomes
TC206’s PV input, and is used for control.
Note that T-205 pressure (PI233) is uncontrolled. Since reboiler duty impacts vapor boil-up,
overhead pressure will vary as TC206 adjusts reboiler duty to maintain its PV at TC206 SP. At
constant (or almost constant) pressure, overhead temperature is a good indicator of C6 content.
However, because T-205 pressure varies as reboiler duty is adjusted to maintain constant overhead
temperature, overhead C6 composition also varies. For the process configuration and unit opera￾tions presented in Figure 10.17, the pressure induced overhead composition changes are acceptable Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License314 10 Heat Input/Heat Removal Controls
TV206
FC
106
TIV206
TIV144
TIV148
FC
146
TC206
RC206
Validation QC206
Validation
E-118
heat duty
E-118
duty/feed
Overhead
temperature
BPA flow
T-205
feed rate
Desired overhead
temperature 
SP
SP
BPA from
E-131
FCG106
Dynamic
compensation
BPA return
to CDU
TI
206
TI
144
TI
148
SP
Figure 10.18 CDU Sidestream Stripper Overhead Temperature Control
and TC206 PV does not need pressure compensation.3 Note: Applications that include pressure
compensation of temperature to help compensate for more significant tower pressure changes and
improve quality control are presented in Chapter 12.
Design Notes and Features
1. The control strategy is a simple cascade – cascade initialization and wind-up are both handled
by standard DCS features.
2. QC206 is an ultimate secondary and because the relationship between duty and valve position
is nonlinear, it is configured as a PID controller. QC206 is a cascade secondary – it is tuned for
best SP response, proportional on error, with SP Init = Yes.
3. Three-way valve TV206 is manipulated by QC206 to vary E-118 duty in order to maintain
QC206 PV at set point. As discussed previously, QC206’s control direction can be specified inde￾pendent of TV206’s failure mode. Thus, with QC206 OP characteristic as shown in Figure 10.6,
if QC206 PV is increasing and/or is above its set point, QC206 OP must decrease to decrease
E-118 duty, e.g., increase TV206 bypass % open and decrease TV206 feed branch % open. Thus,
QC206’s control direction = Reverse.
4. FC146 SP (not PV) is used in the calculation of the heat duty (QC206 PV) to minimize BPA flow
measurement noise propagation. FC146’s set point is almost certainly set by another control
application, and thus, as a secondary, is configured with SP Init = Yes. FC146 SP is then an
accurate indicator of FC146 PV when FC146 is in manual mode. If FC146 is not a secondary,
configuring FC146 for SP Init = Yes must be discussed with operations before final design.
3 A linear pressure–temperature relationship used to pressure compensate tower temperatures is discussed in
Section 3.7.3.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.3 Control Strategies in Heat Integrated Units 315
5. RC206 performs an algebraic control calculation, RC206 OP = RC206 SP * FCG106 Lead/
Lag Algo result, and therefore, control direction does not apply. However, it is a cascade
secondary and therefore SP Init = Yes. Note: RC206 OP (%) in engineering units (RC206 OP
(EU)) is QC206 SP.
6. FC106 SP (not PV) is the dynamic compensation calculation’s (FCG106) wild flow input to
minimize feed rate noise propagation. FC106’s set point is almost certainly set by another con￾trol application, and thus, as a secondary, is configured with SP Init = Yes. If FC106 is not
a secondary, configuring it for SP Init = Yes must be discussed with operations before final
design.
7. TC206 is a cascade primary whose SP is changed from time to time but must also respond
to load upsets. Whether to tune for best load (proportional on PV) or best SP (proportional
on error or proportional on PV) must be discussed with operations. TC206 control direc￾tion = Reverse – if temperature is increasing and/or is above its set point, it must reduce the
duty/feed ratio.
8. Because the TC206 SP value is an offline specified guideline value, SP Init = No is acceptable
although RC206 SP will be bumped when TC206 PV≠TC206 SP on a TC206 initialization pass.
If a potential RC206 SP bump is unacceptable, then set TC206 SP Init = Yes and add code to
ramp TC206 SP back to its last (guideline) value.
9. FF loop problems – either T-205 feed measurement (FC106 PV) or BPA flow measurement
(FC146 PV) becomes unavailable, either E-206 hot side inlet (TI148 PV) or outlet (TI144 PV)
temperature declared invalid, must not adversely affect the temperature feedback loop. Since
all four measurements are used in FF loops, if any one of the four fails, its last “Good” value can
be used. Note that hot side inlet temperature, TI148 PV, is the overhead temperature control
loop’s most important upset, so control performance will degrade when it is unavailable.
10. Temperature control must continue if feed rate FF control is turned Off. Feedforward control is
turned Off by transferring FCG106 from Auto to Manual mode – it is turned On by transferring
FCG106 from Manual to Auto mode.
11. Suitable logic must be provided to initialize ratio controller RC206 when (i) feed rate FF is
turned On (FCG106 transferred to Auto mode) and (ii) an unavailable FC106 PV measurement
becomes available. Standard DCS features will initialize TC206 after it receives an initialization
request from RC206.
12. Likewise, when (i) either E-206 hot side inlet or outlet temperature (TI148 PV, TI144 PV)
returns valid after being declared invalid or (ii) BPA flow measurement (FC146 PV) becomes
available after being unavailable, custom logic must initialize heat duty controller QC206. Fol￾lowing QC206’s initialization, standard DCS features will initialize RC206 and TC206.
13. TI206 PV is PID controller TC206’s PV input. Thus, TC206 input must be allowed to be set
“Bad” when TI206 PV is declared invalid (in TIV206); all TC206 control action stops. However,
the cascade below TC206 remains fully commissioned.
10.3.2 Deethanizer Tray Temperature (Bottoms Quality) Control
We now consider the process configuration in Figure 10.19, which includes heat consumers in
an FCCU’s main fractionator pumparound (P/A) circuit. The P/A circuit provides preheat for the
FCCU feed (in E-405) and is the heat source for three tower reboilers (E-233, E-223, and E-237).
We focus on reboiler E-233 and the deethanizer (DeC2) tower (T-209). Towers T-205 and T-206 tray
temperature controllers (TC291, TC284 respectively) manipulate P/A flow SPs to E-223 (FC231)
and E-237 (FC237). As these two temperature controllers make control adjustments, the P/A flows
to E-233 (T-209 reboiler) and E-405 (FCCU feed preheat) are affected, with subsequent impact on Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License316 10 Heat Input/Heat Removal Controls
FCCU feed
FC
236
FCCU main
fractionator P/A P/A
E-233 return
T-209
reboiler
FC
231
SP
E-223
T-205 reboiler
FC
237
SP
E-237
T-206 reboiler
T-205
tray temperature
controller
TC
291
T-206
tray temperature
controller
TC
284
TC
261
T-209
tray temperature
controller
TV261
TI
243
FC
456
E-405
TI
495
TI
244
TI
278
TI
496
TI
277
Figure 10.19 FCCU Main Fractionator Pumparound (P/A) Configuration
both exchanger duties. The effect on E-405 is small, because E-405 P/A flow is much larger (to
provide preheat to FCCU feed) than the combined P/A flows to E-223 and E-237. However, this is
not the case for T-209 reboiler E-233, and the P/A flow adjustments made by the other two reboiler
duties have an important impact on E-233 duty.
The existing control strategy implemented to control T-209 bottoms quality is shown in
Figure 10.20. Tray temperature controller TC261 manipulates the P/A bypass flow to E-233 to
meet an operator entered SP. As will be discussed in Chapter 12, a stripping section (below the
feed tray) tray temperature is an inferential indicator of the tower separation’s light key, in this
case, C2. TC261 SP is a PTS guideline that minimizes C2 content in T-209 bottoms to minimize
the C2 content carryover to LPG (T-209 bottoms is routed to downstream towers for further
separations). In Figure 10.20, changes in P/A flow to E-233 as adjustments are made to FC231 by
TC291 and FC237 byTC284, and P/A draw-off temperature (TI277 PV) upsets (see Figure 10.19),
which affect TI243 PV, must first impact the tray temperature before TC261 begins to adjust
E-233 P/A bypass. As a result, TC261 controller performance is sometimes poor, and main
fractionator and T-209 upsets result in C2 dumping into LPG. Therefore, the control strategy can
be significantly improved if reboiler E-233 duty can be calculated and incorporated into the control
cascade.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.3 Control Strategies in Heat Integrated Units 317
Figure 10.20 Existing DeC2 Tray Temperature
Control
LC
235
TC
261
FI
213
T
2
0
9
Feed TI
261
BPA
E-233
TV261
TI
243
TI
244
Hot side (P/A) inlet and outlet temperatures are measured – if E-233 hot side flow was measured,
E-233 duty could be calculated. However, it is not measured, and if E-233 duty is to be calculated,
it must be estimated.
4 Referring to the process configuration shown in Figure 10.19, there are
sufficient measurements on E-405 cold side (FCCU feed) to calculate E-405 duty. Then, by equating
cold and hot side duties, hot side flow (P/A) to E-405 can be back-calculated. Once the P/A flow
to E-405 is calculated, P/A flow to E-233 can be estimated by difference. The following equations
illustrate the calculation; all temperatures are DTI points and thus they all must be validated
before use:
Cold side: QE−405 = FC456 SP ∗ CP(FCCU feed)∗(TIV495 PV − TIV496 PV) (10.3)
Hot side: QE−405 = FE−405,P∕A ∗ CP
( P
A
)
∗ (TIV277 PV − TIV278 PV) (10.4)
Remember implementation may require scale factors to insure cold and hot side duties have the
desired engineering units. Heat capacities CP (FCCU Feed) and CP (P/A) are provided by the PTS
group, entered manually, and maintained constant. With all temperatures measured, FC456 SP
known, and assuming no heat losses, by equating cold and hot side duties, Equations (10.3) and
(10.4) are solved for FE-405,P/A, the pumparound flow to E-405. Then, with the pumparound flow
to E-405 estimated (FE-405,P/A), the P/A flow to E-233 (FE-233,P/A) is estimated using an overall P/A
material balance:
E − 233 BPA flow ≡ FE−233,P∕A = FC236 SP − [FE−405,P∕A + FC231 SP + FC237 SP] (10.5)
With the E-233 P/A flow estimate (FE-233, P/A ≡FIZ261 PV) calculated using Equation (10.5), E-233
duty (≡ QC261 PV) is calculated. Note a scale factor has been included to insure QC261 PV has the
desired engineering units.
QC261 PV = Scale ∗ FIZ261 PV ∗ CP
( P
A
)
∗ (TIV243 PV − TIV244 PV) (10.6)
The upgraded control strategy design for T-209 tray temperature control is shown in Figure 10.21.
4 A measurement is preferred. However, the hardware and installation costs of a new measurement would need to
be justified based on improved recovery of C2 in T-209 bottoms.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License318 10 Heat Input/Heat Removal Controls
QC261
TIV243
TIV244
Validation
BPA bypassing E-233
SP
BPA to
E-233
FIZ261
Estimated
BPA flow
calculation
and filter
TV261
E-233
heat duty
TC261
FI RC261
213 FIG213
Dynamic
compensation
Desired tray
temperature 
SP
SP
TI
261
T-209
feed
TI
243
TI
244
Figure 10.21 Improved DeC2 Tray Temperature Control
Like the CDU sidestream stripper overhead temperature control strategy discussed in Section
10.3.1, the most important component of the strategy in Figure 10.21 is the E-233 heat duty
controller, QC261, which provides FF compensation for any upset or operational change that
affects E-223 inlet temperature or (calculated) hot side (P/A) flow. It is essentially the same strategy
implemented for the sidestream stripper overhead temperature control cascade in Figure 10.18
with the following exceptions:
● Hot side (P/A) flow is estimated, not measured.
● The tray temperature is a high-level analog input and thus validation is not necessary.
● Tower feed (FI213) is uncontrolled and hence FI213 PV is the dynamic compensation tag’s
(FIG213) wild flow input.
Design Notes and Features
1. Design notes 1–3, 5, and 7–13 for the control strategy in Figure 10.18 (CDU sidestream stripper
overhead temperature control) are valid for this cascade with tag names and equipment labels
changed to correspond to those in Figures 10.19 through 10.21.
2. Remember: All P/A temperature measurements are externally multiplexed DTI points and thus
they are validated before they are used to calculate FIZ261 PV, in Equations (10.3) through (10.5),
and QC261 PV in Equation (10.6).
3. FC456, FC236, FC231 and FC237 SPs are used in the calculations of P/A flows to E-405 and
E-233. Set point usage helps eliminate the effects of measurement errors and noise. All four flow
controllers must be configured for SP Init = Yes to ensure SP is an accurate indicator of actual
flow (PV) when the controller is in manual mode. FC231 and FC237 are cascade secondaries (in
tray temperature control strategies) and should already be configured for SP Init = Yes. FC236’s
set point is almost certainly calculated by another control application and hence as a cascade
secondary, it should already be configured for SP Init = Yes. FC456’s set point may or may not be
calculated by another control application. If it is, then it is already configured for SP Init = Yes.
If not, it is best to discuss with operations whether FC456 can be configured for SP Init = Yes; Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.3 Control Strategies in Heat Integrated Units 319
otherwise, contingency logic must be provided to use FC456 PV instead of its set point when it
is in manual mode.
4. Warning: The reliability of the estimated P/A flow to E-405, and the estimated P/A flow to E-233
(FIZ261 PV), will have an important impact on control performance. If FIZ261 is too variable,
it can be filtered to smooth the effects of flow measurement inaccuracies, noise, and exchanger
dynamics. If FIZ261 PV is not stable, then a typical E-233 P/A flow value can be tried. QC261
then provides FF compensation for only P/A temperature changes. Pre-implementation testing,
and post-implementation control performance monitoring, are necessary.
“What If” Issues
1. Suppose one of the flow controllers (from among FC456, FC236, FC231, and FC237) becomes
wound-up high, but its mode is still Auto. Since PV will no longer be equal to SP, the flow SP is
no longer an accurate indicator of actual flow (PV) for use in Equations (10.3) through (10.5). Is
contingency logic necessary to switch to the flow PV whenever one of these controllers becomes
wound-up high?
2. What actions are needed if a flow controller PV (from among FC456, FC236, FC231, and
FC237) becomes unavailable? To maintain the TC261 cascade on control, should FIZ261
PV be maintained constant at its last calculated value until the missing flow measurement
becomes available? Or should the unavailable flow be maintained at its last good value until
it becomes available? Initialization of QC261 is required when any one of the unavailable
PV’s becomes available once again. Standard DCS features will then manage the subsequent
initializations of RC261 and TC261.
10.3.3 Cat Naphtha Splitter Reboiler Duty Control
We now consider another heat integrated pumparound (P/A) circuit, shown in Figure 10.22.
This FCCU main fractionator P/A circuit serves as the heat source for three tower reboilers
(E-414, E-451, and E-405). Towers T-439 and T-441 tray temperature controllers (TC466 and
TC489 respectively) meet their SPs by manipulating the P/A flow that bypass E-414 and E-451,
respectively. For this application, we focus on reboiler E-405 and tower T-432, the Cat Naphtha
Splitter, and the distribution of P/A duty between E-451 and E-405 as determined by FC430, the
P/A flow to reboiler E-405.
FC
430
E-405
T-432 reboiler
E-414
T-439 reboiler
P/A return
flow
TC
406
E-410
T-439
tray temp
control
TV489
TC
466
T-441
tray temp
control
E-451
T-441 reboiler
TC
489
TI
436
FCCU fractionator P/A
FC
416
P-442
TI
412
∞
Figure 10.22 FCCU Fractionator Pumparound Exchanger Configuration
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License320 10 Heat Input/Heat Removal Controls
Cat
naphtha
splitter
T
4
3
2
FC
439
FC
423
LC
425
LCN
ICN
HCN
LC
426
FV423
LV426
From FCCU main
fractionator
C5+ distillate
PC
488
PV488
FC
422
E-407
LCN sulfur
quality
control
E-405
FC
430
FC
416 E-451
Fractionator
P/A
TI
436
TI
412
∞
Figure 10.23 Cat Naphtha Splitter (T-432) Configuration
The Cat Naphtha Splitter T-432 configuration is presented in Figure 10.23. After C4 and lighter
components are removed, FCCU main fractionator overhead distillate (C5+) is routed to T-432 as
feed. T-432 overhead distillate is Light Cat Naphtha (LCN), a MOGAS blend stock. It can also be
sent to downstream processing to upgrade its gasoline properties and/or produce low sulfur fuel oil.
The sidestream product, Intermediate Cat Naphtha (ICN) is normally hydrotreated (in the naphtha
hydrofiner, to remove sulfur) and then sent to catalytic reforming as a feed. The bottoms product,
Heavy Cat Naphtha (HCN), is also a MOGAS blend stock, and/or it can be sent to downstream
processing for sulfur reduction and fuel oil production.
T-432’s quality control loop (LCN sulfur) sets the LCN yield by adjusting the distillate product
flow (FC422 SP), while the ICN and HCN yields are set by level controllers LC426 and LC425,
respectively. Fractionation is determined by reboiler E-405 duty. Normally, a reboiler duty/feed
ratio → reboiler duty → hot side flow (FC430) cascade would be implemented to set tower frac￾tionation by maintaining the duty/feed ratio at an offline calculated guideline value. However, the
FCCU fractionator P/A duty requirements include a guideline “best” duty split between the two
P/A branches through E-451 and E-405. Therefore, T-432 fractionation must be set within this
guideline duty split: (i) when E-405 duty becomes too low to satisfy the guideline duty split, heat
duty is shifted from E-451 to E-405, but (ii) when E-451 becomes constrained high, and cannot
meet the tray temperature controller’s target (TC489 SP), heat duty is shifted from E-405 to E-451.
The guideline split is expressed as the ratio of E-405 duty to total P/A flow (FC416). If process
operations shift or upsets occur, this ratio needs to be adjusted online when (i) T-432 measurements Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.3 Control Strategies in Heat Integrated Units 321
TIV412
TIV436
FC
430
RC430
Validation QC430 E-405
heat duty
E-405 duty/
P/A flow
P/A flow
from E-405
E-405 inlet
and outlet
temperatures
SP
SP
SP
FV430
P/A flow
from E-405
P/A flow
to E-414
FC
416
P/A
flow rate
TI
412
TI
436
Desired
E-405 duty/
P/A flow
T-432 constraints
Bottoms
level (LC425)
Bottoms
flow (FC423)
Bottoms valve
position (FV423)
Side stream valve
(LV426)
Reflux valve
(PV488)
E-451 constraints
E-451 bypass
valve (TV489)
E-451 / E-405
duty monitor
Activate console display indication
1. Variable constrained
2. Increase or decrease RC430 SP 
Figure 10.24 T-432 Reboiler (E-405) Duty/Pumparound Flow Ratio Control with E-451, E-405 Duty
Monitor
or valve positions indicate a low E-405 reboiler duty or (ii) reboiler E-451 duty is constrained as
indicated by the pumparound bypass valve position (low bypass flow through TV489). Low E-405
reboiler duty indicators are (i) high T-432 bottoms level (LC425), flow (FC423) and/or valve position
(FV423) or (ii) low sidestream valve position (LV426), and/or (iii) low reflux valve position (PV488).
Figure 10.24 presents the control strategy design that maintains the desired guideline duty/feed
ratio. The control strategy in Figure 10.24 maintains the E-405 reboiler duty/total pumparound flow
ratio at target (RC430 SP) by manipulating the heat duty controller’s setpoint (QC430 SP); QC430
then adjusts the P/A flow to the E-405 reboiler branch (FC430 SP). As shown in Equation (10.7)
below, E-405 heat duty (QC430 PV) is calculated using hot side inlet (TI412) and outlet (TI436) tem￾peratures, and flow rate (FC430). TI412 and TI436 are both externally multiplexed DTI inputs and
must be validated before they are used in the duty calculation. Note again, for the online calculation,
a scale factor is included to ensure QC430 PV has the desired engineering units.
QC430 PV = Scale ∗ FC430 SP ∗ CP
( P
A
)
∗ (TIV412 PV − TIV436 PV) (10.7)
When the P/A draw-off flow (FC416 SP) is changed, RC430 will change QC430 SP; QC430 then
changes FC430 SP to ensure the duty/total pumparound flow ratio remains at its guideline value
(RC430 SP). Also, when P/A draw-off temperature (TI412) changes, QC430 adjusts FC430 SP to
ensure E-405 duty remains constant, which again ensures the duty/total pumparound flow ratio
remains at its guideline value (RC430 SP). Notice that reboiler duty is not adjusted when T-432 feed
rate changes.
The E-451/E-405 Monitor Logic checks whether a reboiler constraint is active. If a low E-405
reboiler duty indicator is detected, a console display indication informs operators to increase the
E-405 duty to P/A flow ratio target (RC430 SP); if a low E-451 reboiler duty indicator is detected, the
console display informs operators to decrease the E-405 duty to P/A flow ratio target. In either case,
the reboiler duty constrained is identified. Operations and PTS input and agreement are needed to
specify (i) level, flow, and valve position limits that trigger an RC430 SP adjustment and (ii) the
appropriate magnitudes for the RC430 SP adjustments. The RC430 SP changes relieve the reboiler
duty constraint by shifting P/A duty between the two reboiler branches.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License322 10 Heat Input/Heat Removal Controls
Notice that at constant P/A draw-off temperature (TI412 PV) and total P/A flow (FC416 SP),
if the P/A return temperature (TC406 SP) is changed, the total P/A duty changes but the duty
split between E-405 and E-432 is unchanged. If the P/A return temperature’s change, or any other
fractionator upset affects the P/A draw-off temperature (TI412 PV), QC430 adjusts the pumparound
flow to E-405 (FC430 SP) to ensure E-405 duty remains constant; this ensures the E-405 duty/total
pumparound flow ratio remains at its guideline value (RC430 SP).
In summary, the control strategy maintains a guideline duty split between the two P/A branches
through E-451 and E-405. The strategy responds to (i) any operational change or upset that affects
P/A draw-off temperature (TI412) and/or flow (FC416) and (ii) T-432 and T-441 operations that
cause E-451 (high) or E-405 (low) reboiler duty constraints to become active.
Design Notes and Features
1. The control strategy is a simple cascade and cascade initialization and wind-up are both
managed by standard DCS features.
2. The E-451 high duty constraint involves monitoring the exchanger’s bypass valve, TV489, which
is manipulated to control T-441 tray temperature TC489. As already discussed, a three-way valve
in exchanger service typically fails with the feed branch closed and the bypass branch open.
Thus, the controller output/valve characteristic illustrated in Figure 10.6 (Section 10.2.1), is
applicable to TV489’s relationship to TC489 OP. Figure 10.6, applied to E-451’s three-way valve
TV489 is shown below:
All flow bypassed No bypass flow
0%
100%
0%
TV489
bypass
% open
E-451
bypass
branch
E-451
feed
branch
TV489
feed
% open
0%
100%
TC489 OP 100%
Referring to TC489’s output characteristic above, as TC489 PV decreases, TC489 OP must
increase to increase E-451 duty – less hot side flow (P/A) is bypassed, and more is routed to
E-451 as feed. However, when TC489 cannot increase E-451 duty any further, the bypass %
open approaches 0% and both TC489 OP and TV489 OP approach 100%. Therefore, the E-451
high duty constraint is detected by a maximum limitation on either TC489 OP or TV489 OP.
3. E-405 duty controller QC430 can be configured as a PID controller or as an algebraic con￾trol calculation that directly calculates the P/A flow routed to reboiler E-405 – by solving
Equation (10.7) for FC430 SP, with QC430 PV replaced by QC430 SP. Because a reboiler heat
duty controller provides FF corrections for reboiler upsets, in most cases, the last “Good” value
of a heating medium’s inlet or outlet temperature (or inlet flow) can be used if the measurement
is declared invalid (or is unavailable). This allows the more important feedback control loop
to remain on control without the FF correction. However, in Figure 10.24, achieving the
guideline duty split between E-451 and E-405 requires the timely calculation of E-405’s heat
duty. Therefore, when either TI436 PV or TI412 PV is declared invalid, the heat duty controller’s
PV must be set “Bad” to force QC430 to become output indisposable; this decommissions the Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.4 Fired Heater Firing Controls 323
guideline duty split strategy. Note: If the E-405 P/A feed flow measurement (ultimate secondary
FC430) becomes unavailable, FC430 will be output indisposable and the guideline duty split
strategy will be decommissioned.
4. QC430 is a cascade secondary – if it is configured as a PID controller, it is tuned for best SP
response, proportional on error, with Control Direction = Reverse (if duty is too high, it must
decrease FC430 SP). Whether a PID or an algebraic control calculation, SP Init is set to Yes.
5. Control is stopped when a QC430 becomes output indisposable. Suitable logic must be provided
to initialize QC430 when E-405 hot side inlet or outlet temperature returns valid after being
declared invalid; this prevents a bump to the P/A flow (FC430 SP) on QC430’s first pass using
the new, valid value. Standard DCS features will then initialize RC430.
6. RC430 performs an algebraic control calculation that ensures the P/A duty distribution
between E-405 and E-451 remains at the guideline value when P/A draw-off flow (FC416)
changes – QC430 SP = RC430 SP * FC416 SP (or PV).
7. Using FC416 SP (not PV) as the ratio controller’s wild flow input is normally best because
it reduces measurement noise propagation. Because FC416 SP is almost certainly calculated
by another control application, as a cascade secondary it should already be configured for
SP Init = Yes. Additional logic may be necessary to switch to the flow PV if FC416 becomes
wound-up. Both the SP/PV choice (if necessary) and the switch to PV when FC416 is wound-up
should be discussed with operations before final design.
8. Since RC430 is the ultimate primary and its SP is either a PTS guideline value or a value needed
to relieve a reboiler constraint, setting RC430 SP Init = No appears to be the preferred choice.
However, SP Init = Yes can be a better choice, provided logic is added to slowly ramp the ini￾tialized SP back to the last SP value. This prevents a bump to QC430 SP (and hence FC430 SP)
whenever RC430 initializes but ensures RC430 SP returns to the desired (guideline or constraint
relieving) target. It is best to discuss this with operations before final design.
9. The control strategy design in Figure 10.24 assumes E-405 and/or E-451 duties become
constrained only occasionally. If either becomes constrained on a more frequent basis, the
monitoring logic can be updated to automatically adjust RC430 SP when the constraint is
detected. However, this is a non-trivial design update, and hence would need to be discussed
with process engineering and operations personnel before proceeding to design.
10.4 Fired Heater Firing Controls
Fired heaters provide preheat for towers, reactors, and other unit operations, and heat for tower
reboiling when high temperature heat is required to meet vapor boil-up requirements. We
have already discussed a fired heater providing preheat for a fixed bed reactor (Section 10.1.2,
Figure 10.2), and a CDU (Section 10.1.3, Figure 10.3); other examples are discussed in Chapters 13
and 14. A control strategy for a tower with a fired heater reboiler is discussed in Section 12.9.3.
Examples already presented and those referenced above for future discussion involve fired
heaters that provide process heat. There also are fired heaters that are chemical reactors. Their
tubes are either packed with catalysts that promote reactions (H2 production via steam reforming,
ethylene production via steam cracking) or reactions occur in the tubes via thermal cracking
(fuel oil production via Visbreaking). Control strategies for these types of fired heaters have
unit operations specific requirements that make them quite different from each other and from
strategies implemented on fired heaters that provide process heat. An important example of a fired
heater utilized as chemical reactor is a steam reformer, which catalytically produces H2 from a Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License324 10 Heat Input/Heat Removal Controls
light hydrocarbon feed that contains large quantities of methane. However, in the discussions that
follow, we focus exclusively on fired heaters that provide only process heat.
This section surveys heater firing controls, focusing on the common methods used to control
heater coil outlet temperature (COT) by manipulating fuel rate. Combustion controls manipulate
the air intake needed to efficiently burn the fuel demanded by the COT controller. Thus, firing and
combustion controls are by nature coupled. Combustion control involves stack excess O2 and/or
firebox pressure control. Draft pressure, the difference between firebox and atmospheric pressures,
can be a control variable instead of firebox pressure. We defer the discussion of combustion controls
and the linking of firing and combustion controls to Chapter 11 (Energy Conservation Controls).
10.4.1 Fired Heater Basics
Under ideal conditions, the combustion of hydrocarbon fuels with the stoichiometric amount of O2
converts all carbon to CO2 and all hydrogen to H2O. In a fired heater, the exothermic combustion
reactions take place in multiple burners at the bottom of the firebox where the entering fuel and
air mix and ignite. The combustion products rise through the firebox, into and through the heater’s
convection section, and then into the stack; the stack gases are then released into the atmosphere.
For many reasons, the stack gases leaving the heater contain other combustion products in addi￾tion to CO2 and H2O. Air (the O2 source), in excess of the stoichiometric requirement, is used to
insure complete combustion of fuel. Thus, any O2 or N2 entering the burners with the air and not
consumed by the combustion reactions exit with the stack gases. Oxides of sulfur (SOx) and nitro￾gen (NOx) are produced in small amounts when some nitrogen entering with the air and some
sulfur entering with the fuel are oxidized. Because there is some incomplete combustion caused by
poor mixing at the burners, trace amounts of CO and unburned hydrocarbons (combustibles) are
also in the stack gases. The atmospheric release of small amounts of SOx, NOx, and/or CO often
have emission limits that are important constraints on heater operations.
Depending upon the type of heater, air either enters the burners and is pulled through the
firebox and stack by buoyancy forces (Natural Draft) or is forced into the firebox by an air blower
(Forced Draft) and pulled through the stack by the buoyancy effect. The firing controls presented
in this section are independent of the type of heater. However, both in cascade structure and the
manipulated variables used, combustion controls for natural and forced draft heaters are different,
although the stack damper plays an important role in both. Differences also arise when exploring
how to link firing and combustion controls to improve heater control performance. We will
account for the differences between natural and forced draft heaters when combustion controls
are presented in Chapter 11.
The heat generated (the heat fired) by the combustion reactions is transferred to the process fluid
via radiant heat transfer (in the firebox) and convective heat transfer (in the convection section)
as the process fluid flows from the inlet to the outlet of the heater’s coils. Not all the heat fired is
absorbed by the process fluid – heat is lost via firebox leaks to the atmosphere and most importantly
with the hot stack gases leaving the heater.
To reduce the size of the heater’s physical structure, the process stream is divided into multiple
passes at heater entry for its passage through the heater and is recombined into a single stream once
again at heater outlet. The coil inlet temperature (CIT) is normally the temperature measurement
of the process fluid before it is divided into multiple passes. Because of burner imbalances, burner
locations relative to the passes, and heat transfer rate differences caused by coking/fouling, the pass
outlet temperatures are almost always all different. The COT is the temperature measurement of
the process fluid after the multiple passes are recombined and thus it is a weighted average of the
individual pass outlet temperatures.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.4 Fired Heater Firing Controls 325
FI
1
PI
1
TI
2
QR
AI
1
FI
2
Fuel gas header
QF
TI
1
TI
3
Figure 10.25 Fired Heater Firing Controls – Process Variable, Calculated Variable Summary
10.4.2 Process Variable and Calculated Variable Summary
Figure 10.25 presents the key process measurements and calculated variables used to control a
fired heater’s COT by manipulating a single fuel, in this case, fuel gas. The air side measurements
(not shown in Figure 10.25), e.g., stack excess O2, firebox pressure (draft pressure), air rate, stack
damper, etc., essential for heater combustion control, are discussed with the combustion controls
in Section 11.2. COT is sometimes controlled by manipulating fuel oil, and in some cases both fuels
are used simultaneously, one (almost always fuel gas) manipulated to control COT and the other
base loaded, e.g., held constant via flow (or pressure) control (dual fuel firing). Our focus is on
COT control using only a single fuel, e.g., fuel gas, since it is the most common approach found in
industry today. We present an example of dual fuel firing in Section 10.4.8, where fuel oil is base
loaded and fuel gas is manipulated to control COT.
Referring to Figure 10.25, the table below identifies the process measurements illustrated and
indicates the type of variable and/or its role in COT control. QR, the heat required, and QF, the heat
fired, are calculated using Equations (10.8) and (10.9), both discussed below.
Symbol Process Variable Variable Type
FI1 Feed rate DV
FI2 Fuel gas flow MV
AI1 Fuel gas heating value1 or molecular weight2 DV
PI1 Fuel gas pressure2 MV or DV
TI1 Coil inlet temperature (CIT) DV
TI2 Coil outlet temperature (COT) CV
TI3 Fuel gas temperature2 Used in calculation
1Used in the heat fired (QF) calculation. 2Used to calculate T, P, molecular weight compensated fuel gas flow.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License326 10 Heat Input/Heat Removal Controls
Depending upon the heater’s service, some measurements may not be available. For example,
measurements unavailable in some cases are fuel gas flow, fuel gas heating value, fuel gas MW
or density, fuel gas temperature and CIT; feed rate, COT, and fuel gas pressure are almost always
available. The COT measurement is almost always a 4–20 mA A/I signal and does not require val￾idation. The CIT is usually a DTI point (as is fuel gas temperature) and therefore normally needs
validation if it is used in a control strategy. The COT controls presented will illustrate the roles of
each of these process variables in the control strategy designs.
There are other firing side measurements of operational interest, for example tube metal
temperatures (TMTs), pass outlet temperatures and flows, bridgewall temperature, and stack
temperature. However, they do not normally play a direct role in COT control, although they
can sometimes be indicators of improper operations – overfiring (TMTs), flooding (bridge￾wall temperature), burner imbalance (pass outlet temperatures) or excessive heat lost (stack
temperature).
The two calculated variables shown in Figure 10.25, the heat required to raise the feed from CIT to
COT, QR, and the heat fired, e.g., the heat provided by the combustion reactions, QF, are calculated
as shown below in Equations (10.8) and (10.9). They are important components of the FF control
loops that are most frequently included in COT control strategies.
QR ≡ Heat required = Scale1 ∗ [F ∗ CP ∗ (COT − CIT) + f ∗ 𝜆 + ΔHR]∕𝜀 (10.8)
QF ≡ Heat fired = Scale2 ∗ HV ∗ FG (10.9)
Symbol Process Variable
Scale1 Scale factor that converts QR to desired EU
F Feed rate
𝜀 Heater efficiency (0–1)
CP Process stream effective heat capacity
COT Coil outlet temperature
CIT Coil inlet temperature
f Fraction of feed vaporized (0–1)
𝜆 Process stream heat of vaporization
ΔHR Heat of reaction
Scale2 Scale factor that converts QF to desired EU
HV Fuel gas heating value
FG Fuel gas flow
Notes: Heat Required (QR) Calculation, Equation (10.8)
1. Heater efficiency (𝜀), effective heat capacity (CP), fraction vaporized (f), heat of vaporization (𝜆),
and heat of reaction (ΔHR) are normally estimated by the PTS group or are chosen to be either
typical or design values, and then assumed constant.
2. For fired heaters that provide only process heat, ΔHR ≡0. (Remember, we are focused on fired
heaters providing process heat only; thus, this applies to all cases in this section).
3. For fired heaters that heat an all-vapor feed or in which no part of a liquid feed is vaporized,
𝜆≡0.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.4 Fired Heater Firing Controls 327
4. This calculation is used exclusively in FF control loops and therefore in almost all cases, good
estimates for the parameters 𝜀, CP, f , and 𝜆 are not prerequisites for using this calculation effec￾tively in the COT cascade.
5. We discuss the value chosen for COT in this calculation (COT controller PV, SP, or a typical or
design value) when we discuss feed rate and CIT FF controls in Sections 10.4.5, 10.4.7 and 10.4.8.
Notes: Heat Fired (QF) Calculation, Equation (10.9)
The source for fuel gas is the refinery’s fuel gas system, a series of headers that collect off gas and
tail gas from various units (light-ends towers, fractionators, amine scrubbers, and so on) that pro￾cess/produce these low molecular weight gases. During normal operations, but especially during
upsets, rapid and large changes in the composition of the gases sent to the fuel gas system can occur
and thus variations in fuel gas heating value are common and can make COT control difficult. This
is the main driving force for BTU control, and we will see the important role it plays in COT control
to compensate for these fuel gas composition changes in Sections 10.4.6 through 10.4.8.
1. Heating value can be measured directly via a Wobbe Index Analyzer or inferred using a relative
density analyzer measurement (the fuel gas molecular weight) which correlates well with heat￾ing value.
2. In either case (Wobbe or relative density analyzer), the measurement must be validity checked
before its use in the heat fired calculation.
3. When non-condensable (N2, SO2, or CO2) or low heating value gases (CO or H2S) are present
in the fuel gas, and their compositions are subject to variation, the Wobbe measurement is the
best measure of heating value.
4. The heating value used in the QF calculation is the lower heating value. This means we are
assuming the H2O produced in the combustion reactions remains in the vapor phase, and the
water’s heat of condensation is not included in the fuel’s heating value.
5. The sample point for the heating value analyzer may not be physically close to the heater that
needs the heating value for COT control. Although relatively rare, it may be necessary to dynam￾ically compensate the heating value measurement before its use in the heat fired calculation. In
our discussion of BTU control, we assume dynamic compensation is not necessary.
6. Fuel gas flow is sometimes pressure, temperature, and/or MW compensated to provide more
accuracy for energy utilization reports and/or refinery fuel balance calculations; compensated
fuel gas flow is very rarely used for control calculations.
7. Fuel oil heating value is relatively constant since its source is normally a fuel oil tank with large
hold-up. Thus, unlike fuel gas, a constant fuel oil flow delivers a relatively constant amount of
firing.
We begin our discussion of heater firing controls with several basic COT regulatory control strate￾gies (Section 10.4.3). We then look at several FF approaches that include compensation for feed rate,
CIT, and fuel gas heating value changes (Sections 10.4.4–10.4.7). We conclude with a discussion of a
dual fuel heater with fuel oil base loaded and fuel gas manipulated to control COT (Section 10.4.8).
10.4.3 Basic COT Regulatory Control
We now look at common basic COT regulatory controls used for fired heaters that are not subject to
frequent CIT or fuel gas heating value upsets, routine feed rate changes, or when tight COT control
is not always necessary. In other cases, measurements (such as CIT or fuel gas molecular weight)
required to implement more advanced approaches are not available, and the cost to make them
available cannot be justified. Four basic COT control cascades are shown in Figure 10.26.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License328 10 Heat Input/Heat Removal Controls
FC TC
PI
FI
Fuel gas header
(a) (b)
(c) (d)
TI
FC TC
PI
FC
Fuel gas header
TI
FC TC
PC
FI
Fuel gas header
TI
HSS
FC TC
PC
FC
Fuel gas header
TI
Figure 10.26 Four Basic COT Control Cascades. (a) COT → FG Valve Cascade. (b) COT → FG Pressure
Cascade. (c) COT → FG Flow Cascade. (d) COT → FG Flow, with Pressure Override
The simplest COT control strategy is shown in Figure 10.26a; the COT controller manipulates
the fuel gas valve directly. A fuel gas flow measurement may or may not be available; a fuel gas
pressure measurement is almost always available. Any upset must affect the COT measurement
before any corrective action is taken.
In Figures 10.26b and 10.26c, the COT controller is cascaded to the fuel gas pressure controller
and fuel gas flow controller, respectively. Any upset in the fuel gas line/header is handled by the
pressure or flow controller before the COT is affected. However, other upsets such as in feed rate
or feed composition, fuel gas composition, CIT, etc. must affect the COT measurement before any
corrective action is taken by the COT controller. The COT to pressure cascade has one small advan￾tage: if the pressure controller’s setpoint low limit (SPLL) is set to a minimum allowable pressure (to
avoid flame instability), standard DCS features will clamp the pressure at that value and hence pre￾vent it from falling below its minimum. However, low fuel pressure is also avoided when the COT
controller is cascaded to the fuel gas flow controller, via the low pressure override in Figure 10.26d.
There are no advantages for either the COT to pressure or COT to flow cascade; because standard Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.4 Fired Heater Firing Controls 329
DCS features can be used to avoid a low fuel gas pressure, pressure control is often preferred at low
firing rates.
Figure 10.26d shows the COT → fuel gas flow cascade with a low fuel gas pressure override (the
HSS). This strategy prevents the fuel gas pressure from dropping below the minimum allowable
value to avoid flame instability. During normal operations, the fuel gas pressure is above its
minimum pressure (PC SP) – the pressure controller consistently wants to close the fuel valve.
When pressure approaches or falls below the minimum, the pressure controller wants to open the
fuel valve, i.e., its output increases. Thus, when pressure is too low, the HSS will choose either the
pressure controller’s output to relieve the low pressure constraint or the flow controller’s output
if it is larger than the pressure controller’s output. In either case, the valve opens and pressure
increases. Note that if the pressure controller overrides the COT controller, the COT controller
will not meet its control objective and COT PV ≠ COT SP.
In most cases, a low pressure override is an indication that there are too many burners in ser￾vice, usually due to reduced heater throughput; operators then routinely take some burners out of
service. A low pressure override can also be an indication of equipment or measurement failure; if
so, a quick response is required to find and fix the problem.
Design Notes and Features (All cascades in Figure 10.26)
1. In the four COT control cascades shown in Figure 10.26, the COT controller is a cascade primary
whose SP is changed from time to time but must also respond to load upsets. Whether to tune for
best load (proportional on PV) or best SP (proportional on error or proportional on PV) response,
and whether SP Init should be “Yes” or “No” depends upon the heater’s service. Discussion with
operations before implementation is best.
2. The COT controller’s control direction is Reverse – if COT is increasing and/or is above its
set point, the COT controller must decrease its output to either decrease the flow or pressure
controller set point or close the fuel valve. Remember: The DCS handles the fuel gas valve’s
failure mode via output signal conditioning external to the PID output calculation.
10.4.4 Ratio Feed Rate Feedforward Control
The COT control strategies in Figures 10.27 and 10.28 incorporate ratio FF control for feed rate
changes into the basic COT regulatory control cascades illustrated in Figure 10.26b and 10.26c.
The additions, RC and FCG, are shown with grey shading and bold text. In Figure 10.27, the
ratio controller (RC) resets the fuel gas pressure controller’s setpoint, while in Figure 10.28, the
ratio controller resets the fuel gas flow controller’s setpoint. In both cases, the ratio controller’s
wild flow input is the dynamically compensated feed rate calculated by FCG’s lead/lag control
algorithm; it is stored to the designated location in FCG that holds FCG’s last control algorithm’s
calculation result. Ratio feed rate FF control is very common for fired heaters since their feed rates
are routinely changed.
Design Notes (Both COT → RC → PC and COT → RC → FC)
1. Each control strategy is a simple cascade – cascade initialization and wind-up are both handled
by standard DCS features
2. Design notes 1–2 for the COT controllers in Figure 10.26 are applicable for these two cascades.
3. The COT dynamic response to changes in feed rate is typically different than its response to fuel
gas pressure or flow. Thus, the feed rate is dynamically compensated (in FCG) using the lead/lag
control algorithm; the lead/lag result is stored to FGC’s designated dynamically compensated
wild flow input location.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License330 10 Heat Input/Heat Removal Controls
FC
PI
TI
FC
Fuel gas header
RC FCG
SP
Dynamic
compensation
TC
TI
Figure 10.27 COT → Pressure Cascade with Feed Rate FF Control
FC
PC
TI
FI
Fuel gas header
RC FCG
SP
Dynamic
compensation
TC
TI
Figure 10.28 COT → Flow Cascade with Feed Rate FF Control
4. If feed rate is controlled, FCG’s wild flow input can be either the feed rate PV or SP. The SP is
normally preferred to minimize feed rate noise propagation to the fuel gas. If the SP is used, it is
best to configure the feed rate controller for SP Init=Yes. If the feed rate controller is a cascade
secondary, then it is already configured for SP Init=Yes. Additional logic may be necessary to
switch FCG’s wild flow input to the feed rate PV when the feed flow controller is wound-up.
These features must be discussed with operations before final design and commissioning.
5. When a feed rate flow measurement becomes unavailable (flagged “Bad”), it must not adversely
affect the COT feedback loop. FCG’s design allows the last lead/lag control algorithm’s result to
be used after the measurement failure. Thus, the ratio controller’s compensated wild flow input
remains constant, and the COT cascade remains on control but without feed rate FF.
6. COT control must routinely continue if feed rate FF is turned Off via an FCG mode change – the
design of FCG ensures the feedback loop is unaffected when FF is turned Off or turned On.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.4 Fired Heater Firing Controls 331
7. Suitable logic must be provided to initialize the ratio controller when (i) feed rate FF is turned
On and (ii) a feed rate measurement becomes available after it has been unavailable. After the
ratio controller is initialized, standard DCS features initialize the COT controller.
8. Ratio feed rate FF control provides adaptive PID gain compensation for feed rate changes, i.e.,
it scales the COT controller’s gain by a factor that is roughly proportional to the feed rate.5
Design Notes (COT → RC → PC Cascade in Figure 10.27)
1. Ratio controller RC’s SP is the desired fuel pressure/feed ratio. Because the relationship between
feed rate and fuel gas pressure is nonlinear, the ratio controller must be configured as a PID. The
RC PV is calculated by dividing PC PV by FC PV. RC is a cascade secondary and thus it is tuned
for best SP response, proportional on error, with SP Init = Yes. Its control direction is Reverse – if
the ratio PV is increasing and/or above set point, it reduces the fuel gas flow by reducing fuel
gas pressure.
2. As previously mentioned, the pressure controller’s set point low limit ensures fuel gas pressure
remains above its minimum at all times.
Design Notes (COT → RC → FC Cascade in Figure 10.28)
1. The ratio controller’s SP is the desired fuel flow/feed ratio. Because the relationship between
feed rate and fuel gas flow is more linear, the ratio control calculation is normally algebraic, e.g.,
FC SP = RC SP * FCG’s stored compensated wild flow input. It is a cascade secondary and thus
it is configured with SP Init = Yes. If the PID option is preferred (not recommended), it is tuned
for best SP response, proportional on error, and configured for control direction = Reverse.
2. The low-pressure override shown in Figure 10.26d can also be included in this control strategy.
10.4.5 Feedforward Control for Both Feed Rate and CIT
We now illustrate how FF compensation for CIT changes/upsets can be included in COT control.
Unlike the feed rate, CIT is normally not controlled. Thus, inlet temperature upsets can be routine,
and frequent; if so, and if the CIT measurement is available, FF on CIT can be justified. Since the
CIT measurement is almost always a DTI point, it is validated before it is used in the control cascade.
The COT control strategy in Figure 10.29 incorporates FF compensation for both feed rate and CIT
changes/upsets into the basic COT regulatory control cascade in Figure 10.26d. The additions, TIV,
FCTIG, and RC are shown with grey shading and bold text. TIV validates the CIT measurement
before its use in the heat required calculation, FCTIG calculates and dynamically compensates the
heat required and RC is the fuel gas flow/heat required ratio controller.
Combined FF compensation for feed rate and CIT in FCTIG is based on the calculated variable
QR, the heat required (Ref. [1]) to raise the feed from CIT to COT (see Equation (10.8) in Section
10.4.2 with ΔHR ≡ 0):
QR ≡ Heat required = Scale1 ∗ F ∗ [CP ∗ (COT − CIT) + f ∗ 𝜆 ]∕𝜀
Remember: Scale1 is an EU scale factor, there are no reactions (heat of reaction ΔHR = 0) and CP
(feed heat capacity), f (fraction vaporized), 𝜆 (heat of vaporization) and 𝜀 (heater efficiency) are
estimated by the PTS group, entered once, and maintained constant. The validated (in TIV) CIT
measurement and either the feed rate PV or SP (SP normally preferred if feed rate is controlled) are
inputs to the QR calculation in FCTIG. As in feed rate FF control, the calculation of QR in FCTIG
provides adaptive COT controller gain compensation for feed rate changes.
5 See Section 3.4 in Chapter 3 for details.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License332 10 Heat Input/Heat Removal Controls
FC TI
Fuel gas header
PC FCTIG
FC
HSS
TIV
Validation
RC
SP
SP
TC
Heat required
calculation and
dynamic
compensation
TI
Figure 10.29 COT Control with Combined Feed Rate and CIT Feedforward Control
The heat required is then dynamically compensated before it becomes the ratio controller’s (RC)
wild flow input. This assumes that the COT’s dynamic response to changes in feed rate and CIT
are about the same. The ratio controller’s SP is reset by the COT controller and is the desired fuel
flow/heat required ratio. The ratio controller then sets the fuel gas flow controller’s SP – the fuel gas
flow demanded by the COT controller and current feed rate and CIT values. As discussed earlier
(Figure 10.26d) for fuel gas flow ultimate secondaries, a low-pressure override (HSS) is normally
included.
Design Notes and Features
1. The control strategy is a simple cascade – cascade initialization and wind-up are both handled
by standard DCS features.
2. Earlier design notes concerning the COT controller (tuning criteria, SP Init, control direction)
are applicable for this cascade as well.
3. The ratio controller’s SP is the desired fuel flow/heat required ratio. Because the relationship
between heat required and fuel gas flow is close to linear, the ratio control calculation is normally
algebraic, e.g., FC SP = RC SP * FCTIG’s stored lead/lag algorithm result.6 If the PID option is
preferred (not recommended), it is tuned for fast SP response, proportional on error with control
direction = Reverse. In either case, the ratio controller is a cascade secondary and thus it is
configured with SP Init = Yes.
4. If feed rate is controlled, FCTIG’s feed rate wild flow input can either be the feed PV or SP. To
minimize feed rate noise propagation to fuel gas, choose the SP. If so, configure the feed rate
controller for SP Init=Yes. If a cascade secondary, it is already configured for SP Init= Yes.
Additional logic may be necessary to switch to using the feed rate PV when the feed flow
controller is wound-up. These features must be discussed with operations before final design
and commissioning.
6 The last calculated value of the dynamically compensated heat required.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.4 Fired Heater Firing Controls 333
5. FF loop problems must not adversely affect the feedback loop (COT control). Potential FF loop
problems are: (i) a feed measurement becomes unavailable or (ii) CIT is unavailable or declared
invalid by TIV. Since the feed rate and CIT are used in an FF control loop, the last “Good” value
of each is used if the measurement becomes unavailable or is declared invalid. Thus, FCTIG’s
design allows FF control to continue when the feed rate and/or the inlet temperature measure￾ments fails or are invalid. If one measurement fails, FF compensation for the remaining valid
variable continues, and when both fail, there is no FF compensation for either feed rate or CIT.
However, in each case, COT control continues.
6. Heat required FF is turned On and Off by a FCTIG mode change – Manual → Auto (On)
and Auto → Manual (Off). In manual mode, FCTIG’s lead/lag algorithm does not execute;
thus, the last calculated value of QR stored in FCTIG is used, there is no FF compensation for
either feed rate or CIT, but COT control continues. Transferring FCTIG to auto mode turns
heat required FF on; fresh values of QR are again calculated, and last calculated value of QR is
updated.
7. Suitable logic must be provided to initialize the ratio controller when (i) heat required FF is
turned On or (ii) an unavailable feed rate measurement becomes available or (iii) an unavailable
or invalid CIT measurement becomes available or is declared valid. After the ratio controller
initializes, standard DCS features initialize the COT controller.
8. If the ratio controller outputs to a fuel gas pressure controller (instead of flow controller), it
must be configured as a PID controller, tuned for best SP response, proportional on error, with SP
Init = Yes, and control direction = Reverse.
9. With fuel gas flow the ultimate secondary, the low fuel gas pressure override HSS is included.
If the ratio controller outputs to a fuel gas pressure controller, then the pressure controller’s set
point low limit ensures fuel gas pressure is above its minimum.
The “COT” value used in the calculation of QR cannot be the COT PV and should not be the COT
SP. If the COT PV is used, and the COT PV increases (ΔCOT PV>0), referring to Equation (10.8),
ΔQR is also positive. Thus, the ratio controller’s wild flow increases, and RC will then increase
fuel flow – the correction is in the wrong direction. If the COT SP is used, and COT SP increases,
ΔQR is again positive, and the ratio controller (correctly) increases fuel flow. Even if tuned for
best load response, the COT controller also responds to its set point’s increase and increases the
ratio controller’s SP. The two corrections combine to overcorrect for the COT SP change. Detuning
the COT controller for SP changes is one possibility (tune for best load change, proportional on
PV). However, it is best to use a “typical” or design value (supplied by the PTS Group), or the
COT PV value whenever the ratio controller initializes, and maintain it constant in all subsequent
calculations. This allows the COT controller to respond to COT PV or COT SP upsets/changes, and
the FF loop to respond to feed rate and CIT changes/upsets.
If COT dynamic responses to feed rate and CIT changes have observable differences, each
can be dynamically compensated with their individual COT response dynamics as illustrated
in Figure 10.30 (feed rate in FCG, CIT in TIG). For many fired heaters, this is not the case and
this approach is usually not necessary. However, the approach in Figure 10.30 has the following
advantage: it allows operators to turn off feed rate FF and CIT FF individually, while heat required
FF and COT control remain on control. For example, if an operator turns Off feed rate FF, i.e.,
transfers FCG from auto to manual mode, heat required FF continues for CIT changes only, with
feed rate held constant at its last “Good” value. When feed rate FF is turned On by transferring
FCG to auto, the ratio controller is initialized (via user provided code), and after the initialization
of the COT controller (via standard DCS features), full heat required FF resumes. Note: Heat Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License334 10 Heat Input/Heat Removal Controls
Feed CIT
FC
TIV
FCG TIG
RC FCTIG
FC
TC
Fuel gas
Dynamic
compensation
Validation
SP
SP
Heat
required
calculation
TI
Figure 10.30 COT Control, Combined Feed Rate
and CIT Feedforward Control, Individual Feed Rate
and CIT Dynamic Compensation
required FF for both feed rate and CIT can be turned Off/On by transferring FCTIG from Auto to
Manual/Manual to Auto mode.
10.4.6 BTU Control: Feedforward Corrections for Fuel Gas Heating Value Upsets
We now incorporate FF corrections for fuel gas heating value changes, caused by fuel gas compo￾sition upsets, into the COT control cascade; this is historically called “BTU Control”. BTU control
can enhance any of the basic COT regulatory control cascades in Figure 10.26. As an example, we
will use the COT control strategy in Figure 10.28 that includes feed rate FF control and has the fuel
gas flow controller as ultimate secondary. As shown in Figure 10.31, a duty or heat fired controller
(QC) is placed between the ratio controller and the fuel gas flow controller in the COT cascade.
The heating value analyzer measurement is validity checked (in AIV) before it provides the heat￾ing value (HV) used in the heat duty calculation. These two additions to the COT cascade provide
compensation for heating value changes.
The heat duty or heat fired (QF) PV is calculated using Equation (10.9) discussed earlier in Section
10.4.2:
QF ≡ Heat fired = Scale2 ∗ HV ∗ FG
Therefore: QC PV = Scale2 ∗ AIV last good value ∗ FG PV (10.10)
Scale2 is the EU scale factor that ensures QF’s units are consistent with other calculations. The
Wobbe analyzer or relative density analyzer measurement is validity checked (in AIV). The val￾idated value is stored to the designated location in AIV that holds AI PV’s last good value – the
heating value input source for the heat fired calculation. Note that the measured fuel gas flow
(FC PV), not the flow controller SP, is used to calculate the firing rate, making it dependent on
the actual volume of fuel being delivered. Thus, QC PV will become unavailable when the fuel
flow measurement is unavailable. Note: When the heat duty controller is configured as a PID,
fuel gas measurement noise is propagated to the fuel’s set point calculation via QC PV. If the
heat duty control calculation is algebraic, QC SP, not QC PV, is used and hence fuel gas noise has
no impact.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.4 Fired Heater Firing Controls 335
FC
RC FCG
SP
SP Validation
Dynamic
compensation
TC
TI
AI
Fuel gas header
FC
QC AIV
LHV
FG
flow
SP
TI
HSS
PC
Figure 10.31 COT Control, BTU Control and Feed Rate Feedforward Control
In this cascade, the ratio controller’s SP, calculated by the COT controller, is the desired fir￾ing to feed ratio. The ratio controller calculates the heat fired controller’s SP; this is the firing
rate demanded by the COT controller. The heat fired controller then calculates the fuel gas flow
controller SP; this is the fuel gas flow that delivers the firing rate demanded by the COT controller.
Design Notes and Features
1. Important: The fuel gas flow is a requirement for BTU control. The ultimate secondary can be a
fuel gas pressure controller or the fuel gas control valve, but the fuel gas flow must be available
to calculate the heat fired, QC, using Equation (10.10).
2. All design notes and features presented in Section 10.4.4 (COT Control with Feed Rate Feedfor￾ward Control), which apply to the COT and ratio controllers are valid for the control strategy in
Figure 10.31.
3. Since the ultimate secondary is the fuel gas flow controller, the duty control calculation can be
algebraic: FC SP = QC SP/[Scale2 * AIV last good value]. However, the duty controller is usually
implemented as a PID. If the ultimate secondary is the fuel gas pressure controller, the duty
controller must be a PID. The duty controller is a cascade secondary, and thus, whether it is an
algebraic or PID calculation, it is configured for SP Init = “Yes”. If implemented as a PID, it is
tuned for best SP response, proportional on error, with control direction = “Reverse”.
4. When the Wobbe analyzer or relative density analyzer measurement becomes unavailable or is
declared invalid by AIV, the COT feedback loop is not affected. Since the heating value is used
for FF control, its last “Good” value is used when the measurement is unavailable or is declared
invalid. This ensures that COT control continues but without BTU control.
5. The AIV design allows an operator to turn heating value FF compensation Off – by transfer￾ring AIV from Auto to Manual modes, without affecting the COT feedback control. In Manual Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License336 10 Heat Input/Heat Removal Controls
mode, AIV’s last good value storage location is not refreshed. Hence, there is no FF compen￾sation for heating value changes, but the BTU controller continues to execute, using the last
(now constant) validated heating value. Thus, COT control continues even if heating value FF
compensation is turned Off.
6. Suitable logic must be provided to initialize the heat duty controller when (i) heating value FF
is turned On (AIV transferred to Auto mode) or (ii) an unavailable or invalid heating value mea￾surement returns available or valid once again. After the duty controller initializes, standard
DCS features initialize the ratio and COT controllers.
7. The low fuel gas pressure override enforces the low fuel gas pressure minimum constraint
(PC SP).
10.4.7 BTU Control with Combined Feed Rate and CIT Feedforward Control
BTU control can also be incorporated into the COT control strategy in Figure 10.29 (COT Con￾trol with Combined Feed Rate and CIT Feedforward Control). A BTU (duty) controller is placed
between the ratio controller and the fuel gas flow controller, with heating value analyzer mea￾surement validity checking. These two additions to the COT cascade provide FF compensation for
heating value changes.
The resulting COT control cascade appears in Figure 10.32. Comparing Figure 10.32 with
Figure 10.29, the fundamental difference is that the ratio controller’s SP, reset by the COT con￾troller, is the desired firing/heat required ratio, not the desired firing/feed ratio. So, instead of FCG
dynamically compensating the feed rate (as in Figure 10.31), in Figure 10.32, FCTIG dynamically
compensates the heat required.
The following previously explained/discussed design notes and features are valid for the control
strategy in Figure 10.32.
FC
AI
TI
Fuel gas header
FCTIG
AIV
Validation
TIV
Validation
TI
LHV
PC
FC
HSS
RC
SP
QC
SP
TC
FG
flow
SP
Heat required
calculation and
dynamic
compensation
Figure 10.32 COT Control, BTU Control, and Combined Feed Rate and CIT Feedforward Control
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License10.4 Fired Heater Firing Controls 337
1. All design notes (except #3) in Section 10.4.5 (Feedforward Control for Both Feed Rate and
CIT).
2. Heat duty controller details, the heat fired (QF) calculation, and design notes in Section 10.4.6
(BTU Control: Feedforward Corrections for Fuel Gas Heating Value Upsets).
10.4.8 Dual Fuel Fired Heaters: Importance of BTU Control
We now illustrate how the control strategy in Figure 10.32 is modified for a dual fuel fired heater.
Both fuel gas and fuel oil are burned, and the heat generated by both fuel’s combustion reactions
is absorbed by the process fluid as it flows through the heater’s tubes. BTU control improves COT
control in dual fuel fired heaters because it provides FF corrections to the manipulated fuel for
base-loaded fuel flow rate changes.
We now consider by far the most common dual fuel fired heater, e.g., with fuel oil base loaded
and fuel gas manipulated to control COT. The control strategy is shown in Figure 10.33. The only
additions (shown with grey shading and bold text) to the control strategy in Figure 10.32 are those
that enable both fuels to be incorporated into the duty controller’s PV and control calculations.
The COT controller’s ultimate secondary is the fuel gas flow; the fuel oil rate is fixed, e.g., base
loaded, on flow control. Because the fuel oil source is normally from tankage, fuel oil heating values
are relatively constant. Thus, a value provided by the PTS Group is manually entered and main￾tained constant in the heat fired calculation until a new value is provided and entered. For a dual
fuel fired heater, the heat fired calculation is augmented to include the contribution of the second
fuel (fuel oil in this case):
QF ≡ Heat fired = Scale2 ∗ HVFUEL GAS ∗ FG + Scale3 ∗ HVFUEL OIL ∗ FO
QC PV = Scale2 ∗ AIV last good value ∗ FG PV + Scale3 ∗ FO HV ∗ FO PV (10.11)
Required firing
calculation and
dynamic
compensation
FC TI
TI
Fuel gas header
SP
Validation
TC
AI
FC
PC
FC HSS
Fuel oil
FO HV
SP
RC
QC
SP
FG
LHV
FG
flow
FCTIG
AIV
Validation
TIV
LHV
FO flow
Figure 10.33 Dual Fuel Heater, Fuel Oil Base Loaded, Fuel Gas Manipulated
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License338 10 Heat Input/Heat Removal Controls
Scale2 and Scale3 are scale factors that convert fuel gas and fuel oil heat fired to consistent, desired
engineering units. The fuel gas heating value measurement is validity checked (in AIV), and the
fresh, current value is used in the calculation of heat fired. The same value of fuel oil heating value
is used until a new value is manually entered. Measured fuel gas (FC PV) and fuel oil (FO PV) flows
are used to calculate firing rate (QC PV) so that the heat fired calculation will respond to an unavail￾able fuel flow measurement. As before, the downside is the propagation of fuel flow measurement
noise to the fuel gas flow set point calculation when the heat duty controller is configured as a PID.
The cascade structure in Figure 10.33 is the same as the single fuel heater strategy discussed in
Section 10.4.7 and shown in Figure 10.32; thus, all design notes and features discussed/presented
there apply to the strategy presented in Figure 10.33. Additional design notes and features follow.
Design Notes and Features
1. A new fuel oil heating value, entered manually, must pass a “reasonableness” test before it
becomes the value used in the heat duty calculation. For example, is it (i) within the normal
expected range and (ii) not too different from the current value it replaces?
2. Logic must be provided to initialize the heat duty controller QC whenever a new fuel oil heating
value is manually entered. After the duty controller initializes, standard DCS features initialize
the ratio and COT controllers.
3. In addition to fuel gas heating value changes, the duty controller provides FF compensation for
fuel oil baseload changes (FO SP).
4. If operational changes routinely require changes in the specific fuel base loaded (e.g., COT
controller’s ultimate secondary is switched), logic must be provided to make the switch auto￾matic. The switch logic must include the following tasks: (i) change ultimate secondary modes
(Cascade → Auto and Auto → Cascade) as appropriate, (ii) if the heat duty controller (QC) is
a PID, change its proportional gain (secondary has different steady state gain and instrument
range), and (iii) force initialization of the heat duty controller. After the duty controller is ini￾tialized, standard DCS features initialize the ratio and COT controllers.
Reference
1 King, M. (2010). Process Control: A Practical Approach, 223–225. Chichester: Wiley.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License339
11
Energy Conservation Controls
CHAPTER CONTENTS
11.1 Heat Recovery Maximization
11.1.1 Crude Fractionator Feed Preheat
11.1.2 Flow Distribution to Parallel Heat Exchangers
11.1.3 Catalytic Reformer Reactor Effluent Heat Utilization
11.1.4 Distillate Hydrofiner Reactor Effluent Heat Utilization
11.2 Lowering Fired Heater Stack Excess O2 Targets
11.2.1 Combustion Control Air Side Measurements
11.2.2 Natural Draft Heater Combustion Control
11.2.3 Forced Draft Heater Combustion Control
11.3 Reducing Tower Reboiler Duty and Reflux Flow
11.3.1 Crude Light-ends Section: Naphtha Splitter Fractionation Control
11.3.2 Aromatics Plant: Toluene Tower Fractionation Management
11.3.3 Light-ends Tower Pressure Minimization
11.4 Reducing Stripping Steam Utilization
11.4.1 Primary Fractionator (CDU) Bottoms Product Steam Stripping
11.4.2 Primary Fractionator (CDU) Sidestream Steam Stripping
11.4.3 Sour Water Steam Stripping
11.5 Reducing Steam Consumption in Amine Gas Treating Units
11.5.1 Scrubber and Regenerator Controls
11.5.2 Kerosene Hydrofiner Treat Gas Scrubber Feed Minimization
11.6 Reducing Reactor Treat Gas, Recycle Gas Flows
11.6.1 Gas Oil Hydrofiner Reactor Treat Gas and H2 Make Gas Minimization
11.6.2 Catalytic Reformer Reactor Recycle Gas Minimization
11.6.3 Naphtha Hydrofiner Reactor Treat Gas and H2 Make Gas Minimization
References
Petroleum refineries and petrochemical plants use significant amounts of energy in almost
all process areas and operating units. There have been significant cost reduction incentives to
better manage energy utilization since the large increases in energy costs in the early 1970s.
Changes in operations, modifications to existing equipment, and new equipment designs have
played an important role in achieving this objective. In this chapter, the focus is on conventional
advanced control strategies that reduce energy utilization with no capital investment other than,
when appropriate, new instrumentation. Although spanning a wide variety of processes and
unit operations, the control strategies presented reduce energy utilization by (i) reducing fuel
consumption, both directly and indirectly, in fired heaters, (ii) reducing process steam utilization,
and/or (iii) reducing compression costs.
Practical Process Control Design with Industrial Applications, First Edition. Alan M. Kugelman.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License340 11 Energy Conservation Controls
The control strategies are organized into six operating objectives that when achieved, reduce
energy utilization and capture energy conservation (ENCON) credits:
1. Maximize heat recovery from hot to cooler process streams.
2. Lower fired heater stack excess O2 targets to improve heater efficiency.
3. Reduce tower reflux flow and reboiler duty.
4. Reduce stripping steam utilization.
5. Reduce steam consumption in amine gas treating systems.
6. Reduce reactor treat gas, recycle flows.
The combustion controls that enable lower stack excess O2 operations capture ENCON credits by
directly reducing fuel consumption. A large portion of the ENCON credits associated with the other
five operating objectives are also captured by (indirectly) reducing fired heater fuel consumption.
For example, in many cases, heat recovery from one or several hot process streams to a feed stream
is possible via heat exchange upstream of a fired heater in feed preheat service. Improved heat
recovery in the upstream exchangers reduces the heat duty requirement and thus fuel consumption
in the downstream fired heater. In addition, a large proportion of the process steam used for strip￾ping, or as heating medium for some tower reboilers, is produced in fired heaters (boilers). And,
finally, reactor treat gas and/or recycle gas are often preheated in fired heaters, and reducing their
flows reduce fuel consumption in the downstream fired heater. Treat gases and recycle gases are
often compressed, so reducing their volumetric flows also decreases compression costs.
11.1 Heat Recovery Maximization
Process unit designs that incorporate heat integrations to recover significant amounts of process
generated heat have proven operating and investment cost advantages. In Chapter 10, Section
10.3, the control strategies implemented in heat integrated units illustrate how process interac￾tions and potential upsets make process control more difficult and effective control strategies
more complicated. These strategies achieved various unit operating objectives, but they did not
explicitly exploit heat integrations to minimize energy costs. By maximizing heat recovery to
tower, reactor, or fired heater feed streams, fired heater fuel consumption and/or heat losses to
water and/or air in downstream heat exchangers are reduced. In this section, several control
strategies are presented and discussed that achieve their operating objectives by maximizing
heat recovery.
11.1.1 Crude Fractionator Feed Preheat
A crude fractionator, either a crude distillation unit (CDU) or vacuum pipestill (VPS), uses
substantial high temperature process heat and large quantities of superheated steam. A simplified
CDU configuration was discussed in Chapter 10, Section 10.1.3 (Figure 10.3). In that configuration,
crude oil is first pumped through a series of heat exchangers and then to a fired heater to raise the
crude temperature high enough to vaporize products removed above the feed tray, e.g., overhead
(naphtha), and kerosene and distillate sidestream products. Substantial heat is recovered to crude
in the upstream exchangers by heat integration with hot process streams. The more heat recovered
by crude, the lower the fired heater’s duty, and hence the lower the fuel consumption to meet
the fired heater’s coil outlet temperature (COT) target. The COT target impacts sidestream yields,
especially the bottom sidestream’s yield, and overhead condenser and pumparound duties.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.1 Heat Recovery Maximization 341
In the example discussed in Chapter 10 (Figure 10.3), CDU overhead, sidestream draw offs,
pumparounds, and tower bottoms all exchange heat with the crude. In more realistic
configurations, crude exchanges heat with streams generated in downstream units and various
product rundown streams as well. Note that as crude preheat proceeds, crude must be heat
integrated with process streams at progressively higher temperatures to maintain a sufficient
driving force for heat transfer.
Because a fired heater’s duty in CDU preheat service is substantial, and its investment costs large,
there are substantial incentives to reduce the preheat heater’s duty by maximizing heat recovery to
crude in upstream units. As illustrated in the two examples that follow, crude preheat heat recovery
in individual sections of the preheat train is often limited by one or more process and/or operational
constraints.
Figure 11.1 shows the portion of a CDU’s (T-109) preheat train upstream of the crude desalter
(D-15).1 Crude flows first to overhead condenser E-173, then to T-109 top pumparound (TPA)
exchanger E-170, and finally to other exchangers before flowing to D-15. Closing crude bypass valve
TV324 so that less crude bypasses E-173 increases heat recovery to crude in E-173 and reduces heat
lost to air in E-174. TV324 is manipulated by TC324 to control E-170 cold side (crude) outlet tem￾perature. E-170 cold side outlet temperature is increased by increasing heat recovery to crude in
E-173. Thus, an operating objective is to maximize E-170 crude outlet temperature (TC324 SP).
Crude exiting E-170 is heated further via other downstream exchangers before entering Desalter
D-15. Crude desalting minimizes downstream fouling and corrosion caused by salt deposition
T
1
0
9
D-15
D-35
TC
306
TV306
Desalter
Crude
distillation
unit (CDU)
E-174
E-173
TV324
Crude
Further crude
preheat
T-109
top P/A
TC
324
E-170
TI
344
TI
340
∞
Figure 11.1 CDU (T-109) Feed Preheat Configuration Upstream of Crude Desalter
1 In Chapter 7 (Section 7.4), this application was used to introduce characteristics and attributes of conventional
constraint control.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License342 11 Energy Conservation Controls
on heat transfer surfaces, and downstream acid formation due to chloride salt decomposition.
Depending upon the crude composition, desalter efficiency can be limited by high temperatures.
For D-15, there is an operating temperature above which desalter efficiency is too low to insure
sufficient crude desalting. Thus, a second operating objective is to maintain the desalter’s inlet
temperature (TI340 PV) below the maximum value that insures acceptable desalting.
As E-173 duty increases, T-109 overhead vapor temperature (TI344 PV) decreases. However,
TI344 PV must remain above the overhead stream’s dew point to minimize corrosion in the
overhead line. Also, as TI344 PV decreases, E-174 outlet temperature controller (TC306) reduces
E-174 duty to maintain TC306 PV at its SP; less heat is lost to air as a result. Therefore, other
operating objectives are to maintain TI344 PV above its minimum value to avoid corrosion in the
overhead line, and/or to maintain TC306 at E-174 outlet in controlling range – TC306 OP (air
louvre position, TV305) above its minimum value.
Therefore, to achieve these operating objectives, the control strategy must maximize E-170 cold
side outlet temperature (TC324 SP) subject to maximum desalter inlet temperature (TI340 PV),
minimum overhead temperature (TI344 PV) and minimum TC306 controller output (TC306 OP)
constraints. TC324 SP affects all three constraint variables – for an increase in TC324 SP, crude flow
to TV324’s bypass branch decreases, crude flow to E-173 increases, and E-173 duty increases:
● D-15 inlet temperature TI340 PV increases, moving it toward its (max) constraint limit
● Overhead temperature TI344 PV decreases, moving it toward its (min) constraint limit
● E-174 duty decreases, TC306 PV tends to decrease, and TC306 OP moves toward its (min) con￾straint as it corrects the air louvre position (TV306) and returns TC306 PV to set point.
The conventional constraint control strategy in Figure 11.2 achieves the control objective
described above. Each constraint variable (TI340, TI344, and TC306 OP) has its own dedicated
PID controller (TC340, TC344, and VTC306 respectively). Each PID tries to adjust the single
manipulated variable (MV), TC324 SP, to drive its PV value to its constraint limit (TC340 SP, TC344
SP, and VTC306 SP respectively). The strategy increases TC324 SP (and therefore heat recovery to
crude in E-173) until one of the three constraint variables reaches its constraint limit (the active
constraint) while keeping the other two out of violation.
TC
324
TC340 TC344 VTC306
Desalter inlet
temperature
Max desalter
inlet temperature
SP SP SP
Ovhd
temperature
Min Ovhd
temperature
TC306
valve position
Min TC306
valve position
LSS
E-170 outlet
temperature
SP
TV324
Crude flow
to E-170
E-173
bypass flow
Crude flow
from E-173
TIV340 TIV344 TV306 TI
344
TI
340
Validation Validation
Figure 11.2 Maximizing Heat Recovery to Crude in T-109 Overhead Condenser E-173
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.1 Heat Recovery Maximization 343
Note: An increase in TC324 SP (the MV) will drive all three constraint variables toward their
constraint limits – TI340 PV increases (max constraint), TI344 PV decreases (min constraint) and
TC306 OP decreases (min constraint). Consequently, the low signal selector (LSS) included in
Figure 11.2’s constraint control strategy follows directly from the rules developed in Section 7.4.4.
The control action demanded by the three constraint variable PIDs in Figure 11.2 (TC340 OP,
TC344 OP, and VTC306 OP) output to the LSS which chooses the smallest of the three PID outputs,
and sends it to the E-170 cold side outlet temperature controller’s SP (TC324 SP).
Design Notes and Features
1. The control strategy in Figure 11.2 is a complex cascade and custom logic must be provided to
handle cascade initialization and wind-up above the LSS.
2. Each PID is tuned for its own response dynamics to changes in TC324 SP. Because their SPs
(constraint limits) are almost never changed, all three constraint variable PIDs are tuned for
best load response, proportional on PV with SP Init = No.
3. For TC340, when desalter inlet temperature TI340 PV is increasing and/or is above its max limit,
controller output must decrease TC324 SP and, therefore, TC340 is configured with control direc￾tion = Reverse. For TC344, when overhead temperature TI344 PV is decreasing and/or is below
its min limit, controller output must decrease TC324 SP and therefore TC344 is configured with
control direction = Direct. Finally, for VTC306, when TC306 OP is decreasing and/or below
its minimum value, controller output must decrease TC324 SP and therefore VTC306 is also
configured with control direction = Direct.
4. Three-way valve TV324 is manipulated by TC324 to vary E-173 duty to maintain TC324 PV at set
point. As discussed in Section 10.2.1, a three-way valve in exchanger bypass service typically fails
with the feed branch closed and the bypass branch open – see Figure 10.6 in Section 10.2.1. As
explained in Section 10.2.1 (Figure 10.6 through Figure 10.9), proper configuration of TV324’s
analog output block’s output direction ensures TC324’s control direction can be specified inde￾pendent of TV324’s failure mode. Thus, with TC324 OP’s characteristic shown in Figure 11.3
(equivalent to Figure 10.6), if TC324 PV is increasing and/or is above its set point, TC324 OP
must decrease to increase TV324 bypass branch % open and decrease TV324 feed branch % open;
this decreases E-173 duty. Thus, TC324’s control direction = Reverse.
E-173 bypass
branch % open
0% 50% 100%
Max feed
flow
TC324 OP
Max bypass
flow
Min bypass
flow
E-173 feed
branch % open
Min E-173
feed flow
Figure 11.3 TC324 OP Characteristic, TV324 Fails with Feed Branch Closed, Bypass Branch Open
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License344 11 Energy Conservation Controls
5. Both TI340 PV and TI344 PV are externally multiplexed measurements and thus both are
validated (in TIV340 and TIV344 respectively) before their use in the control strategy.
6. TI340 PV and TI344 PV are TC340 and TC344 PID PV inputs, respectively. Thus, TC340 PV and
TC344 PV must be set “Bad” when either TI340 PV or TI344 PV is declared invalid (via logic
in TIV340 or TIV344 respectively). In both cases, control action stops, and controller output is
frozen. A console display indication is normally included in the operator interface to indicate
the TI point that has failed.
7. When either TC340 or TC344’s PV is set “Bad”, its control action stops, and its output is frozen.
Custom logic must either decommission the entire control strategy or allow the control strat￾egy to remain commissioned with one less constraint variable. If it remains commissioned,
additional logic must be provided to re-commission the entire cascade bumplessly when the
TI point returns “Good”. Whether or not the entire control strategy is decommissioned when
one TI point is invalid, and how recommissioning takes place (automatically or by operator
action) must be discussed with operations before final design and implementation.
8. When either TI340 or TI344 returns valid, as a minimum, TC340 or TC344 must be initialized,
and TC340 OP or TC344 OP set equal to the current value of TC324 SP by user provided custom
logic. Because TC340 and TC344 are both configured for SP Init = No, initializing either may
bump TC324 SP. If a TC324 SP bump is unacceptable, then configure both for SP Init = Yes, but
provide custom logic/code to ramp their set point back to the process technical service (PTS)
specified max (TC340) or min (TC344) value.
9. To prevent wind-up of the non-active control variable (CV) controllers, logic must be provided
to reset non-active CV controller outputs to the active constraint variable’s controller output
on every normal control execution pass.
10. The operator interface indicates which constraint variable is the active constraint. A constraint
variable “switch history” display is useful to detect noise problems.
Identifying Potential Constraints: Another Typical Example
Typically, there are multiple heat exchangers in a main fractionator’s pumparound circuit.
We have already seen examples in Sections 10.3.1 (Figure 10.17), 10.3.2 (Figure 10.19), and 10.3.3
(Figure 10.22). However, in Figure 11.1, other than the E-170, no other process information is
provided about T-109’s TPA configuration. As heat recovery to crude in E-173 is maximized, E-170
cold side (crude) inlet temperature increases and the driving force for heat transfer in E-170,
from TPA to crude, is reduced. As E-170 duty decreases, E-170 hot side (TPA) outlet temperature
increases. Thus, it is assumed a decrease in E-170 duty, and the increase in E-170 hot side (TPA)
outlet temperature has no adverse process or economic consequences for TPA operations. If this is
not so, any potential downstream TPA constraint needs to be included in the E-173 heat recovery
maximization strategy in Figure 11.2.
The control adjustments made to maximize heat recovery to crude in E-173 do not affect TPA
draw-off flow or temperature. Also, it is assumed TPA return temperature remains on control,
meaning the heat exchanger(s) downstream of E-170 whose duty is manipulated to control TPA
return temperature remain in controlling range. If not, the return temperature controller’s output
is another potential constraint that needs to be included in the E-173 heat recovery maximization
strategy in Figure 11.2. With TPA draw off flow and temperature unchanged, and return tempera￾ture held at setpoint, TPA duty is constant and thus fractionation in T-109 is in principle unaffected
by maximizing heat recovery to crude in E-173.
There is also no information provided about the hot side process streams that exchange heat
with crude downstream of E-170. Again, it is necessary to ensure that any potential constraints are Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.1 Heat Recovery Maximization 345
E-111
E-133
E-191
P-110
P-112
Feed
1st
side stream
draw-off
Crude
D-105 LC
105
TV132
FC
35 TC
132
P-11
Top
pumparound
(TPA)
FV103
FC
15
FC
130
FI
103
TC
106
Kero back-end
product quality
control
TI
177
T
1
0
5
Figure 11.4 CDU Pumparound, Overhead and First Sidestream Configuration
identified and included in the control strategy. Note that process upsets in these exchangers affect
TI340 PV directly and Figure 11.2’s control strategy must be able to respond effectively to them.
Responses to these upsets may reduce the heat recovery to crude possible in E-173.
Remember: It is always necessary to ensure all potential constraints are identified and included
in a constraint control strategy. As the number of constraint variables increase, and especially if
multiple independent variables have significant constraint variable sensitivities, a multivariable
constraint controller such as DMC becomes the best choice.
Next, consider the CDU (T-105) TPA configuration in Figure 11.4, which includes a pumparound
exchanger (E-111) heat integrated with crude feed. First sidestream draw-off becomes the kerosene
product after steam stripping in a sidestream stripper to remove light hydrocarbons, and further
processing in the kerosene hydrofiner (KHF) to remove residual sulfur. The kerosene product’s
back-end quality (e.g., smoke point or 95% distillation point) target is typically met by manipulating
the sidestream draw-off flow FC35. The kerosene’s front-end quality (e.g., flash or 5% distillation
point) target is typically met by manipulating the sidestream stripper’s stripping steam flow rate.
An example is presented in Section 11.4.2 – see Figure 11.29.
One of T-105’s operating objectives is to maximize TPA flow (FC130 SP). Note that as the TPA
duty increases, overhead vapor, external reflux flow (FI103 PV), and internal reflux above the return
tray all decrease; this degrades fractionation above the pumparound return tray. On the other hand,
by increasing TPA flow, heat recovered by crude in E-111 is increased, although the heat recovered
by crude is limited high by a bypass valve position constraint (TC132 OP or TV132). TV132 is a Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License346 11 Energy Conservation Controls
three-way valve, and TV132 OP’s relationship to TC132 OP is equivalent to the TC324 OP – TV324
characteristic presented in Figure 11.3. As TPA flow increases, TC132 PV tends to increase, and
in response, TC132 OP increases to reduce E-111 bypass flow and increase TPA feed to E-111.
Consequently, E-111 duty increases as does the heat recovered by crude in E-111. But, if the bypass
branch % open approaches full closed (→ 0%) and/or the feed branch % open approaches full open
(→ 100%), E-111 duty becomes limited high. This prevents further TPA flow increases, and limits
the heat recovered by crude in E-111.
So as TPA flow and heat recovered by crude in E-111 increase, overhead vapor, external reflux
flow, and internal reflux flow above the return tray, all decrease. However, there must be enough
internal reflux above the first sidestream draw-off tray to meet the draw-off flow target (FC35 SP)
demanded by the kerosene back-end quality controller. Consequently, TPA flow and heat recovered
by crude in E-111 are constrained high by insufficient internal reflux flow above the first sidestream
draw-off tray.
Therefore, the control strategy must maximize T-105 TPA flow (FC130) as limited by: (i) a
maximum allowable TC132 OP, i.e., a low E-111 cold side bypass branch % open (maximum TC132
OP), or (ii) a minimum internal reflux flow above the first sidestream draw-off tray. Measurements
needed to calculate the internal reflux flow above the TPA draw-off tray, i.e., overhead (TC106 PV)
and reflux temperatures (TI177 PV), and external reflux (FI103 PV), are all available.
Increasing FC130 SP (at constant TPA return temperature TC132) tends to increase TC132 PV.
In response, TC132 OP increases to decrease E-111 bypass flow and increases TPA feed to E-111;
this increases E-111 duty. As FC130 SP continues to increase, TC132 OP continues to increase and
move toward its (max) constraint limit – TC132 OP → 100% (bypass branch % open → 0%, the feed
branch % open → 100%). Also, increasing FC130 SP will tend to decrease internal reflux above the
sidestream draw-off tray, moving it toward its (minimum) constraint limit. Since both constraint
variables are driven toward their constraint limit by an MV (FC130 SP) increase, a conventional
constraint control strategy with a LSS is applicable. Thus, the strategy in Figure 11.5 achieves the
control objective described above.
The two constraint variables (TC132 OP and FC103 PV) each has its own dedicated PID con￾troller (VTC132 and FC103 respectively). Each PID tries to adjust the single MV, FC130 SP (via
RC130 SP), to drive its PV value to its constraint limit (VTC132 SP and FC103 SP respectively).
The LSS chooses the smallest of the two PID outputs to send to RC130 SP, the TPA flow/feed ratio
controller. RC130 provides feedforward (FF) compensation for T-105 feed rate (FC15) changes. If
feed rate is not routinely changed during normal operations, or if feed rate changes have minor
effect on tower operations, then feed rate FF is not needed, and the LSS would output directly to
FC130 SP.
Dynamic compensation of feed rate (in FCG15) is needed because both constraint variable’s
response dynamics to TPA flow changes (the MV) are different (slower) than their response dynam￾ics to feed rate changes (the disturbance variable, DV). Because the constraint variable response
dynamics are almost certainly different, the arithmetic average of the individual constraint vari￾able lead (responses to TPA flow changes) and lag (responses to feed rate changes) time constants
are used in FCG15. The time constant averages are acceptable because they are used in FF, not
feedback calculations.
Internal reflux above the draw-off tray (FC103 PV) is calculated by FC103 using overhead
temperature (TC106 PV), reflux temperature (TI177 PV) and external reflux (FI103 PV). Because
the reflux temperature is an externally multiplexed measurement, it is validated (in TIV177)
before its use in the calculation. From Section 3.7.2, internal reflux is calculated as shown in
Equation (11.1).
FC103 PV = Scale ∗ FI103 PV ∗ [1 + (CP∕𝜆)∗(TC106TYP − TIV177 PV − 𝛿)] (11.1) Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.1 Heat Recovery Maximization 347
External
reflux flow
Minimum internal
reflux calculation
Max TC132 OP
(min E-111 bypass
flow) 
SP SP
LSS
TC132 OP
RC130
SP
SP
Reflux
temperature
Typical Ovhd
temperature
IR above
D/O tray,
Calc and Ctl
TPA flow/feed
ratio
Feed
flow
TPA flow
VTC132 FC103
FV130
FC
15
FC
130
FI
103
FCG15
Dynamic
compensation
Side stream
draw-off flow
FC
FC103SPC 35
TC106TYP
TIV177
Validation
TI
177
Figure 11.5 T-105 TPA Flow and E-111 Heat Recovery to Crude Maximization
where
FC103 PV Internal reflux above sidestream draw-off tray
FI103 PV External reflux flow rate
TC106TYP Typical” value of overhead temperature, not TC106 SP or TC106 PV2
TIV177 PV Validated value of reflux temperature, TI177
CP External reflux specific heat
𝜆 Overhead vapor latent heat of vaporization
𝛿 Average difference between vapor dew point and bubble point
Scale factor (Scale) is included to ensure FC103 PV has the desired engineering units. CP, 𝜆, and
𝛿 are physical properties provided by the PTS group; they are engineer entries and are maintained
constant. TC106TYP can be a design value, a true typical value, or the value of the measured over￾head temperature (TC106 PV) when the internal reflux controller FC103 last initialized. If the
design value or a true typical value is used, it is engineer entered and maintained constant.
To ensure there is enough internal reflux (IR) to meet the sidestream draw-off target, the mini￾mum internal reflux is calculated as a percentage (IR % Excess) greater than the sidestream draw-off
rate, FC35 PV or SP.3 The calculation is done in FC103SPC, which outputs the new, minimum
internal reflux target (FC103 SP) to the internal reflux controller’s setpoint:
FC103 SP = [IR % Excess]
100 ∗ [FC35 PV or FC35 SP] (11.2)
2 Why neither TC106 PV nor TC106 SP is used is explained in Section 3.7.2.
3 Relationships of internal reflux and sidestream draw-off flow to tower fractionation is discussed in Section 12.8.3. Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License348 11 Energy Conservation Controls
The internal reflux response (FC103 PV) to changes in TPA flow (FC130 SP) is very slow and
hence the calculation/output of new values of FC103 SP is done infrequently. IR % Excess is a
console entry (typically between 110% and 120%), specified offline and changed very infrequently.
The sidestream draw-off rate (FC35 SP) is the kerosene back-end product quality controller’s MV.
Like all analyzer quality control, the draw-off rate variations will be small and slow – at the con￾trol frequency of the analyzer controller. Therefore, with FC103SPC scheduled to execute on a very
slow frequency, IR % Excess changed infrequently, and small/slow changes in FC35 SP, FC103 SP
changes will be small, and made very slowly. This allows internal reflux responses to TPA flow
changes to approach or reach steady state before the next internal reflux set point change. In effect,
FC103 control adjustments are driven by external reflux (FI103 PV) and reflux temperature (TI177
PV) upsets.
If FC35 PV is used in Equation (11.2) to calculate FC103 SP, measurement noise may be an issue if
FC35 PV is a noisy signal. However, using FC35 SP to calculate FC103 SP eliminates noise propaga￾tion, and since FC35 is the kerosene product’s back-end quality control loop’s ultimate secondary,
it is already configured for SP Init = Yes. Thus, FC35 SP is the preferred choice for the FC103
SP calculation. Note that additional logic may be necessary to switch to FC35 PV when FC35 is
wound-up (FC35 SP may be very different than FC35 PV) and in Auto. Both the SP/PV choice, and
the switch to FC35 PV when FC35 is wound-up should be discussed with operations before final
design and implementation.
Design Notes and Features
1. The control strategy in Figure 11.5 is a complex cascade and custom logic must be provided to
handle cascade initialization and wind-up above the LSS. Although FC103SPC outputs a new
FC103 SP, it is not a controller. However, because it calculates and outputs a new FC103 SP
value, it must recognize and respond to FC103’s initialization and wind-up statuses. Modern
state-of-the-art DCS functionality enables this to be achieved with standard DCS features.
2. VTC132 and FC103 are each tuned for their own response dynamics to changes in RC130 SP.
3. VTC132 SP (maximum TC132 OP) is almost never changed, and thus VTC132 is tuned for best
load response, proportional on PV with SP Init = No. VTC132 SP is normally set somewhat
less constraining (lower) than TC132’s output high clamp. When TC132 OP is close to VTC132
SP, this helps prevent random TC132 PV fluctuations from setting/resetting VTC132’s wind-up
status.
4. FC103 is a cascade secondary, whose setpoint, the minimum internal reflux flow, is calculated
by FC103SPC via Equation (11.2). However, the internal reflux, calculated in Equation (11.1),
varies when tower (or weather) upsets change the reflux temperature (TI177) or the reflux flow
(FI103). Thus, FC103 must respond to setpoint changes (calculated infrequently), but most
often to load upsets. Therefore, tuning for best load response, proportional on PV or tuning for
best set point response, proportional on PV are both reasonable choices. This tuning issue should
be resolved with help from operations during the application’s development.
5. Since FC103 is a cascade secondary, no matter how it is tuned, it should be configured for
SP Init = Yes. If so, the initialized value of FC103 SP will not be a guideline value or the last
minimum internal reflux target calculated by FC103SPC. However, the next time FC103SPC
executes after FC103 initializes, FC103 SP’s desired guideline value will be restored.
6. When internal reflux FC103 PV is decreasing and/or below its set point (its minimum value),
controller output must decrease RC130 SP (i.e., decrease TPA flow) and therefore FC103 is
configured with control direction = Direct. For VTC132, when TC132 OP is decreasing and/or
below its set point (its maximum value), controller output must increase RC130 SP (i.e.,
increase TPA flow) and therefore TC132 is configured with control direction = Reverse.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.1 Heat Recovery Maximization 349
7. TV132 is a three-way valve, whose relationship to TC132 OP is equivalent to the controller
output characteristic in Figure 11.3. Therefore, TC132 is configured with control direc￾tion = Direct. Remember: TC132 OP is calculated as % open, and is sent to analog output block
TV132 whose output direction ensures that when (i) TC132 OP decreases, flow in E-111’s
bypass branch increases and flow in E-111’s feed branch decreases, and when (ii) TC132 OP
increases, flow in E-111’s bypass branch decreases and flow in E-111’s feed branch increases.
8. TIV177, the validated value of TI177 PV, is used in Equation (11.1) to calculate internal reflux.
When TI177 PV is declared invalid via the logic in TIV177, its last “Good” value is used until
TI177 returns valid again. Internal reflux is still a function of external reflux flow (FI103 PV),
and it changes as FI103 PV varies in response to TC106 control adjustments. Thus, FC103 will
not wind-up RC130 when the reflux temperature is held constant at its last “Good” value. An
indication in the strategy’s operator interface informs operators that this TI point has failed.
Since the new, valid value may be quite different from the last “Good” value, logic is provided
(in FC103) to initialize FC103 whenever TI177 PV returns valid.
9. If FC15 SP is used as the dynamic compensation calculation’s (FCG15) wild flow input to
minimize noise propagation, FC15 must be configured for SP Init = Yes. If FC15 is an ultimate
secondary, it is already configured for SP Init = Yes. If FC15 SP is used (configured for SP
Init =Yes), additional logic may be necessary to switch to FC15 PV whenever FC15 is wound-up
and in Auto. If FC15 is not a cascade secondary, FC15 SP is likely a guideline value specified
offline. If SP Init =Yes, then additional logic/code is necessary to ramp FC15 SP back to its
guideline value.
10. An unavailable feed measurement (FC15 PV) must not adversely affect the feedback loop (TPA
flow maximization). Whether FC15 PV or SP is configured as FCG15’s wild flow input, user
provided custom code/logic ensures a last “Good” value is used when FC15 PV is unavailable.
RC130’s wild flow input is then constant (no feed rate FF corrections), but RC130 still responds
to new set points calculated by VTC132 and/or FC103.
11. TPA maximization continues when either feed rate FF is turned Off (FCG15 transferred from
Auto → Manual) or turned On (FCG15 transferring from Manual → Auto).
12. Suitable logic must be provided to initialize ratio controller RC130 when (i) feed rate FF is
turned On and (ii) an unavailable FC15 PV measurement returns available. When RC130
initializes, all controllers above it are forced to initialize. Since this control strategy is a
complex cascade, user provided custom code/logic must manage the initialization of the two
controllers above the LSS.
13. To prevent wind-up of the non-active CV controller, logic must be provided to reset the
non-active CV controller’s output to the active constraint variable’s controller output on every
normal control execution pass.
14. The operator interface indicates which constraint variable is the active constraint. A constraint
variable “switch history” display is useful to detect noise problems that cause erratic active
constraint switches.
11.1.2 Flow Distribution to Parallel Heat Exchangers
After steam stripping to recover lighter hydrocarbons, CDU sidestream draw-offs frequently
exchange heat with crude in the crude preheat train. This is illustrated in Figure 11.6, for CDU
tower T-90 and its third sidestream draw-off. In this configuration, there are two parallel paths for
the sidestream flow, pump P-5A branch set by flow controller FC75, and pump P-5B branch set by
flow controller FC76.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License350 11 Energy Conservation Controls
T
9
0
3rd side
stream
LC
75
Steam
stripper
Crude
distillation
unit (CDU)
3rd side stream
draw-off
P-5A FV75
FC
75
E-340
T-40 reboiler
TV36
T-40 tray
temperature
control
TC
36
P-5B FV76
FC
76 Crude
E-75 A/B/C
3rd
side stream
product
T
8
9
Figure 11.6 CDU Third Sidestream Flow and Heat Recovery Configuration
The sidestream product’s back-end quality target is met by manipulating the total sidestream
draw-off flow, i.e., the sum of FC75 PV and FC76 PV. Heat recovery to crude is maximized by
maximizing the share of the total sidestream flow routed to the P-5B branch via FC76. Decreas￾ing FC75 SP, while increasing FC76 SP to maintain total flow constant, will in principle maximize
heat recovery to crude in E-75 A/B/C. In the P-5A branch, E-340 is a light-ends tower (T-40) reboiler
whose duty is manipulated (via three-way valve TV36) to meet a T-40 tray temperature target (TC36
SP) that infers a T-40 product’s quality. As FC75 SP is decreased (and FC76 SP increased to maintain
total flow constant), more heat is recovered to crude in E-75A/B/C. But as FC75 SP is decreased,
E-340 duty tends to decrease and TC36 PV also tends to decrease. In response, TC36 control adjust￾ments (to TV36) simultaneously increase sidestream feed to E-340 and decrease sidestream bypass
flow around E-340 to return TC36 PV to target. Clearly, there is a low limit for flow through the
P-5A branch (FC75 SP) since eventually E-340 bypass flow approaches zero. If so, E-340 duty cannot
be increased further, TC36 PV cannot be maintained at TC36 SP, and T-40 product quality can no
longer be maintained at target.
Therefore, the operating objectives are to (i) meet the total sidestream flow requirement set by the
sidestream back-end quality control loop and (ii) maximize heat recovery to crude in E-75 A/B/C by
maximizing FC76 SP and minimizing FC75 SP, subject to an E-340 minimum bypass flow limit that
keeps TC36 output in controlling range. The control strategy that achieves these control objectives
is shown in Figure 11.7.
Total third sidestream flow (FC7576) is maintained at a desired set point (calculated by the third
sidestream’s back-end quality control loop) by manipulating FC76 SP, the third sidestream’s flow
through the P-5B branch. In addition to responding to the set point changes demanded by the
quality loop, FC7576 must also respond to the changes made to FC75 SP (by VTC36) that drive
heat recovery to crude in E-75 A/B/C to a maximum. Heat recovery to crude in E-75 A/B/C is
increased by decreasing FC75 SP, the sidestream flow through the P-5A’s branch. In response, total
flow controller FC7576 increases FC76 SP, the flow to the P-5B branch, to balance the decrease Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.1 Heat Recovery Maximization 351
SP SP
FC
75
FC
76
VTC36 TC36 OP
Max
TC36 OP 
SP
TC36
valve position
control
FV76 FV75
To
E-75 A/B/C
To
E-340
P-5B
branch
P-5A
branch
FC7576
FC76 PV FC75 PV
SP
3rd SS total
flow control
From T-90
3rd SS back-end
quality loop
Figure 11.7 Sidestream Total Flow Control, Heat Recovery Maximization to Crude in E-75 A/B/C
in the P-5A branch’s flow. Increases in the P-5B branch’s flow (FC76 SP) is the driving force for
increasing heat recovery to crude in E-75 A/B/C.
FC75 SP decreases have an important impact on E-340. When FC75 SP is decreased, E-340
duty tends to initially decrease and hence tower tray temperature TC36 PV also tends to decrease.
TV36 is a three-way valve, and like TC324 and TV324, and TC132 and TV132, in Section 11.1.1,
its relationship to TC36 OP is equivalent to the controller output characteristic in Figure 11.3.
Therefore, to increase TC36 PV and return it to TC36 SP, TC36 OP increases. As indicated in
Figure 11.3, when TC36 OP increases, sidestream bypass flow to E-340 decreases, sidestream flow
to E-340 increases, E-340 duty increases and TC36 PV increases on its way back to its SP.
So as FC75 is decreased to increase heat recovery to crude in E-75 A/B/C, TC36 OP continues to
increase, E-340 bypass flow continues to decrease, and E-340 feed flow continues to increase. TC36
OP and TV36 are driven toward a high constraint limit – TC36 OP → 100%, the bypass % open → 0%,
and the feed % open → 100%. Therefore, E-340 duty can eventually become limited high; if so, heat
recovery to crude is maximized.
Note that pump flow limitations, P-5A branch low flow and/or P-5B branch high flow constraints,
can be honored by using low FC75 SP or OP clamps, and high FC76 SP or OP high clamps. If any one
of these clamps is reached, standard DCS features will set the appropriate FC75 or FC76 wind-up
status, and broadcast those wind-up statuses to FC7576 or VTC36 respectively. However, unless
these clamps are in some way correlated to TC36 OP reaching its high limit, they cannot guarantee
that heat recovery to crude will be maximized in E-75 A/B.
Design Notes and Features
1. Total flow controller FC7576 is a PID controller whose PV is calculated as the sum of FC75 PV
and FC76 PV. If either flow becomes unavailable, FC7576 PV becomes “Bad”, total flow control
stops, and the third SS back-end quality loop is forced to initialize.
2. The FC7576 → FC76 → FV76 control strategy is a simple cascade, and cascade initialization
and wind-up are both managed by standard DCS features up to FC7576. Depending on the T-90
quality control loop’s cascade structure, initialization and wind-up statuses could be transmitted
to higher levels of the cascade via standard DCS features.
3. Like most flow controllers, both FC7576 and FC76 have control direction = Reverse. Since both
are cascade secondaries, they are tuned for best set point response, proportional on error, with SP
Init = Yes.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License352 11 Energy Conservation Controls
4. The VTC36 → FC75 → FV75 control strategy, which maximizes heat recovery to crude in E-75
A/B/C, is also a simple cascade and cascade initialization and wind-up are both managed by
standard DCS features.
5. Flow controller FC75 has control direction = Reverse. Since it is a cascade secondary, it is tuned
for best set point response, proportional on error with SP Init = Yes.
6. TV36 is a three-way bypass valve, whose relationship to TC36 OP is equivalent to the controller
output characteristic in Figure 11.3. Therefore, if TC36 is increasing or above its setpoint, TC36
OP must decrease to decrease E-340 duty (by increasing E-340 bypass flow and decreasing flow
to E-340). Thus, TC36 control direction = Reverse.
7. If TC36 OP is increasing and/or is above VTC36 SP, VTC36 must increase FC75 SP to increase
TC36 PV. Therefore, VTC36 control direction = Direct. Note: In response to an FC75 SP
increase, TC36 PV will increase and TC36 OP decreases to increase bypass flow and decrease
third sidestream flow to E-340. Remember: For every change in FC75 SP, FC7576 makes the
appropriate change to FC76 SP to maintain total flow constant.
8. VTC36 SP is TC36’s maximum allowable output. It will almost never be changed and therefore
VTC36 is tuned for best load response, proportional on PV with SP Init = No. VTC36 SP is nor￾mally set somewhat less constraining (lower) than a TC36 output high clamp. When close to
set point, this helps prevent the setting and resetting of VTC36’s wind-up status due to random
TC36 PV fluctuations.
9. If desired, FC76 and FC75 output and/or set point clamps can be entered by operators to impose
P-5B branch high/P-5A branch low flow limits.
11.1.3 Catalytic Reformer Reactor Effluent Heat Utilization
In catalytic reforming, heavy virgin naphtha (HVN) – a CDU’s hydrotreated, stabilized overhead
product (naphtha), is upgraded to higher octane components by primarily converting naphthenes
and paraffins to higher octane aromatics. The reactions occur in three to four packed bed reactors
in series. The overall reactions are endothermic, and first reactor preheat, and inter-reactor effluent
reheating are provided by fired heaters. It produces large quantities of H2 for use in many refinery
process units (e.g., hydrotreaters, hydrofiners, and hydrocrackers). Some of the hydrogen produced
is recycled back to the first reactor inlet to maintain reactor H2 partial pressure high enough to help
prevent coke formation and catalyst deactivation.
The hot reactor effluent exiting the last reactor is always heat integrated with several process
streams in a series of heat exchangers. One such configuration for reactor effluent heat recovery is
presented in Figure 11.8.
The hot effluent provides preheat for the combined reformer feed and recycle gas (mostly H2) in
E-33, recycle gas in E-34, and debutanizer tower (DeC4) T-73 feed in E-63. It is also the heat source
for T-73’s reboiler (E-73) and the stabilizer tower’s reboiler (E-83). The flow of reactor effluent to
reboilers E-73 and E-83 is set by DeC4 and Stabilizer tower tray temperature controllers TC73 and
TC83 respectively. From E-33, reformer feed is routed to the fired heater in first reactor preheat
service (F-201); thus, increasing heat recovery to feed in E-33 reduces fuel consumption in F-201.
Thus, there are energy savings if reformer effluent heat recovery to reformer feed is maximized.
Since all other heat exchanger duties are set by temperature control, maximizing heat recovery to
feed in E-33 also reduces heat lost to air in E-113 and water in E-102.
Heat recovery to feed in E-33 is increased by reducing T-73 feed temperature (TC63 SP). TC63’s
response to a decrease in its set point is to reduce its output to close TV63. This reduces efflu￾ent bypass flow around E-33, increases effluent flow to E-33, increasing E-33’s duty. The increase
in E-33’s duty reduces the temperature of the hot effluent at E-33’s outlet. The effluent routed
to effluent/T-73 feed exchanger E-63 by DPC-136 adjustments to DPV136 is E-63’s hot side inlet Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.1 Heat Recovery Maximization 353
Last reactor
effluent E-33
TV63
TV73
TV83
E-73
T-73 reboiler
E-83
Stabilizer reboiler
TC
73
TC
83
Preheat
fired heater
F-201
To reformer
1st reactor CW Recycle
H2
E-34
DPV136
E-113
E-102
DPC
136
E-63
DeC4
feed
DeC4
tower 
TC
63
T
7
3
Reformer
feed
∞
Figure 11.8 Reformer Reactor Effluent Heat Utilization
flow, and thus its temperature is reduced. With a lower hot side inlet temperature, the driving
force for heat transfer in E-63 is reduced, and E-63 cold side (T-73 feed) outlet temperature (TC63
PV) decreases. The decrease in T-73 feed temperature lowers all T-73 temperatures, including the
tray temperature – TC73 PV. Tray temperature controller TC73’s response is to increase its output
to open TV73 and increase effluent flow to E-73. With E-73 duty increasing, TC73 PV returns to
TC73 SP.
Therefore, heat recovery to feed in E-33 is limited by the requirement to keep TC73 OP in con￾trolling range – maintain TV73 below its maximum allowable opening. This ensures DeC4 tower
T-73 meets its product quality target (inferred by TC73 SP). The primary operating objective is
then to maximize heat recovery to reformer feed in E-33 by reducing T-73 inlet temperature (TC63
SP) to close TV63 and minimize E-33 bypass flow. This is subject to a TV73 maximum allowable
opening that keeps TC73 OP in controlling range. The conventional constraint control strategy in
Figure 11.9 achieves these objectives.
As the discussion above indicates, TC63 SP affects both constraint variables (TV63, TV73),
and decreasing TC63 SP moves both constraint variables toward their constraint limits. Since a
Figure 11.9 Reactor Effluent Heat Recovery
Maximization to Reactor Feed
TV63
HSS
VTC63
Min TV63
SP
SP
VTC73 TV73
Max TV73
SP
TC
63
TV63
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License354 11 Energy Conservation Controls
decrease in TC63 SP (the MV) moves both constraint variables toward their constraint limits,
and as explained in Section 7.4.4, the constraint variable PIDs (VTC63 and VTC73) output to a
high signal selector (HSS), which chooses the largest of the two PID outputs to send to TC63 SP.
Note that even if TV63 does not reach its minimum opening (e.g., TV73 is the active constraint,
with E-33 bypass flow greater than the desired minimum), heat recovery to reformer feed is still
maximized for the current operation.
Design Notes and Features
1. The control strategy in Figure 11.9 is a complex cascade and custom logic must be provided to
manage cascade initialization and wind-up above the HSS.
2. VTC63 and VTC73 are each tuned for their own response dynamics to changes in TC63 SP.
VTC63 SP and VTC73 SP are almost never changed, and thus both constraint variable PIDs are
tuned for best load response, proportional on PV with SP Init = No.
3. The maximum % opening for TV73 – VTC73 SP is typically chosen to be less constraining
(lower) than its output high clamp. With VTC73 SP chosen less constraining than TC73’s OP
high clamp, TC73 OP is still in controlling range when TV73 is maintained at its maximum %
opening – controlled at VTC73 SP.
4. When TC63 PV is increasing or above its setpoint, TC63 OP must decrease to close E-33 bypass
valve TV63. Therefore, TC63 is configured with control direction = Direct.
5. When TV63 is increasing or above its minimum allowable opening, VTC63 OP must decrease to
decrease TC63 SP. Therefore, VTC63 is configured with control direction = Reverse. When TV73
is decreasing or is below its maximum allowable output, VTC73 OP must decrease to decrease
TC63 SP. Therefore, VTC73 is configured with control direction = Direct.
6. To prevent wind-up of the non-active CV’s PID output, logic must be provided to reset its PID’s
output to the active constraint variable’s PID output on every control execution pass.
7. The operator interface indicates which constraint variable is the active constraint. A constraint
variable “switch history” display is useful to detect noise problems that cause erratic active con￾straint switches.
11.1.4 Distillate Hydrofiner Reactor Effluent Heat Utilization
After exiting a kerosene or diesel hydrofiner (H/F) reactor, where sulfur and mercaptans are
catalytically removed from the feed, an H2 rich gas containing H2S is separated from the reactor
effluent. The effluent is routed to a product stabilizer, such as steam stripper T-106 in Figure 11.10,
for residual H2S removal. In Figure 11.10, T-106 removes an H2S rich off-gas overhead via steam
stripping. T-106 bottoms, the desulfurized product, is cooled in three heat exchangers in series and
is then routed to tankage. T-106 bottoms exchanges heat with crude in E-104, and then provides
heat for two light-ends tower reboilers, E-130 and E-150.
Like process configurations discussed earlier, there are energy savings to maximize heat
recovery to crude. As heat recovery to crude increases in E-104 (by closing EV104 to route more
stripper bottoms flow to E-104), fuel consumption in the downstream CDU preheat fired heater
should normally decrease. There is clearly a minimum allowable EV104 valve position (full
closed) – minimum E-104 bypass flow. However, as explained below, other potential constraints
can prevent E-104 bypass flow from approaching its minimum value, and thus limit heat recovery
to crude in E-104:
1. As EV104 closes, E-104 duty increases and E-130 hot side inlet temperature decreases.
This reduces reboiler E-130 duty and tends to lower all T-30 temperatures including tray
temperature TC34 PV. In response, TC34 adjusts TV34 to increase E-130 duty. Assuming
TC34 OP’s characteristic is equivalent to Figure 11.3 (TV34 fails with feed branch closed and Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.1 Heat Recovery Maximization 355
P-70
EV104
E-104
Btms/crude
exch
E-130
T-30 reboiler
Off gas to
H2S removal
Crude
E-150
T-50 reboiler
LC
106
H/F steam
stripper
Sour
water
Light
hydrocarbons
Steam
H/F reactor
effluent 
FC
78
Desulfurized
product
TV34 TV20 LV106
TC
20
T
5
0
TC
34
T
3
0
T
1
0
6
D-135
Figure 11.10 H/F Steam Stripper Bottoms Heat Recovery Configuration
bypass branch open), as EV-104 is closed to increase heat recovery to crude in E-104, TC34
PV decreases and TC34’s control adjustments increase TC34 OP. This decreases E-130 bypass
% open and increases E-130 feed % open, driving E-130’s bypass % open toward full closed
(→ 0%) and E-130’s feed % open toward full open (→ 100%), e.g., toward the maximum TC34
OP constraint.
2. As EV104 closes and reboiler E-130 hot side inlet temperature decreases, E-150 hot side inlet
temperature also tends to decrease – all T-50 temperatures tend to decrease, including tray
temperature TC20 PV. In response to lower TC20 PV, and assuming Figure 11.3 is also a valid
representation for the TC20 OP characteristic, TC20 OP increases – to decrease E-150 bypass
% open and increase E-150 feed % open, driving E-150’s bypass % open toward full closed (→
0%) and E-150’s feed % open toward full open (→ 100%), e.g., toward the maximum TC20 OP
constraint.
3. As EV104 closes, pressure drop across the three heat exchangers increases, resistance to flow
increases, T-106 bottoms level LC106 PV tends to increase, and in response, LC106 adjustments
open LV106 to maintain bottoms level at setpoint. Thus, closing EV104 drives LV106 toward a
maximum % open → 100% (LC106 OP max constraint).
Thus, maximizing heat recovery to crude in E-104 is limited by the requirement to keep TC34,
TC20 and LC106 outputs in controlling range. If they remain in controlling range, both light-ends
towers continue to meet their product quality targets (inferred by TC34 SP and TC20 SP), and
LC106 continues to control T-106 bottoms inventory. The operating objective is then to maximize
heat recovery to crude in E-104 by minimizing E-104 hot side bypass flow (EV104 % open → 0%)
as limited by: (i) a maximum TC34 valve position – max TC34 OP, (ii) a maximum TC20 valve
position – max TC20 OP, and (iii) a maximum LC106 valve position – max LC106 OP. The conven￾tional constraint control strategy shown in Figure 11.11 achieves the above operating objective.
Remember: Max TC34 OP and max TC20 OP correspond to minimum E-130 (TV34) and E-150
(TV20) hot side bypass flows and thus maximum E-130 and E-150 heat duties. TC34 OP and TC20
OP are sent to analog output blocks TV34 and TV20. Even if the TC34 OP or TC20 OP charac￾teristic is the opposite of that shown in Figure 11.3 (fails with bypass % open = 0% and feed %
open = 100%), TV34’s and TV20’s configured output direction ensures that when controller output
decreases (increases), flow in the bypass branch increases (decreases) and flow in the feed branch
decreases (increases).
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License356 11 Energy Conservation Controls
LV106 EV104
LC
106
VLC106 VTC34 VTC20
Max LC106 OP
SP
Max TC34 OP
SP
Max TC20 OP
SP
HSS
LC106 OP TC34 OP TC20 OP
Figure 11.11 Steam Stripper T-106 Bottoms Heat Recovery Maximization to Crude in E-104
Thus, EV104 affects all three constraint variables (LC106 OP, TC34 OP, and TC20 OP) – opening
(increasing) EV104 moves all three away from their (max) constraint limits. Since increasing
EV104 (the MV) moves all constraint variables away from their constraint limits, as established
in Section 7.4.4, the constraint variable PIDs (VLC106, VTC34, and VTC20) output to a HSS.
The strategy manipulates EV104 until one of the three constraint variables becomes active. Note:
Even if EV104 is not fully closed, heat recovery to crude is maximized at the EV104 opening
(smallest E-104 bypass flow) that makes either LC106 OP, TC34 OP or TC20 OP the active
constraint.
Design Notes and Features
1. The control cascade in Figure 11.11 is a complex cascade and custom logic must be provided
to handle cascade initialization and wind-up for the three-constraint variable PIDs above the
HSS.
2. Constraint variable controller outputs VLC106 OP, VTC34 OP, and VTC20 OP are generated as
% open. Via EV104’s configured output direction, the DCS handles its failure mode (air-to-open
or air-to-close) and subsequent output signal conditioning external to the PID output calcula￾tions. This ensures valve EV104 closes (opens) when VLC106 OP or VTC34 OP or VTC20 OP,
whichever the HSS selects, decreases (increase).
3. When LC106 PV is increasing or is above its setpoint, LC106 output increases to open LV106.
Thus, LC106 is configured for control direction = Direct.
4. TV34 is a three-way bypass valve, whose relationship to TC34 OP is equivalent to the controller
output characteristic in Figure 11.3. Thus, if TC34 PV is decreasing and/or is below its set point,
TC34 OP must increase – TC34 must be configured for control direction = Reverse. TC34 OP is
sent to analog output block TV34, whose output direction ensures that no matter TV34’s failure
mode, when TC34 OP decreases (increases), E-130 bypass flow increases (decreases), E-130
feed flow decreases (increases) and E-130 duty decreases (increases).
5. Using similar reasoning as used above for TC34, TC20 must also be configured for control
direction = Reverse. Likewise, TV20’s configured output direction ensures that when TC20 OP
decreases (increases), flow in E-150’s bypass branch increases (decreases), flow in E-150’s feed
branch decreases (increases), and E-150 duty decreases (increases).
6. If LC106 OP is increasing and/or above its maximum value (VLC106 SP), VLC106 output
increases (to open EV104). This increases E-104 bypass flow, and reduces pressure drop across Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.2 Lowering Fired Heater Stack Excess O2 Targets 357
the exchanger train, which tends to increase T-106 bottoms flow and decrease T-106 bottoms
level LC106 PV. Therefore, VLC106 control direction = Direct.
7. If TC34 OP is increasing and/or is above its maximum value (VTC34 SP), VTC34 output
increases (to open EV104). E-130 hot side inlet temperature and thus E-130 duty tend to
increase, and TC34 PV tends to increase. In response, TC34 OP decreases – E-130 bypass flow
increases, E-130 feed flow decreases, and E-130 duty decreases. Therefore, VTC34 control
direction = Direct.
8. Equivalent to TC34 OP, if TC20 OP is increasing and/or is above its maximum value (VTC20
SP), VTC20 output increases (to open EV104). E-150 hot side inlet temperature and thus E-150
duty tend to increase, and TC20 PV tends to increase. In response, TC20 OP decreases – E-150
bypass flow increases, E-150 feed flow decreases, and E-150 decreases. Therefore, VTC20 con￾trol direction = Direct.
9. VLC106, VTC34, and VTC20 are each tuned for their own response dynamics to changes in
EV104. VLC106 SP, VTC34 SP, and VTC20 SP will almost never be changed and therefore all
three controllers are tuned for best load response, proportional on PV with SP Init = No.
10. The maximum allowable LC106 OP (VLC106 SP) is normally chosen to be less constraining
(lower) than its output high clamp. With VLC106 SP less constraining than LC106’s output
high clamp, LC106 output is still in controlling range even if LC106 OP is the control strategy’s
active constraint.
11. The maximum allowable TC34 OP (VTC34 SP) and maximum allowable TC20 OP (VTC20 SP)
are also normally chosen to be less constraining (lower) than their output high limit clamps.
With VTC34 SP and VTC20 SP less constraining than their output high clamp, TC34 and TC20
outputs are still in controlling range even if TC34 OP or TC20 OP is the active constraint.
12. To prevent wind-up of the non-active CV PID outputs, logic must be provided to reset their PID
outputs to the active constraint variable’s PID output on every control execution pass.
13. The operator interface indicates which constraint variable is the active constraint. A constraint
variable “switch history” display is useful to detect noise problems that cause erratic active
constraint switches.
11.2 Lowering Fired Heater Stack Excess O2 Targets
Control strategies that lower fired heater stack excess O2 concentrations by reducing the volume of
air used to ensure complete combustion of fuel, are now presented and discussed. By lowering the
excess O2 operating target, or if controlled, by lowering the stack excess O2 controller’s setpoint, flue
gas volume decreases, heat losses to the atmosphere are reduced, and heater efficiency increases.
Fuel consumption is reduced, and as a result energy savings are captured.
Depending upon the type of heater, combustion air either enters the burners and is pulled
through the firebox and stack by buoyancy forces (Natural Draft) or is forced into the firebox by
a forced draft fan or an air blower (Forced Draft) and pulled through the stack by the buoyancy
effect. The firing controls presented in Chapter 10, Section 10.4, are independent of the heater type.
However, both in cascade structure and the MVs used, combustion controls for natural and forced
draft heaters are different, although the stack damper plays an important role in both. Differences
also arise when firing and combustion controls are linked to improve heater control performance.
Under ideal conditions, the combustion of hydrocarbon fuels with the stoichiometric amount
of O2 converts all carbon to CO2 and all hydrogen to H2O. However, the stack gases leaving the Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License358 11 Energy Conservation Controls
heater always contain other combustion products in addition to CO2 and H2O. To ensure complete
combustion of fuel, air (the O2 source), in excess of the stoichiometric requirement, is always used.
Any O2 entering with the air at the burners and not consumed by the combustion reactions and
almost all N2 entering with the air, flow into the stack and exit with the flue gas. Oxides of sulfur
and nitrogen are produced in small amounts when some nitrogen entering with the air and some
sulfur entering with the fuel are oxidized; these combustion by-products also exit with the flue gas.
Finally, there is always some incomplete combustion in the burners caused by poor mixing and
other irregularities. Thus, trace amounts of CO and unburned hydrocarbons exit in the flue gas
with other combustion products.
The flue gas heat content at the stack temperature is heat lost to the atmosphere, and this heat is a
significant percentage of the heater’s total heat losses. Thus, reducing the volume of flue gas and/or
reducing the stack temperature reduce heat losses and increase heater efficiency. In some cases,
an air preheater is installed to recover flue gas heat content in the entering combustion air and
lower stack temperatures. However, air preheaters are expensive, require major capital investment,
and are limited to forced draft heaters. A forced draft heater configuration which includes an air
preheater is discussed in Section 11.2.1.
By lowering flue gas volume, stack heat losses are reduced at a much lower cost than lowering
the stack temperature. This is accomplished by lowering the volume of excess air used to ensure
complete combustion of fuel. This requires closed loop control of stack excess O2 which can be
implemented with no capital investment other than (when necessary) new instrumentation (e.g., a
stack excess O2 analyzer). Without closed loop control, and certainly if there is no online analyzer to
monitor stack O2, operators set the air intake, for all operations, higher than the amount required
to provide a reasonable O2 safety margin. This reduces the time an operator spends monitoring
the fired heater’s operations but wastes fuel and increases energy costs. By reducing O2 variability,
closed loop O2 control enables heater operations at lower excess O2 safety margins, and hence lower
stack excess O2.
In Section 11.1, we discussed control strategies that indirectly reduce fuel consumption in fired
heaters by increasing heat recovery upstream of the heater. We now discuss control strategies that
enable heater operations at lower O2 targets, which directly reduce fuel consumption. Various
combustion control strategies are presented that manipulate air intake to provide only the amount
of excess air needed to efficiently burn the fuel demanded by the COT controller. Combustion
control involves stack excess O2 and firebox pressure control. Draft pressure, the difference between
firebox and atmospheric pressures, can be a control variable instead of firebox pressure. Stack excess
O2 control and the reduction of stack excess O2 variability allow the stack excess O2 target to be
lowered.
However, energy savings are achieved only if the O2 controller’s setpoint is lowered. Great care
must be used to choose the new, lower excess O2 controller setpoint. The excess air must still
support complete combustion at the burners, so its reduction has a practical, low limit. When
combustion becomes incomplete, unburned hydrocarbons enter the flue gas and the heat gener￾ated by the combustion reactions decreases. The heat absorbed by the process fluid decreases and
the COT tends to drop. The COT controller responds by increasing fuel flow, which makes the sit￾uation worse. This is fired heater flooding, a situation that if not detected and corrective actions
taken, can become extremely dangerous. Therefore, it must always be avoided.
The desired “minimum” excess O2 setpoint is different for each heater. Factors such as air
leakage, burner air/fuel mixing efficiency, burner type, fuel type, fuel heating value variability,
frequency of process upsets, heater age, service, and design all have important roles in defining
the excess O2 target. Thus, the excess O2 target is best determined “experimentally” by online
testing on an individual heater basis, with the assistance of a fired heater specialist. And, although Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.2 Lowering Fired Heater Stack Excess O2 Targets 359
O2 analyzers are more reliable than most online analyzers, the excess O2 measurement still must
be validated before its use for control.
11.2.1 Combustion Control Air Side Measurements
Common combustion control strategies for two types of fired heaters are presented in the next two
sections – natural and forced draft heaters. For both heater types, maintaining stack excess oxygen
(if an excess O2 analyzer is installed and the online measurement is available) and firebox (or draft)
pressure at their setpoints are the control objectives. MVs depend upon the heater type. In addition
to the two control variables, there are several process constraints for both heater types that must be
honored. Constraint variables that tend to keep the fired heater out of flood are the most important.
Most present-day stack O2 analyzers can be installed without a complex, extractive sampling
system. Relatively fast measurement response times are common, and with no meaningful
sampling delays, control loop deadtime, a frequent problem for other analyzers, is not normally
an issue. Consequently, derivative action is often not needed, and excess O2 control via PI control
is effective.
For normal conditions, draft pressure, the difference between firebox pressure (PBX) and
atmospheric pressure (PA), [PBX–PA], is negative. High and low firebox pressures must be
avoided – high firebox pressure can cause hot combustion gases to escape, while low firebox
pressure can increase air leakage into the firebox. The higher the firebox pressure, the less negative
the draft pressure; the lower the firebox pressure the more negative the draft pressure. A less
negative draft pressure is considered a higher draft pressure, and a more negative draft pressure a
lower draft pressure. This has the advantage that a high or low draft pressure corresponds to a high
or low firebox pressure. Combustion controls are implemented effectively with either firebox or
draft pressure control. To avoid confusion over the max/min and increase/decrease complexities
of a negative process variable, combustion control designs that control firebox pressure are
presented. Substitution of draft pressure control for firebox pressure control offers equivalent
control functionality, although care is required to correctly specify max/min and high/low PV
limits and define an increasing/decreasing PV value.
Although firebox pressure is a high level, 4–20 mA analog input, it is almost always a very noisy
signal. PV filtering is a common approach to help reduce noise propagation to the final control
element, and subsequently to the excess O2 loop. As always, it is best to filter before any plant tests
are performed to tune the pressure controller or establish the excess O2 target.
Air side measurements required for the combustion controls implemented on natural draft
heaters are shown in Figure 11.12. There are two controlled variables – excess O2 and firebox
Figure 11.12 Natural Draft Heater Combustion Control
Measurements
AI
Stack
oxygen
PI Firebox
pressure
Combustion
air
Stack
damper
FI Fuel
flow
PI Fuel
pressure Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License360 11 Energy Conservation Controls
AI
Stack
oxygen
PI Firebox
pressure
Stack
damper
FI Fuel
flow
PI Fuel
pressure
Combustion
air flow
FI Forced draft
fan
Inlet air
damper
PI
Air discharge
pressure
Figure 11.13 Forced Draft Heater Combustion Control Measurements
(or draft) pressure, but there is only one MV – the stack damper. Therefore, only one controlled
variable can be maintained at its setpoint, while the other must not violate an operating constraint.
As will be presented and discussed in Section 11.2.2, natural draft heater combustion control is
best implemented using conventional constraint control.
Important: There is no air flow measurement available for natural draft heaters. This is an impor￾tant limitation when linking firing and combustion controls to improve heater control perfor￾mance – more about this in Section 11.2.3.
Air side measurements required for forced draft heater combustion controls are shown in
Figure 11.13. The same two process variables, excess O2 and firebox (or draft) pressure, are
controlled but now there are two MVs – the forced draft fan inlet air damper, and the stack damper.
Depending upon air inlet configuration specifics, inlet air guide vanes or a damper in the air
discharge duct may be manipulated instead of the inlet air damper.
As presented and discussed in Section 11.2.3, each controlled variable is paired with one of the
two MVs and conventional constraint control is not needed for forced draft heater basic combustion
control. Important: Forced draft heater inlet air flow is normally measured. When available and
reliable, the air measurement (i) is included in the combustion control strategy, (ii) is very helpful
when linking firing and combustion controls, and (iii) can be used to help avoid heater flood.
A forced draft heater configuration that includes an air preheater is shown in Figure 11.14. Air
is forced into the firebox by the forced draft fan and pulled through the air preheater and into the
stack by the induced draft fan. Hot flue gas is diverted to the air preheater before entering the
stack. It exchanges heat with the inlet air routed to the air preheater before flowing to the burners.
The preheated air is then sent to the burners, and the cooled flue gas is returned to the stack to
be released to the atmosphere. Note that the stack damper is closed to divert flue gas to the air
preheater.
Because significant amounts of heat are recovered by air, stack temperatures are lower, flue
gas heat losses are reduced, and heater efficiency increases. Note that despite the efficiency
improvement captured by lowering the stack temperature, there are still significant ENCON
incentives to operate at lower excess O2 targets.
Like the forced draft heater without air preheater, excess O2 and firebox (or draft) pressure are
controlled, but instead of the stack damper (which is closed to divert flue gas to the air preheater),
the second MV is the induced draft fan’s inlet guide vanes. All forced draft heater combustion Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.2 Lowering Fired Heater Stack Excess O2 Targets 361
Air
preheater
Combustion
air flow
FI
FI
Forced draft
fan
Induced draft
fan
Inlet air
damper
Fuel
flow
AI Stack
oxygen
PI Firebox
pressure
PI Fuel
pressure
PI
Air discharge
pressure
Guide
vanes
Figure 11.14 Forced Draft Heater with Air Preheater Combustion Control Measurements
control strategies presented and discussed in Section 11.2.3 are applicable to the heater/air pre￾heater configuration in Figure 11.14 with the induced draft fan inlet guide vanes replacing the
stack damper as the second MV.
11.2.2 Natural Draft Heater Combustion Control
For most natural draft heaters, only one MV, the stack damper, is available to control the two con￾trol variables – stack excess O2 and firebox (or draft) pressure. The conventional constraint control
strategy shown in Figure 11.15 maintains either excess O2 or firebox pressure, whichever is dynam￾ically closest to its constraint limit, at its constraint limit. The O2 controller setpoint, AC SP, is the
desired, minimum stack excess O2 target and the firebox pressure controller setpoint, PC SP, the
desired, maximum firebox pressure target.4
The damper position affects both the stack excess O2 and the firebox pressure. When the
damper is opened, the stack excess O2 increases, and the firebox pressure decreases. Since opening
(increasing) the damper position (the MV) moves both constraint variables away from their
constraint limits, the constraint variable controllers AC and PC output to a HSS. The strategy
manipulates the stack damper so that one of the constraint variables becomes the active constraint.
Maximum energy savings accrue when the stack excess O2 is the active constraint. When well
designed and implemented with appropriate setpoints, this will be true for most non-upset
operations. Note that even though the O2 analyzer is more reliable than most online analyzers, the
excess O2 measurement still must be validated (in AIV) before its use for control.
Important: If the combustion controls in Figure 11.15 are implemented, an O2 analyzer failure that
incorrectly indicates the excess O2 concentration is drifting upward will close the stack damper but
will not close the damper completely – the firebox (or draft) pressure controller (PC) will only
4 This control strategy was used in Section 7.3 as a basis for the discussion of control objectives and design features
common to all conventional constraint control strategies.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License362 11 Energy Conservation Controls
AI Stack
oxygen
PI Firebox
pressure
FI Fuel
flow
Combustion
air
Stack
damper
AIV AC PC
HSS
Validation
SP
Minimum
stack O2
SP
Max firebox
(or max draft)
pressure
Stack
damper
Figure 11.15 Natural Draft Fired Heater
Combustion Control
allow the damper to close enough to satisfy its own firebox pressure constraint (PC SP). Thus, this
combustion control strategy has an underlying, beneficial feature that helps minimize, but not
prevent, the possible onset of heater flood.
Design Notes and Features
1. The combustion control strategy in Figure 11.15 is a complex cascade and custom logic must be
provided to handle cascade initialization and wind-up for the two constraint controllers (AC,
PC) above the HSS.
2. Constraint variable PID controllers AC and PC are each tuned for their own response dynamics
to changes in the stack damper. Since AC SP and PC SP will only be changed occasionally, both
controllers are tuned for best load response, proportional on PV with SP Init = No.
3. If excess O2 is increasing and/or is above its minimum value (AC SP), AC output decreases
to close the damper. Therefore, the excess O2 controller is configured for control direc￾tion = Reverse. Remember: Controller outputs to final control elements (e.g., valves, dampers),
such as AC OP and PC OP, are assumed to be generated as % open.
4. If the firebox pressure is decreasing and/or is below its maximum value (PC SP), PC
output decreases to close the damper. Therefore, the firebox pressure controller’s control
direction = Direct.
5. If draft pressure is controlled, and draft pressure is decreasing and/or below (more negative
than) its maximum value (PC SP), PC output decreases to close the damper. Therefore, the
draft pressure controller’s is configured for control direction = Direct.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.2 Lowering Fired Heater Stack Excess O2 Targets 363
6. The firebox pressure is normally a very noisy measurement and almost always needs filtering.
Note that even though the pressure measurement is noisy and filtered, derivative action is
almost never needed. Noisy constraint variables often cause multiple, random active constraint
variable switches. Note that firebox pressure is not normally the active constraint, and tight
control to setpoint is not usually necessary. Thus, using an I-only controller instead of a PI
controller (see Section 7.8) to further reduce noise propagation can be effective, although this
also slows the firebox pressure controller’s response times to all upsets. A constraint variable
switch history display is useful to help detect the effect of noise problems.
7. If the excess O2 measurement is declared invalid by AIV or becomes unavailable (“Bad”), the
excess O2 controller’s PV is set “Bad”, and all AC control action stops. When O2 control stops,
AC output is frozen. For pressure control to continue, custom logic must be provided to ensure
the firebox pressure becomes and remains the active constraint variable until the O2 measure￾ment returns valid. The logic provided must also bumplessly recommission the full constraint
control strategy when the excess O2 measurement returns valid. Important: Firebox pressure
(or draft pressure) continuing without O2 control can become problematic and lead to heater
flood if the heater is subject to frequent, and significant, process upsets that affect firing (e.g.,
feed rate, fuel gas heating value). Therefore, discussions with operations and a fired heater
specialist are required to decide whether draft pressure control continues with an unavailable
O2 measurement.
8. To change the damper position manually, an operator must interface with the HSS. Depending
upon the specifics of the DCS’ Override algorithm or function block, and a site’s stan￾dard practices, this may require custom configuration and/or logic to make this “operator
friendly” – analogous to changing a PI or PID controller’s OP.
9. A minimum stack damper opening must be enforced to prevent the damper from closing too
much and causing low air intake and incomplete combustion of fuel. This can be done with
standard DCS clamps – with AC and PC controller or HSS output clamps. Unfortunately, the
minimum damper opening that ensures enough air for complete combustion is heater and
operations dependent, and discussions with a fired heater specialist and/or plant testing are
often required to effectively implement a damper position low limit. Note: In many cases,
special hardware, installed in the field with the damper mechanism, physically limits how
much the damper can close.
10. Logic must be provided to reset the non-active CV controller’s output to the active constraint
variable’s controller output on every normal control execution pass. This prevents wind-up of
the non-active CV controller’s output.
11.2.3 Forced Draft Heater Combustion Control
Differences between forced draft and natural draft heater combustion controls are due to two
factors: (i) forced draft heaters have two MVs, and both excess O2 and firebox pressure setpoints
are satisfied, and (ii) although not always reliable, an air flow measurement is normally available
for forced draft heaters. This section begins with a discussion of forced draft heater combustion
controls that are not linked to the firing controls, and then forced draft heater combustion controls
that are directly linked to the firing controls are presented.
The combustion control strategy shown in Figure 11.16 maintains both excess O2 and firebox
pressure at their desired targets (AC SP and PC SP). The forced draft inlet air damper (or guide
vanes, or air discharge damper) is manipulated to control inlet air flow; if the air flow measure￾ment is reliable, the air flow controller (FC) determines the damper position. The stack excess
O2 controller outputs to the FC’s setpoint to satisfy the stack excess O2 setpoint. The FC makes Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License364 11 Energy Conservation Controls
Combustion
air flow
FI Forced draft
fan
Inlet air
damper
FI Fuel
flow
AI Stack
oxygen Firebox
pressure
Stack
damper
PI
SP
Desired
pressure
Stack damper
+
AIV AC
Validation SP
Desired
stack O2
FC
SP
Combustion
air 
Forced draft fan
inlet air damper
Air inlet FF
PC
(PID FF
Ctl Algo) 
Figure 11.16 Forced Draft Fired Heater Combustion Control
fast inlet air damper adjustments to compensate for upsets in the air ducts before the stack excess
O2 measurement is affected. If the flow measurement is unreliable, the excess O2 controller out￾puts directly to the inlet air damper. Even if reliable, the air flow measurement may be noisy and
require filtering. If so, filter the air measurement before performing any plant tests to tune AC and
PC. Remember: Despite the O2 analyzer’s relatively high reliability, the excess O2 measurement still
must be validated (in AIV) before its use for control.
The stack damper is manipulated to meet the desired firebox pressure target. Anything that
changes flue gas flow affects firebox pressure; therefore, forced draft fan inlet air damper adjust￾ments affect firebox pressure. As shown in Figure 11.16, an (incremental) FF adjustment (Air Inlet
FF) to the stack damper is made each time FC sends its output to the inlet air damper to change the
air rate. Since the firebox pressure response to changes in the stack damper and inlet air damper
positions are both fast, and have about the same dynamics, only steady-state (incremental) FF
control is needed.
Assuming linearity, the incremental relationship between firebox pressure (ΔPBX) and changes
in stack damper (ΔDSTACK) and inlet air damper ΔDAIR is:
ΔPBX = KDSTACK ∗ ΔDSTACK + KDAIR ∗ ΔDAIR (11.3)
KDSTACK Steady-state firebox pressure change ΔPBX, after a change ΔDSTACK,
with ΔDAIR ≡0
KDAIR Steady-state firebox pressure change ΔPBX, after a change ΔDAIR, with
ΔDSTACK ≡0
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.2 Lowering Fired Heater Stack Excess O2 Targets 365
Both KDSTACK and KDAIR are determined by open loop plant testing. Noise, upsets, and
nonlinearities will degrade the plant test data. However, since KDSTACK and KDAIR are used
in a FF calculation, accuracy is not critical. Important: Their signs must be correct, KDSTACK <0,
and KDAIR >0, but order of magnitude accuracy is acceptable.
The steady-state FF controller calculates the change in the stack damper (ΔDSTACK) needed to
maintain a constant firebox pressure after any change in the inlet air damper (ΔDAIR) – based on
the steady-state FF gain (KFF):
ΔDSTACK = KFF ∗ ΔDAIR (11.4)
The analytic expression for KFF is obtained by eliminating ΔDSTACK from Equation (11.3) using
Equation (11.4):
ΔPBX = [KDSTACK ∗ KFF + KDAIR]∗ΔDAIR (11.5)
From Equation (11.5), for no changes in firebox pressure (ΔPBX ≡0) for any change in the inlet air
damper (ΔDAIR), the expression in the brackets must be zero; the steady-state FF gain (KFF) is thus:
KFF = −KDAIR∕KDSTACK (11.6)
Note: With KDSTACK <0 and KDAIR >0, Equation (11.6) indicates KFF >0. With KFF >0,
Equation (11.4) correctly indicates that (i) when the inlet air damper opens (ΔDAIR >0) to
increase air flow, the air inlet FF correction opens the stack damper (ΔDSTACK >0) and (ii) when
the inlet air damper closes (ΔDAIR <0) to decrease air flow, the air inlet FF correction closes the
stack damper (ΔDSTACK <0).
The FF calculation in Equation (11.4) executes within PC, the firebox pressure controller. The
Air Inlet FF entity is included to provide a way to turn the FF control off. It reads the current value
of the inlet air damper position (DAIR,N); it stores this value in its PV location (for display only). If
it is in auto mode, its control calculation stores its PV value to its control calculation result stor￾age location. If Air Inlet FF is in Manual mode, the control calculation is not performed, and the
stored value remains the same. PC’s control algorithm is the PID FF algorithm, which combines
PID feedback and incremental FF control.5 On every execution pass, the PID FF control algorithm
combines its normal PID control algo result with an internally calculated, incremental FF adjust￾ment. PC reads the current value of the inlet air damper position (DAIR,N) stored in Air Inlet
FF’s control calculation result storage location, and the incremental FF correction is calculated
by the PID FF control algorithm – the desired change in the damper position (ΔDSTACK,N), given
the current (DAIR,N) and the last (DAIR,N−1) values of the inlet air damper position (equivalent to
Equation [11.4]):
ΔDSTACK,N = KFF ∗ ΔDAIR,N = KFF ∗ (DAIR,N − DAIR,N−1) (11.7)
DAIR,N−1 is the inlet air damper position read and stored by PC on its last execution pass. The incre￾mental FF control calculation result in Equation (11.7) is added to this control execution pass’
normal PC PID calculation and the sum is PC’s output to the stack damper. The last thing PC
does on the current execution pass is to store DAIR,N as the last value, DAIR,N−1, for use on its next
execution pass.
Since the incremental FF control calculation is done by the box pressure’s PID FF control
algorithm, when PC initializes, standard PID FF control algo features initialize both the PID
control algorithm’s calculation and the FF control calculation in Equation (11.7). With “I” indi￾cating the initialization pass, DAIR,I−1 is set equal to DAIR,I. Thus, ΔDAIR,I = 0, and Equation (11.7)
indicates ΔDSTACK,I ≡0, and there is no FF correction on a PC initialization pass.
5 See Chapter 3, Sections 3.5 and 3.6 for calculation details.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License366 11 Energy Conservation Controls
Remember: By transferring Air Inlet FF into Manual mode, Air Inlet FF does not store a new
value to its control calculation result storage location. Thus, PC reads the same value it read on
the last pass, and via the control calculation in Equation (11.7), the FF adjustment ΔDSTACK,N ≡0.
Thus, to turn Air Inlet FF off, transfer Air Inlet FF to manual mode; to turn Air Inlet FF on,
transfer Air Inlet FF to Auto mode
Design Notes and Features
1. Both the excess O2 and firebox pressure control cascades are simple cascades and standard DCS
features handle initialization and wind-up for both. As discussed above, PC is configured with
the PID FF control algorithm.
2. Both AC and PC are cascade primaries whose set points will be changed only occasionally.
Thus, both controllers are tuned for best load response, proportional on PV with SP Init = No.
3. Flow controller FC is a cascade secondary and thus it is tuned for best SP response, proportional
on error with SP Init = Yes.
4. If excess O2 is increasing and/or above its desired value, AC output decreases to decrease
flow controller FC setpoint. Therefore, the excess O2 controller is configured with control
direction = Reverse.
5. If the firebox pressure is decreasing and/or below its desired value, PC output decreases to
close the stack damper. Therefore, the firebox pressure controller is configured with control
direction = Direct.
6. Firebox pressure is a very noisy measurement and almost always needs filtering. Note that
even though the pressure measurement is noisy and filtered, derivative action is almost never
needed.
7. If the excess O2 measurement is declared invalid by AIV or becomes unavailable, the excess O2
controller’s PV is set “Bad”, and all AC control action stops. Air flow control continues, as does
firebox pressure control.
8. Standard DCS functionality will re-commission the excess O2 controller when the excess O2
measurement becomes available once again. Since SP Init is almost certainly set to No, the
excess O2 controller may bump the air flow controller setpoint on the execution pass after it
initializes. If the air flow bump is unacceptable, then set AC SP Init = Yes, and add custom code
to ramp AC SP back to its desired value (its value before AC PV was declared “Bad” or invalid).
9. Standard features of PC’s PID FF control algorithm ensure firebox pressure control continues
when the air inlet FF is decommissioned by transferring the Air Inlet FF tag to Manual mode.
However, suitable logic must be provided to initialize PC when air inlet FF control is turned
on – by transferring the Air Inlet FF tag to Auto mode.
10. A minimum air inlet damper opening must be enforced to prevent the damper from closing too
much and causing low air intake and incomplete combustion. This can be done with standard
DCS clamps – e.g., FC controller output clamps. However, the minimum damper opening that
ensures enough air for complete combustion is different for different operations. Thus, to be
effective over time, the minimum damper opening clamp value must be “tuned” for various
operations.
Compared to the natural draft heater combustion controls in Figure 11.15, the combustion con￾trol strategy in Figure 11.16 is more likely to be forced into flood by an O2 analyzer failure that
incorrectly indicates the excess O2 concentration is drifting upwards. The excess O2 controller (AC)
will reduce the air flow rate set point, and the inlet air damper position will close. With less air
entering the firebox, box pressure will decrease, and in response, the box pressure controller (PC)
will close the stack damper to recover box pressure. Unlike the natural draft heater, even if PCs
adjustments to the stack damper can hold its setpoint, the air flow controller’s SP and thus heater Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.2 Lowering Fired Heater Stack Excess O2 Targets 367
FI
Fuel
flow
AI Stack
oxygen
Firebox
pressure
Stack
damper
PI
Combustion controls
AC
SP
Desired
stack O2
Combustion air
FI Forced draft
fan
Inlet air
damper
AI
RC
SP
AIV QC
SP
Validation
TC
FC
SP
Fuel gas
Feed rate
dynamic
compensation
Firing controls
Firing/feed
ratio Ctl
COT
control
BTU
control
Firing rate
QC PV
FC FCG
RC Air/firing
ratio control
SP
Combustion
air flow
FC
Forced draft fan
inlet air damper
SP
PC 
SP
Desired
pressure
Stack
damper
Air inlet FF +
Firing FF
AIV 
Validation
Figure 11.17 Forced Draft Heater Combustion Control with Air/Firing Ratio Control
air will continue to decrease, which can push the heater into flood. As will be explained next, link￾ing the combustion controls with the firing controls significantly reduces, but does not eliminate,
the chances this will happen.
Linking the combustion controls to the firing controls improves control performance and helps
keep a forced draft heater out of flood. An example of linked combustion and firing controls is pre￾sented in Figure 11.17. In Figure 11.17, the firing controls described in Chapter 10 (Section 10.4.6)
and presented in Figure 10.31 are linked to the combustion controls described earlier in this section
and presented in Figure 11.16.
The firing control strategy on the left in Figure 11.17, includes firing/feed ratio control (RC)
and BTU control (QC). Additions to the combustion controls, on the right in Figure 11.17, are
the air/firing ratio controller (RC), the Firing FF controller and a current value of firing rate, QC
PV (all indicated by grey shading and bold connectors). The air/firing ratio controller is placed in
the excess O2 loop between the excess O2 and air flow controllers. The Firing FF controller is the
input source for the air/firing ratio controller’s wild flow (i.e., firing PV) input, the current firing
rate (QC PV), which is calculated by QC on every execution pass.6 Reliable air flow, fuel flow and
heating value measurements are required.
Note that the firing controls discussed in Chapter 10, Section 10.4.4 (see Figures 10.27 and 10.28),
which include fuel/feed ratio control instead of firing/feed ratio control, and no BTU control, can
also be linked to the combustion controls in Figure 11.16. Instead of the air/firing ratio controller,
an air/fuel flow ratio controller is placed in the excess O2 loop between the excess O2 and air flow
controllers. Instead of the Firing FF tag providing the input source for the air/firing ratio con￾troller’s wild flow (current firing PV) input, a Fuel Flow FF tag provides the input source for the
air/fuel ratio controller’s wild flow (current fuel gas PV) input.
6 See Equation (10.10) in Chapter 10, Section 10.4.6.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License368 11 Energy Conservation Controls
Heater upsets or changes in operations almost always result in firing rate changes, and the stack
excess O2 is strongly affected by firing rate changes. In Figure 11.16, the combustion controls do
not respond to a firing rate change until the stack excess O2 is affected; only then does AC adjust
the air rate to return the excess O2 to its setpoint. Likewise, PC feedback and incremental FF con￾trol adjustments to return the firebox pressure to its setpoint do not start until the firebox pressure
(via PC) and excess O2 (via Air Inlet FF) are affected. In Figure 11.17, the air/firing ratio con￾troller provides FF compensation for any upset or operational change that changes the current
firing rate, before stack excess O2 is affected. The excess O2 controller makes trim adjustments to
correct for the effects the firing FF loop is unable to cancel. The firebox pressure loop response
is also faster because the Air Inlet FF is affected by the firing rate FF corrections made to the
excess O2 loop. Thus, air/firing ratio control improves the control performance of both excess O2
and firebox pressure control.
A suitable value for the air/firing ratio controller’s low setpoint limit helps prevent the heater
from being forced into flood by a malfunctioning excess O2 analyzer. Theoretical air requirements
(Scf of air/kBTU fired) for typical fuels can be estimated using fuel heating values and assumed
theoretical products of combustion – process technical personnel can help. This theoretical air
requirement corresponds to operations with zero percent excess air (i.e., stoichiometric air – no
excess O2). The theoretical air requirement is the basis for estimating an acceptable value for the
air/firing low setpoint limit that can effectively protect the heater – fired heater specialist assistance
is required. It is normally assumed that a single value of the low setpoint limit is acceptable for all
operations. If operating experience proves otherwise, the low setpoint limit may need to be “tuned”
to specific operations (e.g., fuel type).
Important: If the air flow is not measured, or is unreliable, air/firing ratio control is not possible,
and the heater is exposed to the same consequences of a failing excess O2 analyzer as previously
discussed for other combustion control strategies.
Air/firing ratio control is an important example of steady-state ratio FF control. Unlike
firing/feed ratio control,7 where the dynamically compensated feed rate (calculated in FCG in
Figure 11.17) is the firing/feed ratio controller’s wild flow input, the uncompensated firing rate
(QC PV) is the air/firing ratio controller’s wild flow input. The response of excess O2 to changes
in firing rate is relatively fast. Although it may be somewhat slower than the excess O2 response
to air inlet damper changes, it is acceptable to assume the dynamics of the two responses are
about the same. Therefore, dynamic compensation of the wild flow input, the current firing rate,
is not necessary. The Firing FF controller reads the current value of the firing rate, QC PV, and
stores it to its PV (for display only); its control calculation (if it is in Auto mode) stores its PV
(the firing rate) to its control algo result’s storage location. The firing rate stored in Firing FF
is retrieved by the ratio controller, and is its wild flow input for its control calculation: Air FC
SP = RC SP * (Firing FF control algo result).
Like Air Inlet FF, the Firing FF controller is included to allow operators to turn FF control off. If
Firing FF is in Auto mode, it stores the current firing rate to its control algo result’s storage location;
if in Manual mode, no control calculation is performed, and the value in the storage location is
unchanged. The ratio controller reads the now constant wild flow input (firing rate) in Firing FF’s
control algo result’s storage location, and uses the same firing rate value on every execution pass
until Firing FF is transferred to Auto mode. Therefore, if the firing rate changes, there is no firing
FF correction applied. However, excess O2 feedback control (AC) remains commissioned, and the
7 Feed rate feedforward and firing/feed ratio control are discussed in Section 10.4.4.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.2 Lowering Fired Heater Stack Excess O2 Targets 369
air/firing ratio controller does respond to the changes in its setpoint calculated by the excess O2
controller (AC) as the stack excess O2 measurement responds to the firing rate change.
Important: Air/firing ratio control uses the actual firing rate (QC PV), not the desired firing rate
(QC SP) calculated by the COT loop. This ensures the combustion control loop is not “fooled” when
the firing controls are not meeting the desired firing target (QC PV noticeably different from QC
SP). This is especially important when the COT loop wants to reduce firing, but the fuel’s control
valve does not respond properly. It is possible, although somewhat complex, to enhance the strategy
in Figure 11.17 by delaying a reduction in air rate (in response to a firing rate decrease) to ensure
the firing rate actually decreases before the air is reduced.
Design Notes and Features
1. Design notes 1–10, applicable to the combustion control strategy in Figure 11.16 relate to basic
forced draft heater excess O2 and firebox pressure cascade components that are common to
control strategies with and without air/firing ratio control. Thus, they are applicable to the
combustion control strategy in Figure 11.17 as well.
2. A firing rate flagged “Bad” will stop the Firing FF controller from executing its control
calculation. Thus, the value stored to Firing FF control algo result’s storage location on the
last normal execution pass, the last “Good” firing rate value, is used for air/firing ratio control.
Since the firing rate is in an FF loop, this is acceptable. The excess O2 feedback control remains
commissioned without firing FF control, until the firing rate calculation returns “Good”.
3. Excess O2 control continues even if firing rate FF is turned Off by transferring Firing FF into
Manual mode. The air/firing ratio controller executes normally, with a constant firing rate (the
firing rate stored on the last execution pass that Firing FF was in Auto mode). Because the excess
O2 controller continues to reset the ratio controller’s set point, the feedback control loop – excess
O2 control, continues with firing rate FF control Off.
4. Suitable logic must be provided to initialize the air/firing ratio controller when (i) firing rate FF
is turned On (Firing FF transferred to Auto mode) and (ii) an unavailable firing rate calculation
returns “Good”. After the air/firing ratio controller is initialized, standard DCS features initialize
the excess O2 controller.
5. The firing controls design8 directs the BTU controller (QC) to use the last “Good” value of the
heating value in the heat duty calculation (QC PV) when fuel gas heating value FF is turned Off
or the heating value measurement is declared invalid. Firing control logic initializes the heat
duty controller (QC) when (i) fuel gas heating value FF is turned On or (ii) an unavailable (or
invalid) heating value measurement returns available (or valid).9 In both cases, the new (valid)
heating value may be quite different from the last good value and the firing rate (QC PV) will
almost certainly change after QC initializes. Thus, to prevent an unwanted bump to the air flow
rate, suitable logic must be added to monitor the BTU controller’s control status and initialize
the air/firing ratio controller whenever the BTU controller initializes. Once the air/firing ratio
controller initializes, standard DCS features will initialize the excess O2 controller.
Last Thoughts and Closing Remarks
Firing and combustion processes are inherently interactive, but field experience indicates the more
the firing and combustion control cascades interact, the more effective the combustion control
strategy. From among the combustion control strategies presented, the one with air/firing ratio
8 See Design Note #5 in Chapter 10, Section 10.4.6. Also see discussion of Figure 8.6, in Section 8.8.
9 See Design Note #6 in Section 10.4.6, and discussion of Figure 8.6 in Section 8.8.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License370 11 Energy Conservation Controls
control provides the best control performance. With a reliable air measurement and an effective
air/firing controller low setpoint limit, it is most likely to stay out of flood. Inclusion of air/firing
ratio control is one example of how combustion control performance is improved by including an
interaction with the firing controls.
Notice that in Figure 11.17, the firing controls are directly linked to the combustion controls via
Firing FF, but there is no direct linkage to the firing controls from the combustion controls. There
are more complex firing/combustion control strategies implemented for boilers (Ref. [1]) and fired
heaters (Ref. [2]) that are said to be cross-linked – not only are the firing controls directly linked to
the combustion controls, the combustion controls are directly linked to the firing controls. When
implemented, they are very effective at minimizing, but still do not eliminate, the risk of heater
flood. However, their design features – the user provided code/configuration required to manage
commissioning, decommissioning, initialization and wind-up are very complicated. This makes
their development, implementation, long-term maintenance, and operator training requirements
very resource intensive.
11.3 Reducing Tower Reboiler Duty and Reflux Flow
Product quality control in two-product distillation towers and distillation towers with a single
sidestream are presented and discussed in detail in Chapter 12. The CVs, MVs, DVs and calculated
variables that describe tower operating conditions are presented, and the most frequently chosen
CV–MV pairings for control are summarized. Overviews of basic regulatory, advanced regulatory,
and conventional advanced control strategies are presented, and their application to realistic, indus￾trially important tower configurations are described. This section’s focus is limited to the roles
reboiler duty and reflux flow play in tower operations, their relationship to tower energy utilization
and separation, and how their control can reduce energy utilization.
A typical two product (distillate and bottoms) tower is shown in Figure 11.18. Heat provided by
the reboiler (QR) generates the tower’s vapor boil-up. A large portion of the heat provided by the
reboiler is lost to air or water in the overhead condenser (QC) where the vapor is condensed. The
condensed liquid accumulates in the reflux drum and is withdrawn as distillate product and/or
is returned to the tower as external reflux. The tower configuration in Figure 11.18 includes a
complete condenser, e.g., there is no vapor product, but partial condensation and both liquid and
vapor overhead products are not unusual. Vapor and liquid loadings play a large role in determining
the tower’s separation, e.g., the amount of impurities removed with the bottoms and/or distillate
products. Vapor/liquid loadings, and hence separation is strongly dependent on the tower’s reboiler
heat input, its condenser duty, and the reflux flow.
Whenever possible, reboiler heat requirements are met by heat integration with process streams
in both upstream and downstream units. The process configurations presented in Sections 11.1.2
(in Figure 11.6), 11.1.3 (in Figure 11.8) and 11.1.4 (in Figure 11.10) include light-ends tower
reboilers heat integrated with various process streams. Reboiler energy requirements not met by
heat integration are met by steam, or (rarely), when very large amounts of reboiler heat duty is
required, by fired heaters.10 Reboilers compete with other heat consumers for available process
heat. In individual towers, energy savings are captured if product quality requirements are met at
reduced reboiler duties and/or reflux flow rates. For an individual tower, reducing reboiler duty
decreases condenser duty, and thus heat lost to the condenser’s air or cooling water is decreased.
Reducing reboiler duties plant wide makes additional process heat available to other units, leads
10 An example is presented in Section 12.9.3.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.3 Reducing Tower Reboiler Duty and Reflux Flow 371
P
TI F
TI
L
F
F
TI
F
CW
TI
QR
QC
Reflux (R) Distillate (D)
Btms (B)
Reflux drum
level (LR)
Btms
level (LB)
Pressure
Feed (F)
CVs MVs
Reflux drum level
Bottoms level
Pressure
D quality
B quality
Reflux flow (R)
Distillate flow (D)
Reboiler duty (QR)
Condenser duty (QC)
Bottoms flow (B)
L
F
Figure 11.18 Two Product Tower – Controlled Variables and Manipulated Variables
to more efficient heat recovery, and ultimately to reductions in preheat heater fuel consumption
and total heat lost to cooling water or air.
The table included in Figure 11.18 shows the most important CVs and MVs for this tower
configuration. For most towers, designers specify the inventory control strategy – how reflux
drum and bottoms level are controlled, based on surge capacity and reflux, distillate, and bottoms
flow rangeabilities. After establishing the CV–MV inventory control pairings, the MVs that
remain are available to satisfy the remaining control objectives. In this section’s discussions, we
assume the following CV–MV pairings: (i) bottoms level with bottoms flow (B), (ii) pressure with
condenser duty (QR), and (iii) reflux drum level with either the distillate (D) or reflux rate (R).
With these pairings, the reboiler duty and either the reflux flow or distillate flow, whichever is not
manipulated to control reflux drum level, are the available MVs to pair with the remaining two
CVs – distillate and bottoms product qualities.
Cutpoint and fractionation are terms used to describe how the MVs in Figure 11.18’s table affect
tower operations as they are adjusted to control product qualities at desired targets. Cutpoint refers
to how feed components are separated – feed components with boiling point above a cutpoint
temperature (the “heavy” components) are separated as bottoms product, and feed components
with boiling point at or below the cutpoint temperature (the “light” components) are separated as
distillate product. As discussed in Section 12.6, cutpoint is closely associated with the tower mate￾rial balance. However, there are heavy components (feed components with boiling point above
the cutpoint temperature) that are separated with distillate product, and light components (feed
components with boiling point below the cutpoint temperature) that are separated with the bot￾toms product. Fractionation refers to how well the feed components are separated by their boil￾ing point, e.g., how much heavy component is separated with distillate product, and how much
light component is separated with bottoms product. Fractionation is closely associated with the Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License372 11 Energy Conservation Controls
tower’s energy balance (see Section 12.6), e.g., the vapor (reboiler duty) and liquid (internal reflux)
loadings. Thus, reboiler duty and reflux rate have a major impact on fractionation and product
impurities at the cutpoint temperature.
When both overhead and bottoms product qualities must be controlled, e.g., dual product quality
control, the two MVs identified above as available must be paired with the two quality CVs. No
matter how these two MVs are paired with the two quality CVs, if both product quality targets must
be satisfied, neither reboiler duty nor reflux flow can be fixed independently – reboiler duty and
reflux flow are both determined by the quality control requirements. Note that when both product
quality targets are satisfied, they are in principle satisfied at the minimum heat input, e.g., the heat
input required to just meet the two quality targets.
When only one product quality is controlled, only one of the two remaining MVs – reboiler duty
and either reflux or distillate flow, must be paired with the one quality in closed-loop control. For
most single-product quality control towers, it is either reflux flow or reboiler duty that remains
available and can be fixed independently to manage fractionation.
A specific tower’s operating objectives and economic drivers are typically assessed offline, and the
tower reboiler duty and reflux flow are by-products of that analysis. However, finding the optimal
value of reboiler duty or reflux flow is a trade-off between higher energy costs, and the value of
yield increases. Increasing heat input (reboiler duty) or removal (reflux flow) is justified if incre￾mental energy costs are lower than the yield improvement’s incremental value. Alternative uses of
process heat in downstream units may also have to be assessed. When the outcome of this trade-off
changes on a relatively routine basis, it must be resolved in real-time, within the scope of an online
RTO application. When the energy-yield tradeoff does not change on a routine basis, reboiler duty
and/or reflux flow targets are normally calculated offline by process technical specialists and com￾municated to console operators via daily directives.
For individual towers, reflux flow and reboiler duty are usually controlled by maintaining a
constant reboiler duty to feed or constant reflux to feed ratio. Internal reflux is a more accurate
measure of fractionation than external reflux because it includes the impact of reflux temperature
upsets. Thus, when the measurements needed to calculate internal reflux are available (see Section
3.7.2), internal reflux/feed ratio is normally controlled instead of reflux/feed ratio. When reboiler
duty, external reflux or internal reflux are not ratioed to feed, operators will typically over-reflux
or over-reboil the tower to insure there is enough heat input and reflux flow for the entire range of
the tower’s feed rates. This reduces the time operators spend monitoring the tower’s operation but
wastes energy at all feed rates below the highest expected rates.
Two realistic process examples follow. The first is a tower in virgin (crude) light-ends service, with
reboiler duty the available MV to manage fractionation and the second is a tower in an aromatics
plant’s product fractionation section, with internal reflux the available MV to manage fractionation.
Many more examples are presented and discussed in Chapter 12.
11.3.1 Crude Light-ends Section: Naphtha Splitter Fractionation Control
The first example concerns fractionation management in a virgin naphtha splitter in an oil
refinery’s crude light-ends section. A typical crude light-ends section configuration is shown in
Figure 11.19. The crude light-ends section’s feed is naphtha hydrofiner (NHF) reactor effluent;
this is CDU distillate product after removal of metals, sulfur, nitrogen, and some light components
in the NHF. The remaining light components are removed from the reactor effluent in the
deethanizer (C2−), the debutanizer (C4), and the virgin naphtha splitter (C5 and some C6 material).
The naphtha splitter bottoms product is heavy virgin naphtha (HVN), the primary feedstock for
Catalytic Reforming; its overhead product is light virgin naphtha (LVN), which is isomerization
unit feed and/or motor gasoline (MOGAS) blend stock.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.3 Reducing Tower Reboiler Duty and Reflux Flow 373
To amine scrubber,
FG system 
MOGAS
blending
DeC4
To amine scrubbing,
C3/C4 splitter From C4–
naphtha H/F
C3+
DeC2
C2–
Naphtha
splitter
Catalytic
reforming
reactors
To aromatics plant 
C5+
C5–
C6+
LVN
HVN 
Isom
feed
∞
Figure 11.19 Typical Crude Light-ends Section Tower Configuration
There are two possible naphtha splitter operating objectives: (i) upgrade the heaviest LVN
components to more valuable HVN or (ii) drive C6 into the LVN to minimize benzene make in
the catalytic reformer. The reformer reactions convert the C6 components to benzene, which
must be kept below a stringent low limit in the MOGAS product. If reformate is an aromatics
plant feedstock to make benzene, toluene, and xylene products, then upgrading LVN to the HVN
product is more important. If the reformate is not an aromatics plant feedstock, the reformate
is predominantly used as a MOGAS blend stock, and driving the C6 components into the LVN
product is more important.
A typical virgin naphtha splitter process configuration is presented in Figure 11.20. Since the
reformate is an aromatics plant feedstock, the most important operating objective is to upgrade
LVN to HVN. This is accomplished by controlling the HVN 5% distillation point (AI95 PV) at a
target that minimizes the HVN C5 content. The design basis for the inventory controls have paired
the bottoms level (LC80) with the HVN flow to storage (via LV80), and the reflux drum level (LC89)
with the reflux flow (via LV89). The flow of HVN to catalytic reforming is on flow control (FC82) to
minimize reactor upsets. T-85’s distillate product, LVN, is routed to Isom unit feed storage on flow
control (FC86), and is the MV for control of the HVN 5% distillation point.11
Much of Chapter 12 is devoted to control strategies that meet tower product quality targets. In
Section 12.7.5, manipulating the distillate flow to control a product quality is discussed, and the
control strategy’s cascade structure is presented in Figure 12.28. This cascade is applicable to T-85’s
HVN 5% point control, and a suitable HVN 5% point control strategy can be designed by map￾ping each control component in Figure 12.28 to the corresponding measurement in Figure 11.20.
However, since the current focus is on fractionation management, and because much of Chapter
12 is devoted to tower product quality control, the HVN 5% point control strategy will not be
presented/discussed here.
Since the reflux drum level is paired with the reflux flow and the HVN 5% point is paired with the
distillate flow, fractionation can be independently set by controlling reboiler E-89 duty. Note that
11 As explained in Section 12.2.2, reboiler duty is a better MV choice for the quality control loop, but the distillate
rate, the other available degree of freedom, is a poor choice to manage fractionation.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License374 11 Energy Conservation Controls
T
8
5
E-89
LC
80
CDU
TPA
Virgin
naphtha
splitter
FV89
TI
90
FI
89
C6
in LVN
TI
87 TI
88
FC
87
LVN to Isom
feed storage
PC
77
FI
83
E-88
FC
86
D-115 LC
89
AI
85
LV89
FC
82
AI
95
HVN to
cat reforming 5% dist
point
HVN to
storage 
TI
89
LV80
∞
Figure 11.20 Crude Light-ends Section’s Naphtha Splitter (T-85) Configuration
in Section 12.7.4 manipulating reboiler duty to manage fractionation is discussed, and the control
strategy’s cascade structure is presented in Figure 12.27. This cascade is applicable to fractionation
management in T-85, and a suitable fractionation management strategy can be designed by map￾ping each control component in Figure 12.27 to the corresponding measurement in Figure 11.20.
The control cascade that results is shown in Figure 11.21.
All measurements needed to calculate the reboiler duty (QC89 PV) are available – hot side inlet
(TI88 PV) and outlet (TI89 PV) temperatures, and CDU TPA flow to E-89 (FI89 PV):
QC89 PV = Scale ∗ FI89 PV ∗ CP ∗ (TIV88 PV − TIV89 PV) (11.8)
Both inlet and outlet temperatures are externally multiplexed measurements, and both must be
validated (in TIV88 and TIV89) before their use in the control strategy. The reboiler duty is ratioed
to the feed rate (in RC89) to save energy and lower costs when feed rate decreases.
The desired heat duty/feed ratio, (RC89 SP) is calculated offline to provide sufficient fraction￾ation and either (i) reduce E-89 heat duty or (ii) increase bottoms product (HVN) recovery. With
no regard for the overhead product’s C5 content, increasing RC SP to increase E-89 duty will drive
more vapor overhead, which is condensed in overhead condenser E-88. Reflux drum level rises,
and level controller LC89 increases the reflux flow. The higher vapor and liquid loadings improve
fractionation, and the light components (C5−) in the HVN product and the heavy components (C6+) Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.3 Reducing Tower Reboiler Duty and Reflux Flow 375
TIV88
TIV89
QC89
SP
E-89
duty
FC
87 RC89
SP
E-89 duty/
feed
Desired
duty/feed ratio
FCG87 Feed rate
Dynamic
compensation
E-89 hot side
inlet temperature
E-89 hot side
outlet temperature
Validation
SP
CDU TPA FV89
FC
89
FI
89
TI
89
TI
88
Figure 11.21 Naphtha Splitter (T-85) Fractionation Management
in the LVN product both decrease. In response, the bottoms quality controller (AC95) decreases dis￾tillate draw-off to compensate for the higher HVN 5% distillation point (due to less C5− in the HVN).
The decrease in distillate rate tends to increase reflux drum level further, and in response, LC89
increases reflux flow further. This then tends to increase T-85 bottoms hold-up, and in response,
LC80 increases the HVN flow to storage – increasing HVN recovery. Note: The decrease in distillate
flow rate also reduces the amounts of C6+ in the LVN product. As will be discussed in Chapter 12,
improvements in fractionation make both products in a two-product tower purer.
If driving C6 components into the LVN becomes a second operating objective, then RC89 SP
would be manipulated to control the C6 in LVN product (AI85 PV). Reboiler duty would no longer
be an independent degree of freedom to fix the tower’s fractionation, but instead, fractionation
would be set by meeting both product quality targets. Note: To control both qualities, the CV–MV
pairings would most likely be changed – HVN 5% point paired with reboiler duty, and LVN C6
paired with distillate flow (see Section 12.2.2).
Design Notes and Features
1. This control strategy is a simple cascade – cascade initialization and wind-up are both handled
by standard DCS features.
2. FC89 is a conventional flow controller and hence its control direction = Reverse. Since FC89 is
a secondary, it is tuned for best SP response, proportional on error, with SP Init = Yes.
3. Since QC89 outputs to a flow set point (FC89 SP), it can either be configured as a PID or with
an algebraic control algorithm that calculates FC89 SP directly. If configured as a PID, QC89’s
control direction = Reverse. QC89 configured as a PID makes FI89 PV noise an issue – to mini￾mize the propagation of FI89 PV noise to FC89 SP, it is best to use FC89 SP, not FI89 PV, in the
QC89 PV calculation in Equation (11.8). Since FC89 is a secondary, it is already configured for
SP Init = Yes. Additional logic is usually provided to use FC89 PV in the duty calculation when
FC89 is wound-up and in cascade (or Auto) mode. Note that QC89 still calculates realistic new
values of FC89 SP when the set point is in the non-constrained direction.
4. QC89 is a cascade secondary and thus if configured with a PID control algorithm, it is tuned for
best SP response, proportional on error. Whether configured with a PID or an algebraic control
algorithm, it is configured with SP Init = Yes.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License376 11 Energy Conservation Controls
5. RC89 is not a PID controller and requires no tuning. Since it is a cascade primary, and its
setpoint value is established offline, setting SP Init = No is in principle acceptable. However,
this may cause a bump to QC89 SP on an RC89 initialization pass. If a QC89 bump is unaccept￾able, configure RC89 SP Init = Yes, but provide additional logic to slowly ramp the initialized
RC89 SP back to the last (guideline) SP value.
6. If FC87 SP (instead of FC87 PV) is the dynamic compensation tag’s (FCG87) input to avoid feed
rate measurement noise propagation to QC89 SP, FC87 must be configured for SP Init = Yes.
If FC87 is an ultimate secondary in another control cascade, it is already configured for SP
Init = Yes. If not a secondary, and SP Init is reconfigured to Yes to use FC87 SP, additional logic
may be needed to replace FC87 SP with FC87 PV when FC87 is wound-up and in Auto mode.
7. Custom logic must be provided to ensure the feedback loop is unaffected by a FF loop problem.
Potential FF loop problems are: (i) the feed flow measurement, FC87 PV, becomes unavailable
and (ii) either E-89 hot side inlet (TI88 PV) or outlet temperature (TI89 PV) is declared invalid.
Since these three measurements are in FF loops, if any one of the three measurements fail, it
is appropriate to use its last “Good” value.
Note: When either E-89 hot side inlet (TI88 PV) or outlet (TI89 PV) temperature is declared
invalid, and a last “Good” value is used in the duty calculation (Equation (11.8)), the
RC89 → QC89 → FC89 cascade (feedback control) is still commissioned. RC89 still adjusts the
heat duty setpoint (QC89 SP) when feed rate and/or RC89 SP change.
8. Feed rate FF control is turned On/Off by transferring FCG87 to Auto/Manual mode.
9. Custom logic must be provided to initialize ratio controller RC89 when (i) feed rate FF is turned
On and (ii) an unavailable feed measurement FC87 PV becomes available.
10. As discussed in Section 8.8 and displayed in Figure 8.5, when either E-89 hot side inlet or outlet
temperature returns valid after being declared invalid, custom logic must initialize heat duty
controller QC89 to prevent a bump to FC89 SP on the first execution pass after QC89 initializes.
Standard DCS features initialize RC89 anytime QC89 initializes.
Last Thoughts and Closing Remarks
If both HVN (AI95) and LVN (AI85) product qualities must be controlled and maintained at tar￾get, the two quality control loops will interact. Distillate flow rate adjustments (FC86 SP) and
reboiler duty adjustments (FC89 SP) made to control LVN and HVN qualities will interact. These
CV–MV interactions are difficult to manage, and can degrade both control loop’s performance.
If interactions are a problem that cannot be managed with conventional controls, conventional
model-based control may improve control performance. For example, HVN 5% point and LCN C5
dynamic models, developed from plant test data, can include the dynamic effects of both distil￾late flow and reboiler duty changes on each quality. Thus, on each control execution pass, calcu￾lated values of distillate flow and reboiler duty incorporate the dynamic effects of each MV on
both CVs.
If other T-85 process variables in the control strategy’s scope affect the two control variables,
there is value to incorporate their dynamic effects into the model prediction as disturbance and/or
FF variables. However, as described earlier, if the scope of the control problem becomes wider, it
is impractical to use conventional model-based control, and a true multivariable model-based con￾troller such as DMC is required. Since the naphtha splitter’s operations are closely tied to upstream
(crude light-end section towers in Figure 11.19) and downstream (catalytic reformer, isomerization
unit) operations (as indicated in Figure 11.20), a larger scope multivariable DMC controller that
includes these upstream and downstream unit operations may be justified and ultimately become
the preferred approach.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.3 Reducing Tower Reboiler Duty and Reflux Flow 377
Toluene
tower
Benzene
tower
T
6
8
0
D-675
E-671
CW
AI
695
Toluene in
benzene Light
reformate
E-673
Steam
Xylene
tower
T
6
9
0
E-678
C9+ in
xylene
product
E-679
Hot
oil Heavy
reformate
AI
604
Toluene in
xylene
AI
605
Xylene
product
T
6
8
5
D-675
E-674
Toluene
product
E-675
Hot
oil
Benzene
product
Aromatics
from extraction
section
∞
Figure 11.22 Typical Aromatics Plant (Benzene/Toluene/Xylene) Product Fractionation Section
11.3.2 Aromatics Plant: Toluene Tower Fractionation Management
In this tower fractionation control application, heat removal (via changes in reflux flow), not heat
input (via changes in reboiler duty), is manipulated to achieve the desired degree of fractionation.
A typical aromatic plant’s product fractionation section configuration is shown in Figure 11.22.
The feed is an aromatics rich stream recovered from catalytic reformer reactor effluent. There are
three towers in series that separate three aromatics products. A benzene product is separated as a
sidestream in the benzene tower, T-680. The benzene tower’s bottoms product is feed to the Toluene
tower, T-685, where an overhead toluene product is separated. The toluene tower’s bottoms product
is feed to the Xylene tower, T-690, where an overhead Xylene product is separated.12
The benzene product, T-680’s sidestream, has a minimum toluene impurity target. The toluene
product, T-685 overhead, does not have a xylene impurity target. However, there is a low toluene
impurity limit for the xylene product, separated as T-690 overhead. Since toluene boils at a lower
temperature than xylene, any toluene in T-685 bottoms product is removed with the xylene product
at T-690’s overhead. Therefore, T-690 operational adjustments cannot affect the toluene impurity in
its overhead product. Only T-685 operational adjustments can affect the toluene impurity in T-690
overhead’s xylene product.
12 More recent aromatics plant fractionation section tower designs have combined the three towers in Figure 11.22
into one tower.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License378 11 Energy Conservation Controls
T
6
8
5
Toluene
product
Toluene
tower
E-678
T
6
9
0
E-679
AI
604
Toluene in
xylene
Xylene
product
Hot
oil
Heavy
reformate
LC
639
TI
631
Xylene
tower
Benzene
tower Btms
FC
630
FC
632
D-675 LC
638
E-674
PC
636
FV631
TI
633
E-675
Hot
oil
FC
633
TI
634
TI
635
∞
TI
632
FC
631
Figure 11.23 BTX Product Fractionation Section’s Toluene Tower (T-685) Configuration
Toluene and Xylene tower process configurations and instrumentation details are shown in
Figure 11.23. Refer to Figure 11.23 – with distillate flow paired with D-675’s level (LC638), pressure
(PC636) paired with E-574 duty, and bottoms level (LC639) paired with bottoms flow (FC632),
reflux flow (FC631) and reboiler duty (via FC633) are the MVs available to pair with AI604 PV and
manage T-685 fractionation. In Section 12.9.4, a toluene in xylene (AI604 PV) control strategy that
pairs T-690’s overhead quality AI604 PV with E-675 duty (via FC633) is presented and discussed.
Since the focus here is on fractionation management, this toluene in xylene control strategy is not
discussed here – however, it is displayed in Figure 12.54 and discussed in Section 12.9.4.
Since T-685 reboiler (E-675) duty is paired with AI604, T-685 fractionation is independently set
by controlling heat removal, via the reflux flow, FC631. Since internal reflux is a more accurate
measure of fractionation than external reflux, and the measurements required to calculate internal
reflux are available,13 internal reflux is used to set T-685 fractionation. In Section 12.7.2, manipulat￾ing internal reflux to manage fractionation is discussed, and the control strategy’s cascade structure
is presented in Figure 12.24. This cascade is applicable to fractionation management in T-685, and
a suitable fractionation management strategy can be designed by mapping each control component
13 See Section 3.7.2 for internal reflux calculation details.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.3 Reducing Tower Reboiler Duty and Reflux Flow 379
Desired
internal reflux/feed
ratio
TIV632
FCG630
FC641
RC641
Validation
Dynamic
compensation
SP
SP
T-685 external
reflux flow
Internal reflux/
feed ratio
Internal reflux
calculation
and control
FC
631
SP
FC
630
TI631TYP
FV631
TI
632
Reflux
temperature
“Typical”
T-685 overhead
temperature
T-685 feed
rate
Figure 11.24 Toluene Tower (T-685) Fractionation Management
in Figure 12.24 to the corresponding measurements in Figure 11.23. The control cascade that results
is shown in Figure 11.24.
Referring to the internal reflux calculation discussed in Section 11.1.1 (Equation (11.1)), internal
reflux (FC641 PV) is calculated using Equation (11.9) below. The reflux temperature, TI632, is an
externally multiplexed measurement, and is validated (in TIV632) before its use in the internal
reflux calculation.
FC641 PV = Scale ∗ FC631 PV ∗ [1 + (CP∕𝜆)∗(TI631TYP − TIV632 PV − 𝛿)] (11.9)
In Equation (11.9):
FC641 PV Internal reflux, T-685 rectifying section
FC631 PV T-685 external reflux flow rate
TI631TYP “Typical” value of overhead temperature
TIV632 PV Validated value of reflux temperature, TI632 PV
CP External reflux specific heat
𝜆 Overhead vapor latent heat of vaporization
𝛿 Average difference between vapor dew point and bubble point
Scale factor Scale is included to ensure FC641 PV has the desired engineering units, while CP, 𝜆
and 𝛿 are provided by the process group, entered manually, and maintained constant. TI631TYP can
be a design value, a true typical value, or the validated measured overhead temperature (TIV631 PV)
when the internal reflux controller FC641 initialized last. If the design value or a true typical value
is used, it is entered manually and maintained constant.
The desired internal reflux/feed ratio (RC641 SP) is calculated offline, by process specialists,
based on a yield, energy trade-off – the value of more internal reflux to improve fractionation and
thus the xylene product’s quality or its recovery, vs the cost of the additional reboiler heat input
required.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License380 11 Energy Conservation Controls
Design Notes and Features
1. This control strategy is a simple cascade, and cascade initialization and wind-up are both
managed by standard DCS features.
2. FC631 is a conventional flow controller and therefore it is configured with control
direction = Reverse. As a cascade secondary, it is tuned for best SP response, proportional on
error with SPInit = Yes.
3. Since FC641 outputs to a flow controller’s set point (FC631 SP), it can either be a PID controller,
or have an algebraic control algorithm that calculates FC631 SP directly. If the control algo￾rithm is algebraic, the external reflux flow setpoint is calculated by inverting Equation (11.9),
after replacing FC641 PV with FC641 SP:
FC631 SP = FC641 SP∕(Scale ∗ [1 + CP∕𝜆 ∗ (TI631TYP − TIV632 PV − 𝛿)]) (11.10)
4. If FC641 is configured as a PID, its control direction=Reverse – if FC641 PV is increasing and/or
is above its set point, it must decrease reflux flow. As a cascade secondary, FC641 is tuned for
best SP response, proportional on error. Whether configured with a PID or an algebraic control
algorithm, it is configured with SP Init = Yes
5. RC641 is not a PID controller and requires no tuning. As a cascade primary whose set point is
an offline specified guideline value, setting SP Init = No is in principle appropriate. However,
this may cause a bump to FC641 SP, and then to FC631 SP, after an RC641 initialization pass.
If an FC631 SP bump is unacceptable, then configure RC641 with SP Init = Yes, and provide
additional logic to slowly ramp the set point’s initialized value back to the guideline value.
6. If FC630 SP (instead of FC630 PV) is used as the feed rate’s dynamic compensation tag’s
(FCG630) input to avoid feed flow measurement noise propagation to the internal reflux loop,
FC630 must be configured for SP Init = Yes. If FC630 is an ultimate secondary in another
control cascade, it is already configured for SP Init = Yes. If not, this issue should be discussed
with operations before final design and implementation.
7. Feed rate FF control is commissioned by transferring FCG630 into Auto mode and decommis￾sioned by transferring FCG630 into Manual mode.
8. If the feed measurement (FC630 PV) is unavailable, this FF loop problem must not adversely
affect the feedback control loop (internal reflux/feed control). Whether FC630 PV or SP is
configured as FCG630’s wild flow input, custom logic must ensure a last “Good” value is used
when FC630 PV is unavailable until the measurement becomes available again. If so, RC641’s
wild flow input is constant (no feed rate FF control), but RC641 still responds to feed rate
upsets/changes and operator entered RC641 SP changes by outputting a new FC641 SP.
9. Custom logic must be provided to initialize ratio controller RC641 when (i) feed rate FF is
turned On and (ii) an unavailable feed measurement returns available.
10. One of the purposes of internal reflux control is to compensate for reflux temperature upsets.
When the reflux temperature measurement (TI632 PV) is declared invalid (by TIV632) or
it becomes unavailable, with its last “Good” value used to calculate the internal reflux flow
(FC641 PV), reflux temperature upsets do not impact FC641 PV. However, when feed rate
(FC630) changes or an operator changes RC641 SP, RC641 still responds and changes internal
reflux (FC641 SP); FC641 then resets external reflux flow (FC631 SP). If FC641 is configured
to algebraically calculate FC631 SP directly (using Equation (11.10)), it will calculate the same
value of external reflux (FC631 SP) on each control execution pass after feed rate or RC641
SP changes.14 Thus, there is no debit for keeping internal reflux control commissioned when
reflux temperature is declared invalid.
14 If FC641 is configured as a PID controller, it will not wind-up FC631 SP since FC631 SP changes, and their
subsequent effect on FC631 PV, impact FC641 PV.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.3 Reducing Tower Reboiler Duty and Reflux Flow 381
11. When the reflux temperature returns valid, custom logic must initialize FC641. As shown
below in Equation (11.11), FC641 SP is back calculated using Equation (11.9) with the current
external reflux flow setpoint (FC631 SP) and the new, valid value of the reflux temperature
(TI632NEW). FC641 will send an initialization request to RC641, and standard DCS features
will initialize RC641.
FC641 SP = Scale ∗ FC631 SP ∗ [1 + (CP∕𝜆)∗(TI631TYP − TIV632 PVNEW − 𝛿)]
(11.11)
11.3.3 Light-ends Tower Pressure Minimization
For some light-ends towers, ENCON credits can be captured by reducing the tower’s operating
pressure. Lower tower operating pressures allow the same separation to be achieved at lower
reboiler duty and reflux flow. Pressure minimization benefits are due to pressure’s effect on the
relative volatility of the light hydrocarbon components being separated. Successful applications
have been implemented for many light-ends towers, including DeC4 and C3/C4 splitters.
For any distillation tower, as differences in component boiling points increase, their separation
becomes easier. Relative volatility defines the relative tendency of two components to vaporize at a
given temperature, pressure, and composition (Ref. [3]). Relative volatility is thus an indicator of
the components’ boiling point difference and hence their ease of separation. For two components,
A (more volatile) and B (less volatile), the relative volatility (𝛼) is defined as the mole percent ratio
of A and B in the vapor phase (yA/yB) to their mole percent ratio in the liquid phase (xA/xB):
𝛼 = yA∕yB
xA∕xB
(11.12)
Since A is more volatile than B, yA/yB >1 and xA/xB <1; therefore, 𝛼 >1. As the difference in
components A and B boiling points increase, the ratio yA/yB increases, the ratio xA/xB decreases,
and 𝛼 increases. Thus, the larger the relative volatility, the easier the separation. When the com￾ponent boiling points approach each other, both ratios in Equation (11.12) approach one, and the
relative volatility also approaches one. When 𝛼 =1, separation via distillation is thermodynamically
impossible.
The relative volatilities of the light components in hydrocarbon mixtures increase as pres￾sure is reduced. Thus, as pressure is reduced, separations of these lighter components become
thermodynamically easier, and in principle less heat input and heat removal are required to
maintain the same separation. There are two ways to capture the benefits of lowering tower
pressures. As above, if reboiler duty and/or reflux flows are reduced as pressure is reduced, the
same separation can be achieved (product qualities or product recovery unchanged) at lower
energy costs. However, if reboiler duty and/or reflux flows are maintained constant, both products
become purer or if only one product’s quality is controlled, product recovery increases. Hence,
at the lower pressure, instead of saving energy by reducing reboiler and condenser energy costs,
purer products or improved recovery are obtained.
For a tower that does not interact closely with upstream and/or downstream process units,
minimum pressure can be optimal. For such a tower, a pressure minimization control strategy
consists of lowering tower pressure until a tower constraint is encountered. The MV is the tower’s
pressure controller setpoint. Although conventional constraint control can sometimes be effective,
currently pressure minimization is almost always implemented within a larger scope DMC
controller. Whether conventional constraint control or DMC is used, there are several constraints
that limit the pressure’s reduction and hence they must be honored. Here are the most commonly
encountered limiting constraints:
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License382 11 Energy Conservation Controls
● As pressure decreases, all tower temperatures, including the overhead condenser inlet temper￾ature, decrease. This reduces the driving force for heat transfer in the condenser. To detect a
condenser constraint, the difference between overhead and reflux temperatures is monitored
(minimum constraint). This is the most frequent limiting constraint.
● When tower products feed downstream units, the downstream pressure can limit how low the
tower pressure can go and still maintain the desired flow to the downstream units. This is the
next most frequent limiting constraint. This often requires monitoring one or several tower level
PVs, flow PVs and valve positions (all max constraints).
● Vapor handling ability degrades as the pressure decreases. Thus, heavily loaded towers must
be monitored for flooding as tower pressure is reduced. This normally requires monitoring a
pressure difference in the tower section (rectifying or stripping) prone to flood.
As the tower pressure is decreased, either the reboiler duty or the reflux flow must be reduced
to capture ENCON credits. If both product qualities are controlled, because fractionation has
improved at the lower pressure, analyzer controller feedback is able to lower reboiler duty and/or
reflux flow while maintaining product quality at their desired targets. Thus the “minimum” heat
input required to meet both quality targets is reduced by reducing the tower’s operating pressure.
When only one product quality is controlled, the choice described above is in play – either allow
product recovery to improve, or reduce energy utilization by providing logic/code to simultane￾ously reduce reboiler duty or reflux flow as the pressure is reduced. The reduction in reboiler
duty or reflux flow per unit decrease in pressure that maintains constant fractionation must be
evaluated for each tower; assistance of process engineers is normally sought. For a majority of the
conventional constraint control strategies implemented to minimize pressure, energy credits have
been captured (reboiler duty or reflux flow reduced) rather than improving product recovery.
Whether one or both product qualities are being controlled, when pressure is being minimized,
and tray temperature control is included in the quality control cascade, it is best to pressure
compensate the controlled tray temperature (see Section 3.7.3). Tower pressure, temperature, and
composition are all related via equilibrium. If pressure changes at constant temperature, com￾positions on all trays will change, and if uncorrected, product qualities will be upset. Pressure
compensation of temperature is a FF correction that corrects for pressure upsets before the product
quality is upset. When there is PID or model-based product quality control, pressure compensating
the tray temperature speeds up the quality loop’s response and the product quality upset is
diminished or avoided.
Pressure compensation of the tray temperature is especially important when (i) the temperature
controller is the quality loop’s primary, i.e., there is no closed-loop quality control, (ii) pressure is
uncontrolled, and (iii) the tower is susceptible to pressure upsets. Without pressure compensation
of tray temperature, product quality feedback will eventually correct the quality changes caused by
the pressure upset. However, a primary tray temperature controller with no pressure compensation
will not respond at all to a pressure upset, and thus product quality will change even at constant
tray temperature.
Last Thoughts and Closing Remarks
Pressure minimization applications are now almost always implemented within a DMC controller
whose scope is wider than an individual light-ends tower. This is especially important for a tower
that is tightly coupled to multiple towers and/or other process units. The tower’s minimum
operating pressure depends upon the specific process configuration, upstream and downstream
unit operating objectives and constraints. Thus, the active constraint that limits how low the
pressure goes may be an upstream or a downstream unit’s PV.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.4 Reducing Stripping Steam Utilization 383
The cost of energy and the difference in value between distillate and bottoms product15 ultimately
determine whether it is more profitable to decrease energy utilization or increase product recovery.
For an individual tower, offline evaluation of this energy-yield trade-off is normally straightforward.
If minimizing pressure is known to be best, and if the most profitable option (decrease energy
consumption or increase product recovery) is not expected to change very often, then the “best”
operation is fixed, and DMC is tuned to minimize pressure subject to the most profitable option.
However, if the trade-off changes on a regular basis, and especially if an optimum pressure, as
opposed to a minimum pressure, is best, then the energy-yield trade-off is best resolved online and
in real time. This requires detailed, nonlinear, steady-state models, real economics, and an opti￾mizer. DMC is ill-equipped to resolve energy-yield trade-offs in real time – this requires nonlinear,
detailed models, economic trade-offs and RTO technology.
11.4 Reducing Stripping Steam Utilization
Most process steam used for stripping is produced in fired heaters (boilers) and thus reducing strip￾ping steam utilization can capture ENCON credits by decreasing boiler fuel consumption. There
are three important process uses for stripping steam:
● In primary and main fractionators: Remove light hydrocarbon components in the tower’s strip￾ping section (below the feed tray) and recover them as more valuable distillate product instead
of less valuable bottoms product.
● In primary and main fractionator sidestream steam strippers: Remove light hydrocarbon com￾ponents to meet a sidestream product’s front-end property target, e.g., flash point.
● In sour water strippers (SWS): Remove NH3 and H2S to meet the stripped water NH3 (pH or
conductivity) and H2S concentration targets.
In this section, an overview of each process use is provided, with a focus on how steam utilization
can be reduced while meeting each unit’s operating objectives. Control strategies that help reduce
stripping steam consumption in these process services are presented. All strategies are relatively
simple. Although not a control issue, the challenge is to determine the best, i.e., the lowest steam
flow target that the control strategy must maintain.
11.4.1 Primary Fractionator (CDU) Bottoms Product Steam Stripping
In a CDU, superheated steam is injected below the feed tray to strip out the lower boiling
hydrocarbon components that would otherwise leave the tower with the bottoms product (atmo￾spheric residue). These hydrocarbons are upgraded to the more valuable product removed as the
lowest sidestream. The stripping steam lowers hydrocarbon partial pressure, and thus lowers
hydrocarbon boiling points in the tower’s stripping section. This allows the lower boiling, lighter
hydrocarbon components to vaporize, enter the gas phase, and be upgraded to the more valuable
lowest sidestream product.
Referring to Figure 11.25, the crude feed to CDU T-55 leaves the preheat heater partially
vaporized. All components removed as overhead, or sidestream products enter the flash zone in
the vapor phase. In addition, there is always some overflash,16 atmospheric residue (CDU bottoms
15 If the tower’s products are final products, their values are easily established but if they are intermediate process
streams, their values are more difficult to estimate and energy-yield trade-offs are more difficult to resolve.
16 Overflash is defined as the percent of the feed which enters as vapor but returns to the flash zone as liquid.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License384 11 Energy Conservation Controls
Primary
fractionator
(CDU)
Atm residue FI
92
LC
95
T
5
5
Crude
feed Flash
zone
Superheated
steam
FC
90
FC
60
FV90
FI
92
LC
95
T
5
5
Flash
zone FC
90
Lowest
side stream
FC
60
Figure 11.25 CDU Bottoms Configuration
product) boiling range components that enter the flash zone in the vapor phase but are condensed
above the flash zone and return to the flash zone as liquid. The overflash improves fractionation
immediately above the flash zone (the “wash zone”) and helps improve the lowest sidestream’s
quality and reduce its fractionation overlap with the tower’s bottoms product. The unvaporized
portion of the crude feed and the overflash liquid flow into the tower’s stripping section, just
beneath the flash zone. Superheated steam is injected into the tower below the bottom tray and as
it flows upward it strips some lower boiling components from the downward flowing liquid. The
stripped hydrocarbons in the gas phase flow upwards, through and above the flash zone, where
they are condensed and removed with the more valuable lowest sidestream product.
The incremental effectiveness of steam stripping decreases as the steam rate increases. Steam is
produced in fired heaters that consume energy. Thus, in principle a steam rate will eventually be
reached where the value of the incremental increase in lowest sidestream yield is about equal to
the incremental cost of the steam produced to achieve the yield increase. Maintaining stripping
steam flows below this “break-even” upper limit avoids over-stripping, and hence reduction of
steam stripping benefits.
Like ratioing reboiler duty and reflux flow rate to feed rate, maintaining a constant stripping
steam to tower bottoms flow ratio helps reduce stripping steam utilization. Without steam/bottoms
ratio control, operators typically use more steam than necessary to insure there is enough steam for
the entire expected range of bottoms flow. Over-stripping reduces the time operators spend moni￾toring the tower’s operation but wastes steam at all bottoms flow rates below the highest expected
rates.
The simple control strategy that provides steam/bottoms ratio control is shown in Figure 11.26.
Dynamic compensation of bottoms flow rate is not necessary because the stripping steam injection
point is at the bottom of the tower’s stripping section, close to where the bottoms stream leaves
the tower. When the desired steam/bottoms ratio does not change very often, the desired ratios are
calculated offline, communicated to console operators via a daily directive, and entered manually at Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.4 Reducing Stripping Steam Utilization 385
Figure 11.26 CDU Stripping Steam/Btms Ratio Control
RC90
SP
SP
Steam/Btms
ratio 
Desired
steam/Btms
ratio 
Steam
FC
90
FV90
Steam
flow
FI
92
Btms
flow
the console. If the desired steam/bottoms ratio changes on a routine basis, and there is an existing
RTO application whose scope includes the CDU and related upstream and downstream process
units, the “best” stripping steam/bottoms ratio is established more correctly online, in real-time,
within the RTO application.
Design Notes and Features
1. This control strategy is a simple cascade, and cascade initialization and wind-up are both
handled by standard DCS features.
2. FC90 is a conventional flow controller and thus FC90 has control direction = Reverse. As a
cascade secondary, it is tuned for best SP response, proportional on error with SP Init = Yes.
3. RC90 is not a PID and requires no tuning. It is a cascade primary, and its setpoint value is either
specified offline or calculated by RTO; thus SP Init = No. If so, FC90 SP will almost certainly be
bumped on the first execution pass after RC90 initializes. But a steam flow bump is normally
not a problem and thus maintaining the existing guideline or optimal ratio set point is best.
4. When the bottoms flow measurement (FI92 PV) becomes unavailable, standard DCS features
prevents RC90 from changing the steam rate setpoint. Standard DCS features will also
re-commission ratio control when the feed measurement returns available once again.
Last Thoughts and Closing Remarks
In a CDU, the overflash target is normally maintained by manipulating the preheat heater’s COT
controller’s setpoint. If the lowest sidestream back-end quality is not critical, there are potential
energy savings to minimize overflash by lowering the preheat heater’s COT. The overflash target is
specified to provide just enough liquid wash above the flash zone. However, overflash is difficult to
measure or infer from other tower measurements, and thus controlling overflash is problematic. In
addition, establishing the overflash target requires the resolution of multiple energy-yield trade-offs
and is best done within an RTO application. Because RTO rigorously solves CDU steady-state heat
and material balances, a predicted value of overflash is normally calculated, and can be made avail￾able for monitoring or control purposes external to RTO.
When the lowest sidestream is a product used as a blend stock, minimum overflash may not
be the best approach. The best overflash target also depends upon resolving the same trade-offs
underlying overflash minimization plus one more – the lowest sidestream product’s incremental Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License386 11 Energy Conservation Controls
yield benefit versus the increased steam production’s incremental cost. This almost always must be
done online, in real time within an RTO application whose scope includes not only the CDU but
both upstream and downstream process units.
11.4.2 Primary Fractionator (CDU) Sidestream Steam Stripping
As indicated in the crude fractionator (CDU) configuration shown in Figure 10.3 in Chapter 10,
a naphtha product is withdrawn as an overhead product, and various distillate products (e.g.,
kerosene, diesel oil, and heating oil) are withdrawn as sidestream draw-offs. Due to imperfect
fractionation, the naphtha and all sidestream products contain material from adjacent cuts – for
example, there are naphtha (overhead) and diesel (second sidestream) boiling range components
withdrawn with the kerosene product (first sidestream).
This section’s focus is a CDU’s (T-101) first sidestream draw-off, a kerosene product – see
Figure 11.27. The naphtha boiling range components in the kerosene draw-off mainly affect the
kerosene’s front-end quality, in this case, the 5% distillation point (AI197 PV); initial boiling point
and flash point are two others. The diesel boiling range components (from second sidestream
product) mainly affect the kerosene’s back-end property, in this case, the final boiling point (FBP)
(AI196 PV); smoke point and 95% distillation point are two others. The kerosene hydrofiner
(KHF), R-301, removes metals, sulfur, nitrogen, and some light components. The KHF effluent
is steam stripped in steam stripper T-306, where lower boiling components are stripped out and
returned to T-101. T-306 bottoms flow is the kerosene product, which is routed to tankage.
The focus of this section is on the role of stripping steam in meeting the kerosene front-end quality
target. Thus, how the kerosene product’s FBP is controlled is not addressed here. CDU product
FC
172
T
1
0
1
Naphtha to
naphtha H/F
CDU
Side stream 1
draw-off
FC
173
AI
196
Kerosene
FBP
Kerosene
H/F
R
3
0
1
T
3
0
6
AI
197
FI
175
LC
190 Kerosene
5% Pt
Kerosene
Kerosene
steam stripper
Stripping
steam
FC
174
FV174
D-104
Figure 11.27 CDU Overhead and First Sidestream (Kerosene) Process Configuration
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.4 Reducing Stripping Steam Utilization 387
quality controls are presented and discussed in detail in Chapter 13, Section 13.3. A process variable
summary, including each CDU variable’s type – CV, MV, or DV and its typical control strategy
role is presented in Section 13.3.1 (see Table 13.1). Basic regulatory and product quality CV–MV
pairings are presented in Section 13.3.2 (see Tables 13.2 and 13.3), and overviews of conventional
CDU advanced product quality control strategies are presented and discussed in Section 13.3.3 (see
Figures 13.12, and 13.15 through 13.17). According to Table 13.3, for the T-101 configuration in
Figure 11.27, the kerosene’s FBP (AI196) would typically be paired with T-101’s first sidestream
draw-off flow (FC173). The control cascade required to implement this pairing is shown in Figure
13.15, but due to its complexity, its discussion must be deferred to Section 13.3.3.
The kerosene’s front-end product quality (AI197 PV) target is met by manipulating steam strip￾per T-306 steam flow (FC174). In T-306, superheated steam is injected below the bottom tray.
Hydrocarbon partial pressure is reduced, component boiling points are lowered, and the lower
boiling hydrocarbon components are stripped out of the liquid sidestream draw-off into the ris￾ing vapor and returned to T-101. Thus, steam facilitates the removal of lower boiling hydrocarbon
components because of its effect on hydrocarbon partial pressure and lighter component boiling
points.
Like CDU bottoms stripping steam, maintaining a constant stripping steam to stripper bottoms
flow ratio helps reduce stripping steam utilization by eliminating an operator’s incentive to use
more steam than necessary to ensure no off-specification product is ever produced. Incremental
effectiveness of stripper steam stripping decreases as the steam rate increases. If there is no quality
measurement available, the steam flow target is specified via an offline calculation that trades off
incremental steam production costs versus the incremental value of improved kerosene front-end
quality (5% distillation point).
With no 5% distillation point measurement, the control strategy is simply steam/bottoms flow
ratio control, as shown in Figure 11.28. The desired steam/bottoms ratio is periodically calculated
offline, communicated to operations via daily directives, and entered manually by operators. If
available, 5% distillation point lab measurements may be helpful – they can provide guidance to
operators when they periodically make ratio setpoint adjustments.
If an online measurement is available, the 5% distillation point (AI197 PV) can be controlled at
its desired target by adjusting the steam/bottoms ratio setpoint – see Figure 11.29. The analyzer
signal is validated (in AIV197) before its use in control (AC197). Ratio controller RC174 is retained
to provide FF compensation for anything that changes T-306 bottoms flow, and to help control the
5% distillation point when AI197 PV is unavailable or invalid.
Figure 11.28 T-306 Steam/Bottoms Ratio Control
RC174 Stm/Btms
ratio control
Desired Stm/Btms
ratio
SP
FI
175
Btms flow
FC
174
Steam
SP
FV174
Stripping
steam
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License388 11 Energy Conservation Controls
AI
197
Kero 5% Pt
control AC197 AIV197
Desired kero
5% distillation Pt
SP
Validation Kero
5% Pt
RC174 Stm/Btms
ratio control
SP
SP
FI
175
Btms flow
FC
174
Steam
FV174
Stripping
steam
Figure 11.29 Kerosene 5% Distillation Point
Control
Design Notes and Features (Figures 11.28 and 11.29)
1. This control strategy is a simple cascade, and cascade initialization and wind-up are both
handled by standard DCS features.
2. FC174 is a conventional flow controller and thus its control direction = Reverse. As a cascade sec￾ondary, it is tuned for best SP response, proportional on error and configured with SP Init = Yes.
3. RC174 is not a PID and requires no tuning. In Figure 11.28, RC174 is a cascade primary. Since its
setpoint value is an established guideline, SP Init = No. Although unlikely, if a bump to steam
flow when RC174 initializes is unacceptable (SP Init = No), then choose SP Init = Yes, and
provide additional logic to slowly ramp the initialized RC174 SP back to its last guideline value.
In Figure 11.29, RC174 is a cascade secondary, and thus SP Init = Yes.
4. If AC197 PV is increasing and/or is above its setpoint, too many light hydrocarbon components
are being stripped out of the kerosene product and thus AC197 OP decreases to decrease RC174
SP. Thus, AC197 is configured with control direction = Reverse. As a cascade primary, its setpoint
will very rarely be changed, and it is tuned for best load response, proportional on PV with SP
Init = No. If so, RC197 SP will likely be bumped after AC197 initializes. Again, although unlikely,
if a bump to steam flow is unacceptable, configure AC197 for SP Init =Yes, and provide addi￾tional logic to slowly ramp the initialized AC197 SP back to the desired 5% distillation point
target.
5. In Figures 11.28 and 11.29, when the T-306 bottoms flow measurement (FI75 PV) becomes
unavailable, standard DCS features will stop RC174’s steam rate adjustments, and in
Figure 11.29, AC197’s wind-up status will also be set to HighLow (Output Indisposable).
Standard DCS features will re-commission ratio control, and (in Figure 11.29) 5% distillation
point control when the feed measurement becomes available again.
11.4.3 Sour Water Steam Stripping
Sour water is produced in many refinery processes, including crude distillations, delayed cokers,
amine regenerators and Claus tail gas clean-up units. However, significant amounts of sour water
are also produced in naphtha, distillate, and gas oil hydrotreaters and hydrofiners. In these process Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.4 Reducing Stripping Steam Utilization 389
T
9
1
5 FC
932
E-981
Sour water
stripper
Steam
FC
931
D-935 LC
935
PC
939
FC
935
P-980
Sour gas
to SRU
P-982
AI
936
Stripped
water pH
TC
930
Sour
water
Stripped
water
E-991
TV930
Figure 11.30 Sour Water Stripper (T-915) Process Configuration
units, nitrogen and sulfur are removed from the hydrocarbon feed by chemical reactions that con￾vert them to NH3 and H2S. When the desulfurized products are brought into contact with steam
or water in downstream product stabilizers (strippers), any aqueous solutions removed are rich in
NH3 and H2S and they make significant contributions to the refinery’s sour water inventory.
NH3 and H2S are removed from sour water by stripping in sour water strippers (SWS), either
by open steam stripping or by separation in a reboiled stripper whose heat source is low pressure
steam. A typical SWS (T-915) configuration, with open steam stripping, is shown in Figure 11.30.
T-915 feed is preheated in the stripped water/stripper feed exchanger E-991. Stripping steam enters
below the bottom tray and strips NH3 and H2S from the sour water as it descends in the tower.
The stripping steam with stripped sour gases is cooled in overhead condenser E-981; uncondensed
stripped gases are sent to the sulfur recovery plant on pressure control (PC939), and accumulated
condensate in D-935 is returned to T-915 as reflux. The stripped water exiting T-915 is cooled in
E-991, and is recycled back to process units or sent to wastewater treatment for disposal.
Like CDU stripping steam (ratioed to bottoms flow) and CDU sidestream stripper steam (ratioed
to stripper bottoms flow), SWS steam utilization is reduced by ratioing the SWS steam flow, either
open steam injection or reboiler steam flow, to the stripper’s sour water feed flow. Otherwise, oper￾ators use more steam than necessary to ensure there is always enough steam for any expected
sour water feed rate. The control strategy, a simple steam/sour water feed ratio, is presented in
Figure 11.31.
Sour water stripping reduces the stripped water’s NH3 and/or H2S concentrations to acceptable
levels. NH3 content is determined by either pH or conductivity, while H2S content is determined Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License390 11 Energy Conservation Controls
FC
932
Sour water
feed
Steam
FC
931 RC932 Steam/sour water
ratio
SP
SP
Desired
steam/sour water
ratio
Stripping
steam
Figure 11.31 T-915 Steam/Sour Water Ratio Control
by a composition measurement. Higher steam rates result in more NH3 and H2S stripping,
but more steam consumption. As steam utilization increases, overhead cooling duty in E-981
increases, and as steam rates increase further, overhead cooling may become limited by E-981’s
condensing capacity. Therefore, the desired stripping steam/sour water flow ratio target is also
a trade-off – steam consumption versus acceptable stripped water NH3 and/or H2S content,
subject to a maximum condenser duty constraint. In most cases, the steam/sour water target
is periodically calculated offline, communicated to operations via daily directives, and entered
manually by operators. If available, lab measurements (pH or conductivity, and/or H2S content)
are helpful and enable operators to periodically adjust the ratio setpoint.
In some special cases, where the stripper capacity is large and/or acceptable NH3 and/or H2S
levels are strictly enforced, analyzer feedback may be justified. This requires an online measure￾ment of a stripped water impurity, either pH or conductivity for NH3, and/or H2S composition.
As indicated in Figure 11.32, the analyzer feedback cascades to the steam/sour water feed ratio
controller (RC932 SP), which in principle limits stripping steam to only the amount required to
meet the stripped water quality target(s). When available, the analyzer measurement is validated
before it is used for control. If only one quality measurement is available, the feedback control is
provided by a single PID controller, whose setpoint is the desired stripped water impurity target
(maximum pH or conductivity, or maximum H2S concentration). Very rarely, both measurements
are available; if so, the feedback control is provided by conventional constraint control, with two
constraint variable PIDs. The maximum allowable stripped water pH or conductivity is one con￾straint variable PID’s setpoint, while the maximum allowable H2S concentration is the setpoint of
the other constraint variable’s PID controller.
Design Notes and Features (Steam/Sour Water Ratio Control, Figure 11.31)
1. Design notes 1–5 for the control strategy in Figure 11.28 in Section 11.4.2 (CDU stripping
steam/bottoms ratio control) are valid for this cascade with (i) tag names and equipment labels
changed to correspond to those in Figures 11.30 and 11.31 and (ii) “bottoms” flow is changed
to “sour water feed” flow.
2. If FC931 SP is configured to be RC932’s wild flow input instead of FC931 PV (to minimize feed
rate noise propagation), FC931 must be configured for SP Init = Yes. If FC931 is an ultimate
secondary in another control cascade, it is already configured for SP Init = Yes. Additional logic
may be necessary to switch to the flow PV when FC931 becomes wound-up in Auto.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.5 Reducing Steam Consumption in Amine Gas Treating Units 391
FC
932
T-915
sour water
feed rate
Steam
FC
931 RC932 Steam/sour water
ratio
SP
SP
Desired
stripped water
pH and/or H2S composition
Stripped water
pH and/or H2S composition
control
SP
Stripped water
pH
Stripped water
H2S 
Validation
AI AIV
AI AIV
Figure 11.32 T-915 Stripped Water Impurity Control
Last Thoughts and Closing Remarks
Referring to Figure 11.30, the SWS’s sour water feed temperature (TC930) is controlled by bypassing
T-915’s hot, stripped water product around E-991, the stripped water/sour water feed exchanger.
By increasing TC930, the sour water feed’s fraction vaporized increases and less steam is required
to attain the same stripped water impurity target(s). Hence additional steam savings are possible if
TC930 PV is increased to reduce stripping steam utilization.
A control strategy that slowly increases TC930 SP until limited by a TV930 minimum allowable
bypass flow position would maximize E-991 duty and TC930. However, to ensure stable stripper
operations, TC930 must remain in controlling range as TC930 SP is increased and the E-991 maxi￾mum duty (minimum bypass flow) constraint is approached.
11.5 Reducing Steam Consumption in Amine Gas Treating Units
Gas streams containing H2S are generated in many refinery process units. CDU overhead gases,
main fractionator overhead gases, hydrofiner treat gases, and hydrocracker recycle gases are impor￾tant examples. H2S concentrations are significantly reduced in gas streams routed to LPG recovery,
the fuel gas and hydrofiner treat gas headers, and hydrofiner and hydrocracker H2 rich recycle
gases.
Amine gas treatment units use aqueous solutions of various amines to remove H2S and CO2
from sour gases. Amines are hydrocarbons that contain a functional group that includes nitrogen.
The two most used amines are monoethanolamine (MEA) and diethanolamine (DEA). A typical
amine gas treating configuration contains one or more scrubbers17 and a regenerator; an oil refin￾ery can have several such scrubber/regenerator combinations. A configuration that includes two
17 Scrubber and absorber are used interchangeably to describe the tower removing H2S and CO2 from sour gases.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License392 11 Energy Conservation Controls
T
1
0
9
H/F reactor
tail gas
Amine
regenerator
E-750
TC
106
Rich
amine
T
1
0
5
To H/F
reactors
FI
69
FC
66
Amine
scrubbers
TI
63
Lean
amine
Rich
amine
TK-50
FI
16
LC
16
E-150
E-152
FC
15
Steam
Lean
amine
T
1
0
6
H/F
purge gas 
To fuel gas
header
FI
46
FC
44
TI
49
Lean
amine
Rich
amine
Sour
water
D-35
To SRU
To flare gas
system
FC
16
LC
15
FV16
∞
Figure 11.33 Amine Regenerator/Scrubber Configuration
scrubbers (T-105, T-106) and one regenerator (T-109) is shown in Figure 11.33. Scrubber T-105 is
treating hydrofiner tail gas before it is recycled back to the reaction section. Scrubber T-106 is treat￾ing hydrofiner purge gas before it is routed to the fuel gas header. The H2S and CO2 absorbed by
the amine in each scrubber are stripped out of the amine by steam reboiling in regenerator T-109.
Sour gas enters at the bottom of the scrubber, while the lean amine solution enters at the scrubber
top. Amine loading is defined as the total moles of acid gas (H2S+CO2) per mole of amine; thus,
lean amine loading has low H2S+CO2 content. As the sour gas flows upward countercurrent to
the downward flowing lean amine solution, H2S (and CO2 if present in sour gas) is removed from
the gas stream and absorbed by the amine solution. Hence, the rich amine removed at the scrubber
bottom has high acid gas loading. The “sweet” gases exiting at the scrubber overhead are then
routed to their next destination (e.g., H/F reactors and fuel gas header). The rich amine is routed to
the regenerator (T-109), where the acid gas is stripped from the amine solution by steam reboiling
(E-152). The lean amine leaves the regenerator bottoms with low acid gas loading, ready for re-use
in the scrubbers. The regenerator’s overhead acid gas is H2S (and perhaps CO2) rich; it is routed to
the sulfur recovery unit (SRU) to convert the H2S to elemental sulfur product.
Over the years, amine acid gas treating has been trending upward in importance, as have sour
gas removal volumes: (i) conversion capacity has expanded or has been added to produce low and
ultra-low sulfur fuels, (ii) emissions limits on H2S and SO2 are more stringent, and (iii) heavier
crude slates, high in sulfur, are being run. Steam consumption in the amine regenerator reboiler
is large and is a significant energy cost in the gas treating process. Scrubber and regenerator con￾trol strategies are now presented that help stabilize operations and minimize steam consumption
in the regenerator reboiler. Then, a kerosene hydrofiner (KHF) treat gas scrubber configuration Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.5 Reducing Steam Consumption in Amine Gas Treating Units 393
Figure 11.34 Amine Regenerator
Steam/Rich Amine Ratio Control
RC15
SP
SP
Steam/rich amine
ratio 
Desired
steam/rich amine
ratio 
Reboiler
steam
FI60
Total rich
amine flow
FC
15
FC
66
FC
44
is considered, and a control strategy that minimizes the treat gas flow to an amine scrubber is
presented. By minimizing the scrubber’s treat gas feed, scrubber lean amine flow and steam con￾sumption in the regenerator reboiler are both reduced.
11.5.1 Scrubber and Regenerator Controls
The regenerator operating objective is to use just enough reboiler steam to restore the lean amine
loading to a value that permits the desired acid gas removal in the scrubbers. More steam will
produce lean amine at a lower-than-needed acid gas loading and thus wastes steam. The major
process upset that affects regenerator operations is changes in the sour gas make and hence the
amount of acid gas that must be removed in the scrubbers. This impacts both amine recirculation
rate and rich amine loading.
Like reducing stripping steam as described in Section 11.4, steam consumption can be reduced
by ratioing the reboiler steam to the regenerator’s rich amine feed. If the regenerator’s rich amine
feed is not measured, then lean amine flows to the individual scrubbers in its network (which are
always measured, and almost always controlled) are summed to give the regenerator’s (total) rich
amine feed flow. Steam to rich amine ratio control compensates for changes in amine recirculation
rate. Without steam/rich amine ratio control operators typically use more steam than necessary to
insure there is always enough steam for any expected rich amine rate.
The control strategy, a simple steam/rich amine flow ratio, is shown in Figure 11.34. The chal￾lenge is to specify the best, i.e., minimum, steam/rich amine ratio target (RC15 SP) that ensures the
lean amine loading target is met. The steam/rich amine ratio target is normally calculated offline by
process engineers via an overall regenerator heat balance. The heat balance includes sensible heat
(to heat the rich amine solution from rich amine inlet temperature to lean amine outlet tempera￾ture), the heat required to strip the desired amount of H2S out of the amine (the heat of absorption),
and the heat required to maintain sufficient regenerator reflux flow (heat of vaporization, overhead
condenser duty). With estimated rich amine loading (via lab analysis), desired lean amine loading,
and sour gas flows, the heat balance provides an estimate of the target steam/rich amine ratio tar￾get. The newly calculated ratio is communicated to operations via a daily directive and entered
manually by operators.
The scrubber control strategy is also very simple; lean amine/sour gas ratio control if the sour
gas is measured or, if not, lean amine/sweet gas ratio control. These strategies are shown in
Figures 11.35 and 11.36. The control objective is to maintain the desired acid gas pick-up, despite
changes in sour gas flow. Without amine/sour gas ratio control, operators typically use excess
lean amine, e.g., more than necessary to ensure there is always enough for any expected sour Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License394 11 Energy Conservation Controls
RC44
SP
SP
Lean amine/
sour gas
ratio 
Lean amine
Desired T-106
lean amine/sour gas
ratio 
Sour gas
flow
FC
44
FI
46
Figure 11.35 T-106 Lean Amine/Purge Gas Ratio Control
RC66
SP
SP
Lean amine/
sweet tail gas
ratio 
Lean amine
Desired T-105
lean amine/tail gas
ratio 
Sweet tail
gas flow
FC
66
FI
69
Figure 11.36 T-105 Lean Amine/Tail Gas Ratio Control
gas rate. Thus, amine/sour gas ratio control helps reduce amine recirculation rate. Plant-wide
implementation on all scrubbers helps reduce steam consumption in the regenerator reboiler.
Similar to regenerator operations, the challenge is again how to specify the best ratio – the
amine/sour gas ratio (RC44 SP or RC66 SP) that ensures the desired amount of acid gas is removed
and transferred to the amine. The absorption process is exothermic, and the heat liberated is
transferred to both the acid gas and amine streams; the temperature of each stream rises as it flows
counter currently through the scrubber. The temperature rise in both gas and liquid streams is
an inference of the H2S (and CO2) transferred from the acid gas to the amine solution. The lean
amine/sour gas ratio target is normally calculated offline via overall scrubber heat and material
balances; the new ratio target is communicated to operations via a daily directive and entered
manually by operators.
Design Notes and Features
1. Design notes 1–4 for the control strategy in Figure 11.26 in Section 11.4.1 (CDU Stripping
Steam/Bottoms Ratio Control) are valid for the regenerator (Figure 11.34) and scrubber
(Figures 11.35 and 11.36) ratio controls with tag names and equipment labels changed to
correspond to those in Figures 11.34, 11.35, and 11.36.
2. For regenerator steam/amine feed ratio control (Figure 11.34), min/max allowable steam flow
and min/max allowable steam valve positions are respected by standard DCS features, e.g., FC15
SP high/low clamps and FC15 OP high/low clamps.
3. For regenerator steam/amine ratio control, the steam rate’s reduction may be limited by a
minimum desired reflux flow (FC16 PV) and/or a minimum desired reflux flow valve position Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.5 Reducing Steam Consumption in Amine Gas Treating Units 395
(FV16). If any potential constraints are applicable, they must be included in the regenerator
steam/amine ratio strategy. Steam/feed ratio then becomes a constraint variable in a conven￾tional constraint control strategy with other constraint variable PIDs – one for each applicable
constraint.
11.5.2 Kerosene Hydrofiner Treat Gas Scrubber Feed Minimization
Hydrofining is a major refinery fixed bed catalytic reaction system that removes sulfur (as H2S)
and nitrogen (as NH3) from naphtha, distillate, and gas oil feedstocks in the presence of H2 rich
treat gas. In most refineries, the major H2 rich treat gas source is the catalytic reformer, whose
reactions generate H2. The reactor effluent from the last reformer reactor is cooled and routed to a
separator drum where a liquid reformate product (MOGAS blend stock or an aromatics plant feed￾stock) and a H2 rich off-gas are separated. A portion of the off-gas is recycled back to the reformer
reactors. The H2 rich off-gas not recycled is reformer “make gas”, and serves as the major source
for hydrofiner H2 rich treat gas.
A representative treat gas configuration that distributes reformer make-gas to multiple hydrofin￾ers, in this case naphtha (R-101), kerosene (R-102) and diesel (R-103) hydrofiners, is shown in
Figure 11.37.
All three hydrofiner treat gas flows are set externally by controllers maintaining the treat
gas/hydrocarbon feed ratio at a desired target (see Section 11.6 for the significance of treat
gas/feed ratio). Both the R-101 (FC136) and the R-102 (FC138) treat gas targets are achieved by
manipulating valves (FV136, FV138) that route reformer make gas to the fuel gas system. Notice
that flow controller FC128 is the treat gas source for both R-103 and the Kerosene H/F treat gas
R
1
0
1
R
1
0
3
To FG
header
Diesel
H/F
Diesel feed
Naphtha
feed
Naphtha
H/F
D-101
Desulfurized
product
Desulfurized
product
FC
128
FC
136
TG/feed
ratio Ctl
SP
FC
126
FV126
TG/feed
ratio Ctl
SP
FV128
FV136
T
1
0
3
R
1
0
2
Kero H/F
feed
Kero
H/F
To FG
header
D-102
Off-gas
Desulfurized
product
Rich
amine
Lean
amine
Kero H/F
treat gas
scrubber
FI
132
FC
138
D-103 Separator
drums
Separator
drum
TG/feed
ratio Ctl
SP
Treat gas
recycle
FV138
Reformer
make gas 
Figure 11.37 Kerosene Hydrofiner Treat Gas Scrubber Configuration
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License396 11 Energy Conservation Controls
Minimum
FV126
Minimum
T103 feed rate
SP SP
HSS
FV126
SP
FC132 VFC126
T-103 sour
gas feed
FI
132
R-103 treat
gas flow MV
FC
128
TG to R-103,
T-103
FV128
Treat gas flow
to R-103 and T-103
Figure 11.38 Kero HF Treat Gas Scrubber Sour Gas Feed Rate Minimization
scrubber (T-103). The R-103 treat gas target (FC126 SP) is met by diverting excess make gas to
T-103 via FV126. This determines the T-103 sour gas feed flow (FI132) and hence the scrubber’s
acid gas removal load. Thus, the set point entered for FC128 determines how much treat gas
flow must be diverted to T-103 (FI132) to meet the R-103 treat gas requirement (FC126 SP). As
discussed in Section 11.5.1, scrubber lean amine flow is normally ratioed to the sour gas flow.
Therefore, if T-103 sour gas feed rate is reduced, T-103 lean amine flow is reduced; this helps
decrease amine circulation, and thus steam utilization in the amine regenerator reboiler.
Energy savings are captured if FC128’s set point allows FC126 to meet R-103’s treat gas flow
target, and limit FI132 flow. FC126, the treat gas flow to R-103, responds to an FC128 setpoint
decrease by closing FV126, thus reducing the flow of treat gas to T-103. However, there is a min￾imum FI132 PV that ensures normal scrubber operations; values below this minimum must be
avoided. In addition, FV126 (or equivalently, FC126 OP) must remain in controlling range above a
min % opening. Therefore, the operating objective is to deliver the required treat gas flow to R-103,
while minimizing sour gas flow to T-103 and ensuring FV126 stays in controlling range. Any excess
treat gas, e.g., treat gas not routed to R-103 or T-103 via FC128, is sent untreated to the FG header.
A conventional constraint control strategy that achieves this operating objective is shown in
Figure 11.38. There are two constraint variables, treat gas valve position FV126 and T-103 feed
rate FI132 PV, with dedicated PIDs, VFC126, and FC132. The MV is FC128 SP, the treat gas flow
source for both R-103 and T-103. This control strategy attempts to decrease FC128 SP until either
the treat gas valve position or T-103 feed rate becomes limiting. Both constraint variables have a
minimum limit, the constraint variable PID setpoints, VFC126 SP and FC132 SP. An increase in
FC128 SP moves both constraint variables away from their constraint limits. Thus, based on the
discussion in Section 7.4.4, an HSS is the selector choice in Figure 11.38, and it outputs the larger
of the two desired FC128 SP values.
Design Notes and Features
1. The control strategy in Figure 11.38 is a complex cascade and custom logic must be provided to
manage cascade initialization and wind-up above the HSS.
2. Both constraint variable minimum values (FC132 SP and VFC126 SP) are almost never changed,
and thus both constraint variable PIDs are tuned for best load response, proportional on PV with Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.6 Reducing Reactor Treat Gas, Recycle Gas Flows 397
SP Init = No. FC132 and VFC126 are each tuned for their own response dynamics to changes in
FC128 SP.
3. FC128 is a cascade secondary and thus it is tuned for best SP response, proportional on error, with
SP Init =Yes. As a standard flow controller, FC128 is configured with control direction = Reverse.
4. When FC126 PV is increasing and/or is above its setpoint, FV126 must open; thus, FC126 OP
must increase, and FC126 is configured with control direction = Direct.
5. When FV126 is increasing and/or above its minimum allowable output, VFC126 must decrease
FC128 SP. Therefore, VFC126 is configured with control direction = Reverse. When FC132 PV
(FI132 PV) is increasing and/or above its minimum allowable flow, FC132 must decrease FC128
SP. Therefore, FC132 is also configured with control direction = Reverse.
6. FV126 should almost always be available. However, if FI132 PV becomes unavailable, custom
code/logic must decommission the entire constraint control strategy, and commission it
bumplessly when FI132 PV returns available.
7. The operator interface includes an indication of which constraint variable is the active
constraint. A constraint variable switch history display is useful to help detect noise problems.
8. To prevent wind-up of the non-active CV controller output, logic must be provided to reset the
non-active CV controller’s output to the active constraint variable controller’s output on every
normal control execution pass.
11.6 Reducing Reactor Treat Gas, Recycle Gas Flows
Hydrofining removes sulfur, nitrogen, olefins, and diolefins from naphtha, distillate, and gas oil
feedstocks. In the presence of a large excess of H2 rich treat gas, hydrofining reactions catalytically
convert sulfur to H2S, nitrogen to NH3, and olefins and diolefins to more stable paraffins. Most of
the unconsumed treat gas is recycled and returned to the treat gas header, but H2 rich make-up gas
is required to replace the H2 used up in the hydrofiner reactions. The primary source of hydrofiner
make-up gas is catalytic reformer off-gas that is not recycled back to the reformer reactors.
The principle operating variables in hydrofining are temperature and H2 partial pressure.
Higher temperatures increase conversion but increase coke formation. Higher H2 partial pressures
increase conversion but reduce coke formation. Therefore, temperature is normally chosen to
meet a conversion target, while H2 partial pressure is chosen to manage catalyst deactivation
and meet the catalyst end-of-run target. When a hydrofiner reactor’s H2 rich treat gas and/or
make-up gas is preheated in a fired heater, fuel consumption is reduced by using only enough
treat gas and/or make-up gas to meet the reactor H2 partial pressure operating target. Therefore,
by reducing preheat heater fuel consumption, and/or in some cases, compressor operating costs,
energy savings are captured.
Three reactor systems (gasoil and naphtha hydrofiners, and a catalytic reformer) and control
strategies designed to provide only enough treat gas, make gas, or recycle gas to (i) sustain reactor
H2 partial pressures, (ii) meet conversion or yield targets, and (iii) manage catalyst deactivation, are
now presented. For the hydrofiners, these strategies maintain treat gas/feed ratio and treat gas H2
purity at their desired targets. For the catalytic reformer, these strategies maintain recycle gas/feed
and reactor H2/feed ratios at desired targets. The justifications for the control strategies discussed
next are the energy savings described above.
11.6.1 Gas Oil Hydrofiner Reactor Treat Gas and H2 Make Gas Minimization
A typical gas oil hydrofiner process configuration is shown in Figure 11.39. Treat gas is heated
in preheat heater F-935, combined with the hydrocarbon feed, and the mixture is fed to reactor Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License398 11 Energy Conservation Controls
Recycle gas
compressor
Recycle gas
compressor
KO drum 
Make-up
gas
FC
944
FV944
Make-up
gas
compressor
PI
936
To FG header
AI
905
FC
955
TI
936
Hot separator
vapor
FV955
F-935
Treat
gas
Preheat
heater
HC
feed 
FC
935
Recycle
gas
scrubber Cold
separator
drum
To amine
regenerator
To product
fractionator
Recycle gas
Reactor
feed
Gas oil
H/F
R
9
0
1
To product
fractionator
Hot separator
D-915 drum
D-917
T
9
1
7
E-915
E-935
FV935
C-914
C-921
D
9
1
4
∞
Figure 11.39 Gasoil Hydrofiner Reactor Recycle Gas and Make-up Gas Configuration
R-901. The reactor effluent is separated into liquid and gas products in hot separator drum D-915.
The liquid product is routed to the product fractionator for separation of products. The gas is cooled
in E-935 and E-915, and then flows to cold separator drum D-917. The gas separated in D-917 is
stripped of H2S in recycle gas scrubber T-917 and is recycled back to R-901 after compression in
C-914. Treat gas flow to R-901, FC955, is controlled by diverting some recycle gas back to D-917.
Make-up gas from the catalytic reformer, FC944, is compressed in C-921, and mixes with the recycle
gas. The recycle gas and make-up gas combination is R-901’s treat gas, which then enters F-935.
AI905 is the measured treat gas H2 purity. It is affected by R-901 operations, and catalytic reformer
conversion changes/upsets; both affect recycle gas and make-up gas H2 content and recycle gas and
make-up gas production.
In Figure 11.39, the operating objective is to deliver only enough treat gas flow to R-901 to support
the desired hydrofiner reactions and maintain R-901 H2 partial pressure at a value that ensures the
catalyst end-of-run target is met. The control strategy that achieves this operating objective has two
components; they are presented in Figures 11.40 and 11.41.
In Figure 11.40, a reduction in fuel consumption in preheat heater F-935 can be achieved by
ratioing the reactor treat gas flow (FC955) to the reactor’s hydrocarbon feed (FC935). Without treat
gas/hydrocarbon ratio control, operators typically use more treat gas than necessary to ensure there
is always enough for any expected reactor hydrocarbon feed rate. This is the same rationale used
to justify ratioing reboiler duty and/or reflux flow to feed rate for towers (Section 11.3) and strip￾ping steam to tower bottoms for (primary/main) fractionators, and steam strippers (Section 11.4).
The desired treat gas/oil feed ratio (RC955 SP) is calculated offline and is intended to provide Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.6 Reducing Reactor Treat Gas, Recycle Gas Flows 399
Figure 11.40 H/F Treat Gas/HC Ratio Control
RC955
HC
feed 
SP
SP
Treat gas/HC
ratio control
Desired
TG/HC ratio
FC
935
Treat
gas
FC
955
FV955
Figure 11.41 H/F Treat Gas H2 Purity
Control
AIV905
TG H2
purity
control
AC905
SP
SP
Validation
AI
905
Desired
TG H2 purity
TG H2
purity FC
944
Make-up
gas
FV944
the H2 needed to support the desired reactions and establish the reactor H2 partial pressure that
ensures the catalyst deactivation rate allows the planned end-of-run target date to be met. A newly
calculated ratio target is communicated to operations periodically via a daily directive and entered
manually by operators.
Important: The gas oil hydrofiner’s H2 partial pressure has an important effect on the product
yields achieved and the rate of catalyst aging. The treat gas flow and treat gas H2 purity have
important impact on H2 partial pressure and, therefore, there are some situations in which treat
gas flow must be known with as much accuracy as possible. If so, the treat gas flow is temperature,
pressure and/or molecular weight compensated, and the compensated treat gas flow is controlled
(instead of the uncompensated flow as in Figure 11.40). Flow compensation, and the additional
logic and validity checks needed when a compensated flow is used in closed loop, is discussed in
Chapter 8, Section 8.9.
Figure 11.41 presents the control strategy’s second component – treat gas H2 purity control. The
treat gas H2 purity is measured (AI905 PV), and the measurement’s sample point is downstream of
the recycle gas/make-up gas mix point. Also, the H2 make-up gas flow, which impacts treat gas H2
purity, is controlled (FC944), and is an available degree of freedom. Thus, the treat gas H2 purity
is controlled at a desired target by manipulating make-up gas flow FC944 SP. The H2 purity mea￾surement is validated in AIV905 before it is used for control in AC905.
The control adjustments made by the two control strategies in Figures 11.40 and 11.41 interact.
Each time AC905 adjusts make-up gas flow (FC944 SP) to control treat gas H2 purity, treat gas flow
(FC955) is affected and FC955 makes a compensating adjustment to recycle flow via FV955. Like￾wise, each time RC955 makes an adjustment to treat gas flow (FC955 SP) to maintain constant treat Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License400 11 Energy Conservation Controls
gas/hydrocarbon ratio, treat gas H2 purity (AI905 PV) is affected and AC905 makes a compensating
adjustment to FC944 SP to maintain the target treat gas H2 purity. Because the make-up gas and
recycle gas mixing dynamics are relatively fast, and both flow controllers can be tuned to provide
fast responses, for the process configuration in Figure 11.39, these interactions do not present a
control problem.
Design Notes and Features
1. Both control strategies are simple cascades and cascade initialization and wind-up are both
handled by standard DCS features.
2. Both FC944 and FC935 are conventional flow controllers and thus both have control
direction = Reverse. However, if FC955 PV is increasing or is above its setpoint, FC955 OP
increases to open valve FV955. Therefore, FC955 is configured for control direction = Direct.
3. FC955 and FC944 are cascade secondaries and therefore they are tuned for best SP response,
proportional on error with SP Init = Yes.
4. RC955 is not a PID, and thus requires no tuning. Since it is a cascade primary, and its setpoint
value is an offline specified guideline value, SP Init = No is in principle acceptable. However, if
SP Init = No, after RC955 initializes, FC955 SP will almost certainly be bumped. If the treat gas
bump is not acceptable, then configure RC955 SP Init =Yes and provide additional logic/code
to slowly ramp the initialized RC955 SP back to the last (guideline) SP value. It is best to discuss
these issues with operations before final design and implementation.
5. When the hydrocarbon feed flow measurement (FC935 PV) becomes unavailable, standard DCS
features prevents RC955 from changing the treat gas setpoint. Standard DCS features will also
re-commission ratio control when the feed measurement returns good once again.
6. If FC935 SP is used as RC955’s wild flow input instead of FC935 PV (to minimize noise
propagation to treat gas flow), FC935 must be configured for SP Init =Yes. If FC935 is an
ultimate secondary in another control cascade, it is already configured for SP Init =Yes.
Additional logic/code should be considered to switch to FC935 PV when FC935 is wound-up
and in Auto. If FC935 SP is a guideline value, and SP Init is reconfigured to be = Yes,
additional logic/code must be provided to slowly ramp the initialized FC955 SP back to its
last guideline value. These issues must be discussed with operations before final design and
implementation.
7. Since the treat gas H2 purity (AI905) is lower than make-up gas H2 purity, if treat gas H2 purity
is decreasing and/or below its setpoint, AC905 OP must increase to increase make-up gas flow
(FC944 SP). Thus, AC905 is configured with control direction=Reverse. Since AC905 is a cascade
primary, and its setpoint will very rarely change, it is tuned for best load response, proportional
on PV with SP Init = No. However, with SP Init = No, after AC905 initializes, FC944 will almost
certainly be bumped. Although unlikely, if the H2 make-up gas bump is not acceptable, then
configure AC905 SP Init = Yes and provide additional logic/code to slowly ramp the initialized
AC905 SP back to the last guideline value. These issues must be discussed with operations before
final design and implementation.
Management of Control Interactions in Figures 11.40 and 11.41
To look more closely at the control strategy interactions in Figures 11.40 and 11.41, consider the
following H2 and overall material balances:
H2 balance∶ FC955 ∗ AI905 PV
100% = FC944 ∗ %H2 MU
100% + FRCY ∗ %H2 RCY
100% (11.13)
Material balance∶ FRCY = FC955 − FC944 (11.14) Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.6 Reducing Reactor Treat Gas, Recycle Gas Flows 401
where
FC955 Treat gas flow rate
FC944 Make-up gas flow rate
FRCY Recycle gas flow to F-935 and R-901 (unmeasured)
AI905 PV Treat gas H2 purity
%H2 MU Make-up gas H2 purity (unknown)
%H2 RCY Recycle gas H2 purity (unknown)
To eliminate the (unmeasured) recycle gas flow FRCY from these equations, solve Equation (11.13)
for FRCY and substitute it into Equation (11.13); after re-arrangement, the following expression is
obtained:
FC944
FC955 = (AI905 PV − %H2 RCY)
(%H2 MU − %H2 RCY) = Make gas flow
Treat gas flow (11.15)
For any values of recycle gas (%H2 RCY) or make-up gas (%H2 MU) H2 purity, treat gas H2 purity
(AI905 PV) is determined by the make-up gas/treat gas flow ratio. Thus, when hydrocarbon feed
rate (FC935) changes and RC955 adjusts the treat gas flow (FC955 SP), at constant make-up gas
and recycle gas H2 purity, a make-up gas flow (FC944 SP) adjustment that maintains the make-up
gas/treat gas ratio constant should maintain the treat gas H2 purity approximately the same (see
Equation (11.15)). In addition, if either the recycle gas H2 purity (hydrofiner upset) or make-up gas
H2 purity (reformer upset) changes, Equation (11.15) indicates the make-up gas/treat gas flow ratio
must change to maintain constant treat gas H2 purity. Both observations suggest an upgrade to the
treat gas H2 purity control strategy presented in Figure 11.41; the upgraded strategy is presented in
Figure 11.42.
If an online H2 purity measurement is not available, treat gas H2 purity control in Figure 11.42
cannot be implemented. However, Equation (11.15) is justification for using the control strategy in
Figure 11.42 without analyzer feedback (AC905) as shown in Figure 11.43.
Without an H2 purity measurement, operators typically use more make-up gas than necessary
to ensure there is always enough make-up gas for any expected treat gas rate. Thus, even without
an online H2 purity measurement, ratioing make-up gas to treat gas helps reduce make-up gas
utilization, and thus make-up gas compressor (C-921) energy use. The desired make gas/treat gas
ratio, an operator entry, is periodically established offline based on Equation (11.15), the target treat
gas H2 purity, and estimates of make-up gas and recycle gas H2 purity.
SP
RC944 Make gas/ TG
ratio control
TG flow
SP
FC
955
Make-up
gas PV944
FC
944
Desired TG
H2 purity
TG
H2 AC905 purity 
SP
AIV905
Validity
AI
905
TG H2 purity
control
Figure 11.42 Enhanced Strategy to Control Treat Gas H2 Purity
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License402 11 Energy Conservation Controls
Make-up
gas
RC944 Make gas/TG
ratio control
SP
PV944
SP
FC
944
Desired make gas/
TG ratio 
FC
955
Treat gas
flow
Figure 11.43 Make Gas/Treat Gas Ratio Control
The treat gas H2 purity control strategies shown in Figures 11.41 and 11.42 will in some cases have
roughly equivalent control performance. Control performance isstrongly dependent on the process
configuration, specifically the dynamic response of the measured H2 purity to changes in make-up
gas and treat gas flows. For the gas oil hydrofiner configuration in Figure 11.39, the make-up gas
and recycle gas mixing dynamics are fast, the mix point and treat gas transmitter are close to and
upstream of the H2 purity measurement sample point, and both flow controllers can be tuned to
provide fast responses. Therefore, for this hydrofiner configuration, good control performance is
achievable using either control strategy.
11.6.2 Catalytic Reformer Reactor Recycle Gas Minimization
In catalytic reforming, feedstocks rich in naphthenes and paraffins are catalytically converted
to higher octane aromatic components in an H2 rich environment. Aromatics production is
favored by low pressures and high temperatures, which also favors coke formation and catalyst
deactivation. The H2 rich environment (high H2 partial pressure) suppresses coke formation but
as H2 partial pressure increases, potential gasoline yields (at given octane) are reduced. Thus,
a catalyst life, reformate yield tradeoff determines the best operating pressures and H2 partial
pressure.
A representative catalytic reformer oil feed and recycle gas configuration is shown in
Figure 11.44. H2 rich reformer off-gas is compressed in C-544 and routed to preheat heater
(F-501) on flow control (FC536). The recycle gas is first preheated in exchanger E-514 before
mixing with oil feed (FC503) and flowing to F-501. The operating objective is to use only enough
H2 rich recycle gas to operate at the offline calculated H2 partial pressure that best satisfies
the reformate yield/catalyst life tradeoff. This reduces feed preheat requirements, and thus fuel
consumption in F-501. It also tends to increase H2 rich gas available as make gas for the treat gas
system and other process applications.
In many cases, the H2 partial pressure target is met by maintaining the recycle gas/oil feed ratio at
an offline calculated desired value. However, in Figure 11.44, the recycle gas H2 purity (AI506 PV) is
measured. This enables the H2 partial pressure target to be met more effectively by maintaining the
recycle gas H2 content/feed ratio, instead of the recycle gas flow/feed ratio, at an offline calculated
target. In either case, a newly calculated ratio target is periodically communicated to operations via
a daily directive and entered manually by operators. A control strategy that achieves the operating Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.6 Reducing Reactor Treat Gas, Recycle Gas Flows 403
Make gas
to TG
header
Recycle
gas
Oil feed
% H2 in
recycle gas
Recycle gas
compressor
Make-gas
compressor
E-514 FC
503
FC
536
PC
567
FC
12
AI
506
SC
510
Reformer
off-gas
To first
reformer
reactor
Preheat
heater F-501
C-544 C-541
Figure 11.44 Catalytic Reformer Reactor Recycle Gas and Oil Feed Configuration
% H2 in
recycle gas
AIV506
Recycle gas H2/
feed ratio control
RC536
Validation SP
AI
506
Desired
recycle gas H2/
feed ratio
FC
503
Oil feed
SP
Recycle
gas
To recycle gas
compressor control
SC
510
SP
Compressor
speed control
FC
536
Figure 11.45 Catalytic Reformer Recycle Gas H2/Oil Feed Ratio Control
objective (use only enough H2 rich recycle gas to meet a H2 partial pressure operating target) is
shown in Figure 11.45.
The strategy’s main element is RC536, the recycle gas H2 to oil feed ratio controller. RC536 is a
PID controller, whose PV input is calculated using the following equation:
RC536 PV = Scale ∗ AIV506 PV
100% ∗ FC536 PV∕FC503 PV (11.16) Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License404 11 Energy Conservation Controls
where
RC536 PV Recycle gas H2 content/Oil feed ratio
AIV506 PV Current, validated recycle gas H2 purity (% H2), AI506 PV (measured)
FC536 PV Recycle gas flow rate (measured)
FC503 PV Oil feed flow rate (measured)
Scale Ensures engineering unit compatibility among the measurements
The recycle gas H2 purity measurement is validated in AIV506 before it is used for control
in RC536. Via its PV calculation, RC536 responds to oil feed rate changes (FC503 PV), and
any reformer upset that affects reformer off-gas (and thus recycle gas) H2 content. At constant
reformer off-gas H2 content (and hence constant recycle gas H2 purity, AI506 PV), the strategy in
Figure 11.45 is equivalent to recycle gas/oil feed ratio control (see Equation [11.16]).
Design Notes and Features
1. This control strategy is a simple cascade and cascade initialization and wind-up are both handled
by standard DCS features.
2. If FC536 PV is increasing and/or above its setpoint, its output (FC536 OP) decreases to reduce
recycle gas compressor speed (SC510). Thus, FC536 has control direction = Reverse. FC536 is a
cascade secondary and therefore it is tuned for best SP response, proportional on error with SP
Init = Yes.
3. In Equation (11.16), FC503 PV is used in the calculation of RC536 PV. Thus, when FC503 PV
becomes unavailable, standard DCS features will set RC536 PV “Bad” and ratio control stops.
Standard DCS features will also re-commission ratio control when FC503 becomes available
again. However, if the last good FC503 PV value used on all execution passes, even if FC503 PV
is unavailable, RC536 control continues, and responds to upsets that affect reformer off-gas H2
content. However, custom logic/code is required to: (i) store, update, and use the last “Good”
FC503 PV value in the RC536 PV calculation and (ii) initialize RC536 when FC503 PV becomes
available again.18
4. If FC503 SP is used in the calculation of RC536 PV (to minimize FC503 PV noise propagation
to the recycle gas flow), FC503 must be configured for SP Init = Yes. If FC503 is an ultimate
secondary in another control cascade, it is already configured for SP Init = Yes. Additional
logic/code should be considered to switch to FC503 PV when FC503 is wound-up and in Auto.
If FC503 SP is a guideline value, and SP Init is reconfigured to be = Yes, additional logic/code
must be provided to slowly ramp the initialized FC503 SP back to its last guideline value. The
FC503 PV/SP choice in the RC536 PV calculation should be discussed with operations before
final design and implementation.
5. If the last valid value of recycle gas H2 purity (AI506 PV) is used when AI506 is declared invalid
by AIV506, RC536 control continues and responds only to oil feed rate and RC546 SP changes.
AIV506’s standard validity tag design (described in Section 8.8) provides this functionality. User
provided custom logic/code is required to initialize RC536 when AI506 PV returns valid.
6. RC536 is a PID controller, and since it is a cascade primary whose setpoint will be changed
only occasionally, it is tuned for best load response, proportional on PV. If RC536 PV is increas￾ing and/or above its setpoint, RC536 must decrease recycle gas flow, FC536 SP. Thus, RC536 is
configured with control direction = Reverse.
7. Since RC536 SP is specified offline, configuring RC536 for SP Init = No is in principle acceptable.
However, this can cause a bump to FC536 SP whenever RC536 initializes, e.g., when FC503 PV
becomes available after being unavailable, AI506 PV is declared valid after being invalid, and
18 See Section 3.2 for an explanation and full details.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.6 Reducing Reactor Treat Gas, Recycle Gas Flows 405
so on. If RC536 is configured for SP Init = Yes, FC536 SP will not be bumped when RC536
initializes. However, if SP Init = Yes, it is best to provide additional logic to slowly ramp the
initialized RC536 SP back to the last guideline SP value. The SP Init and ramping issues should
be discussed with operations before final design and implementation.
11.6.3 Naphtha Hydrofiner Reactor Treat Gas and H2 Make Gas Minimization
Like the gas oil hydrofiner discussed in Section 11.6.1 (Figure 11.39), in addition to meeting a
conversion target, the NHF (R-601) in Figure 11.46 has additional operating objectives that include:
(i) reducing H2 make-up gas utilization, (ii) maintaining the reactor’s H2 partial pressure at the
value that promotes the desired hydrofiner reactions, and (iii) ensuring the catalyst end-of-run
target is met.
For R-601 in Figure 11.46, preheat duty is not large enough to require a fired heater. Instead,
reactor R-601’s inlet temperature (TC603) target is met by heat exchange with reformer effluent
in exchangers E-601 and E-602. However, compressor C-610 operating costs are reduced by reduc￾ing H2 make gas utilization. In addition, by limiting H2 make gas to only the amount needed to
operate at the desired reactor H2 partial pressure, the dumping of H2 rich purge gas to the treat
gas (via FC625) and fuel gas (via PV606B) headers is avoided. Thus, for R-601’s configuration in
Figure 11.46, in order to conserve energy, the applicable operating objectives are to: (i) reduce C-610
operating costs by reducing H2 make-up gas utilization and (ii) avoid dumping H2 rich purge gas
to the treat gas and fuel gas headers.
Reactor R-601 treat gas FC608 is controlled by adjusting the recycle gas flow to compressor C-610.
Treat gas is made up of the recycle gas (via FV608) and H2 make-up gas (via FC610). Any excess
recycle gas not routed to C-610 by FC608 is purged to the treat gas header via FC625 and, via
split range pressure controller PC606, to the gas oil hydrofiner (PV606A) or to the treat gas header
(PV606B).
The control strategy implemented to reduce C-610 operating costs and avoid dumping H2 rich gas
to treat gas or fuel gas headers has two components which are equivalent to the gas oil hydrofiner
R
6
0
1
Naphtha
H/F
E-602 E-601
TV603
TC
603
Reformer
effluent
Virgin
naphtha
Cat
naphtha
FC
601
FC
603
FV601
FV603
Treat gas
Separator
drum
% H2
AI
608
FC
608
Lean
amine
Rich
amine
Purge gas
Amine
scrubber
To
FG header 
To
GO H/F 
To TG
header
T
6
0
1 PV606A
PV606B
FI
622
PC
606
FC
625
FV625
Recycle
gas H2
FV608
C-610
H2
make gas
FC
610
FV610
D-601
Figure 11.46 Naphtha Hydrofiner (R-601) Feed and Treat Gas Configuration
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License406 11 Energy Conservation Controls
Recycle
gas
SP
FC
608
FV608
TG flow
control
FC600
PV
RC608
Total
feed
SP
Desired
TG/feed
ratio
PV FC
601
FC
603
Virgin naphtha
feed
Cat naphtha
feed
Figure 11.47 Naphtha Hydrofiner Treat
Gas/Feed Ratio Control
controls discussed in Section 11.6.1: the first adjusts R-601 treat gas flow to maintain the desired
treat gas/oil feed flow ratio, while the second adjusts H2 make gas flow to C-610 to maintain the
desired recycle gas H2 purity. Together, they reduce treat gas and H2 make gas utilization. The
first element, treat gas/total feed ratio control, is presented in Figure 11.47. Since there are two
different feed sources (virgin naphtha and cat naphtha), the total feed rate must first be calculated
(in FC600) before it becomes the ratio controller’s wild flow input. Without treat gas/feed ratio
control operators typically use more treat gas than necessary to ensure there is always enough for
any expected reactor feed rate. Thus, this strategy helps reduce treat gas utilization, especially when
reactor feed rates are reduced.
Design Notes and Features
1. This control strategy is a simple cascade and cascade initialization and wind-up are both handled
by standard DCS features.
2. FC601, FC603, and FC608 are conventional flow controllers and thus all three have control
direction = Reverse.
3. FC608 is a cascade secondary and therefore it is tuned for best SP response, proportional on error
with SP Init = Yes.
4. RC608 is not a PID, and thus requires no tuning. Since it is a cascade primary and its set point
is specified offline, setting SP Init = No is in principle acceptable. However, with SP Init = No,
FC608 SP will almost certainly be bumped after RC608 initializes. If a treat gas bump is unac￾ceptable, configure RC608 for SP Init = Yes, and provide additional code/logic to slowly ramp
the initialized RC608 SP back to its last guideline value. These issues must be discussed with
operations before final design and implementation.
5. FC600 PV is RC608’s wild flow input; it is the sum of the virgin naphtha (FC601 PV) and cat
naphtha (FC603 PV) feed flows. When either feed flow measurement is unavailable, standard
DCS features will (i) set FC600 PV “Bad”, (ii) set RC608 PV “Bad”, and thus (iii) prevent
RC608 from outputting a new treat gas setpoint. Standard DCS features will initialize and
re-commission ratio control when the unavailable feed measurement becomes available again.
6. To minimize feed measurement noise propagation to the treat gas, FC600 PV can be calculated
as the sum of the individual feed flow controller setpoints, FC601 SP and FC603 SP. If so, FC601
and FC603 must be configured for SP Init = Yes, or custom logic/configuration must be added
to allow use of FC601 PV or FC603 PV when FC601 or FC603 is in manual mode or wound-up
in Auto mode. The usual SP Init and FC601 and FC603 SP ramping issues must be discussed
with operations before final design and implementation.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License11.6 Reducing Reactor Treat Gas, Recycle Gas Flows 407
Figure 11.48 Recycle Gas H2 Purity Control, w/o Make
Gas/Treat Gas Ratio Control
Recycle gas
H2 purity
H2
make gas
AC608
SP
Desired
recycle gas
H2 purity
PV610
SP
AIV608
Validity
AI
608
FC
610
Similar to the gas oil hydrofiner in Section 11.6.1, the H2 make gas flow (FC610) is controlled and
is an available degree of freedom that impacts both recycle gas and treat gas H2 purity. With the
recycle gas H2 purity measured (not the treat gas H2 purity), recycle gas H2 purity can be controlled
at its desired value by manipulating the H2 make-up gas flow (FC610). For the gas oil hydrofiner
in Figure 11.39 (Section 11.6.1), changes in H2 make-up gas affected treat gas purity very quickly
(due to the proximity of the recycle gas/make-up gas mix point to the H2 purity measurement sam￾ple tap). However, for the NHF in Figure 11.46, the recycle gas H2 purity dynamic response to
changes in make gas will be slow and contain long deadtimes. Make-up gas flow changes must
pass through compressor C-610, reactor R-601, separator drum D-601 and amine scrubber T-601
before its effect on the recycle gas H2 purity is measured. That long dead time makes PID con￾trol of AI608 PV very difficult, and control performance will almost certainly be poor. A recycle
gas H2 purity model-based controller is almost certainly the preferred approach, although control
performance may still be poor.
As presented in Section 11.6.1, there are two possible approaches to recycle gas H2 purity control
–without make gas/treat gas ratio control, shown in Figure 11.48, and with make gas/treat gas ratio
control, shown in Figure 11.49. In both cases, the recycle gas H2 purity measurement (AI608 PV)
is validated (in AIV608) before its use in AC608. For the process configuration in Figure 11.46, it
is reasonable to assume that even though the recycle gas H2 purity response to changes in both
treat gas and make gas flows are slow and have long deadtimes, their dynamics (e.g., dead time and
first order time constant) should have about the same magnitudes. Thus, treat gas is not dynamically
compensated before it becomes RC610’s wild flow input in Figure 11.49.
When there are frequent treat gas flow changes, control performance with make gas/treat gas
ratio control (Figure 11.49) is more effective than without it (Figure 11.48). Similar to the gas oil
hydrofiner in Section 11.6.1, overall and H2 material balances (Equations (11.13) through (11.15)
in Section 11.6.1) can help assess the advantages of including make gas/treat gas ratio control.
Equation (11.17) is the equivalent overall and H2 material balance relationship for R-601’s config￾uration in Figure 11.46:
FC610
FC608 = (%H2 TG − AI608PV)
(%H2 MU − AI608 PV) = Make gas flow
Treat gas flow (11.17)
where
%H2 TG Treat gas H2 purity (unmeasured)
%H2 MU Make gas H2 purity (unmeasured)
AI608 Recycle gas H2 purity (measured)
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License408 11 Energy Conservation Controls
Recycle gas
H2 purity
H2
Make gas
AC608
RC610
Make gas/
treat gas
ratio control
Treat
gas
SP
SP
Desired
recycle gas
H2 purity
FV610
SP
AIV608
Validity
AI
608
FC
608
FC
610
Figure 11.49 Recycle Gas H2 Purity Control,
with Make Gas/Treat Gas Ratio Control
Referring to Equation (11.17), for constant treat gas and make-up gas H2 purities, the recycle gas
H2 purity is determined by the make-up gas/treat gas ratio. Thus, a (steady state) FF adjustment
to make-up gas flow (via RC610) when treat gas flow changes helps maintain H2 material balance.
Recycle gas H2 purity stays about the same, and AC608 feedback control adjustments are kept to a
minimum.
However, this is only true for treat gas flow changes, which are for the most part due to RC600’s
(treat gas/feed ratio control) adjustments (Figure 11.47). Any upset that changes either make gas or
recycle gas H2 purity requires AC608 feedback control adjustments. Make gas/treat gas ratio control
offers no FF advantage for these upsets, and the control performance of the two AC608 strategies in
Figures 11.48 and 11.49, for these H2 purity upsets, are about the same. However, unlike the gas oil
hydrofiner in Section 11.6.1, the recycle gas H2 purity – make gas response dead time will degrade
the control performances of both strategies, especially if AC608 is a PID controller.
Implementing AC608 as a model-based controller can overcome some drawbacks of the slow
dynamics/long deadtimes in recycle gas H2 purity responses to changes in both treat gas and
make gas changes. However, if process conditions, analyzer capabilities and cost considerations
allow the AI608 sample point to be moved from the recycle gas stream to the treat gas stream, the
dynamic effects of reactor R-601, separator drum D-601, and amine scrubber T-601 will for the
most part be eliminated from H2 purity responses. This would increase the likelihood that AC608
as a model-based controller, or even configured as a PID controller, would provide acceptable
control performance.
Design Notes and Features
1. Both control strategies, in Figures 11.48 and 11.49, are simple cascades, and cascade initializa￾tion and wind-up are both handled by standard DCS features.
2. FC610 is a conventional flow controller and thus FC610 has control direction = Reverse. FC610
is a cascade secondary and therefore it is tuned for best SP response, proportional on error with
SP Init = Yes.
3. In Figure 11.49, if the treat gas flow (FC608 PV) is RC610’s wild flow input, when FC608 is
unavailable, standard DCS features set RC610 PV unavailable and recycle gas H2 purity control Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons LicenseReferences 409
(AC608) is decommissioned. When FC608 PV becomes available, standard DCS features will
initialize both RC610 and AC608, and recommission recycle gas H2 purity control. To avoid
decommissioning the feedback loop (AC608) when FC608 PV becomes unavailable, as discussed
in Section 3.2, the desired approach is to store, update and use the last “Good” value of FC608
PV as RC610’s wild flow input. RC610 control continues (with a constant wild flow input) after
FC608 PV becomes unavailable, and responds to (i) upsets that affect make gas and treat gas H2
purity and (ii) RC610 SP changes calculated by AC608. User provided custom logic/code must
be provided to initialize RC610 when FC608 PV returns available.
4. If FC608 SP is used as RC610 wild flow input instead of FC608 PV (to minimize treat gas
measurement noise propagation to make-up gas), FC608 must be configured for SP Init = Yes.
Since FC608 is RC608’s secondary in Figure 11.47, it is already configured for SP Init = Yes.
Additional logic/code may be necessary to use FC608 PV whenever FC608 becomes wound-up
in Auto mode, but must be provided to initialize RC610 when FC608 PV returns available.
5. When AI608 PV is flagged invalid by AIV608, standard DCS features (in combination with stan￾dard validity logic/code in AIV608) will stop control of recycle gas H2 purity (AC608). However,
for the control strategy in Figure 11.49, RC610 control continues at the last value of RC610 SP
calculated by AC608, and responds to anything that changes treat gas flow or an operator entered
RC610 SP change. Standard DCS features will initialize AC608 whenever AI608 PV returns valid
(control strategies in both Figures 11.48 and 11.49).
6. RC610 can be configured as a PID controller or with an algebraic control algorithm that calculate
the make gas flow set point directly. In either case, as a cascade secondary, it is configured for
SP Init = Yes. If RC610 is configured as a PID, it is tuned for best SP response, proportional on
Error. If the make-up gas/treat gas ratio (RC610 PV) is increasing and/or above its setpoint,
RC610 OP must decrease to decrease FC610 SP. Thus, RC610 as a PID is configured with control
direction = Reverse.
7. If RC610 is configured with an algebraic control algorithm, the RC610 PV value is calculated for
display only, since RC610 PV does not impact RC610’s control calculation. If RC610 is a PID, the
RC610 PV value has direct impact on RC610’s control calculation. RC610 PV is calculated alge￾braically from FC610 and FC608, where any number of possibilities exist re/the choice between
PV and SP for both flows and the SP Init issues that arise.
8. AC608 is a cascade primary, whose setpoint is changed only occasionally. Therefore, if
configured as a PID, it is tuned for best load response, proportional on PV. Since the AC608
setpoint value is established offline and is almost never changed, AC608 is configured for SP
Init = No. However, if SP Init = No, when AC608 initializes, RC610 SP (in Figure 11.49) or
FC610 SP (in Figure 11.48) will almost certainly be bumped. If the resulting H2 make gas bump
is not acceptable, then configure AC608 with SP Init = Yes and provide additional logic to
slowly ramp the initialized AC608 SP back to its last (guideline) SP value. It is best to discuss
the SP Init and ramping issues with operations before final design and implementation.
References
1 Smith, C.L. (2010). Advanced Process Control: Beyond Single-Loop Control, 247–260. Hoboken,
NJ: Wiley.
2 King, M. (2010). Process Control: A Practical Approach, 227–236. Chichester: Wiley.
3 Treybal, R.E. (1980). Mass Transfer Operations, 3e, 346. New York, NY: McGraw-Hill.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License410
12
Tower Product Quality Controls
CHAPTER CONTENTS
12.1 Tower Basics
12.2 Two-product Towers – Process Variable Summary
12.2.1 MVs, CVs, DVs, and Calculated Variables
12.2.2 CV–MV Pairings
12.2.3 Key Components and Separation
12.3 Two-product Towers – Common Product Quality Control CV–MV Pairs
12.3.1 Dual-product Quality Control
12.3.2 Control of One Product Quality
12.3.3 Towers with a Partial Condenser and an Overhead Vapor Product
12.3.4 Towers with Drumless Flooded Condensers
12.4 Towers with Sidestream – Process Variable Summary
12.4.1 MVs, CVs, DVs, and Calculated Variables
12.4.2 CV–MV Pairings
12.4.3 Key Components and Separation
12.5 Towers with Sidestream – Common Product Quality Control CV–MV Pairs
12.6 Cutpoint, Fractionation, and Their Impact on Tower Operations
12.6.1 Tower Cutpoint
12.6.2 Feed Composition Changes and Cutpoint
12.6.3 Tower Fractionation
12.7 Two-product Towers – Overview of Conventional Advanced Control Applications
12.7.1 Conventional Advanced Product Quality Control with MV =Reboiler Duty
12.7.2 Fractionation Management with MV =Reflux Flow
12.7.3 Conventional Advanced Product Quality Control with MV = Reflux Flow
12.7.4 Fractionation Management with MV = Reboiler Duty
12.7.5 Conventional Advanced Product Quality Control with MV = Distillate Rate
12.7.6 Other Product Quality Strategies
12.8 Towers with Sidestream – Overview of Conventional Advanced Control Applications
12.8.1 Conventional Distillate and Bottoms Advanced Product Quality Control
12.8.2 Conventional Sidestream Advanced Product Quality Control
12.8.3 Fractionation Management
12.8.4 Fractionation Management with Product Quality Control Override
12.9 Two-product Towers – Conventional Advanced Control Application Examples
12.9.1 Crude Light-ends Section Tower Controls
12.9.2 Alternative Crude Light-ends Section – Catalytic Reformer Feed Debutanizer (T-542)
Controls
12.9.3 Benzene/Toluene/Xylene (BTX) Feed Fractionation Section Tower Controls
12.9.4 Benzene/Toluene/Xylene (BTX) Product Fractionation Section Tower Controls
12.10 Towers with Sidestream – Conventional Advanced Control Application Examples
12.10.1 Crude Light-ends Section Naphtha Splitter Controls
12.10.2 Reformer Light-ends Section Reformate Stabilizer Controls
12.10.3 BTX Product Fractionation Section: Benzene Tower Controls
References
Practical Process Control Design with Industrial Applications, First Edition. Alan M. Kugelman.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12 Tower Product Quality Controls 411
There are large numbers of distillation towers in chemical plants and oil refineries throughout
the petrochemical industries. They are not only one of the most important separation processes,
they are also a major consumer of energy. Tower unit operations separate a mixture of components
with different boiling points into a lighter, lower boiling overhead product and a heavier, higher
boiling bottoms product by heating the mixture to its bubble point and condensing the vapors.
However, separating feed components into tower products is a complex process – it involves satis￾fying material and energy balances within the framework established by vapor/liquid equilibrium
relationships at each tray’s prevailing temperature, pressure, and composition.
Process control plays an essential role in tower unit operations. Therefore, incentives for good
tower control are high – increasing recovery of valuable products, reducing plantwide energy costs,
stabilizing downstream (and sometimes upstream) operations, and helping to maintain operations
within safety and environmental limits. Distillation towers are numerous and play a prominent
role in achieving a processing area’s operating objectives. Therefore, good tower control is a major
contributor to plant profitability.
However, effective tower control is difficult to achieve:
– Tower responses tend to be nonlinear. CV dynamic responses to MV increases and decreases of
various magnitudes are different
– Towers are heat integrated with other process units via their reboiler duties and feed preheat
– Towers are multivariable – control objectives are achieved by implementing multiple control
strategies that interact, making good control performance difficult to achieve.
– Towers are prone to disturbances – feed source and heat integration upsets and ambient condi￾tion changes (if there is an air fin condenser).
– Towers have many potential constraints – max/min reboiler and/or condenser duties, max/min
valve and flow constraints, and tray hydraulic constraints (high and low vapor/liquid loading).
This chapter focuses on the design of conventional advanced control strategies for distillation
towers, with and without a sidestream. The separation of wide-boiling feed stocks, in primary
fractionators (e.g., CDUs) or main fractionators to separate reactor effluent products is deferred
to Chapter 13. This chapter begins with a discussion of tower basics, and the MVs, CVs, DVs, and
calculated variables associated with tower operations, with and without a single sidestream. The
concept of key components and their relationship to tower separation is described. The important
roles of cutpoint and fractionation and their impact on tower operations are explained.
Based on the most frequently chosen CV–MV pairings, product quality control overviews for
two-product towers and towers with a sidestream are presented and discussed. In the overview
discussions, only the ultimate primary (CV) and the ultimate secondary (MV) are considered.
Standard advanced control components (e.g., internal reflux control) are identified, and depending
upon the functionality required, specific components are chosen to link CVs and MVs and connect
the ultimate primary (the product quality) to the ultimate secondary (an available MV) and thus
complete the conventional advanced control strategy’s cascade structure.
The methods used to manage fractionation while simultaneously controlling product quality
are also presented. For two-product towers without a sidestream, either an MV is available to
manage fractionation directly or the fractionation is determined by default as a by-product of
the two-product quality control strategies achieving their control objectives. For towers with a
sidestream, the sidestream draw-off flow’s impact on the tower’s internal reflux and hence the
tower’s fractionation can sometimes complicate the design of product quality control strategies.
Therefore, for towers with a sidestream, concerns for insufficient internal reflux can make control
of product quality more difficult.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License412 12 Tower Product Quality Controls
The chapter concludes with the presentation and discussion of realistic, industrial applications.
These tower control applications illustrate how the standard advanced control components iden￾tified are used to connect ultimate primaries to ultimate secondaries to synthesize both product
quality and fractionation management control cascades.
Important: Distillation towers are multivariable, and their control strategies tend to interact. If
the interactions are significant, effective product quality control is difficult to achieve with con￾ventional control strategies. In many cases, model-based control is helpful, and incorporating the
tower’s control objectives into a wider-scope multivariable DMC controller will normally provide
more effective control performance. This is especially true for towers with a sidestream.
12.1 Tower Basics
Figure 12.1 shows a simplified P&I drawing of a typical two-product tower.
The feed stream (FI1), made up of several components with different boiling points, enters the
tower and is ultimately separated into two products – a lighter, lower boiling distillate overhead
product (FI2) and a heavier, higher boiling bottoms product (FI3). The heat added in the reboiler
(QR) and the large fraction of QR removed in the overhead condenser (QC) produce the vapor and
liquid phases that flow counter current in the tower. As the vapor rises in the tower, it contacts
the downward flowing liquid, and via equilibrium promoted mass transfer on each tray, the lighter
(lower boiling) components tend to accumulate in the vapor phase and heavier (higher boiling)
components tend to accumulate in the liquid phase. The overhead vapor is condensed in the over￾head condenser, and the condensate accumulates in the reflux drum (LI1). Part of the reflux drum’s
hold-up is returned to the tower as external reflux (FI4) while the remainder is removed as the
distillate product (FI2).
The cooled, external reflux that is returned to the tower condenses some vapor on the tower’s
top tray, and the combined external reflux and condensed vapor is the tower’s liquid internal reflux
(IR). The internal reflux flowing downward accumulates in the tower bottoms (LI2). Part of the
bottoms hold-up is removed as the bottoms product; the rest is vaporized in the reboiler. The vapor
produced (vapor boil-up) is returned to the tower, flows upward, is condensed, accumulates in the
reflux drum, and is either is returned to the tower as reflux or removed as distillate product.
The overhead condenser in Figure 12.1 is a complete condenser – all vapor flowing overhead
is condensed and there is no overhead vapor product. However, some overhead condensers are
partial condensers – some vapor remains uncondensed. Therefore, in addition to the (liquid) dis￾tillate product, there is also an overhead vapor product (see Section 12.3.3). Also, some important
tower configurations do not have a reflux drum – see Section 12.3.4 for a discussion of towers with
drumless, flooded condensers.
12.2 Two-product Towers – Process Variable Summary
Towers are designed to produce products that meet purity/impurity (e.g., desired C2 content of C3
product) and property (e.g., 95% distillation point) specifications. The process design basis is usually
one or more desired steady-state operations that achieve the desired separation. At the design stage,
design parameters such as the number and type of trays, feed location(s), condenser and reboiler
duties, reflux drum hold-up/surge capacity, and bottoms hold-up/surge capacity are specified, and
they and other design features ensure the design’s steady-state operating conditions will in principle Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.2 Two-product Towers – Process Variable Summary 413
CW
FI
4
LI
2
FI
3
FI
1
FI
2
L
V
L
LI
1
QC
L
V
QR
IR
Figure 12.1 Two-Product Tower – Simplified P&I Drawing
be achieved. However, tower designs are always sufficiently robust to permit operations in a feasible
region that contains the unit’s design basis. The feasible operating region accounts for the process
effects of typical disturbances and expected future operational changes that will require the unit to
operate at times away from its design basis.
Once the tower is designed and operating, there are a small number of independent variables
that can be manipulated to maintain operating variables at desired targets despite upsets and oper￾ational changes that affect process operations. In preparation for the discussion of typical tower
control strategies in Sections 12.3 and 12.5, tower basic operating variables are first examined
to establish which variables are controlled – the control variables (CVs), which variables have
impact on the CVs and can be independently changed – the manipulated variables (MVs), and
which variables have impact on the CVs but cannot be independently changed – the disturbance
variables (DVs).
12.2.1 MVs, CVs, DVs, and Calculated Variables
Figure 12.2 presents a simplified Piping and Instrument (P&I) drawing that shows the impor￾tant measurements and calculated variables that describe a two-product tower’s operating con￾ditions. Note that these measurements may not all be provided for a specific tower configuration.
For example, in many cases, the hardware required to measure the feed composition (AI3) is not
provided. And, depending upon the ease of measurement and importance of a specific product
quality in achieving the unit’s operating objectives, the distillate and/or bottoms product quality Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License414 12 Tower Product Quality Controls
FI
4
TI
4
CW
PI
1
TI
2
Qc
IR
FV4
FI
2
TI
3
LI
1
AI
1
FV2
LI
2
FI
3
FI
1
TI
5
TI
1
AI
2
AI
3 TI
6
FI
5
TI
7
QR
TI
8
FV5
FV3
FVCW
Figure 12.2 Two-Product Tower – Basic Operating Variables
measurement(s) (AI1, AI2) may not be in the design basis. For any of these three measurements to
be included in the tower’s design basis, the estimated product quality and/or product yield improve￾ments associated with the measurement’s use must be large enough to justify their initial hardware
investment and their ongoing maintenance costs.
Reboiler duty (QR) and internal reflux (IR) are important calculated variables1 and, as will be
made clear in subsequent discussions, are included in many common tower control strategies.2,3
The calculation and control of condenser duty (QC) is not as common as either reboiler duty or
internal reflux – condenser duty is normally manipulated indirectly, without its explicit calculation,
by adjusting the cooling water flow rate if it is water cooled or by adjusting air louvers or fan speed
if it is air cooled.
The measured and calculated PVs in Figure 12.2 are the tower’s basic operating variables from
which the typical tower’s controlled, manipulated, and disturbance variables are chosen. These
measured and calculated PVs are summarized in Table 12.1, where each variable’s type, e.g., control
variable (CV), manipulated variable (MV), or disturbance variable (DV), is indicated. Variables with
1 Reboiler duty calculation/control is discussed in Section 3.7.1, internal reflux calculation/control in Section 3.7.2.
2 See Sections 10.3.2, 10.3.3, and 11.3.1 for reboiler duty calculation and control examples.
3 An internal reflux calculation and control example is presented in Section 11.3.2.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.2 Two-product Towers – Process Variable Summary 415
Table 12.1 Two-product Tower MVs, CVs, DVs, and Calculated Variables
Symbol Process Variable Type
FI1 Feed flow rate DV
FI2 Distillate flow rate MV
FI3 Bottoms flow rate MV
FI4 Reflux flow rate MV
FI5 Reboiler hot fluid flow rate MV, DV, Calc – QR
LI1 Reflux drum level CV
LI2 Bottoms level CV
AI1 Distillate product quality (LK concentration) CV
AI2 Bottoms product quality (HK concentration) CV
AI3 Feed composition DV
PI1 Tower pressure CV
TI1 Feed temperature DV
TI2 Overhead temperature DV
TI3 Reflux temperature DV, Calc – IR
TI4 Tray temperature (above feed tray) CV (Infers AI1)
TI5 Tray temperature (below feed tray) CV (Infers AI2)
TI6 Reboiler hot fluid inlet temperature DV, Calc – QR
TI7 Reboiler hot fluid outlet temperature Calc – QR
TI8 Reboiler vapor return temperature CV
IR Internal reflux (calculated) MV
QC Condenser duty (rarely calculated) MV
QR Reboiler duty (calculated) MV
type “Calc” in Table 12.1 are, as indicated, used in the calculation of reboiler duty (QR) or internal
reflux (IR).
Here are important observations related to some entries in Table 12.1:
● Every tower design must include control valves FV2, FV3, FV4, and FV5 to enable distillate (FI2),
bottoms (FI3), reflux (FI4), and reboiler hot fluid (FI5) flows to be manipulated (whether the
flows are measured or not).
● Feed rate, FI1, is almost always set by upstream process conditions and thus it is usually a DV,
not an MV. If the feed source is a tank, then feed rate may be an MV.
● Feed composition, AI3, is also almost always set by upstream process conditions, and thus if
measured it can be a DV; it is never an MV.
● The reflux flow (FI4) is required for the calculation of internal reflux (IR). FI4 or IR can be an
MV, but only one can be fixed independently. If the reflux flow measurement is not in the design
basis (highly unlikely), FV4 replaces FI4 as an MV, and internal reflux cannot be calculated.
● Reboiler hot fluid flow rate, FI5, is required for the calculation of reboiler duty, QR. FI5 or QR can
be an MV, but only one can be fixed independently. If the reboiler hot fluid flow rate measurement
is not in the design basis (highly unlikely), FV5 replaces FI5 as an MV, and reboiler duty cannot
be calculated.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License416 12 Tower Product Quality Controls
● If either the distillate flow (FI2) or bottoms flow (FI3) measurement is not in the design basis
(highly unlikely), FV2 or FV3 replaces FI2 or FI3 as an MV.
● Reflux temperature, TI3, is a DV and is required for the calculation of internal reflux.
● If the reboiler hot fluid is not steam – it is a process stream, the reboiler hot fluid inlet tempera￾ture, TI6, is a DV, and TI6 is required for the calculation of reboiler duty.
● Reboiler hot fluid outlet temperature, TI7, is neither a CV, MV nor a DV, but if the reboiler hot
fluid is not steam, TI7 is required for the calculation of reboiler duty.
● If condenser duty is not calculated, and it is water cooled as in Figure 12.2, duty is manipulated
indirectly by adjusting the cooling water flow rate or the cooling water valve position (FVCW).
Cooling water flow or FVCW is the MV.
● Tray temperature above the feed tray, TI4, may infer the distillate stream’s quality (heavy key, HK,
impurity), and if so, it can be the distillate product quality control loop’s primary (CV) when the
quality measurement, AI1, is not available.
● Tray temperature below the feed tray, TI5, may infer the bottoms stream’s quality (light key, LK,
impurity) and if so, it can be the bottoms product quality control loop’s primary (CV) when the
quality measurement, AI2, is not available.
● In a dual-product quality-controlled tower, both distillate and bottoms product qualities are con￾trolled. However, in most tower applications, only one product’s quality, AI1 (distillate product)
or AI2 (bottoms product), is controlled. The quality (impurity) controlled is often the feed’s LK
concentration in the bottoms product or the feed’s HK concentration in the distillate product.
Key components, and their impact on separation, are discussed in Section 12.2.3 with the help of
Figure 12.3.
Based on the PVs identified as CVs in Table 12.1, here are a tower’s five control objectives:
Control Objective CV Symbolon Figure 12.2
Mange reflux drum hold-up LI1
Manage tower bottoms hold-up LI2
Control tower pressure PI1
Maintain distillate product quality at target4 AI1 (HK)
Maintain bottoms product quality at target5 AI2 (LK)
From Table 12.1, the MVs available to adjust to achieve these five control objectives are:
Manipulated Variable MV Symbol on Figure 12.2
Distillate flow rate FI2 (or FV2)
Bottoms flow rate FI3 (or FV3)
Reflux flow rate or internal reflux FI4 (or FV4) or IR
Condenser duty QC
Reboiler duty or hot fluid flow rate QR or FI5 (or FV5)
4 Or tray temperature TI4 if it infers the distillate product’s quality and AI1 is not measured.
5 Or tray temperature TI5 if it infers the bottoms product’s quality and AI2 is not measured.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.2 Two-product Towers – Process Variable Summary 417
Table 12.2 Two-product Tower Configurations – Common CV–MV Pairings
Manipulated Variables
Control Variables Reflux Distillate QC QR Bottoms
Reflux drum level x X
Bottoms level x X
Pressure X x
Distillate quality X x x
Bottoms quality x x X
X = Most frequently chosen as MV.
x = Sometimes chosen as MV.
x = Rarely chosen as MV.
These five control objectives may not all be applicable to a specific tower configuration, and tow￾ers may also have some alternative MVs. However, these five CVs and five MVs are represen￾tative of many two-product towers, but especially towers that have configurations as shown in
Figure 12.2.
12.2.2 CV–MV Pairings
Tower designs almost always specify the tower bottoms hold-up volume, and in most cases, the
reflux drum hold-up volume for accumulation of the liquid condensed in the overhead condenser.
As already explained and illustrated in Section 9.3.1, tower inventory control strategy design is
linked to how other tower control objectives are achieved. There are several potential MVs that
can in principle be manipulated to control reflux drum and tower bottoms levels. In most cases,
designers specify the best inventory control strategy based on reflux drum and tower bottoms surge
capacity and reflux, distillate, and bottoms flow rangeabilities. MVs that remain after designers
choose how best to satisfy the inventory control objectives are available to meet the other control
objectives.
In almost all cases, either reflux flow or distillate flow will be chosen as the MV to control reflux
drum hold-up (level), and bottoms flow rate will be chosen as the MV to control the bottoms hold-up
(level). Thus, either reflux flow or distillate flow and bottoms flow are normally eliminated as available
MVs to achieve the three remaining tower control objectives – control of tower pressure, distillate
product quality, and bottoms product quality. As discussed in Section 9.4.1, overhead and bottoms
inventory controls and product quality controls in two-product towers are not independent.
With this background discussion of the inventory controls in mind, the most common CV–MV
pairings encountered in the two-product tower configuration shown in Figure 12.2 are summarized
in Table 12.2.
Note that there are several potential MV choices for each CV. However, based on field implemen￾tation over the years, it is possible to order the frequency at which a specific MV is paired with each
CV; the MV most frequently paired with each CV is indicated, by X, in Table 12.2. These CV–MV
pairings apply unambiguously to the two-product tower configuration shown in Figure 12.2, which
includes a water-cooled condenser with complete condensation (no vapor product), and a reflux
drum to accumulate condensate. Among the examples that follow in this chapter will be towers
with different overhead configurations – they include air-cooled condensers, flooded condensers
without a reflux drum, and some condensers that feature partial condensation with production of Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License418 12 Tower Product Quality Controls
an additional overhead (vapor) product. All pairings shown in Table 12.2 are not applicable in these
cases – the major differences arise in how the overhead liquid hold-up is managed and how tower
pressure is controlled.
Important: No matter the CV–MV pairings chosen, the tower control strategies ultimately adjust
the tower’s material balance (via the distillate and bottoms flows) and the tower’s energy balance
(via the reboiler duty and reflux flow rate) to meet the product quality requirements (Ref. [1]). As
will be explained in Section 12.6, control strategy adjustments that primarily impact the tower’s
material balance set the tower’s cutpoint, while adjustments that primarily impact the tower’s
energy balance set the tower’sfractionation.
6 However, for most tower CV–MV pairings, individual
control adjustments taken in total change both the tower’s material balance and its energy balance
simultaneously.
The specific MVs chosen to pair with the product quality CVs have an important impact on the
tower’s overall operating performance. However, no matter the CV–MV pairings chosen, the inde￾pendent MV adjustments made to control each product’s quality will to some extent dynamically
interact with each other – each MV has a dynamic impact on both CVs, and if the interactions
are significant, this makes effective control of quality difficult.7 Some CV–MV choices can reduce
these interactions; however, incorporating the tower’s control objectives into a wider-scope multi￾variable controller, i.e., a DMC controller, will in many cases provide more effective control perfor￾mance. This is especially true for towers with a sidestream. Control performance enhancement via
conversion to a wider-scope DMC controller is identified as a promising option for several tower
conventional advanced control applications discussed later in this chapter.
Fortunately, in many two-product towers, only one product quality is controlled in closed loop; in
these cases, the dynamic interactions that adversely affect dual-product quality control are avoided.
But equally important, with one less CV, there is an MV available to use to achieve another tower
operating objective. As will be discussed in Section 12.3.2, when that extra degree of freedom is
available, it can be used to manage tower fractionation to adjust the energy balance to supply the
amount of energy required to achieve a desired tower separation. This leads to the very important
issue of energy-yield trade-off – is it cost effective to use additional energy (reboiler duty increase
and/or more reflux flow) to either improve the product’s purity or increase product yield. This
ultimately depends upon the cost of energy, the criticality of the product’s purity, and the product’s
value. Again, as already observed8 in an earlier application, unless the best operation is known to
be against (multiple) tower constraints, this issue cannot be resolved in real time by a conventional
control strategy or by DMC – it can only be resolved via RTO.
12.2.3 Key Components and Separation
In a two-product tower, feed components with different boiling points are separated into a lighter,
lower boiling distillate product and a heavier, higher boiling bottoms product. The LK is the feed
component designers desire to keep out of the bottoms product, while the HK is the feed component
designers desire to keep out of the overhead (distillate) product (Ref. [2]). Therefore, the tower’s
overall operating objective is to separate LK and lighter than light key (LLK) components (boiling
at a lower temperature than the LK) in the overhead product, and HK and heavier than heavy key
(HHK) components (boiling at a higher temperature than the HK) in the bottoms product.
6 Fractionation, and its role in tower quality control, was introduced in Section 11.3.
7 Dual-product quality control was first described in Section 11.3, and it is discussed again in Section 12.3.1.
8 Energy – yield trade-offs are issues discussed for a CDU bottoms product steam stripping application in
Section 11.4.1.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.3 Two-product Towers – Common Product Quality Control CV–MV Pairs 419
LLK
LK
HK
LK
HK
HHK
LLK
LK
HK
HHK
Distillate
product
Bottoms
product
Feed
LLK = Lighter than light key
LK = Light key
HK = Heavy key
HHK = Heavier than heavy key
Figure 12.3 Two-product Towers – Separation and Key Component Summary
If all LK and LLK components are separated as the distillate product, and all HK and HHK com￾ponents are separated as the bottoms product, the separation is perfect. As will be discussed in
Section 12.6.3, a perfect separation between the light and heavy keys is impossible. As illustrated
schematically in Figure 12.3, almost all LK, all LLK but some HK will be in the distillate product,
and almost all HK, all HHK but some LK will be in the bottoms product. Therefore, as indicated in
red font in Figure 12.3, the distillate product’s HK concentration is a measure of the distillate prod￾uct’s impurity, while the bottoms product’s LK concentration is a measure of the bottoms product’s
impurity.
12.3 Two-product Towers – Common Product Quality Control
CV–MV Pairs
It should be clear that the ultimate secondary, and the structure of any tower’s product quality
control strategy, will depend on the inventory control design basis specified by tower designers.
Discussions of the product quality controls that result if the most common CV–MV pairings in the
last two rows of Table 12.2 are implemented are now presented. In each case, only the ultimate sec￾ondary and the ultimate primary are included in the discussion. The starting point is a discussion
of dual-product quality control, where the tower material and energy balances are closed by satisfy￾ing both product quality targets. Then, control strategies that control only one product quality are
discussed – where tower material and energy balances are closed by manipulating the remaining
degree of freedom that is not needed to control a second product quality.
Remember: Cutpoint and fractionation are terms used to describe how the MVs in the last two
rows of Table 12.2 affect tower operations as those MVs are adjusted to maintain product qual￾ities at their desired values. The impact of cutpoint and fractionation on tower operations is dis￾cussed in Sections 12.6.1 and 12.6.3, respectively. Those discussions establish that cutpoint is closely Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License420 12 Tower Product Quality Controls
associated with the tower’s material balance, while fractionation is closely associated with the
tower’s energy balance.
12.3.1 Dual-product Quality Control
The dual-product quality control CV–MV pairings are illustrated in Figures 12.4 and 12.5 – in
Figure 12.4, reflux flow is paired with the distillate (overhead) product quality and in Figure 12.5,
it is the distillate flow. Note that in both figures, and in all examples that follow in this section, the
assumption is made that the bottoms level is paired with bottoms flow.
In Figure 12.4, with distillate flow manipulated to control reflux drum level, reflux flow and
reboiler duty are the two MVs that are adjusted to control the two product qualities. In Figure 12.4,
the reflux flow is paired with the distillate quality and the reboiler duty with the bottoms quality.
Manipulating reflux flow and reboiler duty directly impacts the tower’s energy balance and
determines the flow of liquid and vapor throughout the tower – the L/V ratio on each tray.
The overhead quality controller sets the reflux flow, ensuring there is enough internal reflux to
meet the distillate product’s specification. The bottoms quality controller sets the reboiler duty,
ensuring there is enough vapor boil-up to meet the bottoms quality specification. As explained in
TI
FC
FI
TI
PC
LC
CW
AI
TI FC
TI
LC
FC
FC
AI
Overhead
quality
Bottoms
quality
Figure 12.4 Dual-product Quality Control – Distillate Flow Paired with Reflux Drum Level
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.3 Two-product Towers – Common Product Quality Control CV–MV Pairs 421
PC
LC
FC
FI
CW
TI
AI
Overhead
quality
Bottoms
quality
FC
LC
TI
FC
TI
FC
TI AI
Figure 12.5 Dual-product Quality Control – Reflux Flow Paired with Reflux Drum Level
Section 11.3, since this value of duty is established as both product quality specifications are met,
it is the current operation’s minimum reboiler duty.
The tower pressure is controlled by manipulating the condenser duty via the cooling water flow;
these adjustments are predominantly in response to the vapor boil-up produced in the reboiler. The
condenser duty establishes the condensate hold-up in the reflux drum, and via the drum’s level
controller adjustments, it determines the distillate product flow. Likewise, the internal reflux, pro￾duced by the overhead quality controller’s external reflux flow adjustments, determines the tower
bottoms hold-up, and via the bottoms level controller adjustments, the bottoms product flow. It is
therefore the level controller adjustments, in response to the impact that reflux flow and reboiler
duty adjustments have on the energy balance, that close the tower’s material balance.
In Figure 12.5, the distillate flow and reboiler duty are the two MVs paired with the two prod￾uct qualities – the distillate flow is paired with the distillate quality and the reboiler duty with
the bottoms quality. The distillate quality controller sets the distillate flow, and the bottoms level
controller, by adjustments to the bottoms flow, closes the material balance. As before, with the
bottoms quality controller setting the reboiler duty, this value of duty is the current operation’s
minimum reboiler duty – it is established as both product quality specifications are met. The reflux
drum level controller’s reflux flow adjustments, and the reboiler adjustments, set the L/V ratio on
each tray.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License422 12 Tower Product Quality Controls
Note that the overhead quality controller’s distillate flow adjustments have no impact on the
tower’s operation until the reflux drum’s level controller responds to those flow adjustments
and changes the reflux flow. However, the impact of the distillate flow changes on the reflux
drum’s hold-up is small – the impact of the reboiler duty and condenser duty changes calculated
by the bottoms quality and pressure controllers are much larger. This means the distillate flow
adjustments have little impact on the tower’s energy balance, but they directly impact the tower
material balance.
Historically, both control strategies have been successfully implemented. Although there are
some advantages to each for specific situations, the differences encountered implementing each
strategy were eliminated with the widespread introduction of conventional advanced control appli￾cation features – reboiler duty control, internal reflux control, feed rate feedforward control, and
so on. However, dual-product quality control performance, via conventional control techniques,
suffers from the interactive nature of the control problem – no matter the CV–MV pairings, each
MV affects both CVs and control performance suffers. Because multivariable control, e.g., DMC,
manages the interactive nature of the control problem very well, it is the method often utilized
today for dual-product quality control, most notably as a component in a multi-unit, larger scope
DMC controller.
12.3.2 Control of One Product Quality
Referring to the last two rows of Table 12.2, the three MVs that have most frequently been paired
with either the distillate or bottoms product quality are the distillate flow rate, the reflux flow rate,
and the reboiler duty. However, either the distillate flow rate or the reflux flow rate must be paired
with the reflux drum level CV. Therefore, the MVs available to pair with the single quality CV are
the reboiler duty and either the reflux flow rate (distillate flow paired with the reflux drum level
CV) or distillate flow rate (reflux flow paired with the reflux drum level CV). The two possibilities
are shown in Figure 12.6 (distillate flow paired with level) and 12.7 (reflux flow paired with level).
In Figure 12.6, with the distillate flow paired with the reflux drum level, either the reflux flow
rate or the reboiler duty can be paired with either product quality, although the reflux flow is more
likely to be paired with the distillate quality CV, while the reboiler duty is more likely to be paired
with the bottoms quality CV. The MV not paired with the quality CV is an available degree of
freedom that can be used to manage fractionation – the net energy utilized while meeting the prod￾uct’s specification. In this configuration, reflux flow and reboiler duty adjustments directly impact
the tower’s energy balance. However, they indirectly impact the tower’s material balance because
they affect the reflux drum and tower bottoms levels. It is the two level controller responses – the
adjustments they make to the distillate and bottoms flow rates, that close the material
balance.
In Figure 12.7, with the reflux flow paired with the reflux drum level, either the distillate flow
rate or reboiler duty can be paired with either product quality. However, the distillate rate is almost
always paired with the product quality CV because it has a direct impact on the tower’s material
balance but only an indirect impact on the tower’s energy balance – via the reflux flow adjustments
calculated by the reflux drum’s level controller in response to distillate flow changes. On the other
hand, the reboiler duty adjustments have minimal impact on the tower’s material balance, which
is closed by the bottoms flow adjustments calculated by the bottoms level controller. Therefore, the
distillate rate adjustments for the most part impact the material balance and set the tower cutpoint,
while the reboiler duty adjustments for the most part impact the energy balance and sets the tower’s
fractionation.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.3 Two-product Towers – Common Product Quality Control CV–MV Pairs 423
TI
FC
FC
LC
TI FC
TI
FC
FI
TI
PC
LC
CW
Quality or
fractionation
Fractionation
or quality
Figure 12.6 Single-product Quality Control, Available MVs – Reflux Flow and Reboiler Duty
Typically, the desired reflux/feed or the desired reboiler/feed ratio (whichever MV is not paired
with the quality CV) is periodically calculated offline and maintained at the offline calculated value.
However, when the desired reflux/feed or reboiler duty/feed ratio changes on a more frequent basis,
an energy-yield trade-off may be justified, but if so would need to be incorporated into an existing
RTO application.
12.3.3 Towers with a Partial Condenser and an Overhead Vapor Product
When the overhead condenser is designed to support partial condensation, in addition to the (liq￾uid) distillate product, a vapor (overhead) product is generated. As before, the tower’s design basis
specifies the reflux drum level controller’s MV, and the MV not paired with the reflux drum’s level
CV, either the reflux flow – see Figure 12.8 – or distillate flow – see Figure 12.9, plus the reboiler
duty are the available degrees of freedom to control product quality.
Partial condensation’s only control impact is the method employed to control the tower’s over￾head pressure. In both Figures 12.8 and 12.9, instead of adjusting condenser duty, the vapor prod￾uct’s flow is paired with the tower pressure CV. Although there are other alternative pressure
control strategies implemented, this is the most common method used. This typically allows tower
pressure to be more effectively controlled. As a consequence, the need for pressure compensa￾tion of a tray temperature included in a product quality control strategy (Section 3.7.3) is reduced. Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License424 12 Tower Product Quality Controls
LC
FC
FC
TI
FC
FI
TI
LC
PC
CW
Quality
TI
TI
FC
Fractionation
Figure 12.7 Single-product Quality Control, Available MVs – Distillate Flow and Reboiler Duty
FC FI
PC
LC
TC
Quality or
fractionation
∞
Figure 12.8 Single-product Quality
Control, Partial Condensation – Distillate
Flow Paired with Reflux Drum Level
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.3 Two-product Towers – Common Product Quality Control CV–MV Pairs 425
Figure 12.9 Single-product Quality Control,
Partial Condensation – Reflux Flow Paired with
Reflux Drum Level
Quality
FC
LC
FI
TC
PC
CW
A temperature controller, located somewhere downstream of the condenser in the tower’s over￾head, typically adjusts condenser duty to meet the temperature target. Remember that whichever
MV is not the product quality controller’s MV, reflux flow or reboiler duty, is adjusted to manage
tower fractionation.
Identical to the tower configuration in Figure 12.7 with the reflux flow paired with the reflux
drum level, in Figure 12.9, either the distillate flow rate or reboiler duty can be paired with either
product quality. However, the distillate rate is almost always paired with the product quality CV,
and fractionation is managed by reboiler duty adjustments.
Other than the method used to control overhead pressure, all other two-product tower control
features discussed earlier in combination with Figures 12.4 through 12.7 are applicable to towers
with the overhead configurations displayed in Figures 12.8 and 12.9.
Note: The condenser in Figure 12.8 is an air-cooled exchanger that makes the tower vulnerable to
a major upset when there is a sudden ambient air temperature decrease, for example, caused by a
sudden rainstorm. The reduction in air temperature increases the condenser’s duty, and its outlet
temperature drops suddenly. The temperature controller’s adjustments, to return temperature to
set point, reduce the condenser’s duty (e.g., close air louvers), but if the condenser’s duty becomes
limited low, the condenser’s outlet temperature remains too low. The reflux returned to the tower is
subcooled, and causes the tower upset. However, as discussed in Section 3.7.2, by including internal
reflux control in the product quality control loop, feedforward corrections are provided for reflux
return temperature upsets, and the impact of these upsets are significantly reduced.
12.3.4 Towers with Drumless Flooded Condensers
A drumless, flooded condenser merges the heat removal role of a conventional condenser and a
reflux drum’s management of condensate inventory.9 Overhead vapor is condensed by the cooling
water flowing through the exchanger tubes. Instead of emptying out and flowing to the reflux
drum, the condensate accumulates in the condenser, submerging some exchanger tube surface
area below the liquid hold-up, while the rest of the tube surface area above the liquid hold-up
remains exposed to the entering overhead vapor. Heat is removed via two mechanisms – latent
9 Eliminating the reflux drum from the design basis has major cost incentives.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License426 12 Tower Product Quality Controls
heat, to condense overhead vapor in contact with the exposed tube surface area, and sensible
heat, transferred from the condensate to cooling water in the submerged tubes.10 The latent heat
removed is much larger than the sensible heat removed. Thus, by adjusting the tube surface area
exposed to vapor, condenser duty can be varied, e.g., condenser outlet flow adjustments change
the tube surface area exposed to vapor, and thus the condenser’s heat duty.
For a water-cooled condenser with complete condensation, as shown in Figures 12.4 through
12.7, the overhead pressure CV is paired with the cooling water flow, setting the condenser duty.
The equivalent scenario for a drumless, flooded condenser, is to pair the overhead pressure CV with
either the reflux flow or distillate flow since adjustments to either flow sets the condenser outlet
flow, and thus the tube surface area exposed. Thus, as discussed above, adjusting either flow will
change the condenser heat duty, impact vapor volume, and thus the pressure.
The tower’s design basis will almost always specify the overhead pressure controller’s MV – either
the reflux flow or the distillate flow. The MV not paired with tower pressure, plus the reboiler duty,
are the available degrees of freedom to control a product quality and/or manage tower fractionation.
In Figure 12.10, tower pressure is controlled by manipulating the distillate rate, with the reflux
flow an available degree of freedom to set the tower’s fractionation or control a product quality. In
Figure 12.11, tower pressure is controlled by manipulating the reflux flow. The distillate rate is an
CW
(Flooded
condenser)
FC
FC
PC
Quality or
fractionation
Figure 12.10 Drumless, Flooded
Condenser – Distillate Rate Paired with
Overhead Pressure
CW
(Flooded
condenser)
FI
FC
PC
Quality
Figure 12.11 Drumless, Flooded
Condenser – Reflux Rate Paired with Overhead
Pressure
10 The sensible heat transferred (to the cooling water) can affect the condensate hold-up temperature and cause
reflux subcooling. Flooded condenser duty upsets tend to have a larger effect on reflux subcooling than
conventional condensers, and thus duty upsets cause more serious tower disturbances. Thus, internal reflux control
is often included in product quality control strategies in towers with a flooded condenser.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.4 Towers with Sidestream – Process Variable Summary 427
available degree of freedom, and as discussed previously, will almost certainly be manipulated to
control a product quality, with reboiler duty adjusted to manage fractionation.
Other than pressure control, product quality control and fractionation management strategies are
implemented in a tower with a flooded condenser in exactly the same way as they are implemented
in a tower with a conventional condenser (with either complete or partial condensation). Note:
Tower pressure control as shown in Figures 12.10 and 12.11 is also applicable to towers with a
sidestream when its design includes a drumless, flooded condenser.
12.4 Towers with Sidestream – Process Variable Summary
Figure 12.12 presents a simplified P&I drawing that displays the important measurements and cal￾culated variables that describe the operating conditions for a distillation tower with a sidestream.
The outstanding feature of this tower’s configuration is of course the tower’s sidestream product,
which can have one or two impurity specifications that may need to be satisfied. Note that in
Figure 12.12, the sidestream draw-off is above the feed tray, indicating it is a liquid sidestream;
a vapor sidestream is withdrawn below the feed tray.
FI
1
FI
6
AI
5
TI
1
AI
3
IR2 AI
4
TI
4
FI
3
AI
2
TI
6
FI
5
TI
7
QR
TI
8
TI
5
FV5
FV3
FI
4
FI
2
AI
1
CW
PI
1
LI
1
Qc
TI
3
TI
2
IR1
FV4 FV2
FVCW
FV6
LI
2
Figure 12.12 Tower with Sidestream – Basic Operating Variables
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License428 12 Tower Product Quality Controls
The tower’s liquid sidestream flow (FI6) is also an additional MV that is available to control
either a product quality, the bottoms level, or (very infrequently) the reflux drum level. This pro￾vides additional flexibility when tower inventory control strategies are designed. But whenever the
sidestream draw-off flow is paired with a CV – any CV, the control strategy must ensure the internal
reflux above the sidestream draw-off tray is large enough to provide both the sidestream’s desired
volumetric flow, and the internal reflux needed to support fractionation below the sidestream
draw-off tray.
As was the case for the two-product tower configuration in Figure 12.2, the measurements
in Figure 12.12 may not all be in the design basis for a specific tower with a sidestream.
Like two-product towers, inventory control and product quality control strategy designs for
Figure 12.12’s tower configuration are not independent. In the two-product tower, there is only
one feed separation that influences the product qualities – between the LK (bottoms product
impurity) and HK (distillate product impurity). But with three products, there are two feed
separations that influence the qualities of the three tower products – between the LK routed to
the distillate product and an intermediate key (IK) routed to the sidestream product, and between
the IK and the HK routed to the bottoms product. As will be discussed in Section 12.4.3, IK is the
potential impurity in both the distillate (AI1) and bottoms (AI2) product, while both LK and HK
are the potential sidestream product impurities (AI4, AI5).
12.4.1 MVs, CVs, DVs, and Calculated Variables
The basic operating variables shown in Figure 12.12, from which the tower’s CVs, MVs, and DVs
are chosen, are almost identical to those shown in Figure 12.2 for the two-product tower. The CVs,
MVs, DVs, and calculated variables listed in Table 12.1 for the two-product tower are also applicable
to the tower with sidestream in Figure 12.12 with the revisions (AI1, AI2, IR1) and additions (FI6,
AI4, AI5 and IR2) listed in Table 12.3 below. Here are important observations related to the entries
in Table 12.3:
● If measured, the distillate product impurity (AI1) is now the IK concentration.
● If measured, the bottoms product impurity (AI2) is now the IK concentration.
● If measured, the sidestream product impurity is either the LK concentration (AI4), the HK con￾centration (AI5), or both concentrations.
● The internal reflux above the sidestream draw-off (IR1) is calculated in the same way as internal
reflux (IR) is calculated in a two-product tower. Thus, reflux flow (FI4) is required to calculate
IR1. If the reflux flow measurement is not in the design basis (highly unlikely), FV4 replaces FI4
Table 12.3 MVs, CVs, and Calculated Variable Additions for Towers with a Sidestream
Symbol Process Variable Type
FI6 Sidestream draw-off flow (or FV6) MV
AI1 Distillate product quality (IK concentration) CV
AI2 Bottoms product quality (IK concentration) CV
AI4 Sidestream front-end quality (LK concentration) CV
AI5 Sidestream back-end quality (HK concentration) CV
IR1 Calculated internal reflux above sidestream draw-off, or external reflux flow, FI4 MV
IR2 Calculated internal reflux below sidestream draw-off tray Calc Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.4 Towers with Sidestream – Process Variable Summary 429
as an MV, but internal reflux cannot be calculated. FI4 or IR1 can be an MV, but only one can be
fixed independently.
● If the internal reflux below the sidestream draw-off (IR2) is calculated, it is calculated as the
difference between the internal reflux above the sidestream draw-off (IR1) and the sidestream
draw-off flow (FI6), i.e., [IR1–FI6]. Thus, sidestream flow (FI6) is required to calculate IR2. If
the sidestream flow measurement is not in the design basis (highly unlikely), FV6 replaces FI6
as an MV, but internal reflux below the sidestream draw-off tray (IR2) cannot be calculated.
Based on the PVs identified as CVs in Tables 12.1 and 12.3, here are the control objectives for a
tower with a sidestream configured as shown in Figure 12.12:
Control Objective CV Symbol on Figure 12.12
Manage reflux drum hold-up LI1
Manage tower bottoms hold-up LI2
Control tower pressure PI1
Maintain distillate product quality at target11 AI1 (IK concentration)
Maintain bottoms product quality at target12 AI2 (IK concentration)
Maintain sidestream product front-end quality at target AI4 (LK concentration)
Maintain sidestream product back-end quality at target AI5 (HK concentration)
and from Tables 12.1 and 12.3, the MVs available to achieve these control objectives are:
Manipulated Variable MV Symbol on Figure 12.12
Distillate flow rate FI2 (or FV2)
Bottoms flow rate FI3 (or FV3)
Reflux flow rate or internal reflux FI4 (or FV4) or IR1
Sidestream draw-off FI6 (or FV6)
Condenser duty QC
Reboiler duty or hot fluid flow rate QR or FI5 (or FV5)
With seven control objectives and just six MVs, only six of the control objectives can be achieved.
Control of reflux drum, bottoms hold-up, and tower pressure are almost always in the design
basis. This leaves three available MVs, and thus only three tower qualities can be controlled.
However, rarely must three qualities be controlled; control of one or two qualities is much more
common.
These seven control objectives may not all be applicable to a specific tower configuration, and
towers may also have some alternative MVs. However, these CVs and MVs are representative of
almost all towers with configurations as shown in Figure 12.12.
11 Or tray temperature TI4 if it infers the distillate product’s quality and AI1 is not measured.
12 Or tray temperature TI5 if it infers the bottoms product’s quality and AI2 is not measured.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License430 12 Tower Product Quality Controls
12.4.2 CV–MV Pairings
Tower designs almost always specify the tower bottoms hold-up volume and, in most cases, the
reflux drum hold-up volume; designers specify the inventory control strategy based on reflux drum
and tower bottoms surge capacity, and reflux, distillate, and bottoms flow rangeabilities. MVs that
remain after designers choose how best to satisfy the inventory control objectives are available
to meet the other control objectives. In almost all cases, either reflux flow or distillate flow will
be paired with the reflux drum level, and it is assumed again that bottoms flow rate will always
be paired with the bottoms level. Also, remember, a tower’s inventory control strategies are by
necessity linked to how other tower control objectives are achieved.
The most common CV–MV pairings encountered in a tower with a sidestream are summarized
below in Table 12.4. Again, there are several potential MV choices for each CV, but as indicated in
Table 12.4 by the symbol X, it is possible to identify the preferred MV for each CV.
These CV–MV pairings apply unambiguously to the tower configuration shown in Figure 12.12 –
with a water-cooled condenser, complete condensation (no vapor product), and a reflux drum
to accumulate condensate. Some examples that follow will be towers with different overhead
configurations – with air-cooled condensers, flooded condensers with no reflux drum, and partial
condensers that produce an additional overhead (vapor) product. All pairings shown in Table 12.4
are not applicable in these cases – as already discussed in Sections 12.3.3 and 12.3.4, the major
differences arise in how the overhead liquid hold-up is managed and how tower pressure is
controlled.
Issues associated with two-product tower CV–MV pairings are also applicable to a tower with a
sidestream:
● To meet product quality requirements, tower control strategies adjust the tower material balance
(via the distillate, bottoms, and sidestream flows) and the tower energy balance (via the reboiler
duty and reflux flow rate).
● Tower material balance adjustments are closely associated with setting the cutpoint between
distillate and sidestream products, and the cutpoint between sidestream and bottoms products.
Tower energy balance adjustments are closely associated with setting the tower’s fractionation.
As before, individual control adjustments, in combination, change both the tower’s material bal￾ance and its energy balance simultaneously.
Table 12.4 Towers with a Sidestream – Common CV–MV Pairings
Manipulated Variables
Control Variables Reflux Distillate Sidestream QC QR Bottoms
Reflux drum level x X x
Bottoms level x x X
Pressure X x
Distillate quality X x x
Sidestream quality x x X x x
Bottoms quality x X
X = Most frequently chosen as MV.
x = Sometimes chosen as MV.
x = Rarely chosen as MV.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.4 Towers with Sidestream – Process Variable Summary 431
● No matter the CV–MV pairings chosen, independent MV adjustments made to control each
product’s quality will to some extent dynamically interact and make effective control of quality
difficult. This is especially true for towers with a sidestream. Although some CV–MV choices can
reduce these interactions, incorporating the tower’s control objectives into a wider-scope DMC
controller will normally improve control performance.
● It is very rare that three qualities must be controlled in a tower with a sidestream – in most
cases, control of only two or one quality is necessary; this reduces but does not eliminate MV–CV
dynamic interactions. As will be discussed in Section 12.6.3, the additional MV made available is
used to manage tower fractionation – adjusting the energy balance to provide the heat input/heat
removal required to provide the tray-to-tray vapor and liquid flows that achieve a desired tower
separation.
12.4.3 Key Components and Separation
In towers with a sidestream, feed components are separated into a lighter and lower boiling distil￾late product, a heavier and higher boiling bottoms product and an intermediary boiling sidestream
product. For towers with a sidestream, the designers’ objectives are:
● Minimize the LK, and HK in the sidestream product. This should keep LLK and HHK out of the
sidestream product.
● Minimize, in both the distillate and bottoms products, the sidestream’s intermediary key (IK),
with boiling point between the LK and HK.
The overall operating objectives are to separate LK and LLK components in the distillate product,
HK and HHK components in the bottoms product, and IK in the sidestream product. However, as
illustrated schematically in Figure 12.13, due to imperfect separations between LK and IK, and IK
and HK, some IK will be in both bottoms and distillate products, while some LK and some HK will
be in the sidestream product. Therefore, as indicated in red font in Figure 12.13, the distillate and
bottoms product IK concentrations are measures of distillate and bottoms product impurity, while
the sidestream’s LK and HK concentrations are measures of side stream product impurity.
LLK
LK
IK
LK
IK
LLK HK
LK
IK
HK
HHK
Distillate
product
IK
HK
HHK Bottoms
product
Feed
Side stream
product
LLK = Lighter than light key
LK = Light key
IK = Intermediary key
HK = Heavy key
HHK = Heavier than heavy key
Figure 12.13 Tower with Sidestream – Separation and Key Component Summary
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License432 12 Tower Product Quality Controls
12.5 Towers with Sidestream – Common Product Quality Control
CV–MV Pairs
The structure and CV–MV pairings of all tower product quality control strategies (including towers
with a sidestream) depend upon the inventory controls specified by tower designers. Overviews of
the product quality control strategies that result for the most common CV–MV pairings in the last
three rows of Table 12.4 are presented in Figures 12.14 and 12.15 for towers with a sidestream. In
Figure 12.14, the distillate flow is manipulated to control the reflux drum level, eliminating it as a
degree of freedom to control product quality or manage fractionation. In Figure 12.15, the reflux
flow is the reflux drum level controller’s MV, eliminating it as an MV to control product quality or
manage fractionation. As described in Section 9.3.2, there are other level CV – flow MV pairings
employed at times, but the level CV – flow MV pairings in Figures 12.14 and 12.15 are the most
frequently implemented. Also, in both figures, bottoms level is paired with bottoms flow. Table 12.4
indicates this is the most frequently chosen pairing, and it is very unusual to encounter a different
bottoms level – MV pairing.
Btms quality
or fractionation
FC AI
PC
LC FC CW
Qc
Ovhd quality
or fractionation
AI
LC
FI AI
Q FC R
FI
FC
SS quality or
fractionation
Figure 12.14 Tower with Sidestream, Distillate Flow Paired with Reflux Drum Level – Product Quality
Control and Fractionation Management MVs
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.5 Towers with Sidestream – Common Product Quality Control CV–MV Pairs 433
In Figure 12.14, with distillate flow, bottoms flow and condenser duty paired with the two level
controller CVs and the pressure controller CV, respectively, the MVs available for product quality
control or fractionation management are the reflux flow, the sidestream flow and the reboiler duty.
If three product qualities must be controlled (not likely), then each remaining MV must be paired
with a product quality CV. From the last three rows in Table 12.4, in most cases the reflux flow will
be paired with the overhead quality, the sidestream draw-off with the sidestream quality, and the
reboiler duty with the bottoms quality.
In Figure 12.15, with reflux flow, bottoms flow and condenser duty paired with the two level
controller CVs and the pressure controller CV, respectively, the MVs available for product quality
control or fractionation management are the distillate flow, the sidestream draw-off flow and the
reboiler duty. Again, if three qualities must be controlled (not likely), then each remaining MV
must be paired with a product quality CV. From the last three rows in Table 12.4, in most cases
the distillate flow will be paired with the overhead quality, the sidestream flow with the sidestream
quality, and the reboiler duty with the bottoms quality. But, remember, control of one or two product
qualities is much more common than control of three qualities.
The internal reflux above the sidestream draw-off tray (IR1 in Figure 12.12), the internal reflux
below the sidestream draw-off tray (IR2 in Figure 12.12), and the sidestream draw-off flow (FI6 in
FI
FI
AI
PC
CW
Qc
LC FC
Ovhd
quality
LC
AI FC
SS quality or
fractionation
FI AI
Q FC R
Btms quality
or fractionation
Figure 12.15 Tower with Sidestream, Reflux Flow Paired with Reflux Drum Level – Product Quality Control
and Fractionation Management MVs
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License434 12 Tower Product Quality Controls
Figure 12.12) are related algebraically via material balance:
IR2 PV = IR1 PV − SS PV (12.1)
where FI6 has been renamed SS PV in Equation (12.1). In Equation (12.1), IR1 PV and SS PV
are independent variables. Thus, for any internal reflux flow above the draw-off tray (IR1 PV),
the sidestream draw-off flow’s magnitude (SS PV) determines the internal reflux flow below the
draw-off tray (IR2 PV). Likewise, for any sidestream draw-off flow, the magnitude of the internal
reflux flow above the draw-off tray determines the internal reflux flow below the draw-off tray. IR1
PV, a function of the external reflux flow, is frequently calculated and is often controlled. SS PV is
always measured, and almost always on flow control. IR2 PV is not measured and is not normally
calculated or controlled. It is a dependent variable, whose value is determined by the internal reflux
(IR1 PV) and the sidestream draw-off flows (SS PV). This is true no matter how many product
qualities are controlled – it is due to the sidestream’s presence and material balance closure.
Dividing both sides of Equation (12.1) by the internal reflux above the draw-off tray, IR1 PV,
yields:
IR2 PV
IR1 PV = 1 − SS PV
IR1 PV (12.2)
From Equation (12.2), maintaining the ratio [SS PV/IR1 PV] constant as IR1 PV varies also main￾tains the ratio of internal reflux flow below (IR2 PV) and above (IR1 PV) the draw-off tray constant.
Similarly, dividing both sides of Equation (12.1) by the sidestream draw-off flow, SS PV, yields:
IR2 PV
SS PV = IR1 PV
SS PV − 1 (12.3)
From Equation (12.3), maintaining the ratio [IR1 PV/SS PV] constant as SS PV varies also main￾tains the ratio of internal reflux flow below the draw-off tray (IR1 PV) to the sidestream draw-off
flow (SS PV) constant. Guideline [SS PV/IR1 PV] or [IR1 PV/SS PV] ratio values are normally
specified offline to establish target IR2 PV, IR1 PV, and SS PV flows that provide satisfactory
fractionation above and below the draw-off tray. This is normally a conservative estimate of
the internal reflux flow required to maintain effective fractionation. Depending upon the tower
configuration and CV–MV pairings, either the external reflux flow (e.g., the internal reflux flow
above the draw-off tray) or the sidestream draw-off flow or reboiler duty can be varied to meet
either offline-specified, guideline ratio.
When only two product qualities are controlled – a much more common circumstance, only two
of the three available MVs – reflux flow, sidestream draw-off and the reboiler duty in Figure 12.14
or distillate flow, sidestream draw-off and reboiler duty in Figure 12.15 must be paired with the
two product quality CVs. Thus, one MV from among the three remaining in each group of three is
available to help manage internal reflux flow and thus fractionation.
In a two-product tower, control of both product qualities fixes the tower’s fractionation (at mini￾mum reboiler duty). However, for a tower with a sidestream, the tower’s internal reflux flows and
thus its fractionation are determined by the relationship in Equation (12.1), no matter how many
product qualities are controlled. Although unusual, if three product qualities are controlled, and all
three remaining MVs must be paired with a product quality CV, there is no MV available to ensure
there is sufficient internal reflux above and/or below the draw-off tray. Therefore, if three product
qualities are controlled, and if operating experience indicates poor fractionation, a product quality
control override may be needed to ensure there is sufficient internal reflux above and/or below
the sidestream draw-off tray to maintain proper fractionation. Depending upon the CV–MV pair￾ings and tower configuration, a product quality controller paired with either the reflux flow, the
sidestream draw-off flow, or the reboiler duty must include override logic for low internal reflux Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.6 Cutpoint, Fractionation, and Their Impact on Tower Operations 435
flow. As long as the guideline ratios in Equations (12.2) and (12.3) are satisfied, quality control
is unaffected and continues. However, if the internal reflux flow or a sidestream draw-off flow
demanded by a product quality controller fails to satisfy the guideline ratios in Equations (12.2)
and (12.3), and product quality control is adversely affected, a quality control loop may need to be
overridden to restore sufficient fractionation.
Important: When less than three product qualities are controlled, one MV is available to help man￾age internal reflux flow and fractionation. A product quality override is not necessary for this case.
12.6 Cutpoint, Fractionation, and Their Impact
on Tower Operations
A distillation tower’s feed stream consists of multiple components with a continuous range of boil￾ing points. Distillation separates feed components into a lighter, lower boiling distillate product and
a heavier, higher boiling bottoms product; if there is a sidestream product, some components are
separated into that intermediary boiling product. Control of product quality is at the core of almost
all tower control strategies. Cutpoint and fractionation are terms used to describe how the MVs in
Tables 12.2 and 12.4 affect tower operations as they are adjusted to maintain product qualities at
their desired values. However, the adjustments to the MVs listed in Tables 12.2 and 12.4 are made
to not only control product qualities but also control the other relevant CVs in Tables 12.2 and 12.4.
12.6.1 Tower Cutpoint
There are two ways to interpret cutpoint – one based on the tower’s overall material balance and the
other based on the feed component boiling points. In a two-product tower, the overall, volumetric
material balance is simply:
F = D + B (12.4a)
1 = D
F
+
B
F (12.4b)
where F, D, and B are the tower’s volumetric feed, distillate product, and bottoms product flows,
respectively. One interpretation of cutpoint is based on the tower’s overall material balance in
Equation (12.4b) – it is either the liquid volume percent of the feed that is recovered as distillate
product, (D/F) * 100%, or as bottoms product, (B/F) * 100%. The other interpretation of cutpoint
is to consider it a boiling point criteria (= TCUT) for how the feed components are separated – feed
components that boil above temperature TCUT are separated as the bottoms product, and feed com￾ponents that boil at or below temperature TCUT are separated as the distillate product.
Insight into the meaning of cutpoint can be gained by examining a tower feed’s true boiling point
(TBP) distillation curve (Refs. [3, 4]). A TBP curve is obtained by heating a liquid volume sample in
a laboratory batch distillation unit, with complete condensation of overhead vapor. As the liquid
feed is heated adiabatically, portions of the initial liquid volume vaporize (the volume % off), flow
overhead, are condensed, and are collected; the volume % off is then plotted against the overhead
vapor temperature. The overhead vapor temperature infers the boiling point of the feed components
that vaporize at that temperature; it increases continuously as heat is added and heavier, higher
boiling components vaporize, flow overhead, condense, and are collected.
A typical TBP distillation curve, a plot of volume % off versus the overhead vapor temperature,
for a tower feed is shown in Figure 12.16. The temperature at which the first drop of feed vaporizes Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License436 12 Tower Product Quality Controls
Volume% off
0% 100%
(D/F)1
(D/F)2
Cutpoint T1
Cutpoint T2
Temperature
(B/F)1
(B/F)2
FBP
Final boiling point
IBP
Initial boiling point
Feed TBP
(True boiling point)
Distillation curve
T2
T1
Figure 12.16 Cutpoint, Feed TBP Distillation Curve – Relationship to Tower Operations
is the initial boiling point (IBP) and the temperature at which the last drop of feed vaporizes is
the final boiling point (FBP). Starting at the IBP, as more heat is added, more feed vaporizes, and
the temperature of the overhead vapor increases as components with progressively higher boiling
points are vaporized. The volume % off continues to increase as the vapor temperature increases
until the vapor temperature reaches the FBP.
The TBP distillation curve in Figure 12.16 can be related to tower operations. As explained above,
the tower’s cutpoint can signify either the volume % off, (D/F)1 or (B/F)1, or the temperature T1.
However, the two-product tower’s operating and control objectives are closely associated with the
separation of feed components into distillate and bottoms products – feed components boiling at or
below T1 are separated into a distillate product, and/or feed components boiling above T1 are sep￾arated into a bottoms product. Thus, the cutpoint temperature (e.g., T1) has physical meaning – it
defines how feed components are separated by boiling point into distillate and bottoms products.
Unless the tower feed’s TBP curve is handy, the volume % off, (D/F)1 or (B/F)1, does not provide
any information on the separation’s boiling point basis. Consequently, cutpoint temperature is typ￾ically considered the more meaningful indication of cutpoint and consequently preferred by both
control engineers and operators.
Note that the cutpoint indicator used has no impact on the tower’s control strategy designs
(or their control performance). In addition, neither cutpoint temperature, D/F, or B/F indicates
how effectively feed components are separated via their boiling points – how much of the feed
components that boil below the cutpoint temperature are separated with the bottoms product
and/or how much of the feed components that boil above the cutpoint temperature are separated
with the distillate product. These misplaced feed components determine both product’s impurity.
The effect of a cutpoint temperature change on distillate and bottoms product volumetric flows
is also indicated on Figure 12.16. When the cutpoint temperature is increased from T1 to T2, more
feed is separated as distillate product, and the volume % off increases from (D/F)1 to (D/F)2. Thus,
at constant feed rate, the distillate product’s volumetric flow rate increases. Likewise, less feed is
separated as bottoms product, the bottoms volume % off decreases from (B/F)1 to (B/F)2, and at
constant feed rate, the bottoms product’s volumetric flow rate decreases.
The cutpoint change in Figure 12.16 also affects both product purities. To explain the effect of
a cutpoint change on product purity, refer to Figure 12.17 which presents typical TBP distillation
curves for a tower’s distillate and bottoms products, collected at two different cutpoint tempera￾tures, T1 and T2. Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.6 Cutpoint, Fractionation, and Their Impact on Tower Operations 437
Volume % off
0% 100%
Cutpoint T1
Cutpoint T2
Bottoms “front-end” now
distillate “back-end”
Temperature
FBP
IBP
FBP
IBP
FBP
IBP
FBP
IBP
Bottoms product
TBP curves @ T1 and T2
Distillate product
TBP curves @ T1 and T2
Figure 12.17 Cutpoint Change – Effect on Distillate and Bottoms Product Separation
To generate the TBP curves for distillate and bottoms products, such as those in Figure 12.17,
a sample volume of each product at each cutpoint temperature is collected, analyzed using the
standard laboratory batch distillation equipment/procedure, and the volume % off is plotted against
the overhead vapor temperature.
Note that in the discussion that follows,
● Both feed rate and feed composition are assumed constant.
● The two-product tower’s LK and HK components have been identified.
● As illustrated in Figure 12.3, the tower’s separation is between the LK and HK.
● Almost all LK, all LLK but some HK is in the distillate product.
● Almost all HK, all HHK but some LK is in the bottoms product.
When the cutpoint temperature is increased from T1 to T2, the lightest and lowest boiling feed
components in the bottoms product – the bottoms product’s front-end components, are instead
removed with the distillate product, becoming the distillate product’s back-end components – its
heaviest and highest boiling components. As indicated in Figure 12.17, this increases both the bot￾toms product’s IBP and the distillate product’s FBP but has almost no effect on either the bottoms
product’s FBP or the distillate product’s IBP. Since the bottoms product front-end (the lightest part
of the bottoms) contains some HK, the distillate product purity decreases. And although the bottoms
front-end contains some HK, it also contains some LK, and thus the bottoms product purity increases
when it loses its front-end. Therefore, when the cutpoint temperature increases, (i) the distillate
product’s volumetric flow increases, and its purity decreases (impurity concentration increases)
while (ii) the bottoms product’s volumetric flow decreases and its purity increases (impurity con￾centration decreases). This is generally true for all cutpoint changes – the product whose volumetric
flow increases becomes less pure, and the product whose volumetric flow decreases becomes purer.
Note that in Figure 12.17, at the higher cutpoint temperature, both bottoms and distillate product
TBP curves are above their TBP curve that corresponds to the lower cutpoint temperature. This is
an indication that after the cutpoint temperature change, the distillate product contains more high
boiling components, and the bottoms product contains less low boiling components. Consequently,
tray temperatures, and HK concentrations, increase throughout the tower.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License438 12 Tower Product Quality Controls
Volume% off
0% 100%
(D/F)
Temperature
(B/F)
FBP
IBP
Feed TBP
Distillation curve
(SS/F)
TD-SS
TSS-B
Figure 12.18 Feed TBP Distillation Curve – Tower with Sidestream
The same cutpoint principles apply to a tower with a single sidestream, although the side steam
adds some additional complexity. In a two-product tower, there is one cutpoint temperature that
identifies the distillate and bottoms product boiling point split. A tower with a sidestream has two
cutpoint temperatures – one that identifies the distillate/sidestream product boiling point split, and
the other that identifies the sidestream/bottoms product boiling point split.
To illustrate, a typical feed TBP distillation curve for a tower with sidestream is shown in
Figure 12.18. The three product’s volume % off – D/F, SS/F, and B/F – are determined by the
two cutpoint temperatures, the distillate – sidestream cutpoint temperature, TD-SS, and the
sidestream – bottoms cutpoint temperature, TSS-B. Referring to Figure 12.16 in a two-product
tower, the cutpoint temperature or either the distillate or bottoms product’s volume % off at the
cutpoint temperature, D/F or B/F, can be considered the tower’s cutpoint. Likewise, referring to
Figure 12.18, for a tower with a sidestream, the cutpoint temperatures, TD-SS and TSS-B, or any
two of the three products’ volume % off (D/F, SS/F, or B/F) can be considered indications of the
tower’s two cutpoints.
But, as before, tower operating and control objectives are closely associated with separations of
feed components into distillate, sidestream, and bottoms products – feed components boiling at or
below TD-SS into a distillate product, feed components boiling above TD-SS but at or below TSS-B into
the sidestream product, and feed components boiling above TSS-B into a bottoms product. Thus,
the cutpoint temperatures again have physical meaning – they define how feed components are
separated by boiling point into distillate, sidestream, and bottoms products. Cutpoint temperatures
are again considered the more meaningful indications of cutpoint and consequently are preferred
by both control engineers and operators. However, as before, the cutpoint indicator used has no
impact on the design or the performance of a tower’s control strategies. Again, remember that
neither the cutpoint temperatures nor the three product volume % off values (D/F, SS/F, B/F)
indicate how efficiently the feed components are separated.
12.6.2 Feed Composition Changes and Cutpoint
In the discussions of Figure 12.16 and 12.17, tower feed composition was assumed constant.
Figure 12.19 illustrates the effect of a feed composition change, at constant feed rate, on a tower’s
cutpoint temperature and its volume % off:
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.6 Cutpoint, Fractionation, and Their Impact on Tower Operations 439
Volume% off 0% 100%
(D/F)1
Cutpoint temp = T1
if (D/F)1 → (D/F)NEW
Temperature
(B/F)1
(D/F)NEW (B/F)NEW
New, heavier
feed 
Cutpoint temp = TNEW
if (D/F)NEW = (D/F)1
T1
TNEW
Figure 12.19 Feed Composition Change – Cutpoint Temperature and Volume % Off
Initially, the cutpoint temperature is T1, and the distillate product’s volume % off is (D/F)1.
Assuming constant heat input and constant feed rate, a feed composition upset occurs that makes
the feed heavier, and as indicated in Figure 12.19, the heavier feed’s TBP curve lies above the lighter
feed’s TBP curve. If the distillate flow is held constant, (D/F)1 ≡constant, the apparent cutpoint
temperature increases to TNEW. This indicates that with the heavier feed, the same distillate volume
% off now contains heavier, higher boiling components – the feed components that boil between T1
and TNEW. If, on the other hand, the distillate flow is decreased from (D/F)1 to (D/F)NEW, then the
apparent cutpoint temperature remains T1, and only feed components in the heavier feed boiling
at or below T1 are removed with the distillate product; feed components in the heavier feed boiling
above T1 are removed with the bottoms product.
Maintaining a constant cutpoint temperature (T1) in principle ensures the same feed
separation – feed components boiling at or below T1 are still separated with the distillate
product, those boiling above T1 are still separated with the bottoms product. However, because the
feed has become heavier, a smaller fraction of the feed, (D/F)NEW, needs to be removed as distillate
product to achieve the same feed component boiling point based separation. In this example, it
appears there is a conflict between cutpoint temperature and volume % off as cutpoint indicators.
For the situation in Figure 12.19, a constant cutpoint temperature – T1, indicates that after the feed
composition upset, components boiling at or below the same temperature, T1, are still removed in
the distillate product while the change in distillate volume % off – (D/F)1 → (D/F)NEW, suggests
the cutpoint has changed. However, the volume % off is smaller because the feed is heavier, and a
smaller percentage of the feed components have boiling points below T1. Thus, the two cutpoint
indicators are not in conflict, and they actually provide a consistent explanation of the changes
that have occurred.
12.6.3 Tower Fractionation
If the volumetric fraction of feed boiling at or below a desired cutpoint temperature can be
determined, then a volume % off cutpoint estimate (D/F or B/F) is also established for the tower.
However, separating feed components into tower products is a complex process that involves not
only the material balance but also the tower’s energy balance and the vapor/liquid equilibrium
relationships established at each tray’s prevailing temperature and pressure. The actual separation Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License440 12 Tower Product Quality Controls
proceeds on successive trays throughout the tower; liquid and vapor phases of different com￾positions are contacted on each tray as the vapor flows upward and the liquid flows downward.
Near-equilibrium conditions are established at each tray’s prevailing temperature and pressure;
mass transfer between the two phases occurs, and the compositions of the vapor and liquid phases
leaving each tray are near equilibrium conditions.
The amount of liquid and vapor flowing from tray to tray and each tray’s temperature and
pressure are thus essential elements in the separation achieved. The energy input provided by
the reboiler generates the tower’s boil-up (vapor flow) and the energy removed by the condenser
generates the tower’s internal reflux (liquid flow). Both reboiler duty and condenser duty also
have impact on tower pressures and temperatures. Therefore, at a desired cutpoint, the tower’s
energy balance ultimately determines the separation achieved and thus each product’s impurity.
This suggests that the best way to meet product quality targets is to manipulate the reboiler duty
and/or the reflux flow.
However, this is not the only way to meet the product quality targets. As discussed in Section
12.3, for a two-product tower with tower bottoms level paired with bottoms flow, pressure paired
with condenser duty, and either reflux flow or distillate flow paired with reflux drum level, the
two remaining MVs – reboiler duty and reflux flow or distillate flow, can be paired with the two
quality CVs to meet the product quality targets. And even if reboiler duty and reflux flow are the
MVs of choice, no matter the product quality CV–MV pairings, all MV adjustments, taken in sum,
ultimately change the tower’s material and energy balances simultaneously as all control strategies
are driven to achieve their control objectives.
Fractionation cannot be measured or calculated – this is why the term fractionation management
is preferred to fractionation control. However, fractionation can be related qualitatively to terms
in the historical Fenske Equation, and the Separation Factor (Ref. [5]). Both provide insight into
fractionation and its relationship to tower material and energy balances and are precursors for
developing stage to stage separation models used for offline/academic simulation studies (Ref. [1]).
However, the Overlap parameter, which can be calculated from the TBP curves of the distillate and
bottoms products (such as those shown in Figure 12.17), is a relatively simple indicator of tower
fractionation and the separation achieved.
Overlap
Overlap is defined as the difference between the bottoms product’s 5% distillation point and the
distillate product’s 95% distillation point:13
Overlap ≡ Btms T5% − Dist T95% (12.5)
Btms T5% Temperature at which the bottoms product’s volume % off = 5%
Dist T95% Temperature at which the distillate product’s volume % off = 95%
A product’s 5% distillation point is a front-end property – it primarily depends upon the lowest
boiling, lightest components in the product. A product’s 95% distillation point is a back-end
property – it primarily depends upon the highest boiling, heaviest components in the product. As
the boiling points of the lightest components in the bottoms product decrease, its 5% distillation
point (T5%) decreases. Also, as the boiling points of the heaviest components in the distillate
product increase, its 95% distillation point (T95%) increases. At the cutpoint temperature, the
bottoms product’s front end and the distillate product’s back end compete for the key components.
13 The following discussion assumes the tower separation is between LK and HK, and the LK in bottoms product
and HK in distillate product are measures of impurity. Instead of T5% and T95%, overlap is sometimes calculated
using TIBP and TFBP.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.6 Cutpoint, Fractionation, and Their Impact on Tower Operations 441
Volume% off
0% 100%
Temperature
Cutpoint temp
Dist T95%
Btms T5%
5% 95%
Bottoms product
TBP curve
Distillate product
TBP curve
Overlap ≡ Btms T5% – Dist T95% > 0
Figure 12.20 Distillate and Bottoms Product TBP Distillation Curves – Perfect Fractionation
When the bottoms product’s lightest components are removed (at the cutpoint temperature), they
move to the distillate product. Consequently, with feed rate and feed composition constant, the
bottoms product becomes purer since its front end, including some LK, has been removed, but the
distillate product becomes purer as well since its back end now includes the additional LK from
the bottoms front end. Therefore, unlike a cutpoint change, when tower separation/fractionation
improves, both products become purer, i.e., impurity concentrations in both products are reduced.
Likewise, when tower separation/fractionation degrades, both products become less pure, i.e.,
impurity concentrations in both products increase.
The relationship between overlap and separation/fractionation is best explained by looking at the
TBP curves for bottoms and distillate products as illustrated in Figure 12.20. In Figure 12.20, all feed
components boiling above the cutpoint temperature are removed with the bottoms product, and all
feed components boiling at or below the cutpoint temperature are removed with the distillate prod￾uct. This is the best separation possible and represents perfect fractionation. In the ideal scenario
illustrated in Figure 12.20, the bottoms product’s 5% distillation point is greater than the distillate
product’s 95% distillation point, and the Overlap parameter in Equation (12.5) is greater than zero.
In contrast to Figure 12.20, as shown in Figure 12.21, some feed components boiling above the
cutpoint temperature are removed with the distillate product and some feed components boiling
below the cutpoint temperature are removed with the bottoms product. For this more realistic
example, the bottoms product’s 5% distillation point is less than the distillate product’s 95% distilla￾tion point, and the overlap parameter in Equation (12.5) is less than zero. Since perfect fractionation
is impossible, virtually all realistic separations will produce a negative overlap parameter. The less
negative the overlap parameter – the closer it is to zero, the better the separation, and as the overlap
parameter becomes more negative, separation degrades.
These same overlap/separation principles also apply to a tower with a single sidestream. As
illustrated in Figure 12.18, a tower with a sidestream has two cutpoint temperatures – one that
identifies the distillate/sidestream product boiling point split (TD-SS), the other identifies the
sidestream/bottoms product boiling point split (TSS-B). Therefore, there is an overlap parameter at
each cutpoint temperature:
OverlapSS→Dist ≡ Side stream T5% − Dist T95% (12.6)
OverlapBtms→SS ≡ Btms T5% − Side stream T95% (12.7) Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License442 12 Tower Product Quality Controls
Volume% off 0% 100%
Temperature
Cutpoint temp
Dist T95%
Btms T5%
5% 95%
Overlap ≡ Btms T5% – Dist T95% < 0
Bottoms product
TBP curve
Distillate product
TBP curve
Figure 12.21 Distillate and Bottoms Product TBP Distillation Curves – Imperfect Fractionation
Once again, because perfect fractionation is impossible, for virtually all realistic separations, the
overlap parameters in Equations (12.6) and (12.7) will both be less than zero. And, again, the less
negative the overlap parameter – the closer it is to zero, the better the separation, and as the overlap
parameter becomes more negative, separation degrades.
The two cutpoint temperatures, volume % off for the three products, applicable distillate,
sidestream and bottoms product 5% and 95% distillation points, and the two overlap parameters
for a tower with a single sidestream are displayed in Figure 12.22.
Overlap and the Separation Factor
The separation factor, a historically important parameter used to connect separation and fraction￾ation, can be related to the overlap parameter. The separation factor is a measure of the separation
achieved between two components in a distillation tower. For a multicomponent separation, at
constant feed rate and feed composition, the separation factor (SLK, HK) between the light and the
heavy keys is defined as (Ref. [1]):
SLK,HK =
YLK∕XLK
YHK∕XHK
=
( YLK
YHK )
∗
(XHK
XLK )
(12.8)
where
YLK Mole fraction (or composition) of LK in overhead vapor phase
(distillate product)
XLK Mole fraction (or composition) of LK in liquid phase (bottoms product)
YHK Mole fraction (or composition) of HK in overhead vapor phase
(distillate product)
XHK Mole fraction (or composition) of HK in liquid phase (bottoms
product)
When there is good separation, YLK ≫>YHK and XHK ≫>XLK and thus SLK,HK is a large number.
Thus, the larger the separation factor the better the separation (and fractionation) achieved.
The following discussion assumes both the feed rate and the feed composition are constant.
Referring to Equation (12.8), the separation factor increases when the LK in the distillate (YLK)
increases and/or the HK in the bottoms (XHK) increases. If the LK in the distillate increases (YLK ↑)
at constant feed rate and feed composition, there is less LK in the bottoms (XLK ↓). Therefore, the Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.7 Two-product Towers – Overview of Conventional Advanced Control Applications 443
Volume% off
0% 100%
Temperature
Side stream
TBP curve
Bottoms
TBP curve
Dist T95%
5%
(D/F)
SS T5%
TD-SS
TSS-B
SS T95%
Btms T5%
95%
Distillate
TBP curve
(SS/F) (B/F)
5%
95%
= OverlapSS→Dist
= OverlapBtms→SS
FBP
IBP
Figure 12.22 Cutpoint and Overlap Parameters – Tower with Sidestream
bottoms product’s 5% distillation point (Btms T5%) increases. If the HK in the bottoms increases
(XHK ↑) at constant feed rate and feed composition, there is less HK in the distillate (YHK ↓).
Therefore, the distillate product’s 95% distillation point (Dist T95%) decreases. With higher Btms T5%
and lower Dist T95%, the overlap parameter defined in Equation (12.5) increases – it becomes less
negative, indicating the LK–HK separation has improved. Therefore, the separation factor and over￾lap parameter increases are consistent and indicate improved separation and better fractionation.
The same analysis applies to a tower with a side steam – there are two separation factors (SLK,IK)
and (SIK,HK) and two overlap parameters (OverlapSS→Dist and OverlapBtms→SS) and at each cutpoint
temperature, the separation factor and the overlap parameter move in tandem.
12.7 Two-product Towers – Overview of Conventional Advanced
Control Applications
In Section 12.3, an overview discussion of tower product quality controls, using the most common
CV–MV pairings in the last two rows of Table 12.2, was presented. However, only the CV–MV
pairing – the ultimate primary (CV) and the ultimate secondary (MV) – was included in these
discussions. In this section, the common advanced control components that connect the ulti￾mate primary to the ultimate secondary and complete the product quality advanced control
strategy’s cascade structure are presented. Control strategies for the major CV–MV pairings are
covered – bottoms quality control via reboiler duty and reflux flow, and distillate product quality
control via reflux flow and distillate flow. Since the focus is on control of one product’s quality, the
methods used to manage fractionation for each quality control strategy are included. Advanced
control strategies for the less common pairings – bottoms quality paired with distillate rate and
overhead quality paired with reboiler duty, are described qualitatively.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License444 12 Tower Product Quality Controls
TI
TI
FC
LC
FC
FC
TI
TIV
TIV
TIV
FCG
Dynamic
compensation
AI
Btms
quality
measurement
FC
AC AIV
TC
RC
QC
SP
SP
SP
SP
SP
Desired
Btms quality
target
Tray
temperature
control
Reboiler duty/
Feed control
Reboiler duty
control
Validation
Reboiler
hot fluid
flow
Fractionation
Feed flow
PC
CW
LC
FI
TC
Validation
Validation
Figure 12.23 Bottoms Product Quality Advanced Control Strategy, MV = Reboiler Duty
12.7.1 Conventional Advanced Product Quality Control with MV = Reboiler Duty
The most common conventional advanced control strategy implemented to control the bottoms
product’s quality, by manipulating the reboiler duty, is shown in Figure 12.23. With distillate rate
paired with the reflux drum’s level, reflux flow is the available degree of freedom to manage frac￾tionation and either help (i) minimize reboiler duty while meeting the bottoms’ quality target or
(ii) maximize reboiler duty to maximize the bottoms product’s yield.
The control strategy in Figure 12.23 is a simple cascade, and cascade initialization and wind-up
are both handled by standard DCS features. However, as the design issues presented below indicate,
there are still a number of initialization and wind-up related circumstances that must be managed
by user-supplied custom code and configuration.
The following advanced control components are included in the control strategy in Figure 12.23.
They are included in most control strategies that pair bottoms quality with reboiler duty. As indi￾cated, most have already been discussed in earlier sections of the book:
● Reboiler duty control – see Section 3.7.1.
● Reboiler heating medium inlet and outlet temperature measurement validity checks (see
Figure 8.5 in Section 8.8) – if one or both are externally multiplexed inputs.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.7 Two-product Towers – Overview of Conventional Advanced Control Applications 445
● Feed rate feedforward control with dynamic compensation, and control of the duty/feed ratio
(see Sections 3.2, 3.3, and 3.4).
● Inclusion of a stripping section tray temperature controller if the tray temperature is sensitive to
bottoms impurity (LK).
● Stripping section tray temperature measurement validity checks (see Section 8.8) – if it is an
externally multiplexed input.
● Bottoms quality validity checks (see Figure 8.4 in Section 8.8).
There are several important control strategy design issues that must be managed by these compo￾nents – these design issues are listed/summarized below. More complete explanations are included
in the above-referenced sections.
● Input validity checks to include in the temperature and quality measurement validation logic.
● Actions to take when (i) an input validity check fails and (ii) an invalid input returns valid.
● Ensure the feedback control loop remains operational when (i) feed rate feedforward control is
decommissioned, (ii) the feed rate measurement, the ratio controller’s wild flow input, becomes
unavailable, or (iii) a reboiler inlet or outlet temperature measurement is declared invalid.
● Ensure the full feedback/feedforward cascade returns on control bumplessly when (i) feed rate
feedforward control is commissioned, (ii) the feed rate measurement becomes available again,
and (iii) a reboiler inlet or outlet temperature measurement returns valid.
● Choose how the duty controller calculates the heating medium flow rate’s set point – either
(i) a PID calculation or (ii) algebraically, using the reboiler duty expression in Equation (3.14)
in Section 3.7.1. If the heating medium flow is not controlled, then the duty controller outputs
directly to a valve and therefore it must be configured as a PID controller.
● Use of SP or PV as the feed rate feedforward input (dynamic compensation tag’s PV input).
● Is model-based quality control needed – this depends upon the tower’s configuration, the quality
analyzer’s location, and its sampling system’s sample time.
● To avoid process upsets, constraint violations, and/or unsafe operations, appropriate SP and/or
OP clamps must be specified.
12.7.2 Fractionation Management with MV = Reflux Flow
In Figure 12.23, the reflux flow is the remaining, available degree of freedom and can be manipu￾lated to manage tower fractionation. Figure 12.24 illustrates how reflux flow, in conjunction with
the calculation and control of internal reflux, is used to manage tower fractionation. The control
strategy in Figure 12.24 is a simple cascade, and cascade initialization and wind-up are both man￾aged by standard DCS features. However, as the design issues listed below indicate, there are a
number of initialization and wind-up related situations that must be managed by user-supplied
custom code and configuration.
The advanced control components included in Figure 12.24 are listed below – they are included in
most strategies that manipulate reflux flow to manage fractionation (or to control product quality):
● Internal reflux control – see Section 3.7.2.
● Feed rate feedforward control with or without dynamic compensation, and control of either the
internal reflux/feed or reflux/feed ratio (see Sections 3.2, 3.3, and 3.4).
● If it is an externally multiplexed measurement, reflux temperature validity checks (see
Section 8.8).
The internal reflux controller calculates the reflux flow’s set point via an arithmetic control algo￾rithm using Equation (3.18) in Section 3.7.2 – repeated below in Equation (12.9):
ER = IR∕[1 + Scale ∗ (CP∕𝜆)∗(TITyp − TIR)] (12.9) Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License446 12 Tower Product Quality Controls
LC
FC
FC
FI
SP
Feed
flow Reflux
flow
TIV
TI Validation
TI
FC
SP
Internal reflux
calc/control
Typical value
Ovhd temperature
TITYP
FCG
Dynamic
compensation
optional
RC
SP
IR/feed
control
Desired
IR/feed
PC
CW
Reflux
temperature
Figure 12.24 Managing Tower Fractionation, MV = Reflux Flow
If the reflux flow is not controlled (highly unlikely), then the internal reflux controller outputs
directly to a valve and therefore it must be configured as a PID controller.
The following control strategy design issues must be managed by the components in Figure 12.24:
● Input validity checks to include in the reflux temperature’s validation logic.
● Actions to take when (i) an input validity check fails and (ii) an invalid input returns valid.
● Ensure the feedback control loop remains operational when the reflux temperature is invalid, or
the feed rate measurement (ratio controller’s wild flow input) becomes unavailable.
● Ensure the full feedback/feedforward cascade is recommissioned bumplessly when the reflux
temperature measurement returns valid, or the feed rate measurement returns available.
● Use of SP or PV as the feed rate feedforward input (dynamic compensation tag’s PV input).
● Specifying the typical value of overhead temperature (TITYP), and actions to take if/when the
typical value of overhead temperature is changed. Note: Before entering a new typical value, the
reflux flow controller should be transferred into Auto to force the internal reflux controller to
initialize. Transferring the reflux flow controller back to Cascade will then bumplessly recom￾mission internal reflux control.
Internal reflux control is less important in a fractionation management application than it is in
a product quality strategy. However, for either product quality control or fractionation manage￾ment, internal reflux control is more important when condenser duty upsets are common, and/or
the condenser is either air-cooled or flooded. In Figure 12.24, the condenser is water-cooled, and
therefore, for this tower configuration, it should be acceptable to exclude internal reflux control. Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.7 Two-product Towers – Overview of Conventional Advanced Control Applications 447
If internal reflux is excluded, the external reflux/feed ratio is controlled, and the cascade is then:
external reflux/feed → reflux flow.
Note that in Figure 12.24, dynamic compensation (FCG tag) of the ratio controller’s wild flow
input (feed rate) is marked optional. For fractionation management, in contrast to product quality
control, it is normally acceptable to use the uncompensated feed rate as the ratio controller’s wild
flow input. To use the uncompensated feed rate as RC’s wild flow input, the dynamic compensation
tag (FCG) in Figure 12.24 is simply omitted and the feed flow’s PV or SP is configured as the RC
wild flow input.
The internal reflux/feed or external reflux/feed ratio controller’s set point is an offline calculated
guideline value that is periodically updated to reflect current economics. It is manually entered by
operators when a new value becomes available. It establishes the tower’s fractionation based on
past operating experiences but does not reflect real-time process conditions and may not reflect
current economic drivers. If real-time process conditions and economics change on a regular basis,
an energy-yield trade-off may be justified. However, as discussed previously, the only realistic way
to implement this trade-off is to incorporate it into an existing, large scope RTO application.
12.7.3 Conventional Advanced Product Quality Control with MV = Reflux Flow
The reflux flow is most often paired with the distillate product quality, although it is occasionally
paired with the bottoms product quality – typically, when the reboiler duty is not an available degree
of freedom for bottoms product quality control.
Bottoms Product Quality Control with MV = Reflux Flow
This control strategy, with the bottoms quality paired with the reflux flow, is shown in Figure 12.25.
With reflux rate paired with the bottoms product quality and distillate rate paired with the reflux
drum’s level, reboiler duty is the available degree of freedom to manage fractionation.
The control strategy in Figure 12.25 includes several advanced control components incorporated
in the quality control (in Figure 12.23) and fractionation management (in Figure 12.24) strategies
discussed in Sections 12.7.1 and 12.7.2 respectively:
● Internal reflux control.
● Reflux temperature measurement validity checks (if it is an externally multiplexed input).
● Feed rate feedforward control with dynamic compensation, and control of the internal
reflux/feed ratio.
● Inclusion of a stripping section tray temperature controller if the tray temperature is sensitive to
the bottoms impurity (LK).
● Tray temperature measurement validity checks (if it is an externally multiplexed input).
● Bottoms quality measurement validity checks.
Remember, control of internal reflux is more important in a product quality control application
(Figure 12.25) than it is in a fractionation management application (Figure 12.24). Internal reflux
control is typically included in any product quality control strategy that manipulates external reflux
flow. Also, in a product quality control application, an internal reflux/feed controller’s wild flow
input (feed rate) is almost always dynamically compensated as in Figure 12.25.
The important control strategy design issues that must be managed by the components in
Figure 12.25 are in large part those summarized in Section 12.7.1 for bottoms product quality
control (in Figure 12.23) and in Section 12.7.2 for fractionation management (in Figure 12.24):
● Input validity checks to include in the temperature and quality measurement validation logic.
● Actions to take when (i) an input validity check fails and (ii) an invalid input returns valid.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License448 12 Tower Product Quality Controls
FC
TI
Feed flow
LC
Fractionation
AI
Btms quality
control
FI
Internal reflux/
feed control
Internal reflux flow
calculation and
control
Validation FC
FCG
TIV
SP
FC
SP
RC
SP
Reflux
flow
Typical value
Ovhd temperature
TITYP
TI
Dynamic
compensation
AIV
TIV
AC
TC
SP
SP
Desired Btms
quality target
Tray temperature
control
FI
LC
TI
Validation
PC
CW
TC
FC
Figure 12.25 Bottoms Product Quality Advanced Control Strategy, MV = Reflux Flow
● Ensure the feedback control loop remains operational when (i) feed rate feedforward control is
decommissioned, (ii) the feed rate measurement becomes unavailable, or (iii) the reflux temper￾ature is declared invalid.
● Ensure the full feedback/feedforward cascade returns on control bumplessly when (i) feed rate
feedforward control is commissioned, (ii) the feed rate measurement returns available, or (iii) the
reflux temperature returns valid.
● Use of SP or PV as the feed rate feedforward input (dynamic compensation tag’s PV input).
● Model-based or PID quality control.
● Specifying the typical value of overhead temperature, and actions to take if/when the typical
value is changed.
Remember: The internal reflux controller almost always calculates the reflux flow rate set point
using an arithmetic control algorithm – via Equation (12.9). However: (i) if reflux flow is not con￾trolled (highly unlikely), then the internal reflux controller outputs directly to a valve and therefore
it must be configured as a PID controller and (ii) if reflux flow is not measured (highly unlikely),
internal reflux cannot be calculated or controlled, and the tray temperature controller outputs
directly to the reflux valve.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.7 Two-product Towers – Overview of Conventional Advanced Control Applications 449
FC
LC FC
TI
FC
Fractionation
Feed flow
TI
Ovhd
quality
LC
FI
FCG
Dynamic
compensation
TIV
TIV
Pressure compensated
tray temperature
control
Internal reflux flow
calculation and
control
AI
Ovhd quality
control
Validation
Desired Ovhd
quality target
AC AIV
SP
FC
TC
RC
FC
SP
SP
SP
SP
Internal reflux/
fed control
Reflux
flow
Typical value
Ovhd temperature
TITYP
TI
Validation
Validation
Tray temp
PC
Pressure
∞
Figure 12.26 Overhead Product Quality Advanced Control Strategy, MV = Reflux Flow
Distillate Product Quality Control with MV = Reflux Flow
The most common conventional advanced control strategy implemented to control the distillate
product’s quality is to pair it with the reflux flow as shown in Figure 12.26. With distillate rate paired
with the reflux drum’s level, reboiler duty is the available degree of freedom to manage fractionation
and either help (i) minimize reboiler duty while meeting the distillate product’s quality target or
(ii) maximize reboiler duty to maximize the distillate product’s yield.
The advanced control components in Figure 12.26, that are common to most strategies that pair
distillate quality with reflux flow, have already been summarized earlier (following Figure 12.25)
for control of bottoms quality via reflux rate. However, there are three additions for the control
strategy in Figure 12.26:
● For control of the overhead quality, a rectifying section (above the feed tray) tray temperature
controller is included provided the temperature is sensitive to the overhead impurity (HK).
● If the rectifying section tray temperature is an externally multiplexed measurement, include tem￾perature measurement validity checks.
● Pressure compensation of the tray temperature measurement – see Section 3.7.3.
Remember, internal reflux control is more important when condenser duty upsets are common,
and/or the condenser is either air-cooled or flooded. In Figure 12.26’s overhead configuration, the
condenser is air-cooled and thus it is best to include internal reflux control. In addition, pressure Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License450 12 Tower Product Quality Controls
control paired with the condenser duty can be troublesome when high ambient temperatures limit
the condenser’s duty. If/when the condenser duty is limited high (typically during daylight hours, in
summer), pressure control is either ineffectual, interrupted, or becomes erratic. This is why the tray
temperature measurement in Figure 12.26 is pressure compensated. Although analyzer feedback
will eventually correct for these pressure variations, pressure compensation of the tray temperature
provides feedforward adjustments for these pressure upsets and thus reduces quality PV deviations
from the quality set point.
Note: The control strategy shown in Figure 12.26 would also be appropriate for a tower configu￾ration that included a drumless, flooded condenser, with overhead pressure controlled by manip￾ulating the distillate flow rate.
With one exception, the important control strategy design issues that must be managed by the
components in Figure 12.26 are the same as those listed for the bottoms product quality control
strategy appearing in Figure 12.25. The exception is the decision to either use the pressure con￾troller’s SP or its PV in the pressure compensation calculation.
With reflux rate paired with the distillate product quality and distillate rate paired with the reflux
drum’s level, reboiler duty is the available degree of freedom to manage fractionation. The use of
reboiler duty to manage fractionation is presented next.
12.7.4 Fractionation Management with MV = Reboiler Duty
In both Figures 12.25 and 12.26, reboiler duty is the remaining, available degree of freedom and can
be manipulated to manage tower fractionation. Figure 12.27 illustrates how reboiler duty is used
to manage tower fractionation.
The control strategy in Figure 12.27 is a simple cascade, and cascade initialization and wind-up
are both managed by standard DCS features. However, there are a number of initialization and
wind-up related issues that must be managed by user-supplied custom code and configuration – see
FC
RC
QC
TIV
TIV
FCG
TI
TI
SP
SP
SP
Reboiler duty/
Feed control
Reboiler duty
control
Validation
Reboiler
heating medium
flow
FC
Feed flow
Desired reboiler
Dynamic duty/Feed
compensation,
optional
Figure 12.27 Managing Tower Fractionation, MV = Reboiler Duty
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.7 Two-product Towers – Overview of Conventional Advanced Control Applications 451
the discussion in Section 12.7.1, where manipulating reboiler duty to control bottoms quality is
discussed (Figure 12.23).
The advanced control components included in Figure 12.27 are listed below – they are included
in most strategies that manipulate reboiler duty to manage fractionation (or to control product
quality):
● Reboiler duty control.
● Reboiler heating medium inlet and outlet temperature measurement validity checks – if one or
both are externally multiplexed measurements.
● Feed rate feedforward control with and without dynamic compensation, and control of either the
duty/feed or the heating medium flow/feed ratio.
Similar to internal reflux control, reboiler duty control is more important in a product quality con￾trol strategy such as shown in Figure 12.23 than it is in the fractionation management application
shown in Figure 12.27. Thus, in some cases, reboiler duty control is not included in a fractionation
management strategy. If it is excluded, the heating medium flow/feed ratio is controlled, and the
cascade is then: hot fluid flow/feed → hot fluid flow.
Note that in Figure 12.27, dynamic compensation (FCG tag) of the ratio controller’s wild flow
input (feed rate) is marked optional. For fractionation management, in contrast to the control of
quality, it is usually acceptable to use the uncompensated feed rate as the ratio controller’s wild
flow input. To use the uncompensated feed rate as RC’s wild flow input, the dynamic compensation
tag (FCG) in Figure 12.27 is simply omitted and the feed flow’s PV or SP is configured as the RC
wild flow input.
Like the internal reflux/feed and external reflux/feed ratio controller set points, the reboiler
duty/feed or heating medium’s flow/feed ratio controller’s set point is an offline, calculated guide￾line value that is periodically updated to reflect current economics. It is manually entered by oper￾ators when a new value becomes available. It establishes the tower’s fractionation based on past
operating experiences but does not reflect real-time process conditions and may not reflect current
economic drivers. As mentioned earlier, if real-time process conditions and economics change on
a regular basis, an energy-yield trade-off may be justified, but the only effective way to implement
such a trade-off is to incorporate it into an existing, large scope RTO application.
The applicable control strategy design issues that must be managed by the advanced control
components in Figure 12.27 are the same as those identified in Section 12.7.1, where manipulating
reboiler duty to control bottoms quality is discussed (see Figure 12.23).
12.7.5 Conventional Advanced Product Quality Control with MV = Distillate Rate
Referring to Table 12.2, the most frequently chosen MV to pair with distillate quality is the reflux
flow rate; this conventional advanced control strategy has already been discussed and is presented
in Figure 12.26. When the reflux flow is not an available degree of freedom for distillate product
quality control (most likely due to its pairing with the reflux drum level, or if there is a drumless,
flooded condenser, its pairing with overhead pressure), the overhead quality is usually paired with
the distillate flow. This control strategy – with the overhead quality paired with the distillate flow, is
shown in Figure 12.28. With reflux flow paired with the reflux drum’s level, and distillate product
quality paired with the distillate flow, reboiler duty is the available degree of freedom to manage
fractionation.
The advanced control components included in Figure 12.28 are common to most strategies that
pair distillate quality with distillate flow:
● Feed rate feedforward control with dynamic compensation of feed rate, and control of the
distillate/feed ratio.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License452 12 Tower Product Quality Controls
Dynamic
compensation
FC
FC
LC
FC
TI
Ovhd quality
control
Validation
TI
TI
FC
TIV
FCG
Fractionation
Feed flow
AI
Ovhd quality
FC
RC
SP
Desired Ovhd
quality target
AC AIV
SP
SP
TC
SP
Tray temperature
control
Distillate/Feed
control
Distillate
flow
PC
CW
LC
Validation
Figure 12.28 Overhead Product Quality Advanced Control Strategy, MV = Distillate Flow
● Use of a rectifying section tray temperature controller if the temperature is sensitive to the over￾head impurity (HK).
● Rectifying section tray temperature measurement validity checks – if tray temperature is an exter￾nally multiplexed measurement.
● Overhead product quality validity checks.
The important control strategy design issues that must be managed by the components included
in Figure 12.28 are:
● Input validity checks included in the tray temperature measurement’s validation logic – if tray
temperature measurement is an externally multiplexed input.
● Actions to take when (i) the feed rate measurement becomes unavailable and (ii) the feed rate
measurement returns available.
● Actions to take when (i) the tray temperature measurement is declared invalid and (ii) the tray
temperature measurement returns valid.
● Ensure the feedback control loop remains operational when (i) feed rate feedforward control is
decommissioned and (ii) the feed rate measurement (ratio controller’s wild flow input) becomes
unavailable.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.8 Towers with Sidestream – Overview of Conventional Advanced Control Applications 453
● Ensure the full feedback/feedforward cascade returns on control bumplessly when (i) feed rate
feedforward control is commissioned, (ii) the feed rate measurement becomes available once
again, and (iii) the tray temperature is declared valid after being invalid.
● Use of SP or PV as the feed rate feedforward input (dynamic compensation tag’s PV input).
● Model-based or PID quality control.
Note: The control strategy shown in Figure 12.28 would also be appropriate for a tower configu￾ration that included a drumless, flooded condenser with overhead pressure controlled by manipu￾lating the reflux flow.
With distillate rate paired with the distillate product quality and reflux rate paired with the reflux
drum’s level, reboiler duty is the available degree of freedom to manage fractionation – see the
discussion of Figure 12.27 in Section 12.7.4.
12.7.6 Other Product Quality Strategies
In summary, here are the most common product quality CV–MV pairings for two-product towers:
– Bottoms product quality paired with reboiler duty (see Figure 12.23 in Section 12.7.1).
– Overhead product quality paired with reflux flow (see Figure 12.26 in Section 12.7.3).
– Bottoms product quality paired with reflux flow (see Figure 12.25, in Section 12.7.3).
– Overhead product quality paired with distillate rate (see Figure 12.28, Section 12.7.5).
Bottoms product quality paired with distillate flow and overhead product quality paired with
reboiler duty, with fractionation managed by manipulating reflux flow in both cases, are uncom￾mon. However, the advanced control components needed to implement the bottoms product
quality-distillate flow pairing are identical to the components included for the overhead product
quality-distillate flow pairing discussed in Section 12.7.5 (see Figure 12.28). Also, the advanced
control components needed to implement the overhead product quality – reboiler duty pairing
are identical to the components included for the bottoms product quality – reboiler duty pairing
discussed in Section 12.7.1 (see Figure 12.23). The only difference in each case is the location of the
tray temperature controller’s measurement – stripping section temperature instead of a rectifying
section temperature in the first case and a rectifying section temperature instead of a stripping
section temperature in the second case.
12.8 Towers with Sidestream – Overview of Conventional
Advanced Control Applications
An overview discussion of the product quality controls for towers with a sidestream was presented
in Section 12.4.2 and Section 12.5. The basis for that discussion was the CV–MV pairings in the last
three rows of Table 12.4; however, the discussion focused only on the ultimate primary (CV) and the
ultimate secondary (MV). With one exception, the same common advanced control components
that complete the product quality advanced control cascade structures for two-product towers are
also applicable to towers with a sidestream. The one exception – the advance control components
that link the sidestream product quality (CV) to the sidestream flow rate (MV).
The methods used to manage fractionation – the tower’s internal reflux flow above and below
the draw-off tray, are also presented. In a tower with a sidestream, ensuring there is sufficient inter￾nal reflux to maintain good fractionation and sustain the separations supported by the advanced
control strategies is sometimes an issue. The method utilized depends on whether there is an MV
available to manage the tower’s internal reflux flow. When all three qualities are controlled, no Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License454 12 Tower Product Quality Controls
degree of freedom is available to manage fractionation. As previously explained in Section 12.5,
when there is no MV available to manage tower fractionation, an override of one of the product
quality controllers may be needed to ensure the tower’s internal reflux remains above the limiting
(minimum) value needed to maintain normal separations.
When an MV is available to directly manage internal reflux flow, a product quality control over￾ride is not necessary. For example, when two-product qualities are controlled, two of the three
available MVs – reflux flow, sidestream flow, and the reboiler duty in Figure 12.14 or distillate flow,
sidestream flow, and reboiler duty in Figure 12.15, must be paired with the two-product quality CVs.
Thus, one MV from among the three in each group is available to directly manage fractionation,
and a product quality override is not necessary.
12.8.1 Conventional Distillate and Bottoms Advanced Product Quality Control
When only distillate and/or bottoms product qualities are controlled, control strategies for a tower
with a sidestream are essentially identical to distillate and bottoms product quality control strate￾gies implemented in a two-product tower. Of course, control of a sidestream quality, illustrated in
Figure 12.29 and discussed next in Section 12.8.2, is unique to towers with a sidestream. Here is a
summary of these conventional bottoms and distillate product quality control strategies, presented
earlier for two-product towers, but also applicable to towers with a sidestream:
● Bottoms product quality controlled by manipulating reboiler duty (Figure 12.23 in Section 12.7.1).
The strategy in Figure 12.23 is sometimes implemented to control distillate product quality.
● Bottoms product quality controlled by manipulating reflux flow (Figure 12.25 in Section 12.7.3).
● Distillate product quality controlled by manipulating reflux flow (Figure 12.26 in Section 12.7.3).
● Control of distillate product quality by manipulating reflux flow (Figure 12.26) is more common
than using it to control bottoms quality (Figure 12.25).
● Distillate product quality controlled by manipulating distillate flow (Figure 12.28 in
Section 12.7.5). The strategy in Figure 12.28 is sometimes implemented to control bottoms
product quality.
The important control strategy design issues that must be managed by the control components
in these strategies are presented in Sections 12.7.1 (in discussion of Figure 12.23), 12.7.3 (in dis￾cussions of Figures 12.25 and 12.26), and 12.7.5 (in discussion of Figure 12.28). Here are the most
important characteristics that must be managed:
● The tray temperature controller’s PV input is a stripping section measurement if controlling bot￾toms quality (LK impurity), and a rectifying section measurement if controlling overhead quality
(HK impurity).
● The quality analyzer’s measurement is always validated, while temperature validation is required
only if the temperature measurement is an externally multiplexed input.
● Commissioning or decommissioning the feed rate feedforward controller has no effect on the
feedback control corrections.
● An unavailable (feed rate) or invalid (temperature) feedforward input does not affect the feedback
control loop corrections.
● When an unavailable or an invalid feedforward input becomes available or valid once again, the
entire feedback/feedforward control strategy is recommissioned bumplessly.
12.8.2 Conventional Sidestream Advanced Product Quality Control
Referring to Table 12.4, the sidestream quality is most frequently paired with the sidestream
draw-off flow. The conventional advanced control strategy that manipulates sidestream draw-off Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.8 Towers with Sidestream – Overview of Conventional Advanced Control Applications 455
SP
Side stream
draw-off
FC
Validation
AI AIV
Quality
measurement
AC
SP
Desired
SS quality
Side stream
quality control
SP
Side stream/feed
ratio control FC FCG
Dynamic
compensation
RC
Feed
flow
Figure 12.29 SS Product Quality Control, MV = SS Draw-off Flow. One or Two Product Qualities Controlled
flow to control the sidestream product’s quality is presented in Figure 12.29. This is the one
product quality control strategy that distinguishes a tower with a sidestream from a two-product
tower. The following advanced control components are included in Figure 12.29 – as indicated,
they have already been discussed in previous sections:
● Feed rate feedforward control with dynamic compensation, and control of the sidestream
flow/feed ratio (see Sections 3.2, 3.3, and 3.4)
● Side stream quality measurement validity checks (see Section 8.8)
Control strategy design issues that must be managed by these components are summarized
below; they have all been identified previously when other tower product quality control strategies
were introduced.
● Input validity checks to include in the sidestream quality measurement’s validation logic.
● Ensure product quality controller adjustments stop when the quality measurement is declared
invalid, and actions to take when an invalid quality measurement returns valid.
● Ensure the feedback control loop remains operational when (i) feed rate feedforward control
is decommissioned and (ii) the feed rate measurement, the ratio controller’s wild flow input,
becomes unavailable.
● Ensure the full feedback/feedforward cascade returns on control bumplessly when (i) feed rate
feedforward control is commissioned and (ii) the feed rate measurement becomes available again.
● Use of SP or PV as a feed rate feedforward input (dynamic compensation tag’s PV input).
● Product quality PID control or model-based quality control.
12.8.3 Fractionation Management
When only two product qualities are controlled, no more than two of the three available
MVs – reflux flow, sidestream draw-off, and the reboiler duty in Figure 12.14 or distillate flow,
sidestream draw-off, and reboiler duty in Figure 12.15 are paired with the two (or less) product
quality CVs that must be controlled. Thus, at least one MV from among the three remaining in Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License456 12 Tower Product Quality Controls
each group of three is available to directly manage internal reflux flow and fractionation; a product
quality control override is not necessary.
The algebraic relationship among internal reflux above the sidestream draw-off tray (IR1), the
internal reflux below the sidestream draw-off tray (IR2) and the sidestream draw-off flow rate (SS)
was presented in Equation (12.1) in Section 12.5 and is repeated below:
IR2 PV = IR1 PV − SS PV (12.10)
In Equation (12.10), IR1 PV and SS PV are independent variables. IR2 PV is a dependent variable,
whose value is determined by the internal reflux flow, IR1 PV (or its set point, IR1 SP if IR1 is
controlled), and sidestream draw-off flow, SS PV (or its set point, SS SP). Thus, if not paired with a
product quality, either the external reflux flow – to set the internal reflux flow above the sidestream
draw off tray (IR1 PV) or the sidestream draw-off flow (SS PV) – to set the internal reflux flow
below the draw-off tray (IR2 PV) can be adjusted to establish and maintain sufficient internal reflux
flow and ensure satisfactory fractionation. Reboiler duty impacts both IR1 PV and IR2 PV, and
thus is also a candidate to manage fractionation. Therefore, with less than three product qualities
controlled, at least one of the following independent variables is available to manage fractionation:
(i) the sidestream draw-off flow, (ii) the external reflux flow, and (iii) the reboiler duty.
Manipulating Sidestream Flow to Manage Fractionation
From Table 12.4, the sidestream draw-off flow is most frequently paired with the sidestream prod￾uct quality. Under special circumstances, it may be paired with either the bottoms level or the
bottoms quality, but these pairings are unusual. Therefore, if the sidestream product quality is not
controlled, the sidestream draw-off flow is normally available to manage the tower’s internal reflux
and thus the tower’s fractionation.
Equation (12.2), discussed in Section 12.5 and obtained by dividing both sides of Equation (12.1)
(or Equation (12.10)) by the internal reflux flow above the draw-off tray, IR1 PV, is fundamental to
managing fractionation with the draw-off flow. Dividing both sides of Equation (12.10) by IR1 PV
yields:
IR2 PV
IR1 PV = 1 − SS PV
IR1 PV = 1 − 𝜆 (12.11)
Equation (12.11) indicates that by maintaining the ratio 𝜆 = [SS PV/IR1 PV] constant, the [IR2
PV/IR1 PV] ratio is maintained constant as IR1 PV varies. Note that the source for IR1 PV is either
(i) the internal reflux control component in a distillate or bottoms product quality advanced control
strategy (such as in Figures 12.25 and 12.26), (ii) a stand-alone calculation based on the reflux flow
demanded by the reflux drum’s level controller, or (iii) if there is a drumless, flooded condenser,
the reflux flow demanded by the overhead pressure controller. A guideline estimate for 𝜆 (or 1/𝜆)
is specified offline to establish target IR2 PV, IR1 PV, and SS PV values that provide satisfactory
fractionation above and below the draw-off tray.
From the definition of 𝜆, SS PV = 𝜆 * IR1 PV. With the value of 𝜆 specified offline, and after
replacing SS PV with the sidestream draw-off flow’s set point (SS SP), the sidestream flow set point
that maintains 𝜆 constant as the internal reflux flow above the sidestream draw-off tray, IR1 PV,
varies with time, can be calculated:
SS SP = 𝜆 ∗ IR1 PV (12.12)
As illustrated in Figure 12.30, the calculation of the sidestream draw-off flow’s set point is provided
by a standard ratio controller, with the calculated internal reflux flow (IR1 PV) the wild flow input.
The control strategy in Figure 12.30 is a simple cascade, with initialization and wind-up managed
by standard DCS functionality.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.8 Towers with Sidestream – Overview of Conventional Advanced Control Applications 457
Side stream
draw-off
FC
Internal reflux
above draw-off
calc
TI
Typical value
Ovhd temperature
Validation
TIV
TI TI TYP
Reflux flow
Reflux
temperature
FC
SP
IR1 PV
FI RC SS/IR1
ratio Ctl
Desired
SS PV/IR1 PV (λ) 
Figure 12.30 Tower Fractionation Management w/o Override, MV = Sidestream Draw-Off Flow
Note that if the IR1 PV’s source is an internal reflux control component in a distillate or bottoms
product quality advanced control strategy (see Figures 12.25 and 12.26), then the internal reflux
controller’s set point, IR1 SP, can replace IR1 PV as the ratio controller’s wild flow input in
Equation 12.12 to reduce noise propagation. As a cascade secondary in either product quality
control strategy, it is already configured for SPInit = Yes. Note: The control strategy in Figure 12.30
impacts IR2 PV directly. It has no immediate impact on IR1 PV, although it maintains the
[IR2 PV/IR1PV] ratio constant (via Equation (12.11)).
Manipulating Reflux Flow to Manage Fractionation
The reflux flow is frequently paired with the distillate quality and is sometimes paired with either
the reflux drum level, or the tower pressure if the tower configuration includes a drumless, flooded
condenser. Therefore, reflux flow is occasionally available as a degree of freedom to manage tower
fractionation – but only if (i) distillate quality is not controlled14 or is paired with reboiler duty15
and (ii) either reflux drum level or the overhead pressure is paired with distillate rate (if there is a
drumless, flooded condenser).
When the above conditions are satisfied and reflux flow is available to help manage fractionation,
the approach used is very similar to the approach described above for the sidestream flow – ensure
sufficient internal reflux to meet the offline specified value of 𝜆. As shown in Figure 12.31, as the
sidestream draw-off flow is manipulated by the sidestream’s product quality control strategy, the
internal reflux flow set point is calculated by the (IR1/SS) ratio controller, whose set point is = 1/𝜆
and whose wild flow is the sidestream draw-off flow. The IR1 controller then resets the external
reflux flow controller’s set point.
Note that the control strategy in Figure 12.31 impacts IR1 PV directly, and by the material balance
in Equation (12.10), it impacts IR2 PV, with the net result that the [IR2 PV/IR1PV] ratio is constant
(via Equation (12.11). Like the control strategy in Figure 12.30, the control strategy in Figure 12.31
is a simple cascade, with initialization and wind-up managed by standard DCS functionality.
Although there are no new advanced control components included in Figure 12.31’s control strat￾egy, there are two additional design issues that must be considered:
● The IR1 controller can be configured as a PID controller, or it can have an algebraic control
algorithm that directly calculates the external reflux controller’s set point, using Equation (12.9).
● Use of SS SP or SS PV for the ratio controller’s sidestream wild flow input.
14 If distillate quality is controlled, reflux rate must either be paired with the distillate quality or with the reflux
drum level if the distillate quality is paired with distillate rate. In either case, it is not an available degree of freedom.
15 Reboiler duty is only occasionally paired with the distillate quality.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License458 12 Tower Product Quality Controls
Reflux
flow FC
SS D/O
SP
SP Side stream product
quality control
Side stream
draw-off 
FC
IR1/SS ratio
control
Desired
IR1 PV/SS PV ratio (1/λ)
RC
SP
SP
Internal reflux
above draw-off
(IR1) control FC
IR1 PV IR1 calculation
Reflux
flow
TI
Typical value
Ovhd temperature
Validation
TIV
TITYP TI
Reflux
temperature
Figure 12.31 Tower Fractionation Management w/o Override, MV = Reflux Flow
Manipulating Reboiler Duty to Manage Fractionation
Referring to Table 12.4, reboiler duty is most frequently paired with the bottoms product quality.
Under some circumstances, it may be paired with the distillate or sidestream quality, but these pair￾ings are not very common. Therefore, if the bottoms product quality is not controlled, the reboiler
duty is probably available to manage the tower’s internal reflux and its fractionation. This is most
efficient when the reflux flow is paired with the reflux drum level or the overhead pressure if there
is a drumless, flooded condenser – reflux flow is not paired with a distillate product quality. Refer
to Equation (12.3) in Section 12.5, obtained by dividing both sides of Equation (12.1) or both sides
of Equation (12.10) by the sidestream draw-off flow, SS PV; it is repeated below:
IR2 PV
SS PV = IR1 PV
SS PV − 1 = 1
𝜆 − 1 (12.13)
Equation (12.13) indicates that by maintaining [IR1 PV/SS PV]≡1/𝜆 constant, the [IR2 PV/SS
PV] ratio is maintained constant as SS PV varies. Remember, a guideline value of 𝜆 (or 1/𝜆) is
specified offline to establish target IR2 PV, IR1 PV, and SS PV values that provide satisfactory frac￾tionation above and below the draw-off tray.
From the definition of 𝜆, it follows that IR1 PV = 1/𝜆 * SS PV. With the value of 𝜆 specified offline,
after replacing IR1 PV with the internal reflux flow’s set point (IR1 SP), the internal reflux flow that
maintains 𝜆 constant as the sidestream draw-off flow varies with time is calculated:
IR1 SP = 1
𝜆 ∗ SS PV (12.14)
Thus, as shown in Figure 12.32, as the sidestream draw-off flow is manipulated by the sidestream
product quality control strategy, the IR1/SS ratio controller (whose set point is 1/𝜆, the desired
IR1/SS ratio) resets the internal reflux flow controller’s set point, IR1 SP via Equation (12.14). The
IR1 controller then resets the reboiler duty controller. The reboiler duty adjustments impact IR1 PV
via the duty’s ability to change vapor boil-up. Vapor boil-up changes lead to one of the following two
responses: (i) if reflux flow is paired with reflux drum level, the vapor is condensed, accumulates
in the reflux drum, and the drum’s level controller adjustments change reflux flow or (ii) if there
is a drumless, flooded condenser and reflux flow is paired with overhead pressure, the pressure
controller adjusts the reflux flow.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.8 Towers with Sidestream – Overview of Conventional Advanced Control Applications 459
TI
FC
TIV
TIV SP
Reboiler duty
control
Reboiler
heating medium
flow
TI
Inlet
temperature
Outlet
temperature
QC
SP
SP
Internal reflux
above draw-off
(IR1) control
FC
IR1 PV IR1 calculation
Reflux
flow
Typical value
Ovhd temperature
TITYP
FC
TI
Validation
TIV TI
Reflux
temperature
SS D/O
SP
IR1/SS ratio
control
SP Side stream product
quality control
Side stream
draw-off flow 
FC
RC
Desired
IR1 PV/SS PV ratio (1/λ) 
Validation
Figure 12.32 Tower Fractionation Management w/o Override, MV = Reboiler Duty
Remember: The internal reflux calculation in Figure 12.32 depends on the external reflux flow
(SP or PV) being established by the reflux drum level controller’s adjustments or the overhead
pressure controller’s (if there is a drumless, flooded condenser) adjustments. It is the level or pres￾sure controller adjustments to the external reflux flow, in response to the reboiler duty changes,
that ultimately changes the internal reflux.
Note: The dynamic response of internal reflux to changes in reboiler duty are very slow, and will
contain deadtime. Whether this is or is not a problem for a particular tower must be evaluated.
Although there are no new advanced control components included in Figure 12.32’s control strat￾egy, there are two additional design issues that must be considered:
● The internal reflux (IR1) controller must be configured as a PID controller – there is no direct,
algebraic relationship between reboiler duty and internal reflux.
● Use of SS SP or SS PV for the ratio controller’s sidestream wild flow input.
And, finally, like the control strategies in Figures 12.30 and 12.31, the control strategy in
Figure 12.32 is a simple cascade, with initialization and wind-up managed by standard DCS
functionality.
12.8.4 Fractionation Management with Product Quality Control Override
When all three qualities are controlled, there is no degree of freedom available to manage frac￾tionation. If so, as explained in Section 12.5, if fractionation becomes an issue, one of the product
quality control strategies must be overridden, and instead of maintaining the quality at its target, the
override ensures the tower’s internal reflux remains above the limiting (minimum) value needed to
maintain normal separation. Process and control specifics impact the decision as to which product’s
quality controller is overridden – the least valuable product and/or the most difficult quality to Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License460 12 Tower Product Quality Controls
measure, infer, or control is often the override choice. In this section, the control logic used to
override previously described distillate and bottoms product quality control (in Section 12.8.1) and
sidestream product quality control (in Section 12.8.2) to manage tower fractionation is described.
The general characteristics of override strategies were discussed in Section 6.1 – specifically, see
the discussions of Figures 6.3 and 6.4.
Remember: As emphasized earlier, the need to control three product qualities seldom occurs. And
if it were necessary, because of interactions among all control adjustments, conventional advanced
control approaches would almost certainly perform poorly.
Distillate or Bottoms Product Quality Control Override to Manage Fractionation with Reflux Flow
The conventional advanced control cascades discussed in Section 12.7.3 pairs reflux flow with
bottoms product quality in Figure 12.25 and with distillate quality in Figure 12.26. In both
Figures 12.25 and 12.26, the internal reflux/feed ratio controller outputs a set point to an internal
reflux controller – this is the internal reflux flow needed to maintain the bottoms (Figure 12.25)
or distillate (Figure 12.26) product quality at target. In Figure 12.31 (in Section 12.8.3), the
internal reflux/sidestream ratio (IR1/SS) controller (RC in the figure) also outputs a set point to
an internal reflux controller – this is the internal reflux flow needed to maintain the IR1/SS ratio
at its guideline value (RC SP) as the sidestream product quality controller adjusts the sidestream
draw-off flow to maintain the sidestream product quality at its desired target.
Thus, a product quality control override design can be developed by adding an appropriate signal
selector and connecting both internal reflux flow set point calculations to it – one calculated by the
conventional advanced control cascade in Figure 12.25 or Figure 12.26, and the other calculated
by the control logic in Figure 12.31 that manages fractionation. This override strategy is presented
in Figure 12.33. The signal selector, in this case an HSS (see discussion following Figure 12.33),
chooses the larger of the two calculated internal reflux flow set points to send to the internal reflux
controller secondary.
In the override strategy in Figure 12.33, the IR1/SS ratio controller’s set point is a desired,
minimum IR1/SS ratio (= 1/𝜆), and 𝜆 is an offline specified value that ensures proper fractionation.
During normal operations, the IR1 SP that satisfies the minimum ratio (based on the current
Desired
IR1 flow SP
IR1/SS ratio
control
IR1 SP IR1 SP to ensure IR1/SS ratio
is above its minimum value
SS D/O
SP
Side stream
draw-off 
SP Side stream product
FC quality control
RC
Desired (minimum)
IR1 PV/SS PV ratio (1/λ)
IR1 SP FC
Reflux flow
SP
HSS
IR1 SP to maintain
quality at target
IR1 calculation
and control
SP
SP
Btms or Ovhd
quality control
IR1/feed
ratio control RC
Dynamic
compensation FCG
Feed flow FC
From Figure 12.25 or 12.26
From Figure 12.31
Figure 12.33 Product Quality Control Override to Manage Fractionation, MV = Reflux Flow
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.8 Towers with Sidestream – Overview of Conventional Advanced Control Applications 461
value of SS PV) is well below the value demanded by the overhead or bottoms product quality
control strategy, IR1 SP. With the internal reflux flow that satisfies the minimum ratio less
than the internal reflux flow that is currently satisfying the overhead or bottoms product quality
target, the HSS chooses the IR1 SP that satisfies the overhead or bottoms product quality target.
However, if operating conditions change so that there is insufficient internal reflux, it is the larger
of the two calculated internal reflux set points that will increase the IR1/SS ratio most. Therefore,
the HSS in Figure 12.33 chooses the larger internal reflux set point, activating the override;
the product quality control is overridden until the IR1/SS ratio is driven above its minimum
value.
When the override is active, the product quality’s IR1/feed ratio controller’s wind-up status
must be set, and it must initialize. The override control strategy in Figure 12.33 is a complex
cascade and custom logic must be provided to set these statuses. However, the product quality
control cascade above the IR1/feed ratio controller, in both Figures 12.25 and 12.26, is a sim￾ple cascade, and standard DCS features will set the initialization and wind-up statuses of the
TC and AC controllers once the ratio controller’s statuses are resolved via the user-provided
custom code.
When the override is inactive, the IR1/SS ratio controller continues to calculate the internal
reflux flow set point that ensures the minimum IR1/SS ratio is not violated; its initialization and
wind-up statuses are thus normally not issues. It thus stands ready to override the quality control
strategy’s internal reflux flow set point whenever it becomes necessary.
Sidestream Product Quality Control Override to Manage Fractionation with Sidestream Flow
The above approach, used to design the distillate or bottoms product quality control override by
manipulating reflux flow, is now applied to the design of a sidestream product quality control
override. The conventional advanced control cascade in Figure 12.29 (Section 12.8.2) pairs the
sidestream draw-off flow with the sidestream quality; the quality control strategy’s sidestream
flow/feed ratio controller outputs to the sidestream draw-off flow, SS SP. In Figure 12.30, SS SP is
calculated to manage internal reflux and tower fractionation – by maintaining the SS PV/IR1 PV
ratio at the PTS specified value of 𝜆. Thus, once again, a product quality control override design
can be developed by adding an appropriate signal selector (in this case, a low signal selector, LSS)
and connecting the two calculated SS SP values to it – one calculated by the conventional advanced
control cascade in Figure 12.29 (SS SP) that controls sidestream quality, and the other calculated
by the control strategy in Figure 12.30 (SS SP) that manages fractionation. The LSS then chooses
the smaller of the two calculated sidestream draw-off flow set points to send to its secondary, the
sidestream draw-off flow. This override strategy is shown in Figure 12.34.
In Figure 12.34, the SS/IR1 ratio controller’s set point is a desired, maximum SS/IR1 ratio, the
offline specified value 𝜆. During normal operations, the SS SP needed to satisfy the maximum ratio
(based on the current value of IR1 PV) is well above the value demanded by the sidestream product
quality control strategy. With the sidestream draw-off needed to satisfy the maximum ratio greater
than the sidestream flow that satisfies the sidestream quality target, the LSS chooses the SS SP
that satisfies the sidestream quality target. However, the override is activated if at some point the
sidestream draw-off flow needed to satisfy the maximum ratio is less than the sidestream flow that
satisfies the quality control strategy paired with sidestream flow. The LSS in Figure 12.34 then
chooses the smaller SS SP, the override is activated, and product quality control is overridden until
the SS/IR1 ratio is driven above its maximum value.
When the override is active, the sidestream product quality’s SS flow/feed ratio controller’s
wind-up status must be set, and it must initialize. Since the override control strategy in Figure 12.34
is a complex cascade, custom logic must be provided to set these statuses. However, standard Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License462 12 Tower Product Quality Controls
Desired (maximum)
SS/IR1 ratio (λ)
IR1 PV or SP
RC
SS D/O flow to ensure SS/IR1 ratio
is below its maximum value
IR1 calculation
and/or control
SP
SS D/O flow to maintain
quality at target
LSS
SP
Side stream
draw-off
FC
SS SP
SS SP
Desired
SS D/O flow SP
From Figure 12.29
From Figure 12.30 Dynamic
compensation
SP
SS/feed
ratio Ctl
FC FCG RC
Feed
flow
AIV AC
SP
AI
Desired SS quality
SS quality
control
Quality Validation
Figure 12.34 Sidestream Product Quality Control Override to Manage Fractionation, MV = Sidestream
Flow
DCS features will set the initialization and wind-up statuses of the AC controller once the ratio
controller’s statuses are resolved via the user provided custom code.
When the override is inactive, the SS/IR1 ratio controller continues to calculate the sidestream
draw-off flow set point that ensures the desired maximum ratio is not violated; its initialization and
wind-up statuses are thus normally not issues. It thus stands ready to override the quality control
strategy’s internal reflux flow set point when it becomes necessary.
Bottoms Product Quality Override to Manage Fractionation with Reboiler Duty
A bottoms product quality control override design combines the conventional advanced control
cascade in Figure 12.23 (Section 12.7.1) – pairing the reboiler duty and bottoms product quality,
with the strategy in Figure 12.32 that manages the tower’s internal reflux and fractionation by
adjusting reboiler duty. A bottoms quality override can best be implemented if the external reflux
flow is paired with either the reflux drum level or the overhead pressure (if there is a drumless,
flooded condenser), e.g., reflux flow is not paired with a distillate or sidestream product quality.
In Figure 12.23, the product quality control strategy’s reboiler duty/feed ratio controller calculates
and outputs a new reboiler duty controller set point (Q SP). In Figure 12.32, a reboiler duty set
point (Q SP) is also calculated, by the internal reflux (IR1) controller, that resets the duty controller
to maintain the desired IR1/SS ratio. Again, a quality control override strategy can be developed
by adding an appropriate signal selector (in this case, a high signal selector, HSS), connected to
the two calculated Q SP values – one calculated by the conventional advanced control cascade in
Figure 12.23, and the other calculated as shown in Figure 12.32 to manage tower internal reflux
and fractionation. The selector chooses the appropriate Q SP value, in this case, the larger of the
two set points, to send to the reboiler duty controller’s set point. This override strategy is shown in
Figure 12.35.
If there is insufficient internal reflux, and the reboiler duty that satisfies the product quality’s
target is smaller than the reboiler duty that satisfies the minimum ratio, the larger of the two cal￾culated reboiler duty set points will (eventually, after tower dynamics expire) increase the internal Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.9 Two-product Towers – Conventional Advanced Control Application Examples 463
Q SP
SP
Desired
IR1
IR1/SS ratio
control
SP
IR1
control FC
RC
IR1 PV
SS D/O
Internal reflux
above draw-off
SP Side stream product
quality control
Side stream
draw-off 
FC
Desired (minimum)
IR1 PV/SS PV ratio (1/λ) 
IR1 calculation
HSS
Desired
reboiler duty
Dynamic
compensation
Reboiler duty/feed
ratio control
FCG
RC
SP
FC Feed
flow
Q SP
Reboiler duty to maintain
quality at target
Btms or Ovhd product
quality control
Reboiler duty
calc and Ctl
Reboiler
hot fluid flow
FC
SP SP
Reflux
flow FC
From Figure 12.32
From Figure 12.23
Reboiler duty to ensure IR1/SS ratio
is above its minimum allowable value
Figure 12.35 Product Quality Control Override to Manage Fractionation, MV = Reboiler Duty
reflux flow (IR1 PV) to increase the IR1/SS ratio above its desired minimum (= 1/𝜆). Therefore,
the HSS in Figure 12.35 chooses the larger reboiler duty set point, activating the override. Product
quality control is overridden until the IR1/SS ratio is driven above its minimum value.
When the override is active, the product quality strategy’s duty/feed ratio controller’s wind-up
status must be set, and it must initialize. The override control strategy in Figure 12.35 is a complex
cascade and custom logic must be provided to set these statuses. However, the product quality con￾trol cascade above the duty/feed ratio controller (in Figure 12.23) is a simple cascade, and standard
DCS features will set the initialization and wind-up statuses of the TC and AC controllers once the
ratio controller’s statuses are resolved via the user-provided custom code.
When the override is inactive, the IR1/SS ratio controller continues to calculate the reboiler duty
set point that ensures the minimum ratio (the IR1/SS ratio controller’s set point) is not violated; its
initialization and wind-up statuses are thus normally not issues. It thus stands ready to override
the quality control strategy’s reboiler duty set point when it becomes necessary.
Remember: The dynamic response of internal reflux to changes in reboiler duty is much slowerthan
its response to either external reflux or sidestream flow changes. Thus, a bottoms product quality
override to manage fractionation, with reboiler duty adjustments, is less effective than using either
external reflux flow or sidestream flow adjustments.
12.9 Two-product Towers – Conventional Advanced Control
Application Examples
Conventional advanced control applications for two-product towers, when only one product
quality is controlled, are presented in this section. Referring to Table 12.2, after the reflux drum
level, the bottoms level and the tower pressure are paired with three of the five MVs, there are Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License464 12 Tower Product Quality Controls
HVN
E-73
Debutanizer
(DeC4)
To De-iC5 and/or
to Isom unit or
MOGAS bending
CW
AI
85
C5, C6
T
8
5
Naphtha
splitter
AI
86
nC4
Catalytic
reforming
reactors
E-89
To aromatics
plant (BTX)
AI
95
5% Pt
TK-1844
For MOGAS
blending
T
8
0
C5+
C4– D-75
To amine
scrubber
E-71
H2S, C4–
Amine
scrubber
T
9
5 C3/C4
splitter
C3
product
TK-41
AI
91
C2
C4
Product
TK-40
E-93
E-92
From
NHF
T
9
0
H2S, C3+
Deethanizer
(DeC2)
D-65
E-91
CW
H2S, C2–
C6
To amine scrubber
LVN
∞
Figure 12.36 Typical Crude Light-ends Section Tower Configuration
two degrees of freedom remaining. Thus, one available degree of freedom can be paired with the
product quality, while the other available degree of freedom can be used to set the tower’s frac￾tionation. When both product qualities are controlled (Section 12.3.1), fractionation cannot be set
independently – no degree of freedom remains after each quality CV is paired with one of the two
remaining MVs. Instead, tower fractionation is determined as the two control strategies satisfy their
quality targets.
These examples, plus those presented and discussed in Section 12.10 for towers with a
sidestream, illustrate how the standard advanced control components presented and discussed
in Sections 12.7 and 12.8 are used to connect ultimate primaries to ultimate secondaries to
build product quality and fractionation management control strategies for representative process
operations.
12.9.1 Crude Light-ends Section Tower Controls
Conventional advanced control strategies implemented in three towers in an oil refinery’s crude
light-ends section, containing a deethanizer (DeC2), a debutanizer (DeC4), and a naphtha splitter,
are now presented and discussed. A typical crude light-ends process configuration is presented
in Figure 12.36. The CDU’s overhead (distillate) product is routed to the naphtha hydrofiner
(NHF) where metals, sulfur, and nitrogen are removed. After some light component byproducts
of the NHF reactions are stripped out of the reactor effluent, the reactor effluent is routed to Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.9 Two-product Towers – Conventional Advanced Control Application Examples 465
the crude light-ends section where the effluent’s remaining lighter components are separated as
indicated below:
Tower Components Separated Routed To
DeC2 (T-90) In overhead vapor product: C2− H2S clean-up, fuel gas system
DeC4 (T-80) In distillate product: C4− C3/C4 splitter (T-95) for separation
of C3 and C4 products
C3/C4 splitter (T-95) In distillate product: C3
In bottoms product: C4
Propane and/or LPG sales
Alkylation unit feed and/or MOGAS
blending
Naphtha splitter (T-85) In distillate product (LVN): C5, C6
In bottoms product (HVN): C6+
Isomerization unit feed and/or
(MOGAS) blend stock.
Catalytic reformer feed
Note that the light virgin naphtha (LVN) at T-85 overhead may be further processed in a down￾stream deisopentanizer (De-iC5) to remove iC5 (a poor isomerization feedstock) before becoming
an Isom unit feed.
The focus of the crude light-ends conventional advanced control strategy discussions will be on
three towers – the DeC2 (T-90), the DeC4 (T-80), and the naphtha splitter (T-85). Their specific
operating and control objectives are summarized below in Table 12.5. Control strategies that sat￾isfy each tower’s product quality requirements and manage each tower’s fractionation are now
presented and discussed.
DeC2 Tower (T-90) Conventional Advanced Controls
The DeC2 tower’s process configuration and instrument details are displayed in Figure 12.37.
Reflux drum D-95’s level, LC201, is paired with T-90’s reflux flow – via valve LV201, and the
tower’s pressure, PC201, is paired with the reflux drum’s vapor off-gas flow – via valve PV201.
Although not shown, T-90’s bottoms level is paired with bottoms flow, a CV–MV pairing that is
almost always utilized. Referring to Table 12.2, the only degree of freedom available for product
quality control is reboiler E-93 duty. The mid-reboiler, E-92, perhaps added as an element in a
tower debottlenecking project, provides additional heat input, but because FI233 is not controlled
Table 12.5 Typical Crude Light-ends Section Operating and Control Objectives
Tower Operating Objective Control Objective
DeC2 (T-90) Limit C2 in C3 product (at T-95
overhead) or minimize C3 loss to fuel
gas (T-90 overhead)
Control C2 in C3 product (T-95
overhead) or control rectifying
section’s tray temperature if an
inferential indicator of C3 (HK)
DeC4 (T-80) Reduce C5 losses to C4 product (any C5
in DeC4 ovhd separated in T-95’s C4
product)
Meet LVN RVP target at T-85 overhead
and increase iC5 recovery in LVN
Control C5 in T-80 overhead
Control nC4 in T-80 bottoms
Naphtha Splitter (T-85) Upgrade T-85 overhead (LVN) to T-85
bottoms product (HVN)
Reduce benzene yield in reformer
Control T-85 bottoms HVN 5% point
Drive C6 into T-85 overhead (LVN)
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License466 12 Tower Product Quality Controls
T
9
0
Deethanizer
(DeC2)
From NHF
product
stabilizer
E-93
CDU
Btms
Reformer
effluent
FC
207
TI
211
TI
212
FI
233
TI
203
TV203
TI
27
FI
102
TI
28
To DeC4 (T-80)
Mid-reboiler
E-92
TI
201
D-95
To amine scrubber
E-91 and FG header
CW
LC
201
PC
201
LV201
PV201
Figure 12.37 Crude Light-ends Section’s Deethanizer (T-90) Configuration
and is set by downstream or upstream conditions, E-92’s duty is also set by downstream or
upstream conditions. However, E-92’s duty must be calculated because it impacts the amount
of duty E-93 must provide to control the product quality as downstream/upstream upsets
effect E-92 duty.
Referring to Table 12.5, E-93 duty can be used to (i) control the C2 in C3 product or (ii) mini￾mize C3 losses to fuel gas. To minimize C3 losses to fuel gas without an overhead C3 (the overhead
product’s HK) online measurement, if T-90’s enriching section tray temperature (TI201 PV) is an
inferential indicator of C3, then it can be controlled at an offline calculated desired value. To limit
the C2 in C3 product, either the C2 in C3 measurement in T-95’s overhead (AI91 PV), a direct indica￾tor of quality, or T-90’s stripping section tray temperature measurement (TI203 PV), if an inferential
indicator of C2 (the bottom’s product LK), can then be controlled. If only stripping section tray tem￾perature control is implemented, the temperature set point is an offline calculated desired value.
Since there is only one MV (E-93 duty), only one of these two control objectives can be achieved.
The choice is normally based on current economics – the estimated incentives for achieving each.
Figure 12.38 illustrates the conventional advanced control strategy that controls the C2 in
C3 product using the T-95 overhead C2 in C3 measurement (AI91 PV). The control strategy
in Figure 12.38 is for the most part comprised of advanced control components discussed in
Section 12.7.1 for product quality control manipulating reboiler duty (see Figure 12.23). From
the discussion in Section 12.7.1, the strategy in Figure 12.38 is a simple cascade and cascade
initialization and wind-up are both handled by standard DCS features.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.9 Two-product Towers – Conventional Advanced Control Application Examples 467
TI
203
FIG207
TC203
RC203
Dynamic
compensation
SP
SP
Total heat input/
feed
Tray
temperature
FC
207
AC91 AIV91
Validation
Desired C2 in C3
product
SP
C2 in C3 product
control
AI
91
C2 in C3 product
(T-95 Ovhd) 
FI
102
TI
28
TI
27
TIV28
TIV27
QC203 Validation
SP
CDU Btms
bypassing E-93
CDU
Btms
TV203
QC213
CDU Btms
to E-93
QI233
Mid-reboiler
E-92 duty
FI
233
TI
211
TI
212
TIV211
TIV212
Validation
SP
E-93
duty
E-92 duty Total
heat input
Figure 12.38 C3/C4 Tower C2 in C3 Product Quality Control, MV = Deethanizer Reboiler Duty
Although the advanced control components in Figure 12.38 were presented and discussed
in Section 12.7.1, some T-90 process configuration features require updates to the standard
components:
● Stripping section tray temperature TI203 PV is a high-level A/I measurement, and thus validation
is not necessary.
● Ratio controller RC203 maintains and controls the total duty (mid-reboiler+reboiler)/feed ratio,
not the reboiler duty/feed ratio.
● Mid-reboiler duty (QI233), reboiler duty (QC203) and total reboiler duty (QC213) all must be
managed; QI233, QC203, and QC213 calculations are all discussed below.
● E-93 reboiler duty controller, QC203, outputs to three-way valve TV203,16 and is thus an ultimate
secondary. Therefore, QC203 must be configured as a PID controller.
● The dynamic response of AI91 PV at T-95’s overhead to T-90 reboiler duty control adjustments
will be slow and include a long deadtime. Thus, AC91 (C2 in C3 controller) will almost certainly
be model-based, with model update via the validated analyzer measurement (AIV91 PV). How￾ever, even if model-based, because of the slow dynamic responses and long deadtimes, effective
closed-loop C2 in C3 control performance will be difficult to achieve.
16 Because the DCS handles TV203’s failure mode via an AO block, with a configured output direction (Direct or
Reverse) external to the QC203 OP calculation, QC203’s control direction (Reverse) can be configured independent
of the valve’s failure mode. A detailed discussion of control direction, failure mode and output direction for
three-way valves is presented in Section 10.2.1, Figure 10.6 through 10.9.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License468 12 Tower Product Quality Controls
If the long deadtime in the AI91 PV – QC203 SP response dynamics cannot be managed well, and
control performance degrades, model-based controller AC91 can be eliminated from the control
strategy in Figure 12.38, and C2 in C3 control can instead be achieved inferentially by control￾ling T-90’s stripping section tray temperature, TC203, at an offline calculated set point. Other than
the elimination AC91 and the analyzer measurement’s validation (AIV91), the control strategy in
Figure 12.38 is unchanged.17
Other than the management of both the mid-reboiler and reboiler duties, the control strategy
design issues associated with the control components in Figure 12.38 have already been presented
and discussed in Section 12.7.1. The mid-reboiler and reboiler duties are each calculated using
Equation (3.14) in Section 3.7.1, with their hot side inlet and outlet temperatures and heating
medium flow rate substituted:
E − 92 duty ∶ QI233 PV = Scale1 ∗ FI233 PV ∗ CP ∗ (TIV211 PV − TIV212 PV) (12.15a)
E − 93 duty ∶ QC203 PV = Scale2 ∗ FI102 PV ∗ CP ∗ (TIV28 PV − TIV27 PV) (12.15b)
The total heat input is the sum of the two individual heat duties:
Total heat input ∶ QC213 PV = QI233 PV + QC203 PV (12.16)
Ratio controller RC203 calculates and resets QC213’s set point – the desired total heat input,
QC213 SP. QC213’s control algorithm is not a PID but is an arithmetic calculation. As indicated in
Equation (12.17) below, the current value of the mid-reboiler’s duty, QI233 PV, is subtracted from
the desired total heat input – QC213 SP calculated by ratio controller RC203, to obtain the desired
E-93 reboiler duty, QC203 SP:
Desired E − 93 duty ∶ QC203 SP = QC213 SP − QI233 PV (12.17)
Note that as long as QC213 SP is used in the calculation of QC203 SP (in Equation (12.17), QC213’s
PV, calculated as the sum in Equation (12.16), is for display only since it does not impact the control
calculation in Equation (12.17).
Because both reboiler heating medium flows are used in the duty calculations in Equations
(12.15a), (12.15b) through (12.17), user provided custom logic must be added to ensure (i) the feed￾back control loop remains operational when either flow becomes unavailable and (ii) the full feed￾back/feedforward cascade returns on control bumplessly when either flow measurement becomes
available after being unavailable.
In addition, since FI233 is uncontrolled, if FI233 PV is noisy, its noise will be propagated first to
the calculation of the mid-reboiler duty, QI233 PV, in Equation (12.15a), then to the calculation of
the desired E-93 reboiler duty, QC203 SP, in Equation (12.17), and eventually to three-way valve
TV203. Likewise, since FI102 is uncontrolled, if the FI102 PV is noisy, its noise will be propagated
to the calculation of reboiler E-93 duty, QI203 PV, and because QC203 is a PID controller, to the
three-way valve TV203. Therefore, filtering either or both may be necessary to help reduce the
impact of noise on control performance. Also, remember, if filtering is needed, the filters must be
added before QC203 is tuned.
Finally, with no degree of freedom available to manage fractionation, tower fractionation is deter￾mined as either C2 in C3 control or limiting C3 in fuel gas strategies achieve their control objective.
17 If instead of controlling C2 in C3, C3 losses to fuel gas are to be minimized, then the rectifying section’s tray
temperature measurement (TI201 PV), instead of the stripping section’s tray temperature TI203 PV, is controlled (by
temperature controller TC201) and maintained at a PTS offline calculated set point value. If the intent is to
minimize C3 losses to fuel gas, all control components located below temperature controller TC203 in Figure 12.38
would be placed below temperature controller TC201: TC201 → RC203 → QC213 → QC203 → TV203.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.9 Two-product Towers – Conventional Advanced Control Application Examples 469
PC
67
T
8
0
E-73
FC
67
TI
61
TI
62
LC
60
FC
62
FC
69
TI
73
AI
86
Reformer
effluent
Naphtha
debutanizer
(DeC4)
To naphtha
splitter
% nC4
(RVP)
From DeC2
(T-90) bottoms
D-75 LC
59
FC
63
To amine
scrubber
E-71
FI
66
TC
63
TI
64
H2S, C4–
TI
75
LV59
PV67
To amine
scrubber and
C3/C4 splitter
∞
Figure 12.39 Crude Light-ends Section’s Naphtha Debutanizer (T-80) Configuration
DeC4 Tower (T-80) Conventional Advanced Controls
The DeC4 tower’s process configuration and instrument details are presented in Figure 12.39.
Reflux drum D-75’s level, LC59, is paired with T-80’s distillate flow – via valve LV59, the tower’s
pressure, PC67, is paired with the reflux drum’s vapor off-gas flow – via valve PV67, and T-80’s
bottoms level, LC60 is paired with bottoms flow, FC62. Referring to Table 12.2, the two remaining
degrees of freedom available for product quality control and fractionation management are
reboiler E-73 duty and reflux flow, FC63. Referring to Table 12.5, if both product qualities are to be
controlled, the two MVs, E-73 duty and reflux flow, can be used to (i) control nC4 (inferring RVP)
in DeC4 bottoms and (ii) control C5 in DeC4 overhead. If both products are controlled, C5 in the
DeC4 overhead would most likely be paired with reflux flow (illustrated in Figure 12.26 in Section
12.7.3), and nC4 in DeC4 bottoms would be paired with reboiler duty (illustrated in Figure 12.23 in
Section 12.7.1). If only one product quality is controlled, one MV can control either nC4 in DeC4
bottoms or C5 in DeC4 overhead, while the other manages fractionation.
Refer to Figure 12.36 – any nC4 at the DeC4’s bottoms is removed with the LVN at the naphtha
splitter’s overhead. Thus, maximizing DeC4’s bottoms nC4 upgrades nC4, which would otherwise Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License470 12 Tower Product Quality Controls
be in T-80’s overhead and be routed to the less valuable butane (T-95 bottoms) product, to more
valuable LVN. However, to avoid violating an LVN maximum allowable RVP constraint, there is
a maximum allowable nC4 content in LVN. This then establishes a max limit for nC4 content in
DeC4 bottoms.
Again, refer to Figure 12.36 – any C5 at the DeC4’s overhead is removed in the C4 product at the
C3/C4 splitter’s (T-95) bottoms. Thus, control of the DeC4’s overhead C5 content reduces the down￾grading of C5 product from LVN (T-85 overhead) to less valuable butane (T-95 bottoms). However,
the DeC4 overhead’s C5 content is typically less important than the DeC4’s bottoms nC4 content
and is often not controlled. If only nC4 in DeC4’s bottoms is controlled, this makes one of the two
remaining degrees of freedom – reboiler duty or reflux flow, available to manage T-80 fractionation.
Figure 12.40 illustrates the conventional advanced control strategy that pairs the validated T-80
bottoms nC4 content’s measurement (AI86 PV) with the reboiler duty. This leaves reflux flow, FC63,
available to manage T-80 fractionation. The control strategy in Figure 12.40 is comprised of the
advanced control components in Figure 12.23 and discussed in Section 12.7.1 for a product quality
control strategy that manipulates reboiler duty. From the discussion in Section 12.7.1, the strategy
in Figure 12.40 is a simple cascade and cascade initialization and wind-up are both handled by
standard DCS feature.
Notice that T-80’s overhead condenser, E-71, is air-cooled, and thus TC63 may become wound-up
high when ambient temperatures are high; if so, E-71 duty is then limited high. When E-71 duty is
limited high, pressure controller PC67 may also become wound-up high; if so, pressure will float
on tower conditions and may become erratic. This is why the tray temperature measurement in
Figure 12.40 (TI73 PV) is pressure compensated before it becomes TC73’s PV input. Although
AC86 feedback will eventually correct for these pressure variations, pressure compensation of TI73
PV provides feedforward adjustments for these pressure upsets and limits their impact on tower
operations.
FC
69
TI
73
FCG69
TC73
RC67
Dynamic
compensation
Validation
SP
SP
E-73 duty/
feed
Pressure
compensated
tray
temperature
AI
86 AC86 AIV86
Desired Btms nC4
SP
Btms
nC4 Ctl
PC
67
SP TI
61
TI
62
TIV61
TIV62
QC67 Validation
SP
FC
67
Reformer
effluent
to E-73
E-73
duty
Tray
temperature
Ovhd
pressure
Btms
nC4
Feed
flow
E-73 hot fluid
temp in
E-73 hot fluid
temp out
Figure 12.40 Naphtha Debutanizer Bottoms nC4 Control, MV = Reboiler Duty
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.9 Two-product Towers – Conventional Advanced Control Application Examples 471
The important control strategy design issues that must be managed by the components in
Figure 12.40 are the same as those listed for the bottoms product quality control strategy appearing
in Figure 12.23 in Section 12.7.1. However, there is one additional issue – the decision to either
use the pressure measurement (PC67 PV) or the pressure set point (PC67 SP) in the pressure
compensation calculation. Pressure measurements are almost always noisy. To minimize noise
propagation, PC67 SP is normally preferred; however, since PC67 is not a secondary, and almost
certainly has been configured with SPInit = No, it is necessary to reconfigure PC67 for SPInit = Yes
to ensure the value used for pressure compensation is still meaningful when PC67 is in Manual
mode. If the PC67 SP value is an offline specified operating guideline, then PC67 should be con￾figured for set point ramping to enable a slow return to its guideline set point, without a process
upset, when PC67 is transferred to Auto mode.
Note: Custom logic must be added to use PC67 PV in the pressure compensation calculation if
PC67 is wound-up and in Auto. PC67 may become wound-up high when increasing ambient tem￾peratures drive E-71 to its high duty limit, and TC63 becomes wound-up high.
The conventional advanced control strategy that manages T-80 fractionation by manipulating
reflux flow FC63 is shown in Figure 12.41. The management of fractionation using reflux flow was
presented and discussed in Section 12.7.2. The cascade structure and advanced control components
that make up the control strategy in Figure 12.41 are the same as the components/cascade structure
presented in Figure 12.24 in Section 12.7.2; design issues that must be managed by the components
in Figure 12.41 are the same as those listed for the previously discussed strategy in Section 12.7.2
and Figure 12.24. However, there is one additional issue – T-80’s reflux temperature (TC63) is con￾trolled, and thus the decision must be made to either use the reflux temperature measurement
(TC63 PV) or its set point (TC63 SP) in the internal reflux flow’s (FC64 PV) calculation.
The best choice is normally TC63 SP, to minimize propagation of temperature measurement noise
to the internal reflux flow calculation FC64 PV, the external reflux flow’s set point, FC63 SP, and
ultimately the external reflux flow, FC63 PV. However, like PC67 in Figure 12.40, it is necessary to
reconfigure TC63 for SPInit = Yes to ensure TC63 SP is meaningful when TC63 is in Manual mode.
FC
69 RC63
Internal
reflux/feed
ratio
SP
Desired internal
reflux/feed ratio
FC
63
External
reflux return
to T-80
TC
63
TI
64
FC64
TI64TYP
SP
SP
Internal reflux
calculation and
control
Typical value
Ovhd temperature
Reflux
temperature
Feed
flow
Ovhd
temperature
Figure 12.41 Naphtha Debutanizer Fractionation Management, MV = Reflux Flow
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License472 12 Tower Product Quality Controls
If the TC63 SP value is an offline specified operating guideline, then TC63 should be configured for
set point ramping to enable a slow return to the guideline set point, without a process upset, when
TC63 is transferred to Auto mode. Custom logic must also be added to use TC63 PV in the internal
reflux calculation when TC63 is wound-up high – when high ambient temperatures drive E-71 to
its high duty limit and TC63 into wind-up (high).
RC63 SP is calculated offline periodically to either reduce reboiler E-73 duty or maintain the
C5 content at the DeC4’s overhead within acceptable limits while the DeC4’s bottoms nC4 content
is maintained at target (Figure 12.40). Current business drivers and their associated economics
determines which operating objective would offer the most benefit.
Naphtha Splitter (T-85) Conventional Advanced Controls
The Naphtha Splitter (T-85) tower’s process configuration and instrument details are presented in
Figure 12.42. The configuration in Figure 12.42 features a drumless, flooded condenser (E-88), and
as indicated in Figures 12.10 and 12.11 (Section 12.3.4), tower pressure can be paired with either the
distillate flow (Figure 12.10) or reflux flow (Figure 12.11). If pressure is paired with distillate rate,
reflux flow is an available degree of freedom, to either control a product quality or manage fraction￾ation. In Figure 12.42, tower pressure, PC77, is paired with the reflux flow, FC83, and as discussed
in Section 12.3.4, distillate flow FC86 is then an available degree of freedom to control a product
quality. Reboiler duty is then the available degree of freedom to either control a (second) product
quality or manage fractionation. Note that bottoms level, LC80, is paired with the bottoms heavy
virgin naphtha (HVN) flow to storage via LV80, while the flow of HVN to the catalytic reformer,
FC82, is controlled to minimize reactor upsets.
T
8
5
E-89
TI
88
TI
89
LC
80
FC
82
FC
87
TI
87
AI
95
CDU TPA
Naphtha
splitter
HVN to
catalytic reforming
5% Dist
point
TV87
E-88
HVN
storage
TK-941
PC
77
FC
83
FI
89
LV80
From DeC4
(T-80) Btms
CW
LVN to De-iC5,
Isom unit, or
MOGAS blending AI
85
FC
86
C6
Figure 12.42 Crude Light-ends Section’s Naphtha Splitter (T-85) Configuration
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.9 Two-product Towers – Conventional Advanced Control Application Examples 473
Referring to Table 12.5 – the two possible T-85 operating objectives are to (i) upgrade the heavi￾est LVN components in T-85’s overhead to the more valuable bottoms HVN product and (ii) reduce
benzene make in the catalytic reformer and thereby reduce benzene content in the reformate. The
first operating objective is achieved by controlling the bottoms HVN 5% distillation point at an
appropriate target. The second operating objective is important only if reformate (catalytic reformer
effluent) is predominantly used as a MOGAS blend stock. Reformer reactions convert C6 compo￾nents to benzene, which must be below a stringent low limit in the MOGAS product. Therefore,
if reformate is predominantly a MOGAS blend stock, a control strategy that drives the C6 compo￾nents out of T-85’s bottoms product (the reformer feed) and into the LVN is much more important
than a strategy to upgrade LVN to HVN. However, if reformate is predominantly an aromatics plant
feedstock to make benzene, toluene, and xylene products, then upgrading LVN to the HVN product
to maximize reformate is more important than driving the C6 components into LVN.
Referring to Figure 12.42, the LVN C6 content (AI85 PV) and the HVN 5% distillation point (AI95
PV) measurements are both available. However, only one of these product qualities, depending
upon the reformate’s ultimate process destination, needs to be controlled. The tower configura￾tion shown in Figure 12.36 indicates reformate is ultimately routed to the BTX (aromatics) plant.
Thus, the appropriate operating objective for T-85 is to upgrade LVN to HVN in order to maximize
catalytic reformer feed, reformate and thus BTX plant feedstock. To do this, the HVN 5% distilla￾tion point measurement is paired with the distillate rate, and tower fractionation is managed with
reboiler duty. Each strategy is displayed below – in Figures 12.43 (HVN 5% point control) and 12.44
(fractionation management).
The cascade structure and advanced control components that make up the control strategy
in Figure 12.43 are the same as the components/cascade structure presented in the overview
of a product quality control strategy that manipulates distillate rate – see Figure 12.28 (in
Section 12.7.5). The only difference is the use of a stripping section tray temperature, TI87 PV, in the
strategy in Figure 12.43. This is necessary because the HVN 5% distillation point is a bottoms qual￾ity and its control strategy needs a tray temperature sensitive to LK; in Figure 12.28, the distillate
AI
95 AIV95
TC87
AC95
Validation
SP
Desired Btms 5% Pt
SP
Tray
temperature
Btms
5% Dist Pt
TIV87
Validation
SP
FC
87
RC86 Distillate/feed
ratio
Distillate
flow
SP Feed flow
FCG87
Dynamic
compensation
TI
87
FC
86
Figure 12.43 Naphtha Splitter Btms (HVN) 5% Distillation Pt Control, MV = Distillate Flow
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License474 12 Tower Product Quality Controls
FC
87
TIV88
TIV89
QC89
RC89
SP
SP
SP
CDU
TPA
E-89 duty/
feed
E-89
duty
FV89
Desired
duty/feed ratio
Feed
flow
FC
89
Hot side
inlet temp
Hot side
outlet temp
Validation
TI
88
TI
89
Figure 12.44 Naphtha Splitter
Fractionation Management, MV = Reboiler
Duty
product quality’s control strategy needs a tray temperature sensitive to HK. The important control
strategy design issues that must be managed by the components in Figure 12.43 are the same as
those listed for the product quality control strategy in Figure 12.28 and discussed in Section 12.7.5.
The advanced control components included in the fractionation management strategy in
Figure 12.44 are the same advanced control components included in Figure 12.27 (but without
feed flow dynamic compensation) and discussed in Section 12.7.4 for managing tower fractiona￾tion with reboiler duty. Note that all measurements needed to calculate the reboiler duty (QC89)
are available – inlet (TI88 PV) and outlet (TI89 PV) temperatures, and CDU pumparound flow
to E-89 (FI89 PV). The important control strategy design issues that must be managed by the
components in Figure 12.44 are the same as those listed for the fractionation management strategy
in Figure 12.29 and discussed in Section 12.7.4.
The desired duty/feed ratio, RC89 SP, is an offline calculated guideline that provides sufficient
fractionation and either (i) reduces E-89 heat duty while meeting the 5% point’s target or (ii) main￾tains the (measured) C6 content at T-85’s overhead within acceptable limits. A third option, pro￾vided it can be justified (cost of incremental reboiler duty versus value of incremental HVN yield),
would be to increase reboiler duty to increase HVN yield.
Note: The strategies in Figures 12.43 and 12.44 are both simple cascades and cascade initialization
and wind-up are both handled by standard DCS feature.
12.9.2 Alternative Crude Light-ends Section – Catalytic Reformer Feed Debutanizer
(T-542) Controls
The next conventional advanced control strategy discussed is implemented in a catalytic reformer
feed debutanizer tower; its debutanized bottoms product is the catalytic reformer’s feed. Its unit
configuration in this crude light-ends section is shown in Figure 12.45.
Unlike the crude light-ends section shown in Figure 12.36, the naphtha splitter and the DeC4
towers in Figure 12.45 are upstream of the NHF, and they produce the feedstocks for the NHF,
e.g., LVN, DeC4 bottoms, and HVN, naphtha splitter bottoms. After metals, sulfur, and nitrogen
are removed, the NHF effluent is routed to the absorber/stripper tower (T-541), where the C2− Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.9 Two-product Towers – Conventional Advanced Control Application Examples 475
C5, C6 N
H
F
Meet LVN
RVP target
TK-185
T
5
4
1
Absorber/
stripper
To
treat gas
system
C2–
C3+
D-542
E-546
C4–
Reformer
feed DeC4 E-547
E-546
Reformer
C feed 5+
To C3/C4
splitter 
Limit C5
losses
to LPG
TK-184
HVN
Meet HVN
5% point target
C7+
Naphtha
splitter
Debutanizer
(DeC4)
T
5
4
2
∞
Figure 12.45 Alternative Crude Light-ends Section Tower Configuration
components are removed in T-541’s overhead and sent to the treat gas system. T-541 bottoms
(C3+) is feed to the debutanizer tower, T-542. The C4− components in T-542’s feed are removed
as its distillate product, which is routed to the C3/C4 splitter, where C3 and C4 products are sepa￾rated. T-542’s bottoms product (C5+), after preheating in downstream units, becomes the catalytic
reformer’s feed. Because the HVN 5% distillation point target (chosen to satisfy a reformer feed
requirement) is met upstream of the NHF at the naphtha splitter bottoms, T-542’s main operating
objective is to limit the C5 content in its overhead product in order to limit C5 losses to the C3 and C4
products (in LPG).
The DeC4 tower’s process configuration and instrument details are presented in Figure 12.46.
Reflux drum D-542’s level, LC590, is paired with T-542’s distillate flow – via valve LV590, the over￾head pressure, PC570, is paired with D-542’s vapor off gas flow – via valve PV570, and T-542’s
bottoms level, LC556 is paired with bottoms flow – via valve LV556. The two remaining degrees of
freedom available for product quality control and fractionation management are reboiler duty and
reflux flow.
Similar to the DeC2 tower (T-90) in Figure 12.37, T-542 also has a mid-reboiler – E-547, which
supplements reboiler E-546’s heat duty and contributes to the tower’s total heat input. However,
reformer effluent flow to E-547 (FI547 PV) is not controlled and is set by upstream/downstream
processing; thus, FI547 cannot be manipulated to impact T-542’s heat input. Although E-547’s duty
is determined externally, it still contributes to the tower’s total heat input. It therefore impacts
the amount of heat reboiler E-546 must provide to control either a product quality or manage
fractionation. To account for its influence on the tower’s total heat input and thus on reboiler
E-546’s duty, E-547’s duty must be calculated.
There is only one product quality to control – T-542’s overhead product’s C5 content (AI556 PV).
Table 12.2 indicates that T-542’s overhead C5 content would most frequently be paired with reflux Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License476 12 Tower Product Quality Controls
Reformer feed
debutanizer
T
5
4
2
C5 %
FI
556
TI
521
AI
556
TI
512
T-541 Btms
FC
541
LC
556
FI
552
Catalytic reformer
feed (HVN)
FC
546
TI
552
TI
551
Reformer
effluent
E-546
D-542 LC
590
FC
551
PC
570
E-545
TI
510
TC
563
PV570
To TG
system
FI
547
TI
541
TI
542
To C3/C4
splitter 
LV590
LV556
E-547
∞
Figure 12.46 Crude Light-ends Section’s Reformer Feed DeC4 (T-542) Configuration
flow, FC551, with reboiler duty, the remaining degree of freedom, available to manage the tower’s
fractionation. Figure 12.47 presents the conventional advanced control strategy that pairs the vali￾dated T-542 overhead C5 content with the reflux flow.
The advanced control components included in the control strategy in Figure 12.47 are the
advanced control components included in Figure 12.26 and discussed in Section 12.7.3 for a
product quality control strategy that manipulates reflux flow. As indicated in the discussion in
Section 12.7.3, the strategy in Figure 12.26, and thus the strategy in Figure 12.47, is a simple
cascade and cascade initialization and wind-up are both handled by standard DCS feature.
T-542’s overhead condenser, E-545, is air-cooled, and thus E-545’s duty may become limited high
during daylight hours when ambient temperatures are high. When E-545’s duty is limited high,
TC563 will almost certainly be wound-up high, and pressure control may be disrupted or become
erratic, or PC570 may become wound-up high as well. This is why the tray temperature measure￾ment in Figure 12.47 (TI512 PV) is pressure compensated before it becomes TC512’s PV input.
Although AC556 analyzer feedback will eventually correct for these pressure variations, pressure
compensation of TI512 PV provides feedforward adjustments for the pressure upsets and limits
their impact on tower operations.
The important control strategy design issues that must be managed by the advanced control
components in Figure 12.47 are the same as those listed for the product quality control strategy
presented in Figure 12.26 (overhead product quality paired with the reflux flow) and discussed in
Section 12.7.3.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.9 Two-product Towers – Conventional Advanced Control Application Examples 477
FC
541 RC551 FCG541
Dynamic
compensation
Internal reflux/
feed
TI
510
TI
521 TIV521
FC551
Validation
SP
External
reflux flow
Internal reflux
calc & Ctl
TI510TYP
Typical value
Ovhd temperature
SP
Reflux
temperature
Feed rate
Ovhd
temperature
AI
556 AC556 AIV556
Validation
Desired Ovhd C5
SP
Ovhd C5
SP
TC512
Pressure
compensated
tray
temperature
SP TI
512
Tray
temperature TIV512
Validation
PC
570
D-542
pressure
Ovhd C5
control
FC
551
Figure 12.47 Reformer Feed DeC4 Overhead C5 Content Control, MV = Reflux Flow
The conventional advanced control strategy that manages T-542 fractionation, by manipulat￾ing reboiler E-546 duty, is displayed in Figure 12.48. The fractionation management strategy in
Figure 12.48 includes the same advanced control components that appear in Figure 12.27 and
are discussed in Section 12.7.4 (fractionation – reboiler duty pairing). Note that all measurements
needed to calculate the mid-reboiler (QI547) and reboiler (QC546) duties are available – inlet (TI541
PV, TI551 PV) and outlet (TI542 PV, TI552 PV) temperatures, and reformer effluent flows to E-547
(FI547 PV) and E-546 (FC546 PV).
Although the advanced control components in Figure 12.48 were discussed in Section 12.7.4,
similar to T-90, T-542’s mid-reboiler E-547’s impact on reboiler E-546’s duty adjustments make a
few standard component updates necessary:
● Ratio controller RC546 maintains and controls the total heat input (mid-reboiler+reboiler)/feed
ratio, not the reboiler duty/feed ratio.
● Mid-reboiler duty (QI547), reboiler duty (QC546) and total heat input (QC576) must be man￾aged. As described below, QI547, QC546 and QC576 calculations are managed in the same way
as mid-reboiler, reboiler and total reboiler duties in the DeC2 (T-90) C2 in C3 control strategy
discussed earlier and illustrated in Figure 12.38.
Other than the two items above the important control strategy design issues that must be man￾aged by the advanced control components in Figure 12.48 are the same as those listed for the
fractionation management strategy in Figure 12.27 and discussed in Section 12.7.4.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License478 12 Tower Product Quality Controls
TI
551
TI
552
FC
541
TIV551
TIV552
QC546
RC546
Validation
Validation
SP
SP
SP
Reformer effluent
from E-546
Total
heat input/feed
E-546
FI duty
547
TI
541
TI
542
TIV541
TIV542
QI547 Validation
E-547
duty
Desired total heat input/feed ratio
QC576
SP
Total
heat input
FC
546
Figure 12.48 Reformer Feed DeC4 Fractionation Management, MV = Reboiler Duty
The mid-reboiler and reboiler duties are each calculated using Equation (3.14) in Chapter 3,
Section 3.7.1:
E − 547 ∶ QI547 PV = Scale1 ∗ FI547 PV ∗ CP ∗ (TIV541 PV − TIV542 PV) (12.18a)
E − 546 ∶ QC546 PV = Scale2 ∗ FC546 PV ∗ CP ∗ (TIV551 PV − TIV552 PV) (12.18b)
The total heat input is the sum of the two individual exchanger heat duties:
Total heat input ∶ QC576 PV = QI547 PV + QC546 PV (12.19)
Ratio controller RC546 calculates and outputs the total heat input requirement – the total heat
input set point, QC576 SP. QC576’s control algorithm is the special, arithmetic calculation given in
Equation (12.20) below. The current value of the mid-reboiler duty, QI547 PV, is subtracted from
the desired total heat input – QC576 SP, to obtain the desired reboiler E-546 duty, QC546 SP:
Desired E − 546 duty ∶ QC546 SP = QC576 SP − QI547 PV (12.20)
As long as QC576 SP (desired total heat input) is used in Equation (12.20) to calculate QC546 SP,
the total heat input PV, QC576 PV, calculated in Equation (12.19) is for display only – QC576 PV is
not included in QC546’s control calculation in Equation (12.20), and has no impact on QC546 SP.
Because E-547’s heating medium flow (FI547 PV) is used in the duty calculations in
Equations (12.18a) through (12.20), user provided custom logic must be added to ensure (i) the
feedback control loop remains operational when FI547 PV becomes unavailable and (ii) the full
feedback/feedforward cascade returns on control bumplessly when FI547 PV becomes available
after being unavailable.
If E-547’s reformer effluent flow, FI547 PV, is a noisy measurement, then its noise will be
propagated first to QI547 PV in Equation (12.18a), then to QC546 SP via QI547 PV’s use in
Equation (12.20), and then to E-546’s reformer effluent flow (FC546) via QC546’s control calcu￾lation. Therefore, to help reduce the impact of noise on control performance, FI547 PV and/or Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.9 Two-product Towers – Conventional Advanced Control Application Examples 479
QI547 PV may need to be filtered. Also, remember, if filtering is needed, and QC546 is configured
with a PID control algorithm, the filters must be added before QC546 is tuned.
The reboiler duty controller QC546 resets FC546, the reformer effluent flow to/from E-546. Thus,
its control algorithm can either be a PID or algebraic. If algebraic, after replacing FC546 PV with
FC546 SP and QC546 PV with QC546 SP in Equation (12.18b), the result is rearranged to solve for
FC546 SP.
The desired total heat input/feed ratio, RC546 SP, is calculated offline periodically to pro￾vide sufficient fractionation and to either (i) lower E-546 heat duty while still meeting the
overhead’s C5 content’s target or (ii) increase bottoms product (HVN) recovery by operating
at higher reboiler duties. The control strategy in Figure 12.48 maintains the desired total
heat input/feed ratio (RC546 SP) constant despite changes in tower feed rate (FC541), and/or
any reformer upsets that impact E-547’s duty (QI547 PV) or E-546’s reformer effluent inlet
temperature (TI551 PV).
12.9.3 Benzene/Toluene/Xylene (BTX) Feed Fractionation Section Tower Controls
The next tower conventional advanced control strategy discussed is implemented in a C8/C9
Splitter (T-675) in a benzene/toluene/xylene (BTX) plant’s feed fractionation section – see
Figure 12.49. A typical BTX plant consists of three major processing areas – feed fractionation,
extraction, and product fractionation. In Figure 12.49, the feed fractionation section’s feed is
stabilized reformate – reformate after C4− components are removed in the reformate light-ends
section.18 Light reformate at the deisohexanizer (T-678) overhead, heavy reformate at the C8/C9
Splitter (T-675) bottoms, and an aromatics rich product at T-675’s overhead are separated. T-675’s
aromatics rich distillate product is sent to the BTX plant’s extraction section, where non-aromatics
are removed via solvent extraction. After final clean-up and removal/recovery of solvent, the
aromatics rich product stream is routed to the product fractionation section, where benzene,
toluene, and xylene products are separated.
The principal operating objective of the deisohexanizer, T-678, is to minimize benzene losses to
the light reformate product, T-678’s overhead. Since benzene is T-678’s HK, minimizing benzene
losses to light reformate also minimizes toluene and xylene (HHK) losses. The most important
operating objective of C8/C9 splitter T-675 is to minimize xylene losses to heavy reformate, T-675’s
bottoms product. Since xylene is T-675’s LK, minimizing xylene losses to heavy reformate also min￾imizes benzene and toluene (LLK) losses.
The focus of this discussion is the C8/C9 Splitter, T-675, and the conventional advanced control
strategy that minimizes the loss of Xylene to the heavy reformate product. T-675’s process
configuration and instrument details are presented in Figure 12.50. T-675’s configuration includes
a drumless, flooded condenser, E-668, and a fired heater reboiler, F-635. For a flooded condenser,
tower pressure is normally paired with either distillate flow or reflux flow (see Section 12.3.4). In
Figure 12.50, tower pressure, PC649, is paired with the distillate flow, FC641. Thus, reflux flow,
FC640, is an available degree of freedom to either control a product quality or manage T-675
fractionation. Fired heater reboilers are rare and are needed only in special cases – when the
vapor boil-up required to maintain sufficient fractionation cannot be supplied by heat transfer
with another process stream in a standard heat exchanger bundle. Reboiler duty, via F-635
duty, is the other degree of freedom available to either control a product quality or manage
fractionation.
18 A typical crude light-ends section tower configuration was presented and discussed in Section 12.9.1 (see
Figure 12.36).
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License480 12 Tower Product Quality Controls
T
6
7
8
Deisohexanizer
Light reformate
to tank
Stabilized
reformate
E-663
AI
606
Steam
Benzene
content
Minimize xylene loss to
heavy reformate
D-651
E-661 CW
Minimize benzene loss
to light reformate
T
6
7
5
Heavy reformate
to tank
AI
675
C8/C9
splitter
F-635
Xylene
content
BTX to aromatics
extraction and
recovery
E-668
Figure 12.49 Benzene/Toluene/Xylene (BTX) Feed Fractionation Section Tower Configuration
There is one product quality to control – the xylene content (AI675 PV) in heavy reformate,
T-675’s bottoms product. Referring to Table 12.2 (Section 12.2.2), T-675’s bottoms xylene content
would most frequently be paired with reboiler duty – the fact that reboiler duty is provided by fired
heater F-635 is irrelevant. With reboiler duty paired with bottoms quality, reflux flow FC640 is the
remaining degree of freedom available to manage fractionation. Figure 12.51 presents the conven￾tional advanced control strategy that pairs T-675’s bottoms xylene content (AI675 PV) with the fired
heater’s (F-635) heat duty.
The control strategy in Figure 12.51 is aligned with the advanced control components in
Figure 12.23 (in Section 12.7.1) for a bottoms product quality paired with reboiler duty. The
advanced control components in Figure 12.51 were presented and discussed in Section 12.7.1.
However, there is one very important difference – the fired heater duty calculation (QC639
PV) in Figure 12.51 versus the typical reboiler duty calculation (Equation (3.14) in Chapter 3,
Section 3.7.1) used in Figure 12.23.
The heat duty or heat fired calculation in Equation (12.21) below corresponds to Equation (10.10)
in Section 10.4.6. The typical heat exchanger reboiler duty calculation in Equation (12.22) below
was defined and discussed in Section 3.7.1:
QF = Scale1 ∗ AIV995 PV ∗ FI633 PV (12.21)
Q = Scale2 ∗ Flow ∗ CP ∗ (Valid TIN − Valid TOUT) (12.22) Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.9 Two-product Towers – Conventional Advanced Control Application Examples 481
T
6
7
5
B/T/X to
aromatics
extraction
F-635
FC
648
Deisohexanizer
bottoms
FC
641
FC
640
TI
644
LC
669
Heavy
reformate
to tank
AI
675
FC
644
TI
634
PC
639
FI
633
AI
995 LHV
Fuel gas
TI
641
E-668
PC
649 CW
Xylene
C8/C9
splitter
Figure 12.50 (BTX) Feed Fractionation Section’s C8/C9 Splitter Configuration
Figure 12.51 C8/C9 Splitter Xylene in
Heavy Reformate Control, MV = Fired
Heater Reboiler
FCG648
TC634
RC639
Dynamic
compensation
SP
SP
SP
F-635 duty/
feed
Tray
temperature
AC675 AIV675
Validation
Desired
xylene content
SP
Xylene in
heavy
reformate
TIV634
Validation
TI
634
AI
675
FC
648
Feed
flow
QC639 AIV995
Validation SP
F-635
duty
Fuel gas
to F-635
PC
639 FI
633
F-635
FG pressure
AI
995
FG
LHV
FG
flow
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License482 12 Tower Product Quality Controls
The exchanger heat duty calculation in Equation (12.22) provides FF corrections for process upsets
that impact the heating medium’s inlet temperature, and under some circumstances, its flow (if
set by upstream or downstream process conditions). Assuming the fuel gas source is the fuel gas
header, the heat fired calculated in Equation (12.21) provides FF corrections for process upsets that
impact the fuel gas header’s composition, and thus the fuel gas heating value, AI995 PV.
Like TIN and TOUT in Equation (12.22), the heating value measurement (AI995 PV) must be
validated before its use in the heat fired calculation. As discussed in Section 10.4.6, heat fired
control must continue when the heating value measurement is not available or is invalid. This
allows the feedback control corrections to continue – COT control in Section 10.4.6, xylene in
heavy reformate in Figure 12.51. Also, when the heating value becomes available or valid again,
the heat fired controller must initialize, allowing the full feedback/feedforward control strategy to
be recommissioned bumplessly. Custom logic and/or code is needed to provide this heat fired con￾trol functionality,19 but since the strategy in Figure 12.51 is a simple cascade, initialization above
the heat fired controller is achieved via standard DCS features.
The control strategy’s ultimate secondary is the fuel gas pressure, PC639. The relationship
between heat fired and fuel gas pressure is not explicit in Equation (12.21); therefore, it cannot
be rearranged to algebraically calculate PC639 SP. Thus, similar to a reboiler duty controller
outputting to a valve, not the heating medium’s flow, QC639 must be configured with a PID
control algorithm.
Important: In tower reboiler service, the fuel gas pressure or fuel gas flow is paired with a tower
control variable (in Figure 12.51, bottoms quality) via the fired heater’s duty. Thus, it is not an
available degree of freedom to control the fired heater’s COT. However, there is normally no need
to control a fired heater’s COT when it is in reboiler service.
The conventional advanced control strategy that manages T-675’s fractionation, by manipulating
reflux flow, FC640, is shown in Figure 12.52. The cascade structure, and advanced control compo￾nents that make up the control strategy in Figure 12.52 are the same as those described previously
RC640
SP
Internal reflux/
feed
Desired
internal reflux/
feed ratio
FC
648
TI641TYP
TIV644
FC641
Validation
SP
External
reflux flow
Internal reflux
calc and Ctl
TI
641
FC
640
TI
644
SP
Typical value
Ovhd temperature
Feed
flow
Figure 12.52 C8/C9 Splitter Fractionation Management, MV = Reflux Flow
19 See discussion of Figure 8.6 in Section 8.8.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.9 Two-product Towers – Conventional Advanced Control Application Examples 483
for the fractionation management strategy discussed in Section 12.7.2 – see Figure 12.24. The con￾trol strategy design issues that must be managed by the components in Figure 12.52 are also the
same as those listed and previously discussed in Section 12.7.2.
The desired internal reflux/feed ratio, RC640 SP, is calculated offline to provide sufficient frac￾tionation to meet the heavy reformate’s xylene content target, or to either lower F-635 duty while
still meeting the heavy reformate xylene content target or to increase the aromatics yield in T-675’s
overhead product by operating at higher F-635 duties.
12.9.4 Benzene/Toluene/Xylene (BTX) Product Fractionation Section Tower Controls
In Section 11.3.2, a control strategy was presented that manages fractionation in the toluene tower
in an aromatics (BTX) plant’s product fractionation section – a typical BTX product fractionation
section configuration is presented Figure 11.22. Referring to Figure 11.22, the product fractiona￾tion section’s feed is an aromatics rich stream recovered from catalytic reformer reactor effluent.
A benzene product, with a toluene in benzene impurity (AI695) target to meet, is separated as a
sidestream in the benzene tower, T-680. The benzene tower’s bottoms product, rich in toluene and
xylene, is feed to the toluene tower, T-685, where an overhead toluene product is separated; the
toluene separated at T-685’s overhead does not have a xylene impurity target. The toluene tower’s
bottoms product is feed to the xylene tower, T-690, where an overhead xylene product is separated,
with a toluene in xylene impurity (AI604) target to meet. Since toluene boils at a lower tempera￾ture than xylene, any toluene in T-685’s bottoms product is removed with the xylene product at
T-690’s overhead. Therefore, T-690 operational adjustments cannot affect the toluene impurity in
its overhead product. Only T-685 operational adjustments can affect the toluene impurity in T-690
overhead’s xylene product.
Although the AI604 measurement is located in T-690’s overhead, it is closely related to the
toluene content of T-685’s bottoms product. Thus, choosing the T-685 MV to pair with AI604 can
be done as if AI604 was measured at T-685’s bottoms. The toluene/xylene tower configuration
shown in Figure 11.23 is repeated below in Figure 12.53 to facilitate the discussion of CV–MV
pairing. Refer to Figure 12.53 – the distillate flow is paired with reflux drum D-675’s level (LC638),
pressure (PC636) is paired with condenser E-574 duty, and bottoms level (LC639) is paired with
bottoms flow (FC632). Therefore, reflux flow (FC631) and reboiler duty (via FC633) are the
available degrees of freedom to control AI604 PV and manage T-685 fractionation. In the last
row of Table 12.2, reboiler duty is most frequently paired with a bottoms product, and if so,
reflux flow then manages fractionation.
Thus, T-685’s operating objective is to maintain the toluene impurity (AI604 PV) in the xylene
product (at T-690 overhead) at a desired target. This section’s focus is on a conventional advanced
control strategy that pairs AI604 PV with T-685’s reboiler duty. The conventional advanced control
strategy that manages T-685 fractionation by manipulating reflux flow, FC631, was presented in
Section 11.3.2 – see the discussion of Figure 11.24.
In Section 12.7.1, manipulating the reboiler duty to control a product quality is discussed, and the
control strategy’s cascade structure is presented in Figure 12.23. A T-690 toluene in xylene (AI604
PV) control strategy that manipulates T-685’s reboiler duty is directly applicable to Figure 12.23’s
cascade structure. Therefore, a toluene in xylene control strategy can be designed by mapping
each control component in Figure 12.23 to the corresponding T-685 and T-690 measurements in
Figure 12.53, with control of T-690’s AI604 PV as the ultimate primary and hot oil flow to reboiler
E-675 (FC633), e.g., reboiler duty, the MV. The toluene in xylene product quality control strategy
that results is presented in Figure 12.54.
The design issues that must be managed by the advanced control components in Figure 12.54,
are the same as those identified for the product quality control strategy overview in Figure 12.23 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License484 12 Tower Product Quality Controls
Benzene
tower Btms
FC
630
T
6
8
5
D-675
E-674
Toluene
product
Toluene
tower
LC
639
LC
638
TI
631
TI
632
FC
631
TI
633
FC
632
E-675
Hot
oil
FC
633
TI
634
TI
635
PC
636
E-678
T
6
9
0
AI
604
Toluene in
xylene
Xylene
product
Xylene
tower
E-679
Hot
oil
Heavy
reformate
AI
605
C9+ in
xylene
LV638
∞
Figure 12.53 Benzene/Toluene/Xylene (BTX) Product Fractionation Section’s Tower Configuration
TI
634
TI
635
TI
633
AIV604
TIV634
TIV635
FIG630
TC633
AC604
QC633
RC633
Dynamic
compensation
Validation
Validation
SP
Desired
toluene in xylene
SP
SP
SP
E-675 duty/
feed
E-675
duty
Tray
temperature
control
Toluene in
xylene
TIV633
Validation
AI
604
FC
630
FC
633
Hot oil
to E-675
SP
Toluene
in xylene
Hot oil
inlet temp
Hot oil
outlet temp
Feed
flow
T-685 tray
temperature
Hot oil
flow
Figure 12.54 Xylene Tower Toluene in Xylene Product Quality Control
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.10 Towers with Sidestream – Conventional Advanced Control Application Examples 485
and discussed in Section 12.7.1. However, even though AI604 control in T-690’s overhead is, from a
product quality perspective, equivalent to controlling a T-685 bottoms quality, there is an important
distinction. Compared to the response of a T-685 bottoms quality, the AI604 PV response at T-690
overhead to T-685’s reboiler duty changes will be very slow, and will contain considerable deadtime.
Thus, AC604 as a model-based controller will almost certainly provide more effective control than
as a PID controller.
12.10 Towers with Sidestream – Conventional Advanced Control
Application Examples
This section presents typical conventional advanced control strategies for the following three tow￾ers, each with a sidestream.
● Naphtha Splitter: Two product qualities controlled (bottoms quality paired with reboiler duty,
distillate product paired with distillate flow), fractionation managed with the SS draw-off flow
● Reformer Stabilizer: Three product qualities controlled (bottoms quality paired with reboiler
duty, one sidestream quality paired with SS draw-off, and a second sidestream product qual￾ity paired with overhead condenser), while managing fractionation with a sidestream product
quality control strategy override
● Benzene Tower (BTX Product Fractionation Section): Side stream product quality controlled by
manipulating sidestream draw-off flow, while managing fractionation with reboiler duty.
12.10.1 Crude Light-ends Section Naphtha Splitter Controls
The CDU’s overhead distillate product (virgin naphtha) is sent to the NHF where metals, sulfur,
and nitrogen are removed. The NHF reactor effluent is then routed to the crude light-ends section
where the NHF effluent’s remaining lighter components are separated. A crude light-ends section
normally contains a DeC2, DeC4, a naphtha splitter and a C3/C4 splitter – a typical unit configu￾ration was presented and discussed in Section 12.9.1 (see Figure 12.36). This section’s focus is on
a naphtha splitter (T-108) that features a sidestream LVN product – its configuration is presented,
with instrument details, in Figure 12.55.
T-108’s distillate product is routed to a deisopentanizer (De-iC5) tower, where iC5 is removed
in the overhead, making the De-iC5’s bottoms product (mostly n-C5) a more suitable isomeriza￾tion unit feedstock. T-108’s sidestream product, LVN, is also an isomerization unit feed, or it can
be a MOGAS blend component. T-108’s bottoms product, HVN, is a catalytic reformer unit feed,
although some HVN is normally routed to tankage for use as a MOGAS blend stock.
T-108’s operating objectives are (i) to upgrade the heaviest components (C6) in the LVN
sidestream product to the more valuable HVN bottoms product and (ii) to maintain a target over￾head iC5 content to minimize the iC5 content in the LVN product. The first operating objective is
achieved by controlling the bottoms HVN 5% distillation point (AI115 PV) at an offline calculated
target. The second operating objective is achieved by meeting an offline calculated iC5 content
(AI116 PV) target for the overhead product flow (FC106) to the De-iC5.
T-108’s configuration includes a drumless, flooded condenser E-108; consequently, the tower
pressure PC107 is paired with the reflux flow via valve PV107. Bottoms level LV100 is paired with
the bottoms flow via valve LV100. Referring to Table 12.4, the three remaining degrees of freedom
available for product quality control and fractionation management are distillate flow rate (FC106),
sidestream draw-off flow (FC119) and reboiler duty (via valve TV117).
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License486 12 Tower Product Quality Controls
PV107
T
1
0
8
PC
107
FI
103
LC
100
FI
107
TI
117
Naphtha
splitter
C5- to
De-iC5
CW
FC
106
E-108
TI
112
TI
111
FC
119
LVN to Isom
unit or MOGAS
AI
116
iC5
content
DeC4
Btms
E-119
FI
112
AI
115
HVN to reforming
or MOGAS 
5% Dist
point
LV100
TI
118
TI
119
CDU
TPA
FI
117
TV117
Figure 12.55 A Crude Light-ends Section’s Naphtha Splitter (T-108), with LVN Sidestream Configuration
As indicated in Table 12.4, bottoms quality is most frequently paired with reboiler duty.
Figure 12.56 shows the conventional advanced control strategy that pairs the validated T-108
bottoms 5% distillation point (AI115 PV) with the reboiler duty (via valve TV117). The advanced
control components that make-up the control strategy in Figure 12.56 are identical to the standard
advanced control components in Figure 12.23 and discussed in Section 12.7.1 for a product quality
control strategy that manipulates reboiler duty. From the discussion in Section 12.7.1, the strategy
in Figure 12.56 is a simple cascade and cascade initialization and wind-up are both managed by
standard DCS feature.
The important control strategy design issues that must be managed by the components in
Figure 12.56 are the same as those listed for the overview discussion of the bottoms product
quality control strategy in Figure 12.23 in Section 12.7.1. Remember: Because the reboiler
E-119 duty controller QC117 outputs to three-way valve TV117, it must be configured as a PID
controller.
Table 12.4 indicates distillate quality is most frequently paired with reflux flow. However, in
Figure 12.55, T-108’s overhead includes a drumless condenser, and the designers paired overhead
pressure with reflux. But Table 12.4 also indicates the distillate quality is sometimes paired with
the distillate flow. Figure 12.57 illustrates the conventional advanced control strategy that pairs the
validated T-108 distillate product’s iC5 content (AI116 PV) with the distillate flow rate (FC106). The
control strategy in Figure 12.57 is comprised of the advanced control components in Figure 12.28
and discussed in Section 12.7.5 for a product quality control strategy that manipulates distillate
flow. The strategy in Figure 12.57 is a simple cascade and cascade initialization and wind-up are
both handled by standard DCS feature.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.10 Towers with Sidestream – Conventional Advanced Control Application Examples 487
Figure 12.56 Naphtha Splitter Bottoms
Product 5% Dist Point Control, MV = Reboiler
Duty
FI
107
AI
115 AIV115
FIG117
AC115
RC117
Dynamic
compensation
Validation SP
Desired 5% Pt
SP
SP
E-119 duty/
feed
Btms
5% Dist Pt
control
TI
117 TC117 Tray
temperature TIV117
Validation
TI
118
TI
119
TIV118
TIV119
QC117 Validation
SP
E-119
duty
FI
117
CDU TPA
TV117
Ovhd iC5
control AC116 AIV116
Desired Ovhd iC5
SP
SP Validation
iC5
FI
107
RC106 Distillate/
feed
C5- to
De-iC5
FC
106
Distillate
flow
SP
Feed
rate
FIG106
Dynamic
compensation
AI
116
Figure 12.57 Naphtha Splitter iC5 Content in Distillate Product Control, MV = Distillate Flow
The important control strategy design issues that must be managed by the components in
Figure 12.57 are the same as those listed for the overview discussion of the distillate product
quality control strategy appearing in Figure 12.28 in Section 12.7.5.
Finally, with sidestream draw-off the only remaining degree of freedom, Figure 12.58 illustrates
the conventional advanced control strategy that manages tower fractionation by manipulating the
sidestream draw-off flow, FC119. As the external reflux flow (FI103 PV) is changed by PC107’s con￾trol adjustments, RC119 adjusts FC119 to maintain internal reflux below the draw-off tray above its
desired minimum value. The control strategy in Figure 12.58 is comprised of the advanced control
components in Figure 12.30 and discussed in Section 12.8.3 for managing fractionation with the
sidestream draw-off. The strategy in Figure 12.58 is a simple cascade and cascade initialization and
wind-up are both handled by standard DCS feature.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License488 12 Tower Product Quality Controls
FC
119 FI
103
RC119
Side stream
flow
SS D/O (LVN)
Desired SS/IR1
SP
SP
Validation
Reflux
flow
TI
112 TIV112
FI111
Internal reflux
(IR1) calculation
TI
111
Typical value
Ovhd temperature
TI111TYP
SS/IR1
control
Reflux
temperature
Figure 12.58 Naphtha Splitter Fractionation Management, MV = Sidestream Flow
The important control strategy design issues that must be managed by the components in
Figure 12.58 are the same as those listed for Figure 12.30’s fractionation management control
strategy in Section 12.8.3.
12.10.2 Reformer Light-ends Section Reformate Stabilizer Controls
In Section 12.9.2, control strategies for the reformer feed DeC4 tower (T-542), in the alternative
crude light-ends section displayed in Figure 12.45, were discussed. Referring to Figure 12.45,
T-542’s overhead distillate product is routed to the reformer light-ends section – shown in
Figure 12.59 below, where it becomes one of the Reformate Stabilizer tower’s (T-543) feed streams.
Again, referring to Figure 12.45, T-542’s bottoms product is the catalytic reforming unit’s feed, and
as shown in Figure 12.59 below, the catalytic reformer’s effluent (unstabilized reformate) is routed
to the reformate light-ends section and becomes T-543’s other feed stream.
The unstabilized reformate’s C2− components are removed in T-543’s vapor distillate product,
which is routed to the treat gas system (via the Absorber/Stripper T-541 shown in Figure 12.45,
Section 12.9.2). T-543’s reflux (note there is no liquid distillate product) between the overhead and
sidestream is designed to maximize removal of the C2− components in the overhead vapor. T-543’s
liquid sidestream product is predominantly C4− components routed to the C3/C4 Splitter (T-544)
where C3 and C4 products are separated. T-543’s bottoms product is the stabilized reformate, sent
to tankage to become either an aromatics (BTX) plant feedstock, or a MOGAS blend stock.
T-543’s operating objectives are to (i) limit the C2− content in LPG (C3 product), (ii) minimize
the C5 losses to LPG (C4 product), and (iii) either help avoid RVP giveaway in MOGAS blending or
improve the stabilized reformate’s suitability as an aromatics plant’s feedstock. The first operating
objective is achieved by controlling the sidestream product’s C2− content (AI417 PV) at an offline
specified target. The second operating objective is achieved by controlling the sidestream product’s
C5+ content (AI416 PV) at its offline specified target. The last operating objective is achieved by
controlling the stabilized reformate’s (T-543 bottoms) RVP (AI415 PV) at its offline specified target.
To achieve these three control objectives, tower fractionation must be managed to ensure there is
sufficient internal reflux below and above the draw-off tray for proper separations.
The Reformate Stabilizer T-543’s process configuration and its instrument details are presented
in Figure 12.60. Reflux drum D-544’s level, LC490, is paired with T-543’s reflux flow, FC451, the
tower’s pressure, PC470, is paired with the reflux drum’s vapor off-gas flow – via valve PV470, and
T-543’s bottoms level, LC400 is paired with bottoms flow – via valve LV400. Referring to Table 12.4, Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.10 Towers with Sidestream – Conventional Advanced Control Application Examples 489
T
5
4
3
T
5
4
4
D-540
TK-144
BTX feed or
MOGAS blending
C4
product
C3
product
C3/C4
splitter
Catalytic
reforming
Unstabilized
reformate
D-544
Stabilized
reformate
E-516
E-544
E-549
E-542
Reformate
stabilizer
Minimize
C5 + loss
to LPG
TK-140
TK-141
To treat gas
system
From
T-542 Btms
Meet MOGAS or BTX feed
RVP requirements
C5+
content
C2–
content
AI
416
AI
417
AI
415
RVP
From T-542
Ovhd
∞
∞
Limit C2–
in LPG
Figure 12.59 Reformer Light-ends Section Tower Configuration
the three remaining degrees of freedom available for product quality control and fractionation man￾agement are reboiler E-516 duty – via TV427, sidestream draw-off flow, FC419, and condenser E-544
duty – via TC407. There are three product qualities that must be controlled to achieve T-543’s oper￾ating objectives – the sidestream’s C2− content, AI417 PV, the sidestream’s C5+ content, AI416 PV,
and the bottoms product’s RVP, AI415 PV.
Referring to Table 12.4, the bottoms product’s RVP measurement would most frequently be
paired with reboiler E-516 duty, the sidestream’s C5+ content (the sidestream’s back-end) would
most often be paired with the sidestream flow rate, and thus the sidestream’s C2− content (the
sidestream’s front-end) would be paired with condenser E-544 duty. Although Table 12.4 indicates
a sidestream quality, in this case its C2− content, is rarely paired with condenser duty, with no
distillate flow, it is the only degree of freedom remaining.
With the three CVs and three MVs paired as above, if fractionation management is needed, it
will require a product quality control strategy override. The ultimate decision as to which prod￾uct quality control to override depends upon which product is most valuable, and which product’s
quality is the most difficult to measure, infer or control. For T-543, its bottoms product, the stabi￾lized reformate, is most likely T-543’s most valuable product – especially if it is an aromatics plant
feedstock. Thus, the stabilized reformate’s RVP is the most important specification to satisfy, and
the last choice to override.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License490 12 Tower Product Quality Controls
Reformate
stabilizer
To
Abs/stripper
(T-541)
T
5
4
3
LC
400
FI
407
FC
406
TI
412
TI
411
D-544
PC
470 E-544
TI
427
TC
407
To C3/C4 splitter
(T-544)
C5+
content
C2–
content
AI
416
AI
417
LC
490
PV470
E-516
Reformer
effluent TV427
TI
418
RVP
TI
419
FI
425
FI
412
AI
415
TK-444 Stabilized
reformate
LV400
Unstabilized
reformate
From
T-542
Ovhd
FC
419
FC
451
∞
Figure 12.60 Reformer Light-ends Section’s Reformate Stabilizer (T-543) Configuration
Figure 12.61 presents the conventional advanced control strategy that pairs the validated T-543
bottoms product RVP measurement (AI415 PV) with the reboiler duty QC427 via reformate
effluent flow FC427. The advanced control components that make-up the control strategy in
Figure 12.61 are identical to the standard advanced control components in Figure 12.23 and
discussed in Section 12.7.1 for a product quality control strategy that manipulates reboiler duty.
The strategy in Figure 12.61 is a simple cascade and cascade initialization and wind-up are both
handled by standard DCS feature. The important control strategy design issues that must be
managed by the advanced control components in Figure 12.61 are the same as those listed for the
overview discussion of the bottoms product quality control strategy appearing in Figure 12.23 in
Section 12.7.1.
Figure 12.62 illustrates the conventional advanced control strategy that pairs the T-543’s
validated sidestream product C2− content (AI417 PV) with condenser E-544 duty (via TC407).
The control strategy in Figure 12.62 has not been included in any of the previous control strategy
overview discussions; however, it is comprised of advanced control components – analyzer
validation, analyzer feedback control, and temperature control that are common to all previously
discussed control strategies in Sections 12.7 and 12.8. Thus, there are no additional advanced
control component or control strategy design issues associated with this strategy. Note again that Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.10 Towers with Sidestream – Conventional Advanced Control Application Examples 491
FI
407
TI
427
AI
415 AIV415
FIG407
TC427
AC415
RC427
Validation
SP
Desired RVP
SP
SP
E-516 duty/
feed
Tray
temperature
Reformate
RVP
TIV427
Validation
FC
406
SP TI
418
TI
419
TIV418
TIV419
QC427
Validation
E-516
duty
Reformate
effluent flow
from E-516
TV427
SP
FC
427
Summation, dynamic
compensation
Figure 12.61 Reformate Stabilizer Bottoms Product RVP Control, MV = Reboiler Duty
TC
407
Side stream
C2–
control
AC417 AIV417
E-544 outlet
temperature
Desired
side stream C2–
SP
SP
Validation Side stream
C2–
E-544
T-543 Ovhd
to D-544
AI
417
∞
Figure 12.62 Reformate Stabilizer Sidestream C2− Content Control, MV = Condenser Duty
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License492 12 Tower Product Quality Controls
the strategy in Figure 12.62 is a simple cascade and initialization and wind-up are both managed
by standard DCS feature.
With three product qualities being controlled (bottoms RVP, sidestream C2− and sidestream C5+),
there is no degree of freedom available to manage fractionation. However, if insufficient internal
reflux and fractionation becomes problematic and must be managed, a product quality control
strategy override is needed.
Note that in Figure 12.60, the overhead condenser E-544 is air cooled; thus, its ability to meet the
duty required to satisfy TC407’s set point is affected by the ambient air temperature. Thus, during
daytime hours, especially during the warmer months of the year, E-544’s duty may become limited
high as ambient temperatures rise. With E-544 duty limited high, TC407 becomes wound-up high,
overhead condensation is reduced, reflux drum D-544 level (LC490) begins to decrease, LC490’s
control adjustments begin to reduce external reflux flow (FC451 SP), and as a result, internal reflux
(IR1 PV) also begins to decrease. If this continues, fractionation is adversely affected, and the SS
PV/IR1 PV ratio can increase (because IR1 PV is decreasing) and exceed its maximum desired value.
Thus, for this tower’s configuration, the best corrective approach would be to override the
sidestream C5+ content quality control loop and manage fractionation by manipulating the
sidestream draw-off flow. This is the best approach because (i) T-543’s bottoms product, the sta￾bilized reformate, is T-543’s most valuable product, and thus would be an unwise quality control
loop to override and (ii) increasing reboiler duty or increasing reflux drum D-544 temperature
(TC407 SP) will not increase external reflux (and consequently internal reflux flow) if E-544’s duty
is limited high.
The control strategy in Figure 12.63 is comprised of the advanced control components in
Figure 12.34, discussed in Section 12.8.4, a product quality control strategy that pairs the validated
T-543 sidestream product’s C5+ content (AI416 PV) with the sidestream draw-off flow rate (FC419),
but also includes an override to manage fractionation. The specifics on how a strategy, such as the
strategy presented in Figure 12.63 can control the sidestream’s C5+ content while ensuring there
is sufficient internal reflux to promote normal separation is explained in Section 12.8.4.
The strategy in Figure 12.63 is a complex cascade, and initialization and wind-up must both be
handled with user provided custom code/configuration. When the override is active, RC406’s (the
sidestream product quality’s SS flow/feed ratio controller) wind-up status must be set, and it must
initialize – custom logic is needed to set these statuses. However, standard DCS features will set
the initialization and wind-up statuses of AC416, once RC406’s statuses are resolved via the user
provided custom code.
Adjustments to sidestream flow FC419 directly impact the internal reflux flow below the
sidestream draw-off tray (IR2 PV) but have minimal impact on the internal reflux flow above the
draw-off tray (IR1 PV). However, as discussed in Section 12.8.3 – see Equation (12.11), enforcing
the maximum (SS/IR1) ratio (RC419 SP) in Figure 12.63 maintains the ratio [IR2 PV/IR1 PV]
constant. Remember, the guideline [SS PV/IR1 PV] ratio value is specified to establish target IR2
PV, IR1 PV and SS PV values that provide satisfactory fractionation. Thus, when the override is
active, the control strategy in Figure 12.63 manipulates the sidestream draw-off flow (FC419) to
ensure there is enough internal reflux below the sidestream draw-off tray (IR2 PV) as drum D-544’s
level controller LC490 adjusts T-543’s external reflux flow (FC451) and ultimately changes the
internal reflux flow above the sidestream draw-off tray, FI415 PV. Note that FI415 PV’s role in the
strategy in Figure 12.63 is limited to being RC419’s wild flow input.
Remember: The stabilized reformate is T-543’s most valuable product, and its RVP is T-543’s most
important specification to satisfy. Thus, when inadequate fractionation is detected, the sidestream
override strategy in Figure 12.63 overrides sidestream C5+ control to maintain proper fractionation
and allow reformate RVP control to continue uninterrupted.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.10 Towers with Sidestream – Conventional Advanced Control Application Examples 493
Desired
side stream C5+
Side stream to
C3/C4 splitter
RC406
SP
AI
416
Side stream C5+
control AIV416 AC416
Validation SP
FI
407
FIG406
FC
406
Summation and
dynamic
compensation
FC
419
LSS
SS/feed
ratio control
Total feed
rate
SS/IR1
ratio control
SP
Maximum
SS/IR1 ratio
SP
FI415
Internal reflux
(IR1) calculation
TI
411
TI
412 TIV412
Typical value
Ovhd temperature
TI411TYP
Validation
RC419
Reflux
temperature
FC
Reflux flow 451
FC419 SP
Side stream draw-off flow
to ensure SS/IR1 ratio is below
its maximum allowable value
FC419 SP
Side stream draw-off flow to
maintain C5+ at target
Figure 12.63 Reformate Stabilizer Sidestream Product C5+ Control with Override to Manage Fractionation,
MV = Sidestream Flow
12.10.3 BTX Product Fractionation Section: Benzene Tower Controls
The next tower control strategy discussed is implemented in a BTX plant’s product fractionation
section, the last of the BTX plant’s three processing areas – feed fractionation, extraction, and
product fractionation. The feed fractionation section’s tower configuration was discussed in
Section 12.9.3, and is shown in Figure 12.49. The BTX product fractionation section’s tower
configuration was first presented in Section 11.3.2, and is shown in Figure 11.22 – benzene (in the
benzene tower, T-680), toluene (in the toluene tower, T-685) and xylene (in the xylene tower, T-690)
products are separated. In Section 12.9.4, the focus was on the toluene/xylene tower configuration
within the product fractionation section shown in Figure 12.53. The advanced control strategy
that pairs the xylene tower’s overhead toluene impurity (in the xylene product) with the toluene
tower’s reboiler duty was discussed in Section 12.9.4 and is displayed in Figure 12.54.
The focus of this section is the product fractionation section’s benzene tower, T-680
(in Figure 11.22). The benzene tower’s process configuration with instrument details is pre￾sented in Figure 12.64. T-680’s primary operating objective is to minimize the toluene impurity in
the benzene sidestream product (AI695 PV). This operating objective is achieved by controlling
and maintaining AI695 PV at an offline specified target. Therefore, conventional advanced control
strategies that (i) maintain the sidestream’s toluene in benzene content at target and (ii) manage
T-680’s fractionation, are presented in this section.
Reflux drum D-675’s level, LC628, is paired with T-680’s reflux flow, FC624, the tower’s pressure,
PC635, is paired with condenser E-671 duty and T-680’s bottoms level, LC629 is paired with bottoms
flow – via valve LV629. T-680’s distillate product, FI629, a light hydrocarbon (reformate) stream
returned to the extraction section for further benzene recovery; it is set by upstream/downstream
operations. Note that any FI629 PV changes impact LC628 PV, and via LC628 control adjustments,
reflux flow FC624 PV and ultimately T-680 internal reflux. The two remaining degrees of freedom Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License494 12 Tower Product Quality Controls
T
6
8
0
D-675
From
extraction
section
E-671
LC
628
FC
623
LC
629
Benzene
product
AI
695
Toluene in
benzene
FC
620
FC
624
TI
633 TI
634
PC
635
To extraction
section
FI
629
E-673
Steam
FI
622 To toluene
tower
FC
621
LV629
Figure 12.64 BTX Product Fractionation Section’s Benzene Tower Configuration
available for product quality control and fractionation management are reboiler E-673 duty (via
steam flow FC621) and the sidestream draw-off flow, FC620. Referring to Table 12.4, the sidestream
product’s toluene in benzene measurement (AI695 PV) would almost certainly be paired with
sidestream draw-off flow, leaving reboiler duty to manage T-680’s fractionation.
Figure 12.65 presents the conventional advanced control strategy that pairs the validated T-680
sidestream product’s toluene in benzene measurement (AI695 PV) with the sidestream draw-off
flow, FC620. The advanced control components that make-up the control strategy in Figure 12.65
are identical to the standard advanced control components in Figure 12.29 and discussed in
Section 12.8.2 for a sidestream product quality control strategy that manipulates sidestream
draw-off. The important control strategy design issues that must be managed by the advanced
control components in Figure 12.65 are the same as those listed for the overview discussion of
sidestream product quality control in Section 12.8.2 and illustrated in Figure 12.29.
Figure 12.66 presents the conventional advanced control strategy that manages tower fraction￾ation by manipulating reboiler E-673’s duty via the steam flow, FC621. The components that
make-up the control strategy in Figure 12.66, and the important control strategy design issues
that must be managed by those components, are identical to the standard advanced control com￾ponents in Figure 12.32 and design issues discussed in Section 12.8.3, that manage fractionation
with reboiler duty.
Remember that even though reflux flow, FC624, is controlled and reset by level controller LC628,
internal reflux is not controlled. Therefore, in Figure 12.66, as the sidestream draw-off flow (FC620) Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License12.10 Towers with Sidestream – Conventional Advanced Control Application Examples 495
Toluene in
benzene
control
RC620
AC695 AIV695
SS/feed
ratio control
Desired toluene content
SP
SP Validation
AI
695
Toluene in
benzene
SS D/O
flow
SP
FC
620
FC
623
Feed
rate FIG621
Dynamic
compensation
Figure 12.65 Benzene Tower Toluene in Benzene Product Quality Control, MV = SS Flow
IR1/SS
ratio control RC624
SP
FC
620
Side stream
D/O flow
Desired IR1/SS ratio
FC
623
Feed
rate RC621
E-673
steam/feed
ratio control
SP
E-673
steam rate
FC
621
SP
TI
633
TI
634
FC
624
TIV634
FCZ624
SP
IR calculation
and control
Overhead
temperature
Reflux
temperature
Typical value
Ovhd temperature
TI633TYP
Validation
Reflux
flow
Side stream product
quality control
Figure 12.66 Benzene Tower Fractionation Management, MV = Reboiler Duty
is adjusted by the sidestream product quality control strategy (by RC620 in Figure 12.65), RC624
resets FCZ624 SP, the internal reflux flow controller’s set point. FCZ624 then resets RC621 SP, the
desired steam/feed ratio, which then resets steam flow FC621 SP to impact the vapor boil-up. The
vapor boil-up is condensed in E-671, accumulates in D-675, LC628’s control adjustments change
the external reflux flow, FC624 PV, which ultimately changes internal reflux flow, FCZ624 PV.
Note 1: Steam flow is the ultimate secondary in Figure 12.66 – heat duty control is not necessary.
Note 2: The strategies in Figures 12.65 and 12.66 are simple cascades and initialization and
wind-up are handled by standard DCS features.
Note 3: In Figure 12.66, FCZ624 also responds to reflux flow changes caused by changes in distillate
flow, FI629 PV.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License496 12 Tower Product Quality Controls
References
1 Smith, C.L. (2012). Distillation Control, 18–35. Hoboken, NJ: Wiley.
2 Towler, G. and Sinnott, R. (2013). Chemical Engineering Design, 2e, 825. Oxford and Amsterdam:
Elsevier.
3 Fahim, M.A., Al-Sahhaf, T.A., and Elkilani, A.S. (2010). Fundamentals of Petroleum Refining, 36.
Oxford and Amsterdam: Elsevier.
4 Gary, J.H., Handwerk, G.E., and Kaiser, M.J. (2007). Petroleum Refining: Technology and Eco￾nomics, 5e, 60. Boca Raton, FL: CRC Press.
5 King, M. (2011). Process Control: A Practical Approach, 274. Chichester: Wiley.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License497
13
Fractionator Product Quality Control
CHAPTER CONTENTS
13.1 Fractionator Unit Characteristics
13.1.1 Distillate, Bottoms, and Multiple Sidestream Products
13.1.2 Heat Removal via Multiple Pumparounds
13.1.3 Feed Preheat, Cooling, and Heat Integrations
13.1.4 Bottoms Stripping Steam and Sidestream Steam Strippers
13.1.5 Control Interactions
13.2 Feed True Boiling Point (TBP) Distillation Curve, Cutpoint, and Fractionation
13.2.1 Feed TBP Distillation Curve
13.2.2 Tower Cutpoint
13.2.3 Tower Fractionation
13.3 Crude Distillation Unit, CDU – The Most Important Primary Fractionator
13.3.1 Process Variable Summary
13.3.2 Control Basics and CV–MV Interactions
13.3.3 Overview of Conventional CDU Advanced Product Quality Control
13.3.4 Conventional Energy Conservation (ENCON) Controls
13.3.5 Example CDU Conventional Advanced Control Applications
13.4 Reactor Effluent Product Separation Section Main Fractionators
13.4.1 Gasoil H/F Main Fractionator Gas Oil Sulfur Control and Yield Maximization
13.4.2 FCCU Main Fractionator ICN 95% Point Control, Pumparound Duty Management
The focus of Chapter 12 was the control strategies implemented on towers, both with and with￾out a sidestream, whose feed stocks normally have relatively narrow boiling ranges, and their
operations frequently center on the separation of one or two components – the so-called key com￾ponents. Satisfying a product’s key component impurity target, or a product’s property (e.g., RVP)
closely correlated with a key component (e.g., nC4), are very often operating objectives achieved by
the advanced control strategies described in Chapter 12. These common control strategy designs
are utilized for a wide variety of towers, e.g., DeC2, DeC4, C3/C4 splitters, naphtha splitters, aro￾matics plant benzene, toluene, and xylene product towers. They feature similar cascade structures
with standard control components, which enable the development of site-standard coding, logic,
and implementation practices that reduce required engineering resources and facilitate long-term
maintenance.
In contrast to these tower operations, primary fractionators (e.g., for crude oil fractionation) and
main fractionators (e.g., for reactor effluent fractionation) separate wide-boiling range feeds into
multi-component products based on the boiling point range of the product’s components. Lower
boiling, lighter components are separated in distillate products at the top of the tower, with higher
boiling, heavier components separated further down the tower in sidestream and bottoms products.
Practical Process Control Design with Industrial Applications, First Edition. Alan M. Kugelman.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License498 13 Fractionator Product Quality Control
Each fractionator product has a characteristic boiling point range, but each can also have one or
more desired properties or specifications that must be honored – e.g., initial boiling point, 95%
distillation point, cloud point, sulfur content, and so on.
Primary fractionator sidestream products are typically routed to hydrofining units to remove
sulfur, nitrogen, and metals to prepare them for further processing in downstream conversion units.
Product properties are therefore normally specified to best meet the capabilities of downstream
unit operations and those unit’s product specifications. In contrast, one or more main fraction￾ator sidestream products are typically final products or blend stocks (various distillates and gas
oils – desulfurized diesel and fuel oils), and after stabilization, are sent to product tanks. The prod￾uct properties and specifications that are most important to honor are those associated with the
more valuable draw-offs that are final products or product blend stocks. In both primary and main
fractionators, the individual components in a product are not normally of interest.
Primary and main fractionator units are more complex, interactive, and multivariable than
conventional distillation towers, and their control strategies are likewise more complex, interac￾tive, and multivariable. This chapter will focus on the conventional advanced control strategies
that have historically been implemented in these fractionator units. However, as has already
been mentioned in earlier discussions of a few fractionator control strategy examples,1 these
highly multivariable and interactive units are difficult to control effectively with conventional
control approaches, and multivariable control, e.g., DMC, typically provides more effective
control performance. With today’s widespread penetration of digital control system technology, a
wider-scope DMC – encompassing upstream and downstream process units, is almost always the
most effective approach for primary and main fractionator advanced controls.
This chapter begins with descriptions of the unit characteristics that make fractionator con￾trols more difficult and more complex than Chapter 12’s tower controls. It will be shown that
these common unit characteristics are the root causes of the multivariable and interactive nature
of fractionator controls. The relationship of the feed’s true boiling point (TBP) distillation curve,
the tower’s cutpoint, and the tower’s fractionation to important fractionator process variables is
explained. Their impact on fractionator operations and control, and how they help explain why
fractionator product quality controls are interactive, is described.
Then, for a primary fractionator processing crude oil (e.g., a crude distillation unit, CDU), a pro￾cess variable and basic regulatory control summary, and an overview of its conventional advanced
control strategies, are presented. This control strategy overview provides insight into why a true
multivariable controller such as DMC is a more appropriate technology for fractionator controls.
Specifically, the limitations of applying conventional control methods to the multivariable and
interactive nature of fractionator controls are highlighted. In addition, the potential energy savings
in a CDU are closely coupled with product yields, and in some cases, an online RTO application
is required to correctly assess the impact of these energy-yield tradeoffs. Hence, the conventional
advanced control examples presented and discussed emphasize the limitations of managing the
underlying interactive and multivariable nature of these control strategies. Not many design details
are included because DMC is the preferred control technology, and the extensive heat integrations
and energy-yield linkages can sometimes only be managed with RTO.
Similar concepts apply to main fractionators – the role of the feed’s TBP distillation curve, the
importance of cutpoint and fractionation, and the multivariable and interactive nature of the con￾trols. However, the scope of main fractionator conventional advanced control strategies is usually
somewhat smaller than those encountered in primary fractionator service – for example, main
fractionators frequently have only one sidestream product. Two main fractionator conventional
1 Examples of primary fractionator (CDU) control were discussed in Sections 1.7.6, 4.3.2, and 11.1.1.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.1 Fractionator Unit Characteristics 499
advanced control examples are discussed, again to emphasize the difficulties encountered by
conventional approaches as they manage the underlying interactions and multivariable nature
of these control problems. These examples support the need for a DMC controller whose design
scope includes upstream (e.g., the reactors) and downstream (unsaturated light-ends recovery)
process units.
13.1 Fractionator Unit Characteristics
The process configuration of a primary fractionator processing a crude feed (a CDU) is presented
in Figure 13.1, and the process configuration of a typical reactor effluent cooling and product sep￾aration section’s main fractionator is shown in Figure 13.2. Referring to Figures 13.1 and 13.2, it
is clear that these two fractionator configurations are very similar and share a number of com￾mon unit characteristics – sidestream products, heat removal via pumparounds, sidestream, and
bottoms product steam stripping. The impact of these common characteristics on the conventional
advanced controls needed to satisfy fractionator operating objectives will be demonstrated through￾out this chapter.
CDU products are typically routed to downstream hydrofining units to remove sulfur (as H2S),
nitrogen (as NH3), and metals to prepare them for further processing in downstream conversion
units (e.g., catalytic reforming, isomerization, etc.). However, even though they are often not
final products or blend stocks, overhead distillate, and some sidestream properties are controlled
(e.g., initial boiling point [IBP], 5%, and 95% distillation points, final boiling point [FBP]) in order
to facilitate conversion in downstream units. In contrast to a CDU, at least one or more main
fractionator product streams are typically final products or blend stocks and therefore control of
their quality is especially important. Naphtha boiling range components are removed as a distillate
product or perhaps as a first sidestream product. The more important products are removed as a
sidestream product or blend stock (various distillates and gas oils, including desulfurized diesel
and fuel oils) and/or as a bottoms product or blend stock (fuel oils or heavy diesel).
Figure 13.1 Typical Primary Fractionator
Configuration
To LGO H/F 
To
Naphtha H/F 
To C2 – C4
Recovery
To Kero H/F 
Steam
Steam
SS1
SS2
Top
pumparound
Bottom
pumparound
D
To HGO H/F 
To
VPS
Steam
SS3
B
Crude
feed F
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License500 13 Fractionator Product Quality Control
Top
pumparound
HGO to
fuel oil blending
Gas oil
distillate
Steam
Low sulfur
LGO to
fuel oil blending
Steam
Reactor
effluent 
Off Gas (C4-) to
gas recovery
Bottom
pumparound
Naphtha to
naphtha splitter
Steam
B
D
F
SS1
SS2
Figure 13.2 Typical Reactor Effluent Main
Fractionator Configuration
The common unit characteristics shared by the two fractionators and identified above are dis￾cussed in the next sections and are shown to be the root-cause of the interactive and multivariable
nature of fractionator product quality and energy utilization control strategies.
13.1.1 Distillate, Bottoms, and Multiple Sidestream Products
In addition to distillate and bottoms products, there are multiple sidestream products whose prop￾erties must either be aligned with the capabilities of downstream units and their operations or
must satisfy product specifications. This enlarges the scope of fractionator control strategies – they
must manage multiple control variables and multiple manipulated variables that, as we will see,
interact. As the control problem becomes multivariable – multiple manipulated variables paired
with multiple control variables, the likelihood of control loop interactions increases. It is likely
that adjustments by more than one manipulated variable (MV) will have an impact on a single
control variable (CV), and adjustments of a single MV will have an impact on more than one CV.
Thus, sidestream products, in addition to distillate and bottoms products, make fractionator con￾trol strategies multivariable and interactive.
13.1.2 Heat Removal via Multiple Pumparounds
To provide the external reflux flow and hence the internal reflux necessary to support good fraction￾ation and meet sidestream draw-off flow demands, would require very large overhead condenser
duties, and an unusually large diameter at the top of the fractionator. To normalize the fractionator’s
diameter and condenser duty, but still balance liquid loadings and ensure satisfactory fraction￾ation, substantial amounts of heat are removed using multiple pumparounds. Liquid streams at
high temperatures are removed at several points in the tower, cooled by heat exchange with both
upstream and downstream process streams, and returned to the tower above the pumparound draw
tray at a lower temperature.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.1 Fractionator Unit Characteristics 501
E-16
T-22 reboiler
T-22
tray temperature
control
TC
6
P/A
return
TC
4
TV4
E-15
T-41 reboiler
T-41
tray temperature
control
TV8 TC
8
Upset Sources:
Flow or temperature
Reactor
P/A return feed
temperature
TV6
FC
5
P/A draw-off
flow TI
7
P/A draw-off
temperature
P/A
draw-off FV5
E-17
Feed / P/A
exchanger
Figure 13.3 Typical Reactor Effluent Main Fractionator Pumparound Configuration
Sidestream draw-offs reduce the internal reflux flow below the draw-off tray. The cold pumpa￾round liquid returned to the tower above the pumparound draw-off tray not only increases the
internal reflux below the return point, it also condenses more of the vapor flowing up the tower
to further increase the descending internal reflux. Thus, a pumparound return tray is normally
placed just below a sidestream draw-off tray so that the additional internal reflux generated by the
cold, returned pumparound stream helps offset the internal reflux flow reduction caused by the
sidestream’s draw-off. In this way, fractionation below the sidestream draw-off tray is maintained
at a level that supports the tower’s separation requirements. But note – the additional internal
reflux generated by the cold, returned pumparound stream reduces the volume of vapor rising
in the tower, and thus the fractionation above the pumparound return tray may also be affected.
Thus, fractionation will likely improve below the pumparound return, but it may decline above the
return point.
The pumparound stream is cooled by heat exchange with various colder process streams in
upstream and/or downstream heat exchangers. For a typical primary fractionator processing crude,
pumparound heat is recovered predominately by (i) preheating the crude feed and (ii) utilizing the
pumparound stream as a heat source for downstream light-ends tower reboilers. For a typical reac￾tor effluent’s main fractionator, pumparound heat is recovered predominately by (i) preheating
reactor feed and (ii) utilizing the pumparound stream as a heat source for downstream unsatu￾rated light-ends tower reboilers. For both primary and main fractionators, these heat integrations
capture heat recovery credits. However, process upsets in those upstream/downstream units can
also propagate to the pumparound, cause pumparound heat duty upsets, and ultimately cause frac￾tionator heat balance upsets. Therefore, it is important to manage these upsets to minimize their
impact on fractionator operations.
Common pumparound characteristics are illustrated in Figure 13.3, a typical main fractionator
pumparound (P/A) configuration. The major pumparound process variables are (i) pumparound
draw-off flow FC5 and its control valve FV5, (ii) pumparound draw-off temperature TI7, and (iii)
pumparound return temperature TC6 and its control valve TV6. The duties of downstream reboilers
E-16 and E-15 are set by their light-ends tower’s tray temperature controller – E-16’s duty by T-22
tray temperature control (TC4) and E-15’s duty by T-41 tray temperature control (TC8). E-17, the Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License502 13 Fractionator Product Quality Control
upstream reactor feed/pumparound exchanger’s duty is set by TC6, the pumparound’s return tem￾perature controller. As indicated in Figure 13.3, the main sources of pumparound process upsets are
(i) light-ends tower upsets that impact a reboiler cold side inlet temperature and/or flow and (ii) any
upstream reactor feed upset. Note: Fractionator tower upsets, for example, a feed composition upset,
will also impact the pumparound draw-off temperature, TI7 PV. Thus, any fractionator tower upset
that affects the pumparound draw-off temperature (or composition) is also a pumparound upset
source.
If the major process variables and control hardware identified above and in Figure 13.3 are
measured (TI7 PV, FC5 PV, TC6 PV) and installed (FV5 and TV6), the pumparound duty can be
calculated and controlled by either manipulating the pumparound draw-off flow, FC5 SP, or the
pumparound return temperature, TC6 SP. The pumparound duty is then an available MV to help
offset heat balance upsets, or because of its effect on tower fractionation, to satisfy a control objec￾tive, e.g., a product quality or property requirement. In addition, fractionator control strategies must
ensure that control valves TV6 (pumparound return temperature control) and FV5 (pumparound
draw-off flow) remain in controlling range. Although reboiler bypass valve positions TV4 and TV8
are typically the responsibility of the temperature control strategies implemented in light-ends tow￾ers T-22 and T-41, respectively, it is usually best to ensure pumparound duty controls also avoid
these reboiler limitations.
13.1.3 Feed Preheat, Cooling, and Heat Integrations
As indicated in Section 10.1.3 and illustrated in Figure 10.3, a CDU’s crude feed is preheated by
recovering heat from pumparound and sidestream product streams before it is routed to the fired
heater. The heat recovered upstream of the heater increases the heater’s CIT and thus reduces
the heater’s duty requirements and fuel consumption. With a few exceptions, the process units
upstream of the CDU are heat exchangers. Most importantly, there are no conversion processes
(e.g., reactors) upstream, and thus, assuming crude switches are managed satisfactorily, there are
no important upsets that impact the CDU’s feed composition. As long as the fired heater’s COT
controller performs well, upstream heat exchanger upsets that affect crude temperatures should
have a minor impact on CDU operations.
A crude switch, which typically changes the CDU’s feed composition, is historically the most
significant and most difficult upset managed by conventional CDU advanced control strategies.
However, crude switches are planned and executed slowly over a number of hours, and over
the years, methods have been developed to manage these upsets reasonably well. But note that
crude feed rates are changed regularly, along with or independent of crude switches, as new
daily directives are issued. To help attenuate the effects of these feed rate changes, the reflux,
distillate, sidestream, and pumparound flow rates are normally ratioed to the dynamically com￾pensated crude feed rate. As discussed in Chapter 3, Section 3.4, these ratio controllers provide
feedforward corrections that improve the performance of product quality feedback control loops.
Therefore (and again, assuming crude switches are managed satisfactorily), for the most part, the
upsets that have the most impact on CDUs are those that involve the downstream units that are
heat integrated with pumparound and sidestream product streams. This makes pumparound and
downstream tower reboiler heat duty calculation and control important tools to help stabilize CDU
operations.
As will be discussed in Chapter 14 (Reactor Conversion Control) and as illustrated in Figure
14.19 in Section 14.2.4, a reaction system’s effluent stream is initially cooled as it exchanges heat
with several process streams, including reactor feed, in downstream heat exchangers. As the
reactor effluent is cooled, liquid and vapor products are separated in hot, cold, and/or low-pressure Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.1 Fractionator Unit Characteristics 503
separator drums, and the liquid product separated in each drum contributes to the product
fractionator’s liquid feed stream. After reactor effluent is cooled and processed in separator drums
to split liquid/vapor products, the fractionator’s liquid feed is often preheated, typically by heat
exchange with reactor effluent, before entering the fractionator.
Unlike a CDU’s feed, which for the most part is processed through a series of heat exchangers,
upstream reactor upsets can cause large temperature and composition upsets in the main fraction￾ator’s feed. In addition, the entire reactor effluent cooling and product separation section normally
features significant heat integrations – among reactor effluent, reactor feed, and reactor treat gas
and recycle gas flows. These heat integrations can sustain and amplify temperature upsets, and
ultimately have an important impact on fractionator feed temperature, and, at times, feed com￾position. Exchanger heat duty and either hot fluid or cold fluid outlet temperature controls can
attenuate these temperature upsets, but there is little that can be done to attenuate the feed com￾position upsets – other than, as will be discussed in Chapter 14, implementing effective reactor
conversion controls.
13.1.4 Bottoms Stripping Steam and Sidestream Steam Strippers
Superheated steam is utilized in two instances in fractionator operations: (i) to remove the lightest,
lowest boiling components from sidestream products and (ii) to remove the lowest boiling hydro￾carbon components from the bottoms product.
The liquid sidestream product draw-offs always contain lower boiling components that can
lower a sidestream product’s front-end property, e.g., flash point or 5% distillation point, below a
desired value. Separations on each tray are equilibrium limited, and liquid and vapor leaving each
tray are, in principle, in equilibrium. Thus, as they leave the tray, there are lighter, lower boiling
components in the liquid phase and heavier, higher boiling components in the vapor phase.
Consequently, there are lighter, lower boiling components in the sidestream draw-offs. These
lighter components are removed from each sidestream product by steam stripping in a separate,
stripper column.
Superheated steam is also introduced below the fractionator’s bottom tray, the last of several
trays located below the feed tray. The steam strips from the descending liquid any remaining
lighter, lower boiling components that should have been removed with the lowest sidestream; it
thus keeps these components out of the less valuable bottoms product. Stripping steam lowers
hydrocarbon partial pressure which lowers hydrocarbon boiling points and allows the lower
boiling, lighter hydrocarbon components to vaporize, enter the gas phase, rise in the tower,
condense, and leave with the lowest sidestream product.
Figure 13.4 shows how the fractionator bottoms and sidestream steam stripping are configured.
Note that the steam stripper can be placed upstream or downstream of the hydrofiner (H/F). In
Figure 13.4a, the sidestream draw-off enters at the top of the stripper on stripper bottoms level
control, and steam enters below the stripper’s bottom tray. The steam and stripped light-ends
are returned to the fractionator as a vapor above the sidestream draw-off tray, while the stripper
bottoms, after hydrofining, is the sidestream product. In Figure 13.4b, the sidestream draw off is on
flow control and is first hydrofined before entering the steam stripper at its top; steam and stripped
light ends are returned to the fractionator as vapor, and the stripper bottoms is the sidestream
product.
To reduce steam stripper stripping steam utilization, steam (FC2) to stripper bottoms
(in Figure 13.4, FC1 on left and FC5 on right) ratio control is almost always implemented
(without dynamic compensation) to maintain the ratio constant (see discussion of Figure 11.28
in Section 11.4.2). Without it, operators typically use more steam than necessary, i.e., to provide Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License504 13 Fractionator Product Quality Control
Fractionator
FC
3
Steam
FI
4
LC
1 SS
draw-off
to H/F
SS
stripper
Steam
FV1
FC
1
LV1 FC
2
Fractionator
FC
3
Steam
FI
4
FC
4
SS
stripper
FC
5
LC
1
SS
product
Steam
FV5
FC
2
H/F
Figure 13.4 Fractionator Bottoms, Sidestream Steam Stripper Bottoms, Steam Stripping
enough steam for the entire range of sidestream product flows. This enables operators to shorten
the time they spend monitoring tower operations but wastes steam at all sidestream product flows
below higher expected rates.
If a sidestream product’s front-end property, e.g., the 5% distillation point, is important and is
measured online, it is normally controlled by manipulating the steam stripper’s steam/bottoms
ratio set point (see discussion of Figure 11.29 in Section 11.4.2). Also, if a back-end sidestream
property, e.g., the 95% distillation point, is important and is measured online, it is almost always
controlled by manipulating the sidestream draw-off flow (FC1 SP or FC4 SP in Figure 13.4). How￾ever, the draw-off flow is normally ratioed to the dynamically compensated feed rate and hence the
sidestream draw-off flow/feed ratio is the MV adjusted to meet the back-end property requirement
(discussed in Section 13.3.3).
In Figure 13.4, level controller LC1 maintains the stripper’s bottoms inventory by manipulat￾ing valve LV1, which determines how much sidestream is removed. This design basis introduces
a number of important constraints that must be monitored by the control strategy implemented
to satisfy the sidestream product’s back-end property requirement. Stripper bottoms level valve
position LV1 (full open), stripper bottoms level measurement LC1 PV (low limit), and sidestream
product flow valve position FV1 (full open) are potential constraints that may limit that control
strategy. In Figure 13.4, stripper bottoms level LC1 PV (high limit) and sidestream product flow
valve position FV5 (full open) are the potential constraints that may limit control of the sidestream
product’s back-end property.
Now, looking at how the lowest boiling hydrocarbon components are removed from the frac￾tionator’s bottoms product, as shown in Figure 13.4, superheated steam (FC3) is injected below
the fractionator’s bottom tray to strip out low boiling hydrocarbon components that would oth￾erwise leave the tower with the bottoms product (FI4). Credits are realized by upgrading some
bottoms product to the more valuable lowest sidestream product, and less importantly, increas￾ing the bottoms product’s flash point. And similar to steam stripper operations, to help reduce
stripping steam utilization, the stripping steam to bottoms flow ratio is almost always controlled
and maintained constant (see discussion of Figure 11.26 in Section 11.4.1).
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.2 Feed True Boiling Point (TBP) Distillation Curve, Cutpoint, and Fractionation 505
13.1.5 Control Interactions
In upcoming sections, the source of most control interactions will be explored – it is predomi￾nantly the multiple pumparounds and, in addition to distillate and bottoms products, the multiple
sidestream products that make fractionator control strategies multivariable and interactive. Here
is a brief summary of these control interactions, presented and discussed in Sections 13.2.2 and
13.3.2. Although discussed for a typical primary fractionator (CDU), these characteristics apply to
main fractionators as well, although main fractionators typically have less sidestream products.
In Section 13.2.2 (Tower Cutpoint)
● An overhead temperature change or in effect, a change in the distillate’s % volume off, will not
only impact the distillate product’s back-end properties but also impacts the first sidestream’s
(SS1) front-end properties. Also, the fractionator’s control strategy must make other, simulta￾neous adjustments to limit the impact to just the distillate’s back end and the SS1’s front-end
properties.
● An SS1’s % volume off change will not only impact the SS1’s back-end properties, it also impacts
the next, lower sidestream (SS2) product’s front-end properties. Again, the fractionator’s control
strategy must make other simultaneous adjustments to limit the impact to just those two product
properties.
In Section 13.3.2 (Control Basics and CV – MV Interactions)
● There are many instances where adjustments made to a single fractionator MV will have an
impact on more than one fractionator CV, and adjustments made by more than one MV have
an impact on a single CV. These control interactions are highly concentrated among the prod￾uct quality/property CVs (overhead and sidestream product properties) and their associated MVs
(overhead temperature, reflux flow, sidestream draw-offs and condenser, TPA, and BPA duties).
● Control interactions are most widespread when the heat removal PVs (condenser, TPA, and BPA
duties) are manipulated.
● There are only a few control interactions among the basic regulatory control CVs (level, temper￾ature, and pressure controllers) and their associated MVs.
Note: Although main fractionators typically have fewer sidestream products, at least one (or more)
product streams is a final product or blend stock and therefore control of quality for these prod￾ucts is especially important. Heat removal via overhead condensers and several pumparounds are
unit characteristics, and thus, like primary fractionators, control interactions are most widespread
when these heat removal PVs are manipulated.
13.2 Feed True Boiling Point (TBP) Distillation Curve, Cutpoint,
and Fractionation
A fractionator’s feed consists of multiple components with a continuous, wide range of boiling
points. Feed components are separated into numerous products, both lighter, lower boiling
distillate products and heavier, higher boiling sidestream and bottoms products. Control strategies
that manage the product quality or properties of the various product streams are the focus of this
chapter. Similar to the tower controls discussed in Section 12.6, cutpoint and fractionation are
terms used to describe how important fractionator MVs affect fractionator operations as they are
adjusted to maintain product qualities or other relevant control variables at desired values.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License506 13 Fractionator Product Quality Control
The same TBP distillation curve, cutpoint, and fractionation principles explained and dis￾cussed for towers in Chapter 12 apply to primary and main fractionators, although the multiple
sidesteam products add additional complexity. In a two (or three) product distillation tower,
there is one (or two) cutpoint temperature(s) that identifies the distillate/bottoms product (or
distillate/sidestream/bottoms product) boiling point split. Since fractionators have multiple
sidestreams, there are multiple cutpoint temperatures that identify the various product boiling
point splits.
13.2.1 Feed TBP Distillation Curve
As discussed in Chapter 12, insight into the meaning of cutpoint can be gained by examining a tower
feed’s TBP distillation curve. As review, a TBP curve is obtained by heating a liquid volume sample
of feed in a laboratory batch distillation unit, with complete condensation of overhead vapor. As
heat is added, volumetric portions of the liquid vaporize (the volume % off), flow overhead, are
condensed and collected; the volume % off is then plotted against the overhead vapor temperature.
The overhead vapor temperature infers the boiling point of the feed components that vaporize at
that temperature; it increases continuously as heat is added and heavier, higher boiling components
vaporize, flow overhead, condense, and are collected.
A typical feed TBP distillation curve, the plot of volume % off vs the overhead vapor temperature,
applied to a fractionator with five products: distillate, three sidestream, and bottoms, is shown in
Figure 13.5. In Figure 13.5, the five product liquid volume % off – D/F, SS1/F, SS2/F, SS3/F, and B/F,
are determined by the four cutpoint temperatures: the distillate – SS1 split by cutpoint temperature
T1, the SS1 – SS2 split by cutpoint temperature T2, the SS2 – SS3 split by cutpoint temperature T3, and
the SS3 – bottoms split by cutpoint temperature T4. Thus, for a fractionator with three sidestream
T2
T3
T4
T1
Cutpoints : T1, T2, T3, T4
T
e
m
p
e
r
a
t
u
r
e
SS1/F SS3/F B/F
Liquid volume % off
SS2/F
Feed TBP
(True Boiling Point)
distillation curve 
D/F
Figure 13.5 Cutpoint and Feed TBP Distillation Curve – Relationships to Process Operations
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.2 Feed True Boiling Point (TBP) Distillation Curve, Cutpoint, and Fractionation 507
products, the cutpoint temperatures, T1 through T4, or any four of the five product volume % off
(D/F, SS1/F, SS2/F, SS3/F, and B/F) can be considered indications of the four tower cutpoints.
Like other towers, fractionator operating and control objectives are closely associated with the
separation of feed components into products. Referring to Figure 13.5: feed components boiling at
or below T1 are separated as the distillate product, those boiling above T1 but at or below T2 as
SS1, those boiling above T2 but at or below T3 as SS2, those boiling above T3 but at or below T4
as SS3 and finally those boiling above T4 are separated as the bottoms product. Thus, the cutpoint
temperatures again have physical meaning – they define how feed components are separated by
boiling point into distillate, sidestream, and bottoms products.
Similar to other towers, the product volume % off does not communicate the separation’s impor￾tant boiling point basis; thus, for both primary and main fractionators, cutpoint temperatures are
considered the more meaningful indicator of cutpoint, and their use is preferred by both control
engineers and operators. And remember, the cutpoint indicator used has no impact on the design
of fractionator control strategies, or how efficiently the feed components are separated by their
boiling points.
13.2.2 Tower Cutpoint
The effect of an increase in the fractionator’s overhead temperature (e.g., an increase in the distillate
product’s volume % off), and its impact on the cutpoint temperature and volume % off of distillate,
sidestream, and bottoms products, is indicated in Figure 13.6. When the overhead temperature
T3
T4
T3ʹ
T4ʹ
Liquid volume % off
SS1/F SS2/F SS3/F
Ovhd
product
Btms
product Sidestream products
T1
T1ʹ
T2ʹ
B/F
SS1/Fʹ = SS1/F SS2/Fʹ = SS2/F SS3/Fʹ = SS3/F’ B/Fʹ< B/F
T
e
m
p
e
r
a
t
u
r
e
Feed TBP
distillation curve 
D/F
D/Fʹ
Cutpoints : T1ʹ, T2ʹ, T3ʹ, T4ʹ
T2
Figure 13.6 Cutpoint Changes After Overhead Temperature Increase, with all SS Draw-off Constant
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License508 13 Fractionator Product Quality Control
is increased, the cutpoint temperature of the D – SS1 split is increased from T1 to T1
′
. More feed
components are separated with the distillate product, the volume % off increases from (D/F) to
(D/F)′
, the distillate product becomes heavier, and its back-end properties, e.g., its 95% distillation
point, and its FBP, increase. Also, the first sidestream’s lightest and lowest boiling components have
been removed – thus its front-end properties, e.g., its 5% distillation point and its IBP, increase. This
illustrates that an overhead temperature change will not only impact the distillate product’s (back
end) properties, it also impacts the SS1’s (front end) properties.
Fractionator sidestream products are almost always on flow control. Thus, as shown in
Figure 13.6, if SS1’s flow is controlled and is held constant, after the overhead temperature
increases, the cutpoint temperature of the SS1 – SS2 split also increases – from T2 to T2
′
. Thus,
heavier, higher boiling components previously separated with SS2 are now separated with SS1. As a
result, in addition to its front-end properties, SS1’s back-end properties also change, e.g., its 95% dis￾tillation point and its FBP increase. But, with SS2 and SS3 flows controlled and held constant, this
is also true for the SS2 – SS3 split’s cutpoint temperature, increasing from T3 to T3
′
, and the SS3 – B
split’s cutpoint temperature, increasing from T4 to T4
′
. Thus, front-end and back-end properties
of both SS2 and SS3 all increase, while only the bottoms product’s front-end properties increase.
With fractionator feed rate and feed composition constant, and all sidestream flow rates
controlled and held constant, the process changes that occur following an overhead temperature
increase are summarized below:
+ D/F volume % off increases
+ B/F volume % off decreases
+ SS1/F, SS2/F and SS3/F volume % off are unchanged
+ All fractionator products become heavier
+ Distillate product back-end properties, e.g., the 95% point and FBP, increase
+ Sidestream product front-end properties, e.g., 5% point and IBP, and back-end properties, all
increase
+ Bottoms product front-end properties increase
+ Material balance is closed by reducing bottoms product volume % – the magnitude of the bottoms
flow decrease is about the same as the magnitude of the distillate flow increase
This explains the interactions that advanced control strategies must manage to maintain fraction￾ator product properties constant. However, Figure 13.6 offers a focus area to help manage some of
these interactions – the sidestream flow rates.
In Figure 13.7, the same overhead temperature increase is implemented, but as shown, there is
a simultaneous change (a decrease) in SS1’s flow rate. In Figure 13.7, if instead of maintaining the
SS1 flow rate constant, it is decreased by an amount ideally equal to the liquid volume % increase
in the distillate product, with SS2 and SS3 flow rates controlled and held constant, the cutpoint
temperatures for the SS1 – SS2 (T2), SS2 – SS3 (T3), and SS3 – B (T4) splits do not change. For the
situation shown in Figure 13.7, after an overhead temperature increase:
+ D/F volume % increases.
+ SS1/F volume % is decreased, ideally by the same amount as the D/F’s increase.
+ SS2/F, SS3/F and B/F volume % are unchanged.
+ Distillate product becomes heavier and higher boiling; its back-end properties, e.g., the 95% point
and FBP, increase. If the intended split is between a LK in the distillate product and a heavier,
intermediate key, IK, in the SS1 product, then the distillate product becomes less pure – the SS1
material moved to the distillate product contains somewhat higher boiling components (relative
to distillate product components), including some IK.
+ After losing its lightest, and lower boiling components to the distillate product, SS1 product
front-end properties, e.g., 5% point and IBP, increase. The SS1 product becomes more pure – the Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.2 Feed True Boiling Point (TBP) Distillation Curve, Cutpoint, and Fractionation 509
D/Fʹ
T2
T3
T4
Liquid volume %
Ovhd
product
Btms
product Sidestream products
T1
T1ʹ
SS1/F SS2/F SS3/F B/F
T
e
m
p
e
r
a
t
u
r
e
Feed TBP
distillation curve 
Cutpoints : T1ʹ, T2, T3, T4
D/F
SS1/Fʹ SS2/Fʹ = SS2/F SS3/Fʹ = SS3/F B/Fʹ = B/F
SS1 D/O reduction
Figure 13.7 Cutpoint Changes After Overhead Temperature Increase, with SS1 Draw-off Reduced
material lost to the distillate product is somewhat lighter, lower boiling components (relative to
SS1 product components), including some LK.
+ When the D – SS1 split’s cutpoint temperature is increased, the distillate product’s volumetric
flow increases, it becomes heavier and higher boiling, and less pure (the higher boiling com￾ponents added include some IK); the SS1 product’s volumetric flow decreases, and its purity
improves (the lower boiling components removed include some LK).
+ This is generally true for any cutpoint change: the product whose volumetric flow increases becomes
less pure, and the product whose volumetric flow decreases becomes more pure.
+ Because the SS1 – SS2 cutpoint temperature (T2) is unchanged, SS1 product back-end properties
are in principle unchanged.2
+ SS2, SS3, and bottoms products front-end and back-end properties are in principle unchanged.
Important: To limit the impact of an overhead temperature increase (decrease) on fractionator
product quality to only the distillate product’s back end and the SS1’s front-end properties,
the fractionator’s SS1 back-end quality control strategy must decrease (increase) the SS1’s flow,
ideally, by the same amount as the D/F’s increase. How fast to make the change is discussed in
Section 13.3.3.
2 The loss of its lightest components should have very small effect on SS1 back-end properties. However, the SS1
flow reduction does affect, to some extent, the fractionation below (and above) the SS1 draw-off tray and therefore
there may be some (small) impact on SS1 back-end properties.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License510 13 Fractionator Product Quality Control
T2
T3
T4
T2ʹ
T3ʹ
T4ʹ
Liquid volume %
SS1/F SS2/F SS3/F
Ovhd
product
Btms
product Sidestream products
T1
B/F
SS1/Fʹ SS2/Fʹ = SS2/F SS3/Fʹ =SS3/f B/Fʹ = B/F
T
e
m
p
e
r
a
t
u
r
e
Cutpoints : T1ʹ, T2ʹ, T3ʹ, T4ʹ Feed TBP
distillation curve 
D/F
D/Fʹ = D/F
Figure 13.8 Cutpoint Changes After SS1 Draw-off Increase, Ovhd Temperature, Other SS Draw-offs
Constant
When specific fractionator control strategies are discussed later in Sections 13.3 and 13.4, it will
become clear that the sidestream draw-off flows are important MVs that impact many CVs . In
fact, the discussions of Figures 13.6 and 13.7 point out their undesirable impact on the front-end
and back-end properties of various fractionator products. However, the discussions of Figures 13.6
and 13.7 suggested an approach to help manage the multivariable responses to a change in the
fractionator’s overhead temperature.
As MVs, sidestream flows will routinely be adjusted, and it is thus worthwhile to examine
whether sidestream flow changes behave in a similar manner, and if so, gain insight into how to
manage their interactive responses. With this in mind, the effects of an increase in a fractionator’s
SS1 flow rate and the subsequent changes in distillate, sidestream, and bottoms product cutpoint
temperatures and volume % off are displayed in Figure 13.8.
When the SS2 flow rate is increased, the cutpoint temperature of the SS1 – SS2 split is increased
from T2 to T2
′
. More feed components are separated with the SS1 product, its volume % off increases
from (SS1/F) to (SS1/F)′
, the SS1 product becomes heavier and higher boiling, and its back-end
properties, e.g., its 95% point and its FBP, increase. Also, the second sidestream’s lightest and lowest
boiling components are now removed with the SS1 product – thus, SS2 front-end properties, e.g.,
its 5% point and its IBP, increase. And with SS2 and SS3 flow rates controlled and held constant,
the SS2 – SS3 split’s cutpoint temperature increases from T3 to T3
′
, and the SS3 – B split’s cutpoint
temperature increases from T4 to T4
′
. So, in addition to SS1 back-end and SS2 front-end properties,
SS2 back end, SS3 front end and back end, and bottoms front-end properties all increase. Finally, Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.2 Feed True Boiling Point (TBP) Distillation Curve, Cutpoint, and Fractionation 511
because the D – SS1 split’s cutpoint temperature T1 is unchanged, the distillate product’s back-end
and SS1 front-end properties are ideally unchanged.
Thus, for the situation illustrated in Figure 13.8, after a SS1 flow rate increase:
+ With overhead temperature constant, the D – SS1 split’s cutpoint temperature, T1, is
unchanged – distillate product volume %, its back-end properties, and the SS1 product’s
front-end properties are unchanged.
+ The SS1 – SS2 split’s cutpoint temperature is increased from T2 to T2
′
.
+ With its volume % increasing from (SS1/F) to (SS1/F)′
, the SS1 product becomes heavier and
higher boiling, and its back-end properties, e.g., its 95% point and its FBP, increase.
+ SS2’s lightest and lowest boiling components are now removed with the SS1 product – thus, SS2’s
front-end properties, e.g., its 5% point and its IBP, increase.
+ With SS2 and SS3 flow rates controlled and held constant, the SS2 – SS3 split’s cutpoint temper￾ature increases from T3 to T3
′
, and the SS3 – B split’s cutpoint temperature increases from T4
to T4
′
.
+ SS2 product’s back end, SS3 product’s front end and back end, and bottoms product front-end
properties all increase.
+ Material balance is closed by reducing bottoms product volume % – this time, the magnitude of
the bottoms flow decrease is about the same as the magnitude of the SS1 draw-off flow increase.
Like Figures 13.6 and 13.7, Figure 13.8 suggests a focus area to help manage the unwanted prod￾uct property changes – in this case, the flow rate of the adjacent sidestream (just below) whose
front-end properties are changed.
In Figure 13.9, the same SS1 flow increase is implemented but with a simultaneous change
(a decrease) in the SS2’s flow rate. As Figure 13.9 indicates, if the SS2 flow rate is decreased by
an amount equal to the liquid volume % increase in the SS1 product, and the SS3 product flow rate is
maintained constant, the cutpoint temperatures of the SS2 – SS3 (T3) and SS3 – B (T4) splits do not
change. Thus, for the situation shown in Figure 13.9, after a SS1 flow rate increase:
+ The SS1 – SS2 split’s cutpoint temperature increases from T2 to T2
′
.
+ SS2/F volume % is decreased, by the same amount as the SS1/F’s increase.
+ D/F, SS3/F and B/F volume % are unchanged.
+ SS1 product becomes heavier and higher boiling, and its back-end properties, e.g., the 95% point
and FBP, increase. If the intended split is between a lighter intermediate key, IK1, in the first
sidestream product and a heavier intermediate key, IK2, in the SS2 product, then the SS1 product
becomes less pure – the SS2 material added to the SS1 product contains some higher boiling
components (relative to the SS1 components), including some IK2.
+ After losing its lightest and lower boiling components to the SS1 product, SS2 product front-end
properties, e.g., 5% point and IBP, increase. The SS2 product becomes more pure – the mate￾rial lost to the SS1 product is predominantly lighter, lower boiling components (relative to SS2
components), including some IK1.
+ Because the SS2 – SS3 cutpoint temperature (T3) is unchanged, and assuming fractionation
effects are small, SS2 product back-end properties are in principle unchanged.
+ SS3 and bottoms product front-end and back-end properties are in principle all
unchanged.
Note again: When a cutpoint is changed, the product whose volumetric flow increases becomes
less pure, and the product whose volumetric flow decreases becomes more pure.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License512 13 Fractionator Product Quality Control
T2
T3
T4
Liquid volume %
Ovhd
product
Btms
product Sidestream products
T1
SS2/Fʹ SS3/Fʹ = SS3/F B/Fʹ = B/F
SS1/F SS2/F SS3/F B/F
T2ʹ
SS1/Fʹ
T
e
m
p
e
r
a
t
u
r
e
Feed TBP
distillation curve 
Cutpoints : T1, T2ʹ, T3, T4
D/F
D/Fʹ = D/F
SS2 D/O reduction
Figure 13.9 Cutpoint Change After SS1 Draw-off Increase, SS2 Draw-off Decrease, Ovhd Temperature and
SS3 Draw-off Constant
Thus, a fractionator’s SS2 back-end quality control strategy must decrease (increase) the SS2’s flow
rate to limit the impact of a SS1 flow rate increase (decrease) to just the SS1 product’s back-end and
the SS2 product’s front-end properties. In this case, the magnitude of the flow change is known – it
must be equal to, but opposite in direction, to the user desired change in the sidestream flow (SS1)
immediately above this sidestream (SS2). However, how fast to make the change still must be deter￾mined; this will be discussed in Section 13.3.3.
13.2.3 Tower Fractionation
At a specified cutpoint temperature, all feed components that boil above the cutpoint tempera￾ture are ideally separated with the heavier (higher boiling point) product, and all feed compo￾nents that boil below the cutpoint temperature are ideally separated with the lighter (lower boiling
point) product. If this were to happen, it would indicate perfect fractionation. However, this is never
the case in real-world fractionator operations. There are always some feed components that boil
above the cutpoint temperature that are separated with the lighter product, and some feed compo￾nents that boil below the cutpoint temperature that are separated with the heavier product. At a
specified cutpoint, the tower’s fractionation determines how efficiently feed components separate
via their boiling point – as the tower’s fractionation improves, there are less misplaced components,
and thus both products become purer.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.2 Feed True Boiling Point (TBP) Distillation Curve, Cutpoint, and Fractionation 513
Remember, the separation of feed components into various fractionator products is a very com￾plex process. It occurs as material and energy balances and vapor/liquid equilibrium relationships
at each tray’s temperature and pressure are simultaneously satisfied. Mass transfer between liquid
and vapor phases occurs at each tray’s near-equilibrium temperatures and pressures. The liquid
and vapor flows, and each tray’s temperature and pressure are essential to the separation achieved.
Heat input (feed preheat) generates the vapor flow, and heat removed (condenser and pumparound
duties) generates the liquid flow (e.g., internal reflux). The heat input/removal also impact pres￾sures, temperatures, and equilibrium conditions established on each tray. Therefore, at desired
cutpoint temperatures, it appears the closure of the fractionator’s energy balance determines the
separation achieved and hence product purity.
However, the fractionator’s underlying multivariable nature makes the real-world control prob￾lem much more complex. Although the cutpoint designation is directly related to the material
balance – the sum of all product volume % (e.g., D/F, SS1/F, etc.) is unity, fractionation’s relation￾ship to heat balance is less direct and much more complex. In fact, no matter how MVs are chosen,
or how MVs are paired with CVs, all individual MV adjustments, taken in sum, ultimately impact both
material and energy balances simultaneously as all control strategies achieve their control objectives.
Although fractionation impacts the fractionator’s material and energy balances, it cannot be
directly measured or calculated. However, as discussed in Section 12.6.3 and illustrated in Figures
12.20 through 12.22, the Overlap parameter (defined in Equation (12.5)) is an empirical and rela￾tively simple indicator of fractionation and its relationship to separation. The definition of the Over￾lap parameter in Equation (12.5) applied to the separation of two adjacent fractionator sidestream
products – SS1 and SS2, is presented below in Equation (13.1); as shown, it is the difference between
the SS2 (the heavier, higher boiling) product’s 5% distillation point and the SS1 (the lighter, lower
boiling) product’s 95% distillation point:
Overlap ≡ SS2 T5% − SS1 T95% (13.1)
SS2 T5% Temperature at which the SS2 product’s volume % off = 5%
SS1 T95% Temperature at which the SS1 product’s volume % off = 95%
There is no fundamental basis for this definition; however, the overlap parameter’s relationship
to separation and fractionation is best explained by looking at the actual TBP distillation curves
of the SS1 and SS2 products (or any other adjacent fractionator products). Typical TBP distilla￾tion curves for these two (adjacent) fractionator sidestream products, SS1 and SS2, are presented
in Figure 13.10.3 Included in Figure 13.10 are SS2 T5%, SS1 T95%, the Overlap parameter, and the
cutpoint temperature (T2).
If all feed components boiling above the cutpoint temperature are separated with the SS2 prod￾uct, and all feed components boiling below the cutpoint temperature are separated with the SS1
product, then fractionation is perfect. If this is true, SS2 T5% is greater than the SS1 T95%, and the
overlap parameter in Equation (13.1) is greater than zero. However, if some feed components boil￾ing above the cutpoint temperature are removed with the SS1 product and some feed components
boiling below the cutpoint are removed with the SS2 product, then as shown in Figure 13.10, SS2
T5% is less than SS1 T95%, and the overlap parameter in Equation (13.1) is less than zero. Since
perfect fractionation is not possible, all realistic separations will have a negative overlap param￾eter. The less negative the overlap parameter – the closer it is to zero, the better the separation,
and the better the fractionation. As the overlap parameter becomes more negative, separation and
fractionation degrade.
3 These TBP curves are generated by collecting sample volumes of each product at a specified cutpoint temperature
and using the same methods discussed in Section 12.6.1 to generate a distillation tower’s feed TBP.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License514 13 Fractionator Product Quality Control
Volume% off
Temperature
SS2
TBP curve Actual SS1 T95%
Actual SS2 T5%
95%
SS1
TBP curve
Ideal cutpoint = T2
0% SS1/F 100%
(LV% off)
SS2/F 100%
(LV% off)
0%
OverlapSS2→SS1
(SS1/F) (SS2/F)
5%
Figure 13.10 SS1 and SS2 TBP Distillation Curves – Fractionation, Overlap, and Cutpoint Relationship
At the cutpoint temperature, when the SS2 product’s lightest (and lowest boiling) components
are removed, they shift into the adjacent lower boiling sidestream product, SS1. Consequently, the
SS2 product becomes purer since the portion of its front end shifted to SS1 is predominantly lower
boiling components that (ideally) should have been separated with the SS1 product. After this com￾ponent shift, SS2 T5% increases – SS2 now contains less lower boiling components, so the volume
% off reaches 5% at a higher temperature. The SS1 product also becomes purer since its back end
now includes the portion of SS2’s front end, predominantly lower boiling components, that should
have been separated with the SS1 product. After this component shift, SS1 T95% decreases – SS1
now contains more lower boiling components, so the volume % off reaches 95% at a lower temper￾ature. With SS2 T5% higher and SS1 T95% lower, the overlap parameter is less negative, indicating
separation, and thus fractionation, has improved.
Also, when the SS1 product’s heaviest (and highest boiling) components are removed, they shift
to the SS2 product. The SS1 product becomes purer since the portion of its back end shifted to
SS2 is predominantly higher boiling components that (ideally) should have been separated with
the SS2 product. After this component shift, SS1 T95% decreases – SS1 now contains less higher
boiling components, so the volume % off reaches 95% at a lower temperature. The SS2 product
also becomes purer since its front end now includes the portion of SS1’s back end, predominantly
its higher boiling components that should have been separated with the SS2 product. After this
component shift, SS2 T5% increases – SS2 contains less lower boiling components, so the volume
% off reaches 5% at a higher temperature. With SS2 T5% higher and SS1 T95% lower, the overlap
parameter is less negative, again indicating separation, and thus fractionation, have improved.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.3 Crude Distillation Unit, CDU – The Most Important Primary Fractionator 515
Therefore, unlike a cutpoint change, when fractionation improves, both adjacent fractionator
products become purer, i.e., impurity concentrations in both are reduced. Likewise, when frac￾tionation degrades, both products become less pure, i.e., impurity concentrations in both products
increase.
13.3 Crude Distillation Unit, CDU – The Most Important Primary
Fractionator
The most common, and most important primary fractionator is a CDU. It separates crude oil
feedstocks into several products, each with a different boiling point range, and different properties.
Some of these products may be final products or a product blend stock, but more frequently, the
separation produces multiple feedstocks for further processing in downstream units. A CDU’s
design always includes multiple sidestream draw offs and multiple pumparounds. Its operations
are multivariable and often nonlinear, and there are normally overhead and sidestream product
quality or property requirements that must be satisfied. Conventional control strategies commonly
implemented to maintain overhead and sidestream properties at desired values are complicated
by the CDU’s underlying, multivariable responses, by its preheat and pumparound exchanger
heat integrations with upstream and downstream units, and by the interactions among its product
quality control strategies. In today’s modern DCS world, most sites employ DMC to manage CDU
control and operating objectives.
13.3.1 Process Variable Summary
Figure 13.11 presents a simplified P&I style drawing that shows the important measurements, con￾trol valves and calculated variables that define a typical CDU’s operating conditions. There are a
wide variety of CDU process configurations that are in operation today – the number of sidestream
draw offs, the number, and complexities of its pumparounds, the heat integrations that preheat its
feed, the number of sidestream steam strippers and their location (upstream or downstream of a
hydrofiner), and variations in the tower’s overhead configuration are the characteristics that often
vary from unit to unit.
Also, not all distillate and sidestream product qualities and/or properties are measured – their
online availability depends upon their ease of measurement and their importance. In some cases,
an online measurement is provided, but it is installed downstream, after the product has been
hydrotreated in a hydrofiner. If there is a downstream steam stripper, a sidestream’s front-end prop￾erty, such as flash point, 5% point, or IBP, if measured downstream, can be effectively controlled
by manipulating the steam stripper’s steam flow. However, for back-end properties and qualities,
a downstream quality measurement introduces a substantial dead time in the quality’s response
to the CDU’s operational adjustments, e.g., sidestream draw-offs, pumparound duties, etc. This
makes conventional advanced control more difficult and is one of the reasons why a (multivariable)
model-based controller, e.g., DMC, is the preferred technology.
The measured and calculated PVs included in Figure 13.11 are the CDU’s basic operating
variables, from which typical CDU CVs and MVs are chosen and disturbance variables (DVs)
are identified. These basic operating variable PVs are summarized in Table 13.1, where each
variable’s type – CV, MV, or DV, its use in a calculation, and its typical control strategy role, are
indicated.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License516 13 Fractionator Product Quality Control
LI
1
TI
3
TI
2 FC
5
PI
1
FC
10
FC
13
FC
12
FC
11
FC
6
FC
7
LC
5
LC
3
FC
1
LC
2
AI
5
AI
4
AI
2
AI
1
To VPS
To naphtha
H/F 
To kerosene
H/F 
To HGO
H/F 
FC
8
FC
4
TI
1
SS1
stripper
SS3
stripper
Steam
Steam
Steam
LV5
LV4
LV3
FI
14
FV6
FV7
TI
5
PV1
FV5
FV8
FV1
LC
4
FC
2
To LGO
H/F 
SS2
stripper
Steam
FV2
FV3
FC
9
TI
4
FV9
QTPA
QBPA
AI
3
TI
6
TI
7
AI
6
AI
7
QCond
FC
3
Figure 13.11 Crude Distillation Unit (CDU) Typical Process Configuration and Operating Variables
Note 1: In Figure 13.11, the sidestream strippers are upstream of the sidestream hydrofiners; the
sidestream steam stripper’s bottoms flow is the sidestream’s draw-off flow. It is thus the MV paired
with the sidestream’s back-end quality. Control of quality is then dependent on steam stripper level
control (LC1, LC2, LC3) performance, and level valve positions LV1, LV2, LV3 are potential con￾straint variables.
Note 2: Top pumparound (TPA), QTPA, and bottom pumparound (BPA), QBPA, heat duties are cal￾culated variables used in many CDU control strategies to help manage heat balance upsets and
constraints, and help maintain product quality at target. The PVs used in their calculation are indi￾cated in Table 13.1.
Note 3: Condenser heat duty (QCOND) is manipulated to either maintain reflux drum temperature
(TI3), reflux drum pressure (PI1) or reflux drum level (LI1) at target. However, unlike QTPA and
QBPA, QCOND is normally not calculated but is manipulated indirectly by adjusting a cold side inlet
temperature, a cold side flow rate, or if air-cooled, air louver positions and/or fan speeds.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.3 Crude Distillation Unit, CDU – The Most Important Primary Fractionator 517
Table 13.1 CDU MVs, CVs, DVs, Calculations, and Control Strategy Roles
Symbol Process Variable Variable Type, Control Strategy Role
FC4 Feed flow DV. Almost always a feedforward variable. Reflux, all
sidestream, and pumparound flows are ratioed to feed rate.
Flow/feed ratios are important MVs.
FC5 Reflux flow MV. Manipulated to control overhead temperature, (TI2),
reflux drum level (LI1), or distillate quality (AI1), sometimes
SS1 quality (AI2).
FC6 Distillate flow MV. Manipulated to control reflux drum level (LI1), or
distillate quality (AI1), sometimes SS1 quality (AI2).
LV3, LV4,
LV5
Sidestream draw-off flow
valve positions
MV. Valve positions manipulated by sidestream steam
stripper bottoms level controllers (LC3, LC4, LC5).
FC1, FC2,
FC3
Sidestream draw-off flows MVs. Manipulated to control a sidestream product’s back end
quality. Almost always ratioed to the dynamically
compensated feed rate, and ratios are SS quality control MVs.
In Figure 13.11, sidestream steam stripper bottoms flow is the
sidestream’s draw-off flow.
FC7 Fractionator bottoms flow MV. Manipulated to control bottoms level (LC2)
FC9, FC8 Top (TPA), bottom
pumparound (BPA) flows
MVs: Manipulated to control TPA, BPA duties (if return
temperatures are not manipulated).
In Calc: Calculation of TPA and BPA duties.
TI4, TI5 TPA, BPA return
temperature
MVs: If controlled, then TC4, TC5 can be manipulated to
control TPA, BPA duties (if pumparound flow is not the
duty MV).
In Calc: Calculation of TPA and BPA duties.
QTPA, QBPA TPA, BPA duties MVs: Manipulated to help manage heat balance upsets, and
sometimes to maintain a product quality at target.
CVs: When objective is to (i) drive operations to constraints
that maximize or minimize pumparound duties or (ii)
reallocate pumparound duties.
FC10 CDU bottoms stripping
steam flow
MV. Increases recovery of bottoms sidestream (SS3) back-end
(AI7). Normally ratioed to CDU bottoms flow (FC7).
FC11,
FC12, FC13
Sidestream steam stripper
steam flows
MVs. Manipulated to control sidestream front-end property
(AI2, AI4, AI6). Almost always ratioed to steam stripper’s
bottoms flow (FC1, FC2, FC3), and ratios are SS front end
quality control MVs.
TI1 Preheat heater’s COT CV: Controlled, via methods discussed in Section 10.4, often
at target specified by PTS group.
MV: Sometimes manipulated to control bottom sidestream
(SS3) back-end property (AI7), or to ensure sufficient
overflash flow (FI14).
QCOND Condenser duty MV: Manipulated to control reflux drum temperature (TI3),
reflux drum pressure (PI1) or reflux drum level (LI1). Unlike
QTPA and QBPA, QCOND is normally not calculated, but
manipulated indirectly – cold side inlet temperature or flow
rate adjustments, or air louver position or fan speed
adjustments if air cooled.
PV1 Valve position, overhead
vapor to LPG recovery,
fuel gas header.
MV: Manipulated to control reflux drum pressure (PI1) when
PC1 does not manipulate condenser duty (QCOND).
(continued) Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License518 13 Fractionator Product Quality Control
Table 13.1 (Continued)
Symbol Process Variable Variable Type, Control Strategy Role
PI1 Reflux drum pressure CV: Controlled by manipulating reflux drum vapor flow to
LPG recovery/fuel gas header. In some CDU overhead
configurations, PI1 is maintained by manipulating condenser
duty (QCOND).
In Calc: To pressure compensate ovhd or reflux drum
temperature; important when PI1 is uncontrolled.
LI1 Reflux drum level CV. Helps maintain fractionator material balance. Frequently
manipulates distillate flow (FC6) or reflux flow (FC5). In
some CDU overhead configurations, LI1 is maintained by
manipulating condenser duty (QCOND).
LC2 Bottoms level CV. Helps maintain fractionator material balance by
manipulating CDU bottoms flow (FC7).
LC3, LC4,
LC5
Sidestream steam stripper
bottoms levels
CVs. Helps maintain material balance by adjusting
sidestream draw offs via LV3, LV4, and LV5 in response to SS
draw-off flow adjustments (FC1 – FC3) made to control
sidestream quality.
TI2 Overhead temperature CV: Inference of distillate (Naphtha) back end quality (AI1),
frequently maintained at desired target by manipulating
reflux flow (FC5).
MV: Often manipulated to control Naphtha back-end
property (AI1).
TI3 Reflux drum temperature CV: If controlled, most likely maintained at desired target by
manipulating condenser duty (QCOND).
DV. If not controlled, it is an inference of reflux return
temperature and thus an internal reflux upset.
In Calc: Calculation of internal reflux between reflux return
and TPA draw-off.
TI6, TI7 TPA, BPA draw-off
temperatures
DVs: Inference of fractionator heat balance upsets
In Calc: Calculation of QTPA and QBPA respectively
AI1 Distillate (Naphtha)
back-end quality – FBP or
95% distillation Pt
CV: Most frequently controlled by manipulating reflux flow
(FC5) via ovhd temperature (TC2): AC1 → TC2 → FC5. Also
controlled via distillate flow (FC6), i.e., AI1 → TC2 → FC6.
FC5 and FC6 ratioed to dynamically compensated feed rate
and is AI1 control MV.
AI2 Kerosene (SS1) front-end
quality – Flash Pt, IBP, or
5% Pt.
CV: Most frequently controlled by manipulating SS1 steam
stripper steam flow (FC11). FC11 is almost always ratioed to
steam stripper bottoms flow (FC1), and the ratio is AI2
control MV.
AI3 Kerosene (SS1) back-end
quality – FBP or 95% Pt
CV: Most frequently controlled by manipulating SS1 draw-off
flow (FC1). Flow is almost always ratioed to the dynamically
compensated feed rate, and ratio is AI3 control MV.
AI4 Diesel or Light Gas Oil,
LGO (SS2) front-end
quality – Flash, 5% Pt
CV: If control of this quality is necessary, it is normally
controlled by manipulating SS2 steam stripper steam flow
(FC12). FC12 is almost always ratioed to stripper bottoms flow
(FC2), and ratio is AI4 control MV.
AI5 LGO (SS2) back-end
quality – FBP or 95% Pt
CV: Most frequently controlled by manipulating SS2 draw-off
flow (FC2). Flow is almost always ratioed to the dynamically
compensated feed rate, and ratio is AI5 control MV.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.3 Crude Distillation Unit, CDU – The Most Important Primary Fractionator 519
Table 13.1 (Continued)
Symbol Process Variable Variable Type, Control Strategy Role
AI6 Heavy Gas Oil, HGO (SS3)
front-end quality – Flash,
5% Pt
CV: If control of this quality is necessary, it is normally
controlled by manipulating SS3 steam stripper steam flow
(FC13). FC13 is almost always ratioed to stripper bottoms flow
(FC3) and ratio is AI6 control MV.
AI7 HGO (SS3) back-end
quality – FBP or 95% Pt,
Cloud Pt, Cold Filter Plug
Point (CFPP)
CV: Most frequently controlled by manipulating SS3 draw-off
flow (FC3). Flow is almost always ratioed to the dynamically
compensated feed rate, and ratio is AI’s MV. Either CDU
bottoms stripping steam flow (FC10) or preheat heater COT
(TC1) is sometimes MV chosen to control AI7.
FI14 Overflash flow.
Note: Overflash is difficult
to measure reliably, and its
measurement is not
always available.
CV. Controlled to (i) ensure sufficient liquid (good
fractionation) above flash zone or (ii) drive operations to
constraints that minimize overflash. Either preheat heater
COT (TC1) but more often SS3 draw-off flow (FC3)
manipulated to meet overflash target.
13.3.2 Control Basics and CV–MV Interactions
The measurements, controllers, control valves, and calculated variables that define a typical CDU’s
operating conditions are shown in Figure 13.11 and summarized in Table 13.1; each variable’s
type – CV, MV, or DV, its use in a calculation, and its typical control strategy role, are indicated.
Typical CV – MV pairings are also indicated throughout Table 13.1. As is true for any multivari￾able, interactive process unit, embedded in the CV – MV pairings in Table 13.1 are instances where
adjustments made to a single MV will have an impact on more than one CV, and adjustments
made by more than one MV have an impact on a single CV. These control interactions are highly
concentrated among the product quality or property CVs and their associated MVs, while there is
only a handful of control interactions among the basic regulatory control CVs (e.g., L, P) and their
associated MVs.
To focus on these control interactions, Table 13.1’s CV – MV pairings are summarized in
Tables 13.2 for the basic regulatory control CVs, and in Table 13.3 for the product quality/property
CVs. The symbols used in each table (X, x, x, x) are defined following each table.
Table 13.2 Basic Regulatory CVs, MVs, and CV – MV Pairings
CV
MV LI1 LC2 LC3 LC4 LC5 TC2 TI3 PI1
FC5 X
FC6 X
PV1 X
LV3 X
LV4 X
LV5 X
FC7 X
QCOND x X x
X = Most frequently chosen as MV.
x = Sometimes chosen as MV.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License520 13 Fractionator Product Quality Control
Table 13.3 Product Quality CVs, MVs, and CV – MV Pairings
CV
MV AI1 AI2 AI3 AI4 AI5 AI6 AI7 FI14
FC5 X x
FC6 x x
FC1 X x
FC2 X x
FC3 X x
QTPA x xxx
QBPA x xxxxx
FC10 x
FC11 X
FC12 X
FC13 X
TC1 x x
X = Most frequently chosen as MV.
x = Frequently chosen as MV.
x = Sometimes chosen as MV.
x = Rarely chosen as MV.
First, look at Table 13.2 – with the exception of condenser duty, QCOND, MVs paired with basic
regulatory control CVs have an impact on only one CV. QCOND can in principle be paired with three
CVs – reflux drum level (LI1), reflux drum temperature (TI3), or reflux drum pressure (PI1); thus,
it can have an impact on more than one CV. As shown in Table 13.2, it is most frequently paired
with reflux drum temperature (TI3). If so, QCOND adjustments made to control TI3 will also impact
PI1, and thus control of reflux drum pressure PC1 (most likely paired with valve position, PV1), and
reflux drum level LI1, and thus control of reflux drum level LC1 (most likely paired with distillate
flow, FC6).
Now, look at Table 13.3. There are five instances where at least three potential MV’s are likely
to have an impact on a single CV – AI1, AI2, AI3, AI4, and AI7, and three instances where two
potential MVs are likely to have an impact on a single CV – AI5, AI6, and FI14. Finally, there are
six instances where a single MV – FC5, FC6, FC3, QTPA, QBPA, and TC1 has an impact on more
than one CV. It is predominantly the multiple pumparounds, and the multiple sidestream products
plus distillate and bottoms products that make fractionator control strategies multivariable and
interactive. And notice the largest number of potential control interactions arise when the heat
removal PVs (QCOND, QTPA, QBPA) are manipulated.
13.3.3 Overview of Conventional CDU Advanced Product Quality Control
In discussions of the feed TBP distillation curve (Section 13.2.1) and tower cutpoint (Section
13.2.2), a number of important observations were made regarding product qualities/properties
and key CDU process variables. Those discussions clearly indicate the overhead temperature,
reflux flow rate, distillate product flow rate, and the sidestream product draw offs play major roles
in product quality control and are the major MVs (but not the only MVs) adjusted to meet the
distillate and sidestream product property CV targets.
The most frequently encountered product property CV – MV pairings are summarized in
Table 13.3 – an indication of how frequently a particular MV is paired with a particular CV Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.3 Crude Distillation Unit, CDU – The Most Important Primary Fractionator 521
is included. The discussion of Table 13.3 clearly illustrates a CDU’s underlying multivariable
nature – there are several instances of a single MV impacting more than one CV and more than
one MV impacting a single CV. These potential control interactions are very troublesome and
make CDU tower product quality control difficult to manage with conventional control methods.
Note that Table 13.3 indicates CV – MV control interactions are most numerous when the heat
removal PVs (QCOND, QTPA, QBPA) are manipulated to control product quality.
Discussions in Sections 13.2.1 and 13.2.2 provided insight into how the impact of control interac￾tions can be reduced. For example, to limit the impact of an overhead temperature change to just the
distillate product’s back end and the SS1 front-end properties, a fractionator’s control strategy must
make a simultaneous SS1 draw-off flow adjustment: when an overhead temperature is increased
(decreased), the SS1 draw off must be decreased (increased). And to limit the impact of a change
in a sidestream’s draw-off flow to that sidestream’s back-end properties and the front-end proper￾ties of the adjacent sidestream immediately below it, a fractionator’s control strategy must make
a simultaneous adjustment to the draw-off flow of the adjacent sidestream immediately below it.
These observations serve as an introduction to the concept of a dynamic decoupler – the calculation
of an incremental, dynamic feedforward correction that “cancels” the impact of another product
quality control loop’s MV adjustments on its product quality CV. It will be established in this section
that the dynamic decoupler uses the same equations and the same implementation building blocks
as the standard incremental dynamic feedforward controller described in Section 3.6.
To this point, the product quality control discussion has been limited to the common CV – MV
pairings in Table 13.3, with only the ultimate primary (CV) and the ultimate secondary (MV)
considered in the discussions. In this section, the typical cascade structure of CDU conventional
overhead product quality and sidestream product quality control strategies are presented. The com￾mon advanced control components that link the product quality CVs and their paired MVs to
complete the conventional advanced control strategy cascade structures are identified. Dynamic
decoupling is one of those components – its basis and its structure is also presented and discussed.
The typical overhead and sidestream product quality control strategies presented are then com￾bined into an overall, unified product quality control strategy applied to the typical CDU configu￾ration with the operating variables shown in Figure 13.11.
With the exception of the dynamic decouplers, the common advanced control components listed
below that link CDU product quality CVs to their paired MVs are essentially the same as those
incorporated into the tower product quality control strategies presented in Chapter 12:
● Analyzer measurement validation, and validated analyzer measurement use in control
● Externally multiplexed temperature measurement validation (when used in control)
● Pressure compensation of a tower temperature used in control
● Ratio feed rate feedforward control, with dynamic compensation
● Calculation and control of duty (TPA and BPA duty, instead of reboiler duty)
● Dynamic decoupling
● Use of the PID FF control algorithm to combine a PID calculated feedback control correction
with the incremental feedforward control correction calculated by the dynamic decoupler
Overhead Product Quality Control
The most common conventional advanced control strategy employed to control the distillate prod￾uct’s back-end quality – pairing it with the reflux flow, is shown in Figure 13.12. With distillate rate
paired with the reflux drum’s level, reflux flow is the available degree of freedom to meet the distil￾late product’s back-end property requirement. The overhead temperature controller’s reflux flow
adjustments first impact the overhead vapor volume and then, after condensation in the overhead
condenser, the reflux drum level. The overhead quality is impacted as the distillate product – SS1 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License522 13 Fractionator Product Quality Control
AI AIV AC
Validation
Ovhd
qualiity
Ovhd quality
control
Desired
ovhd quality 
SP
SP
FC
FC FCG RC
Dynamic
compensation
Feed
rate
Reflux flow
control
Reflux/feed
ratio control
SP
Current reflux/feed
ratio to SS1
dynamic decoupler
TC
TI
PI
Pressure compensated
ovhd temperature
control
TIV
SP
Ovhd
temperature
Ovhd
pressure 
Figure 13.12 CDU Overhead Quality Conventional Advanced Control Strategy
cutpoint is adjusted as the reflux drum level controller manipulates the distillate draw-off flow in
response to the level changes.
The control strategy in Figure 13.12 is a simple cascade, and cascade initialization and wind-up
are both handled by standard DCS features. However, there are a number of advanced control com￾ponent initialization and wind-up status-related issues that must be managed by user-provided
custom code and configuration. Previously presented descriptions of these control components, in
the specific sections included in the list below, include explanations of the circumstances requiring
user-provided custom code:
● Ratio feed rate feedforward control with dynamic compensation – e.g., reflux flow is ratioed to
the feed rate (see Sections 3.2, 3.3 and 3.4).
● Overhead temperature measurement validation (see Section 8.8) – if (as shown in Figure 13.12)
it is an externally multiplexed measurement.
● Control of the pressure compensated overhead temperature (Section 3.7.3) – overhead tempera￾ture is normally a good inference of the distillate product’s back-end quality (e.g., 95% distillation
point). Pressure compensation of the temperature is especially helpful if tower pressure is not
controlled or it is controlled poorly, and pressure upsets are common.
● Distillate quality measurement validation (see Section 8.8), and its control using a PID, or if dead￾time is a problem, via conventional model-based control.
Figure 13.12 indicates the current value of the reflux/feed ratio – the distillate product back-end
quality control strategy MV’s current value, is a first sidestream product quality control strategy
dynamic decoupler input. Dynamic decoupler inputs, calculations, outputs, and implementation
are all discussed next.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.3 Crude Distillation Unit, CDU – The Most Important Primary Fractionator 523
+
SS1
quality
Dynamic
decoupler
Feedback
control
GDC(s)
GDV(s)
GMV GC (s) + (s)
Manual
Auto
+
Error –
SS1
quality SP
MV effect on
SS1 quality
DV effect on
SS1 quality
GMV = KMV * e–θ
MVs
τMV * s + 1
MV = SS1
Feed
DV = Reflux
Feed
GDV = KDV * e–θ
DVs
τDV * s + 1
Figure 13.13 SS1 Quality – Reflux/Feed Dynamic Decoupler Functional Definition
Dynamic Decouplers
It is now demonstrated that a dynamic decoupler provides incremental, dynamic feedforward
control adjustments that cancel the impact of another product quality control loop’s MV adjust￾ments on its product quality CV. The decoupler’s calculation, and its implementation, use the
methodology presented in Section 3.6, where the underlying principles of incremental dynamic
feedforward control are explained. Section 3.6’s discussion is based on Figure 3.6, the s-domain
block diagram of a control loop that contains both a feedback controller and an incremental
feedforward controller, from which the underlying dynamic relationship among the CV, its paired
MV, and a DV is established. The same block diagram used in Figure 3.6 is applied, in Figure 13.13,
to schematically represent how dynamic decoupler GDC(s) cancels the effects of an overhead
quality controller’s MV adjustments (reflux/feed, a SS1 quality loop DV) on the first sidestream’s
quality (SS1 Quality) by calculating incremental adjustments to the SS1 quality control loop’s
MV (MV = SS1/feed).
For the SS1 quality – reflux/feed dynamic decoupler in Figure 13.13, the CV is the first
sidestream’s quality (SS1 Quality), the MV is the SS1/feed ratio and the DV is the reflux/feed ratio.
Remember that all s-domain variables represent changes in that variable. Therefore, the dynamic
decoupler’s input is a change in the DV, i.e., Δ (reflux/feed), and its calculated output is a change
in the MV, i.e., Δ (SS1/feed). This change in the MV, calculated by the decoupler, is added to
the MV value last calculated by the feedback controller, GC(s), and the sum is the MV output
to the process. With these CV, MV, and DV equivalencies in Figures 3.6 and 13.13, the dynamic
decoupler is functionally analogous to the incremental dynamic feedforward controller introduced
and discussed in Sections 3.3 through 3.6. It therefore follows that Section 3.3’s analytical results
are directly applicable to the dynamic decoupler. With the above equivalencies, the applicable
expression comparable to Equation (3.3) is:
SS1 Quality (s)=[GDV(s) − GMV(s) ∗ GDC(s)] ∗ Reflux
Feed (s) (13.2)
In Equation (13.2), GDV(s) and GMV(s), shown in Figure 13.13, represent first-order plus deadtime
transfer function models for the first sidestream quality’s dynamic response (CV) to changes in the
reflux/feed (DV) and SS1/feed (MV) ratios respectively.
Remember, SS1 Quality (s) represents the change in SS1 quality. Thus, for the change in first
sidestream quality (SS1 Quality(s)) to be zero for any change in the reflux/feed ratio, the expression Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License524 13 Fractionator Product Quality Control
in parenthesis in Equation (13.2) must be identically zero. Setting that expression equal to zero,
and solving for GDC(s), yields an expression for the dynamic decoupler:
GDC(s) = [ GDV(s)
GMV(s)
]
(13.3)
Substituting the GDV(s) and GMV(s) transfer functions (as they appear in Figure 13.13) into
Equation (13.3), the analytical expression for the dynamic decoupler’s transfer function GDC(s) is:
GDC(s) = [ KDV
KMV ]
∗
[
𝜏MV ∗ s + 1
𝜏DV ∗ s + 1
]
∗ Exp[−(𝜃DV − 𝜃MV) ∗ s] (13.4)
The dynamic decoupler in Equation (13.4) is identical to the classical incremental dynamic
feedforward controller’s analytical expression in Equation (3.6). Thus, like the standard incre￾mental dynamic feedforward controller, the ideal dynamic decoupler’s transfer function GDC(s)
in Equation (13.4) is analytically equivalent to the Lead-Lag plus deadtime algorithm (derived in
Section 3.3 and presented in Equation (3.7)):
GFF(s)=[KFF] ∗ [
𝜏Lead ∗ s + 1
𝜏Lag ∗ s + 1
]
∗ Exp[−𝜃FF ∗ s] (13.5)
Comparing Equation (13.4) to Equation (13.5), the CV – DV and CV – MV dynamic response param￾eters that correspond to the lead/lag + deadtime algorithm’s input parameters are shown below:
Feedforward Gain = KFF =[KDV/KMV], the ratio of the steady-state gains
Lead Time Constant = 𝜏LEAD = 𝜏MV =CV− MV dynamic response first-order time constant
Lag Time Constant = 𝜏LAG = 𝜏DV =CV− DV dynamic response first-order time constant
Feedforward deadtime = 𝜃FF =(𝜃DV − 𝜃MV) = the difference between the CV and DV dynamic
response deadtime and the CV – MV dynamic response deadtime
Thus, implementing a dynamic decoupler using the lead/lag plus deadtime algorithms or function
blocks is identical to the methods described in Sections 3.3 through 3.6 to implement a standard
incremental dynamic feedforward controller. Thus, plant tests must be planned and executed, test
data collected and analyzed, and the lead/lag+deadtime parameter values identified.
The PID FF control algorithm’s role in implementing the dynamic decoupler is the same as its role
in incremental feedforward control. In Section 3.5, its role in incremental, steady-state FF control
was discussed and illustrated in Figure 3.12, while in Section 3.6, its role in incremental dynamic
FF control was discussed and illustrated in Figure 3.14. Figure 13.14, a direct analog to Figures
3.12 and 3.14, illustrates how the PID FF control algorithm is used to implement the SS1 dynamic
decoupler, the specific dynamic decoupler discussed above.
The PID FF algorithm calculates the change in the dynamically compensated decoupler input
(reflux/feed ratio) by subtracting the last input value (FFn−1 in Figure 13.14) stored at the comple￾tion of the last execution pass, from the current input value (FFn in Figure 13.14). After multiplying
the difference by the decoupler gain (KFF = KDV/KMV), the decoupler correction is subtracted from
the normal PID algorithm result, and the result, the new MV value (SS1 /feed) in % of range of the
MV or in engineering units (depends upon the DCS’ PID algorithm), is the output.
Note: The PID FF algorithm subtracts the decoupler correction from the feedback correction. This
is why a negative sign is used in Figure 13.13 to combine decoupler and feedback corrections – the
dynamic decoupler’s output (the decoupler correction) is subtracted from the feedback controller’s
correction to be consistent with the standard PID FF control algorithm’s formulation.4
4 It is necessary to check whether or not this is the PID FF algorithm’s formulation for a specific DCS, e.g., the
decoupler correction is subtracted from, and not added to, the feedback controller’s correction.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.3 Crude Distillation Unit, CDU – The Most Important Primary Fractionator 525
(SS1 MV SP = PID FF OP in EU /feed SP)
PID Algo OP in EU
Equation (2.10)
Equation (2.11)
Equation (2.12)
PID control calculation
PV
SP
KFF
SS1 quality controller with PID FF control Algo
Dyn compensated
reflux/feed ratio
Current
reflux/feed
ratio
Last FF input value
PV Algo = deadtime
Ctl Algo = lead/lag
Lead/lag calc result
SS1 dynamic decoupler
(lead/lag + deadtime)
Is decoupler status = ON?
Decoupler
on/off status 
Yes
Exit
Was decoupler
= on last pass?
No
Initialize SS1
quality controller
Yes
No
TLEAD
TLAG
θFF
ΔMn(%) Mn–1(%)
Mn(%) = Mn–1(%) + ΔMn(%)
MVn (EU) = PID Algo OP in EU – KFF* (FFn – FFn–1)
Store FFn
on pass n
FFn–1 on
Pass n + 1
Figure 13.14 SS1 Quality – Reflux/Feed Dynamic Decoupler Implementation Using PID FF Algo
The PID FF control algorithm is described and discussed in great detail in Sections 3.5 and 3.6,
and readers are referred to those two sections for additional explanations of the algorithm’s features
and uses. But to complete this section’s description of dynamic decouplers, the most important
attributes of the functionality depicted in Figure 13.14 are briefly summarized below – for details,
see Sections 3.5 and 3.6:
● The PID FF control algorithm has three configurable inputs: PV and SP, the normal PID control
algorithm inputs, and the FF variable’s input (e.g., the dynamically compensated reflux/feed
ratio).
● Since the reflux/feed ratio controller is a cascade secondary, it is already configured with SP
Init =Yes, e.g., the ratio controller’s set point is meaningful when it is in Manual mode or
initializing. Therefore, choosing the ratio controller’s set point as the dynamic decoupler’s
input source is recommended. Note: If the reflux/feed ratio controller is transferred into Auto
mode – decommissioning quality controller feedback, ratio set point changes entered by opera￾tors are still correctly handled by the decoupler. Also, if the reflux flow controller is transferred
to Auto mode, the ratio controller is forced to initialize. Because current reflux flow controller
set points are used in the back calculation of the ratio controller’s initialized set point, any reflux
flow changes made by operators are correctly handled by the decoupler.
● Depending upon the DCS PID algo, the PID FF controller’s output can be in MV engineering
units or MV % of range.
● To be able to calculate FFn −FFn−1 on its next (n +1) execution pass, the PID FF algorithm’s last
task on the nth execution pass is to store FFn to the designated storage location that holds FFn−1.
● The decoupler steady-state gain (KFF), lead (𝜏Lead), lag (𝜏Lag), and deadtime (𝜗FF) parameter
values are engineer entered.
● The dynamic decoupler is commissioned by transferring the dynamic decoupler tag into Auto
mode and is decommissioned by transferring it into Manual mode. When the dynamic decoupler
is decommissioned, there is no impact on the feedback loop – it remains on control.
● To enable bumpless transfer, user-provided code must be provided to initialize the primary
controller whenever the dynamic decoupler is commissioned – typical logic is illustrated
in Figure 13.14. Standard PID FF algorithm initialization features set the last input value Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License526 13 Fractionator Product Quality Control
(FFn−1) equal to its current (on this initialization pass) input value (FFn), making the dynamic
decoupler’s control correction, (FFn −FFn−1), equal to zero on the initialization pass.
● Standard DCS PID FF functionality manages the unavailability of the decoupler’s input
(reflux/feed unavailable) and its return to available status without impacting the SS1 Quality
feedback control loop.
Remember: In most circumstances, it is very difficult to effectively implement dynamic decouplers
in a multivariable environment as complex as the CDU. Experience indicates a true multivariable,
interactive control approach, e.g., DMC, will be more effective than the conventional control strat￾egy approaches that feature dynamic decoupling.
First Sidestream Product Quality Control
In order to illustrate and clarify the dynamic decoupler discussion presented above, the most com￾mon conventional advanced control strategy used to control the first sidestream’s back-end quality
is shown in Figure 13.15, with the sidestream’s back-end quality paired with the first sidestream’s
draw off. Dynamic decoupling is included – using the current reflux/feed ratio, a SS1/feed ratio
correction is calculated by the PID FF control algorithm for reflux/feed ratio changes.
The control strategy in Figure 13.15 is a simple cascade, and cascade initialization and wind-up
are both handled by standard DCS features. However, as expected, there are a number of initializa￾tion and wind-up status-related issues for some of the advanced control components included that
must be managed by user-supplied custom code and configuration. Previously presented descrip￾tions of these control components, in the sections referenced below, include the issues that need
user-provided code to resolve:
● Ratio feed rate feedforward control, with dynamic compensation, e.g., SS1 draw-off flow (and
reflux flow in the overhead quality control strategy is ratioed to the dynamically compensated
feed rate (see Sections 3.2–3.4).
FC
FC FCG RC
AI AIV
Current SS1/feed
ratio to SS2
dynamic decoupler 
Dynamic
compensation
Validation
Feed
SS1 quality
SS1 draw off
flow control
SS1/feed
ratio control
Desired
SS1 quality 
SP
SP
AC
PID FF
Lead/lag +
deadtime
Current
reflux/feed ratio
from ovhd quality
control 
SS1 quality
control
SP
SS1 dynamic
decoupler
PV
FF
Figure 13.15 CDU SS1 Quality Conventional Advanced Control Strategy, with Dynamic Decoupling
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.3 Crude Distillation Unit, CDU – The Most Important Primary Fractionator 527
● First sidestream quality measurement validation (see Section 8.8), and its control using the PID
FF control algorithm.
● The overhead product’s back-end quality controller’s MV value, the current reflux/feed ratio, is
the SS1 dynamic decoupler’s configured input. The dynamically compensated reflux/feed ratio
value is the SS1 quality’s PID FF algorithm’s configured FF input.
Remember: The distillate product quality controller’s MV adjustments (reflux/feed) impact
distillate back-end properties and the first sidestream’s front-end properties. However, the
first sidestream dynamic decoupler’s SS1/feed corrections do not impact the first sidestream’s
front-end properties. Rather, the SS1 dynamic decoupler’s SS1/feed corrections help maintain a
first sidestream product’s back-end quality at target. In Table 13.3, a first sidestream’s front-end
property is most frequently paired with the first sidestream’s steam stripper’s steam flow.
Sidestream Product Quality Control
As shown in Figure 13.16, the cascade structure and control components included in the first
sidestream’s back-end quality control strategy, discussed above and presented in Figure 13.15, are
applicable to the control of any sidestream’s back-end property. The sidestream’s back-end quality
is paired with the sidestream’s draw-off flow and includes dynamic decoupling. In this discussion,
the (N −1)th sidestream is the adjacent sidestream immediately above the Nth sidestream. An
SSN /feed ratio correction is calculated by the Nth sidestream’s PID FF control algorithm, as the
(N −1)th sidestream’s quality control strategy adjusts the SSN−1/feed ratio.
All observations and comments related to the control components included in Figure 13.15’s
control strategy are also applicable to the generalized control strategy in Figure 13.16:
● Ratio feed rate feedforward control with dynamic compensation, e.g., both SSN and SSN-1 are
ratioed to the dynamically compensated feed rate.
● Sidestream quality measurement validation, and its control using the PID FF control
algorithm.
FC
FC FCG RC
AI AIV
Dynamic
compensation
Validation
Feed
rate
SSN quality
SSN draw off
flow control
SSN/feed
ratio control
Desired
SSN quality 
SP
SP
AC
PID FF
Lead/lag +
deadtime
SSN quality
control
SP
SSN dynamic
decoupler
PV
FF
Current
SSN–1/feed ratio
from SSN–1 quality
control 
Current
SSN/feed ratio
to SSN+1 decoupler 
For SS1‘s quality control
strategy (N = 1), this input is the
current reflux/feed ratio
(as shown in Figure 13.15) 
Figure 13.16 CDU SS Quality Conventional Advanced Control Strategy, with Dynamic Decoupling
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License528 13 Fractionator Product Quality Control
● The SSN−1 product’s back-end quality controller’s MV value, the current SSN−1/feed ratio, is the
SSN dynamic decoupler’s configured input. The dynamically compensated SSN−1/feed ratio value
is the SSN product quality’s PID FF algorithm’s configured FF input.
● The SSN product’s back-end quality controller’s MV value, the current SSN/feed ratio, is the SSN+1
dynamic decoupler’s configured input. The dynamically compensated SSN+1/feed ratio value is
the SSN+1 product quality’s PID FF algorithm’s configured FF input.
Remember: The SSN product quality controller’s MV adjustments impact SSN’s back-end proper￾ties and the front-end properties of SSN+1, the adjacent sidestream immediately below SSN, but do
not impact SSN front-end properties. The SSN dynamic decoupler’s SSN/feed corrections only help
maintain the SSN product’s back-end quality at target. Sidestream front-end properties are most
frequently paired with a sidestream stripper’s steam flow.
CDU Tower Conventional Product Quality Advanced Control Strategy
Typical conventional overhead and sidestream product quality control strategies were presented
and discussed in Figures 13.12 (overhead quality), 13.15 (SS1 quality), and 13.16 (quality of any
sidestream below SS1). In Figure 13.17, these control strategies are combined into an overall con￾ventional product quality control strategy for the typical CDU configuration and operating variables
in Figure 13.11.
The major problems associated with CDU product quality control are the multivariable nature
and the troublesome control loop interactions that arise as the scope of the control problem widens.
SP
Current reflux/feed ratio
Current SS1/F ratio 
FCG2
SS1 quality
control
SS2 quality
control
Dynamic
compensation
SS1/feed
ratio control
Lead/lag +
dead time
SS2/feed
ratio control
SS1 dynamic
decoupler
FC
1
FCG1 RC1
Dynamic SP
compensation
AC3
PID FF
SP
FC
4
Feed rate
SS1 flow
SP
AIV3 AI
3
Validation
PV
AIV5 AI
5
Validation
AC5
PID FF
RC2
SP
SP
SP
FC
2
SS2 flow
PV
FF
FF
TC2
RC5
Ovhd
temperature
control
SP
FC
5
Reflux flow
FCG5
Dynamic
compensation
SP
Feed rate
Current SS2/F ratio 
Reflux/feed
ratio control
Lead/lag +
dead time
SS2 dynamic
decoupler
Lead/lag +
dead time
SS3 dynamic
decoupler
SP
SS3/feed
ratio control
FC
3
FCG3 RC3
SP Dynamic
compensation
SP
SS3 flow
AIV1 AC1
AI
1
Validation
PV
SP
Distillate
quality
control
AIV7 AI
7
AC7
PID FF
SS3 quality
controller
Validation
PV
FF
Feed rate
Figure 13.17 CDU Tower Conventional Product Quality Advanced Control Strategies with Dynamic
Decoupling
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.3 Crude Distillation Unit, CDU – The Most Important Primary Fractionator 529
Notice that Figure 13.17’s control strategy exhibits only downward interactions – reflux flow and
sidestream draw-off flows affect qualities and properties of the adjacent sidestream immediately
below it but have no effect on those above it. However, due to fractionation effects, reflux and
sidestream draw offs can have a small impact on nonadjacent sidestream product qualities. Despite
this, neglecting these effects is usually acceptable; it reduces the number of potential control loop
interactions and the complexities they create, although the (remaining) downward control loop
interactions are still difficult to manage.
Note 1: Decoupler lead, lag, and deadtime parameter values are identified using plant test data and
are subject to error, and model error limits the decoupler’s ability to manage interactions.
Note 2: There are interactions between sidestream steam stripper steam adjustments to control
a sidestream’s front-end property and sidestream draw-off adjustments to control a sidestream
back-end property.
Note 3: When a pumparound duty is adjusted to control a product quality CV, process variables
throughout the tower are impacted, and the interactions that arise are usually more difficult to man￾age. Unlike cutpoint changes, whose impacts are normally well understood, fractionation changes
are multifaceted and affect multiple CVs (see Table 13.3).
Note 4: If the benefits are justifiable, a DMC controller can include the impact of reflux and non￾adjacent sidestream flows on all qualities.
13.3.4 Conventional Energy Conservation (ENCON) Controls
In fractionator operations, there are many instances in which energy conservation credits “com￾pete” with product yield credits. Increasing energy utilization is justified up to the point at which
the incremental value of a yield increase is about equal to the energy’s incremental cost. If energy
utilization increases further, the energy’s incremental cost is greater than the yield’s incremen￾tal value, and further energy utilization is not justified. Conventional control approaches cannot
manage these energy utilization realities. Although DMC is often better suited to manage a frac￾tionator’s multivariable and interactive control environment, it cannot resolve these important
energy-yield tradeoffs either. Only an online RTO application, with a scope that includes upstream
and downstream unit operations, is able to manage these tradeoffs in an optimal way. Using first
principle, steady-state models, and an economic objective function, RTO calculates optimum oper￾ating conditions – individual CV targets and desired CV operational ranges. These CV targets and
ranges are stored to underlying advanced control strategies, often DMC controllers, whose respon￾sibility is to move plant operations to these optimal process conditions, and then keep them there.
Because energy and yield are so tightly coupled, the scope of conventional ENCON controls is
not very wide. The most important conventional approaches to capturing energy utilization cred￾its involve minimizing stripping stream use at fractionator and sidestream stripper bottoms (see
Section 13.1.4), and effectively controlling pumparound duties to improve pumparound heat recov￾ery. Less important conventional controls focus on reducing fractionator pressure and reducing
overflash – the excess feed vaporized in the preheat heater but returned to the fractionator’s flash
zone (below the bottom tray) as a liquid.
Stripping Steam Utilization
As discussed in Section 13.1.4, to reduce fractionator and steam stripper stripping steam utilization,
steam flow to each unit is almost always ratioed to the bottoms flow (without dynamic compensa￾tion), and the ratios are maintained at offline calculated values – see the discussion of Figure 13.4 in
Section 13.1.4. This prevents wasteful use of steam at all bottoms and sidestream product flow rates. Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License530 13 Fractionator Product Quality Control
Without ratio control, operators typically use more steam than necessary to ensure enough steam
is provided for the entire range of flows. Note that these steam savings credits are usually small.
Pumparound Duty and Heat Recovery
In most cases, the measurements needed to calculate a pumparound’s duty – draw-off flow rate,
draw-off temperature, and return temperature, are available. Heat duties are maintained at target
by manipulating the draw-off flow rate, which is almost always on flow control. If the return tem￾perature is controlled, it also can be a manipulated variable to maintain the duty at target. To help
maintain a uniform pumparound duty distribution and thus ensure uniform fractionation through￾out the tower, pumparound duties are often ratioed to the fractionator’s dynamically compensated
feed rate, and the ratios are maintained at offline calculated targets. However, because pumparound
duties have an important impact on fractionation, as indicated in Table 13.3, pumparound duties
are sometimes paired with product quality CVs. Thus, pumparound duty/feed ratios are also some￾times paired with product quality CVs.
Because pumparound duties are very large, and their heat exchangers are heat integrated with
upstream and downstream units, improving heat recovery is an important pumparound duty
control objective. Although challenging to quantify, energy savings accrue if effective pumparound
heat recovery enables all or some of the following to occur: (i) heat losses in upstream or down￾stream water-cooled or air-cooled exchangers are reduced, (ii) preheat heater duty, and thus
fuel consumption, is reduced, and/or (iii) steam generation is increased. Conventional control
strategies can improve heat recovery and capture some energy savings credits by maintaining
pumparound duty constant while redistributing heat duty among several of the pumparound’s
heat exchangers. But the magnitude of the benefits and the likelihood of capturing them depend
heavily on which streams are heat integrated, and in what order, with the pumparound’s flow.
There are potential heat recovery energy savings associated with shifting pumparound duties
among the fractionator’s several pumparounds. However, and this is very important, shifting
pumparound duties to improve heat recovery will affect fractionation throughout the tower, and
thus may also have an impact on product quality and yield. Shifting heat duty from lower to upper
pumparounds improves fractionation higher up in the tower, which can improve yields where
more valuable products are removed, but the lower temperatures in the upper sections of the
tower discourage heat recovery. Shifting heat duty from upper to lower pumparounds has the
opposite effects: fractionation improves lower down in the tower, where less valuable products
are removed, but heat recovery is encouraged by higher temperatures. The difficulties of shifting
pumparound duties among a fractionator’s several pumparounds is illustrated by the control
strategy that will be discussed in Section 13.4.2 – it involves heat duty allocation between an FCCU
main fractionator’s top and bottom pumparound to maintain the fractionator’s distillate product’s
95% distillation point controller’s output in controlling range.
The justification for shifting heat duties among several pumparounds is difficult to establish. The
impact of recovering heat at either lower or higher temperatures and the magnitude and worth
of the yield improvements that arise as fractionation improves must be considered. If this can be
done offline by process engineers using detailed simulations and analysis tools, the direction and
maximum magnitude of the heat duty shift that provides the credits necessary to justify the effort
can be established. If so, although complex and resource intensive, inter-pumparound heat duty
reallocation can be achieved using conventional control strategy approaches. However, if these heat
recovery-yield tradeoffs vary over time and must be determined in real time on a periodic basis, an
online RTO application is required.
Finally, as discussed in Section 13.1.2, because pumparound exchangers are heat integrated
with upstream and downstream units, manipulating pumparound duties to manage heat balance
upsets is another important fractionator control objective. Lessening the effects of heat balance Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.3 Crude Distillation Unit, CDU – The Most Important Primary Fractionator 531
upsets helps stabilize fractionator operations. Because pumparound duties have a major impact
on separation and fractionation, maintaining the pumparound heat duty (or the pumparound’s
heat duty/feed ratio) relatively constant can help attenuate fractionator heat balance upsets.
Advanced control credits are then captured by reducing product quality/property variations and
helping to keep product properties closer to their desired targets.
Overflash Minimization
CDUs have a small number of trays below the bottom sidestream draw-off. To ensure there is
sufficient liquid to support separation below the draw-off tray, excess feed must be vaporized in the
preheat heater, then be condensed in the tower to provide the liquid needed to satisfy all sidestream
flow targets and support separation in the wash zone – between the lowest sidestream’s draw-off
tray and the bottom tray. Overflash is the % of the feed vaporized in the preheat heater but returned
to the fractionator’s flash zone (below the bottom tray) as a liquid – this infers unnecessary
feed vaporization and, thus, unnecessary preheat heater fuel firing. When possible, overflash is
controlled to ensure sufficient liquid and, thus good fractionation in the wash zone. Either the
preheat heater’s COT, but more often the lowest sidestream draw-off flow, is manipulated to meet
an offline calculated overflash target. However, overflash flow is difficult to measure reliably,
and therefore it is not always available as a CV. Although there are a few correlations available to
estimate overflash, the best overflash prediction is provided by an online RTO application whose
scope includes the CDU.
If the preheat heater’s COT is manipulated to maintain overflash at an offline specified target,
there are small energy savings captured for minimizing overflash – reduced fuel gas consump￾tion. However, overflash flow responds very slowly to COT changes – the vaporized feed must flow
upwards to the overhead, be condensed, returned to the tower as reflux, and then flow down toward
the wash zone. Also, adjusting COT has fractionation implications which can be utilized to cap￾ture more substantial product quality credits. Therefore, if the lowest sidestream draw-off flow is
not used to meet a bottom sidestream product quality, it is the preferred MV to meet an overflash
target. And unlike its COT response, overflash responds relatively quickly to changes in the lowest
sidestream’s draw-off flow.
If the lowest sidestream product’s quality is important, and its draw-off flow directly impacts the
quality, then overflash control or overflash minimization may not be justified. Overflash optimiza￾tion may be justified, but its worth depends upon an energy-yield tradeoff: the incremental value
of a lowest sidestream product yield increase vs the incremental cost of the net energy required.
Overflash optimization is a very complex operating objective that is difficult to achieve. It involves
large numbers of tower PVs and the above energy-yield tradeoff. Thus, overflash optimization can
realistically only be achieved within an online RTO application.
Pressure Minimization
In a light-ends tower, reducing tower pressure can either maintain the same separation at a lower
reboiler duty (or lower reflux flow) or increase a product’s yield if the reboiler duty is maintained
constant. For a CDU, reducing tower pressure can in principle either achieve the same separation
at a lower preheat heater COT (the source of the associated energy savings) or improve the lowest
sidestream product’s yield if the COT is not reduced. In some cases, a conventional constraint
control strategy can effectively minimize pressure – by reducing pressure until a tower constraint
is encountered. With the pressure controlled, the manipulated variable is the pressure controller’s
setpoint.
Despite this, and similar to light-ends towers, CDU pressure minimization is currently almost
always implemented within a DMC controller – multiple MVs can be adjusted to lower pressure,
and DMC can effectively hold multiple constraints at their constraint limits. Whether conventional Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License532 13 Fractionator Product Quality Control
constraint control or DMC is used, there are always several constraints that limit pressure decreases,
and hence, they must be identified and included in the control strategy’s scope. But for sure, as the
control problem’s scope gets larger, DMC’s potential advantages also increase.
Like overflash, pressure minimization may not be optimal and in fact another energy-yield trade
off determines if pressure optimization is the better operating objective to pursue. As pressure is
reduced, tower temperatures tend to decrease, pumparound heat is recovered at lower tempera￾tures and overhead vapor compression costs increase. These energy “costs” partially offset the net
energy savings associated with lowering tower pressure – reducing heater COT and hence fuel
utilization. Like overflash optimization, when pressure minimization evolves into pressure opti￾mization, the problem becomes too complex for both conventional methods and DMC, and it can
only be achieved within an online RTO application.
13.3.5 Example CDU Conventional Advanced Control Applications
Throughout this chapter, the difficulties of applying conventional control methods to the multivari￾able and interactive nature of fractionator operations have been highlighted, and thus conventional
approaches to CDU advanced controls will in most cases be outperformed by a true multivari￾able controller such as DMC. Although some older conventional control applications remain in
operation, most new CDU advanced control strategies will be implemented as part of a wider-scope
DMC controller that encompasses units both upstream and downstream of the CDU.
So, rather than identifying and explaining specific design issues, the conventional advanced con￾trol strategies discussed in this section are included to demonstrate how the typical cascade struc￾tures of CDU conventional overhead and sidestream product quality control strategies are applied
to actual plant configurations. The first two control strategies discussed also illustrate how spe￾cific CDU overhead configuration characteristics can complicate overhead product quality con￾trol strategies. The last control strategy discussed illustrates the complications introduced by the
interactions between a sidestream steam stripper’s bottoms inventory control and the sidestream
product’s back-end property control.
Overhead Quality Control Strategy with Overhead Pressure Control Override
This first example was initially discussed in Chapter 6 (Override Control), Section 6.2.2. In
Figure 13.18, CDU’s (T-121) overhead pressure (PI026) is not controlled but must remain below a
maximum allowable value. If air fin trim cooler E-117 provides sufficient cooling capacity, reflux
drum (D-122) vapor temperature (TC022 PV) is maintained at its desired target (TC022 SP), and
overhead pressure typically remains below its maximum allowable value. However, overhead
pressure is strongly influenced by anything that affects overhead vapor volume – for example,
the ambient temperature, pumparound heat duty, and preheat heater COT upsets, but especially
E-117’s cooling capacity. When E-117 cooling capacity becomes limited (e.g., in summer, during
daylight hours), overhead pressure tends to increase and can approach and exceed its maximum
allowable value.
Naphtha yield (FI012 PV) is determined when the naphtha endpoint (or 95% point) target is
met. Overhead vapor temperature, TI021 PV, is an excellent inferential indicator of the naphtha’s
95% distillation point, but as shown in Figure 13.18, an online 95% point measurement is available
(AI601 PV). Thus, as presented previously in Figure 6.8, the 95% point’s target (AC601 SP) is main￾tained by manipulating the reflux flow (FC011) via the AC601 → TC021 → RC011 → FC011 cascade.
The strategy in Figure 6.8 is enhanced by two feedforward corrections: pressure compensation
of the overhead temperature and reflux to feed ratio control (RC011). With overhead pressure Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.3 Crude Distillation Unit, CDU – The Most Important Primary Fractionator 533
FI
012
AI
601
Naphtha
95% Pt
Crude feed
FC
010
T
1
2
1
FC
011
E-117
TI
021
E-116
PI
026
To
recontacting
drum
TC
022
LC
012 D-122
Crude E-118 C-110 A E-119
∞ ∞
Figure 13.18 CDU T-121 Overhead Configuration, With Overhead Pressure Uncontrolled
uncontrolled, pressure compensation improves control performance by providing feedforward cor￾rections for pressure variations. Likewise, including RC011 improves control performance by pro￾viding feedforward compensation for changes in the (dynamically compensated) feed rate (FC010).
When E-117 becomes capacity-limited, and overhead pressure starts rising and approaching
its maximum allowable value, a reflux rate increase is the most direct way to stop the increase in
pressure and avoid an overhead pressure maximum limit violation. Increasing reflux flow will
condense more vapor at the top of the tower, decreasing overhead vapor volume, and ultimately
decreasing overhead pressure. But reflux flow is not an available degree of freedom – it is paired
with naphtha 95% point CV. Thus, a high-pressure override controller, to override the naphtha
95% point control cascade and manipulate reflux flow to manage pressure, is desirable. Such an
override control strategy was presented previously in Figure 6.9.
The overhead product quality control strategy in Figure 6.8 and the override control strategy in
Figure 6.9 are combined and shown as one control strategy in Figure 13.19. Max overhead pres￾sure override controller PC126 will override the naphtha 95% point control loop when overhead
pressure PI126 PV begins to approach its maximum allowable value, PC126 SP. This will most
often occur when E-117 cooling capacity is limited, and D-122 vapor temperature controller TC022
becomes wound-up high. While PC126 manipulates the reflux flow rate to avoid a max pressure
limit violation, the 95% point will be uncontrolled and float on tower operations.
With PC126 PV safely below the max pressure (PC126 SP), PC126 will want to decrease reflux
flow in order to bring PC126 PV up to PC126 SP. However, an increase in reflux flow is needed to
reduce overhead pressure of PC126 PV if it is approaching or above PC126 SP. Therefore, a high
selector provides the required override logic for the cascade.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License534 13 Fractionator Product Quality Control
Desired
naphtha 95% Pt
Ovhd pressure
control PC126
Max ovhd
pressure SP
RC011 Reflux/feed
ratio FCG10
Dynamic
compensation
SP
Reflux
rate
T-121 reflux
flow
FI
011 FC011
SP
HSS
TI
021
SP
TIV021
Validation
TC021 Pressure compensated
ovhd temperature Ctl
Overhead
temperature
AI
601
Naphtha 95%
control AC601 AIV601
SP
Naphtha
95% Pt
PI
126
Overhead
pressure Current reflux/feed
ratio to SS1
dynamic decoupler
FC
010
Figure 13.19 CDU T-121 Overhead Quality Control with High Overhead Pressure Override
Design Notes and Features
These design notes and features for the most part result from this chapter’s learnings being applied
to the control strategies proposed earlier in Chapter 6, in Figures 6.8 and 6.9:
1. The current value of the reflux/feed ratio – the distillate product’s 95% distillation point quality
control strategy’s MV, is the first sidestream’s (SS1) product quality control strategy’s dynamic
decoupler input.
2. RC011 is a cascade secondary, and thus, it is configured for SP Init = Yes. When quality control
is overridden by PC126, provided that RC011 is initialized, RC011 SP remains meaningful, and
thus remains a valid SS1 dynamic decoupler input.
3. Since the override control strategy in Figure 13.19 is a complex cascade, custom code/logic
must be provided to set RC011’s initialization and wind-up statuses when naphtha 95% point
control is overridden by PC126. Since the quality control loop above RC011 is a simple cascade,
standard DCS features will set initialization and wind-up statuses of all controllers above RC011
once RC011’s statuses are resolved (via the user-provided custom code).
4. When E-117 cooling capacity recovers, and TC022 is able to maintain TC022 at TC022 SP, pres￾sure should decrease, and if so the naphtha 95% point control loop is able to override PC126.
However, because the override cascade is a complex cascade, custom logic must be provided
to (i) ensure PC126 does not wind-up – a valid PC126 OP value is calculated during normal
operations and (ii) initialize RC011 when this occurs. Standard DCS features will then reset
initialization and wind-up statuses of all controllers above RC011.
5. Note that Table 13.3 indicates TPA duty is frequently paired with an overhead product’s
back-end property. Thus, if the naphtha 95% point was paired with TPA duty via an Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.3 Crude Distillation Unit, CDU – The Most Important Primary Fractionator 535
AC601 → TC021 → TPA duty cascade, reflux flow then becomes an available degree of
freedom to pair with overhead pressure PC126. With pressure paired with reflux flow, the need
for a pressure control override is eliminated.
If TPA duty is an available degree of freedom, a TPA duty increase or, if pumparound duty is
not controlled, a pumparound flow increase or a pumparound return temperature decrease is an
action that can help stop the increase in overhead pressure and avoid an overhead pressure max￾imum limit violation. If TPA duty is increased, more vapor is condensed below the pumparound
return tray, and thus less vapor flows overhead to condenser E-116 and trim cooler E117. This tends
to lower overhead pressure, and also tends to reduce E-117’s heat load. But remember, pumparound
duty changes can affect fractionation, and therefore, also impact product yield/quality, including
the naphtha 95% point quality. Thus, before pairing TPA duty (replacing reflux flow) with the naph￾tha 95% point, or using it to help return TC022 OP into controlling range, a careful analysis by
process specialists is required to fully assess the impact of pumparound duty changes on T-121
operations.
Overhead Quality Control Strategy with Reflux Drum Level Control Override
The override application presented in this section is similar to the strategy discussed in the last
section – a CDU overhead quality control loop, but instead of a maximum pressure override, there
is a reflux drum low-level controller override. However, unlike the strategy discussed in the last
section, this control strategy has a somewhat special characteristic which must be considered to
ensure the override provides the desired control strategy.
Figure 13.20 shows the overhead configuration of this CDU (T-132). Overhead vapor temperature
TI131 PV is an excellent inference of the distillate (IVN) product’s 95% distillation point; an online
IVN 95% point measurement is also available (AI801 PV). Thus, similar to the overhead product
quality control portion of the strategy in Figure 13.19, control of the IVN 95% distillation point is
also achieved by manipulating reflux flow (FC131) – via an AC801 → TC131 → RC131 → FC131
cascade. Since pressure PC132 is effectively controlled by its adjustments to compressor C-120,
TC131 PV does not need pressure compensation. Other standard control components included
are feed rate feedforward control with dynamic compensation (via RC131), and temperature
(TI131 PV) and analyzer measurement (AI801 PV) validity checks to enhance robustness. Note:
The T-132 distillate (IVN) 95% point control strategy is displayed on the left side of Figure 13.21
and discussed in detail there.
Note that reflux drum D-138, exchanger E-138, and recontacting drum D-139 are located between
the IVN 95% point measurement and the reflux flow measurement. So, in addition to the fraction￾ator’s slow dynamic responses to reflux flow (FC131 SP) changes, these additional hold-ups make
AC801’s dynamic response to FC131 SP changes even slower. Difficulties in achieving effective IVN
95% point control performance are almost certain.
Referring to Figure 13.20, any condensed liquid not returned to T-132 as reflux accumulates in
reflux drum D-138. With the IVN 95% point held at set point by manipulating the reflux flow (FC131
SP), and with no liquid distillate product, level controller LC135 maintains D-138 inventory by
manipulating trim cooler E-137’s duty (via air louvers, LV135). When operations are normal and
there is sufficient E-137 cooling capacity, D-138 liquid inventory (LC135 PV) is controlled at its
normal setpoint, well above a chosen minimum value, by manipulating trim cooler E-137’s duty.
However, because E-137 is an air-cooled exchanger, its cooling capacity can become and remain
limited, especially during daytime hours in summer. When E-137’s cooling capacity becomes
limited (louvers fully open with all fans on), LC135’s wind-up status is set to High, and corrections
for a level below set point – an increase in E-137 duty to condense additional overhead vapor, are
not possible. Depending upon how long LC135 remains wound up high, LC135 PV may continue
to decrease, and eventually approach a chosen minimum value.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License536 13 Fractionator Product Quality Control
AI
801
IVN
95% Pt
Intermediate
virgin
naphtha
(IVN)
Crude feed
FC
130
T
1
3
2
D-138
LC
135
FC
131
To FG
system
TI
131
PC
132 LC
136
E-138 C-130
E-136 E-137
LV135 Crude C-120
∞
D-139
Figure 13.20 CDU Overhead Configuration, Potential Quality Control Override for Low Drum Level
The T-132 distillate (IVN) 95% point control strategy described above is displayed on the left side
of Figure 13.21. As shown in Figure 13.21, to ensure D-138’s level (LC135 PV) is not lost when
E-137’s cooling capacity becomes limited, an LC135 level override controller (LC135L) is added
(shown on the right side of Figure 13.21) to the IVN 95% point control strategy to override IVN
95% point control and when necessary allows LC135L to control D-138’s level by manipulating
reflux flow.
Referring to Figure 13.21, when operations are normal and there is sufficient E-137 cooling capac￾ity, LC135 can maintain level at its normal setpoint, well above a chosen minimum value, LC135L
SP. Thus, when operations are normal, LC135L’s control adjustments will consistently request
reflux flow increases in order to lower LC135 PV to LC135L SP. However, when a sizable decrease
in reflux flow is needed to increase and recover the reflux drum level as it approaches its minimum,
the low signal selector (LSS) will choose LC135L’s output (or the RC131 output if it is smaller than
LC135L OP) to send to the reflux flow set point. Therefore, a low selector provides the required
override logic for the cascade.
LC135L overrides the IVN 95% point control loop when the LC135 PV begins to approach its
minimum value (LC135L SP). However, it is very possible that LC135 will become wound-up high
before LC135 PV approaches/reaches LC135L SP. Thus, LC135 PV will almost certainly be above
LC135L SP when LC135 becomes wound-up high. Therefore, even though LC135 is wound-up
high, the level control override is not activated unless and until LC135 PV approaches LC135L SP.
Thus, IVN 95% point control remains commissioned, D-138’s level is uncontrolled, and the level
may or may not approach its minimum value.
This presents an override design issue that must be considered – what is the operating objective
after LC135 becomes wound-up high: (i) keep IVN 95% point control commissioned while D-138
level remains uncontrolled until it approaches a chosen minimum value or (ii) force activation of
D-138 level override control as soon as LC135 becomes wound-up high, with reflux flow the MV,
and decommission IVN 95% point control. However, with proper tuning of override level controller Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.3 Crude Distillation Unit, CDU – The Most Important Primary Fractionator 537
Overhead
temperature
SP
IVN 95%
control AC801
Desired
IVN 95% Pt
SP
AIV801
Validation
IVN
95% Pt
TC131 TIV131 Ovhd temperature
control
Current reflux/feed
ratio to SS1
dynamic decoupler
E-137
LC
135
D-138
level
control
SP
Desired
LC135 PV
LV135
SP
LSS 
RC131 Reflux/feed
ratio
FC
130
FCG130
Dynamic
compensation
SP
Feed
rate
LC135 PV
Min LC135 PV
LC135L
SP
Low
LC135 PV
override
Reflux
rate
FC
131
Reflux return
to T-132
∞
TI
131
AI
801
Figure 13.21 CDU Distillate Quality Control with Level Control Override
LC135L (best load response, proportional on PV, tuned for tight level control), the level response to
reflux flow adjustments should be relatively fast and effective. Thus, with a reasonable choice for
override set point LC135L SP, maintaining IVN 95% point control commissioned for as long as pos￾sible while D-138 level remains uncontrolled is a reasonable choice, with minimum risk of losing
D-138 level.
Design Notes and Features
Note that there are many similarities between these design notes and features and those reported for
the CDU overhead quality control strategy with high-pressure override (in Figure 13.19) discussed
previously:
1. The current value of the reflux/feed ratio – the current value of the IVN 95% distillation point
control strategy’s MV, is the SS1 product quality control strategy’s dynamic decoupler input.
2. RC131 is a cascade secondary and is configured for SP Init = Yes. When IVN 95% point control
is overridden by LC135L, as long as RC131 is initialized, the reflux/feed ratio set point remains
meaningful, and is a valid SS1 dynamic decoupler input.
3. The override control strategy in Figure 13.21 is a complex cascades – custom logic is needed
to set RC131’s initialization and wind-up statuses when IVN 95% point control is overridden
by LC135L. Standard DCS features will set initialization and wind-up statuses of all controllers
above RC131 once its statuses are resolved.
4. When E-137’s cooling capacity recovers, LC135 is able to maintain LC135 PV at its set point,
and the IVN 95% point control loop overrides LC135L. However, when this occurs, because the
override control strategy in Figure 13.22 is a complex cascade, custom logic must be provided to Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License538 13 Fractionator Product Quality Control
TK-851
Kerosene
TI
182
PI
106
D-102
CDU
tower
FC
141
FC
172
Crude feed
LC
180
FC
135
Kero FBP
FC
173
AI
196
SS1 draw off
R
3
0
1
Stripping
steam
Naphtha to
naphtha H/F
TI
183
Kerosene
H/F
AI
197
Kero
5% Pt
TC
184
FC
174
T
3
0
6
FI
175
Kerosene
steam stripper
LC
190
LV190
T
1
0
1
Figure 13.22 CDU Overhead (Naphtha) and First Sidestream (Kerosene) Process Configuration
(i) ensure LC135L does not wind-up – a valid LC135L OP is calculated during normal operations
and (ii) initialize RC131. Standard DCS features will then reset initialization and wind-up sta￾tuses of all controllers above RC131.
5. Similar to the last section’s naphtha 95% point control, if the IVN 95% point was paired with
TPA duty via an AC801 → TC131 → TPA duty cascade, reflux flow becomes an available degree
of freedom to pair with D-138 level LC135. With D-138 level control paired with reflux flow, the
need for a level control override is eliminated.
As was true for the control strategy in Figure 13.20, if TPA duty is an available degree of freedom,
a TPA duty increase (or a pumparound flow increase, or a return temperature decrease) can reduce
E-137’s cooling load and help avoid a low-level control override. But again, changes in pumparound
duty affect fractionation, and therefore product yields and qualities are impacted. Thus, before uti￾lizing TPA duty as the IVN 95% point quality’s MV (replacing reflux flow), or just to help return
LC135 OP into controlling range, a careful analysis by process specialists is required to fully assess
the impact of pumparound duty changes on T-132 operations.
SS1 (Kerosene) Final Boiling Point and Initial Boiling Point Controls
This next example focuses on the CDU (T-101) overhead (Naphtha) and first sidestream (Kerosene)
process configuration in Figure 13.22. It illustrates the interactions among four T-101 control strate￾gies: (i) SS1 product (Kerosene) 5% distillation point (AI197) – paired with SS1 steam stripper steam
flow (FC174), (ii) SS1 steam stripper bottoms level (LC190) – paired with steam stripper bottoms
flow (FI175, via LV190), (iii) SS1 product FBP (AI196) – paired with SS1 draw-off flow (FC173), and
(iv) overhead product (Naphtha) 95% distillation point (inferentially via TI182) – paired with reflux
flow (FC141).
The product quality control strategies implemented to meet desired targets for naphtha 95% point
and kerosene FBP (in Figure 13.23), and kerosene 5% pt (in Figure 13.24) illustrate how the CDU
overhead and SS1 quality advanced control strategies presented earlier are applied to a specific CDU Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.3 Crude Distillation Unit, CDU – The Most Important Primary Fractionator 539
SS1 to
kero H/F
Kero FBP
controller
Desired
Kero FBP 
SP
FC
173
Current SS1/feed ratio to
SS2 dynamic decoupler 
FCG173 RC173
Dynamic
compensation
Feed
rate
SS1 draw off
flow controller
SS1/feed
ratio control
SP
SP
AIV196
AI
196
Kero FBP Validation
AC196
PID FF
SP
SP
Reflux
flow
T-101 reflux flow
FC
141
TIV182
TC182 Validation
Ovhd
temperature
Current
Reflux/feed ratio
from Ovhd quality
control 
SP
FC
172
FCG141 RC141
Dynamic
compensation
Feed
rate
Reflux/feed
ratio control 
PI
106
Ovhd
pressure
Press Comp
ovhd temp Ctl
Desired ovhd
temperature
TI
182
FC
172
SS1 dynamic
decoupler
Figure 13.23 Naphtha (Overhead) 95% Distillation Pt, Kerosene (SS1) FBP Control with Dynamic
Decoupling
FC
174
AI
197 Kero 5% Pt
control
RC174
AC197 AIV197
Stm/Btms
ratio control
Steam
Desired
kero 5% Pt SP
SP
SP
Validation
Kero
5% Pt
FI
175
T-306
Btms flow
Steam
flow
Figure 13.24 Kerosene (SS1) 5% Point Control
configuration. Based on those earlier overview discussions, it is possible to describe the interactions
expected as these product quality control strategies achieve their control objectives. Referring to
Figures 13.22 through 13.24:
● Changes in reflux flow (FC141 SP) to meet the naphtha 95% point target (inferred by pressure￾compensated TC182 SP) will also impact the SS1 5% point (AI197 PV). The impact of reflux flow
on SS1 FBP (AI196 PV) is offset by SS1’s dynamic decoupler corrections, but its impact on SS1 5%
point (AI197 PV) is not offset by SS1’s dynamic decoupler – the SS1 5% point feedback control
strategy must manage the consequences of this interaction.
● Changes in SS1 draw-off flow (FC173) to meet the SS1 FBP target (AC196 SP ) will also impact SS2
front-end properties, sidestream stripper (T-306) bottoms level (LC190 PV), and T-306 bottoms
flow valve position, LV190. The impact of SS1 draw-off flow on SS2 back-end properties is offset Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License540 13 Fractionator Product Quality Control
by SS2’s dynamic decoupler corrections. However, its impact on SS2 front-end properties is not
offset by SS2’s dynamic decoupler – the SS2 front-end property feedback control strategy must
manage the consequences of this interaction.
● If either T-306 bottoms flow valve position (LV190) or T-306 level (LC190 PV) reaches or
surpasses maximum allowable values, SS1 draw-off flow (FC173 SP) cannot increase, and its
wind-up status must be set equal to High. The SS1 FBP (AI196 PV) feedback control strategy
must monitor LV190 and/or LC190 PV and when either becomes limited high, via user-provided
custom code/logic, set FC173’s wind-up status to High. Via standard DCS features, the wind-up
status of RC173 and AC196 will then be set equal to High. When LV190 and/or LC190 PV return
normal, the SS1 FBP (AI196 PV) feedback control strategy must reset FC173’s wind-up status
to Normal. Standard DCS features will then reset the wind-up status of RC173 and AC196 to
Normal.
The control strategies that maintain naphtha 95% point (inferred by pressure compensated
TI182 PV) and kerosene FBP (AI196 PV) at desired targets in Figure 13.23 illustrate how the CDU
overhead and SS1’s product quality conventional advanced control strategy overviews displayed in
Figures 13.12 and 13.15 are applied to this actual plant configuration.
Specific fractionator control features presented earlier in this chapter and included in these
control strategies are (i) dynamic decoupling of the overhead temperature controller’s corrections
(reflux/feed) in the SS1 control strategy, (ii) the Kero FBP controller’s PID FF control algorithm
(AC196) that combines Kero FBP feedback and reflux/feed dynamic decoupler (FF) control
corrections, and (iii) SS1/feed ratio corrections made available as the SS2 control loop’s decoupler
input. A model-based control approach for Kerosene FBP control may be justified by a slow
FBP response to changes in SS1 flow. Based on the Kerosene FBP control strategy presented in
Figure 13.23, the model inputs would be reflux/feed ratio (DV) and SS1/feed ratio (MV).
If TPA duty is an available degree of freedom, Table 13.3 indicates it is frequently paired with
a naphtha back-end property, e.g., FBP or 95% distillation point. However, as emphasized earlier,
pairing a pumparound duty with a product quality brings with it potential control loop interac￾tions that must be understood and assessed prior to its use in product quality control.
The control strategy that maintains SS1 (kerosene) 5% distillation point (AI197 PV) at its
desired target by manipulating SS1’s steam stripper (T-306) steam flow (FC174) is presented
in Figure 13.24. As the discussion of Figure 13.4 in Section 13.1.4 indicates, and as shown in
Figure 13.24, a sidestream product’s front-end property is typically controlled by manipulating the
sidestream stripper’s steam flow, ratioed to the steam stripper’s bottoms flow.
Remember, the reflux/feed adjustments (RC141) made by the overhead naphtha 95% control
loop (TC182) in Figure 13.23 will impact SS1 (kerosene) front-end properties (5% point). However,
the kerosene 5% point response to changes in the T-306 steam/bottoms ratio is reasonably fast,
and provided there are no 5% point analyzer sampling problems, good control performance is nor￾mally achieved. Therefore, a model-based control approach for sidestream front-end properties is
normally not needed.
Last Thoughts
All CDU product quality control and fractionation management objectives discussed in Sections
13.3.3 through 13.3.5 would almost certainly be achieved today within the scope of a DMC con￾troller, which includes the CDU’s sidestreams, pumparounds, etc., and its upstream (e.g., feed
preheat) and downstream units (e.g., sidestream steam strippers, hydrofiners, crude light-ends tow￾ers, etc.). Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.4 Reactor Effluent Product Separation Section Main Fractionators 541
13.4 Reactor Effluent Product Separation Section Main
Fractionators
A main fractionator’s upstream units, in the reactor effluent’s cooling and product separation
section, are less uniform than a primary fractionator’s (e.g., a CDU) upstream units. There
are also variations in reactor operating objectives that determine the most important products
and properties to control. As a consequence, due to variations in their upstream units, main
fractionator conventional advanced control strategies are more difficult to standardize than those
presented in Section 13.3.3 for a CDU. Main fractionators often have only one sidestream product
whose quality must be controlled and/or its yield maximized, and another product whose yield is
minimized to increase the yield of the more valuable product.
Minimizing (or maximizing) a product yield forces a control strategy to drive process operations
against various constraints and thus constraint management is an important element of many main
fractionator control strategies. The product properties that are most important to honor are those
associated with the more valuable products that are either final products or product blend stocks.
However, variations in reactor operating objectives, and consequently, variations in product qual￾ity control objectives, make it impractical to present overviews of main fractionator product quality
control strategies that broadly apply to real process configurations across a broad spectrum of reac￾tor systems.
The two main fractionator conventional advanced control applications that are presented and
discussed next emphasize the difficulties conventional control approaches have managing the
numerous constraints and the underlying multivariable nature of fractionator operations. The
two examples support the need for a true multivariable, constraint controller (e.g., DMC) with a
scope that includes upstream (e.g., the reactor system’s feed preparation, feed preheat, and reactor
sections) and downstream (unsaturated light-ends recovery) units.5
13.4.1 Gasoil H/F Main Fractionator Gas Oil Sulfur Control and Yield Maximization
Figure 13.25 presents a gasoil hydrofiner (R-535) reactor effluent’s cooling and product separation
section configuration,6 which includes main fractionator T-540. As illustrated in Figure 13.25, reac￾tor effluent heat recovery is an important separation section function – mainly preheating reactor
hydrocarbon and product fractionator feeds. However, the section’s primary operating objective is
to separate naphtha, several distillate boiling range liquid products – gasoline, gas oil, low sulfur
diesel and fuel oil, and an H2-rich vapor product.
Referring to Figure 13.25, the reactor effluent is first routed to several separator drums – a hot sep￾arator drum (D-551), a cold separator drum (D-552), and a low-pressure separator drum (D-553),
where the H2-rich gases are separated from the liquid phase as the effluent vapor is cooled by heat
integration with the reactor’s treat gas and hydrocarbon feeds. The H2-rich gases that are separated
are sent to gas recovery where H2S is removed, and the scrubbed gas is recycled to the treat gas
header. Treat gas is preheated in preheat heater F-525, mixes with fresh feed, and the combined
hydrocarbon-treat gas feed then enters H/F reactor R-535. The liquid products from the cold sep￾arator (D-552) and the low-pressure separator (D-553) drums are the main fractionator’s (T-540)
liquid feed streams, where wild naphtha, gas oil, and fuel oil products are separated.
Main fractionator, T-540, separates its light (from D-552) and heavy (from D-553) feed streams
into distillate (wild naphtha), sidestream (low sulfur gasoil distillate), and bottoms (heavy fuel oil
5 Reactor system unit configurations are discussed in Section 14.2.
6 Effluent cooling and product separation sections are described in Section 14.2.4.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License542 13 Fractionator Product Quality Control
R
5
3
5
Recycle and
make-up gas
(treat gas)
D-552
Feed surge
drum
Cold separator
drum
FI
516
LC
555
Low pressure (LP)
separator drum
LC
557
FI
512
LV555
PC
517
FI
514
LV557
Gas oil
H/F
reactor
Treat gas (TG) F-525
D
5
5
1
D
5
0
1
Hot separator
drum
TG preheat
furnace
Hydrocarbon
feed
D-559
Quench
surge
drum
GO H/F main
fractionator
Wild
naphtha
To fuel oil
blending
T
5
4
0
Off gas to
gas recovery 
Gas oil
distillate
To gas
recovery
D
5
5
3
∞
Figure 13.25 Gasoil H/F Reactor Effluent Cooling and Product Separation Section Configuration
blend stock) products. The low sulfur gas oil distillate product (the sidestream product) is the most
valuable product, and its yield is usually maximized, while naphtha and heavy fuel oil products are
less valuable, and their yields are typically minimized.
T-540’s process configuration, which includes sidestream stripper T-535, is shown with its instru￾mentation in Figure 13.26. T-540’s most important operating objectives are to maximize gas oil dis￾tillate yield (FC561) and minimize bottoms product (heavy fuel oil – FI513) yield. Additional oper￾ating objectives are to minimize wild naphtha (distillate) production (FC546), and while achieving
the desired stripping, minimize T-540 heavy feed injection steam (FC564), T-540 bottoms stripping
steam (FC565), and sidestream stripper T-535 stripping steam (FC566).
Minimize Stripping and Injection Steam
Utilization of superheated steam in fractionator operations was explained in Section 13.1.4: (i)
remove the lightest, lowest boiling components from T-540’s sidestream product in sidestream
steam stripper T-535, and (ii) upgrade the lowest boiling hydrocarbon components in T-540’s bot￾toms product to its more valuable (lowest) sidestream product. For T-540, there is a third use – heavy
feed injection steam to help maintain heavy feed flow (FI512 PV) above a minimum mass velocity
to avoid coking.
As presented in Figures 13.27 and 13.28, T-540’s bottoms stripping steam and steam stripper
T-535’s bottoms stripping steam are both ratioed to a tower bottoms flow, and each ratio controller
meets its desired steam/bottoms ratio target by adjustments to the tower’s steam rate. These strip￾ping steam control strategies lower steam utilization when the offline calculated steam/bottoms
ratio controller SPs are suitable. These simple ratio control strategies ensure sufficient steam when Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.4 Reactor Effluent Product Separation Section Main Fractionators 543
Off gas to
gas recovery
FC
546
AI
518
Sulphur
content
Wild
naphtha
E-551
D-502 LC
511
FC
541
TI
555
PC
516
FI
512
T
5
4
0
T
5
3
5
Gas oil
distillate
FC
561
LC
512
LC
513
PC
517
FI
516
FI
514
FI
513
Heavy feed from
LP separator
drum (D-553)
Btms
Light feed from
cold separator
drum (D-552) 
Vapor from
LP separator
drum (D-553)
ovhd
From cold separator
level control (LC555)
FC
564
FC
566
LV512
FV561
LV513
To fuel oil
blending
Steam
Sidestream
steam stripper
From LP separator
level control (LC557)
GO H/F main
fractionator
PV516
TI
560
FC
565
Figure 13.26 Gasoil Hydrofiner Main Fractionator Process Configuration
Figure 13.27 Main Fractionator Stripping Stm/Btms
Ratio Control
RC565 
SP
SP
T-540 Stm/Btms
ratio control 
Desired T-540
stripping Stm/Btms ratio 
T-540 Btms
stripping steam
FI
513
FC
565
T-540
Btms flow
bottoms flow rates increase, help prevent excess steam utilization when bottoms flows decrease,
and capture minor energy savings – a small decrease in steam utilization.
In Figure 13.29, T-540’s injection steam (FC564) is ratioed to the tower’s heavy feed flow (FI512
PV), and the injection steam/heavy feed ratio target (RC564 SP) is met by manipulating the injec￾tion steam flow rate. Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License544 13 Fractionator Product Quality Control
T-535
Btms flow
RC566
SP
SP
T-535 Stm/Btms
ratio control
Desired T-535
Stm/Btms ratio 
FC
561
FC
566
T-535
stripping steam
Figure 13.28 SS Stripper Stripping Stm/Btms Ratio
Control
RC564 
SP
SP
T-540
injection Stm/heavy feed
ratio control 
Desired T-540
injection Stm/heavy feed ratio 
T-540
injection steam
FI
512
FC
564
T-540
heavy feed
flow
Figure 13.29 Main Fractionator Injection
Stm/Heavy Feed Ratio Control
TI
555
Wild
naphtha
Wild naphtha
flow
Desired ovhd
temp
SP
SP
Ovhd
temp
TIV555
Validation TC555 Press comp
ovhd temp
PC
516
Ovhd
pressure
FC
546
Figure 13.30 Controlling Overhead
Temperature to Fix Wild Naphtha Yield
This ratio control strategy ensures sufficient injection steam when heavy feed rates increase, helps
prevent excess injection steam utilization when heavy feed rates decrease, and also captures minor
energy savings – a small decrease in steam utilization.
Minimize Wild Naphtha (Distillate) Production (FC546)
The overhead temperature’s (TI555 PV) operating target is specified offline periodically to establish
a target wild naphtha flow (FC546). As presented in Figure 13.30, the control strategy that main￾tains overhead temperature at that specified value manipulates the wild naphtha (distillate) flow
(FC546 SP). TI555 PV is validated before its use in the control strategy and is pressure compensated Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.4 Reactor Effluent Product Separation Section Main Fractionators 545
(PC516) to help manage operator-entered pressure controller set point changes to keep PV516 in
controlling range (see discussion below).
To reduce wild naphtha yield, daily directives periodically lower the overhead temperature target
(TC555 SP). If so, an important constraint variable must be monitored and managed as the tem￾perature is reduced. When TC555 SP is reduced and wild naphtha flow decreases, the D-402 level
(LC511 PV) tends to increase; LC511 then increases reflux flow (FC541 SP). Note that TC555 can
achieve its control objective only if the LC511 → FC541 control cascade is commissioned and per￾forming effectively. Vapor flowing overhead then tends to decrease, overhead pressure, PC516 PV,
tends to decrease, and in response, PC516 closes PV516 to maintain pressure at its set point. As
TC555 SP is decreased, pressure controller PC516 OP may become limited low. Therefore, PC516
must be kept in controlling range – by maintaining its valve position, PV516, above a minimum
value.
Thus, as the overhead pressure controller’s (PC516) valve position (PV516) approaches or is about
to reach its minimum desired value, to ensure overhead pressure control continues, wild naphtha
flow (FC546 SP) cannot decrease, and its wind-up status must be set equal to Low. TC555 resi￾dent user-provided custom code/logic must monitor PV516, and when it is approaching and/or
reaches its desired minimum % open, it must set FC546’s wind-up status to Low. Standard DCS
features will set the wind-up status of TC555 to Low. A console indication that PV516 is at its mini￾mum value would be a warning to operators to assess whether a pressure decrease, i.e., a PC516 SP
decrease, would be an acceptable action, or to ask for authorization to increase TC555 SP to help
relieve the PV516 constraint. When PV516 ultimately returns to normal, TC555’s user-provided
custom code/logic resets FC546’s wind-up status to Normal; standard DCS features will then reset
the wind-up status of TC555 to Normal.
Maximize Gas Oil Yield (FC561) and Minimize Bottoms (Fuel Oil) Product Yield (FI513)
Reducing, or ideally minimizing wild naphtha yield, helps increase gas oil distillate product, T-540’s
most important operating objective. Gas oil product (FC561 PV) is maximized by maintaining the
sulfur content of gas oil at the gas oil’s maximum desired sulfur content by manipulating sidestream
draw-off flow (FC561 SP). However, because internal reflux below the sidestream draw-off tray
decreases as the draw-off flow increases, these draw-off flow adjustments are subject to a number
of potential T-540 and sidestream stripper T-535 min/max constraints: (i) minimum T-540 bottoms
level controller valve position (LV513), (ii) minimum T-540 bottoms flow (FI513 PV), and (iii) max￾imum T-535 bottoms level controller valve position (LV512).
The control strategy that drives the gas oil distillate product’s sulfur content to its maximum
desired value, as limited by any one of the above three constraint variables reaching its constraint
limit, is presented in Figure 13.31. This is a conventional constraint control strategy, with multi￾ple primary controllers and one secondary controller (FC561) – a complex cascade that requires
custom logic/code to manage cascade initialization and wind-up above the LSS. Each constraint
variable is a PID controller tuned for its own response dynamics to a gas oil distillate flow (FC561
SP) change. As indicated in Figure 13.31, each PID controller’s set point is the constraint variable’s
desired minimum or maximum value. When the MV, FC561 SP, is increased, all constraint vari￾ables move toward violation – hence, the signal selector choice for the constraint control strategy
in Figure 13.31 is a LSS.
There are two additional constraints that must be honored – a maximum allowable gas oil
draw-off flow (FC561 SP) and a maximum allowable gas oil flow valve position (FV561). The
maximum allowable gas oil flow valve position (FV561) is specified offline (e.g., 80–90%) and is
enforced with an FC561 OP high clamp (FC561 OPHC).
The best basis for establishing a credible maximum sidestream draw-off flow is a target internal
reflux flow below the sidestream draw-off tray. As shown in Figure 13.31, internal reflux above the Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License546 13 Fractionator Product Quality Control
LSS
VLC513
SP
LV512 LV513
Maximum LC512
valve position %
SP
Minimum LC513
valve position %
FI513 PV FC513
Minimum
allowable FI513 PV 
SP
SP
AC518
Maximum gasoil
sulfur content
SP
AI
518
Validation
FC
561
FV561
Gas oil
distillate
product
Gas oil
sulfur
content
Typical ovhd
temp
IR above D/O tray
[Equation (3.17)] External
reflux flow
Calc max SS D/O
Reflux
temp
FC
541
Validation TIV177 TI555TYP
TI
560
Max desired
SS PV/IR1 PV
IR1 PV 
FI
516
Light feed
from D-552
FC561 SPHC
VLC512
AIV518
Figure 13.31 Maximize Gas Oil Sulfur Content to Maximize Gas Oil Yield
sidestream draw-off tray (IR1 PV) can be calculated using Equation (3.17) in Section 3.7.2 and then
adding the light feed flow (FI516 PV). The maximum allowable draw-off flow is then related to
the magnitude of the internal reflux flow above the draw-off tray7. Remember, reflux flow is reflux
drum (D-502) level controller’s (LC511) MV. As discussed in Section 12.8.3, a guideline value for
the maximum sidestream flow is usually specified as either a percentage (e.g., 80–90%) or frac￾tion (e.g., 0.8–0.9) of the internal reflux flow above the draw-off tray, e.g., Max D/O = [Guideline
% or Ratio] * IR1 PV.8 This also establishes the magnitude of the internal reflux flow below the
draw-off tray relative to the internal reflux flow above the draw-off tray (see Equation (12.11))
and hence ensures satisfactory fractionation above and below the draw-off tray. As indicated in
Figure 13.31, the max draw-off flow target is enforced by storing the calculated max draw-off flow
target to FC561’s set point high clamp (FC561 SPHC). When either FC561’s set point or output high
clamp is active, FC561’s wind-up status is set to High, standard DCS features set the LSS’ wind-up
status to High, and user-provided code/logic sets the wind-up status of all controllers above LSS to
High. Thus, the LSS cannot increase FC561 SP, but it can decrease FC561 SP.
Because the wild naphtha flow rate (FC546 SP) is manipulated by overhead temperature con￾troller TC555 (in Figure 13.30), TC555’s adjustments impact internal reflux. TC555’s wild naphtha
flow adjustments directly impact reflux drum level LC511 PV, and LC511’s reflux flow adjust￾ments to control LC511 PV ultimately impact the internal reflux above and below the sidestream
draw-off tray. Thus, TC555 control adjustments made to minimize wild naphtha product, inter￾act with the max gasoil sulfur content strategy (in Figure 13.31) by impacting (i) the maximum
allowable sidestream draw-off flow, (ii) bottoms level LC513 PV, and hence (iii) constraint variables
LV513 and bottoms flow FI513 PV. However, the MV adjustments to maintain TC555 at target are
executed on a slow frequency and are usually small in magnitude. Thus, these interactions would
typically not be too difficult to manage.
Design issues common to all conventional constraint control strategies are discussed in
Section 7.8. Here are the most important issues to address for the control strategy in Figure 13.31:
7 External reflux flow is paired with reflux drum (D-502) level controller LC511, and thus IR1 PV will normally vary.
8 The online max draw-off target calculation is typically done on a very slow execution frequency.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.4 Reactor Effluent Product Separation Section Main Fractionators 547
● Because constraint variable PID set points are almost never changed, all constraint variable PIDs
are tuned for fast load response, proportional on PV, with SP Init = No.
● Engineer-provided logic/code is required to reset all nonactive CV controller outputs to the active
constraint variable controller’s PID output on each control pass.
● This constraint control strategy’s most important control objective is to maximize gas oil yield.
Therefore, the control strategy should be decommissioned when the sulfur measurement (AI518
PV) is declared invalid or becomes unavailable. This ensures operations are not driven to one
of the three remaining constraint variable high or low limits with no regard for the product’s
sulfur content. Decommissioning, and recommissioning the control strategy when the AI518
PV measurement returns valid or available, must be managed with user-provided custom
logic/code.
● Constraint variable noise can have an important impact – see Section 7.8 for ways to reduce the
harmful effects of noise.
One additional design issue is important: the response of AI518 PV to changes in FC561 SP is
slow, and features a long deadtime. Thus, if configured as a PID, AC518’s control performance
may be poor. Implementing AC518 as a conventional (single input-single output) model-based
controller (Section 2.7) should provide better control performance than the PID.
Important: T-540’s two feeds – light feed, FI514 PV, and heavy feed, FI512 PV, are both uncon￾trolled and subject to upstream process upsets. Upsets in either feed rate affect T-540 operations,
but because their boiling ranges are different, and they enter the tower at different locations, their
impact on T-540 operations is different. Also, overhead temperature and gas oil sulfur content
responses to changes in each feed’s flow rate may have different dynamic characteristics and
parameters. Therefore, including feedforward corrections for feed rate changes is not straight￾forward – it is not clear that major process flows – wild naphtha and sidestream draw-off flows,
should be ratioed to light feed, or heavy feed, or total feed. It is likely that this issue can only be
resolved via an offline tower simulation study and/or via carefully planned and executed plant
tests and test data analysis.
The multivariable and interactive nature of T-540 operations underly a number of issues
that make achieving the control objectives of the conventional advanced control strategies
in Figure 13.30 (minimize T-540 overhead temperature to reduce wild naphtha yield) and
Figure 13.31 (maximize T-540’s gas oil distillate yield) difficult:
● Maximizing T-540’s gas oil distillate yield (Figure 13.31) involves managing three constraints
and many potential active constraint variable switches. Many plant tests must be planned
and executed to determine all constraint variable responses to sidestream draw off (FC561 SP).
Thus, plant test execution and test data analysis are resource-intensive and time-consuming.
● TI555 PV’s dynamic response to changes in FC546 SP is slowed by the dynamic effects of D-502’s
hold-up and is strongly dependent on LC511’s tuning and control performance. In fact, TC555
can only achieve its control objective if the LC511 → FC541 control cascade is commissioned and
performing effectively.
● The dynamic response of LV512 to a change in FC561 SP depends entirely on level controller
LC512’s tuning and control performance.
● The dynamic response of LV513 to a change in FC561 SP depends upon the tuning and control
performance of both LC512 and LC513.
● Feed rates are uncontrolled, feed rate upsets may be normal, and the inability to account for feed
rate changes in either control strategy (via feedforward corrections) may adversely affect control
performance.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License548 13 Fractionator Product Quality Control
The multivariable nature of T-540 operations, the resource and technical issues described earlier
and the issues summarized above – slow CV dynamic responses, some with long dead times, inter￾action of TC555 control adjustments (to minimize wild naphtha product) with max gasoil sulfur
content control, the inability to include feedforward corrections for feed rate changes – all suggest a
multivariable constraint controller like DMC is the best approach to achieve T-540’s control objec￾tives.9 It is the DMC controller’s wider scope – incorporating feed preparation, feed preheat, gasoil
H/F reactor, and reactor effluent cooling/product separation section units, and its ability to iden￾tify multivariable relationships among dependent and independent variables that result in more
effective control performance.
13.4.2 FCCU Main Fractionator ICN 95% Point Control, Pumparound Duty
Management
The control strategy discussed in this section involves heat duty distribution between an FCCU
main fractionator’s (T-571) top and bottom pumparounds (TPA, BPA) to maintain its distillate
product’s 95% distillation point controller’s output in controlling range. T-571’s pumparound and
overhead configurations are shown in Figure 13.32.
TI
526
TI
528
D-535
LC
535
AI
836
ICN
95% Pt
TC
513
T
5
6
8
LLCN
ICN to
DeC4
Naphtha
splitter
FCCU main
fractionator
E-533
E-538
E-534
TV513A
TV513B
LCN
HCN
P-501A/B
FV539
FC
539
Cracking reaction
vapor products
TC
531
T
5
7
1
E-562
TI
532
LE tower
reboiler
Tray temp.
control 
E-678
E-561
E-563
TV531
FC
537
FC
538
∞
∞
Figure 13.32 FCCU Main Fractionator Overhead and Pumparound Configuration
9 DMC is especially skilled at controlling levels. Therefore, the impact/importance of level controllers LC512 and
LC513 on maximizing gas oil yield (Figure 13-31) is another DMC advantage.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.4 Reactor Effluent Product Separation Section Main Fractionators 549
Overhead temperature controller TC513 sets the cutpoint between HCN (heavy cat naphtha), the
first sidestream product, and LCN (light cat naphtha), the distillate product. To meet its SP, TC513
adjusts exchanger E-533 bypass flow via dual-acting valves TV513A and TV513B to change TPA
return temperature (TI526) and hence TPA duty. The overhead vapor is condensed in water-cooled
E-534 and is collected in drum D-535. A portion of the LCN is returned to T-571 as reflux, and
the rest is routed to the downstream naphtha splitter (T-568). In T-568, light LCN (LLCN) and
Intermediate Cat Naphtha (ICN) products are separated as T-568 overhead and bottoms product,
respectively. The LLCN normally becomes alkylation unit feed, while the ICN is stabilized (in a
downstream debutanizer, DeC4) and routed to tankage and becomes a MOGAS blend stock. After
further clean-up, HCN (first sidestream product) also becomes a MOGAS blend stock.
Any HCN boiling range component carry-over to LCN ultimately is removed with the ICN in
T-568 bottoms product. The ICN 95% distillation point, a measured ICN back-end property (AI836
PV), is sensitive to the HCN component carry-over, and thus control of ICN 95% point is determined
by the LCN/HCN cutpoint set by TC513. As shown in Figure 13.33, control of ICN 95% point is
achieved by manipulating TC513 SP; the 95% point measurement (AI836 PV) is validity checked
(by AIV836) before it is used in the control cascade.
The ICN 95% point response to changes in overhead temperature is very slow because of the
slow response dynamics of the fractionator to changes in TPA return temperature (TI526), and the
dynamics associated with the two heat exchangers (E-533, E-534), D-535 hold-up, and T-568 liquid
and vapor hold-ups. The response also includes real deadtime because the AI836 measurement
sample point is located downstream in T-568’s bottoms stream. Because the response is so slow and
contains a long deadtime, acceptable 95% point control (via AC836) is almost impossible to achieve
with PID control. Single input–single output model-based control, with model bias update via the
validated online analyzer measurement (AI836 PV), is an available alternative. However, although
the ICN 95% point correlates quite well with the overhead temperature, the AI836 response’s long
deadtime complicates the plant test effort and the plant test data collection needed to establish the
95% point – overhead temperature dynamic response parameters for the model-based controller.
Even if appropriate tools and methods are used to analyze the plant test data and determine the
dynamic response parameters, the parameter identification and the model’s control performance
TC
513
AI
836
ICN
95% Pt
AIV836
Validation
AC836
SP
Desired
ICN 95% Pt 
SP
Model-based
controller with
model bias update
via AI836 PV
TC513 PV
TV513A
TV513B
E-533
bypass
To
E-533
Figure 13.33 FCCU Main Fractionator/Naphtha Splitter ICN 95% Point Control
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License550 13 Fractionator Product Quality Control
can still be problematic. If additional (disturbance) variables are included in the model, the model’s
control performance should to some extent be improved. However, additional plant tests and plant
test data analysis would be required, and the slow dynamics and additional deadtimes would again
make it difficult to attain acceptable parameter identification and effective model-based control
performance. Thus, it may be best to eliminate AC836 control, and make overhead temperature
TC513 the strategy’s primary. However, for this to be effective, the values chosen for TC513 SP
must correctly infer the desired ICN 95% point target.
Design Notes and Features (for Control Strategy in Figure 13.33)
1. The AC836 → TC513 → TV513 A/B control strategy is a simple cascade, and cascade initializa￾tion and wind-up are both handled by standard DCS features.
2. AC836 is a cascade primary whose setpoint is almost never changed. Normally, SPInit is a config￾urable parameter for any controller, and therefore, model-based controller AC836 is configured
for SPInit = No.
3. TC513 is a cascade secondary and therefore it is tuned for best SP response, proportional on error,
with SPInit =Yes. TV513A and TV513B are dual-acting valves – their valve characteristics are
presented in Figure 13.34, and discussed further following design note #4. TC513 control direc￾tion is Direct – if temperature is too high, TC513 increases E-533 duty, i.e., TC513 OP increases,
and consequently, if TC513 OP is greater than 50%, less TPA is bypassed (TV513B closes) or
if TC513 OP is less than 50%, more TPA is routed to E-633 (TV513A opens). Remember: The
DCS manages the dual-acting valve’s characteristic and failure mode external to the controller’s
configuration and calculations. As indicated in Figure 13.34, this ensures that when TC513
OP>50% and TC513 OP increases, the bypass valve (TV513B) closes with TV513A full open
or when TC513 OP<50%, and TC513 OP increases, the exchanger feed valve (TV513A) opens
with TV513B full open.
4. Since AC836 is a model-based controller, if the ICN 95% point measurement is declared
invalid by AIV836 or becomes unavailable, the AC836 model is not updated, and there is no
0% 50% 100%
100% 100%
0% 0%
TC513 OP
TV513A
% open
TV513B
% open
E-533 duty increasing
Figure 13.34 TV513 A/B Valve Characteristic
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.4 Reactor Effluent Product Separation Section Main Fractionators 551
feedback – TC513 SP remains constant. If true for an engineer specified (small) number of
AIV836’s validation execution passes, it is best to stop all control action by AC836 and transfer
TC513 into auto mode. Overhead temperature control continues at the last TC513 SP calculated
by AC836 until an operator enters a new TC513 SP, or AI836 returns valid, and the entire
control cascade is recommissioned.
We now look at the need to keep TC513 OP in controlling range so that AC836 (or TC513) can
continue to meet the desired ICN 95% point target. To do this, refer to the valve characteristics of
TV513A and TV513B displayed in Figure 13.34. TV513A and TV513B are dual-acting valves that
are both fully open when TC513 OP = 50%. With TV513B fully open, as TC513 OP increases from
0% to 50%, TV513A opens from 0% to 100% (full open). TPA flow through E-533 gradually increases,
increasing E-533 duty, and thus, TPA duty. As TC513 OP increases above 50%, TV513B begins to
close, bypassing less flow around E-533 (while TV513A remains full open). This increases E-533
and TPA duties further since more TPA flow is routed through E-533. Because there is more cooling,
the return temperature (TI526 PV) decreases, which then can reduce TC513 PV.
However, operations experience indicates that when bypass valve TV513B is ≈ 70–80% closed,
TPA flow (FC539 PV) begins to slowly decrease, and FV539 goes full open as TV513B is closed
further. This anomaly occurs for this specific TPA configuration because the TPA pump capaci￾ties (P-501 A/B) are not sufficient to overcome the pressure drop increase that develops as TV513B
closes. Because TPA flow is decreasing, TPA duty decreases even though TV513B is closing (to
decrease E-533 bypass flow) and return temperature (TI526 PV) may be decreasing to some extent.
Therefore, overhead temperature control via TC513 and ICN 95% point control via AC636 are inef￾fective when either (i) FV539 is full open, indicating FC539 PV is at a maximum value or (ii) TV513B
is closing but TPA duty is not increasing or is decreasing. If so, TC513 OP is no longer in controlling
range and TC513 PV can no longer be maintained at TC513 SP.10
To detect this irregularity, TPA duty (which must be calculated), TV513B, TPA flow (FC539 PV),
and TPA return temperature (TI526 PV) must be monitored. When TPA duty is decreasing while
TV513B is closing, TPA duty is constrained high (e.g., FC539 PV is decreasing and/or TI526 PV
is increasing, or FV539 is full open). One possible approach is to increase the BPA heat duty – for
example, by a fixed percent of the total pumparound heat duty,11 to decrease the amount of heat the
TPA must remove. As a best-case scenario, if the increase in BPA heat duty is sufficient, tempera￾tures in the upper section of the tower will decrease. With temperatures in the upper section of the
fractionator decreasing, overhead temperature, TC513 PV, will also tend to decrease. If so, TC513
OP decreases to open TV513B (to increase bypass flow). This reduces the load on the TPA pumps
(P-501 A/B), TPA draw-off flow (FC539 PV) recovers, and it correlates once again with FV539. This,
in a best case scenario, returns TC513 OP to controlling range.
However, increasing BPA duty will also affect fractionation below the BPA return tray, and impact
liquid and vapor loading throughout the tower. Thus, the BPA duty increase can also impact prod￾uct quality and yields, including ICN yield and ICN 95% point. Also, remember heat recovery is
somewhat discouraged by the lower temperatures in the upper sections of the fractionator. There￾fore, choosing the magnitude of a BPA duty increase to move TPA duty away from its high constraint
limit is not straightforward, nor is it easy to identify and evaluate the total impact of the fraction￾ation changes that follow. Clearly, a full understanding of the BPA heat duty increase’s impact on
T-540 operations is necessary.
10 If a consistent problem, this indicates improved ICN product quality or yield cannot justify the purchase and
installation of additional (or replacement) TPA pump capacity
11 This is possible only if BPA duty is not being controlled or adjusted (e.g., it is not an MV) to satisfy another
control objective. If it is an MV, then overriding this other control strategy must be justified.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License552 13 Fractionator Product Quality Control
A conventional advanced control approach to monitor and adjust T-571 TPA and BPA duties and
maintain TC513 OP in controlling range requires the execution of a number of sequential actions,
logically guided by user-provided custom logic/code, that taken together, is complex and cumber￾some. Here is an overview of those actions and logic checks:
1. Calculate TPA, BPA, and total pumparound duties.
2. Monitor FV539, TV513B, and TPA duty and detect whether TPA duty is limited; the criteria used
is (i) FV539 full open, or (ii) TPA duty decreasing while TV513B is closing. If TPA duty is limited,
transfer TC513 into Auto mode to ensure AC836 does not wind up TC513 SP.
3. Assuming BPA duty is controlled, and it is in Auto mode and not wound up, BPA duty is
increased. The BPA duty increase is a fixed percent of the current total pumparound duty.
4. After waiting for an engineer specified number of execution passes for T-571 to respond to the
BPA duty increase, the monitor checks to see if TPA duty has returned to normal. If normal,
TC513 is considered in controlling range. TC513 is transferred to Cascade mode to recommission
the AC836 → TC513 → TV513 A/B cascade.
5. If TPA duty is still constrained, the program waits for the engineer’s specified number of passes
and then again checks the status of TPA duty. If normal, TC513 is transferred to Cascade mode.
6. If TPA duty is still constrained, a console display indication is activated to inform operators that
despite the T-571 BPA duty increase, T-571 TPA duty is still constrained high. No further action
is taken as the monitor continues to check the TPA duty status. Another increase in BPA duty
can only be authorized by a design-specified operator entry.
Design Notes and Features
With the above user-provided custom logic/code/configuration included in the control strategy’s
design, here are the strategy’s more important design issues and features:
1. Use of the TPA and BPA flow and draw-off/return temperature PV or SP in the TPA and BPA
duty calculations, and in each case, choosing SPInit =Yes or No.
2. Current TPA duty and bypass valve position trends must be calculated. This requires past values
of TPA duty and bypass valve position to be stored, continuously updated and when appropri￾ate, initialized. Criteria (i.e., “dead bands”) must be developed to decide how much larger (or
smaller) than zero a trend must be to be declared positive (or negative).
3. The TPA duty/status monitor must store a new BPA duty set point when a T-571 TPA duty lim￾itation is detected. Thus, the BPA set point store functionality must recognize the initialization
and wind-up status of the BPA duty controller.
4. TPA draw-off (TI528 PV) and return (TI526 PV) temperatures and BPA draw-off temperature
(TI532 PV) are needed for the calculations of TPA and BPA heat duties. Using a last good value
is not acceptable, given how critical the duty calculations are to achieving the strategy’s control
objective. Therefore, when any one of these temperatures is declared invalid or is unavailable,
the TPA duty status monitor/duty adjustment cannot make any changes to the BPA duty. How￾ever, ICN 95% point control remains commissioned without the TPA duty status monitor.
5. When an invalid or unavailable temperature becomes valid or available once again, the TPA
duty status monitor/duty adjustment can be recommissioned, but all historical data needed to
calculate trends must first be initialized to current values.
Last Thoughts and Closing Remarks
It was concluded in Section 13.4.1 that a true multivariable constraint controller (DMC) is a better
choice, compared to the section’s conventional advanced control approach, for achieving the gasoil Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License13.4 Reactor Effluent Product Separation Section Main Fractionators 553
H/F main fractionator’s (T-540) control objectives. The basis for this conclusion is summarized
below:
– T-540’s operations are inherently multivariable
– Control variable dynamic responses are slow, and some have long deadtimes
– T-540’s conventional advanced control strategies that minimize wild naphtha production, max￾imize gas oil yield, and minimize fuel oil (bottoms) product yields interact with each other
– Feedforward corrections for light and heavy feed rate changes, important upset sources, cannot
be included in the conventional advanced control strategies unless and until focused plant testing
and plant test data analysis provide a better understanding of T-540’s feed rate sensitivities.
Likewise, this section’s FCCU main fractionator (T-571) ICN 95% point conventional advanced
control strategy’s control objectives will almost certainly be achieved more effectively if incorpo￾rated into a wider-scope DMC controller. The reasons, presented earlier in this section, are sum￾marized below:
– The coding, testing, commissioning, and maintenance of the T-571 pumparound duty manage￾ment and ICN 95% point control strategies as described above, are complex, potentially problem￾atic, and resource-intensive tasks.
– Key T-571 control variable responses to changes in the principal independent variables are slow,
and in some cases, contain significant deadtimes. The number and duration of the necessary
plant tests, and the analysis of the plant test data, are also resource-intensive tasks.
– There are many key T-571 process variables that interact with several other T-571 process vari￾ables. A good example: the BPA heat duty’s impact on multiple aspects of T-571 operations.
– Determining the impact of BPA heat duty changes on T-571 operations is difficult and
time-consuming. And after their impact is understood, additional effort will be needed to
account for, and incorporate, their consequences.
– If there are additional constraints in upstream and/or downstream units that have an impact on
T-571 operations, incorporating them into the conventional advanced control strategy may not
be possible, even if their inclusion could improve control performance. Even if justified, this will
almost certainly require significant engineering resources to complete.
The DMC controller’s scope would not only include T-571 and T-568, but would include
upstream units (e.g., feed preparation, feed preheat, FCCU reactor/regenerator), additional
downstream units (e.g., DeC4 tower), and all process units that exchange heat with nonair-cooled
and nonwater-cooled TPA (E-538) and BPA (E-563, E-578, and E-562) heat exchangers. The larger
scope, and the ability to identify and include multiple fractionator CV – MV – DV steady state and
dynamic relationships are the major reasons why a DMC controller is preferred, not only for this
application but for most main fractionator product quality control and fractionation management
applications.
Note: The engineering and operations resources required for plant testing, plant test data analysis,
controller tuning, online monitoring, and operator training will be significant. Although a non￾trivial task, the commercially available DMC tools included with the basic package normally make
these tasks manageable.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License554
14
Reactor Conversion Control
CHAPTER CONTENTS
14.1 Reactor Control Fundamentals
14.1.1 Heat of Reaction
14.1.2 Rate of Reaction – Effects of Composition and Temperature
14.1.3 Heat and Mass Transfer Effect on Reaction Rate
14.1.4 Catalyst Activity, Catalyst Deactivation, and Catalyst Run Length
14.1.5 Treat Gas and Hydrogen Partial Pressure
14.1.6 Residence Time, Space Velocity, and Throughput Control
14.1.7 Reactor Feed Mix Control
14.2 Reactor System Unit Configurations
14.2.1 Feed Preparation Section
14.2.2 Feed Preheat Section
14.2.3 Reactor Section
14.2.4 Reactor Effluent Cooling and Product Separation Section
14.3 Reactor System Control Objectives, CVs, MVs, and DVs
14.3.1 Reactor System CVs
14.3.2 Reactor System MVs
14.3.3 Reactor System DVs
14.3.4 Bottom Line: Effective Reactor Control is Difficult to Achieve
14.4 Conventional Reactor Advanced Control Applications
14.4.1 Diesel Hydrofiner Effluent Sulfur Control
14.4.2 Gas Oil Hydrofiner R-535 Conversion Control
14.4.3 Hydrodesulfurization (HDS) R-725 A/B/C Conversion Control
14.4.4 Naphtha Hydrofiner Reactor R-135 Partial Pressure Control
14.4.5 Gas Oil Hydrofiner (R-305) Product Stripper Tower (T-307) Bottoms Quality Control, Inlet
Temperature Maximization
References
Reactors are used extensively throughout the petrochemical and pharmaceutical industries.
They are fundamental to meeting a plant’s operating objectives and providing desired products.
Examples include the production of gasoline (e.g., catalytic cracking, catalytic reforming), jet
fuels (e.g., isomerization, alkylation), ethylene and other olefins (e.g., steam cracking), hydrogen
(e.g., steam reforming), diesel and fuel oil (e.g., hydrotreating, hydrofining), and polymers (e.g.,
polyethylene, polypropylene).
There are a wide variety of reactor types found in industrial applications – batch and contin￾uous, isothermal and nonisothermal, tubular and well-stirred tank, fixed bed and moving bed,
single bed and multi-bed, series and/or parallel reactors. There is also a wide variety of reaction
types – homogenous and heterogeneous, endothermic and exothermic, catalyzed and noncat￾alyzed, elementary and complex, thermodynamic and chemical kinetic limited. In most cases,
Practical Process Control Design with Industrial Applications, First Edition. Alan M. Kugelman.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.1 Reactor Control Fundamentals 555
the extent of reaction can also be limited by the interaction of heat and material balances internal
to the reacting system, and/or heat and mass transfer with the reacting system’s surroundings.
With the wide variety of reactor and reaction types found in industry, a comprehensive discussion
of reactor controls would be a prohibitive task. Although there are many different reactor systems
with many different unit configurations in current operation, this chapter explores fundamental
reactor control concepts for an important subset of reactor/reaction types – petroleum refinery
fixed bed catalytic reactor systems that produce various distillate (kerosene, diesel) and low sul￾fur fuel oil products in an H2-rich atmosphere. Note that the underlying engineering principles,
the importance of reactor temperature control, and the design issues identified for these fixed bed
catalytic reactor systems are generally applicable to many other reactor systems.
The three realities most critical in control strategy designs for these reactor systems are: (i) the
rate of reaction increases exponentially with increasing temperature, and thus temperature has a
very significant effect on conversion, (ii) the solid catalyst slowly deactivates and because the rate
of reaction slowly decreases as the catalyst run proceeds, reactor operating temperatures must be
slowly increased from start-of-run to end-of-run, and (iii) in many cases, the reactions are either
very exothermic or very endothermic, and therefore temperatures either increase or decrease from
bed inlet to bed outlet, and inter-bed or intra-bed heating or cooling is required to maintain con￾version (endothermic reactions) or prevent temperature runaways (exothermic reactions). Most
reactor systems have similar process alignments, structured into four sequential sections: feed
preparation, feed preheat, reactor(s), and effluent cooling and product separation. Although they
represent a logical sequence of unit operations, from reactants in to products out, there are mate￾rial and energy interchanges among units in all four sections that introduce interactions, and make
effective control more difficult to achieve.
Although the focus is on reactor temperature control and other process variables (treat gas/feed
ratio, H2 partial pressure) that play important roles in achieving the conversion control objective
(reactor section), important control strategies implemented in feed preparation, feed preheat, and
effluent cooling and product separation sections are also presented and discussed. The control
strategies discussed are industrially important and are applicable to real, reactor system config￾urations.
Note: Because chemical reactor utilization is so essential and widespread, some of the impor￾tant conventional advanced control strategies already presented and discussed in earlier chapters
involve reactor feed, preheat, temperature, and product property controls. These control issues –
namely reactor feed preparation, reactor feed preheat, reactor temperature, and reactor effluent
property controls are the focus of this chapter. Therefore, some of these previously presented con￾trol strategies are referenced to help clarify or broaden a specific reactor control issue.
14.1 Reactor Control Fundamentals
Reaction systems are complex, and their operations are established by the simultaneous resolution
of their chemical kinetic, thermodynamic, flow regime, and heat and mass transfer characteristics.
However, detailed knowledge of these characteristics is not necessary to design and implement
reactor control strategies that ensure safe and profitable reactor operations. This section presents
the basic characteristics of chemical reaction systems that have the most significant impact on the
design and implementation of reactor system control strategies. Since the reactor control strategy
examples presented in this chapter feature heterogeneous reaction systems with solid catalysts,
the reactor control fundamentals described below focus on reaction systems that include solid
catalyst-promoted reactions.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License556 14 Reactor Conversion Control
Important: In university chemical kinetics courses, conversion is understood to mean the percent￾age or fraction of a given reactant converted to product. However, in the more complex reaction
systems encountered in the petrochemical industries discussed in this chapter, the term conver￾sion should be understood to more broadly mean the extent of reaction required to meet a yield or
product quality target.
14.1.1 Heat of Reaction
The heat of reaction, ΔHR – the change in enthalpy of products and reactants after products are
restored to the same temperature and pressure as reactants, is provided by thermodynamics. If the
heat of reaction is positive, the chemical reactions generate heat as they progress to completion.
This is an exothermic reaction which is accompanied by an increase in temperature as the reaction
proceeds. If the temperature increase can become too large before the desired conversion is reached,
the reaction mixture is cooled by either an inter-bed quench stream or via heat exchange with a
cooler process stream before entering a second catalyst bed or a second reactor.
If the heat of reaction is negative, the chemical reactions consume heat as they progress to
completion. This is an endothermic reaction which is accompanied by a decrease in temperature
as the reaction proceeds. If the temperature decrease can become too large before the desired
conversion is reached, the reaction mixture is heated by either a fired heater or via heat exchange
with a warmer process stream to raise the reaction mixture’s temperature high enough to initiate
the desired reactions before entering a second catalyst bed or a second reactor.
The heat of reaction’s engineering units are normally heat generated (exothermic) or consumed
(endothermic) per unit mole or unit mass of reactant consumed or per unit mole or unit mass of
product produced.
14.1.2 Rate of Reaction – Effects of Composition and Temperature
Chemical kinetics provides the factors that directly influence the rate of reaction. The rate of reac￾tion is normally expressed as a composition-dependent term and a temperature-dependent term:
r = f1(Composition) ∗ f2(Temperature) (14.1)
where
f1 = k ∗ Ca
A ∗ Cb
B ∗ … Cp
P (14.2)
and
f2 = ko ∗ exp(−E∕RT) (14.3)
The rate of reaction is normally expressed as the moles or mass of reactant consumed or product
produced per unit of time per unit mass of catalyst. Thus, the product of heat of reaction and reac￾tion rate, e.g., [ΔHR * r], is the heat generated (exothermic) or consumed (endothermic) per mass
of catalyst per unit of time.
In Equation (14.2), CA, CB,…, CP are appropriate measures of reactant and product (A, B, …, P)
compositions. Because of the reaction rate’s composition dependency, the reactor’s feed composi￾tion impacts the rate of reaction. Although feed rate is always measured and normally controlled,
feed composition is usually very difficult to measure, and therefore, it is rarely controlled. However,
for reactors that have more than one feed source, instead of the feed composition, the feed mix
can be controlled.1 Note that in the discussions to follow, component compositions for gas phase
1 An example has already been presented – see the discussion of Figures 9-16 and 9-17 in Section 9.5.3.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.1 Reactor Control Fundamentals 557
reactions are sometimes expressed as partial pressures. If so, reactor pressure can directly impact
the rate of reaction, and play an important role in determining reactor performance.
Equation (14.2) indicates the reaction is ath order with respect to component A, bth order with
respect to component B and pth order with respect to component P. The sum of the individual com￾ponent orders (a+b+···+p) is n, the overall order of reaction. For a reaction in which the specific
reaction mechanism is known, the a, b, ···, p are integers and correspond to known reaction stoi￾chiometric coefficients. However, in almost all cases, the rate equation is derived by fitting kinetic
data to specific analytic reaction rate expressions. Thus, they are almost always best-fit coefficients
that are normally not integers and are not related to stoichiometry.
The kinetic rate “constant” in Equation (14.2), k, is a parameter that depends upon the reactor’s
feed composition, the catalyst’s properties, and most importantly, the catalyst’s activity – its ability
to promote the desired reactions. This parameter is normally another kinetic best-fit coefficient that
in reality varies with time as the catalyst deactivates over the catalyst run, but which is normally
evaluated once and assumed constant.
As indicated in Equation (14.3), the Arrhenius temperature dependence is exponential, and is a
function of the reaction’s activation energy, E, a thermodynamic parameter, and the universal gas
constant, R. Thus, given the Arrhenius term – exp (−E/RT), in Equation (14.3), the rate of reaction
increases exponentially with increasing temperature. As a consequence, temperature has a very
significant effect on the rate of reaction, and this is why temperature control is the most important
element of most reactor control strategies. Reactor temperature control almost always includes
maintaining the reactor inlet temperature at a desired target, and frequently includes maintain￾ing the reactor outlet temperature at a desired target. Together, these two control strategies man￾age the reactor’s conversion and the reactor effluent’s quality. In addition, for catalyzed reactions
occurring in fixed bed reactors, bed average temperature, equivalent isothermal temperature (EIT),
and Weighted Average Bed Temperature (WABT) are calculated and sometimes used in reactor
temperature control strategies (discussed in Section 14.2.3). These calculated, average, or weighted
bed temperatures are useful because they provide a single temperature to monitor or control despite
nonisothermal bed conditions.
Note: The temperature dependency on the rate of reaction in Equation (14.2) is (very) nonlinear,
which is one of the reasons why reactor temperature control is very challenging.
Important: The heat of reaction determines the direction (temperature increases if the reaction
is exothermic, temperature decreases if endothermic) and the magnitude of the temperature
change as the reaction progresses to completion. However, it is the rate of reaction’s temperature
dependency that determines the magnitude of the conversion change that results.
14.1.3 Heat and Mass Transfer Effect on Reaction Rate
In addition to the rate of reaction’s temperature and composition dependency in Equation (14.1),
for catalytic reactions – specifically heterogeneous reaction systems with solid catalyst particles,
heat and mass transfer also affect the rate of reaction. It is the proximity of the reactants to “active
sites” on the catalyst surface that promote chemical reactions. However, solid catalysts are porous,
and chemical reactions are promoted at gas-solid interfaces on catalyst surfaces both internal and
external to the catalyst’s pores. Figure 14.1 displays a section of catalyst containing a single pore.
In Figure 14.1, there are a number of physical processes that occur as reactants leave the reactor’s
main gas flow, attach to active sites on catalyst surfaces, react to form products, and products return
to the reactor’s main gas flow:
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License558 14 Reactor Conversion Control
Interior (pore) surface
Single catalyst pore
Surface, external to pore 
Gas film
Reactants
Products
Heat
Reactor’s main
gas flow
Figure 14.1 Heat and Mass Transfer In a Porous Catalyst
● Reactants diffuse from the reactor’s main gas flow, through the gas film, to the catalyst’s external
surface.
● The porous catalyst’s interior surface area far exceeds the catalyst’s external surface area; there￾fore, most of the chemical reactions take place within the catalyst particle’s pores. The reactants
move through the pore’s fluid phase, find an active site on the catalyst surface, react to form
products, and the products enter the fluid phase within the pore.
● Products diffuse out of the pore, and along with products formed by reactions at active sites on
the catalyst’s external surface, diffuse through the gas film and into the reactor’s main gas flow.
● Also, depending upon the heat of reaction, the flow of heat out of the reaction zones (for exother￾mic reactions) or the flow of heat into the reaction zones (for endothermic reactions) are fre￾quently not fast enough to maintain constant temperatures on the catalyst surfaces. The rate of
reaction will be impacted if the catalyst surface temperatures heat up or cool down.
Thus, for heterogeneous reaction systems with solid, porous catalyst particles, the resistance to
mass transfer and heat transfer within the catalyst pores and/or the gas film can both have an
important impact on the rate of reaction.
14.1.4 Catalyst Activity, Catalyst Deactivation, and Catalyst Run Length
Almost all solid catalysts lose activity – deactivate, as the catalyst run proceeds. As a consequence,
the rate of reaction is reduced as the catalyst run proceeds. Fouling refers to deactivation caused
by the buildup of deposits that physically block the catalyst surface – a relatively fast process
that may need timely resolution. Poisoning refers to the modification of the catalyst’s surface by
chemisorption on the catalyst’s active sites – a relatively slow process. Therefore, deactivation can
be very rapid – 10–20 seconds (e.g., FCCU reactor), or quite long – one to five years (e.g., hydrodesul￾furization or a gas oil hydrofining reactor), before the catalyst must be reactivated/regenerated.
The reactor control strategies discussed in this chapter are all affected by the slow deactivation
of the catalyst and, as a consequence, the slow decrease in the rate of reaction as the catalyst run
proceeds.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.1 Reactor Control Fundamentals 559
TI
in
TI
out
Temperature (T)
Distance
along
catalyst
bed
Reactor bed 
inlet
Reactor bed
outlet
Start of run End of run
TIN
TOUT
TIN
TOUT
Conversion (X) 
X = 0 Desired X
End of run Start of run
Figure 14.2 Fixed Bed Reactor Temperature and Conversion Profiles – Start-of-Run versus End-of-Run
For most reaction systems that deactivate relatively slowly (one to five years), the reactor must
be shut down and taken out of service to allow the reactivation/regeneration processing (chemical
removal of coke deposits, metals, other contaminants) to occur. As the catalyst deactivates from
start-of-run to end-of-run, the kinetic rate “constant” k, in Equation (14.2), is impacted, and its
decrease causes the rate of reaction to decrease. In order to maintain the desired conversion and to
compensate for the decrease in the rate of reaction caused by the deactivation of the catalyst, the
reactor’s operating temperatures must be increased. Therefore, to maintain the desired conversion,
the reactor outlet temperature2 is slowly increased from the start of the catalyst run to the end of
the catalyst run.
Figure 14.2 illustrates how reactor temperature and conversion profiles progress for an exother￾mic reaction as the catalyst run proceeds from start-of-run to end-of-run. At the start of the run,
when catalyst activity is at its maximum, the rate of reaction is very fast, and conversion reaches
the desired value within the catalyst bed. From that point in the bed onwards, temperatures and
conversion remain about the same because reaction has essentially stopped. As the catalyst run
proceeds and the catalyst deactivates, reactor temperatures are increased to compensate; at this
point, temperatures and conversion continue to increase throughout the bed. Reactor tempera￾tures will continue to be increased until bed temperatures become too high, for example, at bed
temperatures known to promote excessive cracking and/or coke formation and limit conversion to
desired products.
2 As discussed later in this chapter, when the outlet temperature is controlled, its setpoint is slowly increased over
the catalyst run. The inlet temperature is always controlled, and the outlet temperature controller resets the inlet
temperature controller’s set point. The temperature difference developed along the reactor bed ultimately
establishes the conversion achieved.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License560 14 Reactor Conversion Control
Important: The catalyst run plan, both the run length and the guidelines that establish the reactor’s
operating temperatures over the run length, is an operations directive that is very important to
meet. Because it involves a unit shutdown, an unscheduled, earlier-than-planned catalyst reactiva￾tion/regeneration can have a major impact on unit and plant profitability.
Note: Effective reactor controls can help meet end-of-run targets and thus help manage catalyst
deactivation, but there are no reactor control strategies that can explicitly control deactivation.
14.1.5 Treat Gas and Hydrogen Partial Pressure
The hydrotreating reaction system examples explored in this chapter, hydrofining, and hydrodesul￾furization, are relatively mild reactor operations whose primary operating objective is to saturate
feed olefins or reduce the sulfur, nitrogen and/or metal content of the feed by catalytic reaction
with hydrogen. Unlike hydrocracking, which converts a feed stock to more valuable products
with lower boiling ranges than the feed, hydrotreating products have boiling point ranges about
the same as the feed – its purpose is to stabilize, not alter, the feed. The stringent requirements
implemented over the last 15–20 years to lower the sulfur content of heating and fuel oils have
increased the importance of hydrotreating and have generated a large variety of grassroots
hydrodesulfurization units.
Hydrogen is not only an important reactant; it also helps reduce cracking and coke production
and thus helps manage the rate of catalyst deactivation. Catalytic reforming, a reaction system
that produces a gasoline boiling range product (and large amounts of H2), operates in an H2-rich
environment; like hydrotreating, the H2 helps reduce the catalyst deactivation rate. For this reason,
hydrotreating and reforming are important examples of reaction systems that operate with large
amounts of excess H2, and the reactor’s H2 partial pressure is a key reaction process variable – it
impacts conversion, product quality, and the catalyst deactivation rate.
The hydrogen-rich treat gas (and recycle gas) is mixed with the hydrocarbon feed, and the
combined feed stream provides the hydrogen needed to support the desired reactions. The treat
gas also helps maintain catalyst activity by reducing in situ cracking and over time, lowering
the coke-on-catalyst. The treat gas source is the recycle gas or make gas headers. These headers
routinely receive off-gas with widely different H2 content from several refinery operating units.
Hence, treat gas H2 purity, which affects the treat gas flow needed to meet the desired reactor H2
partial pressure, typically varies. However, treat gas H2 purity is often measured, and if measured,
it can be controlled if there is a high H2 purity make-up stream available to manipulate to affect
H2 purity.
Unlike H2 purity, H2 partial pressure cannot be measured but must be calculated. As shown in
Equation (14.4) below, the H2 partial pressure (H2 PP) can be estimated from the treat gas and
hydrocarbon flows, treat gas H2 purity, and reactor pressure:
H2 PP = Press ∗
{[S1 ∗ H2Purity
100% ∗ TG]/[S1 ∗ H2Purity
100% ∗ TG + S2 ∗ HC Feed]}
(14.4)
where
S1, S2 Scale factors to put treat gas and HC feed on a consistent volumetric or
molar basis
TG Treat gas volumetric flow
HC Feed Hydrocarbon feed volumetric flow
H2 Purity Treat gas H2 purity, %
Press Reactor inlet or outlet pressure, or average reactor pressure
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.1 Reactor Control Fundamentals 561
Factoring the hydrocarbon feed (HC Feed) out of the denominator of Equation (14.4) yields:
H2PP = Press ∗
[
S1 ∗ H2Purity ∗
( TG
HC Feed
)] / [S1 ∗ H2Purity ∗
( TG
HC Feed
)
+ S2
]
(14.5)
Equation (14.5) shows that the H2 partial pressure estimate depends on the treat gas H2 purity,
the treat gas/HC feed ratio, and reactor pressure. Thus, ratioing treat gas to hydrocarbon feed
helps maintain the desired reactor H2 partial pressure as the hydrocarbon feed rate changes.
Equation (14.5) also indicates that reactor pressure has a direct impact on H2 partial pressure.
Remember: H2 partial pressure is a very important hydrotreating and reforming reactor process
variable – as partial pressures increase, cracking reactions, and coke production, and hence the
rate of catalyst deactivation, all decrease. This can allow reactor operations at somewhat higher
temperatures – this on average improves conversion.
Note: When Equation (14.4) or (14.5) is used to estimate the H2 partial pressure, and H2 par￾tial pressure is controlled (e.g., it is a PID’s PV input), there is no H2 partial pressure measure￾ment feedback – Equations (14.4) and (14.5) are model predictions, but because the partial pres￾sure cannot be measured, there is no capability to update a bias. The actual partial pressure is, in
effect, unknown. Therefore, because partial pressure cannot be measured, it can only be controlled
indirectly.
In addition to using Equation (14.5) to estimate H2 partial pressure, it can be rearranged to solve
for the treat gas/feed ratio that corresponds to the offline specified H2 partial pressure target. Reac￾tor pressure and treat gas H2 purity are typically set by upstream or downstream operations and
are not degrees of freedom. Therefore, for an offline specified H2 partial pressure (H2 PP SP), and
current values of reactor pressure (Press PV) and treat gas H2 purity (H2 Purity PV), Equation (14.5)
can be solved for the corresponding value of the treat gas/feed ratio target:
TG
HC Feed = H2PP SP ∗ S2
S1 ∗ H2Purity PV ∗ (Press PV − H2PP SP) (14.6)
Whether Equation (14.5) is used to calculate H2 partial pressure to be a PID controller’s PV input,
or Equation (14.6) is used as an algebraic control algorithm, the H2 partial pressure control strat￾egy shown in Figure 14.3 accounts for the reactor’s H2 partial pressure target, changes in reactor
pressure, and changes in treat gas H2 purity:
Note: As shown in Figure 14.3, to improve the partial pressure estimate used in control, and/or
more effectively control the treat gas/feed ratio, whenever possible (the necessary measurements
are available), the treat gas flow is temperature, pressure and/or molecular weight compensated so
that the most accurate measure of treat gas flow is used. Flow compensation is discussed in Section
8.9. Included in that discussion are the advanced control components utilized, and their associated
design issues.
Remember: Whether Equation (14.5) is used and H2 partial pressure is controlled via a PID algo￾rithm or Equation (14.6) is used as the arithmetic control algorithm to calculate a new treat gas/feed
ratio set point, there is no measurement feedback – Equations (14.5) and (14.6) are in principle
model predictions, but because partial pressure cannot be measured, there is no capability to update
a model bias.
Because they reduce energy utilization, a number of control strategies that manage treat gas flow
and H2 purity were presented in Chapter 11 (Energy Conservation Controls). These strategies illus￾trate many of the control objectives and control issues that are common to these types of control Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License562 14 Reactor Conversion Control
HC feed
flow
T, P, MW Comp
TG Calc, Ctl
SP
Reactor H2
partial pressure
control
Desired reactor
partial pressure
SP
Reactor
pressure
Treat gas
temperature
Treat gas
H2 purity (%)
Validation
TG/feed
ratio control
SP
Validation
Treat gas
pressure
Treat gas
H2 purity (%)
TG/feed
ratio
Treat gas
flow
Reactor treat gas
FI
Figure 14.3 H2 Partial Pressure Control
strategies. The examples presented illustrate that routing treat gas to hydrotreaters, hydrofiners,
and reformers, from treat gas, recycle gas and/or make-up gas headers, requires an understanding
of specific characteristics of the gas header’s configuration, and they must be understood before
treat gas/feed ratio control strategies can be designed. The specific process configurations and con￾trol strategies presented in Chapter 11 are briefly summarized below – details can be found in the
referenced sections.
In Section 11.6.2, for the catalytic reformer recycle gas, hydrocarbon feed configuration in
Figure 11.44, the operating objective is to use only enough H2-rich recycle gas to meet a first
catalytic reformer reactor partial pressure operating target. This reduces reactor feed preheat
requirements and thus fuel consumption in preheat fired heater (F-501). It also tends to make
more H2-rich reformer off-gas available as make gas for the treat gas system. The control strategy
proposed in Figure 11.45 manipulates the recycle gas flow, to meet a desired recycle gas H2
content/oil feed ratio target – not a desired recycle gas flow/oil feed ratio target. The calculation
of the recycle gas H2 content/oil feed ratio is enabled by the availability of the recycle gas H2
purity measurement; it helps meet the offline specified reactor H2 partial pressure target more
effectively.3
In Section 11.6.3, for the naphtha hydrofiner (NHF) feed – treat gas configuration in Figure 11.46,
energy savings are captured by providing only enough H2-rich recycle gas flow to meet the offline
specified treat gas/oil feed ratio; this reduces the recycle gas compressor’s (C-610) operating costs.
Control of the NHF treat gas to feed ratio is straightforward and presented in Figure 11.47. However,
recycle gas H2 purity varies with NHF and amine scrubber operations, and thus, treat gas hydrogen
content typically varies at constant recycle gas flow. Because the recycle gas H2 purity is measured,
and H2-rich make gas is an available degree of freedom, the recycle gas H2 purity can be controlled
by manipulating the make gas flow (see Figures 11.48 and 11.49). Limiting make gas flow to only
3 In Section 11.6.2, the recycle gas H2 content/oil feed ratio is calculated in Equation (11-16) using the current
validated recycle gas H2 purity, the current recycle gas flow and the current oil feed flow.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.1 Reactor Control Fundamentals 563
the amount needed to maintain the desired recycle gas H2 purity (i) reduces the C-610 operating
costs and (ii) helps avoid dumping H2-rich make gas to the fuel gas header. With these control
strategies treat gas H2 content is better able to meet the NHF’s H2 partial pressure target.
In Section 11.6.1, for the gas oil H/F (R-901) configuration in Figure 11.39, H2-rich make-up
gas and recycle gas from the recycle gas compressor (C-914) are combined and become the gas oil
H/F’s treat gas. The control strategy proposed in Chapter 11 has two components – treat gas/oil
feed ratio control (in Figure 11.40) and treat gas H2 purity control (in Figure 11.41). Since recycle
gas H2 purity varies with R-901 operations, the measured treat gas H2 purity varies as well. Thus,
control of treat gas H2 purity by manipulating make gas flow (Figure 11.41) helps meet the reactor
H2 partial pressure target more effectively. Limiting treat gas flow to only what is necessary to meet
the offline specified treat gas/oil feed ratio (Figure 11.40) (i) reduces fuel consumption in the treat
gas preheat heater (F-935), (ii) reduces C-914 operating costs, and (iii) ensures the desired treat gas
flow is delivered for any hydrocarbon feed rate.
Remember: Referring to Equation (14.5), and assuming pressure is set by upstream or downstream
operations, controlling the treat gas/oil feed ratio and treat gas H2 purity can help establish H2
partial pressure. In addition, if the treat gas is temperature, pressure and/or molecular weight
compensated (in Figure 11.40, the uncompensated treat gas flow is controlled), control of the com￾pensated treat gas flow measurement is more accurate, and its use in Equation (14.5), helps provide
a better estimate of the operation’s H2 partial pressure.
14.1.6 Residence Time, Space Velocity, and Throughput Control
Residence time – reactor volume per unit of volumetric feed (volume/volume per time), and
space velocity – reactor feed rate per volume of catalyst (volume/time per volume of catalyst),
an analogous parameter for packed bed reactors, both affect reactor conversion. Conversion
increases as the reactor’s feed rate decreases, e.g., as residence time increases or space velocity
decreases. However, depending upon the specifics of the reaction system, decreasing feed rates
can also increase the rate of cracking and if catalyzed, the coke-on-catalyst, which accelerates
catalyst deactivation. This may also adversely affect reaction selectivity – the yield(s) of the desired
product(s) relative to the yield(s) of undesired product(s). Note that when the feed rate is increased,
it may be necessary to increase reactor temperatures to maintain conversion constant.
The most important reasons to control reactor feed rate are to meet production targets and help
maintain safe, stable operating conditions. For these reasons, feed rate control is almost always
included as a standard control component for reactor systems. A control strategy that controls a
reactor’s feed drum inventory and helps stabilize the reactor’s feed rate was presented in Section
9.5.2 – see the discussion of Figures 9.14 and 9.15.
14.1.7 Reactor Feed Mix Control
For reactors that have more than one feed source, a reactor feed rate change that does not main￾tain the feed source flow ratios constant will change the feed’s composition. For example, in a
desulfurization reactor, as the feed becomes heavier, its sulfur content increases, and desulfuriza￾tion becomes more difficult, requiring higher reactor temperatures to achieve the same conversion.
Because reactor feed composition is typically difficult to specify and is often expensive (and diffi￾cult, sometimes impossible) to measure, direct control of feed composition is usually impractical.
However, it is sometimes possible to maintain the feed mix constant when the feed rate is changed.
A NHF reactor’s feed rate and feed mix control strategy, presented in Section 9.5.3, is a good
example. The NHF in this example has two feed sources, both controlled and available degrees of Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License564 14 Reactor Conversion Control
freedom4 – virgin naphtha (VN) (stabilized CDU overhead) and catalytic cracker naphtha (from
an FCCU fractionator). The hydrofiner’s feed configuration is presented in Figure 9.16. The cat
naphtha (CN) is heavier than VN and has a higher sulfur content. Thus, as the feed mix gets
heavier – more CN relative to VN, feed sulfur content will increase, and desulfurization will become
more difficult. To avoid higher temperatures and increased rates of catalyst deactivation, the con￾trol strategy proposed in Figure 9.17 maintains the % CN in the feed, e.g., [CN flow/(CN flow +VN
flow)] * 100%, constant as both the CN and VN flow set points are manipulated to satisfy a new
total feed rate (CN +VN) target.
14.2 Reactor System Unit Configurations
Although there are many different reactor systems with many different unit configurations in oper￾ation in oil refineries and chemical plants, the focus of the reactor control strategies presented and
discussed in this chapter is solid-catalyzed, fixed bed reactors. Although there are many examples
of fixed bed reactor systems, most have similar process configurations, structured into the following
sequential sections. Also indicated is the control focus for each section:
● Feed Preparation Section: Reactor hydrocarbon feed rate and feed mix controls.
● Feed Preheat Section: Reactor inlet temperature and treat gas/hydrocarbon feed ratio controls.
● Reactor Section: Reactor temperature and/or conversion controls treat gas/hydrocarbon feed
ratio control.
● Effluent Cooling and Product Separation Section: Reactor effluent or reaction system product
yield/quality controls.
To present a framework for the control strategies presented later in Section 14.4, the process con￾figuration and control aspects of each process section are presented in Sections 14.2.1–14.2.4.
14.2.1 Feed Preparation Section
It is very common to encounter reaction systems with multiple feed sources that are routed to
a feed surge drum, and a single flow rate manipulated to control the surge drum’s inventory.
Figure 14.4 presents such a reactor feed surge drum configuration, with two different approaches
to feed surge drum inventory control – one manipulating a feed source’s flow rate (e.g., FC3 SP),
the other manipulating the drum’s outlet flow – the reactor’s feed rate (FC4 SP), to control the
surge drum’s inventory (LI1 PV).
When a feed source’s flow rate, such as FC3, is manipulated to control surge drum inventory –
LC1 → FC3 SP, the reactor’s desired feed rate, FC4 SP, is an operator entry or is set by another
control strategy. Also, in this case, the manipulated flow (FC3) source is a tank – this is advan￾tageous because the level control adjustments, and level measurement noise, have no upstream
or downstream process impact. On the other hand, when the reactor’s feed rate (FC4 SP) is
manipulated by drum level control – LC1 → FC4 SP, level measurement noise, level upsets caused
by feed source changes, and/or large or erratic control adjustments will impact the reactor’s feed
rate and hence downstream units. Therefore, as discussed in previous chapters, averaging level
control (Section 9.6) and level measurement filtering (Section 2.5.2) may both be helpful.
Note that one feed source’s flow (FI1 PV) is uncontrolled and set by an upstream unit. Thus,
depending upon the relative magnitude of FI1 PV relative to the other two flow inputs (FC2 PV and
4 This is required - both flow rates must be adjusted to achieve the feed mix, total feed rate control objectives.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.2 Reactor System Unit Configurations 565
Reactor feed
sources
FI
1
Reactor feed
surge drum
FC
2
FC
3
Set by upstream
unit adjustment
LI
1
FC
4
1. Drum level → Inlet flow 
2. Feed rate SP is operator entry 
FC
3
LC
1
LI
1
Drum level sets feed rate 
FC
4
LC
1
Reactor feed
LI
1
To feed preheat section
Figure 14.4 Feed Preparation Section With a Surge Drum – Reactor Feed Rate Control
FC3 PV), surge drum total inlet flow may be variable and impact LC1 PV. If LC1 manipulates FC4
SP, averaging level control will lessen any impact the LC1’s adjustments have on the reactor feed
rate (FC4 SP) and help prevent any potential downstream upsets. Also, remember the feed surge
drum’s (large) hold-up volume dampens potential downstream upsets when input flows change.
Therefore, because of the surge drum, and averaging level control, feed source flow variations are
not normally a problem. Note that when the LC1 → FC3 cascade is implemented, these input flow
variations have no impact on the reactor’s feed rate or any downstream units.
For the reactor feed preparation configuration presented in Figure 14.4, no matter how the
surge drum’s level is controlled, the reactor’s feed composition can in principle change as the wild
flow rate (FI1 PV) changes with upstream process conditions. In addition, feed composition can
in principle change when the feed mix changes, e.g., when level controller LC1 adjusts FC3 SP.
However, the surge drum’s hold-up volume dampens the effects of these potential composition
changes. Hence, the impact on reactor operations is normally very gradual and reactor operations
are not upset.
Although less common than the reactor feed preparation configuration shown in Figure 14.4,
the configuration in Figure 14.5, without a feed surge drum and its upset attenuating abilities, is
therefore more susceptible to feed rate, feed mix and feed composition changes and hence reactor
upsets.
However, the feed mix, and the reactor’s feed rate can both be controlled if the following are
true: (i) all feed source flows are measured, and (ii) there are controlled feed source flows that are
available degrees of freedom – they can be manipulated with no regard for upstream/downstream
process conditions. Therefore, in Figure 14.5, if the two controlled feed source flows, FC2 and FC3,
are available degrees of freedom, then FC2 SP and FC3 SP adjustments can maintain the reactor
feed rate (FI4 PV) at a desired target and simultaneously satisfy one of the three possible feed mix
measures, i.e., maintain either the FC2 PV – FI4 PV or the FC3 PV – FI4 PV or FC2 PV – FC3 PV
ratio constant. As mentioned earlier, an example of feed rate and simultaneous feed mix control
was presented in Section 9.5.3 – see discussions of Figures 9.16 and 9.17.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License566 14 Reactor Conversion Control
Reactor feed
sources
Reactor feed to feed
preheat section
FI
1
FC
2
FC
3
FI
4
Figure 14.5 Feed Preparation Section Without a
Surge Drum
FC
81 FC
71
Treat
gas
TI
12
TI
20
Fuel
gas
TI
11
Hydrocarbon
feed
To product
separation section
TI
10
Reactor effluent
heat integration
TV12
TV10
Figure 14.6 Reactor Feed Preheat Section – HC Feed and Treat Gas Preheated in Fired Heater
14.2.2 Feed Preheat Section
For a large number of industrial chemical reaction systems, the reactants must be preheated to tem￾peratures high enough to initiate the desired chemical reactions. This is true for both exothermic
and endothermic reactions. The reactor feed preheat section’s principle operating objective is to set
the reactor feed’s inlet temperature to the offline specified value that initiates the desired reactions
and then maintain it at the desired target. In many cases, a portion of the preheat is supplied by
fired heaters; however, in almost all cases, a major portion of the feed preheat is provided by reactor
effluent heat recovery in feed/reactor effluent heat exchangers.
In hydrotreater, hydrofiner, and hydrodesulfurization reaction systems, reactions occur in an
H2-rich atmosphere provided by treat gas and/or recycled gas. One such reactor preheat configura￾tion, with both the hydrocarbon and treat gas feed streams preheated in a fired heater, is presented
in Figure 14.6.
In Figure 14.6, to satisfy the reactor’s conversion target, the two most important temperatures
to control are the reactor inlet temperature (the preheat heater’s outlet temperature), TI12 PV, and Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.2 Reactor System Unit Configurations 567
the reactor outlet temperature, TI20 PV. The control of the feed/effluent exchanger outlet tempera￾ture, TI10 PV, is also important in order to maximize effluent heat recovery to feed and to stabilize
the preheat heater’s inlet temperature, TI11 PV. The most effective CV – MV pairings to achieve
these control objectives are as follows:
● Control reactor inlet temperature (TI12) by manipulating the fuel gas pressure via TV12,
TC12 → TV12 – preheat heater duty adjustments. Since TI12 is the heater’s COT, this control
cascade would normally include the advanced control components that make up a typical heater
COT control strategy.
● Control the feed/effluent exchanger outlet temperature, TI10, by adjusting the feed/effluent
exchanger’s bypass flow via three-way valve TV10, TC10 → TV10. TC10 SP is chosen to maximize
reactor effluent heat recovery to feed while TV10 remains in controlling range.
Note: For the feed preheat configuration in Figure 14.6, the reactor outlet temperature (TI20 PV) is
almost always controlled by resetting the reactor inlet temperature controller, i.e., TC20 → TC12 →
(COT advanced control components) → TV12. TC20 SP would be specified by the PTS group to
achieve the desired conversion, and TC20’s control adjustments would establish the corresponding
inlet temperature – TC12 SP (≈ TC12 PV). It is the difference in temperature along the reactor bed
(TC20 PV – TC12 PV) that ultimately determines the reactor conversion achieved.
Important: As illustrated in Figure 14.2, to compensate for catalyst deactivation, the reactor outlet
temperature TOUT (= TC20 SP) is normally slowly increased from the start-of-run to the end-of-run;
the TOUT → TIN control cascade then slowly increases the reactor inlet temperature, TIN (= TC12
SP). These outlet temperature increases over the catalyst run maintain reactor conversion at its
desired target as the catalyst deactivates.
Another typical hydrotreater reactor preheat configuration is presented in Figure 14.7 with
the treat gas preheated in a fired heater while the hydrocarbon feed is preheated in a series of
feed/reactor effluent heat exchangers.
Similar to the preheat configuration in Figure 14.6, the two most important temperatures to
control to meet the reactor’s conversion target are the reactor inlet temperature, TI36 PV, and
the reactor outlet temperature, TI35 PV. However, to facilitate and more effectively control the
reactor inlet temperature, the fired heater’s outlet temperature, TI33 PV, the treat gas temperature
upstream of the hydrocarbon feed mix point, is also controlled. The most effective CV – MV pairings
to achieve these control objectives are as follows:
● Control the treat gas temperature exiting the preheat heater, TI33, by manipulating the fuel gas
flow via TV33: TC33 → TV33. This control cascade, which adjusts the preheat heater’s duty,
would also include the advanced control components that make up a typical heater COT control
strategy.
● Control the reactor inlet temperature (TI36) by resetting the treat gas temperature exiting the pre￾heat heater, TC33 SP, the fired heater’s coil outlet temperature: TC36 → TC33 → (COT advanced
control components) → TV33.
Similar to the feed preheat configuration in Figure 14.6, the reactor outlet temperature (TI35 PV)
is normally controlled by resetting the reactor inlet temperature controller, i.e., TC35 → TC36 →
TC33 → (COT advanced control components) → TV33. TC35 SP is specified to achieve the desired
conversion. TC35’s control adjustments establish the corresponding inlet temperature, TC36 SP
(≈ TC36 PV), and the reactor’s temperature difference (TC35 PV – TC36 PV) determines the reactor
conversion achieved. Again, to compensate for catalyst deactivation, the reactor outlet temperature Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License568 14 Reactor Conversion Control
Treat gas preheat
furnace
Treat gas
HC
feed
TI
33
TI
36
TI
35
Fuel
gas
To/from product
separation section
FC
24
Reactor effluent
heat integrations
To product
separation section
HC
feed
FC
30
TV33
Figure 14.7 Reactor Feed Preheat Section – Treat Gas Preheated in Fired Heater
(TC35 SP) is normally slowly increased from the start-of-run to the end-of-run, the reactor inlet
temperature (TC36 SP) slowly increases to establish the reactor ΔT after each outlet temperature
increase, and in principle, conversion remains about the same.
A third typical hydrotreater reactor preheat configuration is presented in Figure 14.8, this one
with the hydrocarbon feed preheated via a fired heater, while the treat gas flow is preheated
upstream of the reactor feed preheat section. To meet the reactor’s conversion target, the reactor
inlet temperature (TI135 PV), and the reactor outlet temperature (TI36 PV) are controlled. Notice
that the reactor effluent/feed exchanger and the fired heater duties both impact the reactor inlet
temperature. The operating objective is to maximize heat recovery to feed in the feed/effluent heat
exchanger – thus effluent/feed exchanger duty is preferentially manipulated to maintain reactor
inlet temperature at its target, while the preheat heater is operating at its minimum duty – at
minimum fuel gas pressure.
As the catalyst run continues and reactor inlet temperature targets are slowly increased, efflu￾ent/feed exchanger duty eventually becomes limited high – three-way bypass valve TV134’s bypass
path becomes fully closed. From that point forward, the reactor inlet temperature controller manip￾ulates the preheat heater’s duty via fuel gas pressure adjustments. Consequently, the reactor’s inlet
temperature controller must be a split range controller that transitions from its lower output range
(MV = effluent/feed exchanger duty) to its upper output range (MV = preheat heater’s duty) when
feed/effluent exchanger duty becomes limited high. When it transitions into its upper output range,
it must override the minimum preheat heater duty control strategy in order to continue to control
reactor inlet temperature.
Catalytic reforming reaction systems consist of three or four fixed bed reactors in series, all with
one catalyst bed, with a fired heater’s duty manipulated to control the first reactor’s inlet tempera￾ture. Reformer reactions are very endothermic and require large amounts of inter-reactor process Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.2 Reactor System Unit Configurations 569
Fuel
gas
To product
separation section
TI
135
TI
134
TI
136
Treat
gas
HC feed
preheat furnace
FC
139
Reactor effluent
heat integration
FC
181
HC
feed
TV134
PV129
PC
129
F-179
R-175
E-135 A/B
Figure 14.8 Reactor Feed Preheat Section – Hydrocarbon Feed Preheated in Fired Heater
heat input. However, the last reactor’s reactions are slightly exothermic and thus reformer designs
almost always feature use of the last reactor’s effluent for heat recovery to other process streams. An
example of reformer reactor effluent heat utilization is presented in Figure 11.8 in Section 11.1.3.
The reformer effluent is the heat source for two light-ends tower reboilers, the DeC4 tower’s feed
preheat, and most importantly, the combined reformer feed and recycle gas upstream of the fired
heater F-201. The flow of reactor effluent to the two reboilers is set by tower tray temperature con￾trollers. After being heated in the feed/reactor effluent exchangers, reformer feed is routed to F-201;
thus, increasing effluent heat recovery to feed reduces fuel consumption in F-201. Since the duties
of all other heat exchangers are set by temperature control, maximizing effluent heat recovery to
feed also reduces heat lost to air and water in downstream exchanger. Thus, the operating objective
is to maximize heat recovery to reformer feed. The constraint control strategy proposed in Section
11.1.3 (Figure 11.9) maximizes effluent heat recovery to reformer feed subject to max openings on
the tower reboiler bypass valves.
14.2.3 Reactor Section
The three reaction section configurations listed below, and illustrated in Figure 14.9, are the most
common fixed bed, catalyzed reaction systems currently in operation:
1) Fixed bed reactor with one catalyst bed
2) Fixed bed reactors, all with one catalyst bed in series, with/without inter-reactor heating and/or
cooling
3) Single fixed bed reactor with multiple catalyst beds and intra-bed cooling
Kerosene and other middle distillate hydrofiners are usually fixed bed reactors with a single cat￾alyst bed (Configuration 1). Catalytic reformer units are typically three or four fixed bed reactors
in series, with inter-reactor reheat provided by fired heaters (Configuration 2). Hydrocrackers are
usually single reactors (or sometimes two reactors in series) with multiple fixed beds and intra-bed
cooling (Configuration 3).
Because temperature has a very significant effect on the rate of reaction, temperature control is
the basis for most reactor conversion control strategies. Reliable temperature measurements and Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License570 14 Reactor Conversion Control
From feed
preheat section
Reactors with one catalyst bed
in series, with/without inter-reactor
heating and/or cooling 
2
Heat may be added or removed
in heat exchangers or fired heaters
To product
separation
From feed
preheat section
Quench
gas
To next reactor, or
product separation
Single reactor with multiple
catalyst beds and intra-bed cooling
3
To product
separation
Reactor with
one catalyst bed
From feed
preheat section
1
Figure 14.9 Most Common Reaction Section Configurations
good temperature control are prerequisites for maintaining the desired conversion over the entire
catalyst run. Overviews of the most common conversion control strategies are now discussed for the
three reaction section configurations presented in Figure 14.9. For each configuration, the temper￾ature measurements and potential manipulated variables needed to implement control strategies
that maintain reactor conversion constant are identified, and those control strategies are described.
Fixed Bed Reactor with One Catalyst Bed
As described in Section 14.2.2, the feed preheat section provides the heat source MVs that enable a
reactor’s inlet temperature to be controlled. Typical approaches to reactor inlet temperature control,
with heat provided by a fired heater and/or feed/reactor effluent heat exchangers, were presented
in Section 14.2.2. If the reactor outlet temperature is not controlled, the inlet temperature con￾troller set point is specified to achieve the desired conversion. If the reactor outlet temperature
is controlled, it resets the inlet temperature controller, and its set point is specified to achieve the
desired conversion. This inlet/outlet temperature pairing establishes the inlet temperature that sat￾isfies the outlet temperature’s target value, and the reactor’s inlet and outlet temperature difference
establishes the reactor conversion achieved.
Consider a fixed bed reactor with one catalyst bed and the inlet and outlet temperature measure￾ments in Figure 14.10. Almost every control strategy that maintains fixed bed reactor conversion
at a desired target includes bed inlet temperature control. In Figure 14.10, inlet temperature TI100
would be controlled by manipulating an available degree of freedom in the feed preheat section. Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.2 Reactor System Unit Configurations 571
Figure 14.10 Fixed Bed Reactor, One
Catalyst Bed with Inlet/Outlet Temperature
Measurements
TI
110
TI
100
To product
separation section
HC and treat gas feed
from feed preheat section 
Figure 14.11 Fixed Bed Reactor, with One Catalyst Bed, Conversion
Control
SP
TI
110 TC110
SP
TI TC100
100
Preheat section MV
Desired TOut
SP
If outlet temperature TI110 is not controlled, then the TC100 SP is specified offline over the cat￾alyst run to meet a conversion target. The TC100 control strategy must also provide maximum
bed temperature rise protection – an immediate TC100 SP reduction when the bed ΔT (or TI110
PV) approaches or exceeds a high constraint limit. However, in most cases, the reactor conversion
control strategy includes outlet temperature control – as shown in Figure 14.11.
This control strategy is a simple cascade and DCS cascade rules manage all initialization and
wind-up issues. TC110 SP is specified periodically over the catalyst run to meet the conversion
target. Because reactor inlet and outlet temperatures are normally considered essential measure￾ments, they will frequently be high-level 4–20 mA analog inputs that do not require input valida￾tion. Important: As long as TC100 and TC110 both meet their individual control objectives, this
conversion control strategy provides maximum bed ΔT (and/or maximum outlet temperature)
protection.
As indicated in Figure 14.12, intra-bed temperature measurements, TI105A → F, are sometimes
available. When included in the reactor’s design basis, intra-bed temperatures can be used to cal￾culate (and control) a single bed average temperature that is an inferential indicator of reactor
conversion. Even though temperatures vary within the bed, control of the single bed average tem￾perature can be an effective approach to conversion control. Two such averages sometimes used
to meet reactor conversion targets are (i) an arithmetic average bed temperature, but more often
(ii) an EIT. For the intra-bed temperatures in Figure 14.13, these two bed average temperatures are
(Ref. [1]):
Average = (TI105A + TI105B +…+ TI105F)∕6 (14.7)
EIT = ∝1 ∗ TI105A + ∝2 ∗ TI105B +…+∝6 ∗ TI105F (14.8)
In Equation (14.8), the EIT weighting factors 𝛼i are all positive and are normally chosen to sum
to unity; they provide flexibility to include the impact of the more active bed sites in the EIT
calculation.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License572 14 Reactor Conversion Control
TI
110
TI
100
To product
separation section
TI
105
HC and treat gas feed
from feed preheat section 
A→F
Figure 14.12 Fixed Bed Reactor, One
Catalyst Bed with Intra-Bed Temperature
Measurements
.
.
. TI
105F TIV105F
TI
105A
TIV105A
TI
105B
TIV105B Average, or EIT
controller
Average, or EIT
calculation
Validations
SP
Desired average or EIT
PV
SP
Preheat section MV
TI
100
TC100
SP
Figure 14.13 Fixed Bed Reactor, One Catalyst Bed, Conversion Control with Intra-Bed Temperatures
For the reactor configuration in Figure 14.12, to inferentially control reactor conversion using
either the arithmetic average or the EIT, a controller with the arithmetic average or EIT as its PV
input resets the inlet temperature controller, TC100 – see Figure 14.13. The suitability of either the
average temperature or the EIT controller for a specific application must be discussed with and
approved by either process design specialists or the PTS group. These specialists also provide the
average or EIT controller’s set point, the desired analytical form of the calculation, and for the EIT,
the weighting factors, 𝛼i
.
In effect, the average temperature controller or EIT controller replaces the reactor outlet temper￾ature in the conversion control strategy. Instead of specifying the outlet temperature controller’s
target over the catalyst run to maintain conversion, the arithmetic average or EIT controller’s target
is specified by PTS. Like the outlet temperature set points, these controller set points are increased
periodically over the catalyst run to overcome the detrimental effects of catalyst deactivation on
rate of reaction.
As in Figure 14.12, intra-bed temperatures will almost always be multiplexed, low-level DTI
points, and if the arithmetic average or EIT is controlled to meet the conversion target, intra-bed
temperatures must first be validated. Because temperature validation is necessary, custom code
is needed to manage the following incidents: (i) a temperature measurement is declared invalid,
(ii) an invalid temperature measurement returns valid, (iii) the minimum number of valid
temperature measurements needed for the average or EIT to be considered valid is reached, and
(iv) an invalid average returns valid.
No matter how reactor conversion is controlled, the conversion strategy’s ultimate primary’s set
point must be properly specified over the catalyst run to ensure the conversion is maintained on
target. For the fixed bed reactor configuration in Figure 14.10, a conversion control strategy that Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.2 Reactor System Unit Configurations 573
TI
200
TI
210
TI
220
HC feed from feed
preheat section
TI
215
TI
205
TI
225
To product
Heat added separation section
or removed, Q1
Heat added
or removed, Q2
Figure 14.14 Fixed Bed Reactors in Series with One Catalyst Bed and Inter-Reactor Heating/Cooling
pairs the outlet temperature with the inlet temperature usually provides effective reactor conver￾sion control, and since it is also the least complex approach, it is usually considered the preferred
approach. When a fixed bed reactor with a single catalyst bed is operated to meet a target reactor
effluent quality, and the effluent quality is either measured or available via lab analysis, a reli￾able and accurate value helps operators make outlet temperature controller set point adjustments
between offline specified temperature target changes.
Reactors in Series With One Catalyst Bed and Inter-Reactor Heating/Cooling
The reactor section configuration in Figure 14.14 consists of three fixed bed reactors in series, each
with a single catalyst bed, with either inter-reactor heating or cooling; bed inlet and outlet temper￾ature measurements are indicated.
The reactor configuration in Figure 14.14 is typical of a semi-regenerative catalytic reforming
reaction system – three or four fixed bed reactors in series, all with one catalyst bed, with a fired
heater’s duty manipulated to control the first reactor’s inlet temperature. Since reformer reactions
are very endothermic, inter-reactor reheat is needed – second and third reactor inlet tempera￾tures are maintained at desired targets by manipulating fired heater duties. Catalytic reforming
reactions are complex, with many reaction types – dehydrogenation, cyclization, hydrocracking,
and isomerization. Temperature, pressure, and hydrogen partial pressure affect each reaction type’s
reaction rate and catalyst deactivation rate differently. Conversion in each reactor involves different
reactions and, thus, different heat effects and catalyst deactivation rates. It is the last reactor’s efflu￾ent that must meet yield and quality targets, but the operating performance of all reactors impact
the product’s yield and quality. Therefore, choosing the individual reactor outlet temperature set
points to meet an overall conversion target is a difficult and nontrivial task.
For a single reactor with one catalyst bed, reactor conversion is effectively controlled by an out￾let to inlet temperature control cascade. For each reactor’s inlet and outlet temperature pair in
Figure14.14, the applicable control strategies are as shown in Figure 14.15.
Q1 and Q2 are the heat exchanger (heating and cooling) or fired heater (heating) duties manipu￾lated to meet each inter-reactor’s inlet temperature’s desired target. In Figure 14.15, it is assumed
that all temperatures are 4–20 mA A/I measurements and do not need validation. Each reactor’s
outlet temperature’s set point is specified to achieve the desired conversion in that reactor. Because Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License574 14 Reactor Conversion Control
TC205
TC200
Preheat section MV
Reactor #1
desired TOut
SP
SP
TI
205
TI
200
TC215
TC210
SP
SP
Q1
TI
215
TI
210
Reactor #2
desired TOut
TC225
SP
SP
TI
225
TC220
Q2
TI
220
Reactor #3
desired TOut
Figure 14.15 Conversion Control, Reactors in Series with One Catalyst Bed and Inter-Reactor
Heating/Cooling
the outlet temperature and temperature change across each reactor’s catalyst bed can be indepen￾dently established, the overall conversion achieved is determined by the combined effects of the
individual reactor conversions. This makes meeting the overall conversion target difficult and non￾trivial. Specifying operational targets to meet the overall conversion target over the catalyst run is
a task that is always the responsibility of process technical specialists and operations personnel.
Two reactor configurations very similar to the configuration in Figure 14.14 were discussed in
earlier chapters. In Section 4.3.4, the reactor section configuration presented in Figure 4.9 demon￾strates how process analysis can identify (i) heat integrations that cause reactor temperature control
loop interactions, (ii) how temperature controller valve position constraints arise, and (iii) how
valve constraints are relieved. In Figure 4.9’s configuration, there are two reactors in series, each
with a single catalyst bed. This two-stage, fixed bed reactor section illustrates an important char￾acteristic that is typical of the reactor section configuration presented in Figure 14.14 – how heat
integrations link feed preheat directly to reactor operations. In Figure 4.9, the second-stage reac￾tor’s effluent is first reheated in a fired heater; the effluent exits the heater and then preheats the
second-stage reactor’s feed and then the first-stage reactor’s feed in each reactor’s feed/effluent heat
exchangers. Since they are in series, the second-stage feed/effluent exchanger’s duty impacts the
first-stage feed/effluent exchanger’s duty. In addition, because each feed/effluent exchanger’s duty
is manipulated (via dual-acting bypass and feed valves) to control a reactor inlet temperature, the
two reactor inlet temperature control strategies interact.
As the catalyst run proceeds, both reactor inlet temperatures are increased to satisfy conversion
targets. However, as inlet temperatures increase, the dual-acting bypass (closed) and feed (open)
valves can become limited. When the valves become limited, the reheat heater’s duty, an avail￾able degree of freedom, is used to reduce the second-stage feed/effluent exchanger duty required
to meet the second-stage’s inlet temperature – the higher heater COT increases the second-stage
feed/effluent exchanger’s hot side (effluent) inlet temperature. This then increases the driving force
for heat transfer in the first-stage effluent/feed exchangers as well. The control strategy proposed
in Figure 4.11 manipulates the reheat-fired heater’s COT controller’s set point to maintain the
second-stage feed/effluent exchanger’s bypass valve in controlling range and helps promote better
heat transfer in the first-stage effluent/feed exchangers.
In Section 10.2.3, another reactor system with a configuration similar to Figure 14.14 is discussed.
This two-stage, fixed bed hydrodesulfurization reaction system’s configuration, with two reactors
in series, each with one catalyst bed, and inter-reactor reheat/preheat, is presented in Figure 10.12.
This reactor section’s configuration and operations illustrate again how heat integrations link feed
preheat directly to reactor operations and how reactor section heat integrations can be exploited to
maintain important control valves in controlling range.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.2 Reactor System Unit Configurations 575
This reactor section’s operating objective is to catalytically remove sulfur from the feed, in the
presence of an H2-rich treat gas, to help meet a MOGAS blend stock minimum sulfur require￾ment. The first reactor (R-305A), the so-called “guard reactor,” removes some sulfur, but its main
operating objective is to remove the main reactor’s (R-305B) catalyst poisons and potential preheat
exchanger fouling precursors. Note that almost all hydrodesulfurization reactions occur in the main
reactor.
The main reactor’s feed, the guard reactor’s effluent, is first preheated in two feed/effluent heat
exchangers and then in a feed/hot oil exchanger. Its all-important inlet temperature is maintained
at the desired target by manipulating the feed/hot oil exchanger’s duty via a three-way bypass
valve. As the catalyst run proceeds and the main reactor inlet temperature is increased to main￾tain conversion, the hot oil bypass valve, and hence the feed/hot oil exchanger’s duty, must be kept
in controlling range. As discussed in Section 10.2.3 and displayed in Figure 10.13, the proposed
control strategy’s key element is to manage the feed/hot oil exchanger’s duty by shifting heat duty
from the feed/hot oil exchanger to one of the feed/effluent heat exchangers. Even if a main reactor
outlet to inlet temperature control cascade is implemented, inlet temperature will increase as the
outlet temperature controller’s set point is increased to maintain conversion. Thus, it would still be
necessary to keep the feed/hot oil exchanger bypass valve in controlling range.
Single Reactor with Multiple Catalyst Beds and Intra-Bed Cooling
The reactor section configuration in Figure 14.16 consists of a single fixed bed reactor with three
catalyst beds and quench gas injection at the outlet of each bed. This reactor configuration is typical
of catalytic hydrocracker designs, although in some cases they have four or even five catalyst beds.
Depending upon the throughput and the desired product’s properties, the hydrocracking unit may
have one multi-bed reactor or two multi-bed reactors in series.
In hydrocracking, reactions are mainly catalytic cracking and dehydrogenation, with some
isomerization reactions that produce olefins for further dehydrogenation. Although the cracking
TI
400
TI
410
TI
420
TI
405
TI
415
TI
425
Quench
gas
To next reactor, or
product separation section
FC
400
FC
410
FC
420
HC feed from feed
preheat section
Figure 14.16 Single Fixed Bed Reactor with Multiple Catalyst Beds and Inter-Bed Cooling
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License576 14 Reactor Conversion Control
SP
SP
TI
405 TC405
TI
415
SP
SP
TC415
TI
425
SP
SP
Desired
bed #1 TOut
Desired
bed #2 TOut
Desired
bed #3 TOut
TC425
TC400
TI
400
SP
TC410
TI
410
SP
TC420
TI
420
SP
FC
410
FC
420
Quench
gas
FC
400 Bed #1
inlet
Bed #2
inlet
Bed #3
inlet
Figure 14.17 Fixed Bed Reactor Conversion Control with Multiple Catalyst Beds and Inter-Bed Cooling
reactions are endothermic, the dehydrogenation reactions are strongly exothermic, and the net
result is the generation of a considerable amount of heat. Hence, temperatures increase through￾out each bed, with a corresponding increase in the rates of reaction. If the coupled increases in
temperature, rates of reaction, and heat generation continue, a number of potential risks arise,
including a temperature “runaway”.5 Therefore, to enable conversion targets to be met, while at
the same time maintaining reactor temperatures within safe limits to prevent reactor temperature
runaways, cold recycled H2-rich quench gas is injected at each catalyst bed’s outlet to suppress
temperature and rates of reaction increases.
As shown in Figure 14.17, the desired conversion in each catalyst bed can be achieved by
implementing an outlet temperature to inlet temperature to quench gas flow cascade for each
catalyst bed. With effective control performance that includes appropriate quench gas valve
position monitoring, bed temperature rise (and hence temperature runaway protection) and
quench valve position constraints can be honored. Note that when a potential or an actual quench
gas valve position constraint is detected, the action taken is to reduce the set point of the outlet
temperature controller of the bed above the constrained quench gas entry point.
Assuming the control strategy in Figure 14.17 meets all individual catalyst bed conversion targets
and minimizes the temperature runaway risk, the reactor’s overall conversion is set by the desired
reactor temperature profile, e.g., how conversion is distributed among the multiple catalyst beds to
achieve the desired overall conversion. The calculated Weighted Average Bed Temperature WABT
is a single reactor temperature metric that can be used to generate the desired reactor temperature
profile (Refs. [2] and [3]):
WABT = Σi
(TINi ∗ 𝛽i
)+Σi
(TOUTi ∗ 𝛽i
) (14.9)
In Equation (14.9):
𝛽i Bed i volume/total bed volume, i =1, 2, …, n, where n number of
reactor beds and Σ 𝛽i ≡ 1
TINi Bed i inlet or bed i average inlet temperature, i =1, 2, …, n
TOUTi Bed i outlet or bed i average outlet temperature
In many cases, offline simulation and WABT calculations by process specialists allow suitable
bed inlet or outlet temperature targets to be specified periodically to meet overall conversion
5 As temperatures increase, rates of reaction increase, exothermic heat release accelerates which further increases
temperatures. Unless a reactant is completely consumed, there is no self-correction to stop the temperature rise.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.2 Reactor System Unit Configurations 577
targets over the catalyst run. The offline calculated temperature targets are manually entered
by operators. Functionality to ramp the new temperature set point values to their final value is
usually recommended.
Like the outlet (and inlet) temperature set point adjustments discussed previously, the WABT
values are increased over the catalyst run to offset the effects of catalyst deactivation. WABT adjust￾ments over the catalyst run are made relatively infrequently, and thus, temperature corrections
needed to meet new WABT targets are made infrequently. This suggests WABT control is not nec￾essary. The online use of the WABT for a specific application must be justified by process design
specialists and operations personnel. These same specialists are responsible for recommending a
suitable analytical form of the WABT calculation – Equation (14.9) is one common form. When￾ever a WABT target increase is needed, operators initiate the online calculation of the temperature
controller set points. The new temperature set points are validity checked (e.g., new set points and
set point changes within max/min limits) via user-provided custom logic/code, and, after being
declared valid, are displayed at the console. If approved, and initiated by an operator entry, the
new set points are stored via user-provided custom code. The new temperature set point values
are normally ramped to their final value. Although the online WABT temperature correction cal￾culations are asynchronous (unscheduled) and must be initiated by operator actions, the WABT
value (e.g., WABT PV) is usually calculated on a normal frequency for reporting and displayed at
the operator’s console for routine monitoring.
WABT calculations are executed online in one of two ways: (i) bed outlet temperature controller
set points are calculated if TOUT → TIN → Quench Gas cascades are implemented, or (ii) bed inlet
temperature controller set points are calculated if TIN → Quench Gas cascades are implemented.
For the specified WABT value that will achieve the overall conversion target, Equation (14.9) is
the basis for calculating the desired outlet or inlet temperature set points. However, there are two
problems that must be addressed before Equation (14.9) can be used in this manner:
1) When either the new bed outlet or inlet temperatures are implemented, both temperatures will
change – one in response to new set points, the other in response to those new temperature set
point changes; the WABT value is impacted by changes in both temperatures.
2) There is only one equation, but up to n (= number of beds) unknowns, an outlet or inlet tem￾perature controller set point for each catalyst bed.
Here is one approach that circumvents these problems and allows Equation (14.9) to be used to
manage WABT. First, convert the WABT calculation in Equation (14.9) to an incremental basis:
ΔWABT = Σi
(ΔTINi ∗ 𝛽i
)+Σi
(ΔTOUTi ∗ 𝛽i
) (14.10)
ΔTINi Change in bed i inlet, or bed i average inlet temperature, i = 1, 2…n
ΔTOUTi Change in bed i outlet, or bed i average outlet temperature, i = 1, 2…n
n Number of catalyst beds
ΔWABT WABT− WABT*
WABT Current WABT value
WABT* New, desired WABT value
Determine, via careful plant testing,6 the steady-state gains, ki
, for i = 1, 2, …, n, that relate the ith
bed’s outlet temperature change to the ith bed’s inlet temperature change:
ki = ΔTOUTi∕ΔTINi i = 1, 2,… , n (14.11)
6 Transfer inlet temperature controllers to Auto, make step changes in the ith bed’s inlet temperature set point, and
collect the ith bed’s outlet temperature response data. The outlet temperature responses must reach new steady-state
values to allow the ki to be calculated.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License578 14 Reactor Conversion Control
Because the WABT is in essence a steady-state calculation, once the ki are determined,
Equation (14.11) can be used to eliminate either ΔTOUTi or ΔTINi from Equation (14.10).
First, solve Equation (14.11) for ΔTINi and eliminate ΔTINi from Equation (14.10):
ΔWABT = Σi
[
ΔTOUTi ∗ 𝛽i ∗
( 1
ki
+ 1
)] (14.12)
Now solve Equation (14.11) for ΔTOUTi
, and eliminate ΔTOUTi from Equation (14.10):
ΔWABT = Σi
[ΔTINi ∗ 𝛽i ∗ (1 + ki
)] (14.13)
Like Equation (14.9), both Equations (14.12) and (14.13) still have n unknowns, but there is only
one equation. One approach used to manage this problem is to assume either all bed outlet tem￾perature controller set point changes are equal or that all bed inlet temperature controller set point
changes are equal. Assuming all outlet temperature controller set point changes are equal:
ΔTOUTi = ΔT∗
OUT for i = 1, 2,… , n (14.14)
where ΔT*
OUT is every bed’s outlet temperature set point change that yields the desired ΔWABT
Substituting Equation (14.14) into Equation (14.12), and solving for ΔT∗
OUT yields:
ΔT∗
OUT = ΔWABT
Σi
[ 𝛽i
ki
]
+ 1
(14.15)
where ΔWABT = WABT – WABT*
, and WABT* is the desired WABT.
The new bed outlet temperature controller set points are:
TOUTi SP (New) = TOUTi SP (Now)+ΔT∗
OUT where i = 1, 2,… , n (14.16)
Each bed’s outlet temperature controller responds to its new set point by resetting the bed’s inlet
temperature. Until all outlet temperatures reach their new set points, e.g., steady state is attained,
the WABT varies. When steady state is attained, the relationships in Equation (14.10) should be
close to valid, and the WABT should be approaching its desired value.
Now assume all inlet temperature controller set point changes are equal:
ΔTINi = ΔT∗
IN for i = 1, 2,… , n (14.17)
where ΔT∗
IN is every bed’s inlet temperature set point change that yields the desired ΔWABT
Substituting Equation (14.17) into Equation (14.13), and solving for ΔT∗
IN yields:
ΔT∗
IN = ΔWABT
Σi
[ki ∗ 𝛽i
] + 1 (14.18)
The new bed inlet temperature controller set points are:
TINi SP (New) = TINi SP (Now)+ΔT∗
IN where i = 1, 2,… , n
Each bed’s inlet temperature responds to its new set point, and each bed’s outlet temperature
response is its open-loop response to the bed’s inlet temperature change. The value of WABT varies
until steady state is attained; at steady state, the relationships in Equation (14.11) should be close
to valid, and the WABT should be approaching its desired value.
Figure 14.18 illustrates how Equations (14.15) and (14.16) are applied to the control strategy in
Figure 14.17 – all outlet temperature controller set point changes are equal to ΔT∗
OUT. The new
set points and the set point change are first validity checked, and only if valid, they are stored
in response to an operator entry. Note: The steady-state gains may change from start-of-run to
end-of-run; if found to be significant, the ki may require updating over the catalyst run.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.2 Reactor System Unit Configurations 579
Bed outlet
temperatures
Bed inlet
temperatures
Quench
flows
TC415
TC410
FC410
TC415 SP = TC415 SP + ∆T*OUT
TC425
TC420
FC420
TC425 SP = TC425 SP + ∆T*OUT
TC405
TC400
FC400
TC405 SP = TC405 SP + ∆T*OUT
SP SP SP
WABT
calculations
∆T*OUT
β1 β2 β3
k1 k2 k3
∆WABT
Figure 14.18 Reactor Conversion Control with Multiple Catalyst Beds, Inter-Bed Cooling, WABT Update
14.2.4 Reactor Effluent Cooling and Product Separation Section
Although the product separation section almost always involves additional reactor effluent/reactor
feed and reactor effluent/treat gas heat integrations, its primary operating objective is to separate
an H2-rich vapor product, and depending upon the reaction system, naphtha, various distillate,
gasoline, gas oil, and (low sulfur) diesel/fuel oil boiling range liquid products. A typical product
separation section’s unit configuration is illustrated in Figure 14.19.
Hot separator
drum
Low pressure 
separator drum
Product
fractionator HC feed
Additional HC
feed preheat
Cold separator 
drum
Treat gas Additional
treat gas preheat
Gas
scrubber
H2 recycle
Reactor
effluent
Bottoms product 
(e.g., desulfurized 
fuel oil)
Distillate product 
(e.g., wild naphtha)
Rich
amine
Lean
amine
Liquid (product) recovery
Vapor recovery
To fuel gas
header
SS product 
(e.g., desulfurized
diesel)
Figure 14.19 Typical Product Cooling and Separation Section Unit Configuration
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License580 14 Reactor Conversion Control
As emphasized in Section 14.2.2, reactor effluent preheats a number of process streams; this
often includes the product fractionator’s feed, as shown in Figure 14.19. Reactor effluent is then
routed to a series of separator drums – a hot separator drum, a high-pressure separator drum, a cold
separator drum and/or a low-pressure separator drum, where the H2-rich gases and a liquid phase
are separated as the vapor is cooled by heat integration with hydrocarbon feed and treat gas/recycle
gas streams. The H2-rich gases that are separated are sent to a gas scrubber where H2S is removed;
the scrubbed gas is then recycled to the treat gas header. Depending upon the reaction system, the
liquid products from the separator drums are routed as feed to either a product fractionator, a steam
stripper, or to a debutanizer to be stabilized. Main fractionator unit characteristics, control basics,
and product quality controls were presented and discussed in Chapter 13 (Fractionator Product
Quality Control).
Product Separation via a Main Fractionator
Because of their multiple, wide boiling range products, the product separation sections for the
conversion-intensive reactor systems – cokers, visbreakers, catalytic crackers, and hydrocrack￾ers, feature a fractionator with overhead, sidestream and bottoms products (as illustrated in
Figure 14.19). The fractionator C4- overhead vapor is split – a portion is routed to a gas scrubber
for H2S removal and H2 recycle, and the remainder is sent directly to the fuel gas header. Naphtha
boiling range products are removed as a distillate product (or perhaps as a first sidestream product),
while the more important products are removed as sidestream products (various distillates and
gas oils, including desulfurized diesel and fuel oil) and bottoms product (fuel oils, heavy diesel
and effluent residium).
An example of a fractionator in product separation section service is discussed in Section 13.4.2,
for an FCCU main fractionator – Figure 13.32 presents the fractionator’s overhead and pumparound
configurations. The proposed overhead quality control strategy presented in Figure 13.33,
Intermediate Cat Naphtha (ICN) 95% point control, demonstrates the need for model-based
control due to the long deadtime between the downstream ICN 95% point measurement and
the fractionator overhead temperature, the strategy’s MV. The discussion, in Section 13.4.2, of
the pumparound duty management control strategy illustrates the control complexity needed to
shift heat duty from the bottom pumparound (BPA) to the top pumparound (TPA) in order to
maintain the rangeability of the quality control loop’s MV – the TPA duty. Specifically, a TPA air
fin exchanger’s duty becomes limited high, and the quality loop becomes wound-up high. Shifting
heat duty from BPA to TPA provides the quality loop with additional control rangeability and
enables the TPA duty to be increased. However, shifting pumparound heat duties impacts internal
reflux throughout the tower, and thus, tower fractionation. This may affect and thus interact
with other tower control strategies and generate additional complexities. This control strategy’s
complexities are typical, and as indicated in Section 13.4.2, for many main fractionators, control
objectives can be achieved more effectively using DMC.
Remember: For conversion-intensive reactor systems whose product separation section includes a
main fractionator, a DMC controller whose scope includes upstream and downstream units is often
the most effective approach. In fact, any highly heat integrated reactor effluent cooling and prod￾uct separation section, with multiple MVs and CVs, slow dynamics, long deadtimes, and inherent
interactions, will almost certainly be more effectively controlled by a DMC controller whose scope
spans both upstream and downstream units.
Product Separation via a Steam Stripper or Stabilizer
In contrast to the complexities of conversion-intensive reactor systems whose many wide boil￾ing range products must be separated in a fractionator, for hydrotreating reaction systems such Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.3 Reactor System Control Objectives, CVs, MVs, and DVs 581
as naphtha, kerosene, diesel, and gas oil hydrofiners, only one product is normally of interest – the
desulfurized product. Steam stripping is sufficient to meet the single product’s front-end speci￾fication, e.g., a 5% distillation point. Naphtha, kerosene, and diesel front-end product specifica￾tions are frequently met in CDU tower sidestream strippers. For example, in Chapter 11, Section
11.4.2, a control strategy is presented that maintains a kerosene hydrofiner product’s 5% distillation
point at target by manipulating a sidestream stripper’s steam/bottoms ratio. The process configura￾tion, displayed in Figure 11.27, includes the CDU, its kerosene boiling range sidestream draw-off,
the kerosene hydrofiner, and the sidestream stripper. The proposed control strategy presented in
Figure 11.29 maintains the validated kerosene’s 5% distillation point at its desired target by manip￾ulating the sidestream stripper’s steam/bottoms flow ratio.
Catalytic reformer product separation sections often feature the use of steam strippers and
light-ends towers to recover desired, on specification products. The last reactor’s effluent, the
reformate, is stabilized (C4-removed) in a debutanizer tower, with the overhead C4-vapor further
processed in a C3/C4 splitter, and routed to LPG tankage and the fuel gas header. The debutanizer
bottoms product’s (stabilized reformate) RVP or n-butane content is controlled, most likely via
the conventional bottoms product quality advanced control strategy (with reboiler duty as MV)
discussed in Section 12.7.1 and displayed in Figure 12.23. An example of a reformate stabilizer’s
conventional advanced control strategy to maintain reformate RVP at target is discussed in Section
12.10.2 and presented in Figure 12.61. The stabilized reformate (stabilizer bottoms) is normally
sent to tankage and used as either a MOGAS blend component (where the RVP is an important
property) or as an aromatics plant feed stock.
In addition to the advanced regulatory and conventional advanced control applications
implemented to support product fractionator, steam stripper, or stabilizer operations, other
control needs in the product separation section are managed by basic regulatory controls.
They primarily manage drum inventories, stabilize fractionator feed streams, and maintain
the required temperatures and pressures that support the vapor/liquid separations. However,
as discussed in this section, heat integrations, now commonly included in the design basis of
product separation sections, link feed preheat directly to reactor and product separation oper￾ations. Thus, control issues arise – loop interactions, maintaining control valves in controlling
range, etc., that complicate the reactor temperature controls that are directly linked to the heat
integrations.
14.3 Reactor System Control Objectives, CVs, MVs, and DVs
The reactor systems’ main control objectives are embedded in the reactor control fundamentals
and reactor system unit configuration discussions in Sections 14.1 and 14.2. A summary of those
control objectives is presented below:
● Control Reactor Conversion
– Achieved by (i) bed inlet temperature control, (ii) bed outlet temperature control, (iii) a bed
outlet temperature to bed inlet temperature control cascade, or (iv) in some cases, control of
the bed inlet/outlet temperature difference.
– Instead of bed outlet temperature, an average bed temperature or EIT can be controlled; if
either is controlled, it resets the bed inlet temperature controller.
– WABT is another conversion inference that is sometimes used to periodically update bed inlet
or bed outlet temperature controller set points to maintain the desired conversion over the
catalyst run.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License582 14 Reactor Conversion Control
– Remember: Control of conversion is indirect – conversion is not routinely calculated or mea￾sured but is inferred by various bed temperatures and weighted average bed temperatures.
● Manage Catalyst Deactivation
– Achieved by reactor partial pressure control and/or treat gas/feed ratio control
– Effective reactor temperature control helps
– Remember: Catalyst deactivation is managed via offline analysis and planning – it is not mea￾sured, calculated or controlled directly. It may be a root-cause of an unexpected or unexplained
conversion reduction.
● Avoid Unsafe Operating Conditions
– Achieved by stabilizing reactor operations, especially reactor temperatures.
– Monitor bed temperatures to detect hot spots – local variations of bed temperatures in excess
of established, normal magnitudes.
– Maintain valves in controlling range, especially those associated with temperature controllers,
via operational changes that impact those valve positions.
● Meet Product Quality and Product Yield Targets
– Maintain a reactor effluent’s quality at target by regulating reactor conversion via reactor tem￾perature adjustments.
– Meet distillate and gas oil product quality or yield targets via main fractionator or steam strip￾per controller adjustments.
Because reactor temperatures impact almost all control objectives, plant personnel – operators, pro￾cess technical (contact engineers), and control engineers always give highest priority to achieving
and maintaining effective reactor temperature controls.
14.3.1 Reactor System CVs
From the above summary of control objectives, a reactor system’s most important control variables
can be identified:
● Bed inlet temperature.
● Bed outlet temperature.
● Bed ΔT – either directly, i.e., measuring, differencing, and then controlling the difference, or
indirectly, via a bed outlet temperature → bed inlet temperature control cascade.
● EIT or average bed temperature – both calculated inferences of conversion.
● Treat gas/hydrocarbon feed ratio, although at times, this ratio is an MV.
● Reactor H2 partial pressure.
● Treat gas H2 purity or recycle gas H2 purity.
● Reactor effluent and/or the reactor system’s product quality.
Remember:
(i) Effective reactor temperature control is always the highest priority.
(ii) H2 partial pressure can only be calculated – it cannot be measured online. Thus, con￾trol of a calculated H2 partial pressure is really a model-based controller without a bias
update.
(iii) WABT is a conversion inference similar to EIT, that is typically specified offline, but is some￾times calculated online. In either case, the WABT is the basis for periodic bed inlet or bed outlet
temperature set point updates over the catalyst run. After validation, the new temperature set
points are manually entered by operators.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.3 Reactor System Control Objectives, CVs, MVs, and DVs 583
14.3.2 Reactor System MVs
From the discussions in Sections 14.1 and 14.2, a reactor system’s most important manipulated
variables are:
● Fired heater and/or heat exchanger duty – heat input to preheat hydrocarbon, treat gas, and
recycle gas feeds.
● Quench gas flow – heat removal to quench reactions.
● H2-rich treat gas flow or treat gas/feed ratio.
● H2-rich recycle gas flow or recycle gas/feed ratio.
● H2-rich make gas flow.
Note that inlet and outlet temperatures are increased over the catalyst run to maintain reactor
conversion as catalyst deactivation rates increase and rates of reaction decrease. However,
these changes are infrequent and done manually, and thus these temperatures are not normally
classified as MVs. Likewise, feed rates are sometimes reduced over the catalyst run to help meet
the conversion target. These adjustments are also infrequent and are done manually, and like inlet
and outlet temperatures, the feed rate is not normally classified as an MV.
14.3.3 Reactor System DVs
Based on the control objective descriptions and the discussions in Sections 14.1 and 14.2, here are
a reactor system’s most important disturbance variables:
● Treat gas or recycle gas H2 purity upsets have an important impact on reactor partial pressure,
and thus on coking tendency and catalyst deactivation rate. Since H2 is often a reactant, there is
further impact on the extent of reaction and conversion.
● Pressure upsets that affect reactor inlet and/or outlet pressure impact reactor partial pressure.
● Feed composition upsets have direct impact on the extent of reaction – thus conversion, and
coking tendency – thus catalyst deactivation rate.
● Upsets that impact fired heater or heat exchanger duties in preheat or reheat service. These upsets
directly impact reactor bed inlet temperatures, and thus all control objectives.
The effects of treat gas and recycle gas H2 purity upsets can be managed if (i) the purity is mea￾sured, (ii) the measurement is reliable, and (iii) an H2-rich stream (most often, the H2 make gas) is
available, is on flow (or pressure) control, and can be manipulated to control H2 purity. Other than
well-tuned, effective regulatory controls, there are no supplementary control methods available
to correct pressure upsets. However, when used in closed-loop control strategies, compensating
treat gas or recycle gas flows for pressure will help to some extent. Reactor system responses to
feed composition upsets are slow, especially if a feed surge drum is employed. Thus, effective reac￾tor temperature control should be able to manage the impact of these upsets. Fired heater BTU
control and heat exchanger duty control are effective methods used to attenuate fuel gas composi￾tion and exchanger hot fluid upsets; if the required measurements are available, both duty control
components should be included in preheat and reheat temperature control strategies.
14.3.4 Bottom Line: Effective Reactor Control is Difficult to Achieve
Effective reactor control performance is difficult to achieve for many reasons. Reactor operations
are driven by complex heat and material balance relationships that make their key process vari￾able responses interactive and multivariable. As discussed, control loop interactions caused by heat Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License584 14 Reactor Conversion Control
integrations in the preheat, reactor, and product separation sections are prominent, troublesome,
and must be managed. Because reaction rates are exponential functions of temperature, the extent
of reaction and conversion are both very strong functions of temperature. Excessively high tem￾peratures must be avoided because they can prematurely deactivate and/or damage the catalyst.
And if they are not detected in a timely fashion, they can lead to temperature hot spots and even
temperature runaways.
Although not directly related to reactor operations, main fractionator product quality control
strategies implemented in the effluent cooling and product separation section can be very com￾plex. As already highlighted, for conversion-intensive reactor systems whose product separation
section includes a main fractionator, control loop interactions, long deadtimes, complex heat inte￾grations, and the multivariable environment are handled more effectively via a model-based, mul￾tivariable controller such as DMC. In addition to the product separation section, the DMC’s scope
typically includes the entire reactor system – upstream (feed preparation, feed preheat, and reactor
sections) and downstream (light-ends towers, other C4-component separations) units.
14.4 Conventional Reactor Advanced Control Applications
This section presents typical conventional advanced control strategies that control conversion in
the reactor configurations discussed in Section 14.2.3. In each case, control of reactor temperature
is the focus, although treat gas/feed ratio control plays an important role in achieving the con￾version control objective. One application illustrates reactor H2 partial pressure control, using the
relationship in Equation (14.5) among H2 partial pressure, reactor pressure, and the treat gas/feed
ratio, and its rearranged form as a control algorithm in Equation (14.6). Where appropriate, the
use of temperature, pressure, and molecular weight compensated treat gas flow in these conversion
control applications is demonstrated.
One separation section control strategy is discussed – it features a steam stripper whose reboiler
duty is manipulated to control a gas oil H/F effluent product’s sulfur content (the stripper’s bot￾toms product). By maximizing heat recovery to feed in the stripper’s feed/bottoms exchanger, the
stripper’s reboiler duty required to meet the product’s sulfur content target is reduced.
14.4.1 Diesel Hydrofiner Effluent Sulfur Control
The Diesel Hydrofiner’s (R-335) feed preparation, feed preheat, and reactor section configurations
are shown in Figure 14.20. The operating objective is to produce a low sulfur diesel product that
is close to a maximum sulfur specification – with minimum “give-away”; this enables the desired
conversion to be met at lower reactor temperatures, with lower fuel gas consumption in preheat
heater F-335. To help monitor reactor operations, reactor effluent sulfur content lab results are
made available periodically and displayed at the operator’s console.
R-335 removes sulfur from a hydrocarbon feed made up of fresh feed – whose sources are two
CDU sidestream products and storage tank TK-305, plus a low sulfur product recycle stream whose
flow is controlled, FC316. The fresh feed and recycled product are mixed, and the combined total
hydrocarbon feed, FC315, is preheated in fired heater F-335. The preheated feed stream is then
combined with the H2-rich treat gas, which has been preheated separately in upstream units, and
the hydrocarbon – treat gas combined feed is routed to R-335.
The fresh feed originating as CDU sidestream products are controlled by FC115 and FC225;
each flow is manipulated to meet a sidestream draw-off back-end property target. Because both
are third-sidestreams, their boiling ranges and thus their compositions are similar. Also, because Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.4 Conventional Reactor Advanced Control Applications 585
F-335
Fresh
feed
PV501
APS 1
3 SS
APS 2
3 SS
TI
315
FC
115
FC
225
PC
501
TI
369
Low sulfur
product
recycle
FC
315
FC
316
Total
feed
AI
369
Fuel gas
LHV
FC
351
Preheated
treat gas
Sulfur content
(lab value)
Fuel gas
header
PI
350
FI
350
R-335
Diesel H/F
Quality
Quality
FV350
To product
separation
FV315
E-335
TK-305
Figure 14.20 Diesel H/F R-335 Feed Preparation, Feed Preheat and Reactor Section Configuration
quality control adjustments are typically small and implemented slowly, any flow rate variations
should be small. Thus, these feed sources should not cause feed or unit upsets. The fresh feed flow
originating in TK-305 is on pressure control, PC501, and it plays an important role in setting R-335’s
total hydrocarbon feed rate – an FC315 SP change is satisfied by PC501’s adjustments to TK-305 feed
source flow:
– If FC315 SP is increased, FV315 opens, pressure PC501 PV decreases, PC501 opens PV501, flow
from TK-305 increases, and FC315 PV increases to satisfy the new (higher) FC315 SP value.
– If FC315 SP is decreased, FV315 closes, pressure PC501 PV increases, PC501 closes PV501, flow
from TK-305 decreases, and FC315 PV decreases to satisfy the new (lower) FC315 SP value.
The product recycle stream has already been processed in R-335; therefore, it has a much
lower sulfur content than fresh feed, and by replacing fresh feed with product recycle, the feed’s
sulfur content is lowered. Thus, the product’s sulfur specification can be met at somewhat lower
reactor conversions and temperatures. If needed, product recycle flow is a degree of freedom
available to lower reactor temperatures when F-335 is constrained high – fuel gas flow valve
FV350 is full open, or COT (TI315 PV) and/or reactor outlet temperature (TI369 PV) is constrained
high. Product recycle flow, FC316 PV, is zero (or at an offline established minimum flow) at the
start-of-run and is normally not changed until F-335 duty and/or R-335 temperatures are becoming
limited high.
If product recycle flow, FC316 SP, is increased at constant total feed rate (FC315 SP unchanged),
the total feed rate FC315 PV initially tends to increase, and in response, FC315 will close FV315.
The initial flow increase and FC315’s control actions to close FV315 both increase PC501 PV.
In response, PC501 closes PV501, decreasing feed flow from TK-305. This returns FC315 PV to
the (unchanged) FC315 SP, while FC315 adjustments to FV315 ensure total feed flow remains
constant. If FC316 SP is decreased, FC315 PV initially tends to decrease, FC315 responds by
opening FV315, pressure PC501 PV decreases, and PC501 opens PV501 to increase feed flow from
TK-305. The flow increase from TK-305 and the FV315 control adjustments ensure total feed
flow remains constant. Notice: Increasing FC316 SP at constant total feed rate (FC315 SP), which
will ultimately require somewhat lower reactor temperatures to achieve a target conversion, is a
consequence of increasing the product recycle/total feed flow ratio.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License586 14 Reactor Conversion Control
SP
SP
RC316 Recycle/total feed
ratio control
Desired
recycle gas/total feed
ratio
Product
recycle
FC
316
Product recycle
flow control
FV316
Desired TG/total feed
ratio
FC
351
Treat gas to
E-335
RC351
SP
SP
FV351
FC
315
TG flow
control
TG/total feed
ratio control
Total
feed
Figure 14.21 Diesel H/F R-335 Treat Gas/Feed and Product Recycle Gas/Feed Ratio Controls
At times, the reactor’s total feed rate, FC315 SP, must be changed to comply with daily operations
directives. Because feed rate affects reactor residence time, increases in feed rate normally require
somewhat higher reactor temperatures to maintain conversion constant. When FC315 SP is
increased, at constant product recycle flow (FC316 SP), the recycle flow/total feed ratio decreases
which tends to further increase the reactor temperatures necessary to maintain conversion
constant. If FC315 SP is decreased, somewhat lower reactor temperatures are required to maintain
constant conversion; the recycle flow/total feed ratio increases, which tends to further decrease
the reactor temperatures necessary to maintain constant conversion. Therefore, the product
recycle/total feed ratio, like the treat gas/total feed ratio, is controlled, and any change in total feed
initiates a change in product recycle flow to maintain the ratio constant. By ratioing the product
recycle flow to the total feed rate, the degree to which recycled gas affects conversion can, in
principle, remain about the same.
Diesel H/F Treat Gas/Total Feed and Product Recycle/Total Feed Ratio Control
As expected, an operating objective is to deliver only enough treat gas flow to R-335 to support the
desired hydrofiner reactions and maintain R-335 H2 partial pressure at a value that in principle
ensures the catalyst end-of-run target is met. By ratioing treat gas flow to total feed flow, using
more treat gas than necessary is avoided when operators attempt to ensure there is enough for any
expected reactor feed rate. Although not shown in Figure 14.20, this normally lowers treat gas pre￾heat and compression operating costs, and makes more H2-rich make-up or recycle gas available for
other processing. Maintaining the product recycle/total feed ratio at a target value when total feed
rate changes maintains the degree to which recycle gas affects conversion unchanged. The control
strategy implemented to achieve these two operating objectives is presented in Figure 14.21.
The desired treat gas/total feed ratio (RC351 SP) is calculated offline by the PTS group. Newly
specified RC316 targets are periodically communicated to operations via daily directives and
entered manually by operators. The desired product recycle gas /total feed ratio (RC316 SP) is
zero or at a PTS established minimum value at the start-of-run. It normally remains unchanged
until F-335 duty and/or reactor temperatures are approaching their (high) limiting values. This
typically happens only near the catalyst’s end-of-run. Newly specified RC316 targets are calculated
offline, communicated to operations via daily directives, and entered manually by operators. The
intent is to enable conversion targets to be achieved at somewhat lower reactor temperatures and
help extend the catalyst run to the scheduled end-of-run date.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.4 Conventional Reactor Advanced Control Applications 587
Design Notes and Features
1) Both control strategies are simple cascades, and cascade initialization and wind-up are both
handled by standard DCS features.
2) Flow controllers FC351 and FC316 are standard flow controllers and thus have control direc￾tion = Reverse. FC351 and FC316 are cascade secondaries and therefore they are tuned for fast
SP response, proportional on error with SPInit =Yes.
3) RC351 and RC316 are not PIDs, and thus they require no tuning. Since they are cascade pri￾maries, and their setpoint values are offline established guideline values, setting SP Init = No is
in principle acceptable. However, if SP Init = No, FC351 SP and FC316 SP will almost certainly
be bumped after RC351 or RC316 initialize. Configuring RC351 and RC316 for SP Init = Yes
ensures FC351 SP and FC316 SP are not bumped after RC351 or RC316 initialize. However,
if SP Init =Yes is chosen, additional logic is typically provided to slowly ramp the initialized
RC351 SP or RC316 SP back to the last (guideline) SP value.
4) When the total feed flow measurement (FC315 PV) becomes unavailable, standard DCS fea￾tures prevent RC351 and RC316 from changing the treat gas and product recycle flow setpoints.
Standard DCS features will also recommission ratio control when the feed flow measurement
becomes available once again.
5) If FC315 SP is used as RC351 and RC316 wild flow inputs instead of FC315 PV (to minimize
propagation of the feed measurement’s noise to either treat gas or product recycle flows), FC315
must be configured for SP Init =Yes. If FC315 is an ultimate secondary in another control cas￾cade, it is already configured for SP Init =Yes. If not, then choose SP Init =Yes, but additional
custom logic is typically provided to (i) ramp the initialized FC315 SP back to its last (guideline)
SP value and (ii) to switch the wild flow input to FC315 PV whenever FC315 becomes wound-up
and is not in Manual mode.
Reactor R-335 Conversion Control
To meet the sulfur specification, reactor conversion is controlled, and effective temperature control
once again provides the best approach to meet the sulfur specification. For R-335’s reactor section
configuration – a fixed bed reactor with one catalyst bed and measured inlet and outlet tempera￾tures, the reactor conversion control strategy will in most cases be, as shown in Figure 14.11 – a
bed outlet temperature → bed inlet temperature → feed preheat MV cascade. For R-335 in
Figure 14.20, reactor inlet (TI315, F-335’s COT) and outlet temperatures (TI369), and hence the
temperature profile across the catalyst bed, is established by manipulating preheat heater F-335
heat duty. This control strategy is presented in Figure 14.22.
In Figure 14.22, the strategy’s ultimate primary, TC369, can be configured as a PID controller.
If so, it should be configured for control direction = Reverse, and SPInit = No. Although its set
point will be changed periodically over the catalyst run to compensate for catalyst deactivation,
these changes are infrequent and thus it should be tuned for best load response, proportional on
PV. Additional logic should be provided to slowly ramp the initialized TC369 SP back to its last
(guideline) value after an initialization pass. Notice that upstream treat gas inlet temperature upsets
impact R-335 inlet temperatures and thus R-335 outlet temperature. Also, TC369 PV responses to
changes in COT (TC315 SP) may be slow and contain deadtime – good control performance may be
difficult to achieve. Thus, TC369, as a model-based controller may provide more effective control
performance than a PID.
Referring once again to Figure 14.22, the cascade’s control components, from the COT controller
(TC315) to the fuel gas flow controller FC350, are the components that make up the standard
COT with BTU control strategy discussed in detail in Chapter 10 in Section 10.4.6 and shown in Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License588 14 Reactor Conversion Control
TI
315 TC315
RC350 FCG315
F-335
COT
F-335 duty/feed
ratio control
SP
SP
COT
control
Dynamic
compensation
TI
369 TC369 R-335 outlet
temperature
SP
PI
350
Fuel gas
header
AI
369
QC350
Fuel gas
to F-335
Fuel gas
LHV
F-335
Duty
Fuel gas
flow
SP
SP
AIV369
Validation
FC
350
FV350
FC
315
Total feed
rate
Desired R-335
outlet temperature
Figure 14.22 Diesel H/F R-335 Conversion Control
Figure 10.31. The control strategy proposed in Figure 14.22 is a simple cascade and with the excep￾tion of key features of some COT control cascade components (identified and discussed below),
cascade initialization and wind-up are both handled by standard DCS features.
Design Notes and Features
The design notes and features listed/discussed in Chapter 10, Sections 10.4.4 (Ratio Feed Rate Feed￾forward Control) and 10.4.6 (BTU Control: Feedforward Corrections for Fuel Gas Heating Value
Upsets), are all applicable to the control strategy in Figure 14.22. These key features/issues, applied
specifically to the control strategy presented in Figure 14.22, are summarized below:
1) Fuel gas flow controller, FC350: Configured as a PID, tuned for best SP response, with propor￾tional on error, control direction = Reverse, and SP Init = Yes. The maximum allowable FV350
valve position (full open) is enforced by an FC350 OP high-limit clamp.
2) QC350 control algorithm: Because its secondary is the fuel gas flow controller, its control algo￾rithm can be algebraic: FC350 SP = QC350 SP/AIV369 LastGoodValue, where AIV369 Last￾GoodValue is AIV369’s internal storage location for the valid value of AI369 PV.7 QC350 can
also be configured as a PID controller. As a cascade secondary, whether the control algorithm
is algebraic or PID, QC350 is configured with SP Init =Yes. If a PID controller, it is tuned for
best SP response, proportional on error, with control direction =Reverse. Whether the control
algorithm is algebraic or PID, the maximum allowable F-335 heat duty is enforced by a QC350
set point high clamp.
7 See Section 8.8, and discussion of Figure 8-6.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.4 Conventional Reactor Advanced Control Applications 589
3) Heating value validation tag AIV369 functionality8: Determines the heating value measure￾ment’s (AI369 PV) status. Manages (i) heating value feedforward (FF) control On/Off, (ii) an
invalid AI369 PV measurement and its return to valid status, and (iii) BTU controller QC350’s
initialization when either heating value feedforward control is commissioned or an invalid
AI369 PV returns valid. Its functionality ensures feedback control continues when the heating
value feedforward is off.
4) Use of FC315 SP or PV as (dynamic compensation tag’s) FCG315 PV input: FC315 SP is the pre￾ferred choice to minimize feed measurement noise propagation to the fuel gas. If not a cascade
secondary, configure FC315 for SP Init =Yes and slowly ramp FC315 SP back to its desired (run
plan) set point. It may also be desirable to provide custom logic/code to use FC315 PV, instead
of FC315 SP, when FC315 is wound-up and not in Manual mode.
5) Dynamic compensation tag FCG315 functionality9: Manages (i) feed rate feedforward control
On (transfer to Auto mode)/Off (transfer to Manual mode), (ii) an unavailable FC315 PV
measurement and its return to available, and (iii) ratio controller RC350’s initialization when
feed rate feedforward is commissioned, and when an unavailable FC315 PV returns available.
Its functionality ensures feedback control continues when feed rate feedforward is off.
6) RC350 control algorithm: Algebraic – QC350 SP = RC350 SP * FCG315 LastGoodValue, where
FCG315 LastGoodValue is FCG315’s internal storage location for the last good value of the
dynamically compensated feed rate. As a cascade secondary, RC350 is configured with SP
Init =Yes.
7) TC315, F-335’s COT controller: TC315 is configured with a PID control algorithm, tuned for best
SP response, proportional on error, with control direction =Reverse, and with SP Init =Yes (it is
a cascade secondary).
8) TC369, R-335 outlet temperature: Can be configured as a PID controller (tuned for best load
response, proportional on PV), control direction=Reverse, and SP Init = No), although additional
logic should be provided to slowly ramp the initialized TC369 SP back to the last (guideline)
SP value. As mentioned earlier, TC369 as a model-based controller may provide better control
than as a PID; however, model development would be a significant engineering effort.
Sulfur Content Online Monitoring
Sulfur lab results are historized and typically displayed at the console for operator monitoring
and to provide guidance to operators and process specialists when reactor temperature set point
adjustments are made. Depending upon the time interval between lab samples, lab result trends
may also be displayed.
If an inferential model that predicts sulfur content well could be developed – by matching his￾torized lab results to hourly averaged values of time-synchronized independent variables, then
sulfur predictions would be available between sample times. New lab results, after validation, would
be used to update the model’s bias and maintain the model’s ability to adequately predict sulfur
content. However, as discussed in Section 8.7.2, the problems and complexities of developing an
inferential model using historized lab data are significant. Thus, unless the associated credits are
identified with a substantial degree of certainty, and they are significant, it would be very diffi￾cult to justify the operations, laboratory, and engineering effort required to apply this approach to
Figure 14.20’s R-335. How such an inferential prediction model would be used to monitor R-335
operations is presented in Figure 8.3 and explained in Section 8.7.2.
8 See Section 8.8, and discussions of Figures 8-4 and 8-6.
9 See Section 3.4 for discussions of the dynamic compensation calculation result’s storage, its use as the ratio
controller’s wild flow input, its role in commissioning/decommissioning feedforward control, and its role in ratio
controller initialization.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License590 14 Reactor Conversion Control
D
5
5
1
D
5
5
3
F-525
Make-up gas
Hot separator
drum
To cold
separator drum
Low pressure
separator drum
Product
fractionator
vapor feed
Gas oil
H/F reactor
TG preheat heater
Treat gas
D-559
Quench surge
drum
Product
fractionator
liquid feed
PI
550
FI
550
R-535
TI
511
FI
541 Recycle gas
FC
551
TI
505 TI
509
TC
512
TI
508
Recycle gas
compressor
TI spillback
520
PI
524
AI
594
FV541
TV505
Feed surge D drum
5
0
1
Hydrocarbon
feed
LI
556
Fuel gas
TI
510
TI
513
TC
520
FC
553
TC
522
FV551
E-518
E-510
E-508
Figure 14.23 Gasoil Hydrofiner R-535 Feed Preheat, Reactor and Product Separation Section Configuration
14.4.2 Gas Oil Hydrofiner R-535 Conversion Control
Figure 14.23 presents the configuration of Gas Oil Hydrofiner R-535’s feed preheat, reactor, and
product separation sections. Analogous to the reactor section configuration discussed in Section
14.2.3 (see Figure 14.16), R-535 is a single fixed bed reactor, with two (instead of three) catalyst
beds, and inter-bed cooling between the two beds via quench gas. The lower bed’s inlet tempera￾ture, TC512, is controlled by manipulating quench gas flow, FC561. Like the feed preheat section
configuration discussed in Section 14.2.2 (see Figure 14.7), the treat gas (a mixture of recycle and
make-up H2 gases) is preheated in fired heater F-525, while the hydrocarbon feed is preheated
in two feed/effluent heat exchangers, E-508 and E-510. The operating objective is to produce a
low-sulfur gas oil product that satisfies a maximum sulfur specification. As emphasized throughout
this chapter, it is effective reactor temperature controls that are most important.
Based on the discussions in Sections 14.2.1 through 14.2.4, the following control strategies are
applicable to meet R-535’s sulfur content operating objective:
– Treat gas/feed ratio control to help set the desired reactor H2 partial pressure.
– R-535 upper bed inlet temperature (TI509) control to help satisfy the upper bed’s conversion
target.
– R-535’s EIT control, calculated across both catalyst beds to help satisfy the reactor system’s overall
conversion target.
In addition, to help maintain the same catalyst deactivation rate in each bed as R-535’s operating
temperatures are increased over the catalyst run, the difference between upper (TI508 PV) and
lower (TI511 PV) bed outlet temperatures is maintained constant.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.4 Conventional Reactor Advanced Control Applications 591
Hydrocarbon
(HC) feed
FC
553 RC541
Desired TG/HC Ratio
SP
T, P, MW
comp TG
flow Ctl
TI
520
PI
524
Treat gas (TG)
pressure
FC541 TIV520
AI
594 AIV594 TG purity
Validation
Treat gas
to F-525
Recycle gas 
compressor
FV541 spillback flow
Recycle gas
to E-518
Make-up gas
to E-518
FI
541
E-518
F-525 CIT,
TG temp
SP
Treat gas flow
Figure 14.24 R-535 Treat Gas/Hydrocarbon Feed Ratio Control
R-535 Treat Gas/Hydrocarbon Feed Ratio Control
In Section 14.1.5, Equation (14.5), the calculation of reactor H2 partial pressure indicates the treat
gas/feed ratio plays a key role in establishing the reactor’s H2 partial pressure. In addition, treat
gas to feed ratio control makes operator actions that set excessive treat gas flow targets to satisfy
the full range of hydrocarbon feed rates unnecessary. For R-535, this reduces treat gas preheat duty
requirements (less fuel gas consumption in F-525) and makes more make-up and/or recycle gas
available for other processing purposes. Therefore, it is best to use only enough treat gas to support
the desired hydrofiner reactions and help maintain R-535 at an H2 partial pressure that supports
meeting the catalyst end-of-run target.
The control strategy implemented to achieve these operating objectives is presented in
Figure 14.24. The desired treat gas/hydrocarbon feed ratio RC541 is maintained at its target
(RC541 SP) by adjusting the temperature (TI520 PV), pressure (PI524 PV), and treat gas H2 purity
(AI594 PV) compensated treat gas flow set point, FC541 SP. RC541 SP is calculated offline to meet
a desired reactor partial pressure target. The compensated treat gas flow supplies a more accurate
amount of H2 to R-535 and thus helps meet the offline specified reactor H2 partial pressure
target more effectively. However, flow compensation requires two additional control components:
(i) the validation of both the treat gas temperature measurement (in TIV520) and the H2 purity
measurement (in AIV595), and (ii) additional logic/code to handle invalid inputs, and invalid
inputs returning to a valid status. These important control components, features required to use a
compensated flow in closed-loop control, are discussed in Section 8.9.
Note: In the treat gas flow configuration in Figure 14.23, the treat gas flow control valve (FV541) is
upstream of the treat gas flow transmitter and diverts treat gas flow away from the transmitter.
Thus, FV541 must open in order to decrease treat gas flow (FC541 PV). Thus, FC541 must be con￾figured to have control direction = Direct – most flow controllers are configured with control direc￾tion = Reverse.
Design Notes and Features
1) The control strategy is a simple cascade, and the initialization and wind-up status of RC541,
when FC541’s initialization and wind-up status change, is handled by standard DCS features. Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License592 14 Reactor Conversion Control
2) Compensated treat gas flow controller FC541 configured control direction is Direct – if FC541
PV is increasing and/or is above its setpoint, FC541 OP increases to open valve FV541. FC541 is
a cascade secondary; it is tuned for best SP response, proportional on error with SP Init =Yes.
3) Standard validity checks are required for the treat gas temperature (in TIV520) and H2 purity
(in AIV594) measurements. FC541 resident, user-provided logic/code must also be provided
to manage the calculation of FC541 PV when either input is unavailable or is declared invalid
and to manage the initialization of FC541 when either input’s status returns to valid after being
invalid or unavailable. Details are presented in Section 8.9.
4) RC541 is not a PID, and thus it requires no tuning. Since it is a cascade primary, and its setpoint
value is an offline established guideline, setting SP Init = No is in principle acceptable. How￾ever, if SP Init = No, FC541 SP will almost certainly be bumped on an RC541 initialization pass.
If RC541 is configured for SP Init =Yes, an FC541 SP bump is avoided, but additional logic is
usually provided to slowly ramp the initialized RC541 SP back to its last (guideline) SP value.
5) When the hydrocarbon feed flow measurement (FC553 PV) becomes unavailable, standard DCS
features stop RC541’s control calculations and prevent RC541 from changing the treat gas flow
setpoint. Standard DCS features will also re-commission RC541 control when the feed mea￾surement becomes available once again. Treat gas flow compensation continues, and (if FC541
is transferred to auto) responds to operator entered FC541 SP changes.
6) If FC553 SP is used as RC541’s wild flow input instead of FC553 PV (to minimize propaga￾tion of the feed measurement’s noise to the treat gas flow), FC553 must be configured for
SP Init =Yes. If FC533 is an ultimate secondary in another control cascade, it is already
configured for SP Init =Yes. If not, and SPInit =Yes is chosen, additional logic/code is
normally provided to (i) ramp the initialized FC553 SP back to its last (guideline) value and
(ii) switch the wild flow input to FC533 PV whenever FC533 becomes wound-up and is not in
Manual mode.
R-535 Inlet Temperature Control
R-535’s operating objective is the production of a low-sulfur gas oil product that satisfies a maxi￾mum sulfur specification. Again, to satisfy this operating objective, effective temperature control is
essential. There are a number of possible temperature control strategy designs that can set reactor
conversion, although all such control strategies include reactor bed inlet temperature control.
The lower bed’s inlet temperature is already controlled via the TC512 → FC551 (quench gas
flow) cascade. In Figure 14.23, R-535’s upper bed inlet temperature, TI509 PV, is the tempera￾ture of the combined treat gas and hydrocarbon feed streams. Feed/effluent exchanger E-510’s
duty is manipulated to control the vapor temperature (TC520) exiting hot separator drum D-551.
Feed/effluent exchanger E-508’s duty is manipulated to control the hydrocarbon feed temperature
at E-508 outlet (TC522) upstream of E-510. Therefore, with E-508 and E-510 duties set externally,
the only way to control TI509 PV is by manipulating fired heater F-525’s heat duty. This control
strategy is presented in Figure 14.25.
R-535’s upper bed inlet temperature TI509 PV is maintained at its desired target by TC509,
manipulating the F-525’s COT controller’s set point, TC505 SP. Included are feedforward cor￾rections for the validated F-525 coil inlet temperature (from TIV520 in Figure 14.24) and the T,
P, MW compensated treat gas flow (FC541 PV in Figure 14.24). Treat gas and CIT feedforward
corrections are implemented by calculating, in FCTIG451, the heat required to raise the treat gas
(F-525 feed) temperature from the CIT to COT. The heat required is dynamically compensated in
FCTIG541 – this assumes the dynamics of F-525’s COT (TC505 PV) responses to CIT and treat gas
flow changes are about the same.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.4 Conventional Reactor Advanced Control Applications 593
RC550 Fuel gas/heat required
ratio control
SP
FC
550
Fuel gas
flow
SP
TV550
FCTIG541
Heat required
calculation
dynamic compensation
Validated F-525 CIT
(from TIV520)
T, P, MW comp
TG flow
(FC541 PV or SP) 
From TG/HC feed
ratio control
(Figure 14.24)
TC505 COT
control
SP
TC509
SP
Desired R-535 upper bed
inlet temperature
F-525
COT
TI
505
TI
509
R-535 upper bed
inlet temperature R-535 upper bed inlet
temperature control
Typical value
of COT
Figure 14.25 R-535, Upper Bed Inlet Temperature Control
The use of heat required in COT control is discussed in Section 10.4.2. Referring to Equation
(10.8) in Section 10.4.2, the calculation of the heat required (QR) for the strategy in Figure 14.25 is
given by:
QR = FCTIG541 PV = Scale1 ∗ FC541 PV ∗ CP ∗ [TC505 Typical − TIV520 PV] (14.19)
where
FCTIG541 PV Heat required to raise the treat gas temperature from F-525’s CIT to
its COT
Scale1 Scale factor that converts QR to the desired engineering units
FC541 PV T, P, MW compensated treat gas flow (FI541 PV)
CP Treat gas heat capacity
TC505 Typical “Typical” value of F-525 COT – this cannot be TC505 PV or TC505 SP,
see Section 10.4.5, and Design Notes and Features #10 below
TIV520 PV Validated F-525 CIT
FCTIG541’s control calculation dynamically compensates FCTIG541 PV via standard DCS
deadtime and lead/lag algorithms or function blocks. The control calculation’s result, the dynam￾ically compensated heat required, is stored in a designated FCTIG541 storage location (only
when FCTIG541 is in Auto mode), the source for the fuel gas/heat required ratio controller
RC550’s wild flow input – see Section 3.4 for dynamic compensation calculation details. COT
controller TC505 resets RC550 SP, and RC550 then resets the fuel gas flow controller’s set point,
FC550 SP.
As the catalyst run proceeds and begins to approach its end-of-run, a maximum F-525 duty limita￾tion, either a maximum allowable COT (TC505 SP) or a maximum allowable fuel gas valve position,
TV505 full open, may restrict further TC509 SP increases. When COT control (TC505) and/or fuel
gas flow control (FC550) are/is wound-up high, standard DCS functionality will also set TC509’s
wind-up status to high, stopping further increases in TC509 SP. At that time, a feed rate decrease Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License594 14 Reactor Conversion Control
(which also reduces treat gas flow) or an increase in TC522 SP (hydrocarbon feed temperature) may
be an option – this is an operations and PTS decision.
Because quench gas flow FC551 is manipulated to control lower bed inlet temperature TC512,
increases in TC509 SP, especially as the end-of-run is approached, must also consider whether
quench gas flow controller FC551 is wound-up high, e.g. quench gas valve position FV551 full open.
Unlike TC509’s wind-up status being set High when F-525 is limited high, TC509’s wind-up status is
unaffected by FC551’s (or TC512’s) wind-up status. Therefore, user-provided code/logic must mon￾itor FC551’s wind-up status and (i) activate a console warning when quench gas flow FC551 PV is
limited high and (ii) prevent increases in TC509 SP until FV551 is once again in controlling range.
In Section 10.4.5 (Feedforward Control for both Feed Rate and CIT) and specifically Figure 10.29,
COT control with combined feed rate and CIT feedforward control is presented and discussed.
Referring once again to Figure 14.25, the cascade’s control components below TC509, from the
COT controller (TC505) to the fuel gas flow controller (FC550), are the same components that make
up the COT control strategy, with combined feed rate and CIT feedforward control, presented in
Figure 10.29. The design notes and features listed/discussed in Section 10.4.5 are all applicable to
the control strategy in Figure 14.25. Key features/issues, applied specifically to the control strategy
presented in Figure 14.25, are summarized below.
Design Notes and Features
1) The control strategy is a simple cascade – with the exception of key features of some standard
COT control cascade components (identified and discussed below), cascade initialization and
wind-up are both handled by standard DCS features.
2) TC509, R-535’s inlet temperature is configured as a PID, with control direction =Reverse.
TC509 is a primary and is therefore tuned for best load response, with proportional on PV,
and SP Init = No. As a primary, setting SP Init = No is in principle acceptable. However, if SP
Init = No, TC505 SP will almost certainly be bumped after TC509 initializes. If the COT bump
is unacceptable, then choose SP Init =Yes, but additional user-provided code/logic must be
provided to slowly ramp the initialized TC509 SP back to the last (guideline) SP value.
3) TC505 is configured as a PID, with proportional on error, control direction =Reverse, SP
Init =Yes, and is tuned for best SP response (it is a cascade secondary). Like TI509 PV, TI505’s
measurement does not require validation.
4) Ratio controller RC550’s set point is the desired fuel flow/heat required ratio. Because the
relationship between heat required (QR) and fuel gas flow is close to linear, the ratio con￾troller’s control algorithm is normally configured to be algebraic, e.g., FC550 SP = RC550 SP
* FCTIG541 LastGoodValue, where FCTIG541 LastGoodValue is FCTIG541’s designated stor￾age location for the last calculated (and last valid) value of the dynamically compensated heat
required. If the control algorithm is algebraic, RC550 PV is calculated for display only – it has
no role in RC550’s control calculation.
5) RC550 can also be implemented as a PID controller; if so, it is tuned for best SP response, pro￾portional on error with control direction =Reverse. If RC550 is a PID, then RC550 PV has an
essential role in RC550’s control calculation – it is the PID control algorithm’s PV input. With
either an algebraic or a PID control algorithm, RC550 is a cascade secondary and thus it is
configured with SP Init =Yes.
6) FCTIG541’s treat gas flow input can either be FC541 PV or SP. Normally, the SP is preferred to
minimize treat gas measurement noise propagation to fuel gas. FC541 is a cascade secondary
and hence it is already configured for SP Init= Yes. Additional logic, to switch FCTIG541’s
treat gas flow input to FC541 PV when FC541 is wound-up and not in Manual mode, is an
option to consider.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.4 Conventional Reactor Advanced Control Applications 595
7) Heat required feedforward is turned Off by transferring FCTIG541 from Auto to Manual.
In Manual mode, a new dynamically compensated heat required value is not calculated
or stored. Thus, the last calculated and stored value (in the FCTIG541 designated control
algorithm result’s storage location) remains RC550’s wild flow input on each execution pass
that FCTIG521 is in Manual mode. There is no feedforward compensation for either treat gas
flow or CIT, but feedback control continues, with RC550 using the last calculated (and stored)
value (now constant) of heat required. Transferring FCTIG541 back to Auto mode turns
heat required feedforward On. Fresh values of the heat required (FCTIG541 PV) are again
dynamically compensated, the results stored in FCTIG541 designated control algorithm
result’s storage location, and RC550’s wild flow input is again current.
8) Feedforward loop problems must not adversely affect the feedback loop (TC509 control). Poten￾tial feedforward loop problems are: (i) treat gas flow measurement FI541 becomes unavailable,
or (ii) the CIT measurement TI520 PV is declared invalid (in TIV520). With both treat gas flow
and CIT in a feedforward control loop, the last Good value of each is used if the measure￾ment becomes unavailable or is declared invalid. This allows the feedback control to remain
operational, but without one or both feedforward corrections.
9) Suitable FCTIG541 resident user-provided logic must be provided to initialize RC550 when
(i) heat required feedforward is turned On (FCTIG541 transferred to Auto mode), (ii) an
unavailable treat gas flow measurement (FI541 PV) returns available after being unavailable,
or (iii) the CIT measurement TI520 returns valid after being declared invalid in TIV520.
Following RC550’s initialization, standard DCS features initialize TC505 and TC509, and full
heat required feedforward control resumes.
10) As discussed in Section 10.4.5, the “COT” value used in the calculation of QR cannot be the COT
PV (the feedforward correction is in the wrong direction) and should not be the COT SP (the
feedforward and the COT feedback corrections combine and overcorrect for a COT set point
change). Thus, the use of a “typical” COT value is recommended – a design value, or an aver￾age value, or the COT PV value whenever the ratio controller initializes,. Once specified and
entered, the “typical” value is maintained constant in all subsequent calculations. This allows
the COT controller to respond to COT PV upsets or COT SP changes, and the feedforward loop
to respond to treat gas flow and CIT changes/upsets.
11) Fuel gas flow controller, FC550 is configured as a PID, proportional on error, control direction
= Reverse, SP Init =Yes and tuned for best SP response.
R-523 EIT, Conversion Control
Section 14.2.3 presents and discusses several options for maintaining individual bed and overall
conversion targets over the catalyst run. Based on that discussion, and referring to Figure 14.23,
one option to meet R-535’s upper and lower bed conversion targets would be to control only the two
bed inlet temperatures. With both upper (TI508 PV) and lower (TI511 PV) bed outlet temperatures
remaining uncontrolled, progressively higher upper bed (TC509 SP in Figure 14.25) and lower bed
(TC512 SP in Figure 14.23) inlet temperature targets are specified over the catalyst run.
Another option, which may improve conversion control (but certainly help prevent tempera￾ture runaways), would be to control both upper bed (TI508 PV) and lower bed (TI511 PV) outlet
temperatures – with TC508 resetting existing upper bed inlet temperature controller TC509, and
TC511 resetting existing lower bed inlet temperature controller, TC512. If so, progressively higher
values of both TC508 SP and TC511 SP are specified over the catalyst run to meet the individual
bed conversion targets.
Note that these two approaches focus on upper and lower bed conversion, and do not explicitly
manage overall conversion. In both cases, the temperature targets specified over the catalyst run are Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License596 14 Reactor Conversion Control
TI
510
TI
513
TI
508
TI
511
TIV510
Validations
TIV513
TIV508
TIV511
Desired
R-535 EIT
SP
TC514
EIT
control
SP
Upper bed mid-point
temperature
Lower bed outlet
temperature
Upper bed outlet
temperature
Lower bed mid-point
temperature
TI
509 TC509 R-535 upper bed inlet
temperature control
(Figure 14.25)
Figure 14.26 R-535 Overall Conversion Control via Reactor EIT Control
the results of thoughtful offline analysis that aligns operations experience with current PV trends
to develop temperature targets that predict an overall conversion close to the conversion target. In
many cases, both approaches to conversion control are acceptable – how successful depends upon
reaction, product, and unit configuration specifics. However, as discussed in Section 14.2.3, a third
option, control of the reactor’s EIT, does focus on meeting the overall conversion target. Such a
control strategy is displayed in Figure 14.26 for the R-535’s process configuration in Figure 14.23.
The upper bed’s inlet temperature controller (TC509) is reset by an EIT controller whose PV
input, the reactor’s EIT, includes temperatures in both beds. The EIT controller’s set point, specified
by the PTS group, is responsible for meeting the reactor’s overall conversion target. The four EIT
temperature inputs are validity-checked before they are used to calculate and control EIT. Referring
to Equation (14.8) in Section 14.2.3 – a typical EIT expression would be:
EIT PV = ∝1 ∗ TIV510 PV + ∝2 ∗ TIV508 PV + ∝3 ∗ TIV513 PV + ∝4 ∗ TIV511 PV (14.20)
where TIV510 PV,…, TIV511 PV are the validated bed temperatures, the 𝛼i are temperature weight￾ing factors, 𝛼i >0, and Σ𝛼i = 1 for i = 1,…, 4. Note that in many cases (but not in Figure 14.23),
redundant bed temperature measurements are provided at some or all bed probe locations. If so,
all redundant bed temperature measurements at the probe location are validated, the validated
temperatures are averaged, and the average is an EIT calculation input.
The analytic expression for EIT, and the 𝛼i values are normally specified by process designers or
process specialists. The αi may be updated, again by technical specialists, over the catalyst run as
areas of excess or insufficient catalyst activity are revealed. As expected, EIT controller set points
are slowly increased over the catalyst run. As the catalyst run proceeds and begins to approach
its end-of-run, a maximum allowable COT (enforced by a TC505 set point high clamp) or a maxi￾mum allowable fuel gas valve position TV550 (enforced by an FC550 OP high clamp) may restrict
further TC509 SP increases. If so, with TC509 wound-up High, and because the control strategy in
Figure 14.26 is a simple cascade, standard DCS features will also set EIT controller TC514’s wind-up
status to High, preventing further increases in EIT.
Design Notes and Features
1) EIT controller TC514 is configured as a PID with proportional on PV, control direction=Reverse,
SP Init = No, and is tuned for best load response. Because SP Init = No, additional logic is pro￾vided to slowly ramp the initialized TC514 SP value back to the last (guideline) SP value. Tight
control of EIT is not necessary, whether it is responding to a load upset or the occasional set
point increases made over the catalyst run.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.4 Conventional Reactor Advanced Control Applications 597
2) Given the locations of R-535’s bed temperature measurement probes, EIT control cannot con￾tinue if either bed outlet temperature, TI508 PV or TI511 PV, is invalid or unavailable, but it
can continue if either TI510 PV or TI513 PV is invalid or unavailable. If there are redundant
temperature measurements at a bed location, then the number of unavailable or invalid bed
temperature measurements at the location that invalidate the location’s temperature average
must be specified.
3) TC514 resident, user-provided logic/code is provided to initialize TC514 whenever (i) unavail￾able or invalid temperature measurements become available or return valid, and (ii) a bed
location’s invalid average temperature returns valid.
Equalizing R-535 Upper and Lower Catalyst Bed Deactivation Rates
With the EIT controller’s set point, TC514 SP, increasing over the catalyst run, it will consistently
increase the upper bed’s inlet temperature controller’s set point (TC509 SP). Conversion typically
increases, and as a result, the upper bed’s outlet temperature, TI508 PV, will tend to increase. But
note the lower bed’s inlet temperature is controlled and remains constant (TC512 SP). With increas￾ing conversion in the upper bed, the reactivity of the reactor contents entering the lower bed is lower
than the reactivity of the feed entering the upper bed; at constant inlet temperature (TC512 SP),
conversion achieved in the lower bed tends to decrease, and the lower bed’s outlet temperature
either remains about the same or tends to decrease. Although the overall conversion target is in
principle being met, the allocation of reactor conversion between the two catalyst beds is being dis￾torted – conversion tends to increase in the upper catalyst bed, and tends to decrease in the lower
catalyst bed.
As upper and lower bed conversions diverge, coke make and coke-on-catalyst also diverge; thus,
the rate of catalyst deactivation in the two beds tends to become somewhat unequal. As shown in
Figure 14.27, upper and lower bed deactivation rates can be more closely aligned by manipulating
the lower bed’s inlet temperature, TC512 SP, to maintain the difference between the (validated)
upper (TIV508 PV) and lower (TIV511 PV) bed outlet temperatures at a desired target:
Both bed outlet temperature measurements, TI508 PV and TI511 PV, are validated in the EIT
control strategy presented in Figure 14.26 – their validated values as last good values are already
available. Although not the case for R-535, if either bed outlet location features a redundant group
TC551
Desired bed outlet
temperature difference
SP
Validated upper bed
outlet temperature
(from EIT control in
Figure 14.26)
Validated lower bed
outlet temperature
(from EIT control in
Figure 14.26)
TIV508 PV TIV511 PV
Upper bed - lower bed
outlet temperature difference,
calculation and control
SP
TC
512
SP
Lower bed inlet
temperature control
FC
551
Quench
gas flow FV551
Figure 14.27 Equalizing R-535 Upper and Lower Catalyst Bed Deactivation Rates
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License598 14 Reactor Conversion Control
of temperature measurements, all redundant bed outlet temperature measurements at the loca￾tion are validated, then averaged, and the average is used to calculate the upper/lower bed outlet
temperature difference.
If either temperature measurement becomes unavailable or is declared invalid by either TIV508
or TIV511, TC551 resident, user-provided custom code/logic must ensure TC551 control action
stops. No matter how TC551 control action is stopped, the user-provided code/logic must also
ensure TC551 initializes when the invalid temperature measurement returns valid.
TC551 SP, the bed outlet temperature difference set point, is specified offline, equal to a value that
is expected to bring upper and lower bed deactivation rates closer to one another. TC551 SP may
be updated over the catalyst run if bed conversions or catalyst activities are observed to be slowly
diverging. When F-525 duty becomes limited high, and TC509 and TC514 are both wound-up high
and cannot be increased, the upper bed’s outlet temperature (TI508 PV) remains about the same.
This steadies TC551 PV, and until the F-525 limitation is relieved, control adjustments to TC512
are relatively small.
Design Notes and Features
1) Bed outlet temperature difference controller, TC551, is configured as a PID. TC551 is a primary,
whose set point is only occasionally changed. Therefore, it is configured with proportional
on PV, control action = Direct, SP Init = No, and is tuned for best load response. Because SP
Init = No, additional logic is provided to slowly ramp an initialized TC551 SP value back to its
last (guideline) SP value.
2) Tight control of TC551 is not necessary, and its control frequency must be relatively slow, or
even better, asynchronous – executed only when demanded to do so by an operator.
3) In the control strategy in Figure 14.27, lower bed inlet temperature controller TC512 is a sec￾ondary. However, because TC551’s control frequency is relatively slow, TC512’s set point will
be changed infrequently by TC551. It is thus configured as a PID, but with proportional on PV,
control action = Direct, SP Init =Yes, and is tuned for best load response.
4) Quench flow controller, FC551 is configured as a PID, with proportional on error, control direc￾tion = Reverse, SP Init =Yes, and tuned for best set point response.
14.4.3 Hydrodesulfurization (HDS) R-725 A/B/C Conversion Control
Figure 14.28 displays HDS reactor feed preparation, preheat, and reactor section configurations.
Its configuration is analogous to the reactor section configuration discussed in Section 14.2.3 and
shown in Figure 14.14. R-725A/B/C consists of three fixed bed reactors in series, each with a sin￾gle catalyst bed, with inter-reactor cooling provided by quench gas (cold recycle gas), between
R-725A&B and between R-725B&C. The feed is CDU bottoms and has high sulfur and metals
contents. The HDS unit produces a low sulfur fuel oil product that satisfies a maximum sulfur
specification; a significant percentage of the feed’s metals content is also removed.
R-725 A/B/C’s treat gas and hydrocarbon feed streams mix upstream of fired heater F-725, and
the combined feed stream is preheated in F-725. The preheated feed exiting F-725, at TI728 PV,
is R-725A’s inlet stream; R-725A’s outlet temperature, TI330 PV, is measured but uncontrolled.
Because the HDS reactions are exothermic, cold quench gas is injected to cool R-725A’s and
R-725B’s effluents, to inhibit their exothermic reactions before they enter R-725B and R-735C
respectively. The quench gas flows (FC751 and FC752) are manipulated to control R-725B’s
and R-725C’s inlet temperatures (TI731 PV and TI734 PV). Conversion in each reactor depends
upon the temperature rise in each catalyst bed. As discussed in Section 14.2.3 and displayed in
Figure 14.15, outlet-to-inlet temperature control cascades for each catalyst bed provide effective Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.4 Conventional Reactor Advanced Control Applications 599
FC
792
FI
762
Hydrocarbon
feed
(CDU btms)
PI
733
FI
735
TI
728
AI
708
Fuel gas
header
LHV
TI
720
PI
AI 734
794
FV735
TI
722
To product
separation
TI
732
TI
730
TI
720
FC
751
FC
752
Quench
gas 
TI
731
TI
734
FV751 FV752
Treat gas
FV762
P-771
F-725
HDS reactors
(R-725 A/B/C)
C-701 A/B
Figure 14.28 HDS Reactors R-725 A/B/C Feed, Preheat, and Reactor Section Configurations
conversion control for that bed. As the catalyst run proceeds, reactor bed outlet temperature set
points are periodically increased to meet conversion and product sulfur content targets.
Based on the discussions in Sections 14.2.1 through 14.2.4, the following control strategies are
applicable to meet R-725’s conversion and sulfur content operating objectives:
– Treat gas/feed ratio control to help meet the reactor H2 partial pressure target and reduce fuel
consumption in F-725.
– R-725A’s inlet (TI728 PV) and outlet (TI730 PV) temperature control to initiate the desired
hydrodesulfurization reactions and help satisfy R-725A’s conversion target.
– R-725B and R-725C inlet (TI731 PV, TI734 PV) and outlet (TI732 PV, TI720 PV) temperature con￾trol to quench the exothermic reactions in R-725A and R-725B effluents and help satisfy R-725B
and R-725C conversion targets.
Using periodic offline simulations (which may include WABT calculation guidance), suitable reac￾tor outlet temperature targets are specified over the catalyst run to meet overall conversion targets.
When specified in a daily operations report, the new temperature targets are manually entered by
operators.
R-725A/B/C Treat Gas/Hydrocarbon Feed Ratio Control
For the desulfurization reactors in Figure 14.28, it is only necessary to deliver enough treat gas
flow to support the desired desulfurization reactions and to help maintain R-725A/B/C H2 partial
pressures at values that will ensure the catalyst end-of-run target is met. Ratioing treat gas to feed
ensures only the recommended amount of treat gas is utilized at every expected reactor feed rate.
Using only enough treat gas to satisfy the desired ratio helps minimize F-725’s preheat duty, and
thus its fuel gas consumption. The control strategy that maintains the treat gas/feed ratio at an
offline specified target is presented in Figure 14.29.
The desired treat gas/oil feed ratio RC762 is maintained at an offline calculated set point (RC762
SP) by manipulating the temperature (TI720 PV), pressure (PI734 PV), and treat gas H2 purity
(AI794 PV) compensated treat gas flow set point, FC762 SP. As discussed previously, the compen￾sated treat gas flow supplies a more accurate amount of H2 to R-725A/B/C and helps meet the Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License600 14 Reactor Conversion Control
Desired TG/HC ratio
Hydrocarbon (HC)
feed
TI
720
PI
734
AI
794
TG
pressure
TG
temperature
TG
H2 purity
FC762
RC762
TIV520
SP
SP
AIV794
Validation
Validation
FI
762 Treat gas
flow
FV762
FC
792
T, P, H2 purity
compensated TG flow
Calc and Ctl
TG / HC
ratio control
Figure 14.29 R-725 A/B/C Treat Gas/Hydrocarbon Feed Ratio Control
offline specified reactor H2 partial pressure target more effectively. As discussed in Section 8.9, flow
compensation used in closed-loop control requires two additional control components – treat gas
temperature (in TIV520) and H2 purity (in AIV595) measurement validation, and user-provided
custom logic/code to handle invalid inputs and invalid inputs returning to valid status.
Design Notes and Features
The cascade structure and functionality of the treat gas/feed ratio control strategy in Figure 14.29
are identical to the treat gas/feed ratio control strategy in Figure 14.24 (Section 14.4.2) and there￾fore the six design notes and features listed for Figure 14.24 are also applicable to the strategy in
Figure 14.29 (with tag name references changed).
R-725A/B/C Feed Preheat, R-725A’s Inlet, and Outlet Temperature/Conversion Controls
Given the reactor configuration in Figure 14.28 (three fixed bed reactors in series, each with a single
catalyst bed, with inter-reactor quench gas cooling), as discussed in Section 14.2.3 and displayed in
Figure 14.15, each reactor’s conversion target is achieved by cascading the reactor’s outlet tempera￾ture controller to the reactor’s inlet temperature controller. R-725A’s inlet temperature is controlled
by manipulating fired heater F-725’s duty, while R-725B’s and R-725C’s inlet temperatures are
controlled by manipulating inter-reactor quench gas flows.
Starting with the lead reactor, R-725A, its outlet temperature’s target (TC730 SP) is specified
offline and periodically increased over the catalyst run. R-725A’s inlet temperature TC728 PV is
F-725’s COT; hence, R-725A’s temperature profile is established with TC730 resetting TC728 SP,
which then manipulates F-725’s heat duty. This control strategy is shown in Figure 14.30.
R-725A’s outlet temperature TC730 is maintained at its desired target (TC730 SP) by manipulat￾ing F-725’s COT controller’s set point, TC728 SP. The COT control strategy – all control components
below TC730, includes the standard elements of COT control presented in Section 10.4.7. These
features include feedforward corrections for (i) validated (in TIV722) F-725 coil inlet temperature
(TI722 PV), (ii) hydrocarbon feed rate (FC792 PV or SP), (iii) T, P, MW compensated treat gas flow
(FC762 PV or SP) and (iv) validated (in AIV708) fuel gas heating value (AI708 PV). CIT, hydrocar￾bon feed rate and treat gas feedforward corrections are implemented by calculating, in QIG792, the
heat required to raise F-725’s combined hydrocarbon and treat gas feed rate temperature from the
CIT to COT (see Section 10.4.5 for details). The calculation of heat required in QIG728 is described
below. The heat required is also dynamically compensated in QIG728 – this assumes the COT
response dynamics for CIT, treat gas flow, and hydrocarbon feed flow changes are about the same. Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.4 Conventional Reactor Advanced Control Applications 601
TI
728
F-725
COT
TC728 COT
control
SP
TI
730
Desired R-725A
outlet temperature
SP
TC730
SP
R-725A outlet
temperature TIV730
Validation
FC
792 HC feed
Typical COT
value
RC735
SP
Heat desired / heat required
ratio control
FV735
AI
708
LHV
FC
735
Fuel gas
flow
QC735 Heat duty
control
SP
AIV708
Validation Validation
TIV722
TI
722
FC762
F-725
CIT
QIG792 T, P, MW comp TG flow
(from TG/HC ratio Ctl
Figure 14.29) Heat required,
dynamic compensation
Figure 14.30 R-725A/B/C Feed Preheat, R-725A Inlet and Outlet Temperature/Conversion Controls
Feedforward corrections for fuel gas heating value changes are implemented by calculating and
controlling F-725 heat duty (see Section 10.4.6 for details), in QC735.
Since both treat gas and hydrocarbon feed are preheated in F-725, the heat required calculation
includes both the hydrocarbon feed (HC) and the treat gas (TG) flows. Referring to Equation (10.8)
in Section 10.4.2, the heat required calculation for hydrocarbon (QR HC) and treat gas (QR TG)
feeds are:
QR HC = S1 ∗ FC792 PV ∗ CP(HC)∗[TC728 Typical − TIV722 PV] (14.21a)
QR TG = S2 ∗ FC762 PV ∗ CP(TG)∗[TC728 Typical − TIV722 PV] (14.21b)
QR HC Heat required to raise the HC feed temperature from F-725’s CIT to its
COT
QR TG Heat required to raise the TG temperature from F-725’s CIT to its COT
S1, S2 Scale factors that convert QR HC and QR TG to desired engineering
units
FC792 PV Hydrocarbon feed rate
FC762 PV T, P, MW compensated treat gas flow (FI762 PV)
CP(HC), CP(TG) Hydrocarbon and treat gas heat capacities – provided by PTS and
maintained constant
TC728 Typical “Typical” value of F-725 COT, not the COT PV or SP – see Design
Notes and Feature #11 below
TIV722 PV Validated F-725 CIT
The total heat required, QIG792 PV, is the sum of the hydrocarbon and TG contributions in
Equations (14.21a) and (14.21b):
QIG792 PV = ΔT ∗ [S1 ∗ FC792 ∗ CP(HC) + S2 ∗ FC762 ∗ CP(TG)] (14.22)
where ΔT is the difference (TC728 Typical – TIV722 PV).
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License602 14 Reactor Conversion Control
QIG792’s control algorithm dynamically compensates QIG792 PV via standard DCS deadtime
and lead/lag algorithms or function blocks. The control calculation result, the dynamically
compensated heat required, is stored to the designated storage location holding QIG792’s control
algorithm result, which is RC735’s wild flow input source – the dynamically compensated heat
required (see Section 3.4 for details). Thus, transferring QIG792 into Manual mode stops the
dynamic compensation calculation, and the update of QIG792’s designated dynamically com￾pensated heat required storage location. Thus, this decommissions heat required feedforward,
but the more important feedback control corrections (COT control) continue unaffected by the
feedforward corrections being disabled. RC735’s wild flow input source remains constant, at its
last (good) stored value, but RC735 continues to receive and respond to fresh set points sent by the
COT controller (TC728), and output a new set point to QC735 SP.
TC728 resets RC735 SP to establish the heat desired/heat required target, and RC735 then resets
QC735 SP, the heat desired (firing rate). To compensate for fuel gas heating value (AI708 PV) upsets,
QC735 uses the current, valid fuel gas heating value (AIV708 PV), calculates and outputs the fuel
gas flow (FC735 SP) needed to satisfy QC735 SP. Based on Equation (10.9) in Section 10.4.2, the
heat desired or heat fired, QC735 PV, in Figure 14.30, is calculated as shown in Equation (14.23):
QC735 PV = S3 ∗ HV Source ∗ FC735 PV (14.23)
QC735 PV Current F-7-25 heat fired (heat duty, heat desired)
S3 Scale factor that ensures QC735 PV has the desired engineering units
HV Source Fuel gas heating value
FC745 PV Current fuel gas flow rate
The heating value in Equation (14.23) is the heating value currently in the designated heating
value source storage location in AIV708 – this is the last valid value of the heating value measure￾ment, AI708 PV. In Section 8.8 (Input Validation), the functionality provided by validation tags
such as AIV708 is discussed in detail and illustrated in Figure 8.4. How fired heater duty is calcu￾lated and controlled using the validated fuel gas heating value is discussed in detail and illustrated
in Figure 8.6.
As indicated in Figure 14.30, R-725A’s outlet temperature controller, TC730, is the strategy’s ulti￾mate primary. Over the catalyst run, TC730 SP is increased periodically as the PTS group decides
how best to meet the HDS reactor system’s overall conversion target. As the catalyst run proceeds
and begins to approach its end-of-run, a maximum F-725 duty limitation, either a maximum allow￾able COT (TC728 SP high clamp) or a maximum allowable F-725 duty (QC737 SP high clamp)
or a maximum allowable fuel gas valve position (FV735 full open), may restrict further TC730
SP increases. When TC728 or QC735 is wound-up high, or FV735 is fully open, standard DCS
functionality will set wind-up statuses of all controllers above the constrained entity to High, stop￾ping further increases in TC730 SP. At that time, a feed rate decrease may be an option – this is a
real-time operations and PTS decision.
Note that quench gas flow FC751 is manipulated to control R-725B’s inlet temperature, TC731,
which is always lower than R-725A’s outlet temperature, TC730 PV. Thus, increases in TC730
SP, especially toward the end-of-run, must also consider whether quench gas flow to R-725B
(FC751) is wound-up high and/or quench gas valve position FV751 is approaching full open.
Unlike TC730’s wind-up status being set High when F-725 heat duty is limited high, TC730’s
wind-up status is unaffected by a FC751 high wind-up status or a full open FV751. Therefore,
TC730 resident, user-provided code/logic must monitor FC751’s wind-up status and (i) prevent
increases in TC730 SP when FC751 is wound-up high, and (ii) provide a console display indication
that R-725B quench gas flow is limited high and TC730 SP cannot be increased.
Control of R-725A’s outlet temperature TC730 is achieved by manipulating TC728 SP, F-725’s
COT controller’s set point. All control components below TC730 (e.g., F-725’s COT control), include Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.4 Conventional Reactor Advanced Control Applications 603
the standard components of COT control presented in Section 10.4.7. The design notes and fea￾tures listed/discussed in Section 10.4.7 are all applicable to the control strategy in Figure 14.30.
However, there are several complexities, fundamental to the control strategy in Figure 14.30, that
must be managed: invalid inputs, invalid inputs returning to valid, maintaining feedback control
operational when the feedforward controls are turned off or disabled by bad inputs, controlling a
T, P, MW compensated TG flow, and activating control initializations to ensure bumpless transfers.
Therefore, additional explanations for these key features and issues are provided below.
Design Notes and Features
1) The control strategy is a simple cascade and with the exception of key features of some standard
COT control cascade components identified and discussed below, cascade initialization and
wind-up are both handled by standard DCS features.
2) TC730 is configured as a PID, with control direction =Reverse, and SP Init = No. Because SP
Init = No, additional logic is provided to slowly ramp the initialized TC730 SP back to the last
(guideline) SP value. TC730 SP is changed infrequently over the catalyst run, and therefore it
is tuned for best load response, with proportional on PV.
3) TI730’s measurement is a multiplexed, low-level input and therefore TI730 PV is validated
in TIV730. TC730 resident, user-provided code/logic sets TC730’s PV “Bad” to stop all TC730
control actions when TI730 PV is invalid, and resets TC730 PV to “Good” when TI730 PV
returns valid – standard DCS features will then initialize TC730.
4) TC728, F-725’s COT controller, is configured as a PID controller, proportional on error, control
direction =Reverse, and SP Init =Yes; it is tuned for best SP response.
5) RC735 SP is the heat-desired/heat-required ratio target calculated by TC728. RC735’s con￾trol algorithm is normally algebraic, e.g., QC735 SP = RC735 SP * QIG792 LastGoodValue,
where LastGoodValue is QIG792’s designated storage location for the last calculated value of
the dynamically compensated heat required. RC735 PV is calculated for display only – it has
no role in RC735’s algebraic control algorithm.
6) RC735 can also be implemented as a PID controller; if so, RC735 PV is meaningful – it is
RC735’s PID control algorithm’s PV input. It is tuned for best SP response, proportional on error
with control direction =Reverse. Whether it has an algebraic or a PID control algorithm, RC735
is a cascade secondary and thus it is configured with SP Init =Yes.
7) QIG792’s compensated TG (FC762) and hydrocarbon feed flow inputs (FC792) can either be
a PV or SP. Normally, the SP is the preferred input to minimize measurement noise propa￾gation to heat duty QC735 PV and ultimately to fuel gas FC735 PV. FC762 is a cascade sec￾ondary (Figure 14.29) and hence it is already configured for SP Init= Yes. If hydrocarbon
feed FC792 is not a cascade secondary, configure it for SP Init =Yes, and provide custom
logic/configuration/code to slowly ramp the initialized FC792 SP back to the last SP value.
Additional logic/code may be desirable to switch QIG792’s TG (FC762) and hydrocarbon feed
(FC792) flow inputs from SP to PV when FC762 or FC792 is wound-up and not in Manual
mode.
8) Heat required feedforward is turned Off by transferring QIG792 into Manual mode; feedback
control continues. In Manual mode, a new dynamically compensated heat required value is not
calculated or stored, and the last calculated LastGoodValue remains RC735’s wild flow input
for as long as QIG792 remains in Manual mode. There is no feedforward compensation for TG
flow, hydrocarbon flow or CIT, but feedback control continues. Transferring QIG792 into Auto
mode turns heat required feedforward On once again.
9) User-provided logic must be provided to initialize RC735 when (i) heat required feedforward
is turned On (QIG792 transferred to Auto mode), (ii) an unavailable TG or hydrocarbon feed
flow measurement (FI762 PV or FC792 PV) returns available after being unavailable or (iii) the Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License604 14 Reactor Conversion Control
CIT measurement TI720 PV returns valid after being declared invalid in TIV720. In all cases,
standard DCS features initialize TC728 and TC730 after RC735 initializes, and full control
functionality, with heat-required feedforward, resumes.
10) Feedforward loop problems must not adversely affect the feedback loop. Potential feedforward
loop problems are: (i) TG or hydrocarbon flow measurements (FI762 PV or FC792 PV) become
unavailable or (ii) the CIT measurement TI720 PV is declared invalid by TIV720. Since all
three measurements are used in the feedforward control loop, it is acceptable to use the last
“Good” value of each if the measurement becomes unavailable or is declared invalid. This
allows feedback control to remain operational but without feedforward corrections.
11) The “Typical COT” value used in the calculation of QR should be a “typical” or design value, or
an average value, or the COT PV value when the ratio controller initializes (see Section 10.4.5).
After being fixed, the “typical COT” value is maintained constant in all subsequent
calculations.
12) Since its secondary is the fuel gas flow controller, the duty control calculation can be
algebraic10: FC735 SP = QC735 SP/[Scale2 * AIV708 LastGoodValue]. Note that QC735
is commonly implemented as a PID, and if implemented as a PID, it is tuned for best SP
response, proportional on error, with control direction =Reverse. QC735 is a cascade sec￾ondary and thus whether it is an algebraic or PID control algorithm, it is configured for
SP Init =Yes.
13) A heating value measurement declared invalid by AIV708 must not adversely affect feedback
control. Since the heating value is used in feedforward control, it is acceptable to use its last
“Good” value if the measurement is declared invalid. This ensures COT control continues but
without feedforward compensation for heating value changes.
14) AIV708 LastGoodValue is not refreshed when AIV708 is in Manual mode. Thus, heating value
feedforward compensation is turned Off by transferring AIV708 into Manual mode. Although
there is no feedforward compensation for heating value changes, QC735 continues to execute,
using the last (now constant) validated heating value. COT control continues even if heating
value feedforward compensation is turned Off. When AIV708 is transferred back to Auto mode,
AIV708 LastGoodValue once again is refreshed, turning the heating value feedforward On. See
Section 8.8, and Figure 8.6 for details.
15) Suitable QC735 resident code/logic must be provided to initialize QC735 when (i) heating value
feedforward is turned On, e.g., AIV708 transferred to Auto mode or (ii) a heating value mea￾surement is declared valid after being declared invalid – see Section 8.8, and Figure 8.6 for
details. After QC735 is initialized, standard DCS features initialize all controllers above QC735.
16) FC735 is configured for PID control, proportional on error, control direction=Reverse, SP Init =
Yes and tuned for best SP response.
R-725B/C Inlet and Outlet Temperature/Conversion Controls
R-725B’s (TI731 PV) and R-725C’s (TI734 PV) inlet temperatures are controlled by manipulat￾ing inter-reactor quench gas flows (FC751 and FC752). Like R-725A’s reactor outlet temperature,
R-725B and R-725C outlet temperature controllers (TC732 and TC720) reset their inlet tempera￾ture controller set points to establish each reactor’s temperature profile. This control strategy is
presented in Figure 14.31. The reactor outlet temperature targets, TC732 SP and TC720 SP, like
R-725A’s TC730 SP, are specified offline, are periodically increased over the catalyst run, and func￾tionality to ramp the new temperature set point values to their final value is usually included.
10 See Equation (10.10), in Section 10.4.6.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.4 Conventional Reactor Advanced Control Applications 605
SP
SP
TIV731 TC731
Validation SP
TI
732
Desired
R-725B outlet
temperature
TC732
SP
R-725B outlet
temperature TIV732
TI
720
Desired
R-725C outlet
temperature
TC720
SP
R-725C outlet
temperature TIV720
SP
TC734 TIV734
Validation
FC
751
FC
752
Quench
gas 
TI
731
R-725B inlet
temperature R-725B
feed
FV751 R-725C inlet
temperature
TI
734 R-725C 
feed
FV752
Figure 14.31 R-725 B/C Inlet and Outlet Temperature/Conversion Controls
Remember TC730 resident custom code/logic monitors the wind-up status of FC751 and/or
the quench flow valve position’s (FV751) approach to full open and prevents TC730 SP increases
when either is limited high. Likewise, TC732 resident custom code/logic monitors the wind-up
status of FC752 and/or the quench flow valve position’s (FV752) approach to full open and
prevents a TC732 SP increase when either is limited high.
Design Notes and Features
1) Both control strategies in Figure 14.31 are simple cascades, and with the exception of key fea￾tures associated with the four temperature validity checks (discussed below), cascade initializa￾tion and wind-up are handled by standard DCS features.
2) Both TC732 and TC720 are configured as PID controllers, with control direction =Reverse, and
SP Init = No. Because SP Init = No, additional logic is provided to slowly ramp the initialized
set points, TC732 SP and TC720 SP, back to their last (guideline) SP values. As primary con￾trollers whose set points are changed infrequently, both are tuned for best load response, with
proportional on PV.
3) All temperature measurements, TI732 PV, TI731 PV, TI720 PV, and TI734 PV, are multiplexed,
low-level inputs and require input validation (in TIV732 through TIV734). When any tempera￾ture measurement is declared invalid, user-provided code/logic must disable that temperature
controller’s control actions (e.g., PV Status “Bad”). When TC731 or TC734 control actions are
disabled, not only its control actions but as secondaries, it also forces its primary, TC732 or
TC720, into initialization, and the entire cascade is disabled. User provided code/logic must
force each temperature controller to initialize when its temperature measurement returns
valid. Standard DCS features initialize primaries TC732 and TC720 when its secondary’s
measurement, TI731 PV or TI734 PV, returns valid and the secondary is initialized.
4) FC751 and FC752 are configured as PIDs, with proportional on error, control direction =Reverse,
SP Init =Yes and tuned for best SP point response.
14.4.4 Naphtha Hydrofiner Reactor R-135 Partial Pressure Control
Figure 14.32 presents the configuration of NHF R-135’s feed preheat and reactor sections, and a
portion of its product separation section. Analogous to the reactor section configuration discussed
in Section 14.2.3 and shown in Figure 14.10, R-135 is a single fixed bed reactor, with one catalyst Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License606 14 Reactor Conversion Control
Naphtha from
CDU Ovhd
FC
173 R
1
3
5
PI
166
Naphtha
hydrofiner
(NHF)
Make gas to
middle distillate H/Fs
D-152
Naphtha H/F effluent
to naphtha DeC4
NHF effluent
separator drum
Reformer
make gas
TI
179
FI
171
To fuel gas
system
PC
176
AI
161
Make gas
H2 purity (%)
FV172 FC
172
TI
174
PI
167
TI
175
TV174
FC
187
Make gas to KHF
To fuel gas system
E-185
E-184
Figure 14.32 Treat Gas System and Naphtha Hydrofiner R-135 Configuration
bed. Its operating temperatures are moderate enough to allow its combined hydrocarbon and
TG streams to be preheated in a single feed/reactor effluent exchanger E-185. As discussed in
Section 14.2.3 and displayed in Figure 14.11, reactor R-135’s conversion control strategy would
certainly include control of its inlet temperature (TI174 PV), and most likely control of its outlet
temperature (TI175 PV). Inlet temperature TI1174 PV would be controlled (in TC174) by manipu￾lating preheat exchanger E-185’s three-way bypass valve TV174, and if included in the conversion
control strategy, R-135’s outlet temperature TI175 PV would be controlled (in TC175) by resetting
R-135’s inlet temperature controller TC174 – a simple cascade, TC175 → TC174 → TV174.
Although effective reactor temperature control (with temperature targets established offline over
the catalyst run) is essential to achieve the desired conversion objective, this section’s focus is
on the control of R-135’s H2 partial pressure. Reactor H2 partial pressure control complements
the temperature controls by helping to limit coke production. This reduces the catalyst deactiva￾tion rate and helps meet the end-of-run target date, but also allows reactor operations at some￾what higher temperatures – which on average, improves conversion. Equation (14.5), presented
in Section 14.1.5, is used to estimate H2 partial pressure – as a function of reactor pressure, the
treat gas/feed ratio, and make gas H2 purity, and the control strategy presented in Figure 14.3 (in
Section 14.1.5) is used to control H2 partial pressure.
In Figure 14.32, reformer make-up gas (with high H2 content) provides TG to NHF R-135, as
well as middle distillate hydrofiners and the kerosene hydrofiner (KHF). TG flows to the middle
distillate hydrofiners are set by downstream operations, and the kerosene hydrofiner’s TG flow is set
by FC187. TG flow routed to R-135 is determined by adjustments to make gas flow FC172. But note
that FC172’s control adjustments to FV172 may affect the make gas flow lost to the fuel gas system,
via adjustments made by PC176 and FC187. The major operating objectives are to: (i) minimize
R-135 TG to only the amount needed to meet an H2 partial pressure target (to reduce the catalyst
deactivation rate) and (ii) avoid dumping make gas to the fuel gas system.
The strategy to control reactor R-135 H2 partial pressure is presented in Figure 14.33. H2 partial
pressure (PC172 PV) is calculated as a function of reactor pressure (PI166 PV, PI167 PV), make
gas H2 purity (validated AI161 PV) and the treat gas/feed ratio (RC172 PV) using Equation (14.5). Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.4 Conventional Reactor Advanced Control Applications 607
Make gas
to NHF
NHF HC feed 
FC
173
Make gas to
middle distillate
hydrofiners
T, MW comp
TG Calc, Ctl
FI
172
Make gas
to KHF
FC
187
TI
179 FV172
Make gas
H2 purity (%)
Reformer
make gas To fuel gas
system
PC
176
AI
161
To Fuel Gas System
FI
171
PI
167
NHF outlet
pressure
RC172
SP
PC172
NHF H2
partial pressure
control
Desired NHF
partial pressure 
SP
PI
166
NHF inlet
pressure
Validation
TI
179 TIV179
Make gas
temperature
AI
161
Make gas
H2 purity (%)
AIV161
Validation
FC172C
TG/feed
ratio control
NHF HC feed
SP
TG/HC feed
ratio
Figure 14.33 Naphtha Hydrofiner R-135 Partial Pressure Control
PC172 PV is controlled at its desired target by manipulating the treat gas/feed ratio target (RC172
SP). RC172 then resets the temperature (via validated TI179 PV) and molecular weight (via vali￾dated AI161 PV) compensated TG flow rate’s set point (FC172C SP). Compensated TG flow usage
provides a more accurate estimate of the H2 routed to R-135, and thus helps improve the H2 partial
pressure estimate and helps meet the specified reactor H2 partial pressure operating objective.
Remember: Flow compensation used in closed-loop control requires additional control compo￾nents – see Design Notes and Features #3.
In Figure 14.33, the H2 partial pressure controller PC172 calculates the treat gas/feed ratio target
RC172 SP that meets the specified H2 partial pressure (PC172 SP) target, at the current values of
(validated) TG H2 purity (AIV161 PV) and reactor pressure (PI166 PV, PI167 PV). Note that the
reactor’s average pressure, [PI166 PV+PI167 PV]/2, is typically used in PC172’s PV calculation,
although either pressure by itself is an acceptable option. Although PC172 SP may be changed
occasionally over the catalyst run, PC172’s primary role in the control strategy is to adjust the treat
gas/feed ratio (RC172 SP) and hence the compensated TG flow (FC172C SP), in response to H2
purity upsets and/or reactor pressure changes.
Design Notes and Features
1) The control strategy is a simple cascade and control initialization and wind-up status (special
exceptions are noted below) are managed by standard DCS features.
2) Compensated TG flow controller FC172C is tuned for best SP response, proportional on error and
configured for SP Init =Yes and control direction = Direct.
3) Standard validity checks are required for the TG temperature (in TIV179) and H2 purity
(in AIV161) measurements. FC172C resident, user-provided logic/code must manage the Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License608 14 Reactor Conversion Control
calculation of FC172C PV when either input is unavailable or is declared invalid, and manage
the initialization of FC172C when either input’s status returns to valid after being invalid or
unavailable (discussed in Section 8.9, and illustrated in Figure 8.7). RC172, and then PC172 are
initialized via standard DCS features after FC172C is initialized.
4) RC172, the treat gas/feed ratio, is not a PID, and thus it requires no tuning. It is a cascade sec￾ondary and thus it is configured for SP Init =Yes. The hydrocarbon feed flow measurement
(FC173 PV) is RC172’s wild flow input; thus, when FC173 PV becomes unavailable, standard
DCS features will stop RC172 control calculations, which then makes PC172 output indispos￾able. When FC173 PV returns available once again, standard DCS features will initialize RC172,
and then PC172, recommissioning H2 partial pressure control.
5) If FC173 SP is used as RC172’s wild flow input (to minimize feed measurement noise prop￾agation to the TG flow), FC173 must be configured for SP Init =Yes. If FC173 is an ultimate
secondary in another control cascade, it is already configured for SP Init =Yes. Additional user
provided code/logic is provided to slowly ramp the initialized FC173 SP back to the last (guide￾line) SP value, and to switch the wild flow input from FC173 SP to FC173 PV when FC173
becomes wound-up and is not in Manual mode.
6) If PC172 is configured as a PI or PID, then it should be configured for proportional on PV,
with control direction =Reverse. Because its set point will be changed infrequently, it should
be tuned for best load response. As a PI or PID controller, with an arithmetic PV algorithm
(Equation (14.5)), PC172 should respond dynamically much like a flow controller.
7) PC172 can also be configured with an arithmetic control algorithm. The algorithm, whose ana￾lytical form is given by Equation (14.6), calculates the treat gas/feed ratio controller’s set point,
RC172 SP, directly:
RC172 SP = PC172 SP ∗ S2
S1 ∗ AIV161 PV ∗ (Ave P − PC172 SP) (14.24)
In Equation (14.24), Ave P is the reactor’s average pressure – [PI166 PV+PI167 PV]/2, and S1
and S2 are scale factors that put FC172C (TG) and FC173 (HC feed) on a consistent volumetric
basis. PC172 PV is calculated for display only, using Equation (14.5), since it does not impact
PC172’s control calculation in Equation (14.24) – only the partial pressure target (PC172 SP),
reactor pressure (Ave P) and make gas H2 purity (AIV161 PV) impact the control calculation.
8) Whether PC172 is a PI controller or has an arithmetic control algo, as a primary whose set point
is an offline specified value, the usual options re/SP Init are available: (i) choose SP Init =Yes
to avoid a bump to RC172 SP after PC172 initializes but also provide logic/code to ramp its set
point back to its last offline specified value – normally the preferred option, or (ii) choose SP
Init = No and accept a bump in RC172 SP after an initialization pass.
14.4.5 Gas Oil Hydrofiner (R-305) Product Stripper Tower (T-307) Bottoms Quality
Control, Inlet Temperature Maximization
Gas Oil Hydrofiner R-305’s product separation section’s process configuration is presented in
Figure 14.34. R-305’s operating objective is the production of a low-sulfur fuel oil product. R-305’s
effluent, after cooling in E-310, is routed to the cold separator drum (D-305), where the vapor that
disengages is removed and sent to the sour fuel gas system. The low sulfur fuel oil product leaving
D-305 is preheated in E-312 by product stripper (T-307) bottoms and enters T-307 as feed. In T-307,
vapor boil-up flows upwards; the overhead vapor that condenses in E-314 accumulates in reflux
drum D-315. Level control (LC362) returns the liquid that accumulates in D-315 to T-307 as reflux
(FI362 PV), which flows downward countercurrent to the rising vapor. As the vapor and liquid
phases flow countercurrent to each other in T-307, light gases and the residual H2S are stripped Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.4 Conventional Reactor Advanced Control Applications 609
R
3
0
5
T
3
0
7
LC
372
FI
362
LC
362
To sour
FG system
To sour
FG system
Gas oil
H/F
Product stripper
tower
Cold
separator
drum
Reactor
feed
AI
397
TI
372
FV375 Hot
oil
TI
370
FC
375
PC
360
TC
370
Sulfur
content
FC
372
Low sulfur
product TV370
E-310
D-305 E-312
D-315
E-314
E-368
Figure 14.34 Gas Oil Hydrofiner R-305 and Product Stripper Tower T-307 Configuration
out of the liquid, into the rising vapor phase, and become a part of T-307’s overhead vapor routed
to condenser E-314. The stripped light gases and H2S in the overhead vapor are not condensed
in E-314, and the uncondensed vapor entering D-315 is removed as a vapor product and sent to
the sour fuel gas system. The liquid flowing downwards in T-307 accumulates at T-307’s bottoms
hold-up, and the low sulfur product is removed as T-307’s bottoms product.
T-307’s most important operating objective is to meet a low sulfur specification (maximum allow￾able sulfur content – AI397 PV) for the fuel oil product leaving at T-307’s bottoms. A second oper￾ating objective is to maximize T-307’s feed inlet temperature (TC370 PV) – this increases heat
recovery to T-307 feed in E-312 (T-307 feed/bottoms exchanger) and reduces reboiler E-368’s heat
duty required to satisfy the low sulfur fuel oil’s sulfur specification. However, as TC370 PV is
increased, the resulting E-368 heat duty decrease can drive FV375’s hot oil feed flow to E368 to
a minimum, and/or FV375’s hot oil bypass flow to a maximum – FV375 cannot reduce E-368 duty
further. Therefore, the second operating objective, to maximize heat recovery to feed in E-312,
is limited by a low E-368 reboiler heat duty limitation and/or a three-way bypass valve FV375
constraint.
The following control strategies will help achieve these T-307’s operating objectives:
- Control T-307’s bottoms sulfur content – this is R-305/T-307 most important operating objective.
- Enable increases in T-307 inlet temperature to maximize heat recovery to feed in T-307’s
feed/bottoms exchanger E-312 to reduce reboiler (E-368) duty, while maintaining E-368’s bypass
valve FV375 in controlling range.
The control strategies that are presented and discussed below achieve these operating objectives.
In Figure 14.35, fuel oil sulfur content is maintained at its desired target by manipulating reboiler
E-368 heat duty. In Figure 14.36, increases in T-307’s inlet temperature (TC370 SP) are limited by
the requirement to maintain E-368’s bypass valve FV375 in controlling range.
Product Stripper T-307 Bottoms Sulfur Control
Referring to Figure 14.34, the fuel oil product’s sulfur content is measured online (AI397). Assum￾ing the measurement’s availability and reliability are acceptable, closed-loop control of the fuel
oil’s sulfur content is possible. The stripping of light gases and residual H2S is favored by higher Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License610 14 Reactor Conversion Control
TI
370
TI
372
AIV397
TIV370
TIV372
FCG372
AC397
QC375
RC375
Dynamic
compensation
Validation
Validation
Desired
Btms sulfur
SP
SP
SP
E-368 duty/
feed control
E-368
duty control
Btms sulfur
control
AI
397
FC
372
E-368 hot
oil out
E-368 hot
oil in
T-307
feed rate
T-307
Btms sulfur 
FC
375
Hot oil
To E-368
Hot oil
From E-368
SP
Hot oil flow
to E-368
FV375
Vapor return
To T-307
T-307
Btms TI
372
TI
370
E-368
T-307 reboiler
Figure 14.35 Gas Oil Hydrofiner Effluent Product Stripper (T-307) Bottoms Sulfur Control
vapor boil-up, e.g., reboiler E-368 duty. Hot oil flow, and thus reboiler E-368 heat duty, is an available
degrees of freedom to enable stripping gas flow and tower temperatures to be adjusted. As shown in
Figure 14.35, after validation in AIV397, T-307 bottoms sulfur content is maintained at its desired
target by manipulating E-368’s hot oil flow (FC375):
Two feedforward control corrections are included in this control strategy – for feed rate (FC372),
which is ratioed to E-368 heat duty in RC375, and E-368 hot oil inlet (TI370 PV) and outlet (TI372
PV) temperatures, after validation in TIV370 and TIV372, respectively, via heat duty controller
QC375.
Design Notes and Features
1) The control strategy is a simple cascade and control initialization and wind-up status (special
exceptions are noted below) are managed by standard DCS features.
2) Hot oil flow controller FC375 is configured as a PID, tuned for best SP response, with pro￾portional on error and SP Init =Yes. Three-way valve FV375 in exchanger bypass service will
almost certainly fail with the feed branch closed (% open = 0%) and the bypass branch open
(% open = 100%) when FC375 OP = 0%. Thus, FC375 OP’s ideal output characteristic is identical
to TC267 OP’s characteristic in Figure 10.6 in Section 10.2.1. Remember that controller outputs
such as FC375 OP are generated as % open. Referring first to the flow measurement’s location
in Figure 14.34, and then to FC375 OP’s ideal output characteristic (equivalent to TC267 OP
in Figure 10.6), if FC375 PV is increasing or is above its set point, FC375 OP must decrease – to Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License14.4 Conventional Reactor Advanced Control Applications 611
FC
375
Hot
Oil
VFV375
HSS 
SP
SP
FV375
From
drum D-305
TI
370
TV370 T-307
Btms
Feed to
T-307
Desired T-307
inlet temperature
SP
From T-307 btms
sulfur control
Vapor return
To T-307
T-307 btms
To reboiler E-368
TC370
T-307 inlet
temperature
FV375
(Min) FV375
valve position
Low sulfur
product
FV375 feed
branch
FV375 bypass
branch
E-312
E-368
Figure 14.36 Product Stripper T-307 Inlet Temperature Maximization and Control
open the bypass branch and close the feed branch in order to decrease FC375 PV. Hence FC375’s
control direction =Reverse.
3) E-368 duty controller QC375 can either be a PID or it can be configured with an algebraic control
algorithm that directly calculates reboiler E-368’s hot oil flow. Both hot oil inlet (in TIV370) and
outlet (in TIV372) temperatures are validated before they are used in control. If QC375 is a PID
controller, the validated temperatures are used to calculate QC375 PV – the PID algorithm’s
PV input. If QC375’s control algorithm is algebraic, Equation (3.14) in Section 3.7.1 is used to
directly calculate hot oil flow, FC375 SP:
FC375 SP = QC375 SP∕
[
Scale∗ CP
∗ (TIV372 PV – TIV370 PV)
]
4) Since QC375 provides feedforward adjustments for hot oil inlet/outlet temperatures, the last
“Good” value of inlet or outlet temperature is used when that measurement is declared invalid
or becomes unavailable. The management of invalid temperatures in reboiler duty control is
discussed in Section 8.8, and displayed in Figure 8.5.
5) QC375 is a cascade secondary – if it is configured as a PID controller, it is tuned for best SP
response, proportional on error, with control direction =Reverse. Whether QC375 is a PID, or
has an algebraic control calculation, SP Init =Yes.
6) Since feed rate FC372 is a cascade secondary, it is already configured for SP Init =Yes. Thus,
FC372 SP is the recommended feed flow input source for dynamic compensation tag FCG372.
Providing custom logic/code to use FC372 PV instead of FC372 SP when FC372 is wound-up
and is not in Manual mode is an option.
7) Feed rate feedforward On/Off is discussed in Section 3.4. FCG372 resident user-provided
code/logic manages an unavailable FC372 PV measurement and its return to available,
RC375’s initialization when feed rate feedforward is commissioned or an unavailable FC372 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License612 14 Reactor Conversion Control
PV returns available and ensures the feedback loop is not adversely affected when FC372 PV
becomes unavailable.
8) RC375 is not a PID and requires no tuning – its control algorithm is algebraic:
QC375 SP = RC375 SP ∗ FCG375 LastGoodValue
where FCG375 LastGoodValue is FCG375’s internal storage location for the dynamically com￾pensated feed rate input – its control algorithm’s calculation result. As a cascade secondary,
RC375 is configured with SP Init = Yes.
9) AC397 is a PID controller, tuned for best load response with proportional on PV, configured with
control direction = Direct, and because AC397 SP is an offline specified guideline, SP Init = No.
However, if SP Init = No, FC375 SP will be bumped after AC397’s initializes. If SP Init =Yes,
initialization will be bumpless, but additional code/logic is typically provided to slowly ramp
the initialized AC397 SP back to the last (PTS guideline) SP value.
Product Stripper T-307 Inlet Temperature Maximization and Control
Increasing T-307 inlet temperature (TC370 PV) increases heat recovery to T-307’s feed in T-307
feed/bottoms exchanger E-312 and reduces the reboiler (E-368) heat duty (QC375 PV) required to
meet the desired sulfur target (AC397 SP). Therefore, there are potential energy and hot oil utiliza￾tion savings to increase TC370 PV, and ideally to maximize it.
The relationship between TC370 PV and reboiler E-368’s heat duty is central to the design of a
control strategy to maximize TC370 PV. As shown in Figure 14.34, TC370 PV is controlled by adjust￾ments to E-312’s bypass valve, TV370. In response to a TC370 SP increase, TC370 closes TV370 to
increase E-312’s heat duty. Increasing T-307’s inlet temperature increases T-307’s heat input and
tends to increase all T-307 temperatures – this tends to improve stripping efficiency, and reduce
T-307’s bottoms’ sulfur content (AI397 PV). With sulfur content below target, reboiler duty can be
reduced. This is done in closed-loop via the control strategy in Figure 14.35. Without closed-loop
sulfur content control, operators must monitor sulfur content and reduce E-368 duty manually in
order to capture these savings.
If increases in TC370 SP continue, E-368’s heat duty continues to decrease, and FV375 can
become limited low, e.g., minimum flow to E-368 and max bypass flow. With E-368’s duty
limited low, QC375, RC375, and AC397 all become wound-up low, and sulfur content control is
interrupted; T-307 inlet temperature is too high, and TC370 SP must be lowered to allow E-368’s
heat duty to increase and relieve the FV375 and QC375 constraints.
Note: It is AC397’s feedback control adjustments that reduce E-368’s duty as TC370 SP is increased.
Thus, incentives to increase heat recovery to feed in E-312 are achievable without operator action
only if T-307’s bottoms sulfur control strategy in Figure 14.35 is commissioned and performing
satisfactorily.
TC370 set points are specified offline and entered periodically over the catalyst run by operators.
However, the override control strategy in Figure 14.36 allows TC370 SP increases only until FV375
approaches and/or reaches its minimum desired value (VFV375 SP). At that time, FV375’s valve
position controller, VFV375, overrides TC370 and prevents FV375 from violating its minimum con￾straint, VFV375 SP. A display indication that the override has been activated would serve as notice
to operators to decrease TC370 SP.
When FV375 is far away from its minimum value, VFV375 SP, VFV375 will want to increase
TC370, e.g., close TV370 and when FV375 is approaching or violating its minimum value, VFV375
will want to decrease TC370, e.g., open TV370. Thus, the override strategy’s signal selector is a high
signal selector (HSS).
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons LicenseReferences 613
When E-368’s bypass valve position (FV375) is at its minimum value, reboiler E-368’s heat duty
(QC375 PV) has also reached a minimum value. However, the actual value of heat duty, QC375
PV, that corresponds to a bypass valve position limited low, for example, at 10%, will depend upon
operating conditions. On the other hand, a bypass valve position limited low at 10% is unambigu￾ously meaningful, independent of current operations. This is why FV375 is the override controller’s
PV, and QC375 PV is not – an FV375 low limit (e.g., 10%) always has the same physical meaning,
but whether or not the heat duty minimum is a good choice depends upon the current operation.
Note: VFV375 SP, the desired minimum FV375 valve position, is chosen to be above the real, oper￾ational minimum, i.e., less constraining. In addition to the safety and operational issues, this allows
VFV375 to calculate control adjustments even if FV375 is at its minimum value and ensures the
FV375’s approach to set point is not one-sided – only from above its set point.
Design Notes and Features
1) The dynamic response of the sulfur content control strategy in Figure 14.35 to changes in TC370
SP determines the dynamic response of FV375 to changes in TC370 SP. Therefore, the T-307 bot￾toms sulfur control strategy, tuned and in routine operation, will provide the dynamic response
data needed to tune VFV375.
2) VFV375 is a PID controller. Because VFV375 SP is changed only occasionally, VFV375 is tuned
for best load response, proportional on PV, with SP Init = No.
Note: The dynamic response of FV375 to changes in TC370 SP will be very slow and contain
troublesome amounts of deadtime – due to the slow response of T-307 to TC370 SP changes,
specifically the slow response of the bottoms sulfur control strategy. Therefore, tuning VFV375
may be problematic. However, VFV375 provides only override control, and therefore, even if
achieving acceptable control performance is difficult, its expected low time on control limits
the negative consequences.
3) If VFV375 PV is increasing or is above VFV375 SP, VFV375 control adjustments should increase
TC370 PV. Thus, it must close TV370, and it is configured with control direction =Reverse.
4) TC370 is a PID controller, tuned for best SP response, proportional on error and is configured
with SP Init =Yes. If TC370 PV is increasing or is above TC370 SP, TC370 control adjustments
must open TV370 and thus TC370 is configured with control direction = Direct.
References
1 Malloy, J.B. and Seelig, H.S. (1955). Equivalent isothermal temperatures for non-isothermal
reactors. AIChE Journal 1 (4): 528–530.
2 Jones, D.S.J. and Pujado, P.R. (ed.) (2006). Handbook of Petroleum Processing, 230. Dordrecht:
Springer 312–313, 347–348.
3 Gonzalez, R. (2015). Identifying Hydrotreating Process Variables, RefineryOperations.com.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License615
Index
a
Activation energy 557
Active constraint variable 212, 215–217,
223–226, 231–233
Advanced control applications 29, 37–41
Advanced regulatory control 29, 31–33, 155
A/I analog input 5
Air preheater 359–360
Alarm system 30, 54, 260–261
Amine gas treating units 391–397
Analog/Digital (A/D) signal converter 10
Analyzer measurement validation 1, 4–5, 85,
110, 145, 153, 176, 202, 211, 234, 244,
252–257
Anti-reset wind-up 118
A/O analog output block 53, 65–66, 182–183,
240, 266, 274, 298–299
Apparent deadtime 20–22
Application schematics 55, 56, 245
Arrhenius equation 557
Automated PID tuning 91
Auto mode 56, 77–78, 81–82, 131–133, 139–141,
242, 254, 256–257, 259, 276, 279, 281–282,
285, 366, 368, 369
Averaging level control 286
b
Basic regulatory control 29–31, 155
Benzene/toluene/xylene (BTX) plant
feed fractionation section 479–483
product fractionation section 483–485,
493–495
Bias filtering 108–109
Bias updating 105, 109
Bottoms product quality control 417–418,
430–431
MV, reboiler duty 444
MV, reflux flow 447
override to maintain internal reflux 460–463
use of steam stripping 503–504
BTU control 327
with feed rate, CIT FF control 336–337
fuel gas heating value’s role 334–336
Bumpless transfer 46, 76–83, 259, 260
Business drivers 156
c
Cascade control 76–82, 92–93, 259–260
Cascade mode 56, 77–78, 81–82, 259, 276, 279,
285
Cascades, simple and complex 46–50
Cascade wind-up 112–118, 259–260
Catalyst
activity and deactivation 558
poisoning 558
run-length 558–560
Catalytic reformer
effluent heat utilization 352–354
recycle gas minimization 402–404
C8/C9 splitter control 479–482
Clamping
output 55, 114, 241
set point 55, 114, 241
Clausius–Clapeyron equation 151–152
Coil inlet temperature (CIT) 324
feedforward compensation for 331–334,
336–337
Coil outlet temperature (COT) 324
Combustion control
air side measurements 359–361
control objectives 357–359
for forced draft heaters 363–367
Practical Process Control Design with Industrial Applications, First Edition. Alan M. Kugelman.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License616 Index
Combustion control (contd.)
linked with firing controls 367–369
for natural draft heaters 361–363
Compensated flows 258–259
Complex cascades 47–49
Condenser duty 414–417
Constraint control 48, 210
active constraint variable switches 231–233
cascade structure 226–228
design issues 233–235
relationship to override control 205–207
Constraints 3–4
heat recovery in heat integrated units
162–164
MV max overshoot 83–84
setpoint and output clamps 53–55, 114, 241
Control application benefits 41–43
Control direction 45, 63–65, 180, 239–240
Control frequency 246
Control hierarchy 28–30
Control initialization 46, 76–82
Control interactions 505, 521
among potential MVs-CVs 157
impact on design 159, 164, 168–173, 418–419
impact on control performance 376, 399–400
with other control strategies 261–263
in primary and main fractionators 500, 505,
508, 516–521, 528–529, 538–540
Controller modes 12, 76–82
Control loop 8–12
Control variable (CV)
in crude distillation units 515–520
in feedback control loop 8–9
in fired heaters 325–326, 359–361
override control 195–198
overshoot 83–84, 90, 91, 111, 118
in reactor systems 582
in towers with sidestream 428–429
in two-product towers 371, 413–417
Conventional advanced control applications
in crude distillation units 532–540
overview 34–37
in reactor systems 584–613
in towers with sidestream, examples 485–495
in towers with sidestream, overview 453–463
in two-product towers, examples 463–485
in two-product towers, overview 443–453
Conventional ENCON controls 529
heat recovery maximization 340–357,
530–531
overflash minimization 531
pressure minimization 381–383, 531–532
reduce reboiler duty and/or reflux flow
370–372
reduce stack excess O2 357–370
reduce stripping steam utilization 383–395,
529–530
reduce treat gas and/or recycle gas flow 397
Corporate standards 244–245
COT controls
basic 327–329
with BTU control 334–337
with CIT feedforward control 331–334
with dual fuel firing 337–338
with feed rate feedforward control 329–331
Cox Chart 152
Crude distillation unit (CDU) 515
control interactions 521
conventional advanced control applications,
examples 532–540
conventional advanced product quality control,
overview 520–522, 526–529
conventional ENCON controls 529–532
CV–MV pairings, interactions 516–520
heat recovery maximization 340
heat utilization 293–295
steam stripping, bottoms product 383–386
steam stripping, sidestream 386–388
unit characteristics 499–505, 515–516
Cutpoint 371
effect on fractionator product flows 507–512
effect on tower product flows 435–438
illustrated, feed TBP distillation curve
435–436, 438, 506–507
d
Deadtime 16
apparent 20–22
true 20, 22
Derivative control action 58, 63, 69–71, 95
Design synthesis method 88–89
Detailed operations schematics 56
Digital/Analog (D/A) signal converter 10
Digital control system (DCS) 45
alarms 54
control processing 52–53
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons LicenseIndex 617
data base organization 50
history, reports, and trends 56–57
output and set point clamps 55
output processing 53–54
PV processing 51–52
schematics 55–56
standard features 78–80, 99, 112, 115, 217,
227, 234, 243–244, 260
Disturbance variable (DV) 8, 121
in crude distillation units 516–519
in feedback control loop 8–9
process response curve 15–17
in reactor systems 583
in towers with sidestream 428–429
in two-product towers 413–417
Draft pressure 324, 358, 359
Drawing conventions 6–7
DTI, externally multiplexed digital temperature
input 10
DTI measurement validation 32, 144, 148–149,
151, 167, 220, 229, 234, 244, 252–257
Dual fuel fired heaters 337–338
Dual-product quality control 420–422
Duty, calculation, and control
fired heater 334–338, 367–370
reboiler 142–145, 166–168, 228–231, 315–323
Dynamic compensation 100–101, 121
lead-lag algorithm 126–130
tag 124, 127, 131
Dynamic decoupler 521–526
Dynamic feedforward control
full-valued, ratio control 130–133
incremental 137–141
Dynamic matrix control (DMC) 38, 156, 165,
177, 209–210, 345, 376, 381–383, 412, 418,
422, 431, 498–499, 515, 526, 529, 531–532,
540–541, 548, 552–553, 580, 584
e
Endothermic reaction 556
Energy balance
closure, in distillation tower 411, 419–422,
430–431, 439–440
closure, in fractionator 512–513
upsets 146–147
Energy conservation (ENCON) credits 124, 172,
340, 352, 357–358, 381–383
Energy utilization 259, 339–340, 529, 561–563
Energy yield tradeoff 41, 372, 383, 385–386, 418,
498–499
Equivalent isothermal temperature (EIT) 170,
262, 572, 581–582, 595–597
Error 8
derivative action on 63, 241
PID control calculation basis 57–61
proportional action on 71–74, 240
Exothermic reaction 556
f
Feedback control loop 8–10
Feed drum inventory control 279–283
Feedforward control
dynamic compensation 100–101, 121,
126–130
incremental, dynamic 137–141
incremental, steady state 133–137
internal reflux flow 142, 145–149
pressure-compensated tower temperature
142, 149–154
ratio control, full-valued, dynamic 130–133
ratio control, full-valued, steady state 124–126
reboiler duty 142–145
role of 120–124
with feedback 9
Feedforward deadtime 129, 524
Feedforward gain 129, 133, 524
Feed mix control 283–286, 556, 563–565
Feed surge drum 288–289, 295–300
Feed TBP distillation curve 435–436, 438,
506–507
Fenske equation 440
FF corrections, fuel gas heating value changes
334–337
Filtered prediction error 105, 251
Filtering 93–94
bias 108–109
CV PV 95–96
linear exponential filter 24–25, 96–97, 242
noise and 95–96, 242
signal distortion and 94–96
Final boiling point (FBP) 436
Firebox pressure 359, 363
Fired heaters
air side measurements 359–361
basic COT control 327–329
combustion control 361–370
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License618 Index
Fired heaters (contd.)
cross-linked firing and combustion control
370
dual fuel COT control 337–338
feedforward control components 329, 331,
334, 336, 364, 367
firing control, heat fired 326–327, 334, 337
firing control, heat required 326–327
flooding 358, 360, 362, 363, 366, 368, 369
fuel side measurements and calculations
325–327
linked firing and combustion control 367–369
First-order linear model
discrete 23–25
time domain 17–22
Flooded condenser 425–427
Flow compensation 258–259
Forced draft heater combustion control 363–370
Fouling 558
Fractionation 371–372, 439–443, 512–515
Fractionation management, examples
benzene tower 479–483, 493–495
C8/C9 splitter 479–483
Naphtha splitter 372–376, 485–489
toluene tower 377–381
Fractionation management, overviews
MV, reboiler duty 450–451, 458–459
MV, reflux flow 445–447, 457
MV, sidestream flow 456–457
with product quality control override
460–463
Fractionator unit characteristics 499
g
Gas oil hydrofiner 397–402, 541–543,
608–609
Guard reactor 575
h
Heat integrated units, control strategies in
311–323
Heat integration 162–165, 262–263, 293–295,
370, 503, 574
Heat of reaction 556, 557
Heat recovery maximization 218–225, 340–357
High signal selector (HSS) 217, 225
Hold-up 17–19, 35, 286
H2 partial pressure 560–563, 591, 605–608
i
Incremental feedforward control
dynamic 137–141
steady-state 133–137
Inferential model bias update
via analyzer measurement 249–250
via lab data 250–252
Inferential variables 247–252
Initial boiling point (IBP) 436
Input validation 252–257
Integral control action 58, 63, 67–70, 79–80, 118,
239
Interactions among control strategies 168–174,
261–263, 418–419, 505, 519–521, 528–529,
538–540, 583–584
Internal model control (IMC) 89
Internal reflux (IR) control 142, 145–149,
344–349, 377–381, 414, 421, 433–435,
445–449, 474–479
Inventory control
hold-up drum 266–268
reflux drum, with low level override 535–538
stripper bottoms level, with low level override
199–200
towers with one sidestream 270–273
two-product towers 268–270
Inverse response 21
j
Jump test 252
k
Key components 419, 431, 497
l
Lag time constant 129, 131, 149, 346, 524, 525,
529
Lambda tuning 88, 89, 91
Lead-lag algorithm 23, 121
analytical form, s-domain transfer function
128
derivation 127–128
dynamic compensation tag’s role 124, 127,
130–132
input parameters 129
time domain response characteristics 123,
129–130
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons LicenseIndex 619
Lead time constant 129, 131, 149, 346, 524, 525,
529
Level control
averaging 286
control direction 266–267
fractionators 289, 290, 503–504, 535–538
light-ends towers 268–273, 287–288
non-self-regulating loop 13–14
single loop 266–268
tight 286
Limit checking and clamping 55
Limiting constraint 216, 217, 224–226, 232
Linear exponential filter 96–97, 242
Low signal selector (LSS) 217, 226
m
Manipulated variable (MV) 7–8
in crude distillation units 515–520
in feedback control loop 8–9
overshoot 83–84, 86, 89, 90
process response curve 15–17
in reactor systems 583
in towers with sidestream 428–429
in two-product tower 371, 413–417
Manual mode 56, 77–78, 131–133, 139–141, 242,
254, 256–257, 259, 276, 279, 281–282, 366,
368, 369
Mass transfer, in porous catalyst particle
557–558
Material balance
closure, in fractionators 512–513
closure, in towers 411, 419–422, 430–431,
439–446
Model-based PID tuning methods 88
design synthesis 88
internal model control 89, 91
lambda tuning 89, 91
offline optimal tuning parameter 89, 91
Model identification 26–28
Multivariable constraint control 37–38, 209
n
Naphtha splitter controls
configuration, operating objectives 320,
373–374, 465, 472–473, 486
conventional advanced controls 472–474,
485–488
fractionation management 372–376
Natural draft heater combustion control
210–212, 361–363
Noise 45, 93–94
in feedforward control 124–125, 131, 133, 144,
150, 154
filtering 95–97, 242
linear exponential filter 96–97
ratio control and 101–102
signal-to-noise ratio 94–95
o
Open-loop stable control loop 12–13
Open-loop unstable control loop 13–14
Operating plan 155–158
Operations schematics 55, 56
Output clamps 55, 114, 171–172, 241, 348, 351,
352, 354, 357, 363, 366, 394, 445, 545, 546,
588, 596
Output direction 45, 65–67, 240
Overflash, overflash minimization 384, 385,
519, 529, 531, 532
Overhead product quality control 417–419,
430–431
MV, distillate flow 451–453
MV, reflux flow 449
override to maintain fractionation 460
Overlap 440–443, 513–514
Override control 48, 195–205, 459–463, 532–538
Overview operations schematics 56
p
Partial condenser 423–425
Partial pressure
calculation 560
control 560–563, 605–608
PID control algorithm 45–46, 57–59, 238–239
choosing derivative (D) option 63, 241
choosing the proportional (P) option 71–76,
240
continuous (full-valued) version 58–59
control direction 45, 63–66, 239–240
control valve failure mode 65–67
derivative action on error, on PV 63, 241
discrete version, full-valued 59–61
discrete version, incremental 61
EU, % of range transformations 61–62
interacting version 59
initialization 78–80
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License620 Index
PID control algorithm (contd.)
output direction 45, 65–67, 239–240
P, I, D control contributions 58, 63, 67–71, 95,
239
P-only, P-I, I-only controller versions 58, 61,
63, 239
proportional action on error, on PV 71–76,
240
set point initialization 80–81, 241
PID FF control algorithm
in incremental dynamic FF control 138–141
in incremental steady-state FF control
134–137
PID tuning 82
automated 91
cascaded controllers 92–93
composition control, guidelines 84, 85
controller tuning rules, published 92
design synthesis method 88–89
flow control, guidelines 83, 84
gas pressure control, guidelines 83, 85
internal model control method 88, 89
lambda tuning 88, 89, 91
level control, guidelines 83, 85
objectives 83
in operating plants 86
parameters 59, 82
recommended practices 83–84
relay auto-tuning method 87
software tools, commercial 91
temperature control, guidelines 83–85
trial-and-error approach 86–87
Ziegler–Nichols tuning rules 87, 88
Planning, coordination 157–158
Plant testing 2, 14–15, 17, 25–28, 84, 86, 91,
93–96, 101, 105, 106, 108, 109, 121, 129,
138, 144, 151, 152, 157, 158, 163, 168, 175,
242, 249, 261, 263, 359, 363, 364, 376, 524,
529, 547, 549, 553, 577
Prediction error 105–107, 249–252
Pressure-compensated tower temperature
149–154, 166, 168, 201–202, 243, 382,
449–450, 470–471, 475–477, 521–522,
532–535
Pressure minimization 381–383, 531–532
Primary controller 12, 53–54, 74–75, 87, 92–93,
113, 117–118, 241
Process analysis, in control strategy design
158–159, 238
Process dynamics 1–2, 14–25
Process gain 15
Process response curve 14–17
Process variable (PV) 1, 2, 7, 51–52
fired heaters 325–327, 359–361
fractionators 515–519
reaction systems 582–583
towers with sidestream 427–429
two product towers 412–417
Programmable logic controllers (PLCs) 30
Proportional kick 70–73, 111
Pumparound 500–502, 515–516, 530–531,
551–553
r
Rate of reaction 555–560, 569
Ratio control 97–99
in dynamic feedforward control 130–133, 243
initialization 102–103
PV and output calculations 98
in steady-state feedforward control 124–126,
243
Reaction
endothermic 556
exothermic 556
heat of 556, 557
rate 556–558
Reactor conventional advanced control
applications 584
conversion control 587–589, 595–597
inlet temperature control 592–595
partial pressure control 605–608
treat gas/feed ratio control 586–587, 591–592,
599–605
Reactor effluent heat utilization 168–169, 295,
302–306, 352–357, 474–479, 488–493,
579–580, 590
Reactor system unit characteristics
control objectives 581–582
CVs, MVs, DVs 581–583
feed preheat section 566–569
feed preparation section 564–566
reaction section 569–579
reactor effluent cooling, product separation
section 579–581
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons LicenseIndex 621
Real-time optimization (RTO) 29, 37–38, 372,
383, 385–386, 418, 423, 447, 451, 498,
529–532
Reboiler duty control 142–145, 243, 319–323,
372–376, 414, 420, 421, 440, 444–445,
450–451, 458–459, 462–463, 467–471,
479–482
Reboiler duty management 319–323
Reflux flow 268–273, 370–372, 412–418,
422–427, 430–435, 515–516, 519–520
Regulatory control
advanced 29, 31–33, 155
basic 28–31, 155
Relative volatility 381
Relay auto-tuning method 87
Residence time 563, 586
s
Safety protection systems 28–30
Sample time 23–25, 245
Schematic displays 54–57, 245–246, 261
Secondary controller 12, 74–75, 80, 87, 92–93,
113, 117–118, 241
Separation factor 440, 442–443
Set point clamps 55, 114, 241, 296–297, 328, 351,
352, 394, 445, 546, 588, 596, 602
Set point initialization (SP Init) 45, 77–78,
80–81, 102, 241
Set point (SP)
changed by 12
clamping 55, 114, 241
in control loop 7–9
initialization 80–81, 102–103, 241
ramping 52, 81, 245
Sidestream, bottoms steam stripping 383–388,
503–504
Sidestream draw-off
MV, fractionation management 428–429,
433–435, 456–457
MV, product quality control 454–455,
461–462, 526–529
Sidestream product quality control 453–454
MV, sidestream flow 455
override to maintain fractionation
461–462
Signal distortion 93–94, 96, 97, 108, 242
Signal selector 196, 217
in constraint control 217–218, 225–226,
230–231
in override control 195–200, 202–203, 205
Signal-to-noise (S/N) ratio 26, 94–95
Simple cascade 30, 46–50, 52, 76–78, 92, 112,
114, 115, 241–244, 259–260
Single input–single output model-based control
bias filtering 108–109
bias updating 105, 109
CV PV prediction 105, 106
filtered prediction error 105
prediction error 105, 106
tuning 108
Site, company standards 244–246
Software tuning tools 91
Sour water steam stripper 388–391
Space velocity 563
Split range control
AO block configuration 182–183
applications 181
output characteristics 178–180
overview 48–50, 178–181
Standard DCS features 51, 52, 54, 78–81, 112,
114, 115, 217, 234, 237, 241–244, 246–247,
253, 259–260
Steady state 3–4, 12–15, 26, 38, 101, 155,
247–248
Steady-state feedforward control 123
incremental 133–137
with ratio control, full-valued 124–126, 243
Steady-state gain 15
Steam stripping
CDU bottoms 383–386
CDU sidestream 386–388, 538–540
main fractionator bottoms, sidestream steam
stripper bottoms 503–504, 542–544
reactor effluent 580–581
sour water 388–391
Supervisory controls 28–30, 34–37
t
Tag attributes 4, 50
Tag naming 4–5
and drawing conventions 6–7
in process overview, control strategy drawings
5
Tight level control 286
Time to steady state (TTSS) 15–17, 19, 87, 209
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License622 Index
Towers with sidestream
conventional advanced control applications,
overview 453–459
CV–MV pairings 430–431
fractionation management 455–459
fractionation management, with product
quality control override 459–463
inventory controls 270–273
key components and separation 431
process variable summary 428–429
Transfer function 22–23, 127–128
Treat gas/feed ratio
MV to control % H2 purity 397–402, 405–409
MV to control reactor partial pressure
560–563
Trial-and-error tuning 86–87
True boiling point (TBP) distillation curve
435–436, 438, 440–442, 506–507, 514
True deadtime 20–22
Tuning rules, PID controllers 87–91
Two-product tower
conventional advanced control applications,
overview 443–453, 463–464
CV–MV pairings 417–419
fractionation management, reboiler duty MV
450–451
fractionation management, reflux flow MV
445–447
inventory control 268–270
key components and separation 418–419
process variable summary 412–417
u
Ultimate primary 45–50, 65–67, 242–243
Ultimate secondary 45–50, 239–240, 242–243
v
Validation
feedback control input 252–256
feedforward control input 255–257
tests, lab data 250–251
tests, measured input 252–253
Valve failure mode 65–67
Valve position 7–8, 12, 32, 65–67, 114–115,
144–145, 148, 181–183, 354–357
Volume % off 435–439, 506–507
w
Weighted average bed temperature (WABT)
576–579, 582
Wind-up 112–118
causes 113–114
direction 115–118, 260
protection 114, 118, 260
status 114–118, 260
y
Yield maximization 541–542, 545–547
z
Ziegler–Nichols tuning rules 87, 88
 Downloaded from https://onlinelibrary.wiley.com/doi/ by ibrahim ragab - Universita Di Firenze Sistema , Wiley Online Library on [27/07/2024]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License
