Optimization for Energy 
Systems and Supply Chains
To curb the impacts of rising CO2 emissions, the Intergovernmental Panel on Climate 
Change report states that a net zero target needs to be achieved by the year 2055. Experts 
argue that this is a critical time to make important and accurate decisions. Thus, it is 
essential to have the right tools to efficiently plan and deploy future energy systems 
and supply chains. Mathematical models can provide decision-makers with the tools 
required to make well-informed decisions relating to development of energy systems 
and supply chains. This book provides an understanding of the various available energy 
systems, the basics behind mathematical models, the steps required to develop math￾ematical models, and examples/case studies where such models are applied. Divided 
into two parts, one covering basics for beginners and the other featuring contributed 
chapters offering illustrative examples, this book:
• Shows how mathematical models are applied to solve problems in energy 
systems and supply chains
• Provides fundamentals of the working principles of various energy systems 
and their technologies
• Offers basics of how to formulate and best practices for developing 
mathematical models, topics not covered in other titles
• Features a wide range of case studies
• Teaches readers to develop their own mathematical models to make 
decisions on energy systems
This book is aimed at chemical, process, mechanical, and energy engineers.Green Chemistry and Chemical 
Engineering
Series Editor
Sunggyu Lee
Ohio University, Athens, Ohio, USA
Carbon-Neutral Fuels and Energy Carriers
Nazim Z. Muradov and T. Nejat Veziroğlu
Oxide Semiconductors for Solar Energy Conversion: Titanium Dioxide
Janusz Nowotny
Water for Energy and Fuel Production
Yatish T. Shah
Managing Biogas Plants: A Practical Guide
Mario Alejandro Rosato
The Water-Food-Energy Nexus: Processes, Technologies, and Challenges
I. M. Mujtaba, R. Srinivasan, and N. O. Elbashir
Hemicelluloses and Lignin in Biorefineries
Jean-Luc Wertz, Magali Deleu, Séverine Coppée, and Aurore Richel
Materials in Biology and Medicine
Sunggyu Lee and David Henthorn
Resource Recovery to Approach Zero Municipal Waste
Mohammad J. Taherzadeh and Tobias Richards
Hydrogen Safety
Fotis Rigas and Paul Amyotte
Nuclear Hydrogen Production Handbook
Xing L. Yan and Ryutaro Hino
Water Management: Social and Technological Perspectives
Iqbal Mohammed Mujtaba, Thokozani Majozi, and Mutiu Kolade Amosa
Optimization for Energy Systems and Supply Chains: Fundamentals 
and Applications
Viknesh Andiappan, Denny K. S. Ng, and Santanu Bandyopadhyay
For more information about this series, please visit: https://www.routledge.com/
Green-Chemistry-and-Chemical-Engineering/book-series/CRCGRECHECHEOptimization for Energy 
Systems and Supply Chains
Fundamentals and Applications
Edited by
Viknesh Andiappan
Denny K. S. Ng
Santanu BandyopadhyayFirst edition published 2023
by CRC Press
6000 Broken Sound Parkway NW, Suite 300, Boca Raton, FL 33487-2742
and by CRC Press
4 Park Square, Milton Park, Abingdon, Oxon, OX14 4RN
CRC Press is an imprint of Taylor & Francis Group, LLC
© 2023 selection and editorial matter, Viknesh Andiappan, Denny K. S. Ng, and Santanu 
Bandyopadhyay; individual chapters, the contributors
Reasonable efforts have been made to publish reliable data and information, but the authors and 
publishers cannot assume responsibility for the validity of all materials or the consequences of 
their use. The authors and publishers have attempted to trace the copyright holders of all material 
reproduced in this publication and apologize to copyright holders if permission to publish in this 
form has not been obtained. If any copyright material has not been acknowledged please write and 
let us know so we may rectify in any future reprint.
Except as permitted under U.S. Copyright Law, no part of this book may be reprinted, reproduced, 
transmitted, or utilized in any form by any electronic, mechanical, or other means, now known 
or hereafter invented, including photocopying, microfilming, and recording, or in any information 
storage or retrieval system, without written permission from the publishers.
For permission to photocopy or use material electronically from this work, access www.copyright.
com or contact the Copyright Clearance Center, Inc. (CCC), 222 Rosewood Drive, Danvers, MA 
01923, 978-750-8400. For works that are not available on CCC please contact mpkbookspermissions@
tandf.co.uk
Trademark notice: Product or corporate names may be trademarks or registered trademarks and are 
used only for identification and explanation without intent to infringe.
ISBN: 978-1-032-14621-8 (hbk)
ISBN: 978-1-032-14622-5 (pbk)
ISBN: 978-1-003-24022-8 (ebk)
DOI: 10.1201/9781003240228
Typeset in Times
by codeMantrav
Contents
Series Preface ...........................................................................................................vii
Preface.......................................................................................................................ix
Foreword ...................................................................................................................xi
Acknowledgments .................................................................................................. xiii
Editors ......................................................................................................................xv
Contributors ...........................................................................................................xvii
Part a Fundamentals
Chapter 1 Energy Systems and Supply Chains .....................................................3
Viknesh Andiappan, Denny K. S. Ng, and Santanu Bandyopadhyay
Chapter 2 Optimization of Energy Systems and Supply Chains ........................ 15
Viknesh Andiappan, Denny K. S. Ng, and 
Santanu Bandyopadhyay
Chapter 3 Formulating Generalized Mathematical Models ............................... 41
Viknesh Andiappan, Denny K. S. Ng, and 
Santanu Bandyopadhyay
Part B applications
Chapter 4 Mixed-Integer Linear Programming Model for the Synthesis of 
Negative-Emission Biochar Systems .................................................. 51
Beatriz A. Belmonte, Kathleen B. Aviso, 
Michael Francis D. Benjamin, and Raymond R. Tan
Chapter 5 A Comprehensive Guidance on Transitioning Toward 
Sustainable Hydrogen Network from Localized Renewable 
Energy System: Case Study of South Korea ......................................73
Juin Yau Lim and Bing Shen How
Chapter 6 An Optimization Framework for Polygeneration System Driven 
by Glycerine Pitch and Diesel ............................................................93
Wai Mun Chan and Irene Mei Leng Chewvi Contents
Chapter 7 Multi-Objective Optimization of TEG Dehydration Process to 
Mitigate BTEX Emission under Feed Composition Uncertainty .... 111
Rajib Mukherjee and Krystal Smith
Chapter 8 Constrained Production Planning with Parametric Uncertainties ... 133
Nitin Dutt Chaturvedi and Piyush Kumar Kumawat
Chapter 9 Linear Programming Models Based on the Input-Output 
Framework ........................................................................................ 151
Raymond R. Tan, Kathleen B. Aviso, and Jui-Yuan Lee
Chapter 10 Optimisation of Oil Palm-Based Biodiesel Supply Chain: 
Upstream Stages ............................................................................... 169
Jaya Prasanth Rajakal and Yoke Kin Wan
Chapter 11 Optimal Design of Islanded Distributed Energy Systems 
Incorporating Renewable Energy for Rural Africa: A Namibian 
Case Study ........................................................................................ 181
Kemi Jegede, Ishanki De Mel, Michael Short, and 
Adeniyi J. Isafiade
Chapter 12 Multi-Objective Optimization for Energy Network Planning: 
Energy Storage and Distribution in Integrated Solar Powered 
Grids ................................................................................................. 201
Jayne San Juan, Amiel Ching, Charles Chua, Lorenzo Dyogi, 
and Charlle Sy
Index ...................................................................................................................... 221vii
Series Preface
Towards the late 20th century, the development of various environmentally friendly 
processes, techniques, and methodologies saw significant growth in the scientific 
community. The main driving forces for such growth were the rising awareness of 
sustainable development, more stringent environmental regulation, and increasing 
costs of raw materials and waste treatment. After several decades of development, we 
now broadly term these environmentally friendly processes, techniques, and meth￾odologies as green/clean technologies.
In the 21st century, the global community has experienced many extreme weather 
events such as prolonged drought, extreme heat, tornadoes, and wildfires. The sci￾entific community believes that these extreme weather events are closely linked to 
climate change, and they are expected to increase in frequency and intensity in the 
future. Following the Paris Agreement and Glasgow Climate Pact, there is now an 
international commitment to limit the rise of global temperature to well below 2°C by 
end of this century and to pursue efforts to limit temperature increase to 1.5°C above 
pre-industrial levels. Hence, it is believed that green/clean technologies will have a 
much bolder role to play in combating the global climate change in the coming years.
It is also worth mentioning that the United Nation Sustainable Development Goals 
(UNSDG) that were launched in 2015 define 17 important goals to transform the 
world by 2030. It is believed that some of these goals may be addressed with the 
development of green/clean technologies. These include:
• Goal 6: Clean Water and Sanitation: Ensure access to water and sanitation 
for all
• Goal 7: Affordable and Clean Energy: Ensure access to affordable, reliable, 
sustainable, and modern energy
• Goal 12: Responsible Consumption and Production: Ensure sustainable 
consumption and production patterns
• Goal 13: Climate Action: Take urgent action to combat climate change and 
its impacts
The Green Chemistry and Chemical Engineering book series by CRC Press/Taylor 
& Francis focuses on the subset of green technologies dedicated to address the 
“2E” agenda, i.e., environment and energy. It involves the development of materials 
(e.g., catalysts, nanomaterials), methodologies (e.g., process optimization, footprint 
reduction, artificial intelligence), and processes (e.g., waste treatment) that will bring 
forth solutions to address pressing problems such as:
• Greenhouse gas management and reduction
• Sustainable water production
• Wastewater treatment and recycling
• Circular economy and waste reduction
• Renewable energy
• Sustainable use of energy resourcesviii Series Preface
I am hopeful that this Green Chemistry and Chemical Engineering series will 
serve as a de facto source of reference materials and practical guides for academ￾ics and industrial practitioners looking to advance the discipline and aims of green 
chemistry and chemical engineering.
Dominic C. Y. Foo
Centre for Green Technologies
University of Nottingham Malaysiaix
Preface
“Ask not what your country can do for you, ask what you can do for your country” - 
A profound and notable quote from an inaugural address delivered by John F. 
Kennedy. As President of the United States of America, it was one of his efforts to 
inspire his citizens to understand the importance of taking civil action and getting 
involved in public service. Such a quote still carries significant relevance in today’s 
context. Rising global greenhouse gas emission levels and climate change issues 
today have prompted us to pose the same argument as John F. Kennedy did in the 
past, but with a much deeper premise: Ask not what your planet can do for you, ask 
what you can do for your planet.
Amid the vastly reported impacts of climate change, it is now crucial for us to 
rethink energy initiatives for the future. We should aggressively visualize new ways to 
operate in the energy sector and reduce carbon emissions. Since the Paris Agreement 
in 2015, nations worldwide have been developing policies for curbing carbon dioxide 
(CO2) emissions. To date, CO2 emissions are still a critical going issue. CO2 emis￾sions in 2020 saw a significant dip compared to previous years. Experts argue that 
this was due to movement restrictions and lockdowns imposed in many countries to 
address the spread of COVID-19 virus. However, it is clear that we cannot rely on 
such extreme measures to curb CO2 emissions in the long term. This shows that we 
still have a lot to do to reduce CO2 emissions globally. More effective carbon reduc￾tion strategies must be put in place to cut CO2 emissions in the coming few decades. 
To curb the impacts of rising CO2 emissions, the Intergovernmental Panel on Climate 
Change (IPCC) report states that the emissions target needs to be net-zero by the year 
2050. This would certainly require a rethinking of the way we deploy our energy 
systems and supply chains, considering energy transition efforts. These efforts take 
considerable time to materialize once decisions are made. Hence, it is now a critical 
time for us to make important and accurate decisions for our energy systems. We 
need the right tools for us to efficiently plan energy systems and supply chains and to 
avoid making costly judgments that will impact our future negatively.
Mathematical models can provide us with the tools required to make well￾informed decisions. They have been widely used in aiding the decision-making pro￾cess, modeling, and performance prediction related to energy systems and supply 
chains. Several books have been published on the use of sophisticated models for 
energy systems and supply chains. However, these books focus mainly on catering to 
advanced researchers. This led us to discover that there is a gap in addressing readers 
who are new to the research field and are keen to learn the basics behind developing 
mathematical models. Without understanding the basics, people are largely deprived 
of possibilities for using mathematical models meaningfully to solve issues in energy 
systems and supply chains. The recognition of this gap allowed us to conceptualize 
the idea for this book. 
This book aims to provide an understanding of the various available energy sys￾tems and supply chains, the basics behind mathematical models, the steps required 
to develop mathematical models, and examples/case studies where such models x Preface
are applied. This book is divided into two parts. In the first part, we have the first 
three chapters (i.e., Chapters 1 – 3) written in a textbook format suitable for begin￾ners interested to learn about mathematical models. Here, we adopted a strategy of 
teaching the basics and principles needed to develop basic mathematical models. 
This will be catered to advanced undergraduate students, postgraduate students, 
and new researchers keen on exploring this research field. In Chapter 1, we pro￾vide the essential concepts and understanding of the working principles of various 
energy systems and supply chains. A detailed account of the different configura￾tions is described to give a solid foundation for readers. This is linked to Chapters 2 
and 3, where essential basics and fundamentals on mathematical models and opti￾mization, development of mathematical models, and the guiding principles when 
developing such models are covered. 
In the second part of the book, the remaining chapters contain an edited com￾pilation of contributed chapters from different research groups and authors experi￾enced in this research field. These chapters will provide the reader with illustrative 
examples and case studies to show how mathematical models are applied to solve 
problems in different energy systems and supply chains. The second part starts with 
Chapter 4 where Belmonte, Aviso, Benjamin, and Tan used mathematical models to 
synthesize optimal biochar systems. In Chapter 5, Lim, How, and Lin applied a math￾ematical model to the planning of sustainable hydrogen networks in South Korea. 
Meanwhile, Chapter 6 by Chan and Chew, discussed the application of a mathemati￾cal model to optimize polygeneration systems powered by glycerine-pitch and diesel. 
Following this, Mukherjee and Smith used a framework of mathematical models in 
Chapter 7 to optimize the economic and environmental sustainability of a TEG dehy￾dration process. Then, Chapter 8 by Kumawat and Chaturvedi applied mathematical 
models to aggregate production planning for the steel industry in India. Chapter 9 
by Tan, Aviso, and Lee pivoted to the macro-level perspective, where mathematical 
models were used to optimize the economic planning for Taiwan. Following suit, 
Rajakal and Wan demonstrated a mathematical model’s ability to develop sustain￾able land expansion strategies for palm-based biodiesel supply chains in Chapter 10. 
Next, Chapter 11 by Jegede, De Mel, Short, and Isafiade presented the use of a math￾ematical model to determine the optimal design of a decentralized renewable energy 
system in Namibia. Finally, Chapter 12 by San Juan, Ching, Chua, Dyogi, and Sy 
applied a mathematical model to optimize battery energy within the electrical dis￾tribution grid. 
We hope that the twelve chapters of this book provide readers with the founda￾tions and inspiration to tackle problems in energy systems and supply chains using 
mathematical models. 
Viknesh Andiappan, Denny K. S. Ng, and Santanu Bandyopadhyay
June 2022xi
Foreword
Providing clean, affordable energy is necessary to support rising standards of living 
throughout the world while keeping environmental footprints within sustainable lev￾els. There is also increasing pressure to curb fossil fuel use and ramp up low-carbon 
alternatives, particularly renewables, in order to manage climate change. Limiting 
mean global temperature to a safe level – no more than 2°C above the pre-industrial 
average – will actually require the world to cut net greenhouse gas emissions to zero 
by the middle of the 21st century. This goal will also require massive, concerted 
deployment of multiple carbon management measures, one of which is the wide￾spread use of green energy. This unprecedented challenge will also require energy 
specialists of the near future to be well versed in computing techniques that can sup￾port the rapid greening of the energy sector.
This book is intended to address this need by providing a comprehensive intro￾duction to optimization models and their application to energy systems and supply 
chains. The book is divided into two main parts. The first part focuses on fundamen￾tals and consists of three tutorial chapters written by the editors themselves. Chapter 
1 (Energy Systems and Supply Chains) sets the tone by discussing the engineered 
systems that the world relies on to meet its energy needs. Chapter 2 (Optimization 
of Energy Systems and Supply Chains) discusses how optimization is a fundamental 
part of the effective planning, design, and operation of such systems. Then, Chapter 
3 (Formulating Generalized Mathematical Models) delves into the mathematics of 
optimization models in the context of energy applications. These three chapters are 
designed to provide a textbook-style introduction into the subject matter which is 
then illustrated further in the latter half of the book.
The second part of the book deals with applications and consists of nine con￾tributed chapters by research teams from 15 different institutions in nine countries. 
The chapters provide a diversified but coherent illustration of how optimization 
models can be applied to energy-related problems. Chapter 4 (Mixed-Integer Linear 
Programming Model for the Synthesis of Negative-Emissions Biochar Systems) by 
Belmonte and colleagues shows the application of network optimization models for 
planning negative emissions systems that sequester carbon in biochar.
Chapter 5 (A Comprehensive Guidance on Transitioning Toward Sustainable 
Hydrogen Network from Localized Renewable Energy System: Case Study of South 
Korea) by Lim and colleagues, on the other hand, considers the optimization of future 
hydrogen networks as part of energy systems with high renewable penetration. Both 
of these chapters consider macro-level modeling of large-scale systems. On the other 
hand, Chapter 6 (An Optimization Framework for Polygeneration System Driven 
by Glycerine Pitch and Diesel) by Chan and Chew considers the optimization of a 
dual-fuel system for efficient provision of multiple output streams. Chapter 7 (Multi￾Objective Optimization of TEG Dehydration Process to Mitigate BTEX Emissions 
under Feed Composition Uncertainty) by Mukherjee and Smith describes a model 
for the optimization of an industrial process and considers two complications that are 
often encountered in real-world systems – the presence of multiple objectives and the xii Foreword
occurrence of uncertainty. Chapter 8 (Constrained Production Planning with Parametric 
Uncertainties) by Chaturvedi and Kumawat similarly considers how to deal with uncer￾tainties that are encountered in the parameters of production planning models. Chapter 
9 (Linear Programming Models Based on the Input-Output Framework) by Tan and 
colleagues describes a special class of optimization models based on Leontief’s well￾established approach for representing economic networks; the economy-wide impacts 
of energy disruptions or transitions are also considered. The final three chapters deal 
with climate-related concerns. Chapter 10 (Optimization for Oil Palm-Based Biodiesel 
Supply Chain: Upstream Stages) by Rajakal and Wan considers the problem of mini￾mizing land-use change resulting from capacity expansion in agro-industrial supply 
chains. Managing such expansion is critical to mitigating non-combustion greenhouse 
gas emissions. Then, Chapter 11 (Optimal Design of Islanded Distributed Energy 
Systems Incorporating Renewable Energy for Rural Africa: A Namibian Case Study) 
by Jegede and colleagues demonstrates the benefits of optimal design of decentral￾ized energy production as a strategy for meeting the needs of remote communities in 
developing countries. Finally, Chapter 12 (Multi-Objective Optimization for Energy 
Network Planning: Energy Storage and Distribution in Integrated Solar Powered 
Grids) by Sy and colleagues describes a model for planning renewable energy systems 
where energy storage is a critical component. Together, these nine chapters provide 
the reader with a broad spectrum of potential applications of optimization models for 
energy systems and supply chains, while remaining consistent with the overall direc￾tion set by the first three didactic chapters.
As conceived by the editors, this book provides a strong general introduction to the 
area of energy systems optimization using mathematical programming. The content 
is appropriate for graduate and senior-level undergraduate students in engineering and 
related disciplines, as well as researchers, practitioners, and lecturers. The careful bal￾ance between theory and practice guarantees an engaging journey for the reader who is 
intent on contributing to the inexorable greening of the world’s energy.
Prof. Raymond R. Tan
De La Salle Universityxiii
Acknowledgments
First and foremost, we wish to thank the authors who contributed their invaluable 
expertise in the form of chapters covering state-of-the-art developments in Energy 
Systems and Supply Chains. The value of this book is based primarily on their inputs. 
We are also grateful to the staff of CRC Press, who provided invaluable assistance 
throughout the process of publication. Finally, we would like to thank our family 
members for their support throughout our professional careers.
In particular, Viknesh Andiappan would like to dedicate this book to his wife 
Aparna and their families. This book will not have been possible without their 
 support and care. 
Denny K. S. Ng dedicates this book to his wife Pick Ling and children 
(Jenny, Kenny, and Penny) as well as family members for their support throughout 
his professional career.
Santanu Bandyopadhyay would like to dedicate this book to his wife Sreyasi and 
son Ratul for their valuable support.
“We all die. The goal isn’t to live forever, but to leave behind something that will.”xv
Editors
Viknesh Andiappan, PhD, is an Associate Professor at Swinburne University of 
Technology Sarawak Campus. His area of specialization centers on optimization 
of energy systems and supply chains. His research interests also include design 
and optimization of net-zero energy systems, synthesis of integrated biorefiner￾ies, industrial symbiosis planning, energy planning for greenhouse gas emission 
reduction, and sustainable agriculture planning. He spends his time working on 
mathematical programming, multi-objective optimization, input-output model￾ing, game theory models, process simulation, and process integration tools such 
as pinch analysis. Dr. Andiappan is well published and well cited for a young 
researcher (over 70 publications with an h-index of 15) and presented several 
papers at various conferences. In 2020, Dr. Andiappan was awarded the IBAE 
Young Researcher of the Year Award. He was also shortlisted as a finalist for the 
IChemE Young Researcher Malaysia Award in 2018 and 2019. Dr. Andiappan is 
also an editorial board member for internationally peer-reviewed journals such 
as Process Integration and Optimization for Sustainability (PIOS) and Frontiers 
in Sustainability (Sustainable Chemical Process Design). He is a member of the 
reviewer board for Processes Journal. In addition, he serves as a technical com￾mittee member for several conferences. Dr. Andiappan also collaborates closely 
with well-known international researchers from Malaysia, the Philippines, India, 
Japan, Taiwan, and United Kingdom. He led and completed a COVID-19 research 
grant, which worked on developing an economic analysis model to formulate post￾pandemic recovery strategies for the agro-industry in both Malaysia and the 
Philippines. He was awarded the IBAE Young Researcher of the Year Award in 2020 
for his contributions and achievements in research.
Aside from research, Dr. Andiappan is a Chartered Engineer and serves as a 
Chartered Engineer C&C Report evaluator for the Institution of Chemical Engineers 
(IChemE). He also serves as the vice-chair for the IChemE Palm Oil Processing 
Special Interest Group (POPSIG) and was previously the university roadshow coor￾dinator. As the university roadshow director, he led efforts to promote the palm 
industry and the opportunities for chemical engineers as well as for young chemical 
engineering undergraduate students in universities around Malaysia.
Denny K. S. Ng, PhD, is Head in the School of Engineering and Physical 
Sciences, Heriot-Watt University, Malaysia. Prof. Ng has well published over 
220 papers with an h-index of 40, edited one book, and is the author of one 
book. He served as an editor in a number of international refereed journals 
(e.g., Process Integration and Optimization for Sustainability, Springer; Proceedings 
of the Institution of Civil Engineers – Waste and Resource Management; Processes, 
MDPI; Frontiers in Energy Research and Frontiers in Sustainability) and guest editor 
in a number of journals which include Process Safety and Environmental Protection, 
Elsevier. His areas of specialization include net-zero strategies, optimization of xvi Editors
sustainable value chain of palm oil industry, energy management, resource con￾servation via process integration techniques, synthesis and analysis of biomass 
processing, and integrated biorefineries. He is a fellow of IChemE; a fellow of the 
Higher Education Academy; Chartered Engineer, Engineering Council; Professional 
Engineer, Malaysia; and Exco member of Young Scientist Network – Academy of 
Sciences Malaysia (YSN-ASM). He contributed to professional bodies actively. With 
his excellent contributions, he is listed as one of the Top 2% of scientists in their main 
subfield discipline in 2019 and 2021, Stanford List. He is recognized as Top Research 
Scientists Malaysia (TRSM) in 2018 and is the recipient of Ten Outstanding Young 
Malaysian Award (TOYM) 2017; Institution of Engineers, Malaysia Young Engineer 
Award 2015; and Global IChemE Young Chemical Engineer of the Year 2012. Prof. 
Ng also applied his R&D output in industrial consultation projects.
Santanu Bandyopadhyay, PhD, is currently Praj Industries Chair Professor in the 
Department of Energy Science and Engineering, at the Indian Institute of Technology 
Bombay (IIT Bombay). His research interest includes process integration, pinch 
analysis, industrial energy conservation, modeling and simulation of energy sys￾tems, and design and optimization of renewable energy systems. Since 1994, Prof. 
Bandyopadhyay has been associated with and contributed toward various develop￾mental, industrial, and research activities involving different structured approaches 
to process synthesis, energy integration and conservation, as well as renewable 
energy systems design. Before joining IIT Bombay, he worked for M/s Engineers 
India Limited, New Delhi. He is currently Co-Editor-in-Chief for Process Integration 
and Optimization for Sustainability (Springer Nature) as well as Associate Editor for 
Journal of Cleaner Production (Elsevier), Clean Technologies and Environmental 
Policy (Springer Nature), and South African Journal of Chemical Engineering
(Elsevier). He is a fellow of the Indian National Association of Engineering (INAE).xvii
Contributors
Viknesh Andiappan
Faculty of Engineering, Computing and 
Science
Swinburne University of Technology, 
Jalan Simpang Tiga
Kuching, Malaysia
Kathleen B. Aviso
Chemical Engineering Department
De La Salle University
Manila, Philippines
Santanu Bandyopadhyay
Department of Energy Science and 
Engineering
Indian Institute of Technology Bombay
Mumbai, India
Beatriz A. Belmonte
Chemical Engineering Department
University of Santo Tomas
Manila, Philippines
Michael Francis D. Benjamin
Chemical Engineering Department
University of Santo Tomas
Manila, Philippines
Wai Mun Chan
School of Engineering
Monash University Malaysia
Selangor, Malaysia
Nitin Dutt Chaturvedi
Department of Chemical and 
Biochemical Engineering
Indian Institute of Technology Patna
Bihar, India
Irene Mei Leng Chew
School of Engineering
Monash University Malaysia
Selangor, Malaysia
Amiel Ching
Industrial and Systems Engineering 
Department
De La Salle University
Manila, Philippines
Charles Chua
Industrial and Systems Engineering 
Department
De La Salle University
Manila, Philippines
Ishanki De Mel
Department of Chemical and Process 
Engineering
University of Surrey
Guildford, United Kingdom
Lorenzo Dyogi
Industrial and Systems Engineering 
Department
De La Salle University
Manila, Philippines
Bing Shen How
Faculty of Engineering, Computing and 
Science
Swinburne University of Technology
Sarawak, Malaysia
Adeniyi J. Isafiade
Department of Chemical Engineering
University of Cape Town
Cape Town, South Africaxviii Contributors
Kemi Jegede
Department of Mining and Process 
Engineering
Namibian University of Science and 
Technology
Windhoek, Namibia 
and
Department of Chemical Engineering
University of Cape Town
Cape Town, South Africa
Piyush Kumar Kumawat
Department of Chemical and 
Biochemical Engineering
Indian Institute of Technology Patna
Bihar, India
Jui-Yuan Lee
Department of Chemical Engineering 
and Biotechnology
National Taipei University of 
Technology
Taipei, Taiwan
Juin Yau Lim
Department of Environmental Science 
and Engineering
Kyung Hee University
Gyeonggi, Korea
Rajib Mukherjee
Department of Chemical Engineering
The University of Texas Permian Basin
Odessa, Texas
Denny K. S. Ng
School of Engineering and Physical 
Sciences
Heriot-Watt University Malaysia
Wilayah Persekutuan, Malaysia
Jaya Prasanth Rajakal
School of Computer Science and 
Engineering
Taylor’s University, Lakeside Campus
Subang Jaya, Malaysia
Jayne San Juan
Industrial and Systems Engineering 
Department
De La Salle University
Manila, Philippines
Michael Short
Department of Chemical and Process 
Engineering
University of Surrey
Guildford, United Kingdom
Krystal Smith
Department of Chemical Engineering
The University of Texas Permian Basin
Odessa, Texas
Charlle Sy
Industrial and Systems Engineering 
Department
De La Salle University
Manila, Philippines
Raymond R. Tan
Chemical Engineering Department
De La Salle University
Manila, Philippines
Yoke Kin Wan
Department of Chemical and 
Environmental Engineering
University of Nottingham Malaysia
Semenyih, Malaysia
and
School of Computer Science and 
Engineering
Taylor’s University, Lakeside Campus
Subang Jaya, MalaysiaPart A
Fundamentals3
1 Energy Systems and 
Supply Chains
Viknesh Andiappan
Swinburne University of Technology
Denny K. S. Ng
Heriot-Watt University Malaysia
Santanu Bandyopadhyay
Indian Institute of Technology Bombay
1.1 INTRODUCTION
Studies from the International Energy Agency (IEA) indicate that we are still 
faced with the challenge of mitigating global greenhouse gas (GHG) emission, par￾ticularly carbon dioxide (CO2). However, IEA studies also revealed a dip in CO2
emission in 2020. According to some, this may be attributed to reducing human 
activities due to lockdowns to address the COVID-19 pandemic, which started in 
early 2020. Nevertheless, the pandemic has taught us one lesson: we cannot rely on 
drastic measures such as lockdowns to curb CO2 emission in the long term. Most 
CO2 emission originate from using non-renewable fossil fuel energy resources as 
our primary energy sources. As of 2020, the global energy mix stands at 83.1% non￾renewable fossil fuel energy resources and 5.7% renewable energy resources (British 
Petroleum, 2021). These data show that we still have a lot to do regarding reduc￾ing global CO2 and other GHG emission. As global movement restrictions begin to 
loosen, more effective carbon reduction strategies must be implemented to reduce 
CONTENTS
1.1 Introduction ......................................................................................................3
1.2 Energy Supply Chains ......................................................................................4
1.3 Energy Systems ................................................................................................6
1.3.1 Conventional Power Plants ...................................................................6
1.3.2 Cogeneration Systems ...........................................................................8
1.3.3 Trigeneration Systems...........................................................................8
1.3.4 Polygeneration Systems ...................................................................... 10
1.3.5 Hybrid and Renewable Energy Systems ............................................. 10
1.4 Process Systems Engineering ......................................................................... 13
References ................................................................................................................ 14
DOI: 10.1201/9781003240228-24 Optimization for Energy Systems and Supply Chains
CO2 emission in the coming few decades. To curb the impacts of rising CO2 emis￾sion, the Intergovernmental Panel on Climate Change (IPCC) stated that a net-zero 
emission target needs to be achieved by 2050 (IPCC, 2018). This provides us suf￾ficient motivation to begin revaluating how we deploy our energy systems and sup￾ply chains. Experts argue that this is a critical time to make essential and accurate 
decisions as we cannot afford to make costly judgments. Future energy systems and 
supply chains need to be designed and operated differently. In fact, future energy 
systems and supply chains need to be optimized to achieve higher energy efficiencies 
and reduce emission. This must be coupled with renewable energy to avoid emission. 
The integration of these solutions requires careful and holistic decision-making. The 
first step to making informed decisions is to understand how energy systems and 
supply chains work. This chapter takes a closer look at energy supply chains and 
the state-of-the-art technologies used in energy systems. At the end of this chapter, 
we introduce a research domain that deals with the development of decision-making 
tools.
1.2 ENERGY SUPPLY CHAINS
To understand energy supply chains, let’s understand what a typical supply chain net￾work is. A supply chain network is generally made up of several stages. These stages 
include suppliers, manufacturers, distribution centers, and customers (Beamon, 
1998). A supply chain network shows how each stage is connected. The “connection” 
here refers to how each stage interacts with the others. Such interactions can be the 
movement of material and energy resources or the transmission and distribution of 
generated material and energy. Transportation modes such as trucks, tankers, ships, 
pipelines, and electric cables are typically considered to transport energy resources 
from the sources to the destination. However, the choice of transportation is depen￾dent on the type of material and energy resources, cost, and distance of delivery.
Figure 1.1 shows the stages found in a typical energy supply chain. The energy 
supply chain begins with the source where primary energy resources are harvested or 
extracted. Energy resources can be categorized into non-renewable energy resources 
(i.e., coal, natural gas, diesel) and renewable energy resources (i.e., biomass, solar, 
hydro, wind). Non-renewable energy resources refer to fossil fuels such as oil and 
gas extracted from wells and coal mines. The products from the extractions are then 
transported to energy systems to generate secondary energy sources such as petrol, 
diesel, liquified petroleum gas, and electricity. On the other hand, renewable energy 
resources can be in the form of biomass. Biomass can be obtained from agricul￾tural products and waste collected from croplands and processing facilities. In this 
respect, biomass can be transported to energy systems to generate secondary energy. 
Solar and wind energies are other types of renewable energy resources. Unlike bio￾mass, solar and wind do not require transportation. However, solar and wind need 
to be converted to a useful secondary form in locations with sufficiently high avail￾ability and intensity.
The energy system refers to the system/facilities that use primary energy resources 
to produce secondary energy forms for the final energy services. Energy services 
refer to heating, power, cooling, lighting, cooking, and transportation. Depending on Energy Systems and Supply Chains 5
the type of energy system, the secondary energy produced has to be transported and 
distributed to the end-users. For example, electricity is transmitted via transmission 
lines and then distributed to various end-users via distribution systems. These distri￾bution systems involve transformers for change in voltage. Distribution transformers 
receive the high-voltage electricity from the transmission lines and distribute the low￾voltage electricity to the end-users such as residences and industry. Similarly, energy 
FIGURE 1.1 Energy supply chain.6 Optimization for Energy Systems and Supply Chains
can be transported in other forms, such as natural gas, and liquefied petroleum gas, 
via gas pipelines or cylinders. In addition, other heating and cooling energy can then 
be transported via energy carriers (e.g., steam, water, heating oil) to the end-user 
using pipelines.
Based on the forms of secondary energy produced, energy systems can be clas￾sified into conventional power plants, cogeneration systems, trigeneration systems, 
polygeneration systems, and hybrid and renewable energy systems. The following 
sections describe each type of energy system.
1.3 ENERGY SYSTEMS
As shown in Figure 1.1, energy systems are the “heart” of an overall energy supply 
chain. These energy systems comprise several unit operations that produce energy 
for consumption. The following sub-sections dive deeper into the various classifica￾tions of energy systems.
1.3.1 Conventional Power Plants
In conventional energy supply chains, the facilities that produce electricity are known 
as power plants. Power plants convert various primary energy resources to generate 
electricity (secondary energy). Examples of power plants include gas-fired power 
plants, coal-fired power plants, biomass-fired power plants, hydropower plants, and 
many more.
Regardless of the primary energy resource used, the technologies in thermal power 
plants are deployed in different configurations. These configurations can be the gas 
turbine/engine, steam, or combined cycles. The gas turbine/engine cycle relies on the 
high-temperature cycle, where primary energy resources are used to produce elec￾tricity; then some of the thermal energy is rejected as waste heat. Figure 1.2 shows 
an example of the gas cycle. In Figure 1.2, both gas turbines and gas engines are used 
to generate electricity. This is done by combusting gaseous energy resources at high 
temperatures to generate electricity. However, the waste heat generated from these 
technologies is typically released into the atmosphere. This is because the conversion 
FIGURE 1.2 Example of gas turbine/engine cycle for power plants.Energy Systems and Supply Chains 7
process of heat to electricity is restricted by the laws of thermodynamics and gener￾ates waste heat.
Figure 1.3 shows the configuration for the steam cycle. The steam cycle operates 
on the low-temperature cycle. In other words, the primary energy resource is used 
to produce heat first, a part of which is then converted to electricity. Examples of a 
steam cycle may include the use of steam boilers. In steam boilers, energy resources 
(i.e., natural gas, coal) are combusted, and the heat produced here is used to generate 
high-pressure steam. The high-pressure steam is then directed to a steam turbine, 
where electricity is produced. Electricity is produced by converting thermal energy 
from the high-pressure steam in the steam turbine. The steam then leaves the turbine 
at a lower pressure. The low-pressure steam is then condensed for reuse.
Multiple cycles, such as the gas and steam cycles, may be combined to generate 
electricity more efficiently in combined cycle power plants (Miller, 2017). Figure 1.4 
shows an example of a combined cycle power plant. As shown, the energy system 
follows the same operation as the gas cycle, but the waste heat is now utilized in a 
heat recovery steam generator to produce steam. The steam is then passed through a 
steam turbine to generate more electricity.
FIGURE 1.3 Example of steam cycle for power plants.
FIGURE 1.4 Example of combined cycles for power plants.8 Optimization for Energy Systems and Supply Chains
1.3.2 Cogeneration systems
Note that power plants tend to operate with low energy efficiency, especially when 
the facility’s sole purpose is to produce electricity. On the other hand, cogeneration 
systems are often considered to improve the overall energy conversion efficiency. 
Cogeneration systems produce heat and power simultaneously, typically from a sin￾gle primary energy resource. It is also known as a combined heat and power sys￾tem (Wu and Wang, 2006). Cogeneration systems aim to utilize energy primary 
resources with higher efficiency. Such systems are suitable when both heat and elec￾tricity demands are present at the same location. Such systems are commonly used in 
industrial processes or residential areas with colder climates.
Cogeneration systems can be configured in various ways such as the bottoming, 
topping, or combined cycles (Breeze, 2018). Figure 1.5 shows an example of a bot￾toming cycle in cogeneration systems. Its operation is similar to the steam cycle 
discussed in Section 1.3.1, with the only difference in the steam usage at the end. 
As shown in Figure 1.5, steam leaves the steam turbine at a lower pressure and is 
used for heating purposes (e.g., process heating, space heating). Unused steam is 
condensed for reuse.
Figure 1.6 shows an example of the topping cycle for cogeneration systems. As 
shown, the topping cycle follows a similar operation to the gas turbine/engine cycle 
described in Section 1.3.1. However, in cogeneration systems, the waste heat is uti￾lized in a heat recovery steam generator to produce low-grade heat (or low-pressure 
steam) for heating applications.
Topping and bottoming cycles can also be combined in cogeneration systems. 
Such systems are known as combined cycle cogeneration systems (Rao, 2012). This 
variant extends the operation of the combined cycle power plant to provide a portion 
of the steam produced for heating purposes.
1.3.3 trigeneration systems
Trigeneration systems, otherwise known as combined cooling, heating, and power 
systems, are extensions of cogeneration systems. These systems essentially produce 
FIGURE 1.5 Example of bottoming cycle for cogeneration systems.Energy Systems and Supply Chains 9
additional cooling energy for space or industrial cooling requirements (Jradi and 
Riffat, 2014). Trigeneration systems commonly produce cooling energy using two 
primary technologies: vapor compression chiller and absorption chiller (shown in 
Figure 1.7). Vapor compression chillers work on the principle of using the vapor 
compression cycle to produce cooling energy. Such a cycle typically consists of four 
components: evaporator, compressor, condenser, and expansion valve (as shown in 
Figure 1.8). Based on Figure 1.8, heat is extracted from chilled water and is added to 
the refrigerant at constant pressure. Both refrigerant and chilled water do not mix and 
are separated by a solid wall in the evaporator. The refrigerant then leaves the evapo￾rator as vapor and is compressed by a compressor (which requires electricity input) 
to high pressure and temperature. Here, the compressor is typically powered by the 
electricity produced from the cogeneration section (Figure 1.7a). The compressed 
refrigerant vapor is then sent to a condenser, where its heat is rejected to the outside 
cooling medium (e.g., cooling water, air). The refrigerant then leaves the condenser 
as liquid and is expanded in an expansion valve, where its pressure and temperature 
are reduced to the evaporator level. This cycle repeats to produce chilled water at the 
evaporator section continuously.
On the other hand, absorption chillers utilize the remaining waste heat after heat￾ing and electricity generation to produce cooling energy. Unlike vapor compression 
chillers, the working principle for absorption chillers is the absorption cycle. In the 
absorption cycle (shown in Figure 1.9), the compressor in the vapor compression 
cycle is replaced with a chemical cycle. This chemical cycle consists of an absorber, 
pump, and regenerator. Instead of compressing the refrigerant vapor exiting the evap￾orator like in the vapor compression cycle, the absorption cycle dissolves the vapor in 
a liquid (the absorbent). The solution is then pumped to a higher pressure (with much 
less power input than a compressor). Finally, it uses heat input, typically waste heat, 
to evaporate the refrigerant vapor from the solution (Figure 1.7b).
FIGURE 1.6 Example of topping cycle for cogeneration systems.10 Optimization for Energy Systems and Supply Chains
1.3.4 Polygeneration systems
Polygeneration systems are systems that extend the operations of trigeneration sys￾tems. These systems produce heat, power, and cooling, just like trigeneration systems. 
However, they also produce fuels or additional products. Polygeneration systems are 
also known as multi-energy or multi-vector energy systems due to their ability to 
produce other additional outputs (i.e., biofuels, chemicals, hydrogen, clean water) in 
addition to heating, power, and cooling energy (Mancarella, 2014). These systems 
would typically contain additional unit operations that utilize either primary energy 
sources or waste energy to produce additional output.
In most cases, polygeneration systems contain thermochemical conversion path￾ways that produce syngas as an intermediate. In recent times, polygeneration systems 
have multiple input energy resources and multiple outputs. This makes the system 
flexible and improves adjustability. For example, Figure 1.10 shows an example of 
a polygeneration system, where hydrogen is produced due to using energy produced 
from units that make up a trigeneration system.
1.3.5 Hybrid and renewable energy systems
Hybrid and renewable energy systems produce various kinds of energy for residen￾tial and industrial consumption. However, hybrid and renewable energy systems are 
FIGURE 1.7 Trigeneration system (a) with vapor compression chiller and (b) with absorp￾tion chiller.Energy Systems and Supply Chains 11
FIGURE 1.8 Vapor compression cycle.
FIGURE 1.9 Absorption cycle.12 Optimization for Energy Systems and Supply Chains
unique due to the energy resources that are used as input. Hybrid energy systems 
utilize a combination of renewable and non-renewable energy resources to produce 
energy services (Shivarama Krishna and Sathish Kumar, 2015).
The combination of renewable and non-renewable primary energy resources can 
be done via co-firing. Co-firing can be implemented in several ways: direct, indirect, 
and parallel. In direct co-firing, primary energy resources can be either mixed before 
the combustion chamber or fed separately into a combustion chamber (Aviso et al., 
2020). For instance, biomass and coal can be co-fired in a steam boiler to help gen￾erate very high-pressure steam for electricity generation. Indirect co-firing is when 
energy resources are fired in different combustion chambers and mixed to generate 
energy (Aviso et al., 2020). For example, biomass and coal can be combusted in 
separate chambers. The gases produced from combustion will be mixed and fed into 
a steam boiler to generate steam. As for parallel co-firing, energy systems would 
utilize each energy resource in separate pathways (Aviso et al., 2020). For example, 
coal is combusted in steam boilers while biomass is used in a gasifier to produce syn￾gas which is later fed into a separate boiler within the same system. Finally, there are 
alternative hybrid energy systems that do not rely on co-firing. Specific hybrid energy 
systems utilize renewable energy sources such as solar, wind, and hydro alongside 
non-renewable energy resources. These systems have pathways that generate energy 
through combustion and those that avoid combustion entirely under one roof. In this 
respect, these are not the conventional hybrid energy systems where energy resources 
are mixed before or after combustion. For example, solar intensity can be converted 
by concentrated solar panels to produce power. Such unit operations can be operated 
alongside coal-fired steam boilers within the same system.
Renewable energy systems are systems that generate secondary energy exclusively 
from renewable energy resources. Thus, these systems consist of the unit operations 
discussed in Sections 1.3.1–1.3.5 but purely rely on renewable energy resources as 
input to generate heat, power, cooling, and other products.
Sections 1.2 and 1.3 indicate that there are many options in energy systems and 
supply chains to consider for energy generation and distribution. Each system has a 
FIGURE 1.10 Polygeneration system using natural gas.Energy Systems and Supply Chains 13
range of unit operations that may or may not be suitable for energy generation. In 
particular, energy systems and supply chains can be configured differently based 
on performance, sizes, costs, environmental impact, operational flexibility, scalabil￾ity, transport routes, logistics, scheduling, and planning. In this respect, it can be 
challenging to determine optimal energy systems and supply chains for operation. 
Thus, decision-making tools are essential to ensuring that optimal technologies and 
transportation routes will be selected for energy systems and supply chains. The next 
section introduces a field that develops decision-making tools for systems known as 
process systems engineering (PSE).
1.4 PROCESS SYSTEMS ENGINEERING
The field of PSE has a long-standing history of developing systematic meth￾ods to design and optimize energy systems and supply chains (Sargent, 2005; 
Stephanopoulos and Reklaitis, 2011).
PSE is known to develop methods for process synthesis. Process synthesis 
is defined as “an act of determining the optimal interconnection of processing 
units as well as the optimal type and design of the units within a process system” 
(Nishida, 1981). As stated in its definition, process synthesis requires designers 
to find an optimum chemical process design that fulfills various aspects such as 
efficiency, sustainability, economics (El-Halwagi, 2017; Nishida, 1981). In this 
respect, several systematic methods have been developed to provide designers 
with a methodological framework for designing chemical processes (Biegler
et al., 1997; Douglas, 1988; El-Halwagi, 2006; Seider et al., 2004; Stephanopoulos 
and Reklaitis, 2011). Specifically, these methods provide guidance in identify￾ing the feasibility of a process before the actual design of its units. Prior to this, 
several alternatives are generated and evaluated based on design decisions and 
constraints. After ranking by specific performance criteria, the most convenient 
options are refined and optimized. By applying these systematic methods, quasi￾optimal targets for process units can be set well ahead of their detailed sizing 
(Dimian et al., 2014).
Systematic methods developed in PSE are not just limited to process synthesis. 
As shown in reviews presented by Barnicki and Siirola (2004), Cecelja et al. (2011), 
Grossmann and Daichendt (1996), Li and Kraslawski (2004), and Westerberg (2004), 
systematic methods have also been developed for the synthesis of energy systems and 
supply chains. These methods used mathematical optimization to optimize the selec￾tion of technologies in energy systems (Ünal et al., 2015).
This book aims to provide entry-level access to the basics of mathematical optimi￾zation in energy systems and supply chains. This will be covered in two parts (i.e., A 
and B). Part A starts with Chapter 2, where a detailed account of how we can develop 
mathematical optimization (models) to optimize energy systems and supply chains is 
provided. Following this, Chapter 3 recommends best practices for writing general￾ized mathematical equations. Part A is complemented further by Part B of this book. 
Part B contains nine contributed chapters, showcasing the range of applications for 
mathematical optimization.14 Optimization for Energy Systems and Supply Chains
REFERENCES
Aviso, K.B., Sy, C.L., Tan, R.R., Ubando, A.T., 2020. Fuzzy optimization of carbon manage￾ment networks based on direct and indirect biomass co-firing. Renew. Sustain. Energy 
Rev. 132, 110035.
Barnicki, S.D., Siirola, J.J., 2004. Process synthesis prospective. Comput. Chem. Eng. 28, 441–446.
Beamon, B.M., 1998. Supply chain design and analysis: Models and methods. Int. J. Prod. 
Econ. 55, 281–294.
Biegler, L.T., Grossmann, I.E., Westerberg, A.W., 1997. Systematic Methods of Chemical 
Process Design. Hoboken, NJ: Prentice Hall PTR.
Breeze, P., 2018. Combined Heat and Power. Academic Press, London.
British Petroleum, 2021. Statistical Review of World Energy 2021, BP Energy Outlook 2021.
Cecelja, D.F., Kokossis, P.A., Du, D., 2011. Integration of ontology and knowledge-based optimiza￾tion in process synthesis applications, in: Pistikopoulos, E.N., Georgiadis, M.C., Kokossis, 
A.C. (Eds.), Computer Aided Chemical Engineering. Elsevier, New York, pp. 427–431.
Dimian, A.C., Bildea, C.S., Kiss, A.A., 2014. Integrated Design and Simulation of Chemical 
Processes, 2nd ed. Elsevier, Amsterdam.
Douglas, J.M., 1988. Conceptual Design of Chemical Processes. McGraw‐Hill, New York.
El-Halwagi, M.M., 2006. Process Integration. Academic Press.
El-Halwagi, M.M., 2017. Sustainable Design through Process Integration, 2nd ed. Elsevier, 
Cambridge, MA.
Grossmann, I.E., Daichendt, M.M., 1996. New trends in optimization-based approaches to 
process synthesis. Comput. Chem. Eng. 20, 665–683.
IPCC, 2018. Summary for Policymakers. Cambridge University Press, Cambridge, UK and 
New York.
Jradi, M., Riffat, S., 2014. Tri-generation systems: Energy policies, prime movers, cooling tech￾nologies, configurations and operation strategies. Renew. Sustain. Energy Rev. 32, 396–415.
Li, X., Kraslawski, A., 2004. Conceptual process synthesis: Past and current trends. Chem. 
Eng. Process. Process Intensif. 43, 583–594.
Mancarella, P., 2014. MES (multi-energy systems): An overview of concepts and evaluation 
models. Energy 65, 1–17.
Miller, J., 2017. The combined cycle and variations that use HRSGs, in: Eriksen, V.L. 
(Ed.), Heat Recovery Steam Generator Technology. Woodhead Publishing Limited, 
pp. 17–43. Doi: 10.1016/b978-0-08-101940-5.00002-6.
Nishida, N., 1981. A review of process synthesis. AIChE J. 27, 321–351.
Rao, A.D., 2012. Combined Cycle Systems for Near-Zero Emission Power Generation. 
Woodhead Publishing Limited, Cambridge.
Sargent, R., 2005. Process systems engineering: A retrospective view with questions for the 
future. Comput. Chem. Eng. 29, 1237–1241.
Seider, W.D., Seader, J.D., Lewin, D.R., 2004. Product and Process Design Principles: 
Synthesis, Analysis and Evaluation, 2nd ed. John Wiley & Sons, Ltd.
Shivarama Krishna, K., Sathish Kumar, K., 2015. A review on hybrid renewable energy sys￾tems. Renew. Sustain. Energy Rev. 52, 907–916.
Stephanopoulos, G., Reklaitis, G.V., 2011. Process systems engineering: From Solvay to mod￾ern bio- and nanotechnology. A history of development, successes and prospects for the 
future. Chem. Eng. Sci. 66, 4272–4306.
Ünal, A.N., Ercan, S., Kayakutlu, G., 2015. Optimisation studies on tri‐generation a review 
(1).pdf. Int. J. Ener 39, 1311–1334.
Westerberg, A.W., 2004. A retrospective on design and process synthesis. Comput. Chem. 
Eng. 28, 447–458.
Wu, D.W., Wang, R.Z.Ã., 2006. Combined cooling, heating and power : A review. Progress 
Energy Combust. Sci. 32, 459–495.15
2 Optimization of 
Energy Systems and 
Supply Chains
Viknesh Andiappan
Swinburne University of Technology
Denny K. S. Ng
Heriot-Watt University Malaysia
Santanu Bandyopadhyay
Indian Institute of Technology Bombay
2.1 INTRODUCTION
As mentioned in the previous chapter, process systems engineering (PSE) offers a 
range of process synthesis methods. In PSE literature, mathematical optimization 
is among the methods widely used in designing energy systems and supply chains. 
Before we look into how mathematical optimization is done, it is important for us to 
understand key terminologies that will be used regularly in this chapter. These key 
terminologies include:
• Model: A mathematical representation or description of a unit operation, 
process, system, or sub-system.
• Modeling: The act of building a model. It is where the behavior and per￾formance of each unit operation, process, or system are represented using 
mathematical equations. The end product of modeling is a mathematical 
model.
• Simulation: The act of solving a model to study the behavior and perfor￾mance of a unit operation, process, or system.
CONTENTS
2.1 Introduction .................................................................................................... 15
2.2 Methodology of Mathematical Optimization ................................................. 16
2.3 Illustrative Example ........................................................................................22
2.4 Conclusion ......................................................................................................38
Further Reading .......................................................................................................38
DOI: 10.1201/9781003240228-316 Optimization for Energy Systems and Supply Chains
• Optimization: The act of changing and adjusting variables in a model to 
determine the “best” performance or design for a given unit operation, pro￾cess, or system.
The terminologies play a significant role in shaping our understanding of mathemati￾cal optimization. Mathematical optimization is typically performed using the steps 
shown below (Biegler et al., 1997; Hendry et al., 1973):
 1.
 2.
 3.
 4.
 5.
This chapter aims to provide a detailed account of the steps mentioned above. First, 
Section 2.2 provides a clear methodology for mathematical optimization. This meth￾odology is then demonstrated via an illustrative example in Section 2.3. The purpose 
of the illustrative example is to allow readers to relate the theoretical knowledge in 
this chapter alongside a demonstrated example.
2.2 METHODOLOGY OF MATHEMATICAL OPTIMIZATION
This section provides a detailed description of the steps needed in mathematical opti￾mization. The ensuing sub-sections offer a step-by-step guide on how mathematical 
models can be developed for optimization.
Step 1: Developing superstructure of possible connections for unit operations
The first step in mathematical optimization is to develop a superstructure. 
A “superstructure” diagram displays all possible connections between vari￾ous unit operations considered for an energy system. It is essentially a visual 
representation of a network with potential process configurations that need 
to be optimized. It is worth noting that a superstructure can also be used 
to enumerate several possible unit operations and their alternative system 
configurations, process integration, operating modes, and other important 
matters in an energy system (Liu et al., 2011; Westerberg, 1991; Yeomans 
and Grossmann, 1999). Several publications from renowned PSE research￾ers have divided superstructure development into a few stages (Grossmann 
and Sargent, 1978; Mencarelli et al., 2020). The general steps of developing 
a superstructure are described further in the following:Optimization of Energy Systems and Supply Chains 17
 i. Enumerating possible raw materials, final products, and unit operations
 ii. Branching and matching connections
FIGURE 2.1 (a) Listing of raw materials and final products (b) Inclusion of unit operations 
to utilize raw materials and to produce final products.18 Optimization for Energy Systems and Supply Chains
(Pham and El-Halwagi, 2012). At the same time, those unit operations 
that can produce final products from these intermediate products are 
also to be connected (Figure 2.2a). This is called backward branching 
(Pham and El-Halwagi, 2012). The branching exercises here may lead to 
some matches in intermediate products. Therefore, these branches can 
be easily connected to form complete pathways in the superstructure 
(Figure 2.2b).
 iii. Interception
FIGURE 2.3 Inclusion of interception.
FIGURE 2.2 (a) Forward and backward branching (b) Matching.Optimization of Energy Systems and Supply Chains 19
Step 2: Collecting data for unit operations specified in the superstructure
After Step 1, we need to collect data on the unit operations specified in 
our superstructure. These data may include (but are not limited to) input-to￾output ratios, efficiencies, yields, conversions, cost of raw materials, cost of 
unit operations per unit flow or capacity, utility requirements per unit flow, 
and emission factors. These data will be used in Steps 4 and 5 to determine 
the performance of each unit operation. However, there would be occasions 
where data is not readily available for a given unit operation, e.g., new tech￾nologies or technologies with limited published literature. In this respect, 
there are several ways to go about addressing this:
• Assumptions are usually made when there is a lack of data. For example, 
a boiler’s capital cost is given ranges instead of exact values due to differ￾ences in capacity requirements. Therefore, a boiler’s cost is then extrapo￾lated, assuming the relationship between the capacity and capital cost of 
the equipment is linear. Alternatively, assumptions can be made based 
on benchmarks with similar unit operations used in other applications.
• Heuristics or experience can be helpful in cases where data are not 
available in the literature.
• Fundamental calculations based on first principles can be performed to 
generate simplified data. For example, it may be challenging to obtain 
data on the conversion of a general boiler as this highly varies based on 
the manufacturer’s design. Hence, fundamental heat transfer calcula￾tions can be done to determine the general conversion.
• Simulation packages can also be used to estimate the performance of 
certain unit operations. The results from such simulation can act as data 
for us to include.
It is also essential to note that the data collection step is important in deter￾mining the rigor of a mathematical model will consider. For instance, if 
we collect simplified data, the eventual model will take a simplified form 
as well. This may be useful in cases where estimations would be required. 
However, if the goal is to determine accurate insights, then the data col￾lected must also be reflective. It would be fair to say that a mathematical 
model is only as good as its data input. However, extremely accurate data 
and models may pose challenges in computational effort. The most rigor￾ous data and models often require highly complex computational effort to 
generate solutions. Such cases may take up a lot of time to collect accurate 
data and involve lengthy durations to generate solutions. This may not suit 
those who require quick insights to make informed decisions. Hence, a 
trade-off between simplification and accuracy is required. One must con￾sider factors such as the desired level of accuracy, the urgency to obtain 
solutions, and the resources available to operate highly complex computa￾tional systems.
Step 3: Modeling unit operations in the superstructure
The cornerstone of mathematical optimization is the development of a 
mathematical model. The mathematical model is built based on the super￾structure developed in the previous step. Here, a series of equations and 20 Optimization for Energy Systems and Supply Chains
inequalities are formulated to represent the behavior of the unit operations 
shown in the superstructure. These equations represent the relationships 
between the inputs and the outputs of a given unit operation, production flows, 
and costs. In addition, these equations contain variables and parameters.
Variables are quantities assumed to vary during calculations. In other 
words, variables are unknowns that will be varied and determined upon 
optimization to determine the “best” performance for a given system. For 
example, if we are interested in knowing what the optimal capacity would 
be for a given energy system, the capacity is deemed as the variable. It is 
worth noting that the number of variables in the model determines the com￾putational time required to find solutions. Thus, there are several strategies 
that can be used to reduce the complexity of models:
• Reduce the number of variables by replacing them with fixed parameters
• Set boundaries or ranges for each variable to reduce complexity
• Decompose the model into several parts, i.e., solving smaller-sized 
models in series instead of a large-sized one
Aside from the number of variables, the nature of the model can signifi￾cantly impact its computational time. For instance, models could be lin￾ear, non-linear, mixed-integer linear, or mixed-integer non-linear in nature. 
Linear models contain equations that express a linear relationship between 
its input and output. These equations are often simplified correlations that 
can be solved in quick durations but lack rigor. Non-linear models are usu￾ally deemed more accurate models than their linear counterparts. This is 
because most real-life applications exhibit non-linear behaviors. However, 
the downside of non-linear models is that they require longer solving times 
and may require more labor-intensive algorithms to generate solutions. 
Many researchers have developed techniques to linearize non-linear equa￾tions in the past, but this chapter will not cover this. Nevertheless, the deci￾sion to model unit operations in an energy system highly depends on the 
modeler’s accuracy and computational speed preference.
Parameters, on the other hand, are fixed coefficients. Fixed coefficients 
can come in the form of conversion factors, emission factors, are even cost 
factors, to name a few. However, these coefficients very much depend on 
what are the elements we wish to keep constant to allow other elements to 
be included as variables.
Mathematical models can also be categorized into deterministic or non￾deterministic models. Deterministic models are essentially models that 
assume a steady-state condition. In other words, it assumes that the data 
collected as parameters are fixed and do not change based on time or sce￾nario. Meanwhile, non-deterministic models may contain parameters that 
are uncertain or vary based on probability. The modeling approach would 
highly depend on whether the decision-maker is keen to optimize an energy 
system based on a steady-state scenario or under uncertainty. As this book 
is catered for beginners in the field, the focus of this chapter will be on 
deterministic models.Optimization of Energy Systems and Supply Chains 21
Regardless of the nature and category of a mathematical model, it can 
be formulated and built on various commercial optimization software 
platforms. The choice of software may depend on preference, pricing, fea￾tures, user-friendliness, computing requirements, and built-in algorithms. 
Examples of commercial software include (but are not limited to) Microsoft 
Excel Solver, GAMS, LINGO, AIMMS, and MATLAB. In addition, soft￾ware such as process-graph or p-graph possesses built-in features that 
enable users to generate and optimize superstructures simultaneously.
Before choosing software, we need to know how we could write equa￾tions for a mathematical model. This is covered in Section 2.3, where an 
illustrative example illustrates the step-by-step procedure to develop a math￾ematical model. However, it is unlikely for publications in PSE research to 
present equations in the format shown in Section 2.3. In fact, they often (if 
not always) use generalized mathematical equations equipped with symbols 
and notations to represent the superstructure mathematically. Examples of 
these can be found in papers (Andiappan et al., 2014; Leong et al., 2019; 
Tay et al., 2011). The purpose of these generalized equations is to provide 
a generic framework for other researchers to use as a guide in the future, 
allowing them to replicate the concept in their work. Nevertheless, begin￾ners need to understand what these symbols and notations mean before 
being able to follow them as a guide. Chapter 3 will expand on this further 
by describing recommended ways to write generalized equations and best 
practices when doing so.
Step 4: Setting objective function and constraints
Once the behavior and performance of each unit operation in the super￾structure are mathematically modeled, additional constraints must be set. 
These constraints can be in the form of equations or inequalities (as shown 
below).
h x( ) = 0 E quality Constraint
g x( ) ≤ 0 Inequality Constraint
Typical examples of such constraints may include (but are not limited to) 
a target on product demands, a limit on available raw materials, and fea￾sible operating ranges for a unit operation. These constraints define the rela￾tionship between the decision variables, whose values are determined by 
optimizing (e.g., minimizing or maximizing) the model according to a spe￾cific optimization objective (Baños et al., 2011; Edgar et al., 2001; Floudas, 
1995). The optimization objective here is known as the objective function. 
If the objective function is exclusively formulated for a single criterion (e.g., 
economic performance), it is typically considered single-objective optimi￾zation (Savic, 2002). Other examples of objective functions may include 
maximizing yield, maximizing energy efficiency, maximizing profit, mini￾mizing the number of processing steps, minimizing cost, and minimizing 
environmental impact.22 Optimization for Energy Systems and Supply Chains
By default, all models are optimized based on a single objective. In other 
words, each mathematical model can only consider one objective or objec￾tive function at a time. This indicates that mathematical models cannot 
simultaneously have two or more objective functions. Several approaches 
have been developed to consider two or more objectives within a single 
model to address this. These approaches fall under the category known as 
multi-objective optimization. Some examples of multi-objective optimi￾zation approaches include Pareto optimization, weight-sum, ε-constraint, 
fuzzy optimization, and evolutionary multi-objective algorithms. For fur￾ther information on the basics behind multi-objective optimization, readers 
are directed to Andiappan (2017).
Step 5: Optimization and generating solutions
When the objective function is set, the final step is to solve the model 
and generate solutions. The solving of a mathematical model here refers 
to optimization. As mentioned earlier, optimization is done by adjusting 
the variables in a model to determine the “best” performance or solutions. 
To solve a mathematical model, several algorithms are available depending 
on the mathematical nature of the model (e.g., linear, mixed-integer linear, 
non-linear, and mixed-integer non-linear). In most commercial optimiza￾tion software, there are a set of algorithms working in the background to 
solve the models that we developed and generate solutions accordingly. 
Algorithms are essentially a sequence of instructions and procedures used 
to solve mathematical problems. For more details on algorithms, readers are 
directed to papers such as Andiappan (2017) for further reading.
The solution of the optimization would represent the optimal configura￾tion of the energy system. The optimal system, in this sense, may refer to 
the unit operations with the highest yield, the highest energy efficiency, the 
simplest, the minimum cost, the maximum profit, and so on, depending on 
the objective function set in Step 4. Since mathematical optimization opti￾mizes a superstructure and reduces it to the optimal set of unit operations, 
it explicitly determines the topology of energy systems. The following sec￾tion provides an illustrative example to demonstrate the steps described in 
Section 2.3.
2.3 ILLUSTRATIVE EXAMPLE
In this illustrative example, let us consider an energy system that is expected to either 
utilize biomass or palm oil mill effluent and eventually produce final outputs such as 
electricity, medium pressure steam, and methanol. This example is desired to deter￾mine the optimal energy system configuration with the highest profit margin. The 
first step to developing a mathematical model is to put together a superstructure.
Step 1: Developing superstructure of possible connections for unit operations
 i. Enumerating possible raw materials, final products, and unit operations
 As mentioned previously, this step lists out the raw materials and desired 
final products. For this example, biomass and palm oil mill effluent are Optimization of Energy Systems and Supply Chains 23
listed as raw materials (Figure 2.4). Meanwhile, electricity, medium 
pressure steam, and methanol are included as the final products in the 
superstructure (Figure 2.4).
 The unit operations that utilize biomass and palm oil mill effluent are 
included in the superstructure. For example, a pyrolysis unit is added to 
use biomass, while the anaerobic digestion unit is included for the palm 
oil mill effluent (POME) (Figure 2.5). As for the final products, steam 
turbine and methanol synthesis units are added to the superstructure 
(Figure 2.5).
 ii. Branching and matching connections
FIGURE 2.4 Raw materials and final products.
FIGURE 2.5 Inclusion of unit operations to utilize raw materials and to produce final 
products.24 Optimization for Energy Systems and Supply Chains
 
 iii. Interception
FIGURE 2.6 Forward and backward branching.
FIGURE 2.7 Inclusion of matches.
FIGURE 2.8 Including of interceptions.Optimization of Energy Systems and Supply Chains 25
 
Step 2: Collecting data for unit operations specified in the superstructure
Once the superstructure has been finalized, data must be collected 
for each unit operation. This may include data related to performance, 
cost, and material prices. Such data can be compiled from a variety of 
sources. For this example, data was obtained from journal papers and 
textbooks. Tables 2.1 and 2.2 show the data collected for this example. 
These data will be used in Step 3 as part of the equation development 
process.
Step 3: Modeling unit operations in the superstructure
Based on Steps 1 and 2, a mathematical model can now be formulated in 
modeling software, as introduced in the previous section. The equations for 
the model were developed and coded in commercial optimization software, 
i.e., LINGO v18*. The following provides an overview of how each equation 
was written for this example. This overview offers a guide based on each 
section of the superstructure developed in Step 1.
We start with the pyrolysis unit shown in Figure 2.9. The left side of 
Figure 2.9 shows the labels given to each flow. F_Biomass, F_SG_PYRO, 
and F_M_PYRO represent the flows to and from the pyrolysis unit. The 
right side of Figure 2.9 shows the equations used to represent the conversion 
occurring in the pyrolysis unit. C_PYRO_SG and C_PYRO_M are conver￾sion factors for syngas and methane, respectively.
Similarly, this is done for the anaerobic digestion unit, as shown in 
Figure 2.10.
Meanwhile, Figure 2.11 shows how the distribution and summation of 
methane flow are represented in equations.
Next, Figure 2.12 shows the equations formulated for the boiler and the 
steam reformer conversion.
The summation of the syngas flow is shown in Figure 2.13. This includes 
the syngas produced at the pyrolysis unit and the steam reformer. The syn￾gas is then fed into the methanol synthesis unit, where Figure 2.14 shows the 
equations representing its conversion to methanol.26 Optimization for Energy Systems and Supply Chains
Following Figures 2.9–2.14, the cost equations were written based on the 
flow variables of each unit operation. This is shown in Figure 2.15.
In addition, the prices for raw materials and products were included 
in the model to determine the economic performance of the synthesized 
TABLE 2.2
Compilation of Pricing Data for Raw Materials and Products
Raw Material or Product Material Pricing Factor (Cost/Material)
Biomass 0.0046 $/kg 
(Andiappan et al., 2016)
POME –
Electricity 0.0667 $/kWh
(Andiappan et al., 2016)
Medium-pressure steam 0.046 $/kg
(Andiappan et al., 2016)
Methanol 0.805 $/kg
(Andiappan et al., 2016)
TABLE 2.1
Compilation of Performance and Cost Data for Each Unit Operation
Collected Data
Annualized 
Unit CAPEX Factor CAPEX Factora
Operation Conversion (Output/Input) (Cost/Input) (Cost/Input.year)
Pyrolysis 0.155 kg Syngas/kg Biomass, 162.8 $/ (kg/h Biomass) 21.2 $/ (kg/h 
0.005 kg Methane/kg Biomass (Sadhukhan et al., 2014) Biomass).y
(Hanif et al., 2016)
Anaerobic 0.20 kg Methane/kg POME 35.8 $/ (kg/h POME) 4.7 $/ (kg/h 
digestion (Ng et al., 2013) (Sadhukhan et al., 2014) POME).y
Boiler 5.5 kg High-pressure steam/kg Methane 87.5 $/ (kg/h High- 11.4 $/ (kg/h 
(Andiappan et al., 2014) pressure steam) High-pressure 
(Foong et al., 2020) steam).y
Steam 0.90 kg Syngas/kg Methane 56.7 $/ (kg/h Methane) 7.4 $/ (kg/h 
reformer (Basye and Swaminathan, 1997) (Steinberg, 1989) Methane).y
Steam turbine 0.0194 kWh Electricity/kg High- 6100 $/ kW Electricity 793 $/ (kW 
pressure steam, (Andiappan et al., 2014) Electricity).y
1 High-pressure steam/kg Medium￾pressure steam
(Andiappan et al., 2014)
Methanol 0.937 kg Methanol/kg Syngas 40 $/ (kg/h Methanol) 5.2 $/ (kg/h 
synthesis (Andiappan et al., 2016) (Sadhukhan et al., 2014) Methanol).y
a CAPEX factors are annualized by multiplying CAPEX factors with an assumed annualizing factor of 
0.13/year.Optimization of Energy Systems and Supply Chains 27
FIGURE 2.9 Equations for pyrolysis unit.
FIGURE 2.10 Equation for anaerobic digestion unit.
FIGURE 2.11 Equations for distribution and summation of methane flow.
FIGURE 2.12 Equations for boiler and steam reformer units.28 Optimization for Energy Systems and Supply Chains
FIGURE 2.13 Equation for summation of syngas.
FIGURE 2.14 Equations for steam turbine and methanol synthesis units.
FIGURE 2.15 Cost equations for all units.Optimization of Energy Systems and Supply Chains 29
system. Economic equations that calculate the expenditure for materials and 
total revenue in the energy system shall be included. This will be shown in 
the next step.
Step 4: Setting objective function and constraints
The objective function of this illustrative example is to maximize the 
system’s profit margin. We can determine the optimal configuration with 
maximum profit margin by doing this. Meanwhile, additional constraints 
such as the limit of available feed for biomass and POME were included in 
the model. These constraints function as boundaries for the flow rate that 
could be utilized in the unit operations. This is shown in Figure 2.16.
The values for these limits can be seen in the complete list of equations 
below. These equations are coded in the commercial optimization soft￾ware, i.e., LINGO Version 18. A demo version of the LINGO software can 
be downloaded for free from www.lindo.com. The complete code used in 
LINGO is as follows:
!Model;
!Objective Function;
Max = Margin;
!Conversion Data;
C_PYRO_SG = 0.155;
C_PYRO_M = 0.005;
C_AD_M = 0.20;
C_Boiler_HPS = 5.5;
C_SR_SG = 0.90;
C_MSYN_MEOH = 0.937;
C_HST_MPS = 1;
C_HST_Elec = 0.0194;
!Raw Material Availability;
F_Biomass_av = 100000;
F_POME_av = 100000;
!Cost Data;
CF_PYRO = 21.2; !162.82;
CF_AD = 4.7; !0.018 ;
CF_Boiler = 11.4; !87.5 ;
CF_SR = 7.4; !150 ;
FIGURE 2.16 Constraints included for feed flow.30 Optimization for Energy Systems and Supply Chains
CF_HST = 793; !610 ;
CF_MSYN = 40; !172.57 ;
!Pricing Data;
P_MPS = 0.046;
P_MEOH = 0.805; 
P_Elec = 0.0667;
P_Biomass = 0.0046;
!Constraints;
F_Biomass_av >= F_Biomass;
F_POME_av >= F_POME;
!Equations;
!Conversion in Pyrolysis;
F_SG_PYRO = F_Biomass * C_PYRO_SG;
F_M_PYRO = F_Biomass * C_PYRO_M;
!Conversion in Anaerobic Digestion;
F_M_AD = F_POME * C_AD_M;
!Distribution of Methane from Pyrolysis;
F_M_PYRO = F_M_PYRO_Boiler + F_M_PYRO_SR;
!Distribution of Methane from Anaerobic Digestion;
F_M_AD = F_M_AD_Boiler + F_M_AD_SR;
!Mixing of Methane at Boiler and Steam Reformer;
F_M_Boiler = F_M_PYRO_Boiler + F_M_AD_Boiler;
F_M_SR = F_M_PYRO_SR + F_M_AD_SR;
!Mixing of Syngas at MEOH Synthesis;
F_SG_MSYN = F_SG_PYRO + F_SG_SR;
!Conversion at Boiler and Steam Reformer;
F_HPS = F_M_Boiler * C_Boiler_HPS;
F_SG_SR = F_M_SR * C_SR_SG; 
!Conversion to MEOH;
F_MEOH = F_SG_MSYN * C_MSYN_MEOH;
!Conversion at Steam Turbine;
F_Elec = F_HPS * C_HST_Elec;
F_MPS = F_HPS * C_HST_MPS;
!Cost Equations;
!Pyrolysis;
Cost_PYRO = F_Biomass * CF_PYRO;
!Anaerobic Digestion;
Cost_AD = F_POME * CF_AD;
!Boiler;
Cost_Boiler = F_MPS * CF_Boiler;
!Steam Reformer;
Cost_SR = F_M_SR * CF_SR;
!High Pres Steam Turbine;
Cost_HST = F_Elec * CF_HST;Optimization of Energy Systems and Supply Chains 31
!Methanol Synthesis;
Cost_MSYN = F_MEOH * CF_MSYN;
!Profit and Expenditure;
TotalAnnualizedCost = Cost_PYRO + Cost_AD + Cost_Boiler +
Cost_SR + Cost_HST + Cost_MSYN;
TotalRev = (F_Elec * P_Elec + F_MPS * P_MPS + F_MEOH * P_MEOH) 
* AOT;
TotalExp = (F_Biomass * P_Biomass) * AOT;
!Annual Operating Time;
AOT = 8000;
Margin = TotalRev - TotalExp - TotalAnnualizedCost;
@free(Margin);
The last four lines of the code above indicate the equations that calculate 
the total cost of equipment, total revenue from products, and total mate￾rial expenditure. The final equation indicates the equation to determine the 
profit margin by subtracting the total cost of equipment and the total mate￾rial expenditure from the total revenue from products.
Step 5: Solving model and generating solutions
After adding the equations into LINGO, the model can be solved to gen￾erate an optimal solution. The results generated in LINGO are shown as 
follows:
Global optimal solution found.
 Objective value: 0.1971697E+09
 Infeasibilities: 0.000000
 Total solver iterations: 0
 Elapsed runtime seconds: 0.17
 Model Class: LP
 Total variables: 27
 Nonlinear variables: 0
 Integer variables: 0
 Total constraints: 26
 Nonlinear constraints: 0
 Total nonzeros: 63
 Nonlinear nonzeros: 0
 Variable Value
 MARGIN 0.1971697E+09
 C_PYRO_SG 0.1550000
 C_PYRO_M 0.5000000E-02
 C_AD_M 0.2000000
 C_BOILER_HPS 5.500000
 C_SR_SG 0.9000000
 
 
 
 
 
 32 Optimization for Energy Systems and Supply Chains
 C_MSYN_MEOH 0.9370000
 C_HST_MPS 1.000000
 C_HST_ELEC 0.1940000E-01
 F_BIOMASS_AV 100000.0
 F_POME_AV 100000.0
 CF_PYRO 21.20000
 CF_AD 4.700000
 CF_BOILER 11.40000
 CF_SR 7.400000
 CF_HST 793.0000
 CF_MSYN 40.00000
 P_MPS 0.4600000E-01
 P_MEOH 0.8050000
 P_ELEC 0.6670000E-01
 P_BIOMASS 0.4600000E-02
 F_BIOMASS 100000.0
 F_POME 100000.0
 F_SG_PYRO 15500.00
 F_M_PYRO 500.0000
 F_M_AD 20000.00
 F_M_PYRO_BOILER 0.000000
 F_M_PYRO_SR 500.0000
 F_M_AD_BOILER 0.000000
 F_M_AD_SR 20000.00
 F_M_BOILER 0.000000
 F_M_SR 20500.00
 F_SG_MSYN 33950.00
 F_SG_SR 18450.00
 F_HPS 0.000000
 F_MEOH 31811.15
 F_ELEC 0.000000
 F_MPS 0.000000
 COST_PYRO 2120000.
 COST_AD 470000.0
 COST_BOILER 0.000000
 COST_SR 151700.0
 COST_HST 0.000000
 COST_MSYN 1272446.
TOTALANNUALIZEDCOST 4014146.
 TOTALREV 0.2048638E+09
 AOT 8000.000
 TOTALEXP 3680000.
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
The results above suggest that the optimal solution had a maximum profit margin of 
$205 million/y. Figure 2.17 summarizes the optimal flows for each unit operation in 
the optimum solution. For this case, the biomass and POME were fully utilized. This 
required both pyrolysis and anaerobic digestion units to be selected. However, all 
methane produced by the pyrolysis and anaerobic digestion units was fed only to the 
steam reformer. This means that the boiler and steam turbine units were not chosen. Optimization of Energy Systems and Supply Chains 33
The methane entering the steam reformer was converted to syngas and added to the 
syngas from pyrolysis for further processing in the methanol synthesis unit. Lastly, 
methanol is produced as the final product in the methanol synthesis unit.
Apart from presenting the optimal solution, Figure 2.17 also highlights that the 
boiler and steam turbine route was not chosen. This gives us an insight that such a 
route does not offer a higher profit margin compared to the selected system. However, 
we may repeat this step with a different unit price for biomass to conduct a sensitivity 
analysis and understand the impact of its price on the optimal solution. By varying 
the biomass price, it was found that only when the price of biomass is lower than 0.12 
$/kg, the pyrolysis will be chosen alongside the anaerobic digester. In other words, 
the pyrolysis unit will not be favorable when the biomass price is 0.12 $/kg or higher. 
These insights are very useful for practical analysis and planning. Further analysis 
can be done if other aspects such as energy consumption, and emission are consid￾ered in the model.
The example here can also be extended to consider supply chain elements. In 
Chapter 1, we learned that energy resources can be transported from one stage of the 
energy supply chain to another stage using different modes of transportation. These 
transportation modes have unique costs based on distance. Let us revisit Figure 2.16. 
The equations and representations in Figure 2.16 can be updated to consider the 
sourcing and transportation of biomass to the energy system. Figure 2.18 shows two 
possible sources at different locations (i.e., A and B) and distance from the energy 
system. The first two equations in Figure 2.18 represent the limits in which bio￾mass can be sourced from location A and B, respectively. F_Biomass_av_A and F_
Biomass_av_A are the amount of available biomass at locations A and B. The third 
equation in Figure 2.18 expresses the total amount of biomass sourced from A and 
B that will enter the pyrolysis unit. From here, the transportation elements can be 
introduced. The cost factors CTA and CTB in Figure 2.18 indicate the cost required 
to transport a kg of biomass per unit distance. CTA and CTB are then included 
alongside the distances in the fourth equation in Figure 2.18 to determine total trans￾portation cost.
The LINGO code shown earlier is updated with the equations in Figure 2.18. The 
following code shows the updated LINGO code.
FIGURE 2.17 Optimal solution for an illustrative example.34 Optimization for Energy Systems and Supply Chains
!Model;
!Objective Function;
Max = Margin;
!Conversion Data;
C_PYRO_SG = 0.155;
C_PYRO_M = 0.005;
C_AD_M = 0.20;
C_Boiler_HPS = 5.5;
C_SR_SG = 0.90;
C_MSYN_MEOH = 0.937;
C_HST_MPS = 1;
C_HST_Elec = 0.0194;
!Raw Material Availability;
F_Biomass_av_A = 100000;
F_Biomass_av_B = 100000;
F_POME_av = 100000;
!Cost Data;
CF_PYRO = 21.2; 
CF_AD = 4.7; 
CF_Boiler = 11.4; 
CF_SR = 7.4; 
CF_HST = 793; 
CF_MSYN = 40; 
!Cost of Transporting Biomass; 
CTA = 0.06;
CTB = 0.02;
!Distance in km;
DA = 2;
DB = 4;
!Pricing Data;
FIGURE 2.18 Equations for transportation cost.Optimization of Energy Systems and Supply Chains 35
P_MPS = 0.046;
P_MEOH = 0.805; 
P_Elec = 0.0667;
P_Biomass = 0.0046;
!Constraints;
F_Biomass_av_A >= F_Biomass_A;
F_Biomass_av_B >= F_Biomass_B;
F_POME_av >= F_POME;
F_Biomass_A + F_Biomass_B = F_Biomass;
!Equations;
!Conversion in Pyrolysis;
F_SG_PYRO = F_Biomass * C_PYRO_SG;
F_M_PYRO = F_Biomass * C_PYRO_M;
!Conversion in Anaerobic Digestion;
F_M_AD = F_POME * C_AD_M;
!Distribution of Methane from Pyrolysis;
F_M_PYRO = F_M_PYRO_Boiler + F_M_PYRO_SR;
!Distribution of Methane from Anaerobic Digestion;
F_M_AD = F_M_AD_Boiler + F_M_AD_SR;
!Mixing of Methane at Boiler and Steam Reformer;
F_M_Boiler = F_M_PYRO_Boiler + F_M_AD_Boiler;
F_M_SR = F_M_PYRO_SR + F_M_AD_SR;
!Mixing of Syngas at MEOH Synthesis;
F_SG_MSYN = F_SG_PYRO + F_SG_SR;
!Conversion at Boiler and Steam Reformer;
F_HPS = F_M_Boiler * C_Boiler_HPS;
F_SG_SR = F_M_SR * C_SR_SG; 
!Conversion to MEOH;
F_MEOH = F_SG_MSYN * C_MSYN_MEOH;
!Conversion at Steam Turbine;
F_Elec = F_HPS * C_HST_Elec;
F_MPS = F_HPS * C_HST_MPS;
!Cost Equations;
!Pyrolysis;
Cost_PYRO = F_Biomass * CF_PYRO;
!Anaerobic Digestion;
Cost_AD = F_POME * CF_AD;
!Boiler;
Cost_Boiler = F_MPS * CF_Boiler;
!Steam Reformer;
Cost_SR = F_M_SR * CF_SR;
!High Pres Steam Turbine;
Cost_HST = F_Elec * CF_HST;36 Optimization for Energy Systems and Supply Chains
!Methanol Synthesis;
Cost_MSYN = F_MEOH * CF_MSYN;
!Profit and Expenditure;
TotalAnnualizedCost = Cost_PYRO + Cost_AD + Cost_Boiler +
Cost_SR + Cost_HST + Cost_MSYN;
TotalRev = (F_Elec * P_Elec + F_MPS * P_MPS + F_MEOH * P_MEOH) 
* AOT;
TotalExp = (F_Biomass * P_Biomass) * AOT;
TotalTransportCost = (F_Biomass_A * DA * CTA + F_Biomass_B *
DB * CTB) * AOT;
!Annual Operating Time;
AOT = 8000;
Margin = TotalRev - TotalExp - TotalAnnualizedCost 
- TotalTransportCost;
@free(Margin);
The model is then solved, and the results are shown below.
Global optimal solution found.
 Objective value: 0.1331697E+09
 Infeasibilities: 0.000000
 Total solver iterations: 0
 Elapsed runtime seconds: 0.17
 Model Class: LP
 Total variables: 30
 Nonlinear variables: 0
 Integer variables: 0
 Total constraints: 29
 Nonlinear constraints: 0
 Total nonzeros: 71
 Nonlinear nonzeros: 0
 Variable Value
 MARGIN 0.1331697E+09
 C_PYRO_SG 0.1550000
 C_PYRO_M 0.5000000E-02
 C_AD_M 0.2000000
 C_BOILER_HPS 5.500000
 C_SR_SG 0.9000000
 C_MSYN_MEOH 0.9370000
 C_HST_MPS 1.000000
 C_HST_ELEC 0.1940000E-01
 F_BIOMASS_AV_A 100000.0
 
 
 
 
 
 
 
 
 
 Optimization of Energy Systems and Supply Chains 37
 F_BIOMASS_AV_B 100000.0
 F_POME_AV 100000.0
 CF_PYRO 21.20000
 CF_AD 4.700000
 CF_BOILER 11.40000
 CF_SR 7.400000
 CF_HST 793.0000
 CF_MSYN 40.00000
 CTA 0.6000000E-01
 CTB 0.2000000E-01
 DA 2.000000
 DB 4.000000
 P_MPS 0.4600000E-01
 P_MEOH 0.8050000
 P_ELEC 0.6670000E-01
 P_BIOMASS 0.4600000E-02
 F_BIOMASS_A 0.000000
 F_BIOMASS_B 100000.0
 F_POME 100000.0
 F_BIOMASS 100000.0
 F_SG_PYRO 15500.00
 F_M_PYRO 500.0000
 F_M_AD 20000.00
 F_M_PYRO_BOILER 0.000000
 F_M_PYRO_SR 500.0000
 F_M_AD_BOILER 0.000000
 F_M_AD_SR 20000.00
 F_M_BOILER 0.000000
 F_M_SR 20500.00
 F_SG_MSYN 33950.00
 F_SG_SR 18450.00
 F_HPS 0.000000
 F_MEOH 31811.15
 F_ELEC 0.000000
 F_MPS 0.000000
 COST_PYRO 2120000.
 COST_AD 470000.0
 COST_BOILER 0.000000
 COST_SR 151700.0
 COST_HST 0.000000
 COST_MSYN 1272446.
 TOTALANNUALIZEDCOST 4014146.
 TOTALREV 0.2048638E+09
 AOT 8000.000
 TOTALEXP 3680000.
 TOTALTRANSPORTCOST 0.6400000E+08
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
Figure 2.19 shows the optimal solution generated from the updated model. As shown, the 
optimal system remained the same for the energy system. However, biomass was sourced 
and transported from location B to the energy system. This is because the total cost of 
transportation for this route was cheaper compared to the alternative in location A.38 Optimization for Energy Systems and Supply Chains
For this case, it is assumed that the cost of factors CTA and CTB apply to one 
type of transport mode. If multiple transport options need to be considered, addi￾tional nodes can be included in the superstructure. Consider a case where trucks and 
pipelines are possible transport options. In this case, one node must be assigned to 
the truck node from source to the destination and another node for pipeline. These 
additional nodes can then be modeled using the same concept described above.
The above extension serves as an entry-level example on the concept of including 
supply chain considerations. It must be noted that supply chains can grow in com￾plexity depending on the aspects considered in the model. Nevertheless, the concept 
in this chapter can be expanded upon and applied to other transport modes such as 
grid connections and pipelines.
2.4 CONCLUSION
This chapter provided an overview of the steps to develop a mathematical model and 
optimize energy systems. An illustrative example was also presented to provide a 
detailed guide on how a mathematical model can be developed and used to develop 
insights. It is worth noting that the model developed for the example was simplified 
for demonstration purposes. Readers are welcome to add more considerations such as 
energy consumption and emission, into the model to develop further insights.
FURTHER READING
Readers are encouraged to refer to Pham and El-Halwagi (2012) for examples on 
development superstructures. In addition to this, Ünal et al. (2015) provide an over￾view of applications for mathematical optimization in energy systems. Meanwhile, 
the background on linear, non-linear, mixed-integer linear, and mixed-integer non￾linear models can be found in Andiappan (2017). Andiappan (2017) also provides a 
comprehensive review of deterministic and non-deterministic models.
Andiappan, V., 2017. State-of-the-art review of mathematical optimisation approaches for 
synthesis of energy systems. Process Integr. Optim. Sustain. 1, 165–188.
Andiappan, V., Ng, D.K.S., Bandyopadhyay, S., 2014. Synthesis of biomass-based trigenera￾tion systems with uncertainties. Ind. Eng. Chem. Res. 53, 18016–18028.
Andiappan, V., Tan, R.R., Ng, D.K.S., 2016. An optimization-based negotiation framework 
for energy systems in an eco-industrial park. J. Clean. Prod. 129, 496–507.
FIGURE 2.19 Optimal solution for illustrative example with transportation considerations.Optimization of Energy Systems and Supply Chains 39
Baños, R., Manzano-Agugliaro, F., Montoya, F.G., Gil, C., Alcayde, A., Gómez, J., 2011. 
Optimization methods applied to renewable and sustainable energy: A review. Renew. 
Sustain. Energy Rev. 15, 1753–1766.
Basye, L., Swaminathan, S., 1997. Hydrogen Production Costs – A Survey. U.S. Department 
of Energy Office of Scientific and Technical Information, Maryland USA.
Biegler, L.T., Grossmann, I.E., Westerberg, A.W., 1997. Systematic Methods of Chemical 
Process Design. Hoboken, NJ: Prentice Hall PTR.
Edgar, T.F., Himmelblau, D.M., Lasdon, L.S., 2001. Optimization of Chemical Processes. 
Boston, MA: McGraw-Hill.
Floudas, C.A., 1995. Nonlinear and Mixed-Integer Optimization, Handbook of Applied 
Optimization. Cary, NC: Oxford University Press.
Foong, S.Z.Y., Chong, M.F., Ng, D.K.S., 2020. Strategies to promote biogas generation and 
utilisation from palm oil mill effluent. Process Integr. Optim. Sustain. Doi: 10.1007/
s41660-020-00121-y
Grossmann, I.E., Sargent, R.W.H., 1978. Optimum design of chemical plants with uncertain 
parameters. AIChE J. 24, 1021–1028.
Hanif, M.U., Capareda, S.C., Iqbal, H., Arazo, R.O., Baig, M.A., 2016. Effects of pyrolysis 
temperature on product yields and energy recovery from co-feeding of cotton gin trash, 
cow manure, and microalgae: A simulation study. PLoS One 11, 1–11.
Hendry, J.E., Rudd, D.F., Seader, J.D., 1973. Synthesis in the design of chemical processes. 
AIChE J. 19, 1–15.
Leong, H., Leong, H., Foo, D.C.Y., Ng, L.Y., Andiappan, V., 2019. Hybrid approach for car￾bon-constrained planning of bioenergy supply chain network. Sustain. Prod. Consum. 
18. Doi: 10.1016/j.spc.2019.02.011
Liu, P., Georgiadis, M.C., Pistikopoulos, E.N., 2011. Advances in energy systems engineering. 
Ind. Eng. Chem. Res. 50, 4915–4926.
Mencarelli, L., Chen, Q., Pagot, A., Grossmann, I.E., 2020. A review on superstructure opti￾mization approaches in process system engineering. Comput. Chem. Eng. 136, 106808.
Ng, R.T.L., Ng, D.K.S., Tan, R.R., 2013. Systematic approach for synthesis of integrated palm 
oil processing complex. Part 2: Multiple owners. Ind. Eng. Chem. Res. 52, 10221–10235.
Pham, V., El-Halwagi, M., 2012. Process synthesis and optimization of biorefinery configura￾tions. AIChE J. 58, 1212–1221.
Sadhukhan, J., Kok Siew, N., Martinez-Hernandez, E., 2014. Biorefineries and Chemical 
Processes: Design, Integration and Sustainability Analysis, 1st ed. Wiley, Sussex.
Savic, D., 2002. Single-objective vs. multiobjective optimisation for integrated decision sup￾port, in: International Congress on Environmental Modelling and Software. International 
Environmental Modelling & Software Society Lugano, Switzerland, p. 119.
Steinberg, M., 1989. Modern and prospective technologies for hydrogen production from fos￾sil fuels. Int. J. Hydrogen Energy 14, 797–820.
Tay, D.H.S., Ng, D.K.S., Sammons, N.E., Eden, M.R., 2011. Fuzzy optimization approach 
for the synthesis of a sustainable integrated biorefinery. Ind. Eng. Chem. Res. 50, 
1652–1665.
Ünal, A.N., Ercan, S., Kayakutlu, G., 2015. Optimisation studies on tri‐generation a review 
(1).pdf. Int. J. Ener 39, 1311–1334.
Westerberg, A.W., 1991. Process engineering, perspectives in chemical engineering, 
research and education, in: Clark K. Colton (ed.) Advances in Chemical Engineering. 
Amsterdam: Elsevier, pp. 499–523.
Yeomans, H., Grossmann, I.E., 1999. A systematic modeling framework of superstructure 
optimization in process synthesis. Comput. Chem. Eng. 23, 709–731.41
3 Formulating Generalized 
Mathematical Models
Viknesh Andiappan
Swinburne University of Technology
Denny K. S. Ng
Heriot-Watt University Malaysia
Santanu Bandyopadhyay
Indian Institute of Technology Bombay
3.1 INTRODUCTION
Generic mathematical equations have several components: index, labels, variable/
parameter symbols, and notations. An index represents a set of elements. The ele￾ments here may include input materials, intermediate materials, final outputs, tech￾nologies, and emission. For example, suppose an index i may be used to represent the 
input material in a system. In that case, i= 1 may refer to a certain input material (i.e., 
biomass), i= 2 may be a different input material (i.e., coal), and this can go up to i= I 
input materials. This applies to intermediates and outputs, where other indices such 
as k and p are used, respectively. Similarly, indices can be used to describe technolo￾gies or process units too. For example, index j can be used below to represent tech￾nologies at the first layer. The following layer of technologies is represented by index 
j’. This is to indicate the difference between the first and second layers. However, 
more layers can be added depending on one’s preference and the needs for the model. 
More indices must be assigned to every additional layer considered in such instances.
CONTENTS
3.1 Introduction .................................................................................................... 41
3.2 Recommended Practices ................................................................................. 42
3.3 General Representations and Equations ......................................................... 43
3.3.1 Conversion .......................................................................................... 43
3.3.2 Branching Points .................................................................................44
3.3.3 Summing Points .................................................................................. 45
3.3.4 Other Aspects .....................................................................................46
3.4 Conclusion ...................................................................................................... 47
Further Reading ....................................................................................................... 47
References ................................................................................................................48
DOI: 10.1201/9781003240228-442 Optimization for Energy Systems and Supply Chains
Apart from indices, mathematical equations consist of variables and parameters. 
As mentioned in Chapter 2, variables are unknowns that need to be varied and deter￾mined, while parameters are fixed known coefficients. Lastly, mathematical equa￾tions have notations that express various mathematical operations. It is common to 
see PSE research present notations such as ∑, ∈ and ∀. The notation “∑” represents 
the summation of elements while “∈” is used to describe the subset of elements. The 
“∀” symbol reads as “for all”. For example, if the notation is written as “∀ i ∈ N” 
after an equation, it would mean that the equation is applicable “for all values of i
belonging to set N”. In some of the modeling equations, you may see “.” between 
variables or parameters. Such a symbol represents “multiply”. A more detailed list 
of mathematical notations can be found in the following source (https://www.rapid￾tables.com/math/symbols/Basic_Math_Symbols.html). For this chapter, we will 
examine those that are typically used in the context of PSE research.
3.2 RECOMMENDED PRACTICES
Before writing general equations, it is important to take note of some recommended 
practices. These recommended practices offer a systematic way to write these equa￾tions. This, in turn, provides a structured way for others to read and understand the 
role that each equation plays in the mathematical model. First, it is recommended 
that mathematical equations be written in the following format shown in Figures 3.1 
and 3.2.
FIGURE 3.2 Recommended format for presenting variables in mathematical equations.
FIGURE 3.1 Recommended format for presenting parameters in mathematical equations.Formulating Generalized Mathematical Models 43
The general rule is to express anything that is fixed or constant (parameters) as 
non-italic, while variable (those that vary) is presented in italic form. As shown in 
Figure 3.1, “F” is an example of a symbol used to indicate a material’s flow rate. In 
this case, “F” is considered a constant parameter because it is non-italic. Labels or 
names are recommended to be placed above as a superscript and made non-italic. 
Labels or names are used to provide non-mathematical information such as “Total”, 
“New”, and “Available”. These are information that are not mathematical in nature 
but provide distinguishing information. We will see this being applied later in Section 
3.4.4. Meanwhile, the index is expected to be placed in italic form since it can vary 
depending on its set size.
Figure 3.2 shows how variables can be presented in mathematical equations. Most 
features are similar to Figure 3.1 except for the format in “F”. In the case where “F” 
is a variable, it is recommended to write it in italic form.
The recommendations shown in Figures 3.1 and 3.2 provide a solid start to devel￾oping equations. The following section describes various examples of how general 
equations can be developed.
3.3 GENERAL REPRESENTATIONS AND EQUATIONS
The relationship between inputs and outputs can be represented using simple block 
diagrams. The figures below show different block representations readers may come 
across. These block diagrams may come in handy when developing general equations.
3.3.1 Conversion
Figure 3.3 shows a representation of a conversion step, where process j converts input 
i into several outputs p. A good example of this is the pyrolysis unit in Section 2.3, 
where biomass flows into the pyrolysis unit to produce syngas and methane.
The “raw” equations are written as follows:
F G
FIGURE 3.3 General conversion process.44 Optimization for Energy Systems and Supply Chains
F G
In Eq. (3.1), Fj, p represents the flow rate of the output p in technology j. The output 
is determined by multiplying the input flow rate Gj, i with the fixed conversion coef￾ficient C i, j, p. This takes the shape of a typical conversion process of input i to output 
p via technology j. It is important to note that Eq. (3.1) is written specifically for 
product p =1. Equation (3.2) presents the equation for product p =2, while Eq. (3.3) 
describes the flow rate for p = P. In short, Eqs. (3.1)–(3.3) is done for all p. We can see 
that multiple equations must be written to represent its operation for just this section 
alone. This may be tedious to present to a larger audience; hence a more generalized 
form needs to be considered.
The generic equation for this will take the form of:
l
F G j p, , = ⋅ ∑ i jC j i j, ,p ∀ ∀p (3.4)
i=1
The “∀ ∀j p” indicates that this Eq. (3.4) must be applied for all technology j and 
output p. To verify if the equation is written correctly, it is good practice to check 
the consistency of indices on both sides. The general rule is to ensure that both sides 
have the same “active” indices. On the left side of Eq. (3.4), indices j and p are active. 
The same applies to the right side of Eq. (3.4). But what about the index i? Index i

∑
l  is no longer active due to the summation with respect to i ie., . The “i =1” 
 i=1  l
and “I” in the ∑ symbol mean the summation is done for elements from i =1 to 
i=1
i =I. Equation (3.1) shows a relevant example where terms from i =1 until i = I are 
summed. As a result, the index i is not factored as an active index. Since both sides of 
Eq. (3.4) have the same active indices, we can then proceed to include “∀ ∀j p” based 
on those active indices.
It is also worth noting that the concept above is not restricted to only conversion 
processes. Separation or purification processes can also follow this concept, but the 
conversion coefficient is modified to become a separation coefficient. The separation 
coefficient represents the efficiency of separation.
3.3.2 branCHing Points
Branching points are points where materials are split and can be distributed to dif￾ferent places (Figure 3.4). In the case below, output p is produced by technology j
in the first layer and can be distributed to the second layer where technologies j’ are 
available. In theory, the actual equation would be written as follows:
F F q p = = 1, 1 1 = + q j = = , 1, 1 p q = = F F 1, j p = = 2, 1 1 + +  q j = = , , J p=1 (3.5)Formulating Generalized Mathematical Models 45
 However, the general form would like Eq. (3.6):
J
F F q p, , = ⋅ ∑ q j,p ∀ ∀q p (3.6)
j=1
At times, Eq. (3.6) can take the form of an inequality instead. However, inequalities 
can be included in cases where the consumption of the entire flow is not necessary. 
For example, this may be applicable when there is a high amount of available feed 
flow, and it is not expected to be completely used for processing. It is not common 
to apply this in intermediate processes as it will imply that there’s a possibility of 
unused intermediates.
3.3.3 summing Points
Summing points are points at which materials from different sources are added to 
each other. As shown in Figure 3.5, material i is generated at the first layer of tech￾nologies j and can be mixed prior to being processed by technology j’.
FIGURE 3.4 Branching points.
FIGURE 3.5 Summing points.46 Optimization for Energy Systems and Supply Chains
For this representation, the expanded equation can be written as:
F F j i = = 1, 1, j j ′= = 1 2 + + , 1 i j = , 1 ′= = + = F F j J, 1 i j = , 1 ′= j i ′= = 1, 1 (3.7)
Therefore, the generalized version is:
J
∑F F j i, , j′ = ⋅ j i ′, ∀j p ′∀ (3.8)
j=1
3.3.4 otHer asPeCts
Aside from flow rates, a mathematical model may have other aspects being evaluated 
too. These aspects may include emission, cost, and energy consumption. In most 
cases, these aspects vary based on the total flow rate entering or leaving a given unit 
operation. Let us consider cost as an example. The cost of a unit operation is depen￾dent on its size, which often can be related to the flow rate. Cost can be broken down 
into several subcomponents, but for this example, we will consider capital expen￾diture (CAPEX) and operating expenditure (OPEX) only. Ideally, we would assign 
different symbols to CAPEX and OPEX. However, if we want to express them via 
a standardized symbol, labels can be used to differentiate them. Equations (3.9) and 
(3.10) are examples of how labels differentiate aspects with similar symbols.
COSTCAPEX C j 1= = = + ( ) F + j 1,p= = 1 j F F 1,p 1= = + j 1,p= = P j C APEX
1 (3.9)
COSTOPEX
j 1 = + ( ) F + j 1,p= = 1 j F F OPEX = = 1,p 1= = + j 1,p= = P j C 1 (3.10)
As shown, both CAPEX and OPEX use the “COST” symbol. The difference is in 
the labels “CAPEX” and “OPEX”. The “C” coefficient in both equations refers to the 
cost factor per unit flow rate. Meanwhile, the term (F F j 1= = ,p 1 j + + = = 1,p 1 + Fj 1= = ,p P )
refers to the total flow rate leaving a technology j =1. To make these equations more 
generalized, they can be written as Eqs. (3.11) and (3.12), respectively.
COSTCAPEX j j = ⋅ ∑
P
F CCAPEX ,p j α j ∀j (3.11)
p=1
P
COSTOPEX OPEX j = ⋅ ∑F Cj p, j     ∀j (3.12)
p=1
Note that αj
 in Eq. (3.11) is the annualizing factor for each technology j. For both 
equations, index p is inactive due to the summation. This leaves both sides having Formulating Generalized Mathematical Models 47
the same active index j. This means Eqs. (3.11) and (3.12) must be applied to every 
technology j. Following this, Eq. (3.13) sums both CAPEX and OPEX equations to 
represent the total cost. In this case, the index j is no longer active as the summation 
is with respect to j.
J J
COSTTOTAL C = + ∑ ∑ COST APEX
j COSTOPEX
j (3.13)
j= = 1 j 1
This concept can be extended and applied to equations for other aspects too. The 
general representations above serve as guidance in developing generalized equations. 
These rules can be used to represent complex superstructures.
3.4 CONCLUSION
This chapter provided the basics for writing generalized equations. As mentioned 
previously, this chapter serves as a guide for readers to develop generalized equa￾tions for their own work. This chapter ends the first part of this book. Chapters in 
the second half focus on the applications of mathematical models to optimize vari￾ous case studies involving energy systems and supply chains. Those chapters are 
part of an edited compilation contributed by different research groups around the 
globe.
The second half begins with Chapter 4, where Belmonte, Aviso, Benjamin, and 
Tan used mathematical models to synthesize optimal biochar systems. In Chapter 5, 
Lim, How, and Lin applied a mathematical model to the planning of sustainable 
hydrogen networks in South Korea. Meanwhile, Chapter 6 by Chan and Chew dis￾cussed the application of a mathematical model to optimize polygeneration systems 
powered by glycerine-pitch and diesel. Following this, Mukherjee and Smith used a 
series of mathematical models in Chapter 7 to optimize the economic and environ￾mental sustainability of a TEG dehydration process. Then, Chapter 8 by Kumawat 
and Chaturvedi applied mathematical models to aggregate production planning for 
the steel industry in India. Chapter 9 by Tan, Aviso, and Lee pivoted to the macro￾level perspective, where mathematical models were used to optimize the economic 
planning for Taiwan. Following suit, Rajakal and Wan demonstrated a mathematical 
model’s ability to develop sustainable land expansion strategies for palm-based bio￾diesel supply chains in Chapter 10. Next, Chapter 11 by Jegede, De Mel, Short, and 
Isafiade presented the use of a mathematical model to determine the optimal design 
of a decentralized renewable energy system in Namibia. Finally, Chapter 12 by San 
Juan, Ching, Chua, Dyogi, and Sy applied a mathematical model to optimize battery 
energy within the electrical distribution grid.
FURTHER READING
Readers are directed to contributions by Stoecker (1989), Meier (1984), Nayak et al. 
(2015), and Stricker (1985) for examples of generalized mathematical equations writ￾ten for energy systems and supply chains.48 Optimization for Energy Systems and Supply Chains
REFERENCES
Meier, P., 1984. Energy Systems Analysis for Developing Countries. Munich: Springer-Verlag 
Berlin Heidelberg.
Nayak, J.K., Kedare, S.B., Banerjee, R., Bandyopadhyay, S., Desai, N.B., Paul, S., Kapila, 
A., 2015. A 1 MW national solar thermal research cum demonstration facility at 
Gwalpahari, Haryana, India. Curr. Sci. 109, 1445–1457.
Stoecker, W., 1989. Design of Thermal Systems, 3rd ed. New York: McGraw-Hill.
Stricker, S., 1985. Optimizing Performance of Energy Systems. New York: McGraw-Hill.Part B
Applications51
4 Mixed-Integer Linear 
Programming Model 
for the Synthesis of 
Negative-Emission 
Biochar Systems
Beatriz A. Belmonte
University of Santo Tomas
Kathleen B. Aviso
De La Salle University
Michael Francis D. Benjamin
University of Santo Tomas
Raymond R. Tan
De La Salle University
CONTENTS
4.1 Introduction .................................................................................................... 52
4.2 Negative-Emission Biochar Systems ..............................................................54
4.3 Methodology ...................................................................................................54
4.4 Case Study 1: Synthesis of Bioenergy Plant with Biochar Production ........... 55
4.5 Case Study 2: Synthesis of Bioenergy Plant Producing 
Multi-grade Biochars ......................................................................................59
4.6 Conclusion ......................................................................................................64
4.7 Further Reading ..............................................................................................65
4.8 Density and Calorific Value of Process Streams ............................................65
References ................................................................................................................65
Appendix ..................................................................................................................68
DOI: 10.1201/9781003240228-652 Optimization for Energy Systems and Supply Chains
4.1 INTRODUCTION
It is well known that climate change is one of the major environmental crises that 
humanity is facing. The concentration of greenhouse gas in the atmosphere is con￾tinuously increasing, and the world is still behind schedule in meeting the targets of 
the Paris Agreement. Considering that climate impacts are becoming inescapable, 
there is an immediate need for all countries to commit to net zero emission by 2050. 
Such climate transition is still possible if comprehensive plans, supportive policies, 
and most importantly, effective technologies will be immediately employed. Some 
researchers have asserted the necessity to deploy negative emission technologies 
(NETs) to stabilize the global climate (Haszeldine et al., 2018). Among the NETs, 
biochar-based carbon sequestration emerges as promising for scale-up in the near 
future since it is cost-effective (Belmonte et al., 2019a) and utilizes mature technolo￾gies (Tan, 2019).
Biochar is considered a NET since it can store carbon dioxide in soil for hundreds 
of years (Woolf et al., 2010). It is produced via thermochemical conversion of bio￾mass. This process simultaneously produces green energy such as bio-oil that can be 
processed as transportation fuel, and syngas that can be used as fuel for stationary 
applications such as industrial plants. The biochar consists of mostly recalcitrant 
carbon that can remain in soil when biochar is used for soil amendment. Various life 
cycle assessments applied to a biochar production system show that utilizing waste 
biomass results in climate mitigation (Matuštík et al., 2022). Biochar has a potential 
to sequester 130 Gt CO2 until 2100 (Woolf et al., 2010).
The physicochemical properties of biochar (e.g., specific surface area, poros￾ity, pH, cation exchange capacity, carbon content) vary depending on the type of 
feedstock and operational conditions (pyrolysis temperature, heating rate, and resi￾dence time) during biomass conversion. The extent to which biochar can amend 
specific soil quality issues largely depends on these properties. In addition, the 
reason why some biochar applications appear as ineffective in soil amendment is 
due to the addition of unsuitable biochar to the soil (Tan et al., 2017). It is, there￾fore, important to produce biochar that is tailored with relevant physical properties 
to fit local soil conditions. For example, the pyrolysis of coconut shell biomass 
at 600°C had produced biochar with 93.9% carbon content among the different 
biochars produced from various crop residues (Windeatt et al., 2014), which is 
suitable for arid soil (Belmonte et al., 2019a). When the carbon content of arid soil 
is increased via the application of high-carbon content biochar, the water holding 
capacity increases (Novak et al., 2012). Wood biochar has the advantage of higher 
porosity compared with other feedstocks (Marousek et al., 2021). Biochar with 
high porosity can increase the capacity of infertile soil to retain moisture and nutri￾ents (Belmonte et al., 2019a). Porous biochar is also suitable for hard soils since it 
has the capacity to enhance plant root growth (Kazemi Shariat Panahi et al., 2020). 
High-temperature pyrolysis of biomass that contains aromatic lignin, aliphatic 
alkyls, and ester groups results in biochars with higher surface area (Tomczyk 
et al., 2020) that can increase the nutrient holding capacity of degraded soil. It also 
shows that as the pyrolysis temperature increases, biochar’s alkalinity (pH) also Synthesis of Negative-Emission Biochar Systems 53
increases (Li et al., 2019). Acidic soil can strongly benefit from the liming effects 
of biochar on its pH (Belmonte et al., 2019b). Biochars that are derived from min￾eral-rich biosolids have higher cation exchange capacity (Kazemi Shariat Panahi 
et al., 2020) that are suitable for sandy soil (Belmonte et al., 2019a). Application of 
unsuitable biochars into the soil could possibly raise the greenhouse gas emission 
from the soil, reduce soil nutrients, and can negatively impact the biological prop￾erties of the soil (Kazemi Shariat Panahi et al., 2020). Therefore, there is a need 
to enhance the efficacy of biochar via the designer biochar concept to customize 
biochar that can address the specific conditions of the soil to which it is added 
(Ding et al., 2016).
The application of biochar promotes environmental sustainability and supports 
circular economy objectives. Production of biochar from residual biomass and its 
application to soil is a good waste management strategy and can reduce the utiliza￾tion of fertilizer and water for irrigation which further translates into economic gains 
for farmers. The energy co-products generated simultaneously with biochar further 
displace the consumption of fossil fuels which in turn offset the emission from these 
nonrenewable resources. A pyrolysis-biochar system applied to an olive farm uses its 
semi-solid waste to produce liquid and gas fuels from biochar production to fulfill its 
energy requirement and generates an electricity surplus that can be sold to the grid 
while the biochar is used for soil amendment (Zabaniotou et al., 2015). The utiliza￾tion of biochar is perceived to support sustainable development goals (SDGs) such as 
zero hunger (SDG2), affordable and clean energy (SDG7), responsible consumption 
and production (SDG12), and climate action (SDG13). It is, therefore, necessary to 
standardize and optimize the production and application of biochar which can be 
seen as an environmentally sustainable way to mitigate climate change (Neogi et al., 
2021).
Biochar production for carbon sequestration can be integrated with a multi-func￾tional bioenergy system to generate biofuels alongside biochar, bio-oil, and syngas. 
When multi-functional bioenergy system is integrated with biochar production, the 
whole system can achieve a negative carbon footprint (Ubando et al., 2014). This 
integrated system can also be a subunit of a biochar-based carbon management net￾work (Belmonte et al., 2018) for the generation of biochars tailored to address specific 
soil quality issues. The main goal of this work is to design and optimize a bioenergy 
system, which simultaneously generates biochar, using mathematical programming. 
Mathematical programming can facilitate the development of a model for a particu￾lar system. The mixed-integer linear programming (MILP) model previously devel￾oped (Belmonte et al., 2019a) is applied here for the synthesis of a negative-emission 
bioenergy system.
This chapter is organized as follows. The succeeding Section 4.2 describes the bio￾energy system that is being considered here. Section 4.3 discusses the model formu￾lation. Two hypothetical case studies are given in Sections 4.4 and 4.5 to demonstrate 
how the mathematical model is used to design and synthesize bioenergy systems. 
Conclusions are presented in Section 4.6. Section 4.7 recommends papers for further 
reading. Other pertinent data used in the case studies are presented in Section 4.8. 
The mathematical programming codes are then presented in the Appendix.54 Optimization for Energy Systems and Supply Chains
4.2 NEGATIVE-EMISSION BIOCHAR SYSTEMS
The bioenergy system being considered here consists of multiple process units. Each 
process unit consumes input materials (e.g., different biomass feedstocks) to generate 
the final product outputs (i.e., bio-oil, biochar, and biofuels). There are also internal 
demands for the generated energy (i.e., syngas and electricity) needed to produce 
the final products to be sold in the market. Each process unit is defined by a fixed 
proportion of input and output materials or energy. Each stream (input or output) has 
a corresponding unit cost and carbon footprint. Each process unit has a unique capi￾tal cost. The cost data are needed to compute the profitability of the system, while 
the carbon footprint of each stream is used to compute the net carbon footprint of 
the whole integrated system. Due to the different factors that need to be considered, the 
design of such system would require optimization. The hypothetical case studies in 
Sections 4.4 and 4.5 give the detailed features of the system.
4.3 METHODOLOGY
The mathematical model that is employed for the synthesis of integrated biochar 
systems is an MILP model that is based on the previous formulation (Belmonte et al., 
2019a) and is defined by the following equations:
m
The variable x generally corresponds to the design variable, such as the sizes of 
equipment, pressures, or temperatures. In this system, x is the process unit capacity 
vector bounded by lower (xL) and upper (xU) values, y is the final or net output stream 
vector bounded by lower (yL) and upper (yU) limits, c is the stream unit cost vector, 
v is the variable capital unit cost coefficient vector, f is the fixed capital unit cost Synthesis of Negative-Emission Biochar Systems 55
coefficient vector, b is the process unit selection vector consisting of binary variables, 
CRF is the capital recovery factor, A is the process matrix that is made up of coef￾ficients describing the average fixed proportion of input and output flows of materials 
and energy in every process unit, z is the stream carbon footprint coefficient vector, 
CF is the net or final carbon footprint of the system, and M is an arbitrary large 
number. The objective is to maximize the profitability of the integrated biochar sys￾tem (Eq. 4.1). The profit is computed by calculating first the revenues from the sales 
of products and costs of purchased inputs (cTy). Then, the total annual capital cost 
(variable and fixed) is subtracted from the revenues to solve for the annual profit. The 
model includes linear expressions of material and energy balances that correspond to 
the process streams (Eq. 4.2) where matrix A can be based from the system’s histori￾cal data. The process unit selection vector consisting of binary variables (Eq. 4.5) is 
used (Eq. 4.6) to denote if the process unit exists (b= 1) or not (b= 0). The required 
capacities of the process units take non-negative values (Eq. 4.7). The net carbon 
footprint of the biochar system (Eq. 4.8) can also be predicted by accounting for the 
carbon footprint of the individual net output streams (y). It is important to mention 
that the input of biomass to the system takes negative values in y, thus allowing for 
the corresponding carbon footprint to be accounted for.
Near-optimal alternative solutions can also be determined via the addition of 
integer-cut constraints in the original formulation (Voll et al., 2015). The succeed￾ing hypothetical case studies illustrate how the model can be applied in integrated 
biochar systems for negative carbon emission.
4.4 CASE STUDY 1: SYNTHESIS OF BIOENERGY 
PLANT WITH BIOCHAR PRODUCTION
The hypothetical bioenergy plant consists of several process units as illustrated in 
Figure 4.1. The pyrolysis unit produces syngas, bio-oil, and biochar via thermal 
decomposition of biomass material (coconut shell) in an inert environment. The 
FIGURE 4.1 Block diagram of process units in Case Study 1.56 Optimization for Energy Systems and Supply Chains
electricity demand of the plant is being supplied by the combined heat and power 
(CHP) unit using syngas as an input. Fermentation units I and II generate bioetha￾nol and biobutanol from corn stover. The bioreactor unit also utilizes corn stover to 
produce biohydrogen. Extracted bran oil from rice bran is being used to produce 
biodiesel via the process of transesterification. Figure 4.1 also presents the input and 
output flow of material and energy for each process unit. Table 4.1 gives the process 
matrix (A) for the bioenergy plant. Each column shows the relative proportions of 
material and energy streams in a particular process equipment unit. The positive 
coefficient indicates that the stream is being produced, while the negative coefficient 
denotes that the stream is being consumed by the process unit. For example, −4.06 
MW of energy input (syngas) is needed to produce 1 MW of electricity (output) from 
CHP. The process flowsheet of the bioenergy plant is presented in Figure 4.2. Other 
TABLE 4.1
Process Matrix for Case Study 1
Process Unita
Product Fermentation Fermentation 
Stream CHP Pyrolysis I II Bioreactor Transesterification
Syngas (MW) −4.06 3.59 0.00 0.00 0.00 0.00
Electricity 1.00 −0.06 −0.00087 −0.0114 −0.166 −0.00003
(MW)
Rice bran 0.00 0.00 0.00 0.00 0.00 −0.0015
(kg/s)
Coconut shell 0.00 −1.00 0.00 0.00 0.00 0.00
(kg/s)
Corn stover 0.00 0.00 −0.00131 −0.0018 −0.0003 0.00
(kg/s)
Bio-oil (kg/s) 0.00 0.44 0.00 0.00 0.00 0.00
Biochar (kg/s) 0.00 0.28 0.00 0.00 0.00 0.00
Bioethanol 0.00 0.00 0.00579 0.00 0.00 0.00
(MW)
Biobutanol 0.00 0.00 0.00 0.001 0.00 0.00
(MW)
Biohydrogen 0.00 0.00 0.00 0.00 0.00305 0.00
(MW)
Biodiesel 0.00 0.00 0.00 0.00 0.00 0.009
(MW)
Reference Carvalho Windeatt Kazi Baral and Shah Zhang Lei et al. (2010)
et al. et al. et al. (2010) (2016) et al. (2013)
(2012) (2014)
a Some adapted values were converted to specified units.Synthesis of Negative-Emission Biochar Systems 57
pertinent data that were used are given in Section 4.8. Table 4.2 shows the capital 
cost data used in the case study. The capital cost of each equipment is assumed to be 
a linear function of its capacity. It is further assumed that the bioenergy plant is oper￾ating 8,000 h/y. The CRF used is 0.08 (i.e., approximately 5% interest per annum 
for 20 years). The capital costs of fermentation (I and II), bioreactor, and transesteri￾fication units are computed based on cost estimation rules by Peters et al. (2003). 
Table 4.3 shows the final output values of the streams and the corresponding selling 
price. As can be seen in Eq. (4.5) taking bioethanol as an example, the final output 
value should be less than or equal to 5 MW. The bioenergy plant requires syngas as 
TABLE 4.2
Capital Cost Coefficients for Case Study 1
Process Unit Fixed Cost Variable Cost/ (MW) Reference
CHP $432,790 $1,073,033 Sy et al. (2016)
Pyrolysis $714,924 $3,434,623 Badger et al. (2011) 
Granatstein et al. (2009)
Fermentation I $5,185,749 $1,450 Peters et al. (2003)a
Fermentation II $2,382,267 $2,241 Peters et al. (2003)a
Bioreactor $65,948,914 $10,492 Peters et al. (2003)a
Transesterification $16,449 $5.912 Peters et al. (2003)a
a Computed based on cost estimation rules by Peters et al. (2003).
FIGURE 4.2 Bioenergy plant flowsheet for Case Study 1.58 Optimization for Energy Systems and Supply Chains
energy fuel to generate electricity, biochar, bio-oil, bioethanol, biobutanol, biohydro￾gen, and biodiesel. Table 4.4 gives the carbon footprint of each product. The case 
study demonstrates the applicability of the model previously described herein. The 
objective of the case study is to maximize the profitability of the bioenergy plant.
Solving Eqs. (4.1)–(4.8) results in an optimal solution which excludes the trans￾esterification unit as illustrated in Figure 4.3. The final output values of the optimal 
configuration are 206.87 kg/s of bio-oil, 131.65 kg/s of biochar, 5 MW of bioethanol, 
10 MW of biobutanol, and 5 MW of biohydrogen. The plant consumes 470.17 kg/s of 
TABLE 4.3
Demand of Process Streams and Selling Price for Case Study 1
Final Output
Streams Lower Upper Selling Price Reference for the Selling Pricea
Syngas (MW) 0 0 n/a
Electricity (MW) 0 0 n/a
Rice bran (kg/s) −7.967 0 $0.3125/kg Lazaro (2019)
Coconut shell (kg/s) −1,163 0 $0.032/kg Belmonte et al. (2019a)
Corn stover (kg/s) −24.24 0 $0.1006/kg Thompson and Tyner (2014)
Bio-oil (kg/s) 7.59 ∞ $0.09/kg Belmonte et al. (2019a)
Biochar (kg/s) 3.709 ∞ $2.7/kg Ahmed et al. (2016)
Bioethanol (MW) 0 5 $1.1731/L Kazi et al. (2010)
Biobutanol (MW) 0 10 $0.984/L Meramo-Hurtado et al. (2020)
Biohydrogen (MW) 0 5 $52.805/m3 Zhang et al. (2013)
Biodiesel (MW) 0 15 $0.9582/L Corpuz (2019)
a Some adapted values were converted to specified units.
TABLE 4.4
Carbon Footprint per Product for Case Study 1
Products Carbon Footprint Reference
Syngas (kg/MW) 0 Ubando et al. (2014)
Electricity (kg/MW) 0 Ubando et al. (2014)
Rice bran (kg/kg) 0.008 Ubando et al. (2014)
Coconut shell (kg/kg) 0.017 Tan et al. (2009)
Corn stover (kg/kg) 0.008 Ubando et al. (2014)
Bio-oil (kg/kg) 0 Ubando et al. (2014)
Biochar (kg/kg) −3.86 Belmonte et al. (2018)
Bioethanol (g/MJ) 44.9 Mekonnen et al. (2018)
Biobutanol (g/MJ) 79 Väisänen et al. (2016)
Biohydrogen (kg/MW) 0
Biodiesel (kg/MW) 0 Ubando et al. (2014)Synthesis of Negative-Emission Biochar Systems 59
coconut shell and 19.42 kg/s of corn stover. The maximum profit is $1,031,668 × 107
/y. 
The corresponding carbon footprint attained by the system is −499 kg/s (−14.37 
Mt/y).
What if the optimal solution may not be feasible to implement due to some practi￾cal constraints not accounted for in the mathematical model such as space limitation 
and other sustainability issues (e.g., cost and equipment reliability)? The generation 
of near-optimal solutions may help find alternative solutions for implementation. 
This methodology may also reveal insights that can lead to better decision-making. 
Integer cuts are then used to determine near-optimal solution alternatives. Table 4.5 
presents the generated near-optimal solutions alongside the optimal solution. Results 
show that the CHP and the pyrolysis units are important since they are all included in 
all solutions. On the other hand, all generated solutions excluded the transesterifica￾tion unit. As profitability decreases, the carbon footprint also decreases. Comparing 
the objective function values obtained in solutions 2, 3, and 4 with the profitability 
value achieved in the optimal solution, it can be observed that the percentage differ￾ence is within 0.029%. Compared to the optimal solution, the near-optimal solutions 
are less complex since 2–3 process units are excluded from the synthesized bioen￾ergy plant.
4.5 CASE STUDY 2: SYNTHESIS OF BIOENERGY PLANT 
PRODUCING MULTI-GRADE BIOCHARS
The second example is used to demonstrate a bioenergy plant that simultaneously pro￾duces multi-grade biochars with other bioenergy products previously mentioned in 
Case Study 1. Two more pyrolysis units are added in the previous plant configuration 
FIGURE 4.3 Optimal bioenergy plant configuration for Case Study 1.60 Optimization for Energy Systems and Supply Chains
(Case Study 1). Figure 4.4 presents the new plant flowsheet. As can be seen, the three 
pyrolysis units are producing different grades of biochar that are specifically tailored 
to address certain soil quality limitations. The rice husk biochar pyrolyzed at 600°C 
can increase the pH of acidic soil (Belmonte et al., 2019a). Coconut shell biochar 
pyrolyzed at 600°C and 300°C can increase the carbon and cation exchange capac￾ity (CEC) of arid and sandy soil, respectively (Belmonte et al., 2019a). The assumed 
demand for multi-grade biochars and other energy products including the selling 
price is given in Table 4.6. The input and output streams for the additional pyrolysis 
units are shown in Figure 4.5. Table 4.7 gives the process matrix data. The capital 
TABLE 4.5
Generated Optimal and Near-Optimal Solutions for Case Study 1
Carbon Process Unit Capacity (MW)
Profit Footprint Fermen- Fermen- Transesteri￾Rank (109 $/y) (Mt/y) CHP Pyrolysis tation I tation II Bioreactor fication
Optimum 10,316.68 −14.37 415.7 470.2 863.1 10,000 1,639.3 0.0
Second 10,316.66 −14.35 414.9 469.3 0.0 10,000 1,639.3 0.0
Third 10,313.73 −10.16 293.4 331.9 863.1 0.0 1,639.3 0.0
Fourth 10,313.71 −10.14 292.6 330.9 0.0 0.0 1,639.3 0.0
Fifth 2.965255 −4.232 123.1 139.2 863.1 10,000 0.0 0.0
Sixth 2.965254 −4.232 123.1 139.2 863.1 10,000 0.0 0.0
Seventh 2.949297 −4.211 122.3 138.3 0.0 10,000 0.0 0.0
Eighth 2.949296 −4.211 122.3 138.3 0.0 10,000 0.0 0.0
FIGURE 4.4 Bioenergy plant flowsheet for Case Study 2.Synthesis of Negative-Emission Biochar Systems 61
TABLE 4.6
Demand of Process Streams and Selling Price for Case Study 2
Streams
Final Output
Lower Upper Selling Price Reference
Syngas (MW) 0 0 n/a
Electricity (MW) 0 0 n/a
Rice husk (kg/s) −64.52 0 $0.029/kg Belmonte et al. (2019a)
Rice bran (kg/s) −7.967 0 $0.3125/kg Lazaro (2019)
Coconut shell (kg/s) −1,163 0 $0.032/kg Belmonte et al. (2019a)
Corn stover (kg/s) −24.24 0 $0.1006/kg Thompson and Tyner (2014)
RH bio-oil (kg/s) 0 12.78 $0.057/kg Belmonte et al. (2019a)
RH biochar (kg/s) 0 12.95 $1.541/kg Belmonte et al. (2019a)
CS 600 bio-oil (kg/s) 7.59 ∞ $0.09/kg Belmonte et al. (2019a)
CS 600 biochar (kg/s) 3.709 ∞ $2.7/kg Ahmed et al. (2016)
CS 300 bio-oil (kg/s) 1.56 ∞ $0.068/kg Belmonte et al. (2019a)
CS 300 biochar (kg/s) 3.31 ∞ $2.425/kg Belmonte et al. (2019a)
Bioethanol (MW) 5 ∞ $1.1731/L Kazi et al. (2010)
Biobutanol (MW) 10 ∞ $0.984/L Meramo-Hurtado et al. (2020)
Biohydrogen (MW) 5 ∞ $52.805/m3 Zhang et al. (2013)
Biodiesel (MW) 15 ∞ $0.9582/L Corpuz (2019)
FIGURE 4.5 Additional pyrolysis units producing different grades of biochar for Case 
Study 2.62 Optimization for Energy Systems and Supply Chains
TABLE 4.7
Process Matrix for Case Study 2
Product 
Stream
Process Unita
I II III IV V VI VII VIII
Syngas (MW) −4.06 3.59 2.79 0.23 0.00 0.00 0.00 0.00
Electricity 1.00 −0.06 −0.06 −0.06 −0.00087 −0.0114 −0.166 −0.00003
(MW)
Rice husk 0.00 0.00 −1.00 0.00 0.00 0.00 0.00 0.00
(kg/s)
Rice bran 0.00 0.00 0.00 0.00 0.00 0.00 0.00 −0.0015
(kg/s)
Coconut shell 0.00 −1.00 0.00 −1.00 0.00 0.00 0.00 0.00
(kg/s)
Corn stover 0.00 0.00 0.00 0.00 −0.00131 −0.0018 −0.0003 0.00
(kg/s)
RH bio-oil 0.00 0.00 0.34 0.00 0.00 0.00 0.00 0.00
(kg/s)
RH biochar 0.00 0.00 0.39 0.00 0.00 0.00 0.00 0.00
(kg/s)
CS 600 bio-oil 0.00 0.44 0.00 0.00 0.00 0.00 0.00 0.00
(kg/s)
CS 600 0.00 0.28 0.00 0.00 0.00 0.00 0.00 0.00
Biochar 
(kg/s)
CS 300 bio-oil 0.00 0.00 0.00 0.19 0.00 0.00 0.00 0.00
(kg/s)
CS 300 0.00 0.00 0.00 0.70 0.00 0.00 0.00 0.00
biochar 
(kg/s)
Bioethanol 0.00 0.00 0.00 0.00 0.00579 0.00 0.00 0.00
(MW)
Biobutanol 0.00 0.00 0.00 0.00 0.00 0.001 0.00 0.00
(MW)
Biohydrogen 0.00 0.00 0.00 0.00 0.00 0.00 0.00305 0.00
(MW)
Biodiesel 0.00 0.00 0.00 0.00 0.00 0.00 0.00 0.009
(MW)
Reference Carvalho Windeatt Windeatt Prabhakar Kazi et al. Baral and Zhang Lei et al. 
et al. et al. et al. et al. (1986) (2010) Shah et al. (2010)
(2012) (2014) (2014) (2016) (2013)
a I – CHP, II – Pyrolysis 1, III – Pyrolysis 2, IV – Pyrolysis 3, V – Fermentation I, VI – Fermentation II, 
VII – Bioreactor, VIII – Transesterification.Synthesis of Negative-Emission Biochar Systems 63
cost data of all process units, including the additional pyrolysis units, are the same as 
in Case Study 1 (Table 4.2). Other pertinent data that were used are given in Section 
4.8. Table 4.8 gives the carbon footprint for each product. Case Study 2 uses the same 
assumptions as in Case Study 1.
The optimization was done and generated two solutions (one optimal and one 
near-optimal), as shown in Table 4.9. The optimized bioenergy plant generates a 
profit of 324,304 × 108 $/yr. Figure 4.6 illustrates the optimal solution superstructure. 
As can be observed, the optimal solution includes all the process units originally 
present in Figure 4.4. The bioenergy plant produces 12.95 kg/s rice husk biochar 
(RH biochar), 11.29 kg/s RH bio-oil, 323.28 kg/s coconut shell biochar pyrolyzed at 
TABLE 4.8
Carbon Footprint per Product for Case Study 2
Products Carbon Footprint Reference
Syngas (kg/MW) 0 Ubando et al. (2014)
Electricity (kg/MW) 0 Ubando et al. (2014)
Rice husk (kg/kg) 0.04 Liu et al. (2016)
Rice bran (kg/kg) 0.008 Ubando et al. (2014)
Coconut shell (kg/kg) 0.017 Tan et al. (2009)
Corn stover (kg/kg) 0.008 Ubando et al. (2014)
RH bio-oil (kg/kg) 0 Ubando et al. (2014)
RH biochar (kg/kg) −2.0 Belmonte et al. (2018)
CS 600 bio-oil (kg/kg) 0 Ubando et al. (2014)
CS 600 biochar (kg/kg) −3.86 Belmonte et al. (2018)
CS 300 bio-oil (kg/kg) 0 Ubando et al. (2014)
CS 300 biochar (kg/kg) −3.43 Belmonte et al. (2018)
Bioethanol (g/MJ) 44.9 Mekonnen et al. (2018)
Biobutanol (g/MJ) 79 Väisänen et al. (2016)
Biohydrogen (kg/MW) 0
Biodiesel (kg/MW) 0 Ubando et al. (2014)
TABLE 4.9
Generated Optimal and Near-Optimal Solutions for Case Study 2
Rank
Profit 
(109 $/y)
Carbon 
Footprint (Mt/y)
Process Unit Capacity (MW)a
I II III IV V VI VII VIII
Optimum 32,430.4 −36.61 1,044.2 1,154.6 33.2 8.2 863.1 10,000 5,154.2 1,636.4
Second 31,642.8 −35.90 1,021.4 1,154.6 0.0 8.2 863.1 10,000 5,029 1,636.4
a I – CHP, II – Pyrolysis 1, III – Pyrolysis 2, IV – Pyrolysis 3, V – Fermentation I, VI – Fermentation II, 
VII – Bioreactor, VIII – Transesterification.64 Optimization for Energy Systems and Supply Chains
600°C (CS-600 biochar), 508 kg/s CS-600 bio-oil, 5.76 kg/s coconut shell biochar 
pyrolyzed at 300°C (CS-300 biochar), 1.56 kg/s CS-300 bio-oil, 5 MW of bioethanol, 
10 MW of biobutanol, 15.72 MW of biohydrogen, and 15 MW of biodiesel. The opti￾mized bioenergy plant utilizes 33.21 kg/s rice husk biomass, 2.40 kg/s rice bran bio￾mass, 1,162.79 kg/s coconut shell biomass, and 20.51 kg/s corn stover biomass. The 
production of biochar from the three pyrolysis units in the optimal solution results in 
a carbon footprint of −1,271.22 kg/s (−36.61 Mt/y). Meanwhile, the generated near￾optimal solution offers a less complex configuration with the exclusion of pyroly￾sis unit II. However, this results in a slight reduction in negative carbon footprint 
(−1,246.64 kg/s) and profitability ($316,428 × 108/yr).
4.6 CONCLUSION
An MILP model was applied for the synthesis of a bioenergy plant with biochar 
production to attain negative carbon emission. The model was demonstrated with 
two case studies. Since limitations may exist during implementation, near-optimal 
solutions were also generated to support decision-making for the selection of the final 
plant configuration. Two hypothetical case studies were used to illustrate the appli￾cability of the model. Both case studies demonstrate that certain design features can 
be considered during the selection process. In addition, the production of customized 
biochars integrated into the plant design can address the quality issues of the differ￾ent types of soil to achieve favorable results when biochar is applied.
The MILP model employed in this work can further be applied in the synthesis of 
other NETs such as enhanced weathering networks and to consider other footprints 
that accompany the selection of the technology. Parametric uncertainties can be inte￾grated into the basic model through non-deterministic formulations based on fuzzy, 
stochastic, or robust optimization.
FIGURE 4.6 Optimal bioenergy plant configuration for Case Study 2.Synthesis of Negative-Emission Biochar Systems 65
4.7 FURTHER READING
A broad introduction to the NET research landscape can be found in the review 
paper of Minx et al. (2018), while their costs and benefits are compared in a com￾panion article (Fuss et al., 2018). The generic MILP for process synthesis was first 
proposed by Grossmann and Santibanez (1980). Their seminal work is the basis of all 
mainstream MILP formulations used in process synthesis applications. Optimization 
models allow the identification of the best solutions to any given model. However, 
examination of near-optimal solutions may have engineering value as well. This point 
is discussed in more detail by Voll et al. (2015). Alternatives to MILP models may 
also be used for optimal process synthesis. For example, process graph methodology 
has proven to be a viable alternative for many applications (Friedler et al., 2019).
4.8 DENSITY AND CALORIFIC VALUE OF PROCESS STREAMS
REFERENCES
Ahmed, M. B., Zhou, J. L., Ngo, H. H., & Guo, W. (2016). Biomass and bioenergy insight into 
biochar properties and its cost analysis. Biomass and Bioenergy, 84, 76–86.
Aparicio, E., Rodríguez-Jasso, R. M., Lara, A., Loredo-Treviño, A., Aguilar, C. N., Kostas, 
E. T., & Ruiz, H. A. (2020). Biofuels production of third generation biorefinery from 
macroalgal biomass in the Mexican context: An overview. In Maria Dolores Torres, 
Stefan Kraan, & Herminia Dominguez (Eds.), Advances in Green and Sustainable 
Chemistry, Sustainable Seaweed Technologies (pp. 393–446). Amsterdam: Elsevier. 
ISBN 9780128179437.
Streams Density Reference Calorific Value Reference
Syngas 
Electricity 
Rice husk 15.5 MJ/kg Windeatt et al. (2014)
Rice bran 3,000 kcal/kg Zafar (2021)
Coconut shell 17.2 MJ/kg Windeatt et al. (2014)
Corn stover 16.5 MJ/kg Lizotte et al. (2015)
RH bio-oil 13.69 MJ/kg Yusup et al. (2015)
RH biochar 19.3 MJ/kg Windeatt et al. (2014)
CS 600 Bio-oil 19.75 MJ/kg Rout et al. (2016)
CS 600 Biochar 33.7 MJ/kg Windeatt et al. (2014)
CS 300 Bio-oil 16 MJ/kg Granatstein et al. (2009)
CS 300 Biochar 30.238 MJ/kg Prabhakar et al. (1986)
Bioethanol 790 kg/m3 Chen et al. (2019) 26.4 MJ/kg “Bioethanol – European Biomass 
Industry Association,” n.d.
Biobutanol 12 g/L Sindhu et al. (2019) 29.2 MJ/L Aparicio et al. (2020)
Biohydrogen 0.09 g/L Fatehizadeh et al. (2018) 122 kJ/g Fatehizadeh et al. (2018)
Biodiesel 0.88 g/mL “Biodiesel Chemistry 33 MJ/L “Biodiesel Chemistry Tutorial,” 
Tutorial,” (n.d.) (n.d.)66 Optimization for Energy Systems and Supply Chains
Badger, P., Badger, S., Puettmann, M., Steele, P., & Cooper, J. (2011). Techno-economic 
analysis: Prelimiary assessment of pyrolysis oil production costs and material energy 
balance associated with a transportable fast pyrolysis system. BioResources, 6, 34–47.
Baral, N. R., & Shah, A. (2016). Techno-economic analysis of cellulosic butanol production 
from corn stover through acetone-butanol-ethanol fermentation. Energy and Fuels, 
30(7), 5779–5790.
Belmonte, B. A., Benjamin, M. F. D., & Tan, R. R. (2018). Bi-objective optimization of biochar￾based carbon management networks. Journal of Cleaner Production, 188, 911–920.
Belmonte, B. A., Benjamin, M. F. D., & Tan, R. R. (2019a). Optimization-based decision sup￾port methodology for the synthesis of negative-emissions biochar systems. Sustainable 
Production and Consumption, 19, 105–116.
Belmonte, B. A., Francis Benjamin, M. D., & Tan, R. R. (2019b). Bi-objective mixed-integer 
linear programming model for high-level planning of biochar-based carbon manage￾ment networks. Chemical Engineering Transactions, 72, 289–294.
Biodiesel Chemistry Tutorial. (n.d.). Retrieved January 28, 2022, from https://www.ausetute.
com.au/biodiesel.html.
Bioethanol – European Biomass Industry Association. (n.d.). Retrieved January 28, 2022, 
from https://www.eubia.org/cms/wiki-biomass/biofuels/bioethanol/.
Carvalho, M., Lozano, M. A., & Serra, L. M. (2012). Multicriteria synthesis of trigeneration sys￾tems considering economic and environmental aspects. Applied Energy, 91(1), 245–254.
Chen, L., Gao, K., Zhang, C., & Lang, W. (2019). Alternative fuels for IC engines and 
jet engines and comparison of their gaseous and particulate matter emissions. In 
Abul Kalam Azad & Mohammad Rasul (Eds.) Advanced Biofuels: Applications, 
Technologies and Environmental Sustainability (pp. 17–64). Cambridge: Woodhead 
Publishing. ISBN 9780081027912
Corpuz, P. (2019). Biofuels Annual. United States Department of Agriculture, Foreign 
Agriculture Service. Retrieved January 10, 2022, from https://www.fas.usda.gov/data/
philippines-biofuels-annual-4.
Ding, Y., Liu, Y., Liu, S., Li, Z., & Tan, X. (2016). Biochar to improve soil fertility. A review. 
Agronomy for Sustainable Development, 36, 36. https://doi.org/10.1007/s13593-016-0372-z
Fatehizadeh, A., Amin, M. M., Bina, B., Zare, M. R., Ghasemian, M., & Taheri, E. (2018). 
Biohydrogen production as clean fuel from physically pretreated mixed culture. 
Advanced Biomedical Research, 7, 80.
Friedler, F., Aviso, K. B., Bertok, B., Foo, D. C. Y., & Tan, R. R. (2019). Prospects and chal￾lenges for chemical process synthesis with P-graph. Current Opinion in Chemical 
Engineering, 26, 58–64.
Fuss, S., Lamb, W. F., Callaghan, M. W., Hilaire, J., Creutzig, F., Amann, T., … Minx, J. C. 
(2018). Negative emissions – Part 2: Costs, potentials and side effects. Environmental 
Research Letters, 13, Article 063002.
Granatstein, D., Kruger, C., Collins, H., Galinato, S., Garcia-Perez, M., & Yoder, J. (2009). Use 
of Biochar from the Pyrolysis of Waste Organic Material as a Soil Amendment. Final 
project report. Center for Sustaining Agriculture and Natural Resources, Washington 
State University, Wenatchee, WA.
Grossmann, I.E., Santbanez, J. (1980). Applications of mixed-integer linear programming in 
process synthesis. Computers & Chemical Engineering, 4, 205–214.
Haszeldine, R. S., Haszeldine, R. S., Flude, S., & Scott, V. (2018). Subject areas: Negative 
emissions technologies and carbon capture and storage to achieve the Paris Agreement 
commitments. Philosophical Transactions of the Royal Society A: Mathematical, 
Physical and Engineering Sciences, 376(2119), 20160447.
Kazemi Shariat Panahi, H., Dehhaghi, M., Ok, Y. S., Nizami, A. S., Khoshnevisan, B., 
Mussatto, S. I., Aghbashlo, M., Tabatabei, M., Lam, S. S. (2020). A comprehensive 
review of engineered biochar: Production, characteristics, and environmental applica￾tions. Journal of Cleaner Production, 270, 122462.Synthesis of Negative-Emission Biochar Systems 67
Kazi, F. K., Fortman, J., Anex, R., Kothandaraman, G., Hsu, D., Aden, A., & Dutta, A. (2010). 
Techno-economic analysis of biochemical scenarios for production of cellulosic etha￾nol. (No. NREL/TP-6A2-46588). National Renewable Energy Lab.(NREL), Golden, 
CO (United States).
Lei, H., Ding, X., Zhang, H., Chen, X., Li, Y., Zhang, H., & Wang, Z. (2010). In situ produc￾tion of fatty acid methyl ester from low quality rice bran: An economical route for 
biodiesel production. Fuel, 89(7), 1475–1479.
Li, S., Harris, S., Anandhi, A., & Chen, G. (2019). Predicting biochar properties and functions 
based on feedstock and pyrolysis temperature: A review and data syntheses. Journal of 
Cleaner Production, 215(2019), 890–902.
Liu, Q. I., Liu, B., Ambus, P., Zhang, Y., Hansen, V., Lin, Z., Shen, D., Liu, G., Bei, Q., Zhu, 
J., Wang, X., Ma, J., Lin, X., Yu, Y., Zhu, C., Xie, Z. (2016). Carbon footprint of rice 
production under biochar amendment – A case study in a Chinese rice cropping system. 
GCB Bioenergy, 8, 148–159.
Lizotte, P. L., Savoie, P., & De Champlain, A. (2015). Ash content and calorific energy of corn 
stover components in Eastern Canada. Energies, 8(6), 4827–4838.
Marousek, J., & Trakal, L. (2021). Techno-economic analysis reveals the untapped potential 
of wood biochar. Chemosphere, Doi: 10.1016/j.chemosphere.2021.133000.
Matuštík, J., Pohořelý, M., & Kočí, V. (2022). Is application of biochar to soil really carbon 
negative? The effect of methodological decisions in life cycle assessment. Science of the 
Total Environment, 807, 151058.
Mekonnen, M. M., Romanelli, T. L., Ray, C., Hoekstra, A. Y., Liska, A. J., & Neale, C. M. 
U. (2018). Water, energy, and carbon footprints of bioethanol from the U.S. and Brazil. 
Environmental Science & Technology, 52(24), 14508–14518.
Meramo-Hurtado, S. I., González-Delgado, Á. D., Rehmann, L., Quiñones-Bolaños, E., 
& Mehrvar, M. (2020). Comparison of biobutanol production pathways via acetone￾butanol-ethanol fermentation using a sustainability exergy-based metric. ACS Omega, 
5(30), 18710–18730.
Minx, J. C., Lamb, W. F., Callaghan, M. W., Fuss, S., Hilaire, J., Creutzig, F., Amann, T., 
Beringer, T., de Oliveira Garcia, W., Hartmann, J., Khanna, T., Lenzi, D., Luderer, 
G., Nemet, G.F., Rogelj, J., Smith, P., Vicente, J.L.V., Wilcox, J., del Mar Zamora 
Dominguez, M. (2018). Negative emissions – Part 1: Research landscape and synthesis. 
Environmental Research Letters, 13, Article 063001.
Neogi, S., Sharma, V., Khan, N., Chaurasia, D., Ahmad, A., Chauhan, S., Singh, A., You, S., 
Pandey, A., Bhargava, P. C. (2021). Sustainable biochar: A facile strategy for soil and 
environmental restoration, energygeneration, mitigation of global climate change and 
circular bioeconomy. Chemosphere, 293(October 2021), 133474.
Novak, J. M., Busscher, W. J., Watts, D. W., Amonette, J. E., Ippolito, J. A., Lima, I. M., 
Gaskin, J., Das, K.C., Steiner, C., Ahmedna, M., Rehrah, D., Schomberg, H. (2012). 
Biochars impact on soil-moisture storage in an ultisol and two aridisols. Soil Science, 
177(5), 310–320.
Peters, M. S., Timmerhaus, K. D., & West, R. E. (2003). Plant Design and Economics for 
Chemical Engineers. New York: McGraw-Hill Education.
Prabhakar, K., Maheshwari, R. C., & Vimal, O. P. (1986). Pyrolysis of coconut shell and its 
potential as fuel. Short Communication, 17(4), 313–317.
Rout, T., Pradhan, D., Singh, R. K., & Kumari, N. (2016). Exhaustive study of products obtained 
from coconut shell pyrolysis. Journal of Environmental Chemical Engineering, 4(3), 
3696–3705.
Sindhu, R., Binod, P., Pandey, A., Ankaram, S., Duan, Y., & Awasthi, M. K. (2019). 
Biofuel production from biomass: Toward sustainable development. In Sunil Kumar, 
Rakesh Kumar, & Ashok Pandey (Eds.) Current Developments in Biotechnology and 
Bioengineering—Waste Treatment Processes for Energy Generation (pp. 79–92), 
Amsterdam: Elsevier. ISBN 9780444640833.68 Optimization for Energy Systems and Supply Chains
Sy, C. L., Aviso, K. B., Ubando, A. T., & Tan, R. R. (2016). Target-oriented robust optimi￾zation of polygeneration systems. Chemical Engineering Transactions, 45, 199–204.
Tan, R. R. (2019). Data challenges in optimizing biochar-based carbon sequestration. 
Renewable and Sustainable Energy Reviews, 104(January), 174–177.
Tan, R. R., Ballacillo, J. B., Aviso, K. B., & Culaba, A. B. (2009). A fuzzy multiple-objective 
approach to the optimization of bioenergy system footprints. Chemical Engineering 
Research and Design, 7(April), 1162–1170.
Tan, Z., Lin, C. S. K., Ji, X., & Rainey, T. J. (2017). Returning biochar to fields: A review. 
Applied Soil Ecology, 116(March), 1–11.
Thompson, J. L., & Tyner, W. E. (2014). Corn stover for bioenergy production: Cost estimates 
and farmer supply response. Biomass and Bioenergy, 62, 166–173.
Tomczyk, A., Sokołowska, Z., & Boguta, P. (2020). Biochar physicochemical properties: 
pyrolysis temperature and feedstock kind effects. Reviews in Environmental Science 
and Bio/Technology, 19, 191–215
Ubando, A. T., Culaba, A. B., Aviso, K. B., Ng, D. K. S., & Tan, R. R. (2014). Fuzzy mixed￾integer linear programming model for optimizing a multi-functional bioenergy sys￾tem with biochar production for negative carbon emissions. Clean Technologies and 
Environmental Policy, 16(8), 1537–1549.
Väisänen, S., Havukainen, J., Uusitalo, V., Havukainen, M., Soukka, R., & Luoranen, M. 
(2016). Carbon footprint of biobutanol by ABE fermentation from corn and sugarcane. 
Renewable Energy, 89, 401–410.
Voll, P, Jennings, M., Hennen, M., Shah, N., & Bardow, A. (2015). The optimum is not enough: 
A near-optimal solution paradigm for energy systems synthesis, Energy, 82, 446–456.
Windeatt, J. H., Ross, A. B., Williams, P. T., Forster, P. M., Nahil, M. A., & Singh, S. (2014). 
Characteristics of biochars from crop residues: Potential for carbon sequestration and 
soil amendment. Journal of Environmental Management, 146, 189–197.
Woolf, D., Amonette, J. E., Street-Perrott, F. A., Lehmann, J., & Joseph, S. (2010). Sustainable 
biochar to mitigate global climate change. Nature Communications, 1, 56.
Yusup, S., Yiin, C. L., Tan, C. J., & Abdullah, B. (2015). Determination of optimum 
condition for the production of rice husk-derived bio-oil by slow pyrolysis pro￾cess. Process Development and Resource Conservation for Biomass Conversion, 
(November), 329–340.
Zabaniotou, A., Rovas, D., Libutti, A., & Monteleone, M. (2015). Boosting circular economy 
and closing the loop in agriculture: Case study of a small-scale pyrolysis-biochar based 
system integrated in an olive farm in symbiosis with an olive mill. Environmental 
Development, 14, 22–36.
Zafar, S. (2021). Biomass resources from rice industry. Bioenergy Consult. Retrieved January 
28, 2022, from https://www.bioenergyconsult.com/biomass-resources-rice-industry/.
Zhang, Y., Brown, T. R., Hu, G., & Brown, R. C. (2013). Comparative techno-economic analy￾sis of biohydrogen production via bio-oil gasification and bio-oil reforming. Biomass 
and Bioenergy, 51, 99–108. 
APPENDIX
Lingo Code for Case Study 1
Model:
!Capacities of the Process Units (MW);
!x1, CHP;
!x2, Pyrolyis;
!x3, Fermentation I;
!x4, Fermentation IISynthesis of Negative-Emission Biochar Systems 69
!
 
!Final output values converted to MW;
y1 = 0;
y2 = 0; 
-100 < y3; y3 < 0; @FREE(y3);
-20000 < y4; y4 < 0; @FREE(y4);
-400 < y5; y5 < 0; @FREE(y5);
y6 > 150;
y7 > 125;
y8 < 5;
y9 < 10;
y10 < 5;
y11 < 15;
!PROFIT converted to $/y;
PROFIT = (717017.2084*y3 + 53581.39535*y4 + 175592.7273*y5 +
131240.5063*y6 + 
 2307418.398*y7 + 1615650.173*y8 + 970520.5479*y9 +
2.0613E+12*y10 +
 836247.2727*y11) - ((1073033*x1*0.08) +
(3434623*x2*0.08) +
 (1450*x3*0.08) + (2241*x4*0.08) + (10492*x5*0.08) +
(5.91*x6*0.08) +
(382500*b1*0.08) + (631850*b2*0.08) + (5185749*b3*0.08) + 
(2382266*b4*0.08) + (65948913*b5*0.08) + (16449*b6*0.08));
 70 Optimization for Energy Systems and Supply Chains
!Maximize profit;
 max = PROFIT;
!CF = negative carbon footprint converted to kg/s; 
 CF = (y3/12.552*0.008) + (y4/17.2*0.017) + (y5/16.5*0.008) + 
 (y7/33.7*3.86) - (y8/26.4*1.18) - (y9/2433*192);
 
x1<(10^9)*b1; @BIN(b1);
x2<(10^9)*b2; @BIN(b2);
x3<(10^9)*b3; @BIN(b3);
x4<(10^9)*b4; @BIN(b4);
x5<(10^9)*b5; @BIN(b5);
x6<(10^9)*b6; @BIN(b6);
End
Lingo Code for Case Study 2
Model:
!Capacities of the Process Units (MW);
!x1, CHP;
!x2, Pyrolyis I;
!x3, Pyrolysis II; 
!x4, Pyrolysis III;
!x5, Fermentation I;
!x6, Fermentation II
!x7, Bioreactor;
!x8, Transesterification;
!Process Streams (MW);
!y1, syngas;
!y2, electricity;
!y3, rice husk biomass;
!y4, rice bran biomass;
!y5, coconut shell biomass;
!y6, corn stover biomass;
!y7, RH bio-oil;
!y8, RH biochar;
!y9, CS 600 bio-oil;
!y10,CS 600 biochar;
!y11,CS 300 bio-oil;
!y12,CS 300 biochar;
!y13,bioethanol;
!y14,biobutanol;
!y15,biohydrogen;
!y16,biodiesel;
 
-4.06*x1 + 3.59*x2 + 2.79*x3 + 0.23*x4 = y1;Synthesis of Negative-Emission Biochar Systems 71
1*x1 - 0.06*x2 - 0.06*x3 - 0.06*x4 - 0.0008719*x5 - 0.0114*x6 
- 0.166395*x7 - 0.000032*x8 = y2;
-15.5*x3 = y3;
-0.0183747*x8 = y4;
-17.2*x2 - 17.2*x4 = y5;
-0.021681*x5 -0.0293333*x6 - 0.005115*x7 = y6;
4.6546*x3 = y7;
7.527*x3 = y8;
8.69*x2 = y9;
9.436*x2 = y10;
3.04*x4 = y11;
21.1666*x4 = y12;
0.0057933*x5 = y13;
0.001*x6 = y14;
0.00305*x7 = y15;
0.0091667*x8 = y16;
!Final output values converted to MW;
y1 = 0;
y2 = 0; 
-100 < y4; y4 < 0; @FREE(y4);
-20000 < y5; y5 < 0; @FREE(y5);
-400 < y6; y6 < 0; @FREE(y6);
y9 > 150;
y10 > 125;
y13 > 5;
y14 > 10;
y15 > 5;
y16 > 15;
-1000 < y3; y3 < 0; @FREE(y3);
y7 < 175;
y8 < 250;
y11> 25;
y12> 100;
!PROFIT converted to $/y;
PROFIT = (717017.2084*y4 + 53581.39535*y5 + 175592.7273*y6 +
131240.5063*y9 + 
 2307418.398*y10 + 1615650.173*y13+ 970520.5479*y14 +
2.0613E+12*y15 +
 836247.2727*y16 + 53883.87097*y3 + 119912.3448*y7 + 
2287670.103*y8 +
 122400*y11 + 2309676.566*y12) -((1073033*x1*0.08) +
(3434623*x2*0.08) + (3434623*x3*0.08) +
(3434623*x4*0.08) + (1450*x5*0.08) + (2241*x6*0.08) +
(10492*x7*0.08) + (5.91*x8*0.08) + (432790*b1*0.08) +
(714924*b2*0.08) + (714924*b3*0.08) + (714924*b4*0.08) + 
(5185749*b5*0.08) + (2382266*b6*0.08) + (65948913*b7*0.08) +
 (16449*b8*0.08));
 
!Maximize profit;
 max = PROFIT;72 Optimization for Energy Systems and Supply Chains
!CF = negative carbon footprint converted to kg/s; 
 CF = (y4/12.552*0.008) + (y5/17.2*0.017) + (y6/16.5*0.008) + 
 (y10/33.7*3.86) - (y13/26.4*1.18) - (y14/2433*192) +
 (y3/15.5*0.04) + (y8/19.3*2) + (y12/30.238*3.43);
 
x1<(10^9)*b1; @BIN(b1);
x2<(10^9)*b2; @BIN(b2);
x3<(10^9)*b3; @BIN(b3);
x4<(10^9)*b4; @BIN(b4);
x5<(10^9)*b5; @BIN(b5);
x6<(10^9)*b6; @BIN(b6);
x7<(10^9)*b7; @BIN(b7);
x8<(10^9)*b8; @BIN(b8);
End73
5 A Comprehensive 
Guidance on 
Transitioning Toward 
Sustainable Hydrogen 
Network from 
Localized Renewable 
Energy System
Case Study of South Korea
Juin Yau Lim
Kyung Hee University
Bing Shen How
Swinburne University of Technology
CONTENTS
5.1 Introduction .................................................................................................... 74
5.2 Problem Statement .......................................................................................... 76
5.3 Methodology ...................................................................................................77
5.3.1 Mathematically Expressed Optimization Model ................................ 78
5.3.2 P-graph Optimization Model ..............................................................80
5.3.3 Pareto Frontier and TOPSIS ...............................................................80
5.4 Case Study Description .................................................................................. 81
5.5 Results and Discussions ..................................................................................82
5.5.1 Increase of Hydrogen Demand ...........................................................83
5.5.2 Overall Sustainable System Enhancement .........................................84
5.6 Conclusion ......................................................................................................87
Further Reading .......................................................................................................89
Acknowledgments ....................................................................................................90
References ................................................................................................................90
DOI: 10.1201/9781003240228-774 Optimization for Energy Systems and Supply Chains
5.1 INTRODUCTION
The continuous increase in world population and rapid urbanization leads to an enor￾mous increment in energy demand. Based on the estimation made by United Nation, 
the global population is expected to rise to 10.9 billion by 2100 from the 7.8 billion 
mark we have today (United Nations 2019). A much scarier fact is that according to 
Energy Information Administration (US Energy Information Administration 2020), 
the global energy consumption is expected to rise faster than population growth. 
This is aligned with the findings obtained from a research team in South China 
Agriculture University, where they found that, for every % increment in population 
size, the resultant energy consumption will be increased by 2.18% (i.e., more than 
two times the population growth) (He, 2019). This not only leads to concerns in 
energy security (Nepal and Paija 2019) but also creates risks in accelerating climate 
change due to the gigantic increment of carbon emission (Sasana and Putri 2018). 
Therefore, we are in an urgent need to drive the transition of the conventional fossil￾based energy system toward renewable and sustainable energy systems.
Being the first country in Northeast Asia which introduces a nationwide emis￾sion trading system, Korea has aimed to achieve carbon neutrality by 2050 (The 
Government of the Republic of Korea 2020). In fact, consistent efforts (e.g., the Ninth 
Basic Plan for Long-Term Electricity Supply and Demand has planned to add another 
45.6 and 24.9 GW of solar and wind generation capacity, respectively (ITA 2021)) 
have been put in place by the Korean Government to ensure that the pledge will 
materialize. Aside from these weather-driven renewable sources of energy, biogas￾to-power is another attractive alternative power generation pathway. Generally, biogas 
can be derived from the anaerobic digestors which are commonly used to treat organic 
wastes, including but not limited to sewage sludge (Liew et al. 2022), palm oil mill 
effluent (Zainal et al. 2020), and agricultural and livestock residues (Aravani et al. 
2022), while the biogas can be used in power generation (D’Aquino, Santos, and Sauer 
2022) or even serve as a feedstock for green hydrogen production (Jung et al. 2021).
Given that hydrogen is slowly but surely becoming one of the most important 
energy sources around the globe, exploring greener ways for hydrogen production 
has become one essential paradigm for all world leaders. This can be achieved by 
decarbonizing the energy sources used to generate hydrogen, e.g., consuming renew￾able power in electrolysis (Lim et al. 2021b) and converting biogas into hydrogen-rich 
gaseous products via methane reforming technologies (Hemmati et al. 2020). Note 
that the implementation of hybrid renewable energy sources (HRES) which incorpo￾rate multiple renewable energy sources can effectively deal with the issue of having 
an unstable power supply (Datta, Kalam, and Shi 2018). This, therefore, leads to a 
more reliable and sustainable nationwide energy supply system.
In order to simulate the microgrid system adopted for an HRES planning problem, 
a powerful tool like HOMERPro is required. To date, HOMERPro has been suc￾cessfully applied in various HRES case studies conducted in Malaysia (Elwan and 
Habibuddin 2021), Canada (Manzoor and Iqbal 2021), Poland (Bartecka et al. 2020), 
Brazil (Garcia, Nogueira, and Betini 2018), and Australia (Patel, Das, and Khan 
2019). Nevertheless, most of the existing works were solely focused on the planning 
of localized microgrid system, without considering the potential integration with Transitioning Toward Sustainable Hydrogen Network from RES 75
other downstream industries. Therefore, this work attempts to extend the application 
of HOMERPro to consider the green hydrogen production from the aforementioned 
renewable sources by covering several aspects including: (1) ammonia production 
using the generated green hydrogen (Salmon and Bañares-Alcántara 2021), (2) car￾bon sink technologies which capture, store, and convert the carbon dioxide, (3) CO2
emitted from the HRES, and (4) ammonia produced into urea (Ishaq et al. 2021).
On the other hand, optimization is another vital task to further maximize the overall 
feasibility of the synthesized allocation network. For example, a Multi-Integer Linear 
Programming (MILP) model has been developed by Kelechi and Tokos (2016) to 
determine the optimal configurations of technology, optimal production capacity, and 
optimal location of the renewable energy facilities with the consideration of both eco￾nomic and environmental aspects simultaneously. More recently, researchers started 
to apply meta-heuristic and artificial intelligence-based techniques such as Particle 
Swarm Optimization (PSO) (Nuvvula et al. 2022), Cuckoo Search Optimization
(CSO) (Mohamed et al. 2019), and Genetic Algorithm (GA) (Sharma, Kodamana, and 
Ramteke 2022). Despite these works being admirable, most of the applied techniques 
are capable to yield a single most optimal solution for the decision-maker. This can be 
deemed as one huge disadvantage as the near-optimal solutions are known to be impor￾tant to reveal hidden insights of the problems (Voll et al. 2015).
To address this matter, a powerful graph-theoretic tool - P-graph (Friedler et al. 
1992) is proposed in this work. It is known as a unique tool that is capable of yielding 
multiple solutions (optimal and near-optimal) simultaneously (Friedler et al. 2019). 
The usefulness of the near-optimal solutions has been well-demonstrated through a 
wide spectrum of research problems, including evacuation planning (Garcia-Ojeda 
et al. 2020), circular economy (Yeo et al. 2020), carbon management network (Tan, 
Aviso, and Foo 2017), fertilizer formulation (Lim et al. 2021a), heat exchanger net￾work synthesis (Orosz, How, and Friedler 2021), and resource conservation network 
(Lim et al. 2017). However, despite P-graph being cited as a useful and effective tool 
for solving complex energy planning problems (Kong et al. 2021), its application in 
an integrated system that considers renewable energy system, carbon capture system, 
hydrogen generation, and potential energy carrier generation is still considered scarce.
As a whole, this study aims to synthesize an optimal integrated network with the 
minimal total annual cost required. The overall optimization framework covers (1) 
development of biogas allocation network that connects supply sites (i.e. wastewa￾ter treatment plants (WWTP)) and the demand sites (i.e., the HRES); (2) decision 
in selecting optimal location and optimal capacity of steam methane reforming 
(SMR) plant in the WWTP sites; (3) decision in installing electrolyzer (ELZ) in the 
HRES region to consume excess renewable energies generated for green hydrogen 
production; (4) decision in converting the emitted CO2 into value-added products; 
and (5) determination of an optimal energy mix between renewable and non￾renewable power. The remainder of this chapter is structured as follows: Section 
5.2 presents the problem statement of this study, and the research methodology 
used for this work is shown in Section 5.3. The case study descriptions are detailed 
in Section 5.4. It is followed by results and discussions in Section 5.5 and a con￾cluding remark in Section 5.6. Finally, some suggested future readings are outlined 
in Section 5.7.76 Optimization for Energy Systems and Supply Chains
5.2 PROBLEM STATEMENT
This study aims to provide a comprehensive study on generating hydrogen with the 
integration between different localized hybrid renewable energy system (HRES) and 
the wastewater treatment plant (WWTP). Whereby excess renewable electricity, REi, 
is found in each of the localized HRES and could be the source of electricity that 
supplies the system proposed, where i (i =1, 2, 3, …, I) represents different renew￾able energy sources. On the other hand, each of the WWTP that generates biogas 
from anaerobic digestion process results in a specific amount of biogas supply, BGj
, 
that avail for further utilization in the system after fulfilling the biogas demand in 
the HRES region, where j (j =1, 2, 3, …, J) represents different biogas source. Two 
major hydrogen-generating technologies electrolysis and steam methane reforming 
(SMR) will be considered in this study in accordance with the integration framework 
proposed. A strategic deployment of the hydrogen technology will be decided based 
on the location where electrolysis, ELZi
, and steam methane reforming, SMRj
, will 
be deployed at the designated location in accordance with the HRES and WWTP, 
respectively. Apart from the hydrogen generated, ammonia and urea will be further 
considered in the integration between the HRES and WWTP due to their potential as 
an energy carrier. The carbon dioxide emission from the renewable energy resources 
(CO2,i
) and biogas sources (CO2,j
) will be considered either for capture (for storage 
of further utilization) or as direct emission. An overall framework of this integrative 
network between HRES and WWTP in different locations is illustrated in Figure 5.1.
Five major parts are considered in the integrated network proposed earlier: (1) 
biogas supply-demand network, (2) options for hydrogen generation, (3) carbon diox￾ide capture and utilization, (4) inclusion of energy potential energy carrier, and (5) 
electricity utilization. The distribution of biogas toward the hydrogen generation 
FIGURE 5.1 Framework of transitioning localized hybrid renewable energy sources and 
wastewater treatment plant. (Reprinted with permission from Lim et al. (2020), copyrighted 
2021 Elsevier.)Transitioning Toward Sustainable Hydrogen Network from RES 77
based on SMR will be decided upon meeting the biogas demand in the HRES 
region from the supplies in WWTP. Then, hydrogen is generated using two different 
approaches – electrolysis and steam-methane reforming – which work within the 
HRES and WWTP regions, respectively. The CO2 emitted in the proposed frame￾work (HRES, non-renewable electricity, and SMR) will be considered either for 
capture or further treatment. Apart from hydrogen generation, two potential energy 
carriers (ammonia and urea) will be considered in the utilization of hydrogen and 
carbon dioxide from the integrated system. Last but not least, electricity utilization 
will consider the use of renewable and non-renewable electricity.
5.3 METHODOLOGY
The research framework considered in this study is shown in Figure 5.2 and consists 
of three main parts: (1) simulation, (2) optimization, and (3) analysis. In which, the 
biogas availability from the WWTP (BSM-2 modeling with Matlab) and the excess 
electricity identification from HRES (localized renewable energy system deployment 
with HOMERPRO) are identified based on the wastewater characteristics and meteo￾rological data alongside the energy demand, respectively. An optimal configuration 
of the integrative network will be identified based on the mixed-integer linear pro￾gramming (MILP) model developed by minimizing the total annual cost. Then, the 
mathematically developed MILP model is transformed into the P-graph model. Upon 
identifying a pool of feasible solutions from P-graph, an extensive analysis is per￾formed via Pareto frontier analysis and technique for order of preference by similar￾ity to ideal solution (TOPSIS) on identifying an optimal solution for the integrative 
network proposed. Notably, the optimal solution considers both the economic and 
environmental aspects.
FIGURE 5.2 Flowchart of the methodology based on the proposed research framework. 
(Reprinted with permission from Lim et al. (2020), copyrighted 2021 Elsevier.)78 Optimization for Energy Systems and Supply Chains
5.3.1 matHematiCally exPressed oPtimization model
This study aims to minimize the total annual cost, TAC, of the integrative network as 
shown in Eq. (5.1). The TAC accounts for different sections in the network including 
the biogas pipelines TCpipe
total
, steam methane reforming (TCSMR total ), electrolyzer (TCEZR
total), 
carbon capture system (TCCC
total), and potential energy carrier (TCPEC total).
Min TAC= TCpipe SMR EZR CC PEC
total+TC + total TCtotal  + TC   total +  TC   total (5.1)
A cost breakdown (covering capital, operational, and utility) for each element in the 
integrative network is listed in Table 5.1 with the relevant equations for biogas pipe￾lines (Eqs. 5.2–5.5), SMR (Eqs. 5.6–5.9), electrolyzer (Eqs. 5.10–5.12), CCS (Eqs. 
5.13–5.16), and PEC (Eqs. 5.17–5.19) indicated. A detailed discussion of each equa￾tion can be found in Lim et al. (2020).
TABLE 5.1
The Equations Considered in the Study from Lim et al. (2020)
Elements Remarks Expressed Equation Eq.
Biogas Total cost TC = pipe
to  TC + pipe  TC + pipe pipe 5.2 tal capital operating  TCenergy
pipelines
Capital cost pipe ∑∑PC    × × result
TC   = bwwtp,bda  Distwwtp,bda 5.3
capital DP wwtp bda
Operating cost TC = pipe pipe 5.4 operating  TC   capital × 0.05
Utility cost pipe ∑∑∑∑( ) 5.5 TC   utility = × CEP      xbg,bda,wwtp,bdn ×  result   bwwtp, bda
bg bda wwtp bdn
× Priceconv
elec
SMR Total cost TC = SMR  TC + SMR capita  T SMR total l C + SMR operating  TCutility 5.6
Capital cost  x 5.7
SRI   × hyd,smr,wwtp,bdn 

 CSMR =∑∑∑∑ ss  SRC  T ss
capital DP hyd smr wwtp bdn
Operating cost 5.8 TC S SMR operating = × ∑∑∑∑ ROss    xhyd,smr,wwtp,bdn
hyd smr wwtp bdn
Utility cost TC P SMR = × ∑ ∑ ∑ ∑ ( ) 5.9 Utility ricew xw,smr,wwtp,bdn w smr wwtp bdn
+ × ∑ ∑ x bdn ( ) e r∑ wwt ∑ Pric elec elec,smr,wwtp,bdn elec sm p
+ × ∑ ∑ ∑ ( ) Priceng xng,smr,wwtp,bdn ng∑smr wwtp bdn
(Continued)Transitioning Toward Sustainable Hydrogen Network from RES 79
TABLE 5.1 (Continued)
The Equations Considered in the Study from Lim et al. (2020)
Elements Remarks Expressed Equation Eq.
ELZ Total cost TC = EZR
total TCEZR
capital  + TCEZR
utility 5.10
Capital cost  x  5.11
EZI
∑∑∑∑ es × hyd,elz,rea,hres   EZR  EZCes  TC   capital = DP hyd elz rea hres
Utility cost TC   EZR
utility = ×   P ∑∑∑∑( ) 5.12 ricew w    x ,elz,rea,hres
w elz rea hres
+ ×   P ∑∑∑∑( ) riceelec,rea,hres    xrenewable elec,elz,rea,hres
elec elz rea hres
CCS Total cost TC = CC CC CC CP total  TC + capital  TC   operating + TC 5.13
Capital cost  xco2,ccs  5.14
PCI   cs ×  
T CC  PCC  C   capital = ∑∑ cs
DP co2 ccs
Operating cost TC   CC
operating = × ∑∑ 5.15 PCO   cs xco2,ccs
co2 ccs
Penalties TC   CP = × ∑∑ 5.16 PriceCDP c x o2,cp
co2 cp
PER Total cost TC = PER  TC + ammonia total total  TCurea
total 5.17
Ammonia  x  5.18
API   × amm
production as    APC  TCammonia total = as     + × 
Price   elec x cost elec,amm 
 DP
Urea   xurea   5.19
production  UPI   us ×    urea   UPCus 
cost TC =  total     DP   
 
+ ×   U[ ] POus   P x x urea + ×  riceelec     elec,urea 80 Optimization for Energy Systems and Supply Chains
5.3.2 P-graPH oPtimization model
P-graph was initially developed to solve various kinds of process network synthesis 
problems in the engineering field. The user-friendly interface of P-graph studio has 
allowed the ease of developing the model by representing the core vertices: materials 
(M-type) and operating unit (O-type) in the form of circular dots and horizontal bars, 
respectively. As of the M-type vertices, three main subsets of raw materials, inter￾mediate products, and final products are involved. The detailed mechanism of the 
P-graph based on the five axioms established can be found in Friedler et al. (1992). 
Apart from the user-friendly interface, the accelerated branch-and-bound (ABB) 
algorithm has the capability of proposing a pool of near-optimal solutions from the 
model developed which is important while tackling real-life problems. Such P-graph 
model is then developed in accordance with the mathematical optimization model 
aforementioned in Section 5.3.1. An overview of the P-graph model can be seen in 
Figure 5.3 which involves six different segments including: (A) biogas distribution 
network, (B) steam methane reforming system, (C) electrolysis, (D) carbon capture 
system, (E) potential energy carrier, and (F) non-renewable electricity.
5.3.3 Pareto Frontier and toPsis
A post analysis including Pareto frontier analysis and TOPSIS is proposed upon 
successfully identifying the pool of near-optimal solutions from P-graph. Such an 
approach is essential as the ranking based on the solutions generated by P-graph is 
solely based on the economic aspects which then lead to the importance of a further 
analysis of the solution pool considering both the economic (total annual cost) and 
environmental aspects (total CO2 emission). First, min-max normalization is imple￾mented on the pool of near-optimal solutions based on the decision desirability in 
accordance with the maximum (most desirable) and minimum (less-desirable). The 
Pareto frontier is identified from the pool of near optimal solutions.
TOPSIS is then implemented to propose the most sustainable network integration 
configuration with its promising multi-criteria decision-making approach. Notably, 
the assignment of weights is omitted with both economic and environmental aspects 
being considered equally important. Euclidean distance of the normalized solution, 
Sol
Norm i n,  toward the positive-ideal solution and negative-ideal solution is identified as 
D+
n (See Eqn. 20) and D−
n (See Eqn. 21), respectively. Whereby Sol
min
i n, and Sol
max i n,
represents the lowest and highest possible value in the pool of solutions. Thereupon, 
the relative closeness, Cn (See Eqn. 22), is calculated to rank the identified Pareto 
frontier. In which a bigger value of Cn indicates a more desirable solution considering 
both assessment criteria of total annual cost and total CO2 emission.
2
D+
n = −   S ∑( ) olNorm i n,   Solmin
i n, (5.20)
i
2
D+
n = −   S ∑( ) olNorm i n,   Solmin
i n, (5.21)
iTransitioning Toward Sustainable Hydrogen Network from RES 81
D−
C n
n = (5.22) D D + −
n n +
5.4 CASE STUDY DESCRIPTION
The developed model aforementioned is validated with the case study in South 
Korea. As shown in Figure 5.4, a total of 16 HRES regions and 15 WWTP regions 
are involved as per the framework proposed. The important information extracted 
from the simulation for both the HRES is the excess electricity, CO2 emission, bio￾gas demand, and cost of energy; whereas the biogas production is identified for the 
regions involving WWTP. As of the biogas distribution network proposed earlier, a 
model reduction approach will be done in which the biogas demand in the HRES 
regions will be supplied with the biogas supplied from the WWTP within similar 
political regions. The deficit (HRES region) and remaining (WWTP region) of the 
biogas are then identified accordingly. Notably, the parameters for the economic 
evaluations are standardized based on the Chemical Engineering Plant Cost Index 
(CEPCI). All the relatable parametric information can be found in Lim et al. (2020).
FIGURE 5.3 The developed P-graph model based on the problem statement: (A) Biogas 
pipeline distribution network, (B) Steam methane reforming system, (C) Electrolyzer, (D) 
Carbon capture system, (E) Potential energy carrier, and (F) Non-renewable electricity. 
(Reprinted with permission from Lim et al. (2020), copyrighted 2021 Elsevier.)82 Optimization for Energy Systems and Supply Chains
5.5 RESULTS AND DISCUSSIONS
This study aims to minimize the total annual cost for the integrative network pro￾posed earlier to determine the optimal configuration of the biogas distribution 
network, hydrogen production deployment, carbon capture system, and electricity 
utilization. Such configuration is targeted to meet the hydrogen demand of 7,200 
tons of H2/year in regards to the petrochemical industry in Daesan, South Korea. The 
optimal configuration for the network is shown in Figure 5.5 which resulted in a TAC 
of 75,772,460 US $/year where 93% of the cost comes from the operating units (i.e., 
SMR and biogas piping construction) and the remaining 7% is from materials (i.e., 
water and renewable electricity). The total biogas pipeline distance in the network 
was found at 1,214.9 km.
All locations in the HRES region (exception for Gunsan and Pohang) are uti￾lized to supply the electricity (3.4 × 107 kWh/year) toward the entire integrative net￾work proposed. Notably, only four locations in WWTP are selected to meet the 
hydrogen demand of 7,200 H2/year via the allocation of steam methane reforming 
technology. Locations involved in hydrogen production are Cheongbuk (87.65 tons 
H2/year), Cheongnam (1,277.9 tons H2/year), Gyeongnam (1,691.6 tons H2/year), 
and Gyeonggi (4,142.3 tons H2/year). In which the overall CO2 generated from 
the network is found at 5.9 × 104 tons of CO2/year, whereas the freshwater usage is 
1.17 × 105 tons H2O/year.
FIGURE 5.4 An overview of the case study proposed for the integrative network between 
the regions of hybrid renewable energy system and wastewater treatment plant. (Reprinted 
with permission from J.Y. Lim et al. (2020), copyrighted 2021 Elsevier.)Transitioning Toward Sustainable Hydrogen Network from RES 83
5.5.1 inCrease oF Hydrogen demand
In the attempt to successful identification for the optimal integrative network upon 
meeting the base demand of 7,200 tons H2/year, an extensive scenario where the 
demand for H2 is increased by 20% is attempted. Such scenario allows the assess￾ment of the robustness of the P-graph model developed when experiencing spikes in 
hydrogen demand. As per results, the TAC increased by 3.2% (78,262,399 US$/year) 
in comparison to the base demand of 7,200 tons H2/year. The hydrogen generation 
upon meeting the demands has acquired both the SMR (7,661 tons H2/year) and ELZ 
(979 tons H2/year) technology. Whereas the electricity utilization for such an inte￾grative network has proposed a mixture of 4.43 × 106 kWh/year renewable electricity 
and 1.17 × 105 kWh/year of non-renewable electricity. Notably, the CO2 existing in the 
system is directly discharged into the atmosphere in solutions proposed by the P-graph 
model developed as the penalty is the cheaper option while comparing to the imple￾mentation of carbon capture system. In which such configuration could not ensure the 
sustainability of the system proposed by omitting the environmental concerns.
Hence, a scenario where the environmental regulation is enforced having all the 
carbon dioxide captured is explored. As a result of this, the TAC is increased toward 
103,160,000 US $/year based on the configuration proposed in Figure 5.6. The hydro￾gen production for the steam methane reforming and electrolysis is encountered with 
the capacity of 7,336 tons H2/year and 1,304 tons H2/year, respectively. Whereby a 
FIGURE 5.5 Integrative network proposed in accordance with meeting the hydrogen 
demand in the petrochemical industry. (Reprinted with permission from Lim et al. (2020), 
copyrighted 2021 Elsevier.)84 Optimization for Energy Systems and Supply Chains
100% dependency on non-renewable electricity is found where 3.5 × 107 kWh/year of 
electricity is demanded. The hydrogen generation in accordance with the regions for 
electrolyzer and steam-methane reforming is shown in Tables 5.2 and 5.3, respectively.
5.5.2 overall sustainable system enHanCement
An extensive evaluation is performed to identify the most sustainable solution con￾sidering both the economic and environmental aspects based on the configura￾tion proposed in Section 5.3.3. A total of 50 near-optimal solutions were identified 
from the P-graph model based on a 20% hydrogen demand increase alongside tight 
environmental regulation enforcement. The TAC of the solution pool ranges from 
103,160,000 US$/year to 103,262,000 US$/year, whereas the CO2 emission is rang￾ing from 9.12 × 104 tons CO2/year to 9.14 × 104 tons of CO2/year. Notably, the pool of 
near-optimal does not cover the entire search space of the model created in consid￾eration of the computational time with the hardware availability. A total of 13 Pareto 
frontier (marked in red diagonal shape) were found as shown in Figure 5.7 after 
performing the min-max normalization. Notably, the 13 Pareto frontier identified is 
based on this case study and might vary when the scenarios differed (i.e., 30% and 
40% increase in hydrogen demand). The TAC and total CO2 emission range from 
103,160,000 to 103,260,000 US$/year and 9.12 × 104 to 9.13 × 104 tons of CO2/year, 
respectively.
Upon identifying the Pareto frontier, TOPSIS is implemented to rank the solutions 
considering both economic and environmental aspects. As shown in Table 5.4, the 
FIGURE 5.6 Optimal configuration for 20% increase of the hydrogen demand consider￾ing tight environmental regulation enforcement. (Modified with permission from Lim et al. 
(2020), copyrighted 2021 Elsevier.)Transitioning Toward Sustainable Hydrogen Network from RES 85
TABLE 5.2
Production Capacity of the Electrolyzer at 20% Increase of 
Hydrogen Demand under Different Condition
HRES Region
Electrolyzer Production Capacity (Tons H2/Year)
Without Environmental Regulation Environmental Regulation
1. Busan – 112.38
2. Cheongju 267.03 267.03
3. Daegu 0.09 0.09
4. Daejeon 5.72 5.72
5. Gangneung 3.58 3.58
6. Gunsan – 63.10
7. Gwangju 1.73 1.73
8. Gyeongju 71.94 71.94
9. Incheon 428.00 428.00
10. Jeonju 1.30 1.30
11. Jinju 3.48 3.48
12. Pohang 184.65 334.86
13. Seoul 0.20 0.20
14. Wonju 3.85 3.85
15. Yangsan 3.25 3.25
16. Yeongju 3.73 3.73
Source: Modified with permission from Lim et al. (2020), copyrighted 2021 Elsevier.
TABLE 5.3
Production Capacity of the Steam Methane Reforming at 20% 
Increase of Hydrogen Demand
HRES Region
Steam Methane Reformer Production Capacity (Tons H2/Year)
Without Environmental Regulation Environmental Regulation
Cheongbuk – –
Cheongnam 1,049 1,049
Gangwon – –
Gyeongbuk – –
Gyeonggi 4,050.4 2,687.7
Gyeongnam 292.65 –
Jeollanam – 292.7
Jeonbuk – –
Ulsan 2,269.4 3,306.4
Source: Modified with permission from Lim et al. (2020), copyrighted 2021 Elsevier.86 Optimization for Energy Systems and Supply Chains
TOPSIS ranked 1 solution (most sustainable configuration) is originated from the 
P-graph ranked 20 solution, whereas the ranked 1 from the P-graph solution falls 
into rank 4 after performing TOPSIS analysis. Such integrative network configura￾tion has the TAC and total CO2 emission of 103,236,000 US$/year and 9.12 × 104
tons of CO2/year, respectively. Both the ranked 1 from P-graph solution and TOPSIS 
FIGURE 5.7 Pareto frontier found in the 50 near-optimal solution pool from the 20% hydro￾gen demand increased. (Modified with permission from Lim et al. (2020), copyrighted 2021 
Elsevier.)
TABLE 5.4
TOPSIS Results for 20% Increase of Hydrogen Demand
Scenario: 20% Increase in Hydrogen Demand (Carbon Captured)
Total Annual Cost Total CO2 Emission
TOPSIS Rank (US $/Year) (Tons CO2/Year) P-graph Rank
1 103,236,000.00 91,213.20 20
2 103,241,000.00 91,205.10 23
3 103,193,000.00 91,282.40 8
4 103,160,000.00 91,335.40 1
5 103,260,000.00 91,174.20 45
6 103,249,000.00 91,191.90 32
7 103,242,000.00 91,203.10 26
8 103,164,000.00 91,328.40 2
9 103,246,000.00 91,196.10 29
10 103,236,000.00 91,212.10 21
11 103,231,000.00 91,220.20 19
12 103,188,000.00 91,289.40 7
13 103,244,000.00 91,198.80 27
Source: Modified with permission from Lim et al. (2020), copyrighted 2021 Elsevier.Transitioning Toward Sustainable Hydrogen Network from RES 87
solution are shown in Figure 5.9a and b, respectively. The configuration of such solu￾tion can be referred to in Figure 5.8. As a comparison of this sustainability enhance￾ment approach, the electrolyzer original deployed in the region of Seoul and Yangsan 
is currently substituted with the utilization of electricity that would supply to other 
parts of the system. Notably, the hydrogen production capacity in Gunsan is increased 
by 5.5% from the original production of 63.1 tons H2/year. 
5.6 CONCLUSION
Explicit insights on transitioning the localized excess renewable electricity and the 
biogas generated from wastewater treatment plants are shown in this study. In which, 
a mathematical optimization model is developed on identifying an optimal integra￾tive network and a P-graph model is constructed accordingly. A case study in South 
Korea is incorporated to ensure the validity of the model developed in which such 
model will ensure to fulfill the base hydrogen demand of 7,200 tons H2/year target￾ing the petrochemical industry. The total annual cost is found to be 75,772,460 US 
$/year with a total biogas pipeline length of 1,214.9 km. Then, a scenario where a 
20% increase in hydrogen demand is implemented alongside the condition where 
a tight environmental regulation (all CO2 emission will be captured) will be imple￾mented. In return, the TAC is increased toward 103,160,000 US $/year. A further 
enhancement of the sustainability of the configuration proposed is executed with 
the aid of Pareto frontier analysis and TOPSIS. As per result, the TAC and total CO2
emission are reported to be 103,236,000 US$/year and 9.12 × 104 tons of CO2/year, 
FIGURE 5.8 Optimal configuration while 20% increase of hydrogen demand. (Modified 
with permission from Lim et al. (2020), copyrighted 2021 Elsevier.)88 Optimization for Energy Systems and Supply Chains
FIGURE 5.9 Results proposed from the P-graph model in 20% increase of hydrogen 
demand: (a) ranked 1 in P-graph which considers economic aspects only and (b) ranked 1 
with TOPSIS analysis that considers both economic and environmental aspects.Transitioning Toward Sustainable Hydrogen Network from RES 89
respectively. In summary, this research has provided an example of transitioning 
excessive electricity, carbon dioxide, and biogas into hydrogen on a nationwide scale 
which extends the limits of the original configuration that is only restricted to the 
localized renewable energy system.
FURTHER READING
The following listed materials are recommended for further reading:
 I. Nationwide sustainable renewable energy and Power-to-X deployment 
 II. Shaving electric bills with renewables? A multi-period pinch-based method
 III. Blockchain as a frontier in biotechnology and bioenergy applications (Loy 
 IV. Toward data-driven process integration for renewable energy planning 
 V. Evaluation of an integrated microalgae-based biorefinery process and 90 Optimization for Energy Systems and Supply Chains
ACKNOWLEDGMENTS
The authors would like to thank the financial support offered by the Universiti of 
Teknologi Brunei via the UTB Seed Fund (Grant no.: UTB/GSR/3/2021 (5)).
REFERENCES
Aravani, V.P, H. Sun, Z. Yang, G. Liu, W. Wang, G. Anagnostopoulos, G. Syriopoulos, et al. 
2022. “Agricultural and livestock sector’s residues in Greece & China: comparative 
qualitative and quantitative characterization for assessing their potential for biogas pro￾duction.” Renewable and Sustainable Energy Reviews 154: 111821. Doi: 10.1016/j.
rser.2021.111821.
Bartecka, M., P. Terlikowski, M. Kłos, and Ł. Michalski. 2020. “Sizing of prosumer hybrid 
renewable energy systems in Poland.” Bulletin of the Polish Academy of Sciences: 
Technical Sciences. Doi -10.24425/Bpasts.2020.133125 68 (No. 4 (i.a. Special Section 
on Advances in Electrical Power Engineering)): 721–731. http://journals.pan.pl/
Content/116303/PDF/08_721-731_01496_Bpast.No.68-4_27.08.20.pdf.
D’Aquino, C.A, S.C Santos, and I.L. Sauer. 2022. “Biogas as an alternative source of decentral￾ized bioelectricity for large waste producers: An assessment framework at the University 
of São Paulo.” Energy 239: 122326. Doi: 10.1016/j.energy.2021.122326.
Datta, U., A. Kalam, and J. Shi. 2018. “1- Hybrid PV–wind renewable energy sources for 
microgrid application: An overview.” In Woodhead Publishing Series in Energy, edited 
by A. Hina Fathima, N. Prabaharan, K. Palanisamy, A. Kalam, S. Mekhilef, and J.B.T. 
Jackson. Hybrid-Renewable Energy Systems in Microgrids Justo, 1–22. Woodhead 
Publishing. Doi: 10.1016/B978-0-08-102493-5.00001-7.
Elwan, A.A., and M.H. Habibuddin. 2021. “Techno-economic analysis of a grid-connected 
waste to energy gasification plant: A case study.” Energy Engineering: Journal of the 
Association of Energy Engineering 118 (6): 1681–1701. Doi: 10.32604/EE.2021.016291.
Friedler, F., K.B. Aviso, B. Bertok, D.C.Y. Foo, and R.R. Tan. 2019. “Prospects and challenges 
for chemical process synthesis with P-graph.” Current Opinion in Chemical Engineering
26: 58–64. Doi: 10.1016/j.coche.2019.08.007.
Friedler, F., K. Tarjan, Y.W. Huang, and L.T. Fan. 1992a. “Combinatorial algorithms for pro￾cess synthesis.” Computers and Chemical Engineering 16: S313–S320. Doi: 10.1016/
S0098-1354(09)80037-9.
Friedler, F., K. Tarján, Y. W. Huang, and L. T. Fan. 1992b. “Graph-theoretic approach to pro￾cess synthesis: Axioms and theorems.” Chemical Engineering Science 47 (8): 1973–
1988. Doi: 10.1016/0009-2509(92)80315-4.
Garcia, G., E.F. Nogueira, and R.C. Betini. 2018. “Solar energy for residential use and its con￾tribution to the energy matrix of the state of Paraná.” Brazilian Archives of Biology and 
Technology 61 (Special issue). Doi: 10.1590/1678-4324-smart-2018000510.
Garcia-Ojeda, J.C., A. Argoti, B. Bertok, and F. Friedler. 2020. “Modeling and assessing evacu￾ation route plans by resorting to the P-graph framework.” 2020 Smart Cities Symposium 
Prague, SCSP 2020, 2–7. Doi: 10.1109/SCSP49987.2020.9134050.
He, Y. 2019. “How population growth impacts energy consumption in guangdong in China.”
Behavioural Sciences: 1–2. https://researchfeatures.com/population-growth-energy
-consumption-guangdong-china/.
Hemmati, S., M.M. Elnegihi, C.H. Lee, D.Y.L. Chong, D.C.Y. Foo, B.S. How, and C.K. Yoo. 
2020. “Synthesis of large-scale bio-hydrogen network using waste gas from landfill and 
anaerobic digestion: A p-graph approach.” Processes 8 (5). Doi: 10.3390/PR8050505.
Ishaq, H., O. Siddiqui, G. Chehade, and I. Dincer. 2021. “A solar and wind driven energy 
system for hydrogen and urea production with CO2 capturing.” International Journal of 
Hydrogen Energy 46 (6): 4749–4760. Doi: 10.1016/j.ijhydene.2020.01.208.Transitioning Toward Sustainable Hydrogen Network from RES 91
ITA, International Trade Administration. 2021. “South Korea - country commercial guide.” 
2021. https://www.trade.gov/country-commercial-guides/south-korea-energy-new-and
-renewable%0A%0A.
Jung, S., J. Lee, D.H. Moon, K.-H. Kim, and E.E Kwon. 2021. “Upgrading biogas into syngas 
through dry reforming.” Renewable and Sustainable Energy Reviews 143: 110949. Doi: 
10.1016/j.rser.2021.110949.
Kelechi, O., and H. Tokos. 2016. “An MILP model for the optimization of hybrid renewable 
energy system.” In 26 European Symposium on Computer Aided Process Engineering, 
edited by Z. Kravanja and B.T. Miloš. Computer Aided Chemical Engineering Bogataj, 
38: 2193–2198, Elsevier. Doi: 10.1016/B978-0-444-63428-3.50370-2.
Kong, K.G.H., B.S. How, S.Y. Teng, W.D. Leong, D.C.Y. Foo, R.R. Tan, and J. Sunarso. 2021. 
“Towards data-driven process integration for renewable energy planning.” Current 
Opinion in Chemical Engineering 31: 100665. Doi: 10.1016/j.coche.2020.100665.
Kong, K.G.H., B.S. How, J.Y. Lim, W.D. Leong, S.Y. Teng, W.P.Q. Ng, I. Moser, and J. Sunarso. 
2022. “Shaving electric bills with renewables? A multi-period pinch-based methodology 
for energy planning.” Energy 239: 122320. Doi: 10.1016/j.energy.2021.122320.
Liew, C.S., N.M. Yunus, B.S. Chidi, M.K. Lam, P.S. Goh, M. Mohamad, J.C. Sin, S.M. Lam, 
J.W. Lim, and S.S. Lam. 2022. “A review on recent disposal of hazardous sewage sludge 
via anaerobic digestion and novel composting.” Journal of Hazardous Materials 423: 
126995. Doi: 10.1016/j.jhazmat.2021.126995.
Lim, C.H., P.S. Pereira, C.K. Shum, W.J. Ong, R.R. Tan, H.L. Lam, and D.C.Y. Foo. 2017. 
“Synthesis of resource conservation networks with P-graph approach—direct reuse/
recycle.” Process Integration and Optimization for Sustainability 1 (1): 69–86. Doi: 
10.1007/s41660-017-0005-2.
Lim, J.Y., B.S. How, G. Rhee, S. Hwangbo, and C.K. Yoo. 2020. “Transitioning of localized 
renewable energy system towards sustainable hydrogen development planning: P-graph 
approach.” Applied Energy 263. Doi: 10.1016/j.apenergy.2020.114635.
Lim, J.Y., B.S. How, S.Y. Teng, W.D. Leong, J.P. Tang, H.L. Lam, and C.K. Yoo. 2021a. 
“Multi-objective lifecycle optimization for oil palm fertilizer formulation: A hybrid 
P-graph and TOPSIS approach.” Resources, Conservation and Recycling 166 (August 
2020): 105357. Doi: 10.1016/j.resconrec.2020.105357.
Lim, J.Y., U. Safder, B.S. How, P. Ifaei, and C.K. Yoo. 2021b. “Nationwide sustainable renew￾able energy and power-to-X deployment planning in South Korea assisted with forecast￾ing model.” Applied Energy 283: 116302. Doi: 10.1016/j.apenergy.2020.116302.
Loy, A.C.M., J.Y. Lim, B.S. How, and C.K. Yoo. 2021. “Blockchain as a frontier in bio￾technology and bioenergy applications.” Trends in Biotechnology. Doi: 10.1016/j.
tibtech.2021.09.006.
Manzoor, S., and M. T. Iqbal. 2021. “Dynamic modeling and simulation of the rooftop PV sys￾tem for the first passive house in newfoundland.” Journal of Physics: Conference Series
1803 (1). Doi: 10.1088/1742–6596/1803/1/012017.
Mohamed, M.A, A.M Eltamaly, A.I. Alolah, and A.Y. Hatata. 2019. “A novel framework￾based cuckoo search algorithm for sizing and optimization of grid-independent hybrid 
renewable energy systems.” International Journal of Green Energy 16 (1): 86–100. Doi: 
10.1080/15435075.2018.1533837.
Nepal, R., and N. Paija. 2019. “Energy security, electricity, population and economic growth: 
The case of a developing south asian resource-rich economy.” Energy Policy 132: 
771–781. Doi: 10.1016/j.enpol.2019.05.054.
Nuvvula, R.S.S., E. Devaraj, R.M. Elavarasan, S.I. Taheri, M. Irfan, and K.S. Teegala. 2022. 
“Multi-objective mutation-enabled adaptive local attractor quantum behaved parti￾cle swarm optimisation based optimal sizing of hybrid renewable energy system for 
smart cities in India.” Sustainable Energy Technologies and Assessments 49: 101689. 
Doi: 10.1016/j.seta.2021.101689.92 Optimization for Energy Systems and Supply Chains
Orosz, Á., B.S. How, and F. Friedler. 2021. “Multiple-solution heat exchanger network syn￾thesis using P-HENS solver.” Journal of the Taiwan Institute of Chemical Engineers. 
Doi: 10.1016/j.jtice.2021.05.006.
Patel, K., N. Das, and M.M.K. Khan. 2019. “Optimization of hybrid solar, wind and die￾sel energy systems from economic point of view.” 2019 29th Australasian Universities 
Power Engineering Conference, AUPEC 2019 2019 (November): 26–29. Doi: 10.1109/
AUPEC48547.2019.211861.
Rhee, G., J.Y. Lim, S. Hwangbo, and C.K. Yoo. 2020. “Evaluation of an integrated micro￾algae-based biorefinery process and energy-recovery system from livestock manure 
using a superstructure model.” Journal of Cleaner Production 125325. Doi: 10.1016/j.
jclepro.2020.125325.
Salmon, N., and R. Bañares-Alcántara. 2021. “Green ammonia as a spatial energy vector: A 
review.” Sustainable Energy & Fuels 5 (11): 2814–2839. Doi: 10.1039/D1SE00345C.
Sasana, H., and A.E. Putri. 2018. “The increase of energy consumption and carbon diox￾ide (CO2) emission in Indonesia.” E3S Web of Conferences 31: 1–5. Doi: 10.1051/
e3sconf/20183101008.
Sharma, R., H. Kodamana, and M. Ramteke. 2022. “Multi-objective dynamic optimization 
of hybrid renewable energy systems.” Chemical Engineering and Processing - Process 
Intensification 170: 108663. Doi: 10.1016/j.cep.2021.108663.
Tan, R.R., K.B. Aviso, and D.C.Y. Foo. 2017. “P-graph and Monte Carlo simulation approach 
to planning carbon management networks.” Computers and Chemical Engineering 106: 
872–882. Doi: 10.1016/j.compchemeng.2017.01.047.
The Government of the Republic of Korea. 2020. “2050 carbon neutral strategy of the Republic 
of Korea: Towards a sustainable and green society.” Republic of Korea, no. December: 
1–131.
United Nations. 2019. World population prospects 2019. Department of economic and social 
affairs. World population prospects 2019. http://www.ncbi.nlm.nih.gov/pubmed/12283219.
US Energy Information Administration, EIA. 2020. “Global electricity consumption continues 
to rise faster than population.” https://www.eia.gov/todayinenergy/detail.php?id=44095.
Voll, P., M. Jennings, M. Hennen, N. Shah, and A. Bardow. 2015. “The optimum is not enough: 
A near-optimal solution paradigm for energy systems synthesis.” Energy 82: 446–456. 
Doi: 10.1016/j.energy.2015.01.055.
Yeo, J.Y.J., B.S. How, S.Y. Teng, W.D. Leong, W.P.Q. Ng, C.H. Lim, S.L. Ngan, J. Sunarso, 
and H.L. Lam. 2020. “Synthesis of sustainable circular economy in palm oil industry 
using graph-theoretic method.” Sustainability (Switzerland) 12 (19): 1–29. Doi: 10.3390/
su12198081.
Zainal, B.S., M.A. Ahmad, M. Danaee, N. Jamadon, N.S. Mohd, and S. Ibrahim. 2020. 
“Integrated system technology of pome treatment for biohydrogen and biomethane 
production in Malaysia.” Applied Sciences (Switzerland) 10 (3): 1–18. Doi: 10.3390/
app10030951.93
6 An Optimization 
Framework for 
Polygeneration System 
Driven by Glycerine 
Pitch and Diesel
Wai Mun Chan and Irene Mei Leng Chew
Monash University Malaysia
6.1 INTRODUCTION
A polygeneration system generates heat and power as well as other utilities like clean 
water, chilled water, chemicals, or biofuels in a single integrated system (Ray and 
De, 2019). A combined cycle gas turbine (CCGT) is used in the polygeneration sys￾tem for electricity generation. In CCGT, the gas turbine exhaust heat is recovered as 
CONTENTS
6.1 Introduction ....................................................................................................93
6.2 Methodology ...................................................................................................95
6.2.1 Brayton Cycle .....................................................................................96
6.2.2 Steam Cycle ........................................................................................97
6.2.3 Waste Heat Recovery System .............................................................98
6.2.4 Utility Demand .................................................................................100
6.2.5 Objective Function ............................................................................100
6.3 Case Study .................................................................................................... 101
6.4 Results and Discussion ................................................................................. 101
6.4.1 Scenario 1 ......................................................................................... 102
6.4.2 Scenario 2 ......................................................................................... 102
6.4.3 Cost Analysis .................................................................................... 106
6.5 Conclusion .................................................................................................... 107
Nomenclature ......................................................................................................... 107
Variable ......................................................................................................... 107
Parameter ...................................................................................................... 107
Superscript .................................................................................................... 108
Further Reading ..................................................................................................... 108
References .............................................................................................................. 108
DOI: 10.1201/9781003240228-894 Optimization for Energy Systems and Supply Chains
steam through a heat recovery steam generator, and the steam is then used to power a 
steam turbine for extra power generation. The CCGT has an overall efficiency of 50%–
60%, which is higher than a simple cycle gas turbine with only up to 40% efficiency 
(Zohuri, 2017). On the other hand, combined heat and power (CHP) is the basic form 
of polygeneration. Unlike CCGT that utilizes all steam for electricity generation, CHP 
sends a portion of the steam from the heat recovery steam generator for heating in order 
to generate heat and electricity simultaneously. A techno-economic model is devel￾oped by Shnaiderman and Keren (2014) to compare the performance between CHP and 
natural gas steam boilers. Their results showed that CHP has a shorter return on invest￾ment and greater cost savings as compared to a natural gas steam boiler. Caglayan and 
Caliskan (2018) assessed the application of CHP in the ceramic industry and found 
that the use of CHP increases energy efficiency by 17.5% and provides significant sav￾ings in natural gas for tile dryer operations. Other than that, some literature aimed to 
enhance the economic feasibility and energy efficiency of CHP through the utiliza￾tion of municipal solid waste (Casas-Ledón et al., 2017) and renewable energy such as 
geothermal energy (Van Erdeweghe et al., 2018), wind energy (Zheng et al., 2018), and 
solar energy (Ancona et al., 2017). Despite that, some amount of heat from the steam 
turbine outlet in CHP remains untapped in the form of low-pressure steam between 
110°C and 160°C. This “waste” heat is deemed as low-grade waste heat (LGWH), and 
they are less useful as compared to higher-grade waste heat because the temperature 
is too low for power production. However, as technology advances, they can be further 
utilized to produce various utilities such as chilled water and desalinated water with the 
help of LGWH recovery technologies (Ammar et al., 2012).
On the other hand, there are some researches that explored the polygeneration 
system which combines CHP with both absorption refrigeration system (ARS) and 
multi-effect desalination (MED) to produce electricity, heat, chilled water, and desal￾inated water. In Rubio-Maya et al. (2011), a mathematical optimization approach is 
used to study the optimal sizing of the polygeneration plant fuelled by natural gas, 
solar energy, and gasified biomass. The optimization is based on a superstructure that 
contains all possible configurations for a polygeneration plant. Maraver et al. (2012) 
assessed the economic feasibility of polygeneration system comprised of Organic 
Rankine Cycle, domestic hot water unit, MED, and ARS using Aspen Plus. They 
reported that the approximate payback period of the proposed configuration ranges 
between 4 and 20 years, depending on fuel prices and capital costs.
Despite several existing works on the polygeneration system using renewable energy 
sources including solar energy and biomass, there is a lack of literature in evaluating 
the cost savings potential of utilizing diesel-glycerine pitch in the polygeneration sys￾tem. Glycerine pitch is a scheduled waste generated from the fatty acid plants during 
the glycerol concentration process, and it is commonly disposed of in a landfill. In 
Malaysia, the cost of landfill is approximately RM 500/t, and incineration is between 
RM 810/t and RM 3600/t (Hidawati et al., 2003). In an attempt to save cost and envi￾ronment, various researches have been performed to study the conversion of glycerine 
pitch into value-added products like copolymer (Ramachandran and Amirul, 2013), 
acetic acid (Irvan et al., 2018), and activated carbon (Gonçalves et al., 2019). Aside 
from chemical conversion for the co-production of bioproducts, a different alterna￾tive to valorize glycerine pitch is to recover its energy content through combustion. 
Glycerine pitch has a calorific value of about 13,800 kJ/kg. Merapan (2015) reported An Optimization Framework for Polygeneration System 95
significant cost savings from the utilization of 60:40 diesel-glycerine pitch blend for 
boiler operation. Nevertheless, a research gap remains to study the effect of glycerine 
pitch percentage in the fuel blend and the price of glycerine pitch on the economic 
feasibility of the polygeneration system driven by glycerine pitch and diesel fuel blend.
To address the aforementioned research gaps, a superstructure of a polygeneration 
network is generated. The superstructure consists of CCGT, multi-effect desalina￾tion (MED), reverse osmosis (RO), vapor compression refrigeration system (VCRS), 
and absorption refrigeration system (ARS) for the simultaneous production of power, 
heat, desalinated water, and chilled water. It is formulated as mixed-integer nonlinear 
programming (MINLP) model with the objective function of total annual cost (TAC) 
minimization. The optimization variables are the flow rate of steam turbine exhaust to 
different waste heat recovery technologies and the plant-wide unit operation selection 
and sizing. Several scenarios are created to study the integration of LGWH recovery 
technologies and the utilization of glycerine pitch-diesel fuel. Sensitivity analysis is 
performed on the optimization model to study the effect of glycerine pitch percentage 
in the blend and the glycerine pitch unit price on the polygeneration network.
6.2 METHODOLOGY
The superstructure of the polygeneration network is shown in Figure 6.1. The math￾ematical model presented in this section is arranged in the following manner: (1) 
Brayton cycle, (2) steam cycle, (3) waste heat recovery system, (4) utilities demand, 
and (5) objective function.
FIGURE 6.1 Superstructure of polygeneration network.96 Optimization for Energy Systems and Supply Chains
6.2.1 brayton CyCle
Brayton cycle is the first cycle in CCGT; it describes the transformation of fuel to 
electricity generation through the use of a compressor, combustion chamber, and 
gas turbine. In the Brayton cycle, the air is taken into the compressor at ambient 
temperature. The temperature of the air leaving the compressor T2 is calculated 
using Eq. (6.1).
T AIR _ 2
= ϕ T ( )γ −1
COMP γ AIR _1 (6.1)
where the T AIR _1 is the temperature of the air entering the compressor at ambient 
temperature, T AIR _ 2
 is the temperature of air temperature leaving the compressor, 
and γ is the specific heat ratio that takes a value of 1.4. The compression ratio ϕCOMP
is taken to be 15 (Rueda Martínez, 2011).
The work done by the compressor (W COMP ) is evaluated Eq. (6.2). The air intake 
into the system is determined using Eq. (6.3)
W m COMP = −  AIR A C T IR
p ( ) AIR _ 2 A T IR_1 (6.2)
m  AIR F = m UEL _CCϕAF (6.3)
where m AIR is the air mass flow rate, C AIR p is the specific heat capacity of the air taken 
at 1.3 kJ/kg °C, m FUEL _ CC
 is the fuel intake into the combustion chamber, and ϕAF is 
the air-to-fuel ratio, which is adapted from Merapan (2015); the air-to-fuel ratio for 
diesel fuel is 19.10.
The compressed air from the compressor outlet is then sent to the air-fuel com￾bustion chamber, where both the compressed air and diesel fuel are mixed together 
and combusted. Energy balance for the combustion of the air-fuel mixture is given 
as follows:
P m CC = −   GASC T GAS GAS_1 AIR AIR p p m C T AIR _ 2
 (6.4)
m  GAS = + m m FUEL _ CC A IR (6.5)
PCC
m FUEL _ CC = )
ηCCLHVFUEL _ CC (6.6
where PCC is the heat transfer within the combustion chamber, m GAS is the mass flow 
rate of flue gas with a mixture of fuel and air, CGAS
p is the specific heat capacity of flue 
gas, T GAS_1 is the temperature of flue gas leaving the combustion chamber, m FUEL _ CC
is the mass flow rate of fuel entering the combustion chamber, and LHVFUEL _ CC
 is 
the lower heating value of the fuel. ηCC is the efficiency of combustion chamber; it is 
assumed as 85%.An Optimization Framework for Polygeneration System 97
The outlet flue gas from the combustion chamber is then expanded in the gas tur￾bine. Energy balance around the gas turbine is modeled as follows:
γ −1
T GAS_ 2  1  γ
=   T GAS_1  ϕCOMP (6.7) 
P m GT = − ηGT  GASC T GAS
p ( ) GAS_1 T GAS_ 2 (6.8)
where PGT is the power extracted from the gas turbine, ηGT is the efficiency of the 
gas turbine, and T GAS_ 2 is the temperature of exhaust flue gas from the gas turbine.
6.2.2 steam CyCle
The steam cycle is the second cycle in CCGT; it consists of material balance around 
the heat recovery steam generator that recovers heat from gas turbine exhaust gas 
and the steam turbine that generates additional electricity. In the steam cycle, a 
single-pressure HRSG with superheater, evaporator, and economizer sections is used 
for the generation of superheated steam. Energy balance around the superheater is 
given in Eq. (6.9).
m  S_ HRSG ( ) h h SH − = SAT _S m C GAS GAS ( ) T T GAS_ 2 SH p − (6.9)
where m S_ HRSG is the mass flow rate of steam entering the HRSG, hSH is the enthalpy 
of superheated steam, hSAT _S
 is the enthalpy of saturated steam, and TSH is the tem￾perature of the gas leaving the superheater.
Energy balance around the evaporator section of the HRSG is interpreted using 
Eq. (6.10).
m  S_ HRSG ( ) h h SAT _S S − = AT_ W m C GAS GAS p ( ) T T SH − EVP (6.10)
where hSAT _ W is the enthalpy of saturated water andT EVP
 is the temperature of the gas 
leaving evaporator.
Energy balance around the economizer section of HRSG is given in Eq. (6.11).
m  S_ HRSG ( ) h h SAT _ W E     − = C _ W m C GAS GAS p ( ) T T EVP E − X (6.11)
where hEC_ W is the enthalpy of hot water entering the economizer and T EX is the 
temperature of the exhaust gas leaving the HRSG.
The high-pressure superheated steam that is generated from the HRSG is then 
expanded using a steam turbine to generate a secondary source of electricity. The 
secondary energy extracted from the steam turbine (PST) is evaluated by using 
Eq. (6.12).
P m ST = − ηST  S_ HRSG ( ) h h SH ST_ S (6.12)98 Optimization for Energy Systems and Supply Chains
where ηST is the efficiency of the steam turbine and hST_ S is the enthalpy of steam 
leaving the steam turbine.
The exhaust steam from the steam turbine is combined with the steam generated 
from the auxiliary boiler. The properties of boiler steam are assumed similar to the 
exhaust steam from the steam turbine outlet. After that, the mixed stream is allocated 
to four pathways: direct pathway to condenser with waste heat recovery, MED for 
desalination, ARS for chilled water generation, and process heating. 
m  S_ HRSG + = m m S_ BOILER  S_SC (6.13)
m  S_SC = + m m S_COND   S_ MED S + + m m _ ARS  S_ HEAT (6.14)
where m S_ BOILER is the mass flow rate of steam generated from the auxiliary boiler; 
m S _SC is the mass flow rate of steam in the steam cycle; and   , m m   S_COND S_ MED ,
m S_ ARS ,  and m S_ HEAT is the mass flow rate of steam to the condenser, MED, ARS, 
and process heating, respectively.
The energy balance of the auxiliary boiler is shown in Eq. (6.15).
m  S_ BOILER = ηBOILERmFUEL _ BOILERLHVFUEL _ BOILER (6.15)
where ηBOILER is the efficiency of the boiler, with a value of 0.85 and LHVFUEL _ BOILER
is the lower heating value of boiler fuel.
6.2.3 waste Heat reCovery system
Four pathways are available for LGWH recovery to generate plant utilities, namely 
MED for desalination, double-effect ARS for chilled water, direct process heating, 
and direct condensation without LGWH recovery.
The first pathway is the recovery of steam to desalinate seawater or brackish water 
using MED for the intention of reuse and potable uses. The MED unit is modeled 
based on the gain output ratio (GORMED) with the following equation (Frantz and 
Seifert, 2015).
GORMED S = −0.001( ) T T _S2 + − 0.152TST_ S 5.70 (6.16)
where TST_ S is the temperature of steam leaving the steam turbine and entering the 
MED.
The mass flow rate of desalinated water is obtained using Eq. (6.17).
m  DW _ MED = mS_ MED M GOR ED (6.17)
where m DW _ MED is the desalinated water mass flow rate.
The second pathway represents the recovery of LGWH to power a double-effect 
ARS for chilled water generation. The energy balance for steam-driven ARS is 
shown as follows:An Optimization Framework for Polygeneration System 99
P m
Equation (6.19) describes the derivation of cooling power using the coefficient of 
performance. Equation (6.20) converts the cooling power from kW to refrigeration 
tonne (RT).
P P CHW _ ARS W = H _ ARS A COP RS (6.19)
S P ARS R = x T CHW _ ARS (6.20)
where PCHW _ ARS
 is the cooling power provided by ARS and COPARS
 is the coefficient 
of performance that is affected by steam temperature TST_ S. The correlation between 
COPARS and TST_ S is data fitted using results from Gomri (2009) for double-effect 
ARS. S ARS
 is the capacity of ARS expressed in refrigeration tonne (RT); xRT is the 
unit conversion from kW to RT.
The third pathway utilizes steam for direct process heating (m S_ HEAT) with the 
limiting heat sink temperature of 100°C. Equation (6.21) describes the derivation of 
thermal energy from the steam exhaust to process heating (PS_ HEAT).
P m S_ HEAT = −  S_ HEAT ( ) h h ST_ S HEAT_ W (6.21)
where hHEAT_ W is the enthalpy of condensate after process heating.
The fourth pathway is the default configuration that bypasses LGWH recovery. 
The steam from this pathway mixes with exhaust steam or condensate from other 
LGWH recovery pathways. The resulting stream enters the condenser to reduce the 
temperature to the inlet temperature of HRSG. The heat transfer area of the con￾denser is determined using Eq. (6.22).
m h S S _ C C h
ACOND  ( ) OND_1 − COND_ 0
= COND (6.22) U T∆ LMTD
where ACOND is the heat transfer area of the condenser, UCOND is the overall heat 
transfer coefficient between steam and cooling water, ∆TLMTD is the log-mean tem￾perature difference, and hCOND_1 and hCOND_ 0 are the enthalpy of condenser inlet and 
outlet streams.
The condensate outlet from the condenser and all LGWH recovery technologies 
are gathered and pumped to the required pressure before resuming the entire steam 
cycle. The electricity consumed by the pump is determined using Eq. (6.23).
P m PUMP = −  S ( ) p p EC_ W ATM (6.23)
where pEC_ W is the pressure of water entering an economizer. Condensate is assumed 
at the atmospheric pressure (pATM).100 Optimization for Energy Systems and Supply Chains
6.2.4 utility demand
Four types of utilities will be produced in the proposed polygeneration system: elec￾tricity, heat, desalinated water, and chilled water. The mass and energy balances of 
desalinated water, chilled water, and process heating are shown in Eqs. (6.24)–(6.26).
mDW = + m m DW _ RO DW _ MED (6.24)
P P CHW C = + HW _ VS C P HW _ ARS (6.25)
P P HEAT = HEAT_ S (6.26)
where mDW, PCHW, and PHEAT are the plant demand for desalinated water, chilled 
water, and process heating. These demands are fulfilled by either the commercial 
units (mDW _ RO
 for RO and PCHW _ VS for VCRS) that consume fresh energy or the 
waste heat recovery technologies that are driven by steam from the steam cycle. 
In Eq. (6.26), the heat demand is fulfilled only by the energy from the steam cycle 
because the boiler is taken into account in Eq. (6.13).
Equations (6.27)–(6.28) are used to link the mDW _ RO, PCHW _ VS, and PHEAT_ BL
 to 
their respective fresh energy supply.
P m ELC_ RO D = W _ROϕRO (6.27)
P P ELC_ VS C = HW _ VS V COP S
 (6.28)
where PELC_ VS
 is the electricity demand for RO; PCHW _ VS is the electricity demand 
of VCRS; m FUEL _ BL
 is the diesel required for the boiler; ϕRO is the electricity con￾sumption per unit mass flow rate of clean water produced by RO, which has a value 
of 7 kWh/t (Lenntech, 2019); and COPVS is the coefficient of performance of VCRS, 
which has a value of 4 (Chan et al., 2017).
The energy balance for electricity demand is shown in Eq. (6.29), and the mass 
balance of fuel is shown in Eq. (6.30).
P P GT + = ST PELC_ PLANT + + P P ELC_ RO ELC_ VS
 (6.29)
m  FUEL = + m m FUEL _ BL F  UEL _CC (6.30)
where PELC_ PLANT is the electricity demand for the overall plant and m FUEL is the 
overall fuel demand.
6.2.5 objeCtive FunCtion
The objective function of this work is to minimize TAC for the overall network, 
which takes into account the annual operating cost and annualized capital cost. The 
annual operating cost is contributed only by the cost of fuel, whereas the capital cost 
includes the cost of all unit operations mentioned above.An Optimization Framework for Polygeneration System 101
Equation (6.31) describes the derivation of the total annual cost in this work.
TAC=OPC + KaCAP (6.31)
where OPC is the annual operating cost, CAP is the total capital investment cost of 
all unit operations, and Ka is the annualized capital cost factor. It is assumed that the 
plant will run for a 15 years period, with a discounting factor of 5% per annum on 
the asset value.
6.3 CASE STUDY
This case study evaluates the integration of polygeneration network in an offshore 
platform. Due to the lack of support in electricity from the power grid, the elec￾tricity supply of the platform originates from the CCGT on the platform itself. 
The integration of polygeneration network utilizes the LGWH from the CCGT to 
generate various utilities for the platform. The electricity, thermal, chilled water, 
and clean water demands in this case study are adapted from literature, and they 
are summarized in Table 6.1. The incoming water sources are brackish water and 
seawater; they are assumed to contain total dissolved solid (TDS) greater than 
2,000 mg/L. The chilled water supply and return temperature are assumed as 7°C 
and 15°C. Two scenarios are used in this case study. Scenario 1 represents the com￾mercial CCGT without LGWH recovery, while Scenario 2 involves the integration 
of LGWH recovery technologies into the CCGT utilizing various blends of diesel￾glycerine pitch.
6.4 RESULTS AND DISCUSSION
The superstructure of polygeneration is solved using LINGO v18.0 nonlinear and 
global solver. The model has a total of 76 variables and consists of 25 nonlinear 
variables. The solution runtime is 15 seconds, and the model class is in the MINLP 
model. The results and discussion are divided into three sub-sections. Sections 6.4.1 
and 6.4.2 provide insight into the optimized network of Scenarios 1 and 2, respec￾tively. Section 6.4.3 compares the cost components between different scenarios, and 
discussion is made accordingly.
TABLE 6.1
Offshore Platform Utility Demand (Micale et al., 
2009; Pitchaimuthu et al., 2017; Zhang et al., 2019)
Utility Demand
Electricity 37,224 kW
Chilled water 3,000 RT
Thermal 19,483 kW
Clean water 5,000 m3/day102 Optimization for Energy Systems and Supply Chains
6.4.1 sCenario 1
Scenario 1 illustrates commercial CCGT without any LGWH recovery technolo￾gies. It uses 2.10 kg/s of diesel to generate 43.39 MW of electricity (Figure 6.2). The 
platform utilizes 85.7% of the total electricity for various operations and systems, 
such as drilling and mining, crude oil process, and natural gas system. The rest of 
the electricity is consumed by RO for desalination, VCRS for chilled water genera￾tion, and air compressor for gas turbine operation. Aside from that, the steam turbine 
exhaust is fed directly to a condenser without any waste heat recovery. Therefore, 
an additional 0.51 kg/s diesel fuel is used for process heating. The overall network 
consumes a total of 2.61 kg/s of diesel fuel.
6.4.2 sCenario 2
Scenario 2 illustrates the integration of LGWH recovery technologies into the CCGT. 
In this study, the fuel blend of glycerine pitch and diesel is used for the boiler operation. 
The economic feasibility of this scenario depends on the percentage blend of glycerine 
pitch in the fuel. High glycerine pitch percentage requires a low amount of diesel fuel, 
which in turn reduces the operating cost. A sensitivity analysis is performed to study 
the effect of glycerine pitch percentage on economic performance (Figure 6.3). Based 
on the sensitivity trend in Figure 6.3, the total annual cost remains constant at glycer￾ine pitch percentage lower than 70%. After that, the curve starts to decline at a rate of 
40,000 USD per glycerine pitch percentage. At 90% glycerine pitch, the reduction rate 
FIGURE 6.2 Optimized network for Scenario 1.An Optimization Framework for Polygeneration System 103
increases to 160,000 USD per glycerine pitch percentage. The increase in reduction 
rate throughout the sensitivity analysis is caused by the network changes. Based on the 
sensitivity analysis, Scenario 2 is divided into Scenarios 2a, 2b, and 2c to represent the 
scenario at 0%, 70%, and 90% glycerine pitch, respectively (Figure 6.4).
FIGURE 6.3 Sensitivity analysis of glycerine pitch percentage.
FIGURE 6.4 Optimized network for Scenario 2a using pure diesel as boiler fuel.104 Optimization for Energy Systems and Supply Chains
At glycerine pitch percentage below 70%, the network only recovers energy from 
the steam turbine exhaust for the ARS and thermal demand (Figure 6.5). The boiler is 
not selected in the network because the savings in utilizing glycerine pitch and diesel 
blend are insufficient to overcome the additional investment in the boiler and LGWH 
recovery technologies. As a result, the clean water demand is fulfilled by RO, and the 
chilled water demand is partially supplied by the VCRS. At 70%–90% glycerine pitch 
(Figure 6.6), the boiler is used, and it is driven by 0.34 kg/s of glycerine pitch-diesel 
fuel. On top of that, the capacity of ARS increases as the boiler sends more steam to the 
LGWH recovery area. However, the clean water demand is still supplied solely from 
RO. Lastly, the network changes to Figure 6.7 as the glycerine pitch exceeds 90%. At 
this percentage, the savings in boiler fuel is able to justify the investment in MED. As a 
result, the boiler fuel intake increases from 0.34 to 0.78 kg/s in order to drive the MED 
unit. Nevertheless, the utilization of glycerine pitch as a boiler fuel is known to cause 
tube choking and clogging issues (Merapan, 2015). Therefore, prior testing on the maxi￾mum tolerable glycerine pitch percentage must be performed before actual application.
Scenario 2 shows significant changes as compared to Scenario 1 even at low glycer￾ine pitch percentage. By comparing Figures 6.4 and 6.5, the recovery of steam turbine 
exhaust eliminates the usage of the boiler to fulfill the thermal demand. Aside from that, 
the remaining steam turbine exhaust is sent to the ARS, causing a reduction in VCRS 
electricity demand. As a result, the diesel intake is reduced from 2.61 in Scenario 1 to 
2.06 kg/s in Scenario 2a. At higher glycerine pitch percentage, the diesel fuel intake 
reduces further to 1.96 kg/s in Scenario 2b and 1.89 kg/s in Scenario 2c as more of the 
clean water and chilled water demands are fulfilled by LGWH recovery technologies. 
Based on the differences in Scenario 2a–c, it can be drawn that the steam is allocated 
FIGURE 6.5 Optimized network for Scenario 2b using 70% glycerine pitch and 30% diesel 
as boiler fuel.An Optimization Framework for Polygeneration System 105
FIGURE 6.6 Optimized network for Scenario 2c using 90% glycerine pitch and 10% diesel 
as boiler fuel.
FIGURE 6.7 Sensitivity analysis of glycerine pitch price.106 Optimization for Energy Systems and Supply Chains
primarily to thermal demand, followed by ARS and MED. The sequence of allocation is 
decided through its capital cost and conversion efficiency. Unit operations with low capi￾tal cost and high conversion efficiency are likely to be chosen as compared to the others. 
6.4.3 Cost analysis
According to Table 6.2, Scenario 1 has the greatest capital cost despite having a 
simple network configuration without LGWH recovery (Figure 6.2). Although the 
integration of ARS and MED requires higher capital investment as compared to 
VCRS and RO, the utilization of steam turbine exhaust reduces the overall electricity 
demand. As a result, the capacity and capital cost of gas turbine, HRSG, and steam 
turbine are reduced, causing a decrease in the annualized capital cost. Based on the 
cost analysis, a 4.30% reduction in the annualized capital cost is obtained at 70% 
glycerine pitch, and a 5.78% reduction at 90% glycerine pitch. Aside from that, the 
reduction in electricity demand has also cut down the operating cost significantly due 
to reduced diesel fuel intake for the gas turbine cycle. Consequently, the annual oper￾ating cost and total annual cost are reduced by 23% and 21%, respectively, after the 
integration of LGWH recovery and the utilization of glycerine pitch. Nevertheless, 
it should be noted that this is the case only when the price of glycerine pitch is 
zero. The price may increase once the value of glycerine pitch is discovered and the 
demand begins to pick up. Therefore, a sensitivity analysis is performed to determine 
the feasible price range of glycerine pitch for the polygeneration system.
Based on Figure 6.7, the trade-off point varies according to the glycerine pitch 
percentage in the fuel. The trade-off point is 20 USD/t for Scenario 2b and 45 USD/t 
for Scenario 2b. Above the maximum price limit, glycerine pitch is no longer deemed 
economically feasible for the polygeneration network. Therefore, this analysis pro￾vides crucial information for both glycerine pitch suppliers and power plant owners 
during the procurement process. 
TABLE 6.2
Cost Analysis 
Scenario 2a Scenario 2b Scenario 2c
Scenario 1 Pure Diesel 70% GP 90 % GP
Components (106 USD/y) (106 USD /y) (106 USD/y) (106 USD/y)
Gas turbine cycle
Heat recovery steam generator
Steam turbine
58.13
3.09
 3.47
57.17
3.05
 3.42
54.42
2.95
 3.28
52.37
2.87
 3.17
Condenser 0.02 - - -
Multi-effect desalination - - - 5.74
Reverse osmosis 4.84 4.84 4.84 -
Absorption chiller
Vapour compression chiller
Annualized capital cost
Annual operating cost
Total annual cost
-
0.53
 6.75
43.60
50.35
 0.55
0.43
 6.69
34.47
41.16
 1.35
-
6.46
34.56
41.02
 1.35
-
6.36
33.47
39.83An Optimization Framework for Polygeneration System 107
6.5 CONCLUSION
In this work, a superstructure of the polygeneration network has been devel￾oped and solved using MINLP. The superstructure contains CCGT for power 
generation, boiler for thermal energy generation, RO and MED for clean water 
generation, and VCRS and ARS for chilled water generation. In this work, the 
polygeneration system is integrated with glycerine pitch and diesel as boiler fuel 
to generate steam for the LGWH recovery technologies, such as ARS and MED. 
Based on the results, the proposed polygeneration network driven by glycerine 
pitch and diesel is able to reduce both the capital cost and operating cost of the 
platform significantly as compared to the commercial CCGT. However, the eco￾nomic feasibility of the proposed network is affected by the maximum tolerable 
glycerine pitch percentage in the fuel blend. Future works would study the valori￾zation of glycerine pitch to form other value-added products through the integra￾tion of different refinery processes.
NOMENCLATURE

A Area, m2
F Flow rate, kg/s
m Mass flow rate, kg/s
GOR Gain output ratio
OPC Annual operating cost, USD/y
p Pressure, kPa
P Power consumption, kWh
Q Energy, kW
S Cooling capacity in refrigeration tonne
T Temperature, °C
CAP Annualized capital cost, USD/y
TAC Total annual cost, USD/y
Parameter
Cp Specific heat capacity, kJ/kg °C
COP Coefficient of performance
LHV Lower heating value, kJ/kg
U Heat transfer coefficient, W/m2 °C
ta Annual operation days, days/y
x Conversion factor
ϕ Ratio
γ Specific heat ratio
η Efficiency
Ka Annualized cost factor108 Optimization for Energy Systems and Supply Chains
suPersCriPt
ARS Absorption refrigeration system
ATM Ambient condition
BL Boiler
COMP Compressor 
COND Condenser
CC Combustion chamber
CHW Chilled water
DW Desalinated water
EC Economizer
EVP Evaporator
GT Gas turbine
LMTD Log-mean temperature difference
MED Multi-effect desalination
RO Reverse osmosis
RT Refrigeration tonne
S Steam
SH Superheated steam
SAT Saturated 
ST Steam turbine
VS Vapor compression refrigeration system
W Water
WH Waste heat
FURTHER READING
Chan, W.M., Y.T. Leong, J.J. Foo and I.M.L. Chew, 2017. Synthesis of energy efficient chilled 
and cooling water network by integrating waste heat recovery refrigeration system. 
Energy, 141, 1555–1568.
Chan, W.M., Y.T. Leong, J.J. Foo and I.M.L. Chew, 2019. Economic viability for the synthesis 
of multiperiod thermal-driven chilled water network, Applied Thermal Engineering, 
147, 312–323.
Chan, W.M., Y.T. Leong and I.M.L. Chew, 2020. Multiple-criteria evaluation of centralized 
chilled water hub powered by industrial waste heat and renewable energy, Journal of 
Cleaner Production.
REFERENCES
Ammar, Y., S. Joyce, R. Norman, Y. Wang and A.P. Roskilly, 2012. Low grade thermal 
energy sources and uses from the process industry in the UK. Applied Energy, 89(1): 
3–20. Doi: 10.1016/j.apenergy.2011.06.003.
Ancona, M.A., M. Bianchi, E. Diolaiti, A. Giannuzzi, B. Marano, F. Melino and A. Peretto, 
2017. A novel solar concentrator system for combined heat and power application in res￾idential sector. Applied Energy, 185: 1199–1209. Doi: 10.1016/j.apenergy.2016.03.026.
Caglayan, H. and H. Caliskan, 2018. Energy, exergy and sustainability assessments of a 
cogeneration system for ceramic industry. Applied Thermal Engineering, 136: 504–515. 
Doi: 10.1016/j.applthermaleng.2018.02.064.An Optimization Framework for Polygeneration System 109
Casas-Ledón, Y., F. Spaudo and L.E. Arteaga-Pérez, 2017. Exergoenvironmental analysis of a 
waste-based integrated combined cycle (WICC) for heat and power production. Journal 
of Cleaner Production, 164: 187–197. Doi: 10.1016/j.jclepro.2017.06.211.
Frantz, C. and B. Seifert, 2015. Thermal analysis of a multi effect distillation plant powered by 
a solar tower plant. Energy Procedia, 69: 1928–1937. Doi: 10.1016/j.egypro.2015.03.190.
Gomri, R., 2009. Second law comparison of single effect and double effect vapour absorption 
refrigeration systems. Energy Conversion and Management, 50(5): 1279–1287. Doi: 
10.1016/j.enconman.2009.01.019.
Gonçalves, M., C.S. Castro, I.K.V. Boas, F.C. Soler, E.d.C. Pinto, R.L. Lavall and W.A. 
Carvalho, 2019. Glycerin waste as sustainable precursor for activated carbon production: 
Adsorption properties and application in supercapacitors. Journal of Environmental 
Chemical Engineering, 7(3): 103059. Doi: 10.1016/j.jece.2019.103059.
Hazimah, A.H., T.L. Ooi, and A. Salmial, 2003. Recovery of glycerol and diglycerol from 
glycerol pitch. Journal of Oil Palm Research, 15(1): 1–5.
Irvan, B. Trisakti, R. Hasibuan and M. Joli, 2018. Fermentative utilization of glycerol resi￾due for the production of acetic acid. IOP Conference Series: Materials Science and 
Engineering, 309: 012126. Doi: 10.1088/1757-899x/309/1/012126.
Lenntech. Reverse osmosis desalination cost analysis. Website: https://www.lenntech.com/
processes/desalination/energy/general/desalination-costs.htm. 
Maraver, D., J. Uche and J. Royo, 2012. Assessment of high temperature organic 
Rankine cycle engine for polygeneration with med desalination: A preliminary 
approach. Energy Conversion and Management, 53(1): 108–117. Doi: 10.1016/j.
enconman.2011.08.013.
Marques, C., G. Davies, G.G. Maidment, J. Evans and I. Wood, 2013. The Use of Phase 
Change Materials in Domestic Refrigerator Applications. Proceedings of the Institute 
of Refrigeration.
Merapan, K., 2015. Glycerine Pitch from Glycerine Concentration Process as Alternative 
Fuel for Boiler Operations. Master’s thesis. University Teknologi Malaysia.
Micale, G., L. Rizzuti and A. Cipollina, 2009. Seawater Desalination: Conventional and Renewable 
Energy Processes. Springer, Berlin, Heidelberg. Doi: 10.1007/978-3-642-01150-4
Pitchaimuthu, D., J.Y. Lee, M.M. El-Halwagi and D.C.Y. Foo, 2017. A superstructure 
approach for the design of heating utility system. Chemical Engineering Transactions, 
61: 1897–1902.
Ramachandran, H. and A.A. Amirul, 2013. Evaluation of unrefined glycerine pitch as an 
efficient renewable carbon resource for the biosynthesis of novel yellow-pigmented 
p(3hb-co-4hb) copolymer towards green technology. Biotechnology and Bioprocess 
Engineering, 18(6): 1250–1257. Doi 10.1007/s12257-013-0452-8.
Ray, A. and S. De, 2019. Polygeneration using renewable resources: Cost optimization using 
linear programming. Process Integration and Optimization for Sustainability, 3(1): 
115–124. Doi 10.1007/s41660-018-0053-2.
Rubio-Maya, C., J. Uche-Marcuello, A. Martínez-Gracia and A.A. Bayod-Rújula, 2011. 
Design optimization of a polygeneration plant fuelled by natural gas and renewable 
energy sources. Applied Energy, 88(2): 449–457. Doi: 10.1016/j.apenergy.2010.07.009.
Rueda Martínez, F., 2011. Evaluation of the gas turbine inlet temperature with relation 
to the excess air. Energy and Power Engineering, 03(04): 517–524. DOI: 10.4236/
epe.2011.34063
Shnaiderman, M. and N. Keren, 2014. Cogeneration versus natural gas steam boiler: A techno￾economic model. Applied Energy, 131: 128–138. Doi: 10.1016/j.apenergy.2014.06.020.
Van Erdeweghe, S., J. Van Bael, B. Laenen and W. D’Haeseleer, 2018. Optimal combined 
heat-and-power plant for a low-temperature geothermal source. Energy, 150: 396–409. 
Doi: 10.1016/j.energy.2018.01.136.110 Optimization for Energy Systems and Supply Chains
Zhang, A., H. Zhang, M. Qadrdan, W. Yang, X. Jin and J. Wu, 2019. Optimal planning of inte￾grated energy systems for offshore oil extraction and processing platforms. Energies, 
12(4): 756.
Zheng, J., Z. Zhou, J. Zhao and J. Wang, 2018. Integrated heat and power dispatch truly uti￾lizing thermal inertia of district heating network for wind power integration. Applied 
Energy, 211: 865–874. Doi: 10.1016/j.apenergy.2017.11.080.
Zohuri, B., (ed.) 2017. Combined cycle-driven efficiency in nuclear power plant. In: Thermal￾Hydraulic Analysis of Nuclear Reactors. Springer International Publishing, Cham: 
pp. 523–552. Doi: 10.1007/978-3-319-53829-7_16111
7 Multi-Objective 
Optimization of TEG 
Dehydration Process 
to Mitigate BTEX 
Emission under Feed 
Composition Uncertainty
Rajib Mukherjee and Krystal Smith
The University of Texas Permian Basin
7.1 INTRODUCTION
Natural gas processing involves the removal of acidic gases followed by dehydration. 
The dehydration is primarily carried out through absorption in tri-ethylene glycol 
(TEG). During the dehydration process, volatile organic compounds (VOCs) includ￾ing benzene, toluene, ethylbenzene, and isomers of xylene, together known as BTEX, 
that are present in natural gas are absorbed into the glycol solvent. During the ther￾mal regeneration process of TEG, a substantial amount of the BTEX and VOCs 
are emitted resulting in adverse environmental as well as health impacts, leading 
CONTENTS
7.1 Introduction .................................................................................................. 111
7.2 Methodology ................................................................................................. 114
7.2.1 Data Generation and Metamodel Development ................................ 117
7.2.2 Robust Multi-objective Optimization (RMOO) ............................... 117
7.3 Results and Discussions ................................................................................ 119
7.3.1 Metamodel Generation ..................................................................... 121
7.3.2 EACO-Based Robust Multi-objective Optimization ........................ 121
7.3.3 Pareto Front Generation .................................................................... 123
7.3.4 Value of Stochastic Solution (VSS) .................................................. 127
7.4 Conclusions ................................................................................................... 129
Further Reading ..................................................................................................... 129
Acknowledgments .................................................................................................. 130
References .............................................................................................................. 130
DOI: 10.1201/9781003240228-9112 Optimization for Energy Systems and Supply Chains
to strict regulations. Effective mitigation of the emission is essential for the natural 
gas industry. There are several process parameters associated with major equipment 
that may impact BTEX emission. Regulation of some of these parameters is found 
to have an adverse impact on the dehydration process. In this work, a multi-objective 
optimization is performed to find the optimal operating conditions related to the 
process parameters to mitigate BTEX emission while fulfilling the dry gas water 
specification. The process becomes more challenging in the context of uncertain 
process variables. Thus, a stochastic multi-objective optimization is required for 
robust solution. The analysis is performed using data-driven modeling using machine 
learning algorithms followed by optimization with probabilistic technique. Support 
vector regression (SVR) is used for metamodeling, and metaheuristic efficient ant 
colony optimization (EACO) is used for optimization. The surrogate or metamodel is 
generated with data obtained from chemical process simulation. Using SVR-EACO 
strategy, different optimized sets of operating conditions that minimize the BTEX 
emission for stipulated dry gas water content were obtained. The result shows that 
optimal choice TEG circulation rate, reboiler temperature, stripping gas flow rate, 
and absorber pressure can mitigate BTEX release from the dehydration process.
The US Clean Air Act Amendments (CAAA) of 1990 sets restrictions on the 
emission of BTEX [1]. Under Clean Air Act 82 Amendment (CAAA) Title I Air 
Pollution Prevention and Control, Parts A (Section 112), BTEX is defined as a haz￾ardous pollutant and must not exceed emission of 25 tons/y total from major sources. 
As defined in the amendment, several dehydration plants become classified as major 
sources of BTEX pollutants [2]. In Title V of the CAAA, a major source of pollut￾ants must execute maximum achievable control technology (MACT) for mitigation. 
A study by the Gas Processing Association and American Petroleum Institute (API) 
has found that among different glycol dehydrates, TEG has the highest associa￾tion for BTEX composite and therefore greatest solubility in TEG and emission. 
Hence, it is essential to understand the relationship of process parameters between 
BTEX emission from the TEG dehydration process for achievement of MACT. In 
TEG absorption process, the unit contains a TEG absorption column, a flash tank, 
a stripping column, a reboiler, and a TEG surge drum. Following the sweetening 
process, the wet gas comprising of water, BTEX, and other volatile organic com￾pounds (VOCs) enters the absorption column, which holds lean TEG that contains 
a low concentration of water and BTEX. Succeeding the absorption column, the 
rich TEG that contains a higher concentration of water and BTEX enters the flash 
tank and further into the stripping column for regeneration. BTEX and VOC emis￾sion primarily come from the flash tank when the rich gas is depressurized and the 
regeneration unit where the TEG is stripped. The uncertainty involved in the opti￾mization process is either related to data, including inlet feed composition and flow 
rate, or metamodeling that affects the reliability both in design and operation of 
the system [3–5]. In the present work, BTEX emission is analyzed under uncertain 
feed composition. Due to the uncertain behavior of the feed composition, emission 
of byproducts and wastes from processing plants including pollutants like BTEX 
and other VOCs are difficult to assess. Thus, a robust multi-objective optimization 
(RMOO) under uncertainty is proposed for emission mitigation from the NG dehy￾dration process.Multi-Objective Optimization of TEG Dehydration Process 113
The existing literatures on the optimization of TEG dehydration process are 
predominantly on the impacts associated with process variables through sensitiv￾ity analysis. A sensitivity analysis was performed by Gupta et al. [6] to discover 
the optimal condition for the reduction of TEG losses. Gandhidsan [7] conducted 
a parametric study to perceive the effects of altering operating parameters such as 
temperature, pressure, and TEG circulation rate on the dehydration unit’s model. The 
development of the dehydration unit has significantly upgraded from the findings by 
Rahimpoir et al. [8] who tested performance in terms of dew point, glycol consump￾tion, and greenhouse gas emission to find the optimal conditions from the simulation. 
Jokar et al. [9] executed an economic analysis utilizing structured packing instead 
of a plate column as the absorber in the Farashband plate. The effects of TEG cir￾culation rate and the number of plates in the absorber on the dry gas water content 
were examined by Jacob [10]. The author discovered that the stripping gas flow rate 
has a larger influence on drying than on the reboiler temperature. Ranjbar et al. [11] 
used a method based on a comparative sensitivity for parametric optimization of the 
TEG plant. The test minimized the dry gas water content as well as the TEG circu￾lation rate and reboiler duty. The HYSYS process simulator was utilized for their 
analysis. The information generated was used to formulate a response surface model 
to enhance the glycol circulation rate, temperature of the reboiler, and the number 
of trays in the absorber. A techno-economic analysis was conducted by Neagu and 
Cursaru [12]. Considering effects such as reboiler temperature and stripping gas flow 
rate, they deduced that an optimal stripping gas flow rate can improve TEG regenera￾tion and minimize the dry gas water content. Chebbi et al. [13] enhanced the process 
further and designed parameters that incorporated the TEG circulation rate, TEG 
concentration, and number of trays in the absorber to decrease the capital cost and 
functional requirements for the reboiler, TEG pumping, and stripping gas rates.
Traditionally, a benchmark for a process performance in terms of emission and/or 
efficiency is generated by the median composition based on the available well-com￾positional data. In reality, an uncertain composition of the feed streams can result in 
deviation from the benchmark. Considering other parameters like pressure, tempera￾ture, and catalyst activity as deterministic, the reliability of the processing system 
to meet a benchmark will depend on the degrees of uncertainty in the composition 
that can be expected in the feed stream. The difference obtained from the median 
composition of the feed and that from the stochastic analysis is essential to estimate 
whether deterministic analysis overestimates or underestimates the performance. In 
opposition to the prior works, the present examination is to conduct an RMOO of the 
dehydration processing by observing the economic and environmental impacts for 
sustainable operation under uncertain process conditions. Generally, process design 
integrates economic, environmental, and societal aspects for objective parameter 
approximation using dependable process assessment tools in a retrospective approach 
[14,15]. Economic and environmental assessment of NG processing plants under feed 
composition uncertainty has been performed by Mukherjee et al. [16] and Reddy 
Asani et al. [17], where environmental aspect was assessed in terms of CO2 equiva￾lent. In the present work, we have analyzed two of the three pillars of sustainability 
that include economic sustainability for retaining the specs of dry gas water content 
and environmental sustainability in terms of BTEX emission reduction.114 Optimization for Energy Systems and Supply Chains
Process data for dehydration originated utilizing a process simulator followed by 
surrogate model creation and optimization for a Pareto optimal solution. Altering 
surrogate model production techniques, including the response surface model and 
support vector machine (SVM) regression, are examined, and the one with the 
least mean absolute percentage error (MAPE) is adopted. Surrogate modeling is 
a successful way for model order reduction where we can represent a complicated 
process without neglecting the crucial features. Currently, the metamodel of the 
process was developed to minimize the mathematical effort during optimization. 
In the present work, RMOO is proposed to obtain a robust estimate of product 
specification and BTEX emission that occur with changing feed composition. 
RMOO utilizes both robust optimization (RO) and multi-objective optimization 
(MOO) technique. The RMOO method uses the robust value of the objective and 
constraints.
The metamodels are usually not flat, due to the dispersed character of the input￾output data used to create the model. Therefore, the need for the efficient optimi￾zation of the input area of an SVR model, a metaheuristic optimization known as 
the EACO, is being used. EACO has been extensively used for solving chemical 
engineering problems which include computer-aided molecular design [18,19], sol￾vent selection process [20], and chemical process optimization [21]. In the pres￾ent work, SVR is integrated with the EACO to create a hybrid process, and the 
RMOO algorithm is generated to generate Pareto points. The SVR-EACO hybrid 
plan has been used for decision variable optimization of the TEG dehydration pro￾cess of NG when the feed composition is uncertain. The improved operating con￾ditions are analyzed to find the effects of minimizing BTEX emission at different 
compositions.
7.2 METHODOLOGY
The basic design of an NG processing unit has an acid gas removal unit, followed by 
the dehydration unit, as shown in Figure 7.1. The acid gas removal unit carries out the 
separation of carbon dioxide and hydrogen sulfide. Water is then removed from the 
dehydration unit in order to meet specifications downstream which is less than 7 lbm/
MMscf (112.13 mg/m3
).
Proceeding to the acid gas removal unit, the sweet gas is fed into the dehydration 
unit. There are many alternatives for the dehydration process; they all depends on the 
plant capacity and the required amount of drying. Absorbent liquids are used such 
FIGURE 7.1 Block flow diagram of natural gas processing.Multi-Objective Optimization of TEG Dehydration Process 115
as glycols, specifically, EG, DEG, TEG, and tetraethylene glycol. Contained in the 
TEG dehydration process are absorption and stripping column sections. Figure 7.2 
displays a simplified diagram of the TEG dehydration process.
TEG is found to have a higher deteriorating temperature when compared to EG 
and DEG, so it can be revitalized to a leaner concentration. However, TEG has a 
higher likelihood to absorb BTEX and subsequently release during regeneration to 
produce more emission, resulting in the most pollution from the process when com￾pared to EG or DEG. The issue of BTEX/VOC mitigation is a problem that has many 
alternate solutions such as incineration, flaring, or condensation. However, incinera￾tion and flaring are not an international standard adopted by the industry since the 
process contributes to pollution of other kinds. Likewise, condensation is somewhat 
economical but not environmentally safe as its byproducts contribute to BTEX/VOC 
pollution of water.
Several process parameters may impact BTEX/VOC emission. Essential param￾eter selection that has a significant effect on emission can be performed with mul￾tivariate statistics [22,23] or machine learning algorithms [21,24,25]. Even though 
sensitivity analysis quantifies how variation in the output can be assigned to the 
inputs and their interactions, variable selection is more decision oriented. In the study 
by Braek et al. [26], optimizing the process parameters has a notable effect on reduc￾ing BTEX/VOC emission. Nonetheless, their study comprises fixed feed composi￾tion resulting in a deterministic solution.
Oftentimes, variables that affect BTEX/VOC emission also have an effect on 
the dew point of the dry gas. As an example, glycol circulation rate minimizes the 
amount of water in the dry gas, which results in a significant increase in BTEX emis￾sion. Therefore, the issue that is addressed is how the variables we have chosen affect 
both the dry gas water content and the BTEX emission. The multi-objective opti￾mization shows which variables provide the best balance between these two: BTEX 
emission and dry gas water content. The Pareto optimal point is generated from the 
optimization results and gives the best solution to the problem.
FIGURE 7.2 Schematic diagram of wet gas dehydration process. Stripping gas obtained 
from the dry gas flow stream.116 Optimization for Energy Systems and Supply Chains
The framework for the stochastic simulation and optimization is displayed in 
Figure 7.3. For the stochastic simulation of the process, metamodel and optimization, 
MATLAB acts as the controller, and ProMax® is utilized to illustrate the simulation. 
MATLAB generates the random input variables chosen from uniform distribution using 
quasi-random sampling derived from the Halton sequence, which has high dimensional 
uniformity similar to Hammersley sequence sampling (HSS) [27,28]. A good sampling 
technique is crucial to increase the results from the surrogate model [29]. After the 
output response from the process simulation is complete for the certain input variables, 
the surrogate model generation followed by the optimization is performed to discover 
the optimal process for BTEX mitigation as well as dry gas water content.
 1.
 2.
 3.
 7.
FIGURE 7.3 Framework for the simulation and data-based modeling and optimization of 
natural gas dehydration process.Multi-Objective Optimization of TEG Dehydration Process 117
7.2.1 data generation and metamodel develoPment
The simulation is performed in a chemical process simulator. Details of the simula￾tion can be found in Mukherjee and Diwekar [4,21]. Four different decision variables 
namely glycol circulation rate, absorber pressure, reboiler temperature, and stripping 
gas flow rate, as identified by Mukherjee and Diwekar [21], that have a significant 
effect on BTEX emission and dry gas water content are used in our analysis. Random 
sampling is performed from a uniform distribution. Along with the decision vari￾ables, the uncertain variables, the feed composition is also varied to generate five 
hundred realizations. The process simulator is used to generate output data for vari￾ous realizations of the input variables.
The input-output data thus generated is used for metamodel development followed 
by optimization. Metamodeling of complex chemical process phenomena has gained 
tremendous application since its inception about three decades ago [30]. These mod￾els are often polynomial or statistical in nature that can capture the nonlinearity of 
the original process system. In the present work SVR adopted from the SVM, a sta￾tistical learning algorithm first introduced by Vapnik [31,32] has been used for model 
building for process optimization. A designed performance function has been used 
to combine the response of the entire process system using SVR. SVR is a regression 
model that has been constructed on a specific region of the entire design space. Using 
SVR, a functional relationship between the randomly generated input variables and 
the corresponding response of the entire natural gas processing system has been 
generated. Nandi et al. [30] have used SVR-generated regression model for chemical 
process optimization.
Optimization of a process using the SVR model can be either using sequential 
application of gradient-based methods or through stochastic optimization using 
metaheuristic techniques. In general, there are four basic steps in SVR-based robust 
process optimization:
 1. Sampling from the vector space of the process variables
 2. Specification of a SVR model
 3. 
 4.
Details of the surrogate model generation using SVR have been described in [21]. 
The SVR models are generated using Matlab® routine fitrsvm.
7.2.2 robust multi-objeCtive oPtimization (rmoo)
The main goal of the present work is to find the optimal process parameters in the 
dehydration unit to reduce BTEX emission, all in accordance with the dew point 
specifications. The process should not only enable us to achieve a high drying effi￾ciency but also be environmentally friendly with minimum toxic chemicals released 
under source stream composition uncertainty. This becomes an exciting RMOO. The 118 Optimization for Energy Systems and Supply Chains
solution of RMOO is generally achieved by quantifying the trade-offs between the 
two conflicting objectives. Since the economic (drying efficiency) and environmental 
(BTEX mitigation) objectives are conflicting in nature, the impact of different pro￾cess variables on them can show completely different trends. The hybrid algorithm 
RMOO implements both RO and MOO techniques to find a robust optimal value.
In a constraint method, a MOO problem is transformed into a series of single￾objective optimization problems [33]. One of the objectives is picked to minimize (say 
yl) while each of the others (yi, i = 1, …, k, i ≠ l) are turned into inequality constraint 
having parametric right-hand sides (θi, i = 1, …, k, i ≠ l). In the present problem, the 
process optimization objective is to determine the optimal values of the process vari￾ables so that the two objectives are realized simultaneously. This includes minimum 
environmental impact in terms of BTEX emission ( ) yBTEX , while maximizing drying, 
i.e., minimizing dry gas water content ( yDryW ). The constraint optimization method 
applied for the present multi-objective problem can be formulated as:
m
where the objective function fBTEX and constraint fDryW denote the output variables 
BTEX emission and dry gas water content to meet the threshold θDryW, respec￾tively; x = [ ] x x, , , x T
1 2  m is the m − dimensional  vector of uncertain variables; 
c = … [ ] c c, , .,c T
1 2 n is the n − dimensional  vector of decision variables which are 
essential; y y BTEX  and    DryW are the functions correlating output variables BTEX 
emission and dry gas water content, respectively, with the inputs estimated with 
machine learning SVR; wyBTEX and wyDryW are the parameter vector of the functions 
y y BTEX  and  DryW, respectively; h g  and  are other equality and inequality constraints, 
respectively; and ui and li are the upper bound and the lower bound of ci, respectively. 
The optimization problem is solved repeatedly by changing the value of the paramet￾ric right-hand side as in Eq. (7.2) to generate the Pareto set.
The fluctuations in uncertain variables are subject to alterations in the perfor￾mance of the process and thus the outputs y y BTEX  and  DryW. In order to combat these 
issues, a robust design optimization method from Taguchi is performed (for further 
details, see the explanation by Tsui [34]). The RMOO is formulated as
minimize       EfBTEX = E y ( ) x c, , w  BTEX fBTEX            (7.6) 
subject to      EfDryW ≡ E y ( ) w f  ≤ θ  DryW x c, , DryW  DryW (7.7)Multi-Objective Optimization of TEG Dehydration Process 119
  , E h( ) I ( ) x c = ≥ 0           I 0  (7.8)
  , E g( ) J ( ) x c ≤ ≥ 0           J 0 (7.9)
l c i i ≤ ≤ u i i          = 1,2,n (7.10)
where E is the expected value and the objective functions Ef E BTEX  and  fDryW denote 
the expected values of the output variables BTEX emission and dry gas water con￾tent, respectively.
The optimization task is fulfilled in two steps. In the first step, the SVR-based 
process models, yBTEX ( ) x , , c wyBTEX and yDryW ( ) x c ,  , wyDryW , have been developed 
followed by optimizing the input space (c) of the process model using EACO with 
the intention of minimizing the objective function defined in Eq. (7.6). The objective 
of the EACO-based optimization is to find the n − dimensional optimal decision vari￾able vector c* =  T
c c *
1 , , * *
2 ,cn 
 that represents the optimal process conditions where 
the process output yBTEX is minimized while fulfilling the constraint yDryW ≤ θ.
Figure 7.4 shows the framework for the development of a surrogate model-based 
RMOO of natural gas dehydration unit. The overall process has nine steps: finding 
the uncertain and decision variables and their operating range and type of distribu￾tion, input dataset generation using efficient sampling techniques, commercial pro￾cess simulation for output data generation, surrogate model generation using SVR, 
robust optimization under uncertain variables using EACO, generate the Pareto opti￾mal points by the epsilon c − onstrained method. At each Pareto point, the mean value 
of BTEX emission and dry gas water content is evaluated using the ProMax® simula￾tor. The Pareto optimal points from deterministic solution with MOO as obtained by 
Mukherjee and Diwekar [21] are also used to obtain the mean value of BTEX emis￾sion and dry gas water content under uncertain feed condition using the ProMax®
simulator. The two results are compared to obtain VSS.
7.3 RESULTS AND DISCUSSIONS
A total of 500 simulations were conducted to find the effect of uncertain and decision 
variables on BTEX emission and dry gas water content. Details of the variables are 
given in Table 7.1. The distribution of the uncertain input variables (feed components) 
is shown in Figure 7.5. The maximum and minimum amount of BTEX emission and 
dry gas water content from the 500 realizations show that the BTEX emission could 
be as low as 59.56 ton/y and can go as high as 2,302.54 ton/y. On the other hand, 
moisture content could be as low as 30.76 mg/m3 and as high as 229.06 mg/m3. On 
the other hand, BTEX emission, and the corresponding moisture content was. To 
achieve minimizing BTEX emission with possible maximizing dehydration simul￾taneously under uncertain feed conditions, the constrained optimization problem, as 
shown in Eqs. (7.6)–(7.10), was solved in which SVR-based models of the process 
were built and optimized using the EACO. The optimization solves ten equations 
comprising one objective one constraint, and the rest are the limits to the process 
variables. EACO is performed for 10 optimal points by changing the constraint as 120 Optimization for Energy Systems and Supply Chains
FIGURE 7.4 Algorithmic flow diagram for metamodel-based robust multi-objective optimi￾zation (RMOO) of natural gas dehydration unit under feed composition uncertainty and Value 
of Stochastic Solution (VSS) estimation at each pareto point.Multi-Objective Optimization of TEG Dehydration Process 121
shown in Figure 7.4. The number of iterations for each of the ten optimization runs 
varies, with a maximum of 107 iterations and a minimum of 36 iterations having a 
mean value of 69.5 iterations. The simulation is conducted in MATLAB®, installed 
in a Windows® server.
7.3.1 metamodel generation
Here, two SVR models, one for BTEX emission and the other for dry gas water 
content, were developed. The simulated dataset was subdivided into two parts, with 
80% (400 realizations) for training the SVR model and 20% (100 realizations) for 
validation and testing of the model. In the present work, a variant of SVR known 
as ε − SVR has been implemented for the development of the two SVR-based mod￾els. The performance of the developed models was evaluated using the test sets. To 
find the optimal SVR model, the effects of different kernel function and other algo￾rithm-specific parameters have to be examined. Three different kernel functions that 
include polynomial, RBF, and sigmoid were tested. Among the three different types 
of kernel used, polynomial function resulted in minimum values of mean absolute 
percentage error (MAPE) [35].
7.3.2 eaCo-based robust multi-objeCtive oPtimization
Since the process involves multi-objective criteria where average BTEX emission 
needs to be minimized and average dryness of the treated gas has to be maximized, 
a Pareto optimal solution is found to be appropriate. The EACO-specific parameters 
TABLE 7.1
Range of the Process Variables as Used for Analysis
Distribution 
Variable Name Variable Type Distribution Type Characteristics
Glycol circulation rate (sgpm) Decision Uniform ul = 1, uu = 10
Absorber pressure (kpa) Decision Uniform ul = 3,447, uu = 4,137
Reboiler temperature (Celsius) Decision Uniform ul = 182.22, uu = 204.44
Stripping gas rate (m3/day) Decision Uniform ul = 0, uu = 2,831.68
H2S (mole%) Uncertain Normal µ = 1.5748, σ = 1.5748 × .2
CO2 (mole%) Uncertain Normal µ = 3.31154, σ = 3.31154 × .2
Methane (mole%) Uncertain Normal µ = 81.7503, σ = 81.7503 × .2
Ethane (mole%) Uncertain Normal µ = 9.4179, σ = 9.4179 × .2
Propane (mole%) Uncertain Normal µ = 3.8509, σ = 3.8509 × .2
Benzene (mole%) Uncertain Normal µ = 0.0331, σ = 0.0331 × .2
Toluene (mole%) Uncertain Normal µ = 0.0189, σ = 0.0189 × .2
Ethylbenzene (mole%) Uncertain Normal µ = 0.0237, σ = 0.0237 × .2
o-Xylene (mole%) Uncertain Normal µ = 0.0047, σ = 0.0047 × .2
m-Xylene (mole%) Uncertain Normal µ = 0.0095, σ = 0.0095 × .2
p-Xyleme (mole%) Uncertain Normal µ = 0.0047, σ = 0.0047 × .2122 Optimization for Energy Systems and Supply Chains
used for the optimization of the input space of the SVR models are the algorithm will 
terminate if the maximum number of iterations are reached (MAXITR = 500), or 
the solutions from two successive iterations have a difference of less than or equals 
to a tolerance EPS (EPS = 1E-5), or the solution does not change for twenty-five 
consecutive iterations (CONITER = 25). The EACO algorithm used the following 
parameters: number of ants (nAnts = 100), pheromone evaporation rate (ρ = 0.85), 
solution archive size (K = 50), and algorithm parameter (q = 1e−3). The problem 
includes inequality constraints in terms of meeting the dryness limit. The EACO 
algorithm used in this work implements the constraint through the oracle penalty 
method introduced by Schlüter et al. [36].
FIGURE 7.5 Distribution of the uncertain variables.Multi-Objective Optimization of TEG Dehydration Process 123
7.3.3 Pareto Front generation
Natural gas has to be dried for the prevention of hydrate formation and/or liquid 
water deposition in the pipelines. Dehydration is also essential to avert condensa￾tion in the compressors that will cause damage or poor performance of the equip￾ment. Thus, along with the environmental objective of BTEX minimization, the 
economic objective of reducing the moisture content in natural gas has also been 
looked into. It is imperative to find the optimal operating condition through a 
robust multi-objective Pareto optimal solution. Pareto fronts are usually generated 
by either using a sequence of single-objective optimization results and turning 
them into a multi-objective optimization problem by putting them in a multi￾dimensional coordinate where each dimension represents a single objective or 
using evolutionary methods [37]. Using ε − constrained  method, Pareto optimal 
points are generated that compare BTEX emission with the dry gas water con￾tent. Results from the solution are shown in Table 7.2. Pareto point A is obtained 
by minimizing BTEX emission for maximum dryness (minimum moisture con￾tent). Pareto points B to J were obtained from BTEX emission minimization by 
putting a constraint in dry gas water content from that obtained at Pareto point 
A and increasing in steps. The optimized process conditions from A to J listed 
in Table 7.2 were verified through process simulation. Median values of BTEX 
emission and dry gas water content under uncertain feed compositions at the opti￾mal operating conditions as obtained from the process simulation are shown in 
Table 7.2. All analysis is conducted with the results from process simulation at the 
ten optimal operating conditions. 
Typically, natural gas is dried between 64.07 and 112.13 milligrams of water per 
cubic meter (mg/m3
) [38]. The density of water vapor is equivalent to a dewpoint of 
approximately −40°F or moisture content of 143PPMv [39]. The three best operating 
TABLE 7.2
Optimized Process Condition for the Ten Pareto Points
Optimum Process Variables Output from ProMax® Simulation
Glycol Absorber Reboiler Stripping BTEX Emission Dry Gas Water 
Pareto circ. Rate Pressure Temp. Gas Rate (Median Value) (Median Value)
Points sgpm kpa °C MSCFD ton/y mg/m3
A 8.13 3,447 204.44 100 1041.5 32.84
B 6.48 4,137 204.44 100 685.45 44.21
C 5.17 4,137 204.44 100 544.72 53.66
D 4.30 4,137 204.44 100 445.6 63.91
E 3.60 4,137 204.44 100 363.39 75.93
F 2.99 4,137 204.44 100 291.52 90.98
G 2.45 4,137 204.44 100 227.34 109.73
H 1.96 4,137 204.44 100 169.71 134.07
I 1.51 4,137 204.44 100 118.43 166.59
J 1.06 4,067 204.44 100 71.85 213.37124 Optimization for Energy Systems and Supply Chains
condition sets as obtained from the robust optimization as tabulated in Table 7.2 
are D, E, F, and G. The overall optimal solution can be obtained at F where BTEX 
emission (292.52 ton/y) as well as dry gas water content (90.98 mg/m3
) is mini￾mized. From the simulated data (500 realizations) as used for SVR model building 
and testing, the maximum value of the BTEX emission was found to be 2,302.54 
ton/y, and that of dry gas water content was 229.06 mg/m3. A comparison of the 
maximum values with that from the simulation result at the Pareto optimal point ‘F’ 
reveals that the optimal operating conditions as found from the robust optimization 
have decreased the BTEX emission and dry gas water content by 87.3% and 60.28%, 
respectively, from the highest possible value. It is to be mentioned that Mukherjee 
and Diwekar [21] in their deterministic optimization were able to decrease the BTEX 
emission and dry gas water content by 76.31% and 58.39%, respectively, from the 
highest possible value.
The Pareto front generated with the simulation results from the ten optimal points, 
A to J, is shown in Figure 7.6. From the Pareto front, it can be found that the dry gas 
moisture content decreases at the cost of increased BTEX emission. Figure 7.6 also 
shows the Pareto points as obtained from the deterministic solution.
At the ten Pareto optimal points, the distribution of the output variables, BTEX 
emission, and dry gas water content at various feed compositions, is shown in 
Figure 7.7a and b, respectively.
Tables 7.3 and 7.4 show the probabilistic characteristics of BTEX emission and 
dry gas water content, respectively. At the mean ( ) µ feed composition as given in 
Table 7.1, the BTEX emission and dry gas water content at the Pareto point F are 
290.18 ton/y and 90.5 mg/m3, respectively. From Table 7.3, it can be seen that at Pareto 
FIGURE 7.6 Pareto optimal points as obtained from stochastic and deterministic optimiza￾tion of natural gas dehydration process.Multi-Objective Optimization of TEG Dehydration Process 125
FIGURE 7.7 Distribution of output variables at the ten Pareto points: (a) BTEX emission, 
(b) dry gas water content.126 Optimization for Energy Systems and Supply Chains
point F, the mode (most frequent) value of BTEX emission as given in Table 7.3 is 
277.04 ton/y. The difference in the two values suggests that the traditional analysis 
approach may misrepresent the emission of the process by ≅ 4.53%. Similarly, from 
Table 7.4, it can be seen that at Pareto point F, the mode value of the dry gas water 
content is 92.11 mg/m3 suggesting that the traditional analysis approach may misrep￾resent the dry gas water content of the process by ≅ 1.74%. Thus, traditional analysis 
has overpredicted the emission and dryness.
Looking at the statistical characteristics of the distribution of BTEX emission 
in Table 7.3 suggests that at Pareto point F, the award zone (P5) when the emission 
is low and the risk zone (P95) when the emission is high is found to be 197.94 and 
481.56 ton/y, respectively, with the standard deviation is as high as 31.2% of the mean 
value. On the other hand, the statistical characteristics of the distribution of dry gas 
TABLE 7.3
Characteristics of BTEX Emission at the Pareto Optimal Points as Obtained 
from Stochastic Solution
Pareto Mean Median Mode Stdev Minimum Maximum P5 P95
A 1,100.3 1,041.50 973.07 343.75 446.35 2,767.00 699.61 1,764.1
B 717.82 685.45 651.92 215.95 301.11 1,976.00 465.87 1,117.7
C 571.84 544.72 517.95 176.68 238.31 1,640.60 369.13 897
D 468.4 445.60 419.04 146.81 194.8 1,381.50 301.71 737.17
E 382.13 363.39 341.65 120.19 159.11 1,125.20 246.2 601.81
F 306.38 291.52 277.04 95.59 128.15 874.80 197.94 481.56
G 238.55 227.34 217.74 73.07 100.62 658.42 154.86 373.01
H 177.6 169.71 163.15 52.7 75.91 471.35 116.15 275.16
I 123.46 118.43 116.75 34.89 53.8 312.64 81.65 188.56
J 74.41 71.85 71.73 19.64 33.32 172.27 50.18 111.38
TABLE 7.4
Characteristics of Dry Gas Water Content at the Pareto Optimal Points as 
Obtained from Stochastic Solution
Pareto Mean Median Mode Stdev Minimum Maximum P5 P95
A 32.52 32.84 33.48 2.24 22.75 37.80 28.51 35.72
B 43.89 44.21 44.85 2.40 32.52 49.66 39.41 47.25
C 53.18 53.66 54.46 3.04 39.09 60.39 47.74 57.51
D 63.27 63.91 64.71 3.68 46.45 71.92 56.71 68.40
E 75.29 75.93 77.05 4.32 55.26 85.38 67.44 81.37
F 90.18 90.99 92.11 5.13 66.48 102.04 80.89 97.23
G 108.77 109.73 111.49 6.09 80.73 122.70 97.87 117.10
H 132.95 134.07 136.16 7.05 99.80 149.29 119.98 142.72
I 165.15 166.59 168.67 8.49 125.42 184.53 149.77 176.68
J 211.60 213.37 215.77 10.41 162.27 235.47 192.38 226.02Multi-Objective Optimization of TEG Dehydration Process 127
water content in Table 7.3 suggest that at Pareto point F the standard deviation of the 
dry gas water content is only 5.68% of the mean value.
7.3.4 value oF stoCHastiC solution (vss)
In our previous work, we used the EACO algorithm for an SVR-EACO optimiza￾tion of natural gas processing units considering the feed composition to be constant. 
This resulted in a deterministic optimization, without considering uncertainty in 
the system. The average value of the uncertain variables (feed composition) is used 
for optimization. In the present work, we used probabilistic information of the 
output variables (BTEX and dry gas water content) to measure the VSS. The dif￾ference between taking the average value of the uncertain variable for optimization 
as used in Mukherjee and Diwekar [21] when compared with stochastic analysis, 
i.e., propagating the uncertainties through the model as used in the present work is 
defined as the VSS. The Pareto optimal points as predicted by stochastic and deter￾ministic optimization are shown in Figure 7.6. Figure 7.6 shows the median values 
of the two objectives; BTEX emission and dry gas water content are obtained from 
ProMax® process simulation at the optimal conditions as predicted by the stochas￾tic and deterministic methods. To estimate the VSS, we compared the objective 
BTEX emission at different dry gas water content values as obtained from optimal 
process conditions suggested by robust optimization with that from deterministic 
optimization. To compare the emission at a given dry gas water level from stochas￾tic and deterministic optimization, interpolation was undertaken using
BTEX
where the superscripts S and D are used to represent stochastic and deterministic 
solutions, respectively. BTEX emission and dry gas water content as obtained from 
stochastic and deterministic solution and the interpolated value of BTEX as obtained 
using Eqs. (7.11)–(7.13) are shown in Table 7.5.
The VSS is obtained from the difference of deterministic and stochastic solu￾tion (interpolated) is shown in Figure 7.8. The results reflect emission savings up 
to 63.16 ton/y.128 Optimization for Energy Systems and Supply Chains
TABLE 7.5
Interpolated Values of BTEX Emission 
Stochastic Solution 
Stochastic Solution Deterministic Solution (Interpolated)
Dry Gas BTEX Dry Gas BTEX 
Pareto Water Emission Water Emission BTEX Emission
Points mg/m3 ton/y mg/m3 ton/y ton/y
1 32.84 1,041.5 30.27 1,184.9 1,121.74
2 44.21 685.45 37.00 889.1 857.41
3 53.66 544.72 64.39 442.0 414.07
4 63.91 445.6 78.97 347.4 322.97
5 75.93 363.39 91.79 287.86 273.13
6 90.99 291.52 103.96 244.86 239.29
7 109.73 227.34 113.41 241.56 216.93
8 134.07 169.71 127.67 202.33 181.98
9 166.59 118.43 141.28 171.79 149.67
10 213.37 71.85 156.34 144.08 128.64
FIGURE 7.8 Value of Stochastic Solution (VSS) as obtained from the difference of deter￾ministic optimization solution and stochastic optimization solution.Multi-Objective Optimization of TEG Dehydration Process 129
7.4 CONCLUSIONS
In this work, we have applied a hybrid method comprising SVR with the EACO 
for metamodeling and robust optimization of TEG dehydration process under feed 
composition uncertainty. SVR is a machine learning technique for nonlinear model￾ing. Two different process models are developed: one for BTEX emission and the 
other for dry gas water content using SVR. RMOO of the input space of the SVR 
model is performed using EACO so that the ensemble average of BTEX emission 
is minimized with a constraint on ensemble average dry gas water content using 
ε − constraint method resulting in a Pareto optimal solution. The hybrid approach 
involving SVR and EACO is a novel mechanism for RMOO that can be applied to an 
exclusive historical process data-based process modeling and optimal process condi￾tions estimation under uncertainty. The Pareto points D to G, as given in Table 7.2, 
are found to be appropriate, with median values of dry gas water content between 
64.07 and 112.13 mg/m3 as recommended while keeping a moderate BTEX emission. 
Through the process, we obtained the range of variables at which Pareto optimal 
solutions for BTEX emission mitigation are feasible. The algorithm that involves 
SVR and BONUS is a novel method used for process optimization that considers 
uncertainty associated with the feed composition.
FURTHER READING
In this chapter, the strategy of using MOO under feed compositional uncertainty for 
the NG dehydration process is explored. The chapter concludes with an examination 
of data-driven optimization theory and suggests implementing its use. For further 
reading about the theory and specific application:
Alfadala, H. E., & Al-Musleh, E. Simulation of an acid gas removal process using meth￾yldiethanolamine; an equilibrium approach. In Proceedings of the 1st Annual 
Gas Processing Symposium, Elsevier, 2009, January, pp. 256–265, DOI: 10.1016/
B978-0-444-53292-3.50033-X
Baratto, F., & Diwekar, U. M. Multi-objective trade-offs for fuel cell-based auxiliary power 
units: case study of South California Air Basin. Journal of Power Sources, 2005, 
139(1–2), 197–204. DOI: 10.1016/j.jpowsour.2004.07.031
Dara, S., & Berrouk, A. S. Computer-based optimization of acid gas removal unit using modi￾fied CO2 absorption kinetic models. International Journal of Greenhouse Gas Control, 
2017, 59, 172–183. DOI: 10.1016/j.ijggc.2017.02.014.
Davis, S. E., Cremaschi, S., & Eden, M. R. Efficient surrogate model development: Impact of 
sample size and underlying model dimensions. In Computer Aided Chemical Engineering. 
Elsevier, 2018, Vol. 44, pp. 979–984, DOI: 10.1016/B978-0-444-64241-7.50158-0.
Ebeling, H. O., Lyddon, L. G., & Covington, K. K. Reduce emissions and operating costs 
with appropriate glycol selection. In Proceedings of the Seventy-Seventh GPA Annual 
Convection, Tulsa, Oklahoma, 1998.
Edgar, T.F., Himmelblau, D.M., & Lasdon, L.S. Optimization of Chemical Processes. 
McGraw-Hill, 2001. ISBN-13:978-0070393592
Hlavinka, M. W., Hernandez-Valencia, V. N., & Bullin, J. A. Influence of process operations on 
VOC and BTEX emissions from glycol dehydration units. In Proceedings of the Annual 
Convention-Gas Processors Association, Gas Processors Association, Tulsa, Oklahoma, 
1993, pp. 100–106.130 Optimization for Energy Systems and Supply Chains
Kamin, Z., Bono, A., & Leong, L. Y. Simulation and optimization of the utilization of tri￾ethylene glycol in a natural gas dehydration process. Chemical Product and Process 
Modeling, 2017, 12(4). DOI: 10.1515/cppm-2017-0017.
Li, R., Henson, M. A., & Kurtz, M. J. Selection of model parameters for off-line parameter 
estimation. IEEE Transactions on Control Systems Technology, 2004, 12(3), 402–412. 
DOI: 10.1109/TCST.2004.824799.
Ng, H. J., Chen, C. J., & Razzaghi, M. Vapor-liquid equilibria of selected aromatic hydro￾carbons in triethylene glycol. Fluid Phase Equilibria, 1993, 82, 207–214. DOI: 
10.1016/0378-3812(93)87145-Q.
Pearce, R. L., Protz, J. E., & Lyon, G. W. Drizo – improved regeneration of glycol solutions. 
In Proceedings of the Gas Conditioning Conference, Norman, OK, Vol. 22 #D, 1972.
Porter, J. A., & Reid, L. S. Vapor-liquid equilibrium data on the system natural gas-water￾triethylene glycol at various temperatures and pressures. Journal of Petroleum 
Technology, 1950, 2(08), 235–240. DOI: 10.2118/950235-G.
ProMax Foundations. Bryan Research & Engineering, Inc, 2015. http://www.bre.com/PDF/
Foundations-Manual-En.pdf (Accessed 12th March 2022).
Wilbur, S., & Bosch, S. Interaction Profile for: Benzene, Toluene, Ethylbenzene, and Xylenes 
(BTEX). Agency for Toxic Substances & Disease Registry (ATSDR), Atlanta, GA, 2004.
Zecchin, A. C., Maier, H. R., Simpson, A. R., Leonard, M., & Nixon, J. B. Ant colony opti￾mization applied to water distribution system design: Comparative study of five algo￾rithms. Journal of water Resources planning and Management, 2007, 133(1), 87–92. 
DOI: 10.1061/(ASCE)0733-9496(2007)133:1(87).
ACKNOWLEDGMENTS
This research work was supported by the UT System’s Rising STARs Grant Program 
(Project ID # P5011032 34). The author Krystal Smith acknowledges financial sup￾port from The University of Texas Permian Basin College of Engineering Semester 
Undergraduate Research in Engineering (SURE) Program funded by the Permian 
Basin International Oil Show Fellowship. The authors would like to acknowledge 
the technical support of Justin C. Slagle of Bryan Research & Engineering (BRE). 
REFERENCES
 1. Waxman, H. A. An overview of the clean air act amendments of 1990. Envtl. L. 1991, 
21, 1721.
 2. Rueter, C. O., Reif, D. L., Menzies, W. R., & Evans, J. M. Measurement and enhanced 
monitoring of BTEX and VOC emissions from glycol dehydrators. SPE Adv. Technol. 
Series 1996, 4(02), 13–22. Doi: 10.2118/29698-PA.
 3. Mukherjee, R., & El-Halwagi, M.M. Reliability of CHO symbiosis networks under 
source streams uncertainty. Smart Sustain. Manuf. Syst. 2018, 2, 132–153. Doi: 10.1520/
SSMS20180022.
 4. Mukherjee, R., & Diwekar, U. M. Optimizing TEG dehydration process under 
metamodel uncertainty. Energies, 2021, 14(19), 6177. Doi: 10.3390/en14196177.
 5. Mukherjee, R. Reliability-based robust multi-objective optimization (RBRMOO) 
of chemical process systems: A case study of TEG dehydration plant. Frontiers in 
Sustainable Food Systems, 2022, 3, 856836. doi: 10.3389/frsus.2022.856836
 6. Gupta, A., Ansari, N. A. K. R., Rai, R., & Sah, A. K. Reduction of glycol loss from gas 
dehydration unit at offshore platform in Bombay offshore-a case study. In Abu Dhabi 
International Petroleum Exhibition and Conference. Society of Petroleum Engineers, 
1996, January Doi: 10.2118/36225-MS.Multi-Objective Optimization of TEG Dehydration Process 131
 7. Gandhidasan, P. Parametric analysis of natural gas dehydration by a triethylene glycol 
solution. Energy Sources, 2003, 25(3), 189–201. Doi: 10.1080/00908310390142235.
 8. Rahimpour, M. R., Saidi, M., & Seifi, M. Improvement of natural gas dehydration per￾formance by optimization of operating conditions: a case study in Sarkhun gas process￾ing plant. J. Nat. Gas Sci. Eng. 2013, 15, 118–126. Doi: 10.1016/j.jngse.2013.10.001.
 9. Jokar, S. M., Rahimpour, H. R., Momeni, H., Rahimpour, M. R., & Abbasfard, H.
Simulation and feasibility analysis of structured packing replacement in absorption col￾umn of natural gas dehydration process: A case study for Farashband gas processing 
plant, Iran. J. Nat. Gas Sci. Eng. 2014, 18, 336–350. Doi: 10.1016/j.jngse.2014.03.005.
 10. Jacob, N. C. G. Optimization of Triethylene glycol (Teg) Dehydration in a natural 
gas processing plant. Int. J. Res. Eng. Res. Eng. Technol. 2014, 3(6), 346–350. Doi: 
10.15623/ijret.2014.0306064.
 11. Ranjbar, H., Ahmadi, H., Sheshdeh, R. K., & Ranjbar, H. Application of relative sensi￾tivity function in parametric optimization of a tri-ethylene glycol dehydration plant. J. 
Nat. Gas Sci. Eng. 2015, 25, 39–45. Doi: 10.1016/j.jngse.2015.04.028.
 12. Neagu, M., & Cursaru, D. L. Technical and economic evaluations of the triethylene 
glycol regeneration processes in natural gas dehydration plants. J. Nat. Gas Sci. Eng.
2017, 37, 327–340. Doi: 10.1016/j.jngse.2016.11.052.
 13. Chebbi, R., Qasim, M., & Jabbar, N. A. Optimization of triethylene glycol dehydration 
of natural gas. Energy Rep. 2019, 5, 723–732. Doi: 10.1016/j.egyr.2019.06.014.
14. Mukherjee, R., Sengupta, D., & Sikdar, S.K.Sustainability in the context of process engineer￾ing. Clean Technol. Environ. Policy 2015, 17, 833–840. Doi: 10.1007/s10098-015-0952-7.
 15. Sikdar, S. K., Sengupta, D., & Mukherjee, R.Measuring Progress Towards Sustainability.
Springer International Publishing, Cham, 2017, Doi: 10.1007/978-3-319-42719-5.
 16. Mukherjee, R., Reddy Asani, R., Bopanna, N., & El-Halwagi, M.M. Optimal design of 
shale gas processing and NGL recovery plant under uncertainty of the feed composi￾tion. J. Natural Gas Sc. & Eng. 2020, 83, 103517. Doi: 10.1016/j.jngse.2020.103517.
 17. Asani, R. R., Mukherjee, R., & El-Halwagi, M. M. Optimal selection of shale gas pro￾cessing and NGL recovery plant from multiperiod simulation. Proc. Integrat. Optimiz. 
Sustain. 2021, 5(1), 123–138. Doi: 10.1007/s41660-020-00140-9.
 18. Mukherjee, R, Gebreslassie, B., & Diwekar, U.M. Design of novel polymeric adsor￾bents for metal ion removal from water using computer-aided molecular design. Clean 
Technol. Environ. Policy 2017, 19(2), 483–499. Doi: 10.1007/s10098-016-1236-6.
 19. Doshi, R., Mukherjee, R., & Diwejar, U.M. Application of adsorbate solid solution the￾ory to design novel adsorbents for arsenic removal using CAMD. ACS Sustain. Chem. 
Eng. 2018, 6(2), 2603–2611. Doi: 10.1021/acssuschemeng.7b04094.
 20. Gebreslassie, B. H., & Diwekar, U. M. Efficient ant colony optimization for computer 
aided molecular design: Case study solvent selection problem. Comput. Chem. Eng.
2015, 78, 1–9. Doi: 10.1016/j.compchemeng.2015.04.004.
 21. Mukherjee, R., & Diwekar, U.M. Multi-objective optimization of the TEG dehy￾dration process for BTEX emission mitigation using machine-learning and meta￾heuristic algorithms. ACS Sustain. Chem. Eng. 2021, 9, 1213–1228. Doi: 10.1021/
acssuschemeng.0c06951.
 22. Mukherjee, R., Sengupta, D., & Sikdar, S.K. Parsimonious use of indicators for eval￾uating sustainability systems with multivariate statistical analysis. Clean Technol. 
Environ. Policy 2013, 15(4), 699–706. Doi: 10.1007/s10098-013-0614-6.
 23. Sengupta, D., Mukherjee, R., & Sikdar, S. K. Environmental sustainability of countries 
using the UN MDG indicators by multivariate statistical methods. Environ. Progress 
Sustain. Energy 2015, 34(1), 198–206. Doi: 10.1002/ep.11963.
 24. Mukherjee, R. Selection of sustainable process and essential indicators for decision 
making using machine learning algorithms. Proc. Integrat. Optimiz. Sustain. 2017, 
1(2), 153–163. Doi: 10.1007/s41660-017-0011-4.132 Optimization for Energy Systems and Supply Chains
 25. Mukherjee, R., Beykal, B. Onel, M., Szafranc, A.T., Stossi, F., Mancini, M.A., Zhou, 
L., Wright, F.A., & Pistikopoulos, E.N. Classification of estrogenic compounds by 
coupling high content analysis and machine learning algorithms. PLOS Comput. Biol. 
2020, 16(9), e1008191 Doi: 10.1371/journal.pcbi.1008191.
 26. Braek, A. M., Almehaideb, R. A., Darwish, N., & Hughes, R. Optimization of pro￾cess parameters for glycol unit to mitigate the emission of BTEX/VOCs. Proc. Safety 
Environ. Protect. 2001, 79(4), 218–232. Doi: 10.1205/095758201750362262.
 27. Mukherjee, R., & Diwekar, U.M. Comparison of Monte Carlo and quasi Monte Carlo 
technique in structure and relaxing dynamics of polymer in dilute solution. Comput. 
Chem. Eng. 2016, 84, 28–35. Doi: 10.1016/j.compchemeng.2015.08.014.
 28. Wang, X., & Hickernell, F. J. Randomized halton sequences. Math. Comput. Model.
2000, 32(7–8), 887–899. Doi: 10.1016/S0895-7177(00)00178-3.
 29. Ibrahim, M., Al-Sobhi, S.A., Mukherjee, R., & Alnouss, A. Influence of sampling tech￾nique on the performance of surrogate model using ANN: A case study of natural gas 
stabilization unit. Energies, 2019, 12(10), 1906. Doi: 10.3390/en12101906.
 30. Nandi, S., Badhe, Y., Lonari, J., Sridevi, U., Rao, B. S., Tambe, S. S., & Kulkarni, B. D.
Hybrid process modeling and optimization strategies integrating neural networks/sup￾port vector regression and genetic algorithms: study of benzene isopropylation on Hbeta 
catalyst. Chem. Eng. J. 2004, 97(2–3), 115–129. Doi: 10.1016/S1385-8947(03)00150-5
 31. Vapnik, V. The Nature of Statistical Learning Theory, 2nd edition. Springer, New York, 
1999. Doi: 10.1007/978-1-4757-3264-1.
 32. Vapnik, V., Golowich, S., & Smola, A. Support vector method for function approxima￾tion, regression estimation and signal processing. Adv. Neural Inform. Process. Syst. 
1996, 9, 281–287.
 33. Diwekar, U. Introduction to Applied Optimization. Springer Science & Business Media, 
2008, Vol. 22. Doi: 10.1007/978-0-387-76635-5.
 34. Tsui, K.L. An overview of Taguchi method and newly developed statistical methods for 
robust design. Iie Trans, 1992, 24(5), 44–57.
 35. De Myttenaere, A., Golden, B., Le Grand, B., & Rossi, F. Mean absolute percent￾age error for regression models. Neurocomputing, 2016, 192, 38–48. Doi: 10.1016/j.
neucom.2015.12.114.
 36. Schlüter, M., & Gerdts, M. The oracle penalty method. J. Global Optimiz. 2010, 47(2), 
293–325. Doi: 10.1007/s10898-009-9477-0.
 37. Miettinen, K. Nonlinear Multiobjective Optimization. Springer Science & Business 
Media, 2012, Vol. 12. Doi: 10.1007/978-1-4615-5563-6.
 38. Mokhatab, S., Poe, W. A., & Mak, J. Y. (2015). Chapter 7- Natural gas dehydration. 
In Handbook of Natural Gas Transmission and Processing: Principles and Practices. 
Third edition, Cambridge, MA: Gulf Professional Publishing, 2012, Vol. 12.
 39. Phymetrix, http://www.phymetrix.com/industries-applications/natural-gas/ (accessed 
31 October 2021).133
8 Constrained Production 
Planning with Parametric 
Uncertainties
Nitin Dutt Chaturvedi and Piyush Kumar Kumawat
Indian Institute of Technology
8.1 INTRODUCTION
One of the most significant aspects of industrial planning is aggregate production 
planning (APP) (Chaturvedi, 2017a). It is a method for developing an overall manu￾facturing plan that ensures uninterrupted production at a facility along with demand 
satisfaction. Traditional APP models involve simultaneous determination of pro￾duction, inventory, employment management, and profit maximization (Nam and 
Logendran, 1992). Lately, such models have been extended to meet non-constant, 
time-varying demand with variable sales and production capacity. With increasing 
environmental concerns, planners and environmentalists focus on developing a prof￾itable production planning model with an emphasis on limited carbon emission and 
energy savings for long-term sustainable development (Sinha and Chaturvedi, 2019). 
A substantial amount of current research focuses on the deterministic state of APP 
while ignoring its intrinsic unpredictability. A minor uncertainty in the deterministic 
CONTENTS
8.1 Introduction .................................................................................................. 133
8.1.1 APP with Uncertainty: A Brief Overview ........................................ 134
8.1.2 APP and Robust Optimization Methodologies ................................. 135
8.2 Methodology ................................................................................................. 137
8.2.1 Problem Statement ............................................................................ 137
8.2.2 Deterministic Mathematical Formulation ........................................ 138
8.2.3 Robust Mathematical Formulation Including Uncertainty ............... 138
8.3 Case Study: Indian Steel Industry ................................................................ 142
8.4 Conclusion .................................................................................................... 146
Acknowledgments .................................................................................................. 147
Nomenclature ......................................................................................................... 147
Sets ................................................................................................................ 147
Parameters ..................................................................................................... 147
Variables ....................................................................................................... 147
References .............................................................................................................. 147
DOI: 10.1201/9781003240228-10134 Optimization for Energy Systems and Supply Chains
model can drastically impair the anticipated production plan and sometimes result 
in penalties if environmental regulations are not addressed. Here resides a signifi￾cant challenge in industrial operations, as many of the production-related factors are 
unknown exactly or might change in the future (Sagawa and Nagano, 2021).
Energy consumption (Chaturvedi, 2017b) and planning (Chaturvedi, 2020) are 
important and critical aspects for industries. For constrained carbon emission and 
energy consumption planning models, related metrics such as specific energy con￾sumption (SEC), production cost (C), and emission factors (EF) may fluctuate over 
time and are frequently vulnerable to unanticipated deviations. All of these pertur￾bations illustrate the dynamic and unpredictable nature of APP and the necessity to 
address these uncertainties in APP decision models. In deterministic cases, a typi￾cal plan may produce inappropriate results, which would significantly impact plan￾ning performance (Mirakyan and De Guio, 2015). Thus, planning under uncertainty 
has received much attention from chemical engineering and operations research 
communities.
8.1.1 aPP witH unCertainty: a brieF overview
In the past, different types of uncertainty models were presented to handle uncer￾tainties in APP, such as fuzzy, stochastic, and robust forms (Jamalnia et al., 2019). 
In general, these forms have been implemented to handle epistemic and probabilistic 
uncertainties. Probabilistic uncertainty focuses on classes of possible outcomes in 
repeated realizations of process, whereas epistemic uncertainty focuses on a single 
example that may occur. The most common literature formulations can be classified 
into different categories as follows:
 i. 
 ii. Constrained Production Planning with Parametric Uncertainties 135
APP model, the unknown parameters are assumed to follow a specific 
distribution (Golari et al., 2017). In general, the stochastic programming 
approach can effectively accommodate decision-making processes with 
various time stages only if historical data and their probability information 
are available.
 iii. Chance constrained optimization: In an uncertain context, it tries to max￾imize a goal while ensuring that restrictions are satisfied with a defined 
probability. In chance-constrained optimization, a probability distribu￾tion, similar to stochastic programming, is the key uncertainty model for 
expressing the unpredictability of unknown parameters. It has the ability 
to set a target objective value that assures that the likelihood of satisfying 
a restriction is greater than a specific limit. Such chance constraints can 
be used to quantify the tradeoff between objective performance and model 
failure probability (Rakes et al., 1984). The difficulty in estimating prob￾abilities necessitates the use of a probability density function. It is assumed 
that the probability density function is known or can be derived for chance 
constraint issues. On the other hand, these functions are rarely known to be 
extremely accurate and are usually approximations.
 iv. Robust optimization: This optimization approach does not need precise 
knowledge regarding probability distributions of unknown parameters. 
Instead, it uses an uncertainty set to model uncertain parameters, including 
all potential uncertainty insights. It is worth emphasizing that the level of 
uncertainty is a critical component. The goal of robust optimization is to pro￾tect against the worst-case scenario within a given uncertainty set. (Kumawat 
and Chaturvedi, 2021). Although the data on uncertainty is unknown and 
constrained, the uncertainty space is convex. Without any prior knowledge 
of parametric behavior, the optimization problem is transformed into its 
robust counterpart optimization problem with unknown parameters.
This chapter focuses on robust optimization for several reasons: (1) it does not require 
historical knowledge of data and the uncertainty; (2) decision-maker can design 
uncertainty set based on experiences, wherein the exact value is still not known; and 
(3) it has a mechanism to tradeoff objective value with probability violation limits. 
Some popular methodologies and recent attempts of RO-APP are summarized in the 
next section.
8.1.2 aPP and robust oPtimization metHodologies
Robust optimization methodologies have been developed and widely applied in 
APP. Recent advances include models focusing on energy saving (Modarres and 
Izadpanahi, 2016), multi-product (Mirzapour Al-E-Hashem et al., 2011), multi-site 
(Leung et al., 2007), and some integrated approaches (Aouam and Brahimi, 2013). 
However, just a few works of literature have presented an APP that uses several 
process paths (Chaturvedi et al., 2021). Therefore, this study will focus on different 
robust optimization methodologies and their implementation on APP with multiple 
routes. Further, their results are compared in later sections.136 Optimization for Energy Systems and Supply Chains
Soyster (1973) gave the first introduction to handle coefficient uncertainty. The 
aim was to modify the uncertain optimization model into a deterministic counter￾part. It models in such a way that any acceptable solution within their established 
uncertainty sets may be achieved using all possible realizations of uncertain parame￾ters. This method is seen to be useful since it protects the decision-maker from ambi￾guity over all potential parameter values. However, this method frequently yields too 
cautious results, resulting in a loss of optimality. As a result, a resilient solution can 
be assured at the expense of optimality.
Furthermore, Ben-Tal and Nemirovski (1999) introduced the robust counterpart 
formulation, which is extremely conservative and highly desired, with the flexibil￾ity to allow a performance-to-robustness tradeoff. In this approach, nonlinear con￾straints are used to handle uncertainties in linear programming, with a method to 
adjust the degree of solution conservatism via the constraint violation probability. 
The drawback of this approach is that it introduces nonlinearity, which increases the 
size of the issue and the computing work required to solve it.
Bertsimas and Sim (2004) suggested robust linear programming with coefficient 
uncertainty to avoid the complexity associated with nonlinearity. They claim that 
all of the unknown coefficient parameters achieving the worst-case value simul￾taneously is unlikely. As a result, a budget parameter is included to regulate the 
solution’s conservatism. This approach may regulate the parameters that are permit￾ted to reach their worst-case value and tradeoff with a probability violation upper 
bound (Thiele, 2007). The main tools of robust optimization are uncertainty sets 
and a robust counterpart problem. Thus, uncertainty in the parameters (e.g., SEC, 
C, EF) is described via uncertainty set. Let there be a matrix A (nonempty uncer￾tainty set Eqs. (8.3) and (8.4)), which contains all possible values that may be real￾ized for parametric uncertainties of process parameters. Uncertainty is considered 
to affect only the constraint coefficient aα ,  where every element of the vector aα i.e. 
aαβ , 1 β ∈ … { } , 2, .n is uncertain; here α is the index for constraint under uncertainty 
and β is the index of uncertain parameters. The decision-maker knows range fore￾casts for all the uncertain parameters, specifically; parameter aαβ belongs to the inter￾val  a a αβ − + ˆαβ ,   a a αβ ˆαβ 
. The interval is centered at a nominal value aαβ, while aˆαβ
measures the deviation magnitude. The scaled deviation vαβ ∈ −[ ] 1,1 of the parameter 
aαβ from its nominal value can be defined as in Eq. (8.1).
a a − vαβ = αβ αβ (8.1)
aˆαβ
n
The sum of scaled deviations for constraint α, ∑vαβ , is more precise than indi￾β=1
vidual ones and can take any value between 0 and n; nonetheless, it is unlikely that 
all the coefficients take their worst cases at the same time. Therefore, the true value n n
of∑v v αβ ∑ αβ can be assumed to be a narrower range (Eq. 8.2), i.e.
β= = 1 1 β
n
 ∑vαβ ≤ Γα (8.2)
β=1Constrained Production Planning with Parametric Uncertainties 137
Here Γ ∈α [ ] 0,n is known as the budget of the uncertainty for constraint α and is 
used to regulate the robustness with the level of probability violation. Γ = α 0 rep￾resents that there is no protection against uncertainty, and Γ = α n results in a very 
conservative solution considering all the uncertain parameters take the worst-case 
values at the same time. The uncertainty set A is:
 A a = = { } ( ) αβ a a αβ αβ + ∀ a v ˆαβ αβ ,       , α β,v V αβ ∈ α (8.3)
where Vα is the set of uncertain parameters in constraint α is defined as:

 n 
 Vα α = =   [ v vα α 1 2 , , v v  αβ ]      1 v v αβ ≤ ∀,     ,  ∑vαβ ≤ Γ β  (8.4)
 β=1 
A robust optimal solution can now be obtained by modifying the deterministic con￾straint. A general robust counterpart constrained is presented in Eq. (8.5).
+ ≥ min∑
n
aα x aˆαβ x vβ αβ 0,    ∀ α (8.5) v V α α ∈ β=1
Through the application of strong duality, the equivalent model to the problem is:
aα α x p − Γ  0 L q α α − ≥
v V
∑ β ,    ∀ α (8.6)
∈ α
zLα α + ≥ q u β α a , ˆ β β    ∀ α (8.7)
  0 zLα α ≥ ≥ ,  q β 0, ∀ α (8.8)
Variables   , z q α αβ, and uβ are additional variables introduced by the duality theorem 
for each constraint (Eqs. 8.6–8.8) of the robust problem. The probability violation 
methodology can be adapted from Bertsimas and Sim (2004).
8.2 METHODOLOGY
This section comprises three sections to describe the methodology for an APP with 
constrained parameters. It includes a problem statement that describes a scenario of 
production planning with multiple process routes. Next, a mathematical formulation 
is presented to formulate the problem described in Section 8.2.1. In the last section, 
robust optimization formulations are presented and formulated to provide solutions 
for APP problems with uncertainty.
8.2.1 Problem statement
Given Zi
 process routes to produce a finished product from raw material. With the 
increasing demand of the future, Pi
, i.e., the variable amount of production level from 
the ith process route needs to be enhanced.138 Optimization for Energy Systems and Supply Chains
The APP aims to plan production with a restriction on total carbon emission and 
total energy consumption. Here each process route has an emission factor (EF )i , which 
is uncertain and can vary uniformly in the region  EF E i i ∈ −  F E    F ,i i   EF + EFi . 
The evidence on uncertainty is believed to be unknown but constrained assum￾ing the uncertainty space is convex. Similarly, each process route has a specific 
energy consumption (SECi) which is also uncertain and can vary in the region 
 SECi i ∈ − SEC S  ECi i ,  SEC + SECi . The maximum level of production from  
ith process route is specified to be Pmax i . Also production cost per unit production 
( ) Ci from each process route is also specified to be within the region process route 
C C i i ∈ −  C C   i i ,   + C  i . 
The objective is to minimize the production cost by satisfying the limits of carbon 
emission and energy consumption.
8.2.2 deterministiC matHematiCal Formulation
This section gives the mathematical formulation taking the nominal values. The 
mathematical model comprises the following sets, variables, parameters, and con￾straints. The most important constraint is to meet the production demand; the con￾straint is expressed in Eq. (8.9). Each process route Pi has the maximum production 
limit defined by Eq. (8.10).
Zs
∑Pi d = P (8.9)
i=1
Pi i ≤ Pmax
 (8.10)
The constraint on total carbon emission limit (CEL) and total energy consumption 
limit (ECL) is given by Eqs. (8.11) and (8.12), respectively.
∑
Zs
EFi i × ≤ P CEL (8.11)
i=1
Zs
∑SEC E i i × ≤ P CL (8.12)
i=1
The objective is to minimize the total production cost (TPC), i.e., given in Eq. (8.13):
Zs
minimize ∑Ci i × P (8.13)
i=1
8.2.3 robust matHematiCal Formulation inCluding unCertainty
In this chapter, three popular mathematical methodologies are adapted to handle 
uncertainty in APP and are listed as follows:Constrained Production Planning with Parametric Uncertainties 139
 i. 
 ii. 140 Optimization for Energy Systems and Supply Chains
−M P SEC S i i ≤ − K M EC
i i ≤ SEC
 (8.20)
∑
zs s
+ + ∑
z
ˆ Ω ≤ 2
C   P P C   M K C C C P C2 ii ii i i i C (8.21)
i= = 1 1 i
−M P EFC E i i ≤ − K M FC
i i ≤ EFC
 (8.22)
 iii. 
Equation (8.11) that restricts the carbon emission limit is modified as following 
Eqs. (8.23) and (8.24). 
zs s Z
∑P zE i i EF + Γ L q E + ≤ ∑ E
i   CEL,     ∀ i (8.23)
i=1 i
zL q E + ≥ E
i P i i i × ∀ EF,          (8.24)
Similarly, Eq. (8.12) that limits energy consumption is restructured as Eqs. (8.25) 
and (8.26).
s s Z
∑
z
P z SEC   + ΓSEC SEC i i L q + ≤ ∑ SEC i ECL,     ∀   i (8.25)
i=1 i
zL q SEC S + ≥ EC
i i P i × ∀ SEC i ,       (8.26)
Further, the objective that aims to minimize (Eq. 8.13) the production cost (PC) is 
modified as Eqs. (8.27) and (8.28).Constrained Production Planning with Parametric Uncertainties 141
∑
zs s Z
P zL q C C i i C   + ΓC + ≤ ∑ i PC     ∀ i (8.27)
i=1 i
zL q C + ≥ C
i P i i i × ∀ C,         (8.28)
The overall formulation can be solved as a linear programming formulation. 
Probability violation methodology with respect to uncertainty realization can be 
adapted from Bertsimas and Sim (2004).
The flow chart in Figure 8.1 depicts an APP approach with unknown parameters 
for production cost reliability. To begin, the suggested mathematical model is solved 
Start 
Given:
1. Nominal parameters
related to process routes.
2. Maximum limit for
CEL and ECL.
3. Total demand
Check 
Feasibility 
Solve the model as formulated in section 8.2.3
by introducing a level of uncertainty 
Planner 
Satisfied
Calculate the upper bound probability
violation for the assigned budget parameter 
End 
Modify 
Limits
Production plan is obtained to be
implemented 
Modify 
uncertainty 
parameter 
Yes 
Yes 
No
No
FIGURE 8.1 Flowchart for the methodology of robust APP.142 Optimization for Energy Systems and Supply Chains
using the provided data by assigning a budget parameter to each constraint: pro￾duction cost (ΓC), carbon emission (ΓE), and energy consumption (ΓSEC). A viable 
model will result in the lowest cost with a production plan for the prescribed level of 
uncertainty. The model becomes infeasible if the true values of the parameter exceed 
the capped limit of constraints; however, this may be handled in a variety of ways, 
as detailed further in this section. Then, using the provided budget parameter, deter￾mine the upper bound probability violation. If the decision-maker is satisfied with 
the results, the operation may be completed by getting a production plan that meets 
the specified dependability limits. If the result is unsatisfactory, the operation should 
be repeated with a different budget parameter value until the planner can make an 
adequate tradeoff between the surplus production cost and the estimated probabil￾ity violation value. With an objective to minimize production cost, the optimization 
model results could be infeasible for a specific uncertainty level. The reason may be 
that the constrained limit for total carbon emission and energy consumption might 
be violating and not satisfied with the process routes’ production limit. The issue can 
be resolved with the following cases.
 1.
 2.
For the first case, the capped limits could be extended until the model outputs are 
feasible for their respective known budget
8.3 CASE STUDY: INDIAN STEEL INDUSTRY
A case study based on the Indian steel industry is studied using proposed formula￾tions. India is the world’s third-largest steel manufacturer (Centre of Science and 
Technology 2009), and steel output in 2030–2031 is expected to reach over 302 
Megaton (Mt). Steel is produced in India primarily using four process pathways: 
scrap-electric arc furnace (scrap-EAF), gas-based direct reduced iron-electric arc 
furnace (gas-based DRI-EAF), blast furnace/basic oxygen furnace (BF/BOF), and 
coal-based direct reduced iron-electric arc furnace (coal-based DRI-EAF).
Each process route has its own SEC and EF and an arbitrary cost that must be pro￾duced per ton of product from each process route. It should be noted that the nominal 
value of process route parameters presented in Table 8.1 is average among different 
plants across the nation. Therefore, these parameters might fluctuate from their nom￾inal value in a defined interval due to the unexpected events production process. This 
could be due to accounting differences in plant performance, raw material variety 
and quality, etc. Hence a uniform variation in such parameters is assumed. Table 8.1 
shows the amount of product (steel) required for each process route, along with their 
corresponding unknown process parameters. As a total demand, 302 Mt of produc￾tion is required from all process pathways.
The objective of the task is to estimate production cost and predict it while taking 
into account parametric uncertainties while meeting demand. Total CO2 emission Constrained Production Planning with Parametric Uncertainties 143
and energy consumption are both limited at 1,000 t CO2 and 8,300 GJ, respectively. 
The deterministic problem is first solved, and the objective value of $87,00,000 is 
determined. The factors SEC, EF, and C may alter but are only considered to vary 
inside their respective circumscribed zone. The worst-case scenario corresponds to 
the greatest value of all the parameters, with the goal of minimizing the production 
cost under uncertainty. The proposed formulations with three robust counterpart for￾mulations are presented and analyzed.
The problem is modeled in GAMS 24.8.2, solved using XPRESS (for LP) and 
DICOPT (for NLP) solver on the computer (Intel(R) Core (TM) i5 (3 GHz), 8 GB 
RAM). The results were obtained in a fraction of seconds.
Uncertainty in EF: In this case, bounded and symmetric uncertainty in the 
emission factor of each process route is assumed. The nominal EF along 
with the variability scale is presented in Table 8.1. In the previous section, 
it was stated that EFi (emission factor of the ith process route) can vary in 
the region  EF E i i ∈ −  F E  Fi i ,  EF + EFi . The parameters are considered to  
be varying to the right-hand side spread (leading to worst case) from the 
nominal value of the bounded interval.
At first, the model is solved using RO 1 approach. The worst-case sce￾nario responds to the maximum possible value in EF. The resultant objec￾tive value of $92,35,280 is required to produce steel and to satisfy projected 
demand. The modified production plan is presented in Table 8.2. Providing 
flexibility to the model, RO 2 formulation is implemented with different 
reliability levels. Figure 8.2 represents the variation of objective value 
with respect to the level of uncertainty (ΩEF). It is observed that the model 
achieves a maximum value of $94,01,210 at ΩEF = 1, with the reliability of 
30%, and remains infeasible for a further level of uncertainty. It can be con￾cluded that this case model produces over-conservative results compared to 
other formulations.
The budget parameter allows the tradeoff between the goal value and 
upper bound of probability violation in the RO 3 formulation. Here, ΓEF
will govern the amount of uncertainty in this case, and its influence on the 
objective value (production cost) may be seen in Figure 8.2b. It is also worth 
TABLE 8.1
Description of Process Routes for the Indian Steel Industry (Sinha and 
Chaturvedi, 2018)
Process Routes
EF
(t CO2/Mt 
Product)
SEC
(GJ/Mt 
Product)
Production Cost
($k/Mt Product)
Maximum Projected 
Production in 
2030-2031 (Mt)
Scrap-EAF 1.1 ± 0.11 20 ± 4 50 ± 3 32
Gas-based DRI-EAF 1.5 ± 0.35 21.9 ± 2 60 ± 3 19
BF/BOF 2.1 ± 0.4 29 ± 4 30 ± 2 95
Coal-based DRI-EAF 3.8 ± 0.5 23.4 ± 3 25 ± 2 180144 Optimization for Energy Systems and Supply Chains
noting that the manufacturing cost does not change until Γ = EF 0.8, show￾ing that this level of uncertainty will not affect the production plan. Beyond 
this level, the model looks for other possible production plans to minimize 
objective value by satisfying the emission and energy constraints. Between 
the levels of uncertainty (0.8, 2), there is a sharp increase in manufactur￾ing cost, which then gradually increases. This is because the model looks 
for appropriate production plans to carry out production within established 
constraints on the expense of production cost. Table 8.2 shows the effect of 
altering the budget parameter on the upper bound of probability violation. It 
is observed that with an increase in budget parameters, the objective value 
increases. The surplus amount is also known as the price of robustness. This 
provides a choice to the decision-maker for a tradeoff between the price of 
robustness and the upper bound of the probability violation.
TABLE 8.2
Solution Data of Example
RO 2 RO 3
ΩEF ΓEF
(a) EF Uncertainty Nominal RO 1 0 1 1.5 0 2 4
Objective ($k) 8,700 9,235.28 8,700 9,401.2 Not- 8,700 9,150 9,235.28
Const. violation prob. 0 1 0.6 feasible 0.71 0.295 0.0625
Production plan (Mt)
Scrap-EAF 27 32 27 32 27 32 32
Gas-based DRI-EAF – 11.72 – 14.46 – 9 11.72
BF/BOF 95 95 95 95 95 95 95
Coal-based DRI-EAF 180 163.27 180 158.54 180 166 163.27
ΩSEC ΓSEC
(b) SEC Uncertainty 2 1.2 1.5 2 2 4
Objective ($k) 8700 Not- 8,700 8,700 9,143.28 8,700 8,967.5 Infea￾Const. violation prob. Feasible 1 0.7 0.32 0.71 0.295 sible
Production plan (Mt)
Scrap-EAF 27 27 27.9 32 27 32
Gas-based DRI-EAF – – 11.443 – 5.59
BF/BOF 95 95 94.1 78.557 95 84.41
Coal-based DRI-EAF 180 180 180 180 180 180
ΩC ΓC
(c) Cost Uncertainty 0 1.2 1.5 0 2 4
Objective ($k) 8,700 9,331 8,700 9,197 9,290.5 8,700 9,250 9,331
Const. violation prob. 1 1 0.7 0.32 0.71 0.295 0.0625
Production plan (Mt)
Scrap-EAF 27 27 27 27 27 27 27 27
Gas-based DRI-EAF – – – – – – – –
BF/BOF 95 95 95 95 95 95 95 95
Coal-based DRI-EAF 180 180 180 180 180 180 180 180Constrained Production Planning with Parametric Uncertainties 145
Uncertainty in SEC: Similarly, in this case, true values of SEC appear in the 
bounded and symmetric region   S ECi i − + SEC   ,  SEC S   i i EC . Table 8.1 
presents the nominal SEC of each process route and the variability scale.
From RO 1, the model results are infeasible because no production 
plan was possible at the maximum uncertainty level. Therefore, the plan￾ner should seek other possible options in such a case by modifying capped 
limits or increasing the maximum production capacity from other process 
routes. According to RO 2 formulation, there was no significant change in 
the production plan till ΩEF = 1.1, beyond that the objective value increases 
until 1.8 with a reliability level of 80%. It is perceived that the model turns 
infeasible beyond this scale. With RO 3, the degree of uncertainty is regu￾lated by the ΓSEC and can be seen in Figure 8.2b to signify its resulting 
influence on the objective value. Similar to the prior situation, no effect 
on the production plan or goal value was noticed until Γ = SEC 1.6. It is also 
worth noting that the realistic production plan can only be realized up to 
Γ = SEC 3.6, with a $93,75,760 goal. Beyond this point, the total capping of 
energy consumption may be surpassed, resulting in infeasibility. Table 8.2a 
shows the outcome of the upper bound of probability violation with vari￾ance in budget parameter. 
Uncertainty in production cost: In the same manner, the cost (Ci) varies in 
the interval C C i i − +   ,  C C i i . Since there is no limit over production cost,  
all the models will result in feasible solutions with any realization of uncer￾tainty in the bounded set. Also, there is no change observed in the produc￾tion plan as long it follows the capped limit, which is considered not to be 
stable in this case. With RO 1 formulation, a 7.2% increase in production 
cost is observed. With RO 2 formulation, a steady increase in production 
cost is observed (Figure 8.2a) until ΩC = 1.8 and constant thereafter. The 
model guarantees more than 80% of reliability corresponding to the objec￾tive value of $93,31,000.
FIGURE 8.2 Impact on the objective value with variation in uncertainty realization for 
(a) RO 2 and (b) RO 3.146 Optimization for Energy Systems and Supply Chains
Similarly, a gradual increase is observed in the production cost with an increas￾ing level of uncertainty in RO 3. It will result in feasible solutions for any budget 
parameter lies between [0,4]. For the worst-case, i.e.,   4 Γ = C , the resultant objec￾tive value will be $93,31,000, with a probability of constraint violation to be 0.0625 
(Table 8.2c). However, the objective value results are constant beyond Γ = C 3, show￾ing that only 75% of uncertain parameters (cost) influence the objective value.
A production plan considering all uncertainties is presented in Table 8.3. Cases 
with RO 2 and RO 3 are presented only, as RO 1 was infeasible in a specific case of 
uncertain SEC. With their respective value of uncertainty level, RO 3 produces better 
and offers a good level of reliability as compared to RO 2. The results are tabulated 
in Table 8.3; with an expense of $16,860, RO 3 offers 40% more assurance in the 
probability of constraint violation.
The outcomes of the proposed work will assist the planner in the following ways:
• Obtaining a production plan that should be followed adhering to restricted 
standards.
• Estimating the production cost in uncertain scenarios.
• Providing flexibility to the model and the ability to modify it based on 
uncertainty level.
8.4 CONCLUSION
With rising concerns about carbon emission, energy usage, and manufacturing costs, 
it is more critical than ever to plan with environmental constraints and uncertainty. 
A small change in such factors may technically and economically affect future plan￾ning models. Therefore, this chapter presents robust optimization formulations to 
handle parametric uncertainty in parameters associated with APPs having numer￾ous process pathways. The proposed planning model aims to limit carbon emission 
and energy consumption while satisfying demand. The optimization problem is 
addressed to estimate the minimum production cost. Three formulations are pro￾posed, and their results are compared with the deterministic case. The models are 
ranked according to their solution conservatism and consistency. A case study of 
steel manufacturing in India is used to explain the recommended formulas. An upper 
TABLE 8.3
Production Plan with Multiple Uncertainties
RO 2 RO 3
ΩEF ,  Ω Ω SEC E , 1 F = , Γ Γ EF ,   SEC C ,  Γ = 2
Production cost ($k) 9,786.24 9,803.1
Production plan (Mt)
Scrap-EAF 32 32
Gas-based DRI-EAF 16.46 12.7
BF/BOF 95 89.3
Coal-based DRI-EAF 158.54 168Constrained Production Planning with Parametric Uncertainties 147
bound of probability violation is also presented for various production plans for each 
constraint. The planning problem can also be implemented by constraining the cost 
objective and optimizing the model for carbon emission and energy consumption. 
Similar planning problems would be linked with scheduling for sustainable produc￾tion in future work.
ACKNOWLEDGMENTS
The authors would like to thank the Science and Engineering Research Board 
(SERB), India, and Indian Institute of Technology, Patna, for providing the research 
funding for this project under grant no. ECR/2018/000197.
NOMENCLATURE
sets
i I ∈ process routes
Parameters
Zi process routes
EFi emission factor of process route ‘i’ 
SECi specific energy consumption of process route ‘i’ 
Ci production cost per unit product of process route ‘i’ 
Pmax i maximum production level of process route ‘i’ 
Pd total production demand
CEL carbon emission limit
ECL energy consumption limit
EFi , SEC ,i i C emission factor, specific energy consumption, cost: nominal value 
of process route ‘i’ 
E
F ,i i
 SEC , Ci emission factor, specific energy consumption, cost uncertainty 
spread of process route ‘i’ 
Γ Γ EF ,  SEC C , Γ budget of uncertainty for emission factor, specific energy consump￾tion, cost uncertainty
variables
Pi amount of production from process route ‘i’ 
LzE , qE
i , zL q C ,  C
i positive auxiliary variables for RO 3
M K EF EF
i i ,  , M K C C
i , i positive auxiliary variables for RO 2
REFERENCES
Aouam, T., Brahimi, N., 2013. Integrated production planning and order acceptance under 
uncertainty: A robust optimization approach. European Journal of Operational 
Research 228, 504–515. Doi: 10.1016/j.ejor.2013.02.010.148 Optimization for Energy Systems and Supply Chains
Ben-Tal, A., Nemirovski, A., 1999. Robust solutions of uncertain linear programs. Operations 
Research Letters 25, 1–13. Doi: 10.1016/S0167-6377(99)00016-4.
Bertsimas, D., Sim, M., 2004. The price of robustness. Operations Research 52, 35–53. 
Doi: 10.1287/opre.1030.0065.
Chaturvedi, N.D., 2017a. Minimizing energy consumption via multiple installations 
aggregate production planning. Clean Technologies and Environmental Policy 19, 
1977–1984. Doi: 10.1007/s10098-017-1376-3.
Chaturvedi, N.D., 2017b. Minimizing the energy requirement in batch water networks. 
Industrial and Engineering Chemistry Research 56, 241–249. Doi: 10.1021/acs.
iecr.6b02543.
Chaturvedi, N.D., 2020. Cost optimal sizing of hybrid power systems: A pinch analysis 
approach. Chemical Engineering Transactions 81. Doi: 10.3303/CET2081163.
Chaturvedi, N.D., Kumawat, P.K., Keshari, A.K., 2021. Energy and carbon-constrained pro￾duction planning with parametric uncertainties. IFAC-PapersOnLine 54, 560–565. 
Doi: 10.1016/j.ifacol.2021.08.301.
Golari, M., Fan, N., Jin, T., 2017. Multistage stochastic optimization for production-inventory 
planning with intermittent renewable energy. Production and Operations Management
26, 409–425. Doi: 10.1111/poms.12657.
Jamalnia, A., Yang, J.B., Feili, A., Xu, D.L., Jamali, G., 2019. Aggregate production plan￾ning under uncertainty: a comprehensive literature survey and future research direc￾tions. International Journal of Advanced Manufacturing Technology 102, 159–181. 
Doi: 10.1007/s00170-018-3151-y.
Kumawat, P.K., Chaturvedi, N.D., 2021. Robust resource targeting in continuous and batch pro￾cess. Clean Technologies and Environmental Policy. Doi: 10.1007/s10098-021-02118-8.
Kumawat, P.K., Sinha, R.K., Chaturvedi, N.D., 2021. Multi-objective optimization for sus￾tainable production planning. Environmental Progress and Sustainable Energy. 
Doi: 10.1002/ep.13741.
Leung, S.C.H., Tsang, S.O.S., Ng, W.L., Wu, Y., 2007. A robust optimization model for multi￾site production planning problem in an uncertain environment. European Journal of 
Operational Research 181, 224–238. Doi: 10.1016/j.ejor.2006.06.011.
Mirakyan, A., De Guio, R., 2015. Modelling and uncertainties in integrated energy planning. 
Renewable and Sustainable Energy Reviews 46, 62–69. Doi: 10.1016/j.rser.2015.02.028.
Mirzapour Al-E-Hashem, S.M.J., Malekly, H., Aryanezhad, M.B., 2011. A multi-objective 
robust optimization model for multi-product multi-site aggregate production planning 
in a supply chain under uncertainty. International Journal of Production Economics
134, 28–42. Doi: 10.1016/j.ijpe.2011.01.027.
Modarres, M., Izadpanahi, E., 2016. Aggregate production planning by focusing on 
energy saving: A robust optimization approach. Journal of Cleaner Production 133, 
1074–1085. Doi: 10.1016/j.jclepro.2016.05.133.
Mula, J., Poler, R., García-Sabater, G.S., Lario, F.C., 2006. Models for production planning 
under uncertainty: A review. International Journal of Production Economics 103, 
271–285. Doi: 10.1016/j.ijpe.2005.09.001.
Nam, S.J., Logendran, R., 1992. Aggregate production planning - A survey of mod￾els and methodologies. European Journal of Operational Research 61, 255–272. 
Doi: 10.1016/0377-2217(92)90356-E.
Rakes, T.R., Franz, L.S., James Wynne, A., 1984. Aggregate production planning using 
chance-constrained goal programming. International Journal of Production Research 
22, 673–684. Doi: 10.1080/00207548408942487.
Sagawa, J.K., Nagano, M.S., 2021. Integration, uncertainty and information: How do they affect 
planning performance? Revista de Gestão 28, 23–49. Doi: 10.1108/rege-11-2019-0113.Constrained Production Planning with Parametric Uncertainties 149
Sinha, R.K., Chaturvedi, N.D., 2018. A graphical dual objective approach for minimizing 
energy consumption and carbon emission in production planning. Journal of Cleaner 
Production 171, 312–321. Doi: 10.1016/j.jclepro.2017.09.272.
Sinha, R.K., Chaturvedi, N.D., 2019. A review on carbon emission reduction in industries and 
planning emission limits. Renewable and Sustainable Energy Reviews 114, 109304. 
Doi: 10.1016/j.rser.2019.109304.
Soyster, AL, 1973. Convex programming with set- inclusive constraints and applications to 
inexact linear programming. Operations Research 21(5), 1154–1157.
Thiele, D.B., 2007. Robust and data-driven optimization: Modern decision making under 
uncertainty. INFORMS Tutorials in Operations Research. Doi: 10.1287/educ.1063.0022.151
9 Linear Programming 
Models Based on the 
Input-Output Framework
Raymond R. Tan and Kathleen B. Aviso
De La Salle University
Jui-Yuan Lee
National Taipei University of Technology
9.1 INTRODUCTION
Input-output (I-O) analysis is a well-established framework for modelling economic 
structures using systems of linear equations. Based on the Nobel Prize-winning work 
of Leontief (1936), I-O models are now routinely used as part of national statistics 
in most countries. I-O models provide a mathematically elegant approach to cap￾turing interdependencies among sectors in an economy. These interdependencies 
reflect aggregate supply chain linkages and create a network-like economic structure 
through which indirect ripple effects can propagate. I-O models have been used to 
analyze the ripple effects of disruptive events such as terrorist attacks (Santos and 
Haimes, 2004), pollinator loss (Khanna and Bakshi, 2009), and pandemics (Foong et 
al., 2022). The capability to identify emergent properties of economic structures is the 
most powerful feature of I-O models. The underlying linearity assumptions simplify 
calculations with I-O models and allow them to be implemented with commercial 
spreadsheet software. In practice, national I-O tables are calibrated from records of 
CONTENTS
9.1 Introduction .................................................................................................. 151
9.2 Methodology ................................................................................................. 153
9.2.1 Overview of the I-O Framework ...................................................... 153
9.2.2 LP Models Based on the I-O Framework ......................................... 154
9.3 Case Study 1: Energy Allocation during a Shortage .................................... 157
9.4 Case Study 2: Decarbonization via Economic Restructuring ...................... 160
9.5 Conclusion .................................................................................................... 162
Further Reading ..................................................................................................... 162
References .............................................................................................................. 162
Appendix 9A: LINGO Code for Case Study 1 ...................................................... 164
Appendix 9B: LINGO Code for Case Study 2 ...................................................... 166
DOI: 10.1201/9781003240228-11152 Optimization for Energy Systems and Supply Chains
actual transactions, so that the coefficients represent aggregate supply chain linkages 
between economic sectors in the recent past; however, this “top-down” approach can 
also be supplemented with “bottom-up” calibration using engineering models of key 
technologies used by firms (Wachs and Singh, 2018). A comprehensive discussion of 
I-O models can be found in the textbook by Miller and Blair (2009).
Although the basic I-O model is used for the analysis of inter-industry economic 
flows, there are two important extensions. First, mathematical programming models 
based on the I-O framework have been developed to allow the optimization, rather 
than just passive analysis, of economic networks. Such capability is important for 
mitigating adverse economic impacts in the context of risk management (Jiang and 
Haimes, 2004). An early application used a multi-objective optimization model to 
deal with various crises, including power plant failure, trade embargo, and inter￾national conflict, in Finland (Kananen et al., 1990). An I-O-based linear program￾ming (LP) model was developed by Tan et al. (2015) to determine the capacity of 
an economic network to absorb shocks from disruptive events. A graph-theoretic 
implementation of the I-O model was developed to determine the allocation of com￾modities among economic sectors during a shortage. The model was formulated 
to minimize gross domestic product (GDP) loss and was applied to the problem of 
electricity rationing in the Philippines (Aviso et al., 2015). To relax the common 
assumption of one-to-one correspondence between commodities and economic sec￾tors, technology choice was integrated into an I-O model variant with rectangular 
technical coefficient matrices (Duchin and Levine, 2011). The presence of such tech￾nology choices introduces excess degrees of freedom to allow optimization within 
an I-O model. Use of I-O models to maximize the impacts of military operations has 
also been proposed (Gallagher et al., 2005).
The second important variant of the basic I-O model integrates an environmental 
extension by introducing a supplementary set of coefficients that reflect natural resource 
use, pollutant generation, and environmental footprints. Such environmentally extended 
I-O models have been used extensively in sustainability science. An early discussion 
of this topic was given in a tutorial article by Chen (1973). I-O analysis was proposed 
by Duchin (1992) as a tool for rigorous modelling in the field of industrial ecology 
(IE), which sought to model sustainable industrial networks after natural ecosystems. 
Environmentally extended I-O models have also been used in the context of life cycle 
assessment (LCA) due to the structural similarity of the calculations involved (Heijungs 
and Suh, 2002). An I-O model was developed to gauge the link between quality of life 
and natural resource depletion using energy return on investment (EROI) as a metric 
(Brandt, 2017). More recently, environmentally extended I-O models have been used to 
gauge the effectiveness of measures to implement the circular economy (CE) concept 
(Aguilar-Hernandez et al., 2018). These I-O variants are particularly useful for quantify￾ing sustainability footprints embedded in economic goods (Yang et al, 2020).
Some I-O models combine both optimization and environmental extensions. For 
example, an early fuzzy optimization model based on the I-O framework was pro￾posed to assess how decarbonization efforts will affect the economy of Taiwan (Hsu 
et al., 2000). A fractional programming I-O model was used to explore decarbon￾ization scenarios for the Philippine economy, taking into account commitments to 
the Paris Agreement (Cayamanda et al., 2017). A similar model was proposed by Linear Programming Models Based on the Input-Output Framework 153
Heijungs et al. (2014) for maximizing economic affluence using the planetary bound￾aries as sustainability constraints. A brief tutorial on this topic can be found in the 
encyclopedia chapter by Tan et al. (2017). Alternative optimization tools have also 
been used in combination with I-O models. One recent example is a hybrid carbon 
emissions pinch analysis (CEPA) and I-O model developed for decarbonization plan￾ning (Tan et al., 2018). Different variations of I-O optimization formulations are 
discussed in the book of Tan et al. (2019).
This chapter is organized as follows. Section 9.2 gives a brief overview of the 
basic I-O model. Section 9.3 then gives two LP formulations based on the I-O frame￾work: one for optimal allocation of a scarce resource during a shortage, and the other 
for optimal economic restructuring to minimize greenhouse gas (GHG) emissions. 
Section 9.4 applies the first LP model to a hypothetical case study of an energy short￾age in Taiwan, using a low-resolution model derived from official statistics (Statistical 
Bureau, 2021); Section 9.5 deals with a decarbonization scenario via optimal eco￾nomic restructuring, where the Taiwan I-O data is augmented with GHG emissions 
data reported by the Environmental Protection Administration (2021). Concluding 
remarks are given in Section 9.6.
9.2 METHODOLOGY
9.2.1 overview oF tHe i-o Framework
The basic I-O model (Leontief, 1936) summarizes the balance of flows of economic 
goods in an economy with n number of economic sectors contained in set M, where 
the total output of sector i, xi
 is the sum of intermediate demand (given by the second 
term in Eq. 9.1) and final demand, yi
:
n
xi j = + ∑a , ijx yi ⋅ ∀i j ∈M (9.1)
j=1
where aij forms the matrix of technical coefficients, xi
 is the total output of sector i, 
and yi
 is the final demand (i.e., net or final output) of sector i. The coefficients aij reflect 
the current average state of technology of a particular class of goods. For example, it 
is possible to reflect the typical fuel requirement of a gas-fired power plant per unit 
of electricity as coefficients. In conventional I-O models, it is assumed that there is a 
one-to-one correspondence between economic sectors (i.e., each sector produces one 
commodity group) so that the technical coefficients form a square matrix. The fixed 
numerical coefficients aij, which represent the required inputs to sector j from sector 
i, also imply having a fixed mix of inputs for a given unit of production, without the 
flexibility of substitution. This assumption of having a rigid Leontief production func￾tion is an inherent limitation of the I-O model, since in many cases some degree of 
substitution is actually possible. Each coefficient xi
 gives the total output of sector i in 
an economy; note that this figure is simply the combined output of all the firms that 
are in the sector. The coefficients yi
 give the portion of total output in sector i which 
is consumed by households as finished goods. The discrepancy between correspond￾ing elements of xi
 and yi
 corresponds to intermediate demand, which is the portion of 154 Optimization for Energy Systems and Supply Chains
the total production that is used as inputs to produce other goods. In standard I-O 
practice, the values in Eq. (9.1) are in terms of economic value (although the same 
principles apply to physical flow of goods as well). The sum of all final demands yi
is known as the Gross Domestic Product (GDP), which is a commonly used measure 
of the size of an economy.
Equation (9.1) can be rearranged to give:
n
y x i i = −∑a , ijx i j ∀ ∈j M (9.2)
j=1
Environmental aspects such as consumption of natural resources or generation oaf 
waste and pollutants can be readily added to the basic model:
n
∑b   kjx z j k = ∀ j M     ∈ ∀,      k Z ∈ (9.3)
j=1
where bkj is the environmental coefficients for the amount of environmental 
emissions type k generated per unit of output from sector j and zk is the foot￾print for environmental emission type k. In this model, environmental flows 
are directly proportional to sector size because of the implicit assumption of 
fixed technology portfolios. Note that an appropriate sign convention needs to 
be adopted in the general case where some sectors have inflows and others have 
outflows (Heijungs and Suh, 2002). This basic I-O model excludes the flow of 
goods from trade, which is beyond the scope of this chapter. Figure 9.1 depicts 
a typical I-O system, while the LP extensions of this basic model are discussed 
in the next section.
9.2.2 lP models based on tHe i-o Framework
The first LP extension considered here (referred to as Model I hereafter) is a risk 
management model based on earlier formulations (Kananen et al., 1990; Jiang and 
Haimes, 2004) and is intended to determine the allocation of a scarce commodity to 
maximize GDP during a crisis or shortage:
n
 max∑yi (9.4)
i=1
subject to:
n
y x i i = −∑a   ijx i j ∀ ∈ ,  j M (9.5)
j i =
xL
i ≤ ≤ x i U i x   i ∀ ∈M (9.6)Linear Programming Models Based on the Input-Output Framework 155
y y L
i ≤ ≤ y i U i i ∀ ∈     M (9.7)
where xL
i and xU
i are the bounds for total output of sector i, and yL
 and yU i i are the 
bounds for final demand of sector i. This LP model determines the allocation that 
gives the highest possible GDP during the crisis (Eq. 9.4); in general, this GDP will be 
lower than the GDP under non-crisis conditions, and thus, the problem is equivalent to 
a minimization of GDP loss. The model determines the allocation of total production 
xi to maximize GDP within the specified constraints. The flow balances of economic 
commodities still hold under these conditions (Eq. 9.5). Total output values of the eco￾nomic sectors are bounded by exogenously defined lower and upper limits (Eq. 9.6). 
In principle, the lower limits xL
i can be as low as zero (i.e., total cessation of produc￾tion in a sector), but in practice a non-zero value lower than the normal level may be 
specified based on other considerations such as employment. The upper limit of total 
output xU
i is determined by the production capacity of available capital stock in the 
economic sectors, and in practice may be close to the value of xi under normal condi￾tions. Similarly, final demand is bounded by exogenously defined limits in Eq. (9.7), 
where yL
i and yU
i represent deviations above and below the normal values of yi.
The second LP extension (Model II) incorporates an environmentally extended 
I-O model within the optimization formulation. The core formulation is described in 
FIGURE 9.1 An I-O representation of an economy consisting of sectors S-1, S-2, S-3, and 
S-4, with environmental flows.156 Optimization for Energy Systems and Supply Chains
previous works (e.g., Miller and Blair, 2009; Tan et al., 2017, 2019). It is intended to 
determine the optimal economic restructuring relative to a baseline state
n
max∑yi (9.8)
i=1
subject to:
∑
n
y x i i = − a   ijx i j ∀ ∈ ,  j M (9.9)
j=1
n
zk = ∀ ∑b   kjx j j   , ∈ ∀ M k     ∈K (9.10)
j=1
xL
i ≤ ≤ x i U i x   i ∀ ∈M (9.11)
y y L ≤ ≤ y i U i i i ∀ ∈     M (9.12)
zk ≤ ∀ z   U
k k K∈ (9.13)
where zU
k is the limit for footprint type k. The formulation is identical to that of 
Model I, except for two constraints arising from the environmental extension 
(Eqs. 9.10 and 9.13). The environmental footprint of the economic system is a func￾tion of the total output across sectors (Eq. 9.10) and must not exceed an exogenously 
defined upper limit (Eq. 9.13). The latter limit may be determined based on policy 
decisions, as in the case of nationally determined contributions to GHG emission 
cuts under the Paris Agreement. The other constraints have a similar meaning as in 
Model I, except for one key distinction. Since Model I is a risk management model, 
the optimal values of xi and yi represent temporary adjustments that are required 
only for the duration of the crisis, after which the system can revert to its normal 
state. In Model II, these deviations represent permanent changes in production and 
consumption patterns relative to the baseline state to improve the sustainability of 
the economy.
Note that both models described here assume a fixed set of coefficients, aij, and 
thus do not account for possible changes in technology that are beyond the scope of 
this chapter. Such effects can be accounted for by nonlinear programming (NLP) 
formulations with some coefficients aij variable; alternatively, mixed-integer linear 
programming (MILP) formulations can be developed where discrete technology 
choices are available (Duchin and Levine, 2011).
Both LPs are easily implemented using different modelling environments. These 
models can easily be built and solved without computational issues in Excel, whose 
standard built-in solver includes the ubiquitous simplex algorithm for LP problems. 
Alternatively, commercial equation-based optimization software such as LINGO can 
be used; a recent tutorial on the use of this software for I-O models can be found Linear Programming Models Based on the Input-Output Framework 157
in a chapter of the book of Tan et al. (2019). Two case studies using Taiwan data 
(Statistical Bureau, 2021; Environmental Protection Administration, 2021) are pre￾sented in the next two sections; the corresponding LINGO codes for these examples 
are also given in Appendices A and B.
9.3 CASE STUDY 1: ENERGY ALLOCATION DURING A SHORTAGE
This case study illustrates how Model I can be used to allocate scarce goods among 
economic sectors to minimize total economic losses. Such shortages can be triggered 
by natural events such as droughts (Aviso et al., 2021) or by manmade crises, such as 
the lockdowns imposed to control the COVID-19 pandemic (Foong et al., 2022). The 
inherent network representation allows indirect effects and linkages to be accounted 
for. These principles are applied here to the case of Taiwan.
In Taiwan’s energy transition plan, the proportion of gas-fired power generation 
will increase from 35.7% in 2020 to 50% by 2025, and the demand for natural gas 
(NG) will increase substantially. However, Taiwan depends on imports for its NG 
supply – 99% of the supplies come by ship. There is the risk of import interrup￾tion and an NG shortage. NG supplies to Taiwan can be interrupted by shipping 
delays or unloading delays due to adverse weather conditions. Other risk factors 
include equipment failure, geopolitics, naval blockade, and international events. In 
case of an NG shortage, the supply of NG to the electricity enterprise, cogeneration 
systems, industry, transport sector, and NG utility enterprise will be controlled in 
order. Such a shortage can easily lead to ripple effects through the Taiwan economy; 
impacts may even propagate to other parts of the world for export-oriented sectors 
(Aviso et al., 2021).
We use a simplified, low-resolution, four-sector model of the Taiwan economy 
in 2016, derived from the data published by the Bureau of Statistics (2021). The 
number of sectors is reduced using techniques described by Miller and Blair (2009) 
by combining the sectors into four major groups, namely: (1) energy industries, (2) 
manufacturing and construction, (3) transport, and (4) others. The last group consists 
of agriculture and most of the service sectors. The transactions in the economy at 
the baseline state are shown in Table 9.1 in billion New Taiwan Dollars (NT$).1 The 
sum of the values in the final demand column gives the baseline GDP of NT$ 26,769 
billion. Each row of a given sector column (in the gray cells) lists the value of goods 
purchased from the corresponding supplier sector. Note that a sector can purchase 
inputs from itself, which is possible since firms in the sector can take inputs from 
other firms within the same sector (e.g., livestock farming requires an input of feeds 
from crop farming). Dividing these cells by the total output of the corresponding 
sector gives the matrix of technical coefficients in Table 9.2. It can be seen that the 
coefficients of this matrix give the fractional contribution of inputs to the value of 
the total sector output.
We then assume that there is an energy shortage that reduces the total output of 
the energy industries by 10% relative to the baseline state. Because of the afore￾mentioned assumption of having Leontief production functions, such an energy 
1 At current exchange rates, NT$ 30 is approximately equivalent to €1.158 Optimization for Energy Systems and Supply Chains
shortage is certain to result in an economic contraction for the duration of the 
shortage. One possible state can result from a naïve solution that assumes a propor￾tionate 10% contraction of all sectors in the economy, which then leads to a 10% 
loss of GDP. The procedure to arrive at this solution is trivial, and we leave it to 
the reader to determine the corresponding state of the economy. The question is, 
is it possible to have a GDP loss of less than 10% through selective rationing and 
allocation of scarce energy?
The solution can be found using Model I, assuming that the range of contraction 
of each sector is allowed to vary from 0% to 20% from the baseline, while the final 
demand, except that for the sector of Energy industries, is allowed to change by ±5% 
relative to normal conditions. The LINGO code for this model is shown in Appendix 
9A. Solving the model leads to an optimized state of the economy as shown in in Table 
9.3; this solution gives a GDP loss of 0.39%, which is far less than the 10% loss from the 
naïve solution assuming economy-wide proportionate contraction. The resulting GDP 
is NT$26,664 billion. Note that economic restructuring occurs since the contraction in 
TABLE 9.1
Baseline Transactions in the Taiwan Economy in Billions of NT$
Energy industries
Energy Industries
233 655 Manufacturing and Construction
181Transportation
273Others
543 Final Demand
1,342 Intermediate Demand
1,885 Total Output
Manufacturing and 758 10,238 65 1,481 13,509 12,542 26,051 
construction
Transportation 4 178 236 166 898 583 1,481 
Others 46 2,079 209 3,326 11,819 5,660 17,479 
TABLE 9.2
Matrix of Technical CoefficientsEnergy Industries
Manufacturing 
and Construction
Transportation
Others
Energy industries 0.124 0.025 0.122 0.016
Manufacturing and construction 0.402 0.393 0.044 0.085
Transportation 0.002 0.007 0.159 0.010
Others 0.024 0.080 0.141 0.190Linear Programming Models Based on the Input-Output Framework 159
each sector’s final demand does not need to be equal to the corresponding reduction in 
total output. For example, a comparison of the final demands of the energy industries in 
Tables 9.2 and 9.3 shows a reduction of 30.9%, even though the total output is reduced 
by just 10%. This result means that the available energy in the economy is prioritized 
for use as an intermediate input into the other sectors, a strategy that creates more eco￾nomic value than the final use of energy by households (Aviso et al., 2015). A similar 
redistribution of economic goods also occurs for the other sectors.
Sensitivity analysis with respect to different levels of energy shortage is shown in 
Table 9.4. No feasible solution was found at a 40% energy shortage, indicating that 
the degrees of contraction of the sectors or changes in the final demand caused by the 
crisis would exceed the specified bounds.
In practice, the solution to Model I may not be possible to duplicate precisely in 
a market economy. It should be seen as a benchmark which can be used to guide the 
implementation of target emergency policies and rationing regulations to mitigate 
economic damage from the shortage. For example, during an electricity shortage, the 
temporary closure of energy-intensive industries such as primary aluminum produc￾tion can be used as a measure to free up limited power supply for use by other sectors 
(Bastian-Pinto et al., 2015).
TABLE 9.3
Optimal Transactions in the Taiwan Economy in Billions of NT$ at a 10% 
Energy Shortage
Energy industries
Energy Industries
210
Manufacturing 
651and Construction
181Transportation
280Others
375Final Demand
1322 Intermediate Demand
1,697 Total Output
Manufacturing and 682 10,238 65 1,486 13,580 12,471 26,051 
construction
Transportation 3 182 235 175 885 596 1,481 
Others 41 2,084 209 3,321 11,824 5,655 17,479 
TABLE 9.4
GDP Loss at Different Levels of Energy Shortage
Level of Energy 
Shortage (%)
Total GDP 
(billion NT$) % GDP Loss
10 26,664 0.39
20 26,580 0.71
30 26,495 1.02
40 No feasible solution No feasible solution160 Optimization for Energy Systems and Supply Chains
9.4 CASE STUDY 2: DECARBONIZATION VIA 
ECONOMIC RESTRUCTURING
This case study illustrates the use of Model II to plan economic restructuring for 
purposes of decarbonization. Restructuring is defined here in the same sense as used 
by Cayamanda et al. (2017), where differentiated growth (or contraction) of the total 
outputs of economic sectors is used to reduce the carbon intensity of an economy. 
Radical changes in technology, which will be reflected as changes in technical coef￾ficients, are not considered.
In response to climate change concerns, a long-term national goal has been set for 
Taiwan to reduce GHG emissions to no more than 50% of the 2005 level by 2050. 
The government has also set intermediate targets of reducing GHG emissions by 2% 
from the 2005 level by 2020, by 10% from the 2005 level by 2025, and by 20% from 
the 2005 level by 2030. The required emission reductions are shared by the energy, 
manufacturing, transport, residential and commercial, agriculture, and environment 
sectors. This indicates the need for optimal economic restructuring, thereby achiev￾ing the intermediate and long-term emission reduction goals. Analysis of decarbon￾ization options for Taiwan has recently been published (Tsai, 2021).
We begin with the same baseline state of the Taiwan economy shown in Table 9.1. 
Direct sectoral GHG emissions are given in Table 9.5 based on data from the 
Environmental Protection Administration (2021). Note that total emissions amount 
to 265 Mt. Direct emission intensities can be found by dividing each entry by total 
sector economic output. Note, however, that the total emission intensity in the last 
row is normalized based on country GDP.
We then consider an optimal carbon-constrained economic restructuring problem 
as follows. The objective is to find the highest possible GDP without increasing total 
GHG emissions, assuming that the growth of total output of each sector is allowed to 
vary between ±10% from the baseline, while the final demand is allowed to grow by −5 
to +15%. The solution can be found using Model II, whose LINGO code is shown in 
Appendix 9B. Solving the model leads to an optimized state of the economy as shown 
in Table 9.6. The direct sectoral GHG emissions are shown in Table 9.7, along with their 
percentage change relative to the baseline. Note that these values also give the percent￾age change of sector total outputs. Although the total emissions remain the same at 
TABLE 9.5
Direct Sectoral GHG Emission in Taiwan (Environmental 
Protection Administration, 2021)
GHG Intensity 
GHG Emission (Mt) (Mt/billion NT$)
Energy industries 179.3 0.0951
Manufacturing and construction 38.5 0.0014
Transportation 37.4 0.0253
Others 9.8 0.0006
TOTAL 265 0.0099Linear Programming Models Based on the Input-Output Framework 161
265 Mt due to the exogenously specified limit, the increase in GDP by 4.56% leads to a 
reduction of the carbon intensity of the economy from 0.009907 to 0.009475 Mt/billion 
NT$. This change corresponds to a reduction of 4.36%. This optimal economic restruc￾turing results in a change in the distribution of goods in the economy. For example, com￾parison of the final demands of the transportation sector in Tables 9.1 and 9.6 indicates 
a contraction of 6.5%. However, the corresponding reduction in total output is just 2.1%, 
matching the reduction of direct GHG emissions from that sector in Table 9.7. This result 
means that transportation services are prioritized as an intermediate input for other sec￾tors to create more economic value compared to its final consumption by households.
As in the previous case study, in practice, the solution to Model II serves more as 
a performance benchmark, as it will not be possible to control a market economy pre￾cisely. This benchmark state can guide the planning and implementation of decarbon￾ization measures, such as those described by Tsai (2021). The economic restructuring 
can be induced through various policy instruments, such as selective financial incen￾tives or disincentives (e.g., carbon markets or taxes), or even the outright prohibition 
of classes of technologies. The projected phaseout of coal-fired power plants and non￾electric light vehicles in some Western economies are examples of such bans.
TABLE 9.6
Optimal Transactions in the Decarbonized Taiwan Economy in 
Billions of NT$
Energy industries
Energy Industries
233 
Manufacturing 
652 and Construction
177 Transportation
308 Others
513 Final Demand
1,370 Intermediate Demand
1,883 Total Output
Manufacturing 757 10,250 64 1,634 13,377 12,705 26,082 
and construction
Transportation 4 183 230 192 840 609 1,449 
Others 45 2,087 204 3,653 13,238 5,989 19,227 
TABLE 9.7
Direct Sectoral GHG Emissions in Decarbonized Taiwan 
Economy
GHG Emissions (Mt) Change (%)
Energy industries 179.1 −0.1
Manufacturing and construction 38.6 0.1
Transportation 36.6 −2.1
Others 10.8 10.0
TOTAL 265 0162 Optimization for Energy Systems and Supply Chains
9.5 CONCLUSION
Two LP model variants based on the I-O framework were described in this chapter 
and illustrated using Taiwan case studies. The first variant shows how a scarce com￾modity can be allocated within an economic network during a shortage to minimize 
total GDP loss and was applied to the case of a hypothetical energy crisis. The second 
variant shows how economic restructuring can be used to optimize an environmental 
objective and was applied to the case of differentiated sector growth to minimize 
GHG emissions. Both models illustrate how indirect effects in an economic network 
are accounted for in an I-O-based optimization model. While only low-resolution 
four-sector models were used in both case studies, in principle the LP formulations 
can handle higher resolution data if they are available.
These LP models can be the basis for more complex extensions of the basic I-O 
optimization framework. The aforementioned NLP or MILP variants can be used to 
relax the strict assumption of a fixed state of technology. A multi-period extension of 
Model II will also be needed to allow progressively more ambitious environmental 
goals to be integrated into long-term economic planning.
FURTHER READING
The original article by Leontief (1936) is a must-read for any scholar interested in 
learning about I-O models. In addition to its historical value, the article gives firsthand 
insights into how I-O concepts were first conceived. An interesting engineering-oriented 
tutorial on environmentally extended I-O models can be found in an early article by 
Chen (1973); this paper links I-O models to block diagrams used in control engineering 
problems. The book of Miller and Blair (2009) gives a comprehensive treatment of I-O 
models for intermediate-level readers, including different optimization extensions. Their 
book is the single most complete document on the topic. Tan et al. (2019) give a more 
detailed discussion of I-O-based mathematical programming models with emphasis on 
sustainability. The book also provides a tutorial on the use of LINGO to implement such 
models. In addition to economics, I-O models can also be used in process engineer￾ing applications. There are some notable examples of such applications for the analysis 
(Ziębik, 2017) or optimization (Kasivisvanathan et al., 2013) of industrial plants.
REFERENCES
Aguilar-Hernandez G.A., Sigüenza-Sanchez C.P., Donati F., Rodrigues J.F.D., Tukker A., 
2018, Assessing circularity interventions: A review of EEIOA-based studies. Journal of 
Economic Structures, 7, Article 14.
Aviso, K.B., Cayamanda, C.D., Solis, F.D.B., Danga, A.M.R., Promentilla, M.A.B., Yu, 
K.D.S., Santos, J.R., Tan, R.R., 2015, P-graph approach for GDP-optimal allocation of 
resources, commodities and capital in economic systems under climate change-induced 
crisis conditions. Journal of Cleaner Production, 92, 308–317.
Aviso, K.B., Chien, C.-F., Tan, R.R., Tseng, M.-L., 2021, Taiwan drought was a microcosm of 
climate change adaptation challenges in complex island economies. Process Integration 
and Optimization for Sustainability, 5, 317–318.
Bastian-Pinto, C.L., Brandão, L.E.T., Ozório, L.M., 2015, Valuing flexibility in electro-inten￾sive industries: The case of an aluminum smelter. Producao, 26, 28–38.Linear Programming Models Based on the Input-Output Framework 163
Brandt, A.R., 2017, How does energy resource depletion affect prosperity? Mathematics of a 
minimum energy return on investment (EROI). BioPhysical Economics and Resource 
Quality, 2, Article 2.
Cayamanda, C.D., Aviso, K.B., Biona, J.B.M., Culaba, A.B., Promentilla, M.A.B., Tan, 
R.R., Ubando, A.T., 2017, Mapping a low-carbon future for the Philippines: Scenario 
results from a fractional programming input-output model. Process Integration and 
Optimization for Sustainability, 1, 293–299.
Chen, K., 1973, Input-output economic analysis of environmental impact. IEEE Transactions 
on Systems, Man, and Cybernetics, 6, 539–547.
Duchin F., 1992, Industrial input-output analysis: Implications for industrial ecology. Proceedings 
of the National Academy of Sciences of the United States of America, 89, 851–855.
Duchin, F., Levine, S., 2011, Sectors may use multiple technologies simultaneously: The rect￾angular choice-of-technology model with binding factor constraints. Economic Systems 
Research, 23, 281–302.
Environmental Protection Administration, 2021, Taiwan Greenhouse Gases Inventory. EPA: 
Taipei, Taiwan.
Foong, S.Z.Y., Andiappan, V., Aviso, K.B., Chemmangattuvalappil, N.G., Tan, R.R., Yu, 
K.D.S., Ng, D.K.S., 2022, A criticality index for prioritizing economic sectors for post￾crisis recovery in oleo-chemical industry. Journal of the Taiwan Institute of Chemical 
Engineers. Doi: 10.1016/j.jtice.2021.06.051.
Gallagher, M.A., Snodgrass, A.W., Ehlers, J.G., 2005, Input-output modeling for assessing 
cascading effects. Military Operations Research, 10, 5–17.
Heijungs, R., De Koning, A., Guinee, J.B., 2014, Maximizing affluence within the planetary 
boundaries. International Journal of Life Cycle Assessment, 19, 1331–1335.
Heijungs, R., Suh, S., 2002, The Computational Structure of Life Cycle Assessment, Springer: 
Dordrecht.
Hsu, G.J.Y., Xu, H.-M., 2000, Impact of mitigating CO2 emissions on Taiwan’s economy: 
A fuzzy multiobjective programming approach. Environmental Economics and Policy 
Studies, 3, 335–345.
Jiang, P., Haimes, Y.Y., 2004, Risk management for Leontief-based interdependent systems. 
Risk Analysis, 24, 1215–1229.
Kananen, I., Korhonen, P., Wallenius, J., Wallenius, H., 1990, Multiple objective analysis of 
input-output models for emergency management. Operations Research, 38, 193–201.
Kasivisvanathan, H., Barilea, I.D.U., Ng, D.K.S., Tan, R.R., 2013, Optimal operational adjust￾ment in multi-functional energy systems in response to process inoperability. Applied 
Energy, 102, 492–500.
Khanna, V., Bakshi, B.R., 2009, Modeling the risks to complex industrial networks due to 
loss of natural capital. IEEE International Symposium on Sustainable Systems and 
Technology, ISSST '09 in Cooperation with 2009 IEEE International Symposium on 
Technology and Society, ISTAS, art. no. 515677.
Leontief, W.W., 1936, Quantitative input and output relations in the economic systems of the 
United States. Review of Economics and Statistics, 18, 105–125.
Miller, R.E., Blair, P.D., 2009, Input-Output Analysis: Foundations and Extensions, 2nd ed. 
University Press, Cambridge.
Santos, J.R., Haimes, Y.Y., 2004, Modeling the demand reduction input-output (I-O) inoper￾ability due to terrorism of interconnected infrastructures. Risk Analysis, 24, 1437–1451.
Statistical Bureau, 2021, National statistics, republic of China: 2016- IOTs 63 sectors https://
eng.stat.gov.tw/ct.asp?xItem=44869&ctNode=1650, last accessed 05 December, 2021.
Tan, R.R., Aviso, K.B., Foo, D.C.Y., 2018, Carbon emissions pinch analysis of economic sys￾tems. Journal of Cleaner Production, 182, 863–871.
Tan, R.R., Aviso, K.B., Promentilla, M.A.B., Solis, F.D.B., Yu, K.D.S., Santos, J.R., 2015, 
A shock absorption index for inoperability input-output models. Economic Systems 
Research, 27, 43–59.164 Optimization for Energy Systems and Supply Chains
Tan, R.R., Aviso, K.B., Promentilla, M.A.B., Yu, K.D.S., Santos, J.R., 2019, Input-Output 
Models for Sustainable Industrial Systems: Implementation Using LINGO. Springer 
Nature, Singapore.
Tan, R.R., Yu, K.D.S., Aviso, K.B., Promentilla, M.A.B., 2017, Input–output modeling approach 
to sustainable systems engineering, Chapter In: M. Abraham (Ed.), Encyclopedia of 
Sustainable Technology, Elsevier, Amsterdam, 519–523.
Tsai, W.-T., 2021, Trend analysis of Taiwan’s greenhouse gas emissions from the energy sector 
and its mitigation strategies and promotion actions. Atmosphere, 12, Article 859.
Wachs L., Singh S., 2018, A modular bottom-up approach for constructing physical input￾output tables (PIOTs) based on process engineering models. Journal of Economic 
Structures, 7, Article 26.
Yang, L., Wang, Y., Wang, R., Klemeš, J.J., Almeida, C.M.V.B., Jin, M., Zheng, X., Qiao, Y., 
2020, Environmental-social-economic footprints of consumption and trade in the Asia￾Pacific region. Nature Communications, 11, Article 4490.
Ziębik, A., 2017, “Input-output” approach to energy production systems, In: W. Stanek, ed., 
Thermodynamics for Sustainable Management of Natural Resources, Springer, Cham, 
81–108.
APPENDIX 9A: LINGO CODE FOR CASE STUDY 1
!
indices
i, j sectors
k environmental category
Parameters
baselinex (j) - baseline productivity of sector j
baseliney (i) - baseline final demend of sector i
xLL(j) - lower limit for x
xUL(j) - upper limit of x
yLL(i) - lower limit for y
yUL(i) - upper limit of y
a(i,j) - technical coefficient matrix equivalent to (I-A) 
of Taiwan IO 
shortage - fractional reduction in total output of energy 
sector
variables
x(j) - new production level of sector j
y(i) - new final demand of sector i 
r(i,j) - optimal input from sector i to sector j
;
Sets:
Sectors: x, y, baselinex, baseliney, xLL, xUL, yLL, yUL;
Amatrix (sectors, sectors): a, r;
EndsetsLinear Programming Models Based on the Input-Output Framework 165
Data:
Sectors = EnergyInd, MfgCons, Transport, Others;
a = 0.876 -0.025 -0.122 -0.016
 -0.402 0.607 -0.044 -0.085
 -0.002 -0.007 0.841 -0.010
 -0.024 -0.080 -0.141 0.810;
baselinex = 1885 26051 1481 17479;
!the shortage varies from 0.1 to 0.4;
shortage = 0.10;
Enddata
Calc:
@for(sectors(i): baseliney(i) = @sum(sectors(j): 
a(i,j)*baselinex(j)));
!limits for x where sectors can contract by up to 20%;
@for(sectors(i)|i#ne#1: xLL(i) = 0.8*baselinex(i);
 xUL(i) = baselinex(i));
!setting the lower and upper limits of Y which can vary 
+/- 5%;
@for(sectors(j)|j#NE#1: yLL(j) = 0.95* baseliney(j);
 yUL(j) = 1.05*baseliney(j));
Endcalc
!Eq. 5a;
max = @sum(sectors(i): y(i)); 
!Eq. 5b;
@for(sectors(i): y(i) = @sum(sectors(j): a(i,j)*x(j))); 
!Eq. 5c;
@for(sectors(i): x(i) > xLL(i);
 x(i) < xUL(i));
!Limit for Sector 1;
xUL(1) < (1-shortage)*baselinex(1);
!Eq. 5d;
@for(sectors(j)|j#NE#1: y(j) > yLL(j); y(j)< yUL(j));
!To determine balanced optimal matrix;
@for(sectors(i): @for(sectors(j): r(i,j) = a(i,j)*x(j)));
@for(Amatrix(i,j): @free(r(i,j)));166 Optimization for Energy Systems and Supply Chains
APPENDIX 9B: LINGO CODE FOR CASE STUDY 2
!
indices
i, j sectors
k environmental category
Parameters
baselineG(k) - baseline total environmental impact k of 
economy
baselinex (j) - baseline productivity of sector j
baseliney (i) - baseline final demand of sector i
xLL(j) - lower limit for x
xUL(j) - upper limit of x
yLL(i) - lower limit for y
yUL(i) - upper limit of y
a(i,j) - technical coefficient matrix equivalent to (I-A) 
of Taiwan IO 
b(k,j) - intensity of environmental impact k in sector j 
variables
z(k) - total environmental impact k
x(j) - new production level of sector j
y(i) - new final demand of sector i 
r(i,j) - optimal input of sector i into sector j
;
Sets:
Sectors: x, y, baselinex, baseliney, xLL, xUL, yLL, yUL;
Amatrix (sectors, sectors): a, r;
Impact: zU, z;
Bmatrix (Impact, sectors): b;
Endsets
Data:
Sectors = EnergyInd, MfgCons, Transport, Others;
a = 0.876 -0.025 -0.122 -0.016
 -0.402 0.607 -0.044 -0.085
 -0.002 -0.007 0.841 -0.010
 -0.024 -0.080 -0.141 0.810;
baselinex = 1885 26051 1481 17479;
Impact = GHG;Linear Programming Models Based on the Input-Output Framework 167
b = 0.095119363 0.00147787 0.025253207 0.000560673 ;
Enddata
!Eq 6a;
max = @sum(sectors(i): y(i));
!Eq. 6b;
@for(sectors(i): y(i) = @sum(sectors(j): a(i,j)*x(j)));
@for(sectors(i): baseliney(i) = @sum(sectors(j): 
a(i,j)*baselinex(j)));
!Eq 6c;
@for(Impact(k): zU(k) = @sum(sectors(j): b(k,j)*baselinex(j));
 z(k) =@sum(sectors(j): b(k,j)*x(j)));
!Eq 6d;
!limits for x where sectors can contract by up to +/-10%;
@for(sectors(i): xLL(i) = 0.90*baselinex(i);
 xUL(i) = 1.1*baselinex(i));
@for(sectors(i): x(i) > xLL(i);
 x(i) < xUL(i));
!Eq 6e;
!final demand can grow up to vary from -5% to 15%;
@for(sectors(j): yLL(j) = 0.95* baseliney(j);
 yUL(j) = 1.15*baseliney(j));
@for(sectors(j): y(j) > yLL(j); y(j)< yUL(j));
!Eq. 6g;
z(1) < zU(1);
@for(sectors(i): @for(sectors(j): r(i,j) = a(i,j)*x(j)));
@for(Amatrix(i,j): @free(r(i,j)));169
10 Optimisation of Oil 
Palm-Based Biodiesel 
Supply Chain
Upstream Stages
Jaya Prasanth Rajakal
Taylor’s University
Yoke Kin Wan
University of Nottingham Malaysia
10.1 INTRODUCTION
The increasing demand for energy and a concurrent urgency towards carbon emis￾sion reduction has led to transition towards low carbon energy sources for power 
generation and transportation (Bouckaert et al., 2021). Solar, wind and bioelectricity 
(electricity from biomass) are a few of the promising alternatives for power genera￾tion, while biofuels and electric vehicles are potential substitutes for conventional 
fossil-based transportation. Though extensive fundamental research has led to break￾throughs in these technologies, challenges do remain in scaling up for reliable and 
economically viable production. A supply chain approach is necessary in such cases 
to synthesise an optimal supply chain design and operation. This chapter presents a 
simple application of mathematical modelling for bioenergy supply chains.
CONTENTS
10.1 Introduction .................................................................................................. 169
10.2 Methodology ................................................................................................. 171
10.2.1 Problem Statement ............................................................................ 171
10.2.2 Material Flow ................................................................................... 172
10.2.3 Plantation Expansion Cost ................................................................ 174
10.2.4 LUC Emission ................................................................................... 174
10.3 Case Study Scenario ..................................................................................... 175
10.4 Results and Discussion ................................................................................. 177
10.5 Conclusion .................................................................................................... 178
Future Reading ....................................................................................................... 178
References .............................................................................................................. 179
Appendix ............................................................................................................... 179
DOI: 10.1201/9781003240228-12170 Optimization for Energy Systems and Supply Chains
Bioenergy is a renewable form of energy derived from biomass resources. The 
term bioenergy broadly includes but not limited to bioelectricity and biofuels. 
Bioelectricity is the electricity generated from biomass resources as energy source. 
Similarly, biofuel refers to liquid fuels that are produced from biomass (e.g., bioetha￾nol from corn, biodiesel from jatropha). In energy context, biomass refers to organic 
materials derived from plants that can be used as energy source (McKendry, 2002). 
Examples of biomass materials include wood, coconut shells, sugarcane bagasse, and 
palm fibre. Biomass resources are naturally occurring and abundantly available that 
are suitable for clean energy production.
A typical bioenergy supply chain includes plantation, postharvest centre, produc￾tion centre, distribution centre, retailers and consumers, as shown in Figure 10.1. The 
energy crops are developed as plantations which yield the biomass. The harvested 
biomass is transported to the post-harvest centre to produce intermediate products. 
The intermediate products are then processed at the production facility to produce the 
final products. The final products are shipped or transported to the distribution centre 
where they are stocked as inventory. Later, the final products are transported to the 
retailers who form touch points to the consumers. The bioenergy supply chain can 
be classified into upstream and downstream stages. Typically, the upstream stages 
include the plantation which yields the biomass and the transportation of biomass to 
the post-harvest centre. The downstream stages include the production centre, distri￾bution centre, retailers and consumers.
In recent times, there has been a steady rise of biomass in the global energy mix, 
as countries aggressively push for bioenergy projects as part of their strategies to 
achieve carbon neutrality by 2050 (Global Energy Statistics, 2020). Some of these 
projects include biomass-based power plants and large-scale commercial biofuel 
plants. Capacity expansion along the bioenergy supply chain is often necessary due 
to increasing demand and requires careful consideration. In such cases, it is impor￾tant to ensure reliable sources of biomass supply to the bioenergy plants for their 
uninterrupted operation. Therefore, energy crops are developed as plantations to 
operate these bioenergy plants.
Crops that produce biomass material with high energy content are identified as 
energy crops such as sugarcane, corn, oil palm, and jatropha (Halford and Karp, 
2010). Plantation expansion carries significance as crop production is not agile 
enough to scale up or scale down in a short notice due to its biological nature. Hence, 
plantation expansion requires careful planning to ensure the demand is met with the 
supply. Moreover, plantation expansions involving new plantation development may 
require land-use change (LUC), which involves cost and carbon emission. Therefore, 
optimisation is important for plantation expansion. The optimised land selection 
allows for plantation expansions that can produce required biomass at minimum cost 
and minimum LUC emission depending on the objective prioritised.
FIGURE 10.1 Typical bioenergy supply chain.Optimisation of Oil Palm-Based Biodiesel Supply Chain 171
The rest of this chapter is organised as follows: Section 10.2 presents the method￾ology to develop a mathematical model for optimal selection of lands for new planta￾tion development in a bioenergy supply chain. Section 10.3 presents a classic palm 
oil case study to demonstrate the developed model with a discussion on the generated 
results in Section 10.4. Conclusion and suggested future readings are presented in 
Sections 10.5 and 10.6.
10.2 METHODOLOGY
This section presents the methodology to develop a mathematical model for the opti￾mal selection of lands for new plantation development in a bioenergy supply chain. 
The first step is to define the problem statement describing the indices, parameters, 
variables, constraints, and objective for the scope of work. Later, a superstructure is 
constructed which is a visual representation of the interconnections between each of 
the individual units in the system. It allows for the systematic evaluation of all feasi￾ble alternatives in finding the optimised solution. The following subsection describes 
the problem statement.
10.2.1 Problem statement
Given,
• A set of plantations under cultivation and potential lands for new planta￾tion development, g ∈G with given area, Ag and plantation density, δ g. The 
potential lands g ∈G are considered such that they have no competition 
from other land uses.
• A set of bioresource m ∈M that are produced at the plantations.
• A set of post-harvest centres f ∈F where the bioresource m are transported 
for processing. The annual capacity of the post-harvest centre f to process 
the bioresource m is given as ZPH_BR
f m, ,t .
• ZPH_BR
f m, ,t is assumed to be sufficient to process all of the bioresource m received 
at the postharvest centre f.
• A set of intermediate products i I ∈ that are produced at post-harvest centre 
f while processing the bioresource m.
• A set of production facilities j J ∈ where intermediate products i are trans￾ported and processed to final product.
• A set of final products p P ∈ that are produced from production facilities j.
In order to meet a specified future demand for product p P ∈ , plantations g G∈ may 
need to be expanded. Therefore, the model determines:
• Optimised allocation of lands for new plantation development.
Subject to:
• The projected increase in demand for the product, DFP
p t, .172 Optimization for Energy Systems and Supply Chains
Figure 10.2 shows the superstructure of a typical bioenergy supply chain. Based on 
the superstructure, mathematical equations are formulated. The equations can be 
categorised as follows:
• Material flow
• Plantation expansion cost
• LUC emission
10.2.2 material Flow
The plantation g G∈ with area Ag (ha) and planting density δ g (palms/ha) yields bio￾mass m ∈M. The amount of biomass m harvested at plantation g for the time period 
t, and FPL_BR g m, ,t (t/y) can be determined as shown in Eq. (10.1): 
F A PL_BR g m, ,t g = ∀ δ g g V B, , m g t g m∀ ∀t (10.1)
where, Vg m, (t of m/palm/y) is the yield of biomass m from each palm tree in a year, 
and Bg t, is the binary variable used for the optimal land selection. The harvested bio￾mass m at the plantation g is then transported to the different postharvest facilities 
f ∈F as shown in Eq. (10.2): 
∑
F
F F PL_BR g m, ,t = ∀ PL_PH
g m, , f t, g m∀ ∀t (10.2)
f =1
where FPL_PH
g m, , f t, (t/y) is the amount of biomass m transported from plantation g to post￾harvest facility f during the time period t. The total amount of biomass m received at 
post-harvest facility f from all the plantations g G∈ for the time period t, and FPH_BR
f m, ,t
(t/y) can be determined as shown in Eq. (10.3): 
G
F F PH_BR
f m t g = ∀ ∑ PL_PH
, , , , m f ,t f m∀ ∀t (10.3)
g=1
FIGURE 10.2 Superstructure of a bioenergy supply chain.Optimisation of Oil Palm-Based Biodiesel Supply Chain 173
The amount of biomass m sent to post-harvest facility f cannot be more than the 
maximum processing capacity as shown in Eq. (10.4): 
F Z PH_BR
f m, ,t f ≤ ∀ PH_BR
, , m t f m∀ ∀t (10.4)
where ZPH_BR
f m, ,t (t/y) is the maximum processing capacity of the biomass m at post￾harvest facility f for the time period t. The biomass m at the postharvest facility f is 
processed to intermediate products i I ∈ as shown in Eq. (10.5): 
F F PH_IP PH_BR
f i, ,t f = ∀ , , m t Vm i, fmit ∀ ∀ ∀ (10.5)
where FPH_IP
f i, ,t (t/y) is the amount of intermediate product i produced at post-harvest 
facility f for the time period t, and Vm f, ,i is the conversion factor of biomass m to inter￾mediate product i at post-harvest facility f. The intermediate products i I ∈ are then 
transported to the production facility j J ∈ as shown in Eq. (10.6), 
J
F F PH_IP
f i, ,t f ≤∑ PH_PR
, ,i j,t ∀∀∀ ift (10.6)
j=1
where FPH_PR
f i, , j t, (t/y) is the amount of intermediate product i transported from post￾harvest facility f to the production facility j during the time period t. The total amount 
of intermediate product i received at production facility j for the time period t, and 
FPR_IP
jit , , (t/y) can be determined as shown in Eq. (10.7): 
F
F F PR_IP
jit , , =∑ PH_PR
f i, , j t, ∀∀∀ ijt (10.7)
f =1
This total amount of intermediate product i received at production facility j should be 
less than the maximum processing capacity as shown in Eq. (10.8): 
F Z PR_IP
jit ≤ PR_IP
, , jit , , ∀∀∀ ijt (10.8)
where ZPR_IP
jit , , (t/y) is the maximum processing capacity of intermediate product i at 
production facility j for the time period t. At the production facility, the intermedi￾ate products are processed into final products p P ∈ . The amount of final product 
p produced at the production facility j during time period t, and FPR_FP
j p, ,t (t/y) can be 
determined as shown in Eq. (10.9): 
F F PR_FP
j p, ,t = ∀ PR_IP
jit , , V p i j, ,p ∀∀∀ ijt (10.9)
where Vi j, ,p is the conversion factor for intermediate product i to final product p at 
production facility j. The total amount of final product p produced at production facil￾ity j for the time period t, and FFP
jit , , (t/y) can be determined as shown in Eq. (10.10):
∑
J
F F FP
p t, = ∀ PR_FP
j p, ,t p t ∀ (10.10)
j=1174 Optimization for Energy Systems and Supply Chains
The production of the final product is always expected to be greater than or equal to 
the demand, DFP
p t, (t/y) as shown in Equation (10.11): 
F D FP
p t, ≥ ∀ FP
p t, p t ∀ (10.11)
Based on the demand for the final product, the plantations may require expansions 
for increased production of biomass. The mathematical formulation for optimal land 
expansion is described in the next section.
10.2.3 Plantation exPansion Cost
In order to determine the cost involved in new plantation development, expan￾sion costs (i.e., land clearing cost and land preparation cost) are considered. Land 
clearing cost involves the cost involved in clearing the existing forest cover which 
includes boundary demarcation, tree marking, felling and bucking, skidding, log 
loading, and short-distance haulage (Abdul Samad et al., 2009). The land prepara￾tion cost involves the cost involved in developing the plantation, which includes 
road construction, drainage construction, lining, planting material, holing, and 
planting (Latif et al., 2003). Both the land clearing and land preparation cost 
depend on the area and current land use of the potential land that is identified for 
plantation development. The cost of expansion, CostExpansion t (USD) can be deter￾mined using Equation (12): 
G
CostExpansion L = + ∑( ) Cost C L Cost P t g g g A Bg t, (10.12)
g=1
where CostLC
g l, (USD/ha) and CostLP
g l, (USD/ha) are the land clearing and land prepara￾tion cost for conversion of per unit area of current land use into oil palm plantation. 
Bg t, is a binary variable employed for plantation selection.
10.2.4 luC emission
Emission from land-use change due to the conversion of the native ecosystem to 
plantation g during period t, Carbont
PL (tCO2-eq/y) can be determined as shown in 
Equation (10.13).
B C t t g g t g
g
G
= ∀ ∑=
Carbon A PL , LUC
1
(10.13)
where CLUC g (tCO2-eq/ha/y) is the annual CO2 emitted per unit area due to land use 
change at plantation g.
The optimised land section for plantation expansion depends on the objective 
function. The following case study considers two objectives – minimise cost and 
minimise LUC emission.Optimisation of Oil Palm-Based Biodiesel Supply Chain 175
10.3 CASE STUDY SCENARIO
An oil palm case study is presented in this section to illustrate the developed model. 
As shown in Figure 10.3, plantation is the fundamental unit in the oil palm’s bioenergy 
supply chain. Fresh fruit bunch is the primary bioresource harvested at the plantations 
and then transported to the palm oil mills. At the mills, the FFBs are processed into 
various intermediate products of which crude palm oil (CPO) and palm biomass (shell 
and fibre) have the potential to be an energy source. In addition, the palm oil mill efflu￾ent (POME) discharged from the mills also has potential to produce gaseous fuels. 
These intermediate products can be used for the following bioenergy production:
• CPO can be further processed at the refineries to produce biodiesel. 
Biodiesel is generally blended with diesel and used as transport fuels.
• The palm biomass, fibre and shell can be used as boiler feed at mills. The 
steam generated is used for process steam requirements and power genera￾tion. The generated power is used for captive consumption at the mill, and 
the excess is exported to the utility grid.
• The POME is treated via biochemical conversion processes to gaseous fuels 
like bio-compressed natural gas (bio-CNG) and biohydrogen.
In this case study, the optimal land selection is determined based on the demand for 
biodiesel. The superstructure of the bioenergy supply chain considered for biodiesel 
production from oil palm is shown in Figure 10.4, and the diagrammatic representa￾tion is shown in Figure 10.5. The optimised land selection is determined under two 
scenarios – minimise plantation expansion cost and minimise LUC emission. 
In this case study scenario, the need for plantation expansion is analysed for a 
set biodiesel demand of 4,500 t/y. The exiting plantations can produce an FFB of 
22,500 t/y, which can produce 4,050 t/y of biodiesel. Hence, there exists a shortage 
of 450 t/y. To meet this shortage, the production of FFBs has to be increased by 2,500 
t/y. Thus, plantation expansion is required in this case. The details of potential land 
identified for plantation expansion and their corresponding expansion cost and LUC 
emission are shown in Table 10.1. It can be observed that the expansion cost and LUC 
emission are dependent on the type of land use change (LUC) to oil palm plantation.
FIGURE 10.3 Oil palm’s bioenergy supply chain.176 Optimization for Energy Systems and Supply Chains
FIGURE 10.5 Diagrammatic superstructure of bioenergy supply chain for biodiesel pro￾duction from oil palm.
FIGURE 10.4 Superstructure of bioenergy supply chain for biodiesel production from 
oil palm.
TABLE 10.1
Area, Planting Density, Expansion Cost and LUC Emission of Potential Land 
Identified for New Plantation Development
Plantation Current Land Type
Area 
(ha)
Planting 
Density 
(Palms/ha)
Expansion 
Cost 
(USD/ha)
LUC Emission 
(tCO2/ha)
P1 Existing plantation 1,000 150 0 0
P2 Degraded tropical forest 100 150 3,750 8.6
P3 Peat forest 100 200 4,250 29
P4 Shrubland 100 150 1,830 2.5
P5 Swampland 100 200 2,330 24.3Optimisation of Oil Palm-Based Biodiesel Supply Chain 177
In order to solve this case study scenario, computer codes for the mathematical 
model are written and solved in LINGO v18.0 solver in an HP Pavilion x360 with 
Intel® Core™ i5 8250 (1.80 GHz) processor and 8GB RAM under a 64-bit operat￾ing system. The developed model is of the class mixed integer linear programming 
(MILP). Computation of the optimal solution for the case study is obtained by solv￾ing the mathematical optimisation model using a branch and bound algorithm. The 
time taken to generate the global optimal solution for both the scenarios is 1 second. 
The coding for the mathematical model can be found in Section 10.7.
10.4 RESULTS AND DISCUSSION
In Scenario 1, the optimisation objective has been set to minimise plantation expan￾sion cost. As a result, P5 is selected for plantation expansion due to the least expan￾sion cost, as shown in Figure 10.6. The expansion cost is USD 233,000 while the 
LUC emission are 2,430 tCO2. The land footprint brought under plantation expansion 
is 100 ha. In the case of Scenario 2, P2 and P4 are selected for expansion, as shown 
in Figure 10.7. The expansion cost is USD 558,000, LUC emission is 1,110 tCO2, and 
the land footprint brought under plantation expansion is 200 ha. 
FIGURE 10.6 Scenario 1 – optimised plantation expansion.
FIGURE 10.7 Scenario 2 – optimised plantation expansion.178 Optimization for Energy Systems and Supply Chains
In Scenario 2, the optimisation objective is to minimise LUC emission. As a 
result, peatlands and swamplands are avoided to minimise the LUC emission, result￾ing in a 54.32% reduction in LUC emission when compared to Scenario 1. However, 
the cost of expansion is increased by 139% and the land footprint increased by 100%. 
Moreover, despite the less land footprint under plantation expansion in Scenario 1, 
it could produce sufficient FFB. This is because P5 being a swampland has a higher 
planting density of 200 palms/ha. P3, a peatland with a 100 ha area, is overlooked in 
Scenario 1 due to higher expansion cost compared to swampland.
In addition to cost and LUC emission, indicators like water footprint, fertiliser 
footprint and labour requirement can also be included in the optimisation framework 
for a more holistic perspective in sustainable decision-making on land selection. For 
such instances, a multi-objective modelling will allow for considering multiple con￾flicting objectives while determining the optimised expansion.
10.5 CONCLUSION
Mathematical modelling is a useful method for addressing supply chain problems. It 
allows to determine the best possible pathway under given constraints from a set of 
available alternatives in a supply chain. Moreover, mathematical models are capable 
of representing the supply chain interactions, solve large and complex problems, 
and effectively aid in decision-making. This chapter has presented a MILP model 
for optimal plantation expansion in a bioenergy supply chain. The optimal selection 
is determined under two scenarios – minimising the plantation expansion cost and 
minimising the LUC emission. The scenarios illustrate how the objective function 
impacts the land selection. The developed model can be a basis for more complex 
considerations in optimising expansions in bioenergy supply chain. Apart from bio￾diesel, supply chain optimisation for other energy products like bioelectricity and 
bio-CNG from oil palm’s biomass materials can be synthesised. Some of the sug￾gested readings on the allied problems in bioenergy supply chain and the modelling 
approaches developed to address them are provided in the next section.
FUTURE READING
In addition to land selection, other factors can be included for detailed modelling, 
analysis and decision making. An extension of the simple case study presented in 
this chapter can be found in the work of Rajakal et al. (2019), which considers opti￾mal truck capacity selection for biomass transportation from plantation to the palm 
oil mill. A more comprehensive multi-objective approach for sustainable expansions 
along the entire palm supply chain can be reviewed in the work of Rajakal et al. 
(2021a). Similarly, a multi-period approach for minimising plantation expansion by 
determining optimal storage capacity can be reviewed in the work of Rajakal et al. 
(2021b). Apart from this, the optimal time period for new plantation development can 
be found in the work of Rajakal et al. (2021c) and is worth further reading. In addi￾tion, supply chain optimisation for various biomass resources and biomass-derived 
energy products is available extensively in the literature and can be found in Scopus 
and Web of Science databases.Optimisation of Oil Palm-Based Biodiesel Supply Chain 179
REFERENCES
Abdul Samad, A.R., Othman, M.S. and Mohd Ashhari, Z., 2009. A comparison analysis of 
logging cost between conventional and reduce impact logging practices. Int. J. Econ. 
Manage. 3 (2), pp. 354–366.
Bouckaert, S., Pales, A.F., McGlade, C., Remme, U., Wanner, B., Varro, L., D’Ambrosio, D. 
and Spencer, T., 2021. Net zero by 2050: A roadmap for the global energy sector. Paris: 
International Energy Agency. https://iea.blob.core.windows.net/assets/063ae08a-7114-
4b58-a34e-39db2112d0a2/NetZeroby2050-ARoadmapfortheGlobalEnergySector.pdf
Global Energy Statistics, 2020. Stockholm: World Bioenergy Association. http://www.world￾bioenergy.org/uploads/201210%20WBA%20GBS%202020.pdf
Halford, N.G. and Karp, A. eds., 2010. Energy Crops. London: Royal Society of Chemistry. 
1st edition (January 21, 2011)
Latif, J., Noor, M.M., Dolmat, M.T., Din, A.K., 2003. Economics of higher planting density in 
oil palm plantations. Oil Palm Ind. Econ. J. 3(2), pp. 32–39.
McKendry, P., 2002. Energy production from biomass (part 1): Overview of biomass. 
Bioresource Technol. 83(1), pp. 37–46.
Rajakal, J.P., Ng, D.K., Tan, R.R., Andiappan, V. and Wan, Y.K., 2019. A mathematical 
optimisation model for analysis of minimal cropland expansion in agro value chains. 
Sustain. Prod. Consump. 20, pp. 178–191.
Rajakal, J.P., Ng, D.K., Tan, R.R., Andiappan, V. and Wan, Y.K., 2021a. Multi-objective 
expansion analysis for sustainable agro-industrial value chains based on profit, carbon 
and water footprint. J. Clean. Prod. 288, p. 125117.
Rajakal, J.P., Tan, R.R., Andiappan, V. and Wan, Y.K., 2021b. A hybrid optimisation model 
for land allocation and storage sizing in agro-food system. Process Integ. Optimiz. 
Sustain. pp. 1–15.
Rajakal, J.P., Tan, R.R., Andiappan, V., Wan, Y.K. and Pang, M.M., 2021c. Does age matter? 
A strategic planning model to optimise perennial crops based on cost and discounted 
carbon value. J. Cleaner Prod. 318, p. 128526.
APPENDIX 
!Plantation 1 - Existing plantations;
A1 = 1000; Z1 = 150; V1 = 0.15;
C1 = 0; LUC1 = 0;
!Plantation 2 - Tropical forest;
A2 = 100; Z2 = 150; V2 = 0.15;
C2 = 3750; LUC2 = 8.6;
!Plantation 3 - Peatforest;
A3 = 100; Z3 = 200; V3 = 0.15;
C3 = 4250; LUC3 = 29;
!Plantation 4 - Shrubland;
A4 = 100; Z4 = 150; V4 = 0.15;
C4 = 1830; LUC4 = 2.5;
!Plantation 5 - Swampland;
A5 = 100; Z5 = 150; V5 = 0.15;
C5 = 2330; LUC5 = 24.3;
V_POM = 0.20; V_PR = 0.90;180 Optimization for Energy Systems and Supply Chains
!Material Balance;
!Equation 1;
PL1 = A1 * Z1 * V1 * B1;
PL2 = A2 * Z2 * V2 * B2;
PL3 = A3 * Z3 * V3 * B3;
PL4 = A4 * Z4 * V4 * B4;
PL5 = A5 * Z5 * V5 * B5;
@BIN (B1); @BIN (B2); @BIN (B3); @BIN (B4); @BIN (B5); 
!Equation 2;
!Since only one mill is considered, Eq2 can be ignored;
!Equation 3;
PH_BM = PL1 + PL2 + PL3 + PL4 + PL5;
!Equation 4; 
Z_PH_BM = 100000;
PH_BM <= Z_PH_BM;
!Equation 5;
PH_IP = PH_BM * V_POM;
!Equation 6;
!Since only one mill is considered, Eq6 can be ignored;
!Equation 7;
PR_IP = PH_IP;
!Equation 8;
Z_PR_IP = 10000;
PR_IP <= Z_PR_IP;
!Equation 9;
PR_FP = PR_IP * V_PR;
!Demand;
D_FR = 4500;
PR_FP >= D_FR;
E_Cost = (A1 * C1 * B1) + (A2 * C2 * B2) + (A3 * C3 * B3) +
 (A4 * C4 * B4) + (A5 * C5 * B5);
CE = (A1 * LUC1 * B1) + (A2 * LUC2 * B2) + (A3 * LUC3 * B3) +
 (A4 * LUC4 * B4) + (A5 * LUC5 * B5);
!MIN = E_Cost;
MIN = CE;181
11 Optimal Design of 
Islanded Distributed 
Energy Systems 
Incorporating Renewable 
Energy for Rural Africa
A Namibian Case Study
Kemi Jegede
Namibian University of Science and Technology
University of Cape Town
Ishanki De Mel and Michael Short
University of Surrey
Adeniyi J. Isafiade
University of Cape Town
CONTENTS
11.1 Introduction .................................................................................................. 182
11.2 Problem Statement ........................................................................................ 184
11.3 Methodology ................................................................................................. 185
11.4 Case Study Scenario ..................................................................................... 192
11.4.1 Introduction ...................................................................................... 192
11.4.2 Findings of Study .............................................................................. 193
11.4.2.1 Demand Profile .................................................................. 193
11.5 Conclusion .................................................................................................... 197
References .............................................................................................................. 198
Appendix ................................................................................................................ 199
DOI: 10.1201/9781003240228-13182 Optimization for Energy Systems and Supply Chains
11.1 INTRODUCTION
Several regions in Africa are rich in natural resources and have favourable cli￾mates for renewable energy production. Namibia, a sub-Saharan African country, 
has numerous potential renewable energy sources for electrification. Chief among 
these resources is solar irradiation, which can yield as much as a yearly total of 
3,000 kWh/m2 in the southern part of the country. Other renewable energy sources 
in Namibia include wind and biomass. The country stands to benefit from using 
indigenous renewable energy resources that will help reduce its high dependency on 
imported energy. This is critical to maintaining the security of supply, price control, 
loss minimisation and quality of power variations.
Rural communities in sub-Saharan Africa are often characterized by low-energy 
consumption, geographical isolation (far from the main grid systems) and decentral￾ised population (Louie, 2018). This profile is not viable for connection to the main 
grid systems, which implies that stand-alone renewable energy technologies will be 
ideal for these communities. Islanded microgrid systems, separated from the national 
grid infrastructure, should reduce investment costs relating to the infrastructure sys￾tem (such as extending power lines over long distances) to connect to the main grid 
system. The benefits of electrification to rural communities directly address three of 
the United Nation’s 17 sustainable development goals, namely attaining affordable 
and clean energy, developing sustainable cities and communities, and governments 
taking climate-positive actions to build their economies and societies.
The energy demand of the decentralised population in this study is met by the 
Distributed/Decentralised Energy System (DES). The DES is an energy chain con￾sisting of production, conversion, transmission, distribution and consumption, all 
operating at a decentralised location out of the main centralised energy system. 
Decentralised systems are mostly solar home systems with storage batteries, which 
may also include a stand-by diesel generator suitable for low-energy consumption 
households. There is no consensus in the literature about the general terminology of 
centralised and decentralised energy generation, as these terms are used relatively. In 
this chapter, when we refer to centralised energy, this is energy generated at a site and 
sent to consumers through a grid system. Decentralised energy generation, on the 
other hand, is relatively smaller energy conversion units situated close to the consum￾ers. The DES ensures a reduction in energy transmission losses by being closer to 
the energy demand zones in comparison to centralised energy networks. They have 
also been associated with resiliency and reliability, as producing electricity where it 
is used reduces the probability of disruption. The above-mentioned features make the 
DES an efficient, reliable and environmentally friendly alternative to the traditional 
centralised energy system.
This research focuses on developing a methodology that can be used in design￾ing an optimal DES network for isolated (islanded) rural microgrids, which also 
require supply chain (SC) elements to be included due to the geographical isola￾tion of the system from traditional supply routes. The idea of covering all energy 
requirements with a single renewable energy vector is usually unrealistic; therefore, 
a hybrid energy system will be considered. A hybrid energy system considers vari￾ous energy sources and technologies for supply to demand regions. Renewable and Optimal Design of Islanded Distributed Energy Systems 183
non-renewable energy technologies, as well as energy storage systems, will be tech￾nologies available for selection to meet a community’s energy demand. Hybrid sys￾tems reduce the intermittency associated with single stand-alone renewable energy 
technologies. The application of SC networks to cater for the variability in the avail￾ability of these renewable energy sources will also be considered. To solve this com￾plex system of mapping the varying demand and supply of energy in a cost-optimal 
way across different temporal discretisations (hourly and seasonal) and accounting 
for SC considerations in rural communities isolated from the main grid, a multi￾period MILP optimisation is proposed.
The transhipment model is used to determine the optimal distribution of goods 
from several supply points (sources) through intermediate storage to several demand 
points (destinations) as discussed by Render & Stair and Taylor. For each of the given 
points, there are maximum capacities that cannot be exceeded. The SC strategy for 
incorporating bioenergy into energy networks has been previously addressed by 
Čuček et al. (2010) and Mutenure et al. (2018). Here, they discussed the optimisation 
of SC networks and addressed the challenges presented by the varied availability 
of biomass resources. For a continuous supply of energy, the SC network aspects to 
be considered must be informed by operational and system constraints dictated by 
the generation of energy from both renewable and non-renewable energy sources, 
the transmission of energy to consumers based on need and energy storage and the 
transportation of fuel (diesel, fuelwood, animal dung, human waste and crop residue) 
required to produce electricity to consumers. The SC concept can be used to connect 
and manage the above-mentioned energy supply and demand requirements at opti￾mum architecture, reliability, sustainability and economics.
There are several technological options available to satisfy the energy demands 
of the kind of community investigated in this work. The common renewable energy 
sources are solar photovoltaics, solar thermal, wind, biofuels, geothermal, tidal and 
hydro. Conventional non-renewable energy production is from fossil fuels in the form 
of coal, petrol, kerosene or diesel. The interest in the use of renewable energy sources 
stems from the fact that they are non-depletable and environmentally friendly. This 
study will focus on solar and biomass technologies available for energy generation, 
as well as diesel as an option for non-renewable energy technology, to allow reliable 
energy supply. Apart from the intermittent availability of renewable energy sources 
like solar and biomass, they may not produce sufficient power during peak demand. 
Energy storage is therefore a critical factor to consider in islanded rural energy net￾works. For periods where there is a higher production of energy than demand, excess 
energy should be stored for later use when demand exceeds direct energy supply 
from renewable energy sources. Factors that need to be considered when determin￾ing suitable storage technologies are specific energy, operating cost, power response 
time, efficiency and calendar life (Lund et al., 2016).
This study is aimed at using a deterministic mathematical optimisation method to 
model and optimise hybrid, islanded energy networks. Popular mathematical models 
used for the optimisation of hybrid energy systems include mixed-integer non-linear 
programming (MINLP) (Weber & Shah, 2011; Huang et al., 2022), MILP (Mehleri 
et al., 2012b, 2013; Gupta et al., 2011) and stochastic discrete dynamic programming 
(Rajanna & Saini, 2016; Suresh et al., 2020).184 Optimization for Energy Systems and Supply Chains
Several studies, such as Weber and Shah (2011) and van der Heijde et al. (2019), 
analyse isolated grids considering hypothetical scenarios and communities. On 
the other hand, some studies focus on the technical aspects of isolated rural grids 
and how they can be monitored. These studies ignored the optimal resource allo￾cation/sharing approach that meets the demand for energy considering the inter￾mittency in resource availability and variability in energy demand. Studies, such 
as Azimoh et al. (2015), focus on the socio-economic aspects of decentralised 
hybrid grid systems in existing communities without optimisation of the net￾works. Compared to the previously mentioned studies, the novelty of this work 
lies in simultaneously optimising the design of the distributed energy network 
and the SC, which contributes to the resources used in the designed network. 
The model developed will then be used to obtain optimal network configurations 
for a hypothetical rural community in Namibia. The flexible model can be easily 
adapted to predict optimal networks for energy networks for different communi￾ties. The variability in energy demand and supply will be addressed by using the 
multi-period SC methods used by Egieya et al. (2019) and Mutenure et al. (2018) 
for bioenergy networks. To the best of the authors’ knowledge, the concept of SC 
networks has not been explicitly included in hybrid distributed energy systems, as 
proposed in this study.
11.2 PROBLEM STATEMENT
Given:
• A set of renewable and non-renewable resources (j), such as solar irradia￾tion, biomass, human and animal waste, and diesel, from which energy can 
be generated;
• A set of technologies for converting resources to energy such as solar pho￾tovoltaic panels, biodigesters and generators;
• A set of backup energy storage systems;
• An hourly (t) and a seasonal supply (p) based variability in intensity for end￾use in a day (d) for the given energy sources (j);
• An hourly and seasonal based variability of load demand for an isolated rural 
community with household, communal and commercial energy demand;
• Unit costs to install, maintain and operate the technologies, including the 
transportation of the resources and energy produced between supply, tech￾nology and demand locations.
The goal is to develop an optimal energy distribution network for a given rural 
community that is isolated from the main centralised grid system with the above￾mentioned information. The proposed energy network superstructure is shown in 
Figure 11.1. The energy network developed must be able to meet all the energy 
requirements for the given neighbourhood, irrespective of variations in resource 
availability and fluctuations in energy demand. This will be done by setting up the 
model as a MILP to optimise total cost. A multiple timeframe SC network will be 
used to model the fluctuations in the energy sources and sinks.Optimal Design of Islanded Distributed Energy Systems 185
The availability and fluctuations of energy sources will be dependent on several 
parameters related to the choice of the specific community of interest, such as avail￾able energy sources, climate and lifestyle. The optimisation model will minimise the 
total cost associated with the network while ensuring that all the constraints are met.
11.3 METHODOLOGY
This methodology uses the transhipment method to model the SC aspect of the 
integrated SC and DES. Different energy source types are distributed from a set of 
sources through the conversion technology nodes to meet the demands of the gen￾erators, which provide electricity to the islanded DES. The rest of the DES consists 
of PV, generators and batteries. These components combined with the SC provide 
an integrated SC-DES. The objective is to find a design that minimises the total 
annualised cost (TAC) of the integrated energy system and that includes the trans￾portation costs of the SC. This study derives an MILP formulation of the system and 
optimisation of the SC system integrated with a DES model, which is based on that 
presented in Mehleri et al. (2012) and De Mel et al. (2021b). The DES model provides 
electricity for a set of homesteads with energy demands derived from average energy 
consumption assumed for each season. The different seasons are defined by a rep￾resentative 24-hour day discretised into 0.5 hours, giving 48 half-hourly timesteps, 
and the model considers four seasons, as is commonly done in DES design models 
(De Mel et al., 2022). Energy sources and DES technologies will be used to opti￾mally meet the demand of the energy prosumers, with the microgrid connecting the 
demand nodes being supplied by a small, centralised energy generator, connected 
FIGURE 11.1 Integrated SC and DES superstructure.186 Optimization for Energy Systems and Supply Chains
to the SC. Prosumers are energy consumers that also produce energy. The generator 
will also be used to charge the storage systems during electricity off-peak times.
The variables contained in the SC model are listed in Figure 11.2. The energy 
node levels are classified into supply node, technology node level 1 and technology 
node level 2. The different components are shown in their respective categories in 
Figure 11.2. The categories are developed for different seasons (p), which corre￾sponds to four different seasons in a year. Supply and technology node levels are 
shown in Figure 11.2.
The cost associated with the SC can be described as follows:
CostSC = + ∑∑∑T x 1 2 s t ,  1,p s, t p 1, ∑∑∑T y t t 1, 2,p t1,t p 2, + T z 3
p s t1 t t
∑∑∑ s t ,  2,p s, t p 2,
p 1 2 p t s 2
(11.1)
where  1T is the unit cost of moving material between supply and technology nodes 
in level 1 [N$/kWh], T2 is the unit cost parameter to link between technology node 
levels 1 and 2 [N$/kWh], T3 is the unit cost parameter to move material between 
supply and technology node level 2 [N$/kWh], Supply is the set containing all fuel 
sources (s), Tnode1 is the set containing energy conversion technologies (t1) in node 
FIGURE 11.2 SC superstructure.Optimal Design of Islanded Distributed Energy Systems 187
level 1, Tnode2 is the set containing energy conversion technologies (t2) in node level 
2, x is the energy flow between supply and technology node 1 in kWh, y is the energy 
flow between technology node 1 and node 2 in kWh, z is the energy flow between 
supply and technology node 2 (without passing node 1) in kWh, and p represents the 
seasons in the year.
The following constraints were implemented to ensure the correct designs for 
optimisation are produced:
• Upper and lower bounds for the size of the different energy units
• Upper and lower bounds for the size of storage devices
• The energy produced, consumed or stored by each of the generators, con￾sumers or storage systems.
The MILP model was developed in the Pyomo algebraic modelling environment 
(Bynum et al., 2021) and solved using the CPLEX solver (IBM, 2022). The data￾base of input such as decision variables, constraints, design parameters and objective 
function was adapted from Mehleri et al. (2012) and De Mel (2021a, b), while the SC 
information used to meet the energy demands within the rural islanded microgrid are 
derived from Absolut firewood (2021), Gupta et al. (2011), Environmental Association 
for Universities and Colleges (2021) and GlobalPetrolPrices.com (2021), as discussed 
in the case study scenario section.
The following constraints were applied to the SC:
Constraints described by Eqs. (11.2) and (11.3) ensure that the energy transmission 
from all sources cannot exceed the maximum capacity of the energy sources:
 
where CC id the maximum energy capacity of each energy source or technology (j)
at respective nodes and corresponding time periods (seasons of the year).
Equations (11.4) and (11.5) ensure that the fuel at each node level is less than or 
equal to the amount of fuel supplied to the node:
∑xs t ,  1,p t ≤ T1_ Cap 1,p
s
∀ ∈   1t T     node1,     ∀ ∈p  Time (11.4)
∑( ) y z t t 1, 2,p s + ≤ s t ,  2,p CCj
t p 2,
t2
∀ ∈ ss   SubSupply, ∀ ∈   1t T     node1,     ∀ ∈ t T 2  node2,     ∀ ∈p  Time (11.5)188 Optimization for Energy Systems and Supply Chains
where T1_Cap is the technology node level 1 maximum capacity and SubSupply is 
the set containing all fuel sources that go directly into technology node level 2.
The TAC objective function of the integrated energy SC and DES which is to be 
minimised is represented as shown in Eq. (11.6).
In Eq. (11.7), the operating cost can be obtained by multiplying the operating cost 
of every unit (CO
j ) [N$/kWh], with the optimal amount of energy generated by the unit 
(EUj d,  , t) [kWh] in a day (t = 48 time steps) for the number of operational days in a 
season (sd) in four seasons (p) and the energy source j. Similarly, the capital cost can 
be obtained by multiplying the capital cost of every unit (CC
j ) [N$/kW], with the opti￾mal amount of energy generated by the unit (EU) and the capital recovery factor CRF.
TAC = Cost C CC + + ost C OP ostSC
 (11.6)
sd 48 5
CostOP = × ∑∑∑
CO
j EUj d,  , t 
 (11.7)
d= = 1 1 t j=1
CostCC = × ∑CC
j EUj j × CRF (11.8)
j
where CostCC is the annualized capital cost [N$/year], CostOP is the annualized oper￾ational and maintenance cost [N$/year], CostSC is the annualised cost of the SC [N$/
year] as shown in Eq. (11.1), CO
j is the operating cost of every unit j, [N$/kWh], CC
j
is the capital cost of every unit [N$/kW], EU is the optimal amount of energy gener￾ated by a unit [kWh] and CRF is the capital recovery factor. The constraints below 
were implemented on the DES to ensure that the correct designs for optimisation are 
produced.
The linking constraint that ensures that the capacity of each unit in the DES 
remains the same across all seasons is as follows:
i pf  > = 1 EUj d,  , t p,  EUj d,  , t p,  −1  (11.9)
where p represents different seasons. Conversion technology capacities are main￾tained across seasons because these technologies are constantly used across seasons 
and not replaced every season.
Equation (11.10) ensures that electricity demand is met by the SC.
Eload
i t ,  = + E E SC PV discharge i t ,  i t ,  +∑Ei t ,  , c (11.10)
c
where for each building i at a timestep t and a storage c, Eload
i t ,  is electricity demand, 
ESC PV i t ,  is power from the SC, Ei t ,  is the power from a generator powered by the PV, and 
Edischarge
i t ,  , c is the power discharged by batteries.
Eq. 11 ensures that the generator powered by the PV cannot produce more than 
its maximum capacity.Optimal Design of Islanded Distributed Energy Systems 189
P
where NPanel i is the integer value of the number of panels installed, APanel is the area 
of panel (m2
), Irr is the irradiance received by the panel (kW/m2
), and ηPanel c is the 
panel efficiency.
Equation 11.13 is the constraint limiting the size of panels installed in the avail￾able roof area
NPanel P i i × ≤ A A anel roof (11.13)
Aroof
i is the maximum roof area.
Equation (11.14) gives the operational and maintenance costs of the PV
 
C E OP, PV = + ∑ ∑  PV, used
i t E C PV, charge
i t c  × × OP, V , PV days
,  ,  ,  N t × ∆
i t ,   c 
f 1
+ × ∑N C Panel OP,  , PV P i × × EU anel
i Ndays (11.14) 365 i
COP, V , PV is the variable operational cost [N$/year], Ndays is the number of days in the 
season, ∆t is the time interval used to convert power to energy (kW to kWh), and 
COP,  f , PV is the fixed operational cost [N$/kW-year].
Equation (11.15) gives the capacities of the batteries
EU V batt
i c,  = × Vi c ,  EDC (11.15)
Vi c ,  is the installed battery volume [m3
], and VEDC is the volumetric energy density 
of the given battery kWh/m3
 

Equations (11.16–11.18) constrain the binary value controlling the installation of 
batteries, the type of batteries to be installed and the amount of energy that can be 
stored in these batteries, respectively.
∑Wi c,  ≤ 1 (11.16)
c
EUbatt
i c,  ≤ × M Wi c,  (11.17)
εstored i t ,  , c i ≤ × EUbatt
, c SoCmax c (11.18)190 Optimization for Energy Systems and Supply Chains
Wi c ,  is the binary variable controlling type of battery to be installed, M is the maxi￾mum capacity of battery storage, εstored i t ,  , c is the amount of energy stored in the battery 
[kWh], and SoCmax c is the maximum state of charge allowed.
The recommended depth of discharge of the battery is dictated by Eq. (11.19)
εstored batt i t ,  , c i ≥ × EU , c c ( ) 1 D− oDmax (11.19)
DoDmax c is the recommended depth of discharge.
The battery energy balance is in a piecewise form as defined by Eqs. (11.20) 
and (11.21)
if t = 1:
ored E t disch
εst ch ch i t ,  , c × ∆ i t ,  , c i = × ( ) E t , t c,  η × ∆ − ηdisch (11.20)
Else if t ≥ 2
di
st × ∆
ε ed E t ored i t c i = + ε η stor
t c − ( ) sch
E t ch ch i t ,  , c
,  ,  ,  1, i t ,  , c × × ∆ −
ηdisch (11.21)
Ech
i t ,  , c is the power used to charge the battery, Edisch i t ,  , c is the power discharged from the 
battery, ηch is the efficiency of charging the battery, ηdisch
 is the efficiency of discharg￾ing the battery, and εstored i t ,  −1,c is the amount of energy stored by the battery at a previous 
time point. The logical imposition that restricts the battery discharge is given by 
Eq. (11.22), while the imposition that maintains the battery storage at the beginning 
and end of the daily horizon at the same level is given by Eq. (11.23)
if t> 1:
∆t Edisch or i t, c i × ≤ st ,  ε ed
ηdisch , t c −1, (11.22)
At  1 t t = =  and  48,
εstored = εstored i c , 1, i c , 48, (11.23)
The sum of the available power for charging is given by Eq. (11.24)
Ech
i t ,  .c = + E E ch, SC ch, PV
i t ,  , c i, t c,  (11.24)Optimal Design of Islanded Distributed Energy Systems 191
Ech, SC
i t ,  , c is the power from the generators fed by the SC, and Ech, PV
i t ,  , c is the power from 
the PV panel.
The upper and lower bound of the amount of power for charging a battery is given 
by Eqs. (11.25) and (11.26), respectively.
Ech × ∆t × ≤ ηch batt i t ,  , c i EU , c × S1 (11.25)
∆t Edisch i t ,  , c i × disch ≤ × EUbatt
, c S2 (11.26)
η
where S1 and S2 are scalar values representing the proportion of charge/discharge in 
the battery (a value of 0.2 was used for both scalers).
The constraints that prevent non-linearity during battery charging and discharg￾ing are described by Eqs. (11.27) and (11.28), respectively. Non-linearity in the 
battery is due to the battery cycling because it is charging and discharging at the 
same time.
Ech
i t ,  , c i ≤ × M Q , t c,  (11.27)
Edisch i t ,  , c i ≤ × M Q ( ) 1 − , t c,  (11.28)
Qi t ,  , c is the binary variable indicating charging/discharging, and M represents 
a big-M value. Eq. (11.29) describes the operational and maintenance cost of the 
batteries
∑∑ EUbatt
i c,  × POM, batt c
COP, Batt = c 1
× × sd (11.29)
t i ∆ 365
COP, Batt
 is the operating cost of batteries, and POM, batt c is the fixed operational cost of 
batteries per year [N$/kW-year].
The model will determine the following:
• Energy supply allocations and capacity for each energy supply technology
• Average hourly energy profiles in each structure that requires energy in the 
community of interest
• The average hourly flow of energy between the SC and structures that 
require energy
• Energy storage capacity
Although the model is developed and used to solve a specific problem, the model 
can be refined and expanded to represent other systems of interest as accurately 
as possible.192 Optimization for Energy Systems and Supply Chains
11.4 CASE STUDY SCENARIO
11.4.1 introduCtion
This case study focuses on developing an optimal electricity distribution network 
for an un-electrified rural community in Namibia. The demand profiles used are the 
same as provided by Mehleri et al. (2012) and De Mel et al. (2021a, b). However, data 
for solar irradiation and the rest of the SC component of the integrated model are 
data for a rural Namibian town, Tsumkwe. It is important to note that the estimation 
of electricity demand and design of a network for an un-electrified location comes 
with challenges as local factors have critical influences. In addition, the progres￾sive increase in energy consumption for various reasons adds to the complexity of 
demand estimation and network design.
This case study looks at the energy network described in Figure 11.1. The neigh￾bourhood consists of five houses as electricity demand zones. The electricity load 
will be supplied by the SC (via the SC generators), the PV unit (via the PV generators) 
and storage technologies. The SC consists of fuel transported from their sources to 
the digester and steam turbine conversion technologies; however, diesel goes directly 
into the SC generators without an intermediate conversion technology.
The operation of the energy network consists of four seasons which are winter, 
spring, summer and autumn. The seasons contain 90, 92, 92 and 91 days, respec￾tively. A day is divided into 0.5 hourly timesteps to give a total of 48 timesteps. The 
load usage pattern for each representative day of the season was assumed to be the 
same for every day in the season.
The average mini-grid electricity demand for the houses in this case study are 
20.1, 18.0, 20.0 and 25.3 kWh/day for Winter, Spring, Summer and Autumn, respec￾tively. Rural communities, however, have an energy demand of about 2–7 kWh/day/
household (Mbaka et al., 2010; Azimoh et al., 2016). Although the energy demands 
used for this case study are higher than those of typical rural communities, they are 
used as an indicator of future energy demands in the rural neighbourhood after the 
modernisation of the community.
The average daily solar irradiance for this neighbourhood in Tsumkwe is 14.8, 
13.3, 11.2 and 14.2 kWh/m2/day for Winter, Spring, Summer and Autumn, respec￾tively. The SC aspect of the energy network has resources with energy capacity rang￾ing from 500 to 15,000 kWh/season. There are also sufficient batteries to store excess 
electricity and supply this to the network when required.
Table 11.1 shows the key parameters used for the case study configuration.
The cost range of fuelwood that goes to a conversion technology was determined 
by using the cost of fuelwood given by Absolut firewood . The calculation to deter￾mine the cost is given below:
kgWood N$80 N$0.941 Cost of fuel wood to conversion technology = × = 4.25kWh 20kgWood kWh
Similar calculations were done to determine the cost range of human waste, crop 
residue and animal waste that go to conversion technologies. Using the diesel price 
of N$15.580 / L from GlobalPetrolPrices.com (2021) and the conversion of diesel to Optimal Design of Islanded Distributed Energy Systems 193
the energy of 10 kWh/L (Environmental Association for Universities and Colleges 
(2021), the cost range of diesel to conversion technologies was determined as follows:
N$15.580 1l Cost of diesel to conversion technology = × = N$1.56/kWh
l 10kWh
11.4.2 Findings oF study
11.4.2.1 Demand Profile
The model consists of 13,669 continuous variables, 2,940 integer variables, 26,189 
constraints and 1 overall objective function which was minimized. An Intel Core i5 
64-bit 2.40 GHz computing system was used for computation. CPU solution time was 
5.65 seconds. Figure 11.3 shows the half-hourly electricity demand for house 1 for 
Winter, Spring, Summer and Autumn. Similar trends and values have been observed 
for the other houses with slight variations in the values of electricity demand.
As seen in Figure 11.3, Autumn has the highest electricity demand followed by 
Winter, Summer, and Spring, respectively.
Electricity peak hours can be seen to be around 18:00 and 20:00 daily for all 
four seasons. This coincides with the time when workers arrive home and utilise 
domestic equipment contributing to higher energy demand. The lowest electricity 
demands are during the early hours of the morning between 0:00 and 06:00 while 
residents are asleep.
TABLE 11.1
Key Parameters for Case Study
Parameter Value Source
Capital cost of PV panel 9,540 N$/panel De Mel et al. (2021a & 2021b)
Annualised capital cost of steam turbine 0.0276 N$/kWh Brook (2019)
Annualised capital cost of digester 0.750 N$/kWh Brook (2019)
Annualised capital cost of diesel generator 0.0899 N$/kWh Brook (2019)
Variable operational cost of PV panel 0.11 N$/kWh De Mel et al. (2021a & 2021b)
Fixed operational cost of PV panel 265 N$/kW ⋅ year De Mel et al. (2021a & 2021b)
Panel area 2 1.75m De Mel et al. (2021a & 2021b)
Panel capacity 0.25 kW De Mel et al. (2021a & 2021b)
Maximum capacity of PV 5,000 kW De Mel et al. (2021a & 2021b)
Efficiency of PV panel 0.135 De Mel et al. (2021a & 2021b)
Cost of fuelwood to conversion technologies 0.941 − 1.48 N$/kWh Absolut firewood (2021)
Cost of animal dung to conversion 2.12 − 4.24 N$/kWh Absolut firewood (2021); 
technologies Gupta et al. (2011)
Cost of human waste to conversion 5.30 − 6.36 N$/kWh Absolut firewood (2021); 
technologies Gupta et al. (2011)
Cost of crop residue to conversion 0.21 − 0.38 N$/kWh Absolut firewood (2021); 
technologies Gupta et al. (2011)
Cost of diesel to conversion technologies 2.12 − 3.18 N$/kWh GlobalPetrolPrices.com (2021)194 Optimization for Energy Systems and Supply Chains
The choice of the energy conversion technology is determined by both cost 
and available supply of energy to demand zones. To analyse the solution deter￾mined by the integrated DES, one needs to consider the energy available from 
each energy source and the cost associated with the supply of these energies to 
demand zones.
The SC is available at all seasons and at all times of the day. The constraint of 
limited feedstock at a given period (time of day or season) is not a factor for the size 
of five neighbourhood houses considered in this study. Therefore, the capacity of SC 
is sufficient at all times for the neighbourhood houses. It is expected that if the cost 
of the SC energy production is lower than the alternatives, it will be the sole energy 
chosen to meet the demand.
The size of the PV is limited to the available area on the roof of each neighbour￾hood house because the PV units are installed on the roof of each house. Another 
limit of the PV unit is the available solar irradiation at various hours of the day and in 
various seasons. The selection of the optimum network of the DES will be informed 
by the available PV energy supply to meet the demand as well as the cost associated 
with the energy supply. Similarly, the choice of selection of the battery will depend 
on its cost-effectiveness compared to PVs and the supply chain. The battery has the 
same advantage as the SC in that it is available to supply energy at all times of the 
day depending on its level of charge.
Figure 11.4 shows the energy produced from the different conversion technolo￾gies for all five neighbourhood houses in the four seasons of the year for the optimal 
network. The electricity demand variations across the seasons can also be seen. The 
yearly demand for each house is 84.0, 79.9, 90.8, 98.0 and 78.0 kWh for house 1 to 
house 5, respectively.
As seen in Figure 11.4, the battery supply of electricity is not used for energy 
supply. The optimal solution does not include the incorporation of batteries, imply￾ing that batteries are not an economical choice in the system, based on the costing 
FIGURE 11.3 Half-hourly electricity demand for house 1 in four seasons.Optimal Design of Islanded Distributed Energy Systems 195
parameters used. The availability of inexpensive feedstocks and conversion tech￾nologies from the SC, and the ability of the PVs to produce sufficient electricity to 
meet most of the daily energy demands during daylight hours, explains this result.
Figure 11.5 shows PV variations in four seasons for house 1. A similar graph was 
also observed for the other neighbourhood houses.
The PV energy conversion technology is the second most used technology in the 
neighbourhood houses after the SC. The percentage of the yearly electricity obtained 
from direct PV supply to houses is 30.8%. PV offers cheaper energy compared to 
FIGURE 11.4 Energy supply profiles for five houses showing different conversion technolo￾gies across different seasons.
FIGURE 11.5 PV variation of house 1 in Tsumkwe across the day in four seasons.196 Optimization for Energy Systems and Supply Chains
SC fuel and the battery for energy. PV technology is, however, largely available 
between 07:00 and 17:00 during the day when direct radiation can be converted to 
transmittable energy. During periods where PV energy is available, it may not meet 
the demand at the given period and may thus still be necessary to rely on the SC 
energy technologies. PV energy conversion technology usage is also dependent on 
solar radiation intensity in the different seasons. The supply of solar irradiation is not 
directly related to energy usage as a result of the availability of the SC and storage 
energy sources available for supply to demand zones.
Figure 11.6 shows the seasonal SC energy supply variation of house 1 in a day.
The SC supplies 69.2% of the total energy demand of the five neighbourhood 
houses. The SC allows for the potential selection of several biomass and diesel fuel 
sources for the supply of energy to the generator. The range of costs associated 
with each SC energy option from source to technology conversion can be seen in 
Table 11.1. Out of the SC fuels listed in Table 11.1, only fuelwood and crop residue 
fuels were selected in the optimal solution as SC fuels. This can be explained by the 
significantly cheaper cost of these fuels per kWh of energy generated compared to 
alternatives. If the energy generated from these two feedstocks is not sufficient, the 
DES will select the next cheapest available feedstock.
SC energy conversion technologies come with the additional advantage that it is 
available to supply electricity at all hours of the day. Its use is, however, predomi￾nant at hours when PV energy is least used. For periods between 07:00 and 17:00, 
when solar radiation is available, the utilisation of the SC is reduced and used only 
to cover the deficit energy not met by PV supply. SC supply picks up before and after 
this period as can be seen in Figure 11.6. The reduction in solar irradiation in Winter 
would have also increased the dependency on SC energy supply but cannot be seen 
explicitly in Figure 11.6 as the energy demand for winter is lower than that of Summer 
and Autumn.
FIGURE 11.6 Supply chain seasonal energy profile of house 1 in four seasons.Optimal Design of Islanded Distributed Energy Systems 197
Because of the significantly higher cost associated with the battery, the optimum 
DES did not select the battery for energy supply. The battery is inactive for the cost 
and supply profiles used to meet the demands of five neighbourhood houses.
The energy provided by the SC coupled with PV unit supply is sufficient to cover the 
energy demand of the five neighbourhood houses at all periods (time of day or season).
The annualised cost breakdown for the optimal network is presented in Table 11.2.
For an annualised network cost of N$ 51,000, 432 kWh/year of electricity is gen￾erated for the neighbourhood of five houses. The optimum configuration depends 
mostly on the SC for electricity supply. The SC contributes 69.2% of the electricity 
supply of the network. This is followed by PV (30.8%) with no battery energy supply 
contribution to the electricity of the network respectively.
11.5 CONCLUSION
This study developed an optimal network for five houses having similar energy 
demands in a rural islanded energy system situated in Namibia. Electricity supplied to 
the five neighbourhood houses is 432 kilowatt per year. The technology choice depends 
on the energy demand profiles, available energy resources, and the price of feed￾stocks, as well as the energy conversion efficiencies and component costs of individual 
technologies. Because optimisation of the network was obtained by minimising TAC 
for the system, economic feasibility plays a large role in dictating the relative amounts 
of the energy options that will be used to meet the demand of the five households. The 
optimal configuration relies mostly on the SC network (crop residue and fuelwood) 
for its electricity demand, with a 69.2% supply of total demand. The remainder of the 
electricity is provided by the PV unit (30.7%). The battery is not a viable option for the 
given demand/supply profile at the costs specified. This is because of the cost associ￾ated with energy produced compared to the PV and SC energy supply alternatives. 
The dependency of energy on the SC stems from the SC being abundant and avail￾able at all periods (time of day and seasons) and its cost-effectiveness. The amount of 
energy provided by different energy conversion technologies also differed depending 
on the seasons. The selection of energy conversion technologies and amounts depend 
on the available resources that feed these technologies in the respective seasons. For 
the system considered, the available conversion technologies can cover the energy 
demand with a total annualised network cost of N$ 51,000.
TABLE 11.2
Annual Cost Break-Down
Cost Name Cost Value [N$]
Network cost 51,000
SC cost 39,801
DES cost 11,200
PV investment cost 9,870
PV operational cost 1,340
Battery investment cost 0
Battery operational cost 0198 Optimization for Energy Systems and Supply Chains
REFERENCES
Absolut firewood, 2021. Absolut firewood. [Online] Available at: https://www.absoluttours.
com/firewood/ [Accessed 12 December 2021].
AECOM, 2020. Spon’s Mechanical and Electrical Services Price Book 2020. 51 ed.
Abingdon: CRC Press.
Azimoh, C. L. et al., 2016. Electricity for development: Mini-grid solution for rural electri￾fication in South Africa. Energy Conversion and Management, 110(1), pp. 268–277.
Brook, M., 2019. Estimating the Tendering for Construction Work. 5th ed. Oxon: Taylor & 
Francis.
Bynum, M. L. et al., 2021. Pyomo -Optimization Modeling in Python. 3rd ed. Zurich: Springer 
Nature Switzerland AG.
Čuček, L. et al., 2010. Synthesis of regional networks for the supply of energy and bioprod￾ucts. Clean Technologies Environmental Policy, 12(6), pp. 635–645.
De Mel, I., Klymenko, O. V. & Short, M., 2022. Balancing accuracy and complexity in opti￾misation models of distributed energy systems and microgrids with optimal power flow: 
A review. Sustainable Energy Technologies and Assessments, 52(A), pp. 1–15.
De Mel, I., Klymenko, O. V. & Short, M., 2021b. Investigating the consolidation of the opti￾mal design of distributed energy systems with optimal power flow. arXiv, pp. 1–22.
De Mel, I. A., Klymenko, O. V. & Short, M., 2021a. Levels of approximation for the optimal 
design of distributed energy systems. Computer Aided Chemical Engineering, 50(1), 
pp. 1403–1408.
Egieya, J. M., u ek, L., Zirngast, K., Isafiade, A. J., Pahor, B. & Kravanja, Z., 2019. Synthesis 
of biogas supply networks using various biomass and manure types. Computers 
& Chemical Engineering, 122, pp. 129–151. ISSN 0098-1354, https://doi.org/
10.1016/j.compchemeng.2018.06.022. (https://www.sciencedirect.com/science/article/
pii/S0098135418306562)
Environmental Association for Universities and Colleges, 2021. How Much Energy Do You 
Use. Cheltenham: Environmental Association for Universities and Colleges.
GlobalPetrolPrices.com, 2021. GlobalPetrolPrices.com. [Online] Available at: https://www.
globalpetrolprices.com/Namibia/diesel_prices/ [Accessed 13 December 2021].
Č č
Gupta, A., Saini, R. P. & Sharma, M. P., 2011. Modelling of hybrid energy system - Part I: 
Problem formulation and model development. Renewable Energy, 36(2), pp. 459–465.
Huang, Y. et al., 2022. Three-phase optimal power flow for networked microgrids based on 
semidefinite programming convex relaxation. Applied Energy, p. 117771.
IBM, 2022. IBM ILOG CPLEX Optimizer. [Online] Available at: https://www.ibm.com/ana￾lytics/cplex-optimizer [Accessed 17 February 2022].
Louie, H., 2018. Off-Grid Electrical Systems in Developing Countries. 1st ed. Seattle: Springer.
Lund, H. et al., 2016. Energy storage and smart energy systems. International Journal of 
Sustainable Energy Planning and Management, 11(1), pp. 3–14.
Mbaka, N. E., Mucho, N. J. & Godpromesse, K., 2010. Economic evaluation of small￾scale photovoltaic hybrid systems for mini-grid applications in far north Cameroon. 
Renewable Energy, 35(10), pp. 2391–2398.
Mehleri, E. D., Papageorgiou, L. G., Markatos, N. C. & Sarimveis, H., 2012a. A model 
predictive control framework for residential microgrids. Computer Aided Chemical 
Engineering, 30(1), pp. 327–331.
Mehleri, E. D., Sarimveis, H., Markatos, N. C. & Papageorgiou, L. G., 2012b. A mathematical 
programming approach for optimal design of distributed energy systems at the neigh￾bourhood level. Energy, 44(1), pp. 96–104.
Mehleri, E. D., Sarimveis, H., Markatos, N. C. & Papageorgiou, L. G., 2013. Optimal design 
and operation of distributed energy systems: Application to Greak residential sector. 
Renewable Energy, 51(1), pp. 331–342.Optimal Design of Islanded Distributed Energy Systems 199
Morstyn, T. et al., 2020. OPEN: An open-source platform for developing smart local energy 
system applications. Applied Energy, 275(1), pp. 1–11.
Mutenure, M. et al., 2018. Optimization of bioethanol and sugar supply chain network: a 
South African case study. Clean Technologies and Environmental Policy, 20(5),
pp. 925–948.
Rajanna, S. & Saini, R. P., 2016. Modelling of integrated renewable energy system for electri￾fication of a remote area in India. Renewable Energy, 90(1), pp. 175–187.
Rao, S. S., 2009. Engineering Optimization - Theory and Practice. 4th ed. Hoboken, NJ: John 
Wiley & Sons.
Render, B. & Stair, Jr, M. R., 1997. Quantitative Analysis for Management. 6th ed. New York: 
Prentice-Hall, Inc./Book.
South African revenue services, 2009. Wear and tear allowance. [Online] Available at: www.
sars.gov.za [Accessed 21 December 2021].
Suresh, V., Muralidhar, M. & Kiranmayi, R., 2020. Modelling and optimization of an off-grid 
hybrid renewable energy system for electrification in a rural areas. Energy Reports,
6(1), pp. 594–604.
van der Heijde, B., Vandermeulen, A., Salenbien, R. & Helsen, L., 2019. Representative days 
selection for district energy system optimisation: a solar district heating sytem with 
seasonal storage. Applied Energy, 248(1), pp. 79–94.
Weber, C. & Shah, N., 2011. Optimisation based design of a district energy system for an eco￾town in the United Kingdom. Energy, 36(2), pp. 1292–1308.
APPENDIX
The annualised capital cost of the generator is calculated as follows:
£27 893 1kVA 1year 1 season 1 day 0.00442£ × × × × = 60kVA × 15years 0.8kW 4 seasons 90 days 24 hours kWh
0.0899N$/  = kWh
South African revenue services (2009); AECOM (2020)
This is a variable cost related to the size of the generator added to the operational 
cost and then multiplied by the seasonal capacity.201
12 Multi-Objective 
Optimization for Energy 
Network Planning
Energy Storage and 
Distribution in Integrated 
Solar Powered Grids
Jayne San Juan, Amiel Ching, Charles Chua, 
Lorenzo Dyogi, and Charlle Sy
De La Salle University
12.1 INTRODUCTION
The rising global population is expected to drive an increase of approximately 30% in 
global energy consumption by 2040 (U.S. Energy Information Administration (EIA), 
2017). The current production of energy continues to rely on fossil fuels such as oil, 
gas, and coal. However, the finite reserves of fossil fuels are projected to reach their 
CONTENTS
12.1 Introduction .................................................................................................. 201
12.1.1 An Integrated Solar-Powered Electrical Distribution Grid ..............204
12.1.2 System Description ...........................................................................205
12.2 Methodology .................................................................................................206
12.2.1 Assumptions .....................................................................................207
12.2.2 Objective Function ............................................................................208
12.2.3 Constraints ........................................................................................209
12.2.4 Solution Approach ............................................................................ 211
12.3 Case Study .................................................................................................... 212
12.3.1 Base Run Results .............................................................................. 213
12.3.2 Solar Production Site Breakdown ..................................................... 215
12.3.3 Battery Storage Breakdown .............................................................. 216
12.4 Conclusions and Recommendations ............................................................. 217
References .............................................................................................................. 218
Appendix ............................................................................................................... 219
DOI: 10.1201/9781003240228-14202 Optimization for Energy Systems and Supply Chains
limit soon and could completely be diminished within the next century (Madanayake 
et al., 2017). This problem is compounded by growing environmental concerns brought 
about by climate change. Energy production from such sources has also been linked to 
health and environmental problems associated with hazardous gas emissions. Fossil 
fuels inevitably contribute high values of carbon emissions, accounting for about 75% 
of total greenhouse gas (GHG) emissions (Ramos et al., 2018).
Latest studies in the field assert that potentially devastating environmental disas￾ters will occur if the world does not reduce its carbon pollution, making global 
warming a crucial issue for the world community. Hence, interest has grown in miti￾gating global warming and climate change by developing alternative solutions for 
more sustainable and efficient energy production. Governments and stakeholders 
have started to invest in renewable energy sources such as biomass, hydropower, 
geothermal, wind, and solar.
However, the integration of renewable energy sources into existing energy sys￾tems poses various challenges. Compared to energy production through fossil fuels, 
renewable energy sources have an inherent intermittent nature. The EIA adds that 
while renewable energy is virtually inexhaustible, the amount of energy that is 
available for energy production at a given time is limited (U.S. Energy Information 
Administration, 2017). Therefore, it is imperative to support the proper management 
and design of energy networks by data-based decision-making tools.
The design and management of renewable energy networks have typically been 
modeled quantitatively using simulation and optimization models. Optimization 
models are more appropriate for designing large-scale optimal supply chains consid￾ering multiple conflicting objectives, which is common in energy networks. Zandi￾Atashbar et al. (2016) critically reviewed literature applying mathematical modeling 
to energy networks and identified the predominant objectives among existing studies. 
Most studies optimize only based on a single objective – the economic, environ￾mental, or social. Some of the most common objective functions are minimizing 
costs or individual components, maximizing profits, and minimizing investment 
risks. Environmental impact has usually been measured based on emissions or global 
warming potential, while the number of local jobs created has been used to measure 
the performance of the social objective. Pérez-Fortes et al. (2014) assert that the 
consideration of multiple objectives in optimizing renewable energy networks is cru￾cial because their design and management necessitate the satisfaction of conflicting 
goals. This allows the model to capture the varied priorities of several stakeholders 
and balance the tradeoffs that exist between the objectives.
Economic and environmental objectives should simultaneously be optimized in 
energy networks. One objective should not be minimized too much that no atten￾tion would be given to optimizing the other. Considering only economic costs can 
result in a scheme where crucial investments and processes are disregarded to reduce 
costs, significantly compromising environmental sustainability. Similarly, when a 
system is optimized based solely on environmental efficiency, costs may be dramati￾cally inflated, making the solution impractical for implementation. The challenge in 
designing and managing an energy network is ensuring that the least cost is achieved 
while also minimizing overall environmental impact.Multi-Objective Optimization for Energy Network Planning 203
Economic objectives remain to be the most considered in the existing literature. 
Common economic objectives involve minimizing costs or investment risks and the 
maximization of profits, NPV, or revenue. Among these, the most popular is the min￾imization of total costs, or its individual components, such as transportation costs, 
logistics costs, and capital costs. On the other hand, the environmental objectives are 
generally to minimize GHG emissions or environmental impact and to maximize 
GHG emission savings.
Savic (2002) explains that single-objective optimization is only useful as a tool 
to allow decision-makers to understand the nature of a problem. However, it cannot 
yield a set of alternative solutions that account for the tradeoffs between conflicting 
objectives. Solving the economic and environmental objectives individually as sin￾gle-objective problems only gives insights into the system’s behavior. Goal program￾ming is one of the more popular theoretical approaches to achieve Pareto optimality 
when solving multi-objective optimization problems (Orumie and Ebong, 2014).
Goal programming models can be categorized as either non-preemptive or pre￾emptive goal programming. Non-preemptive goal programming models consider 
all goals to be of relatively equal importance. On the other hand, preemptive goal 
programming assigns priorities to the goals when some goals are more important 
for the decision-makers than others. Through this, higher priority goals will be 
attained closer than lower priority goals (Winston, 2004). Orumie and Ebong (2014) 
described a third kind of goal programming: weighted goal programming. Similar to 
preemptive goal programming, weights are assigned to indicate the relative impor￾tance of goal deviations. However, if these deviational goal values are of different 
units, normalization must be performed so that the deviations may be assessed on 
the same scale.
Rollan et al. (2018) proposed a goal programming approach to maximize net pres￾ent value and carbon sequestration to establish a planting and harvesting schedule in 
a forest reforestation system. The minimum efficiency between the two objectives 
was maximized to achieve a balance between the conflicting objectives. The efficien￾cies were computed by dividing the actual objective value by the maximum obtained 
when each objective was optimized separately. San Juan and Sy (2021) supplemented 
this approach through an additional phase that will allow one to account for the worst 
possible performance of each objective when computing for efficiencies. This is the 
objective value obtained when the other objective is optimized. The authors utilized 
the approach to develop a multi-objective optimization model to design biomass co￾firing networks integrating uncertainty in biomass properties with investment and 
operations planning. The simultaneous consideration of economic and environmen￾tal objective values allowed the control and identification of thresholds for which an 
objective’s achievement should be evaluated.
This chapter demonstrates the utility of the aforementioned approach by focus￾ing on the integration of solar energy in existing electrical grids. Specifically, the 
study involves storing and distributing solar energy into these integrated grids. The 
succeeding sections are structured as follows: Section 12.2 discusses the problem 
scope and system under study. Section 12.3 contains the model development and 
methodology used to account for the multiple objectives considered. Section 12.4 204 Optimization for Energy Systems and Supply Chains
presents the results from the computational experiments performed. Finally, Section 
12.5 summarizes the main conclusions and findings of this chapter.
12.1.1 an integrated solar-Powered eleCtriCal distribution grid
Solar photovoltaic systems produce electricity without emissions of GHG and par￾ticles that come from the burning of fossil fuels. Many current technologies have 
been engaged to harvest and convert solar energy to electricity to be properly utilized 
and to satisfy everyday energy consumption. The use of solar energy offers an alter￾native to reduce the dependency on traditional utilities. Kabir et al. (2018) state that 
solar energy inherently can satisfy the world's energy demands if the technologies for 
harvesting and supplying are properly used.
However, the integration of renewable energy sources into existing energy sys￾tems poses various challenges. Compared to energy production through fossil fuels, 
renewable energy sources have an inherent intermittent nature. Solar energy out￾puts have certain fluctuations and uncertainties which affect energy production since 
energy production either peaks or plunges (Zeng et al., 2011). Wan et al. (2015) add 
that the volatility in solar energy generation within the electrical distribution grid 
brings about severe difficulties involving electric power balance, system stability, 
reactive power compensation, and frequency response. Battery energy storage can be 
integrated into the energy system to mediate intermittent power generation (Sufyan 
et al., 2019). The use of batteries enables energy storage when solar energy and fossil 
fuel production are above the demand while also distributing energy when produc￾tion is low, and demand is high. Energy storage aims to mitigate energy wastage due 
to the imbalance between energy distribution and demand while also acting as an 
additional supply source.
Research has looked into the optimization of energy storage systems with energy 
production utilizing renewable energy sources. Sinn et al. (2017) conducted a study 
that solved the optimal sizing of an energy storage system to reduce energy waste 
from a renewable energy source. However, this only focused on two extreme cases: 
whether to store all excess energy, which resulted in an energy storage capacity 
of more than 400% of the current available capacity; or not to store energy at all, 
which resulted in around 61% of produced energy. Zerrahn et al. (2018) extended 
this research work by considering economic costs while varying the percentage of 
demand that renewable energy could satisfy. The authors believed that the extreme 
scenarios considered by Sufyan et al. (2019) were not desirable options. Instead, they 
stated that the optimal choice is somewhere in the middle. That is, having the capabil￾ity to store excess energy while also incurring inevitable energy loss. Alternatively, 
a study by Wang et al. (2014) aimed to minimize the output power fluctuation of 
large solar power plants while utilizing battery storage. The study considered power 
generation fluctuations of solar energy but only considered the solar energy genera￾tion system. It only considered modeling the battery but did not include an economic 
perspective as well as demand satisfaction.
The problem scope considered in this chapter adds to the body of literature 
by considering the different processes involved in an electrical distribution grid. 
Specifically, decisions involved from energy production to fulfillment of demand. Multi-Objective Optimization for Energy Network Planning 205
The possibility of battery storage is likewise considered since having this component 
will help minimize energy loss within the electrical distribution grid. The optimiza￾tion model of Zerrahn et al. (2018) assumed that excess energy incurred no cost and 
that the fluctuating power generation from the renewable energy source was resolved 
through the use of an aggregate value. However, this is a limiting assumption that is 
addressed in this work. According to Yang et al. (2014), there is an associated cost 
with the volatility of solar energy, which comprises the ancillary costs of the system. 
Furthermore, a multi-period optimization model is developed in this work, which 
contrasts with single-period models found in the literature. This allows the model 
to account for energy storage and variability of solar energy usage within a time 
horizon. This approach also allows one to identify the maximum energy capacity 
of the storage, which is essential for determining the optimal storage of the battery. 
Furthermore, having a multi-period perspective allows the consideration of battery 
obsolescence through time.
12.1.2 system desCriPtion
The electrical distribution grid understudy is presented in Figure 12.1. The system 
contains three main components: production, distribution, and consumption. The 
grid has two sources of electricity: regular coal production and solar energy. Energy 
is converted into electricity, fed into the electrical grid, and eventually distributed to 
the end consumers. The diagram shows that solar-produced energy will be stored in 
batteries before being released into the electrical grid. Battery storage is introduced 
into the grid to minimize potential electricity losses and account for variability in 
solar energy production.
The inherent variability of electricity production from solar energy causes either 
spikes or plunges in the amount of electricity produced. Electricity loss is then 
experienced when production is higher than consumption. Hence, the presence of 
batteries allows energy to initially be stored during spikes within the production. 
Alternatively, stored energy will be utilized when supply is insufficient to satisfy 
consumer demand. Battery storage will have varying levels of energy stored at the 
FIGURE 12.1 Electrical distribution grid.206 Optimization for Energy Systems and Supply Chains
end of the period and are to be carried on to the subsequent periods. The model 
captures the dissipation of energy in the batteries through time. Furthermore, storage 
capacity diminishes over time due to the nature of obsolescence.
12.2 METHODOLOGY
The model structure in Figure 12.2 presents the sequence of decisions that will be 
performed in developing the electrical distribution grid starting from production to 
distribution. Site selection is only performed once at the start of the planning horizon. 
Selected sites refer to where the source of renewable energy would be located in the suc￾ceeding time periods. Meanwhile, recurring decisions involve the operational require￾ments of the distribution grid. The model primarily needs to decide on the amount of 
coal to produce and solar energy to harvest at the beginning of each period. Through 
the combination of these two, the demand for energy within the grid would be satisfied.
It is assumed that the existing powerplant within the grid is being utilized for 
coal-produced energy. The model then determines the amount of solar energy that 
will be directly fed into the grid from harvesting while also deciding on the amount 
of solar energy to be stored. The component of storage within the model requires the 
accompanying decision of the amount of battery energy storage to be used within the 
period. Lastly, the presence of storage requires the model to decide when and how 
much energy should be released within the period to supply energy into the electrical 
distribution grid to satisfy demand.
Collectively, these decisions are made to simultaneously maximize energy 
efficiency and minimize the cost throughout the whole system. The multi-period 
FIGURE 12.2 Model structure.Multi-Objective Optimization for Energy Network Planning 207
perspective used to model the system understudy accounts for the change in storage 
levels of the batteries. This also allows the consideration of dissipation in the storage 
capacity of batteries over time.
Table 12.1 contains the model nomenclature used to define the indices, param￾eters, and variables in the model.
12.2.1 assumPtions
• Site selection for solar energy source occurs before decisions relating to 
energy distribution and battery acquisition. Selected sites can be operated 
instantaneously.
TABLE 12.1
Indices, Variables, Parameters
Indices Definition
i Time period {1,…,I}
j Battery {1,…,J}
k Site {1,…,K}
Binary Variables
UBij 1, if battery j is used in period i
0, otherwise
BBij 1, if battery j is purchased in period i
0, otherwise
CSk 1, if site k is selected
0, otherwise
Continuous Variables Units
RMCui Amount of coal to be utilized in period i kg
SPESij Amount of solar-produced energy to store in period i to battery j kW
SPERDi Amount of solar-produced energy to be released directly in period i kW
SPERSij Amount of solar-produced energy to release in period i from battery j kW
System Variables
BIij Beginning inventory of battery j in period i kW
EIij Ending inventory of battery j in period i kW
BC Batter capacity kW
DE Energy demand kW
ASPi Average solar production in period i kW
CCSi Supply of coal in period i kW
EPC Energy produced per kilogram of coal kW/kg
Parameters
RMC Variable cost of raw materials related to coal-produced energy US$/kg
MCj Maintenance cost for battery j US$/unit
ICj Investment cost for battery j US$/unit
OCj Operational cost for battery j US$/unit
PC Production cost for coal-produced energy US$/kg208 Optimization for Energy Systems and Supply Chains
• Selected sites can be directly connected to the grid as well as to future 
installed batteries.
• Batteries are purchased before the beginning of the month. This means that 
the batteries are already available and can be utilized within the month that 
the model decides to utilize them for storage. Battery capacity is reflective 
of current battery storage units within the market.
• Beginning inventory within the first month is zero. The batteries do not 
contain any charge of electrical energy that could be used to distribute unto 
the grid.
• The ending inventory of battery storage units refers to the stored solar 
energy from the renewable energy site that was not consumed within the 
given month. The ending inventory is carried forward to the succeeding 
periods within the planning horizon.
12.2.2 objeCtive FunCtion
The objective function involves both the minimization of cost and the maximization 
of energy efficiency.
Costs: The first objective of the model as shown in Equation 1 is to minimize 
costs associated with the energy grid distribution. These involve investment 
costs (IC) for buying battery j in period i (BBij), variable and production costs 
(RMC + PC) for each amount of coal to be utilized (RMCui
), maintenance 
costs (MC), and operational costs (OC) for battery j usage in period i (UBij).
  Min Cost R = + ∑ ∑ ( ) MC PC * RMCui + ICj * B
i  ∑ Bij
j i 
∑ ∑   
( )  + +  MCj j OC *  UBij  (12.1)
j  i 
Energy efficiency: The second objective of the model is to maximize energy 
efficiency relating to solar energy production. This is defined as optimiz￾ing the percentage contribution of solar energy in satisfying the electric￾ity demand of the grid. The numerator is then equated to the total amount 
of solar energy consumed by the grid, comprised of the amount of energy 
released into the grid (SPERSij) and stored in the battery for later use 
(SPES )ij . Meanwhile, the denominator is represented by the total amount of 
coal utilized (RMCui) and solar energy produced  A( ) SPik . The efficiency 
function is summarized in Equation 2 as follows:
(SPERSij + SPES )ij
Max Energy Eff ∑ ∑ =
∑ ∑
i j
ui + ik k i i k ∑ (12.2)
RMC * EPC ASP * CSMulti-Objective Optimization for Energy Network Planning 209
12.2.3 Constraints
Capacity: This constraint limits the amount of raw material coal (RMCui
) that 
is available for utilization based on supply. This ensures that the amount of 
raw material coal utilized is always less than or equal to the capacity of coal 
supply (CCSi
) for each period i.
RMCu i i i ≤ ∀ CCS     (12.3)
Solar energy production supply: In terms of solar energy production, there is 
a finite amount of supply that can be harvested from a grid of solar panels 
in each certain period depending on the seasonality and interannual vari￾ability. The average solar production in period i (ASPi
) is used as the basis 
for the maximum amount of solar energy that can be harvested in period i. 
The newly harvested amount of solar energy would include the new input 
amount of solar energy that is stored in period i into the battery j (SPESij), 
the new input amount of solar energy that is released directly to the grid 
in period i from battery j (SPERDij), and the new input amount of unused 
solar energy in the period i from battery j (USEij). The summation of these 
three usages of newly harvested solar energy has a curtailment of its supply, 
forcing the total sum of these three amounts to be equal to the average solar 
production for the period i (ASPi
). Given that site selection is a decision 
within the model, the average solar production would be dependent on how 
many solar plant sites are chosen (CSk).
∑SPESij + + ∑ ∑ SPERDij USE A ij = ∀ ∑ SPik * CS   k i (12.4)
j j j k
Energy demand: Similar to all supply and demand models, a demand con￾straint is present which must be satisfied while trying to achieve the objec￾tive of the model. It was stated previously that the supply of energy comes 
from two sources which are the coal energy plant and the solar energy 
source. The solar energy source has two components: the harvested energy 
within the period and the energy that was stored and would be dispersed 
within the period. The amount of coal energy is given by the amount of 
raw material coal used (RMCui
) multiplied by the energy produced by 1 kg 
of coal (EPC). The latter is assumed to be approximately 8 kWh based on 
the European Nuclear Society regarding their fuel conversions (European 
Nuclear Society, 2019). This would be added to the amount of solar-pro￾duced energy to be released directly into the grid (SPERDij) alongside 
the amount of solar-produced energy to release in period i from battery j
(SPERSij). The sum of these three variables should be greater than or equal 
to the demand for energy for period i (DEi
).
RMCu i i * EPC + + ∑ ∑ SPERDij SPERSij ≥ ∀ DEi     (12.5)
j j210 Optimization for Energy Systems and Supply Chains
Battery capacity: Battery energy storage units have their own capacity in 
which the amount of stored energy must not exceed the said amount. Within 
a time period, battery storage is composed of the beginning inventory (BIij) 
as well as the solar-produced energy stored for the period (SPESij). The 
model tries to limit the amount of solar-produced energy that can be stored 
within the time period, but it also tries to decide whether attainment of new 
batteries is needed. The beginning inventory added with the solar-produced 
energy stored in the period is less than the battery capacity (BC) multiplied 
by the number of used batteries (UBij). The number of used batteries deter￾mines the available amount of battery storage.
∑BIij + ≤ ij ij i
j
∑ ∑ SPES   UB * BC ∀ (12.6)
j j
Available batteries: The number of available batteries which is determined 
by the number of used batteries (UBij) should be less than or equal to the 
number of bought batteries (BBij). This constraint ensures that the number 
of available batteries is equivalent to the number of purchased batteries or 
the batteries that the system has invested in throughout all time periods.
∑UBij ≤ ∀   B ∑∑ B   ij i (12.7)
j i j
Ending inventory: The ending inventory of a period is determined by the dif￾ference in inflow of solar energy into the battery and the outflow. This is 
accounted from the beginning inventory of battery j in period i (BIij) being 
added by the amount of solar energy stored in battery j in period i (SPESij) 
and subtracting the amount of energy released from the battery into the 
grid in period i from battery j (SPERSij). This allows for the model to have 
a value for the ending inventory in the period to be carried over to the next 
period as the next beginning inventory to uphold the multi-inventory con￾sideration of the model.
EI B ij = − Iij SPERSij + ∀ SPES   ij   ,i j (12.8)
Beginning inventory: The model tries to account for a multi-period decision￾making system due to the presence of battery energy storage in which 
energy can be stored and used in future periods. In order to account for 
the movement of storage from one period to the next, the constraint below 
shows how the ending inventory of period i-1 is the beginning inventory of 
the following period. 
EI B ij ≤ ∀ I   ij   ,i j (12.9)
Percentage of energy demand distribution: The percentage of the energy 
demand distribution is assumed in the model to be at least 70% of demand Multi-Objective Optimization for Energy Network Planning 211
in period i (DEi
) given to coal-produced energy equivalent to the product 
of amount of raw material coal utilized (RMCui
) and approximate energy 
produced for every kilogram of coal (EPC); and battery storage released 
solar energy across all batteries j (SPERSij) for all periods i. The remaining 
percentage of demand (DEi
) will be satisfied through solar-produced energy 
released directly to the grid from the solar plant (SPERDij). This is done to 
promote the usage of solar energy as a supplement to the current traditional 
coal-produced energy.
RMCu i i * EPC + ≥ ∑SPERSij 0.7 * DE   i ∀ (12.10)
j
∑SPERDij ≥ ∀ 0.3* DE   i i (12.11)
j
Available stored amount to release from current inventory: The amount 
of solar-produced energy available to be released from battery storage in 
period i from battery j (SPERSij) should always be less than or equal to the 
beginning inventory of battery j in period i (BIij). This is to ensure that the 
model follows the limits of the system regarding how much solar energy 
could be released from the battery storage.
SPERSij ≤ ∀ BIij    i j ,  (12.12)
12.2.4 solution aPProaCH
The model seeks to optimize the performance of both cost and energy efficiency of 
the grid. This is defined here as the goal achievement score (GAS). The GAS strikes 
a balance between the minimization of the total cost and the maximization of energy 
efficiency. A balance is achieved by maximizing the minimum rating obtained for 
each objective. This approach has been adapted from Rollan et al. (2018), which dealt 
with a scheduling problem for forestation projects. The authors used this scoring 
system to simultaneously optimize carbon sequestration and economic metrics in the 
aforementioned projects. The use of the GAS score prevents optimizing one objec￾tive at the expense of the other, as shown in Eq. (12.13). GAS values are obtained by 
dividing the improvement achieved (difference between worst and actual values) and 
the potential improvement (difference between worst and potential values).
 Costmax − cost   Eff e min − ff 
Max GAS =min  max pot ,  min pot  (12.13)
 Cost − Cost   Eff E − ff 
The GAS score is computed by initially considering two single-objective function 
models. Costmax
 denotes the worst value that the cost objective may take (its value 
when the efficiency objective is optimized, and vice versa for Eff min). Meanwhile, 
potential objective values (Costpot and Eff pot) denote the best possible values from the 
aforementioned single-objective optimization models.212 Optimization for Energy Systems and Supply Chains
Target-setting is subsequently performed by assigning either a cost budget or tar￾get efficiency as a soft constraint to the other objective. The initial budget is set at the 
value of the cost when the energy efficiency objective is optimized. The succeeding 
budget becomes based on the cost value obtained in the preceding phase. The same 
goes for the efficiency target. This consequent loop is ran until a stopping criterion is 
met, which is based on an algorithm proposed by San Juan et al. (2019). The system 
checks whether the maximum values for cost and efficiency have been surpassed by 
the actual values obtained from the model and assigns them these as new values if 
they have. Based on these values, the GAS is computed. If the difference between the 
current and previous GAS is less than a set tolerance level, the loop is stopped. The 
algorithm is summarized as follows:
GAS Optimization Algorithm
12.3 CASE STUDY
The mixed-integer linear programming model developed for this problem was solved 
through the use of the CPLEX solver in the MATLAB (Matrix Laboratory) envi￾ronment. A six-month planning horizon was considered in the succeeding demon￾strations. The demand values were based on a 2018 dataset on the peak demands 
of the Luzon Region in the Philippines as provided by the Department of Energy 
Philippines (2018). The complete datasets on demand and battery storage properties 
are presented in the Appendix.
The results are presented in three parts: each sub-objective is optimized sepa￾rately, followed by the complete model run. Running the model wherein each objec￾tive is minimized individually is necessary to obtain the potential and worst values 
Set tolerance level ε
Initialize Budget, Eff target, Costmax , Costpot , Eff min , Eff pot  and i = 0
while GASi i − > GAS −1 ε do
Solve optimization model Min Cost
Set Budget = cost
Solve optimization model Max Eff
Set Eff target = eff
i i = + 1
if cost>Cost
max
Costmax = cost
if env<Eff min
Eff min = eff
 Costmax − cost   Eff e min − ff 
GASi = min   ,   
 Costmax − Costpot   Eff E min − ff pot 
endMulti-Objective Optimization for Energy Network Planning 213
for cost and emissions needed in the full model run. The results are summarized in 
Table 12.2 and Figure 12.3.
Solar panel efficiency considers the amount of solar energy that is fully converted 
and stored into usable electricity, provided that it incurs less wastage or less dis￾sipated electricity. It is evident that there is a direct correlation between cost and 
efficiency. The higher the efficiency of the solar energy battery storage, the higher the 
incurred cost would be. The optimal GAS value of 0.7222, therefore, represents the 
balance between these two conflicting objectives. Specifically, this value indicates 
that a compromise is met when the system aims to have a 90% energy efficiency rat￾ing and a corresponding system cost of $173,431.
12.3.1 base run results
Figure 12.4 reflects the investment plan for the grid based on the results obtained 
from the GAS score. This plan involves decisions pertaining to the site location 
TABLE 12.2
Comparison of Performance from Cost and 
Efficiency Objectives
Complete Model Run
Min Max GAS
Cost 149,798 251,872 173,431 0.7685
Efficiency 0 1 0.9 0.7222
0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
130000
150000
170000
190000
210000
230000
250000
270000
0.77 0.83 0.89 0.9 0.92 0.94 0.95
GAS
COST ($)
ENERGY EFFICIENCY
Cost vs Efficiency GAS
FIGURE 12.3 Minimizing cost ($) vs. maximizing efficiency (%).214 Optimization for Energy Systems and Supply Chains
which was determined by the variable CSk and the decision on whether to purchase 
a battery and use it within the given month. Site selection is performed before the 
start of the first month, in which two out of the three sites (A and B) were utilized 
by the model. Three batteries were also available for purchase. The model deter￾mined that Battery 3 is to be purchased within the first month and then utilized all 
throughout the remaining months within the specified planning horizon. Battery 1 
was purchased on month 2, and Battery 2 was purchased and used during month 
three up until month 6.
It is evident from Table 12.3 that the ending inventory of the previous month is 
equivalent to the beginning inventory of the next month, thus verifying the multi-period 
carry-over inventory concept of the optimization model. These levels are adjusted 
TABLE 12.3
Beginning and Ending Inventory Results of Batteries (in kW)
Inventory Results
Month
1 2 3 4 5 6
Battery 1 Beg Inv 0 0 600,000 0 600,000 0
Stored 0 600,000 0 600,000 0 0
Ending Inv 0 600,000 0 600,000 0 0
Battery 2 Beg Inv 0 0 0 600,000 0 600,000
 Stored 0 0 600,000 0 600,000 0
Ending Inv 0 0 600,000 0 600,000 0
Battery 3 Beg Inv 0 296,100 76,700 523,300 76,700 523,300
Stored  296,100 76,700 523,300 76,700 523,300 0
Ending Inv 296,100 76,700 523,300 76,700 523,300 0
FIGURE 12.4 Decisions per period.Multi-Objective Optimization for Energy Network Planning 215
based on the amount of solar energy stored in the batteries within periods and released 
into the grid distribution to satisfy energy demand. The importance of this multi-period 
concept is tested in the model by allowing the system to optimize for decision-making 
throughout more than one period creating a multi-period inventory system.
Aside from energy storage, the system also decides on the amount of solar energy 
to release to the grid directly. Table 12.4 shows the amount of solar energy (in MW) 
that is directly fed into the system after harvesting within the given time period. The 
amount of solar energy directly fed into the system is the amount of solar energy 
generated from the two chosen sites collectively.
Based on the results, it can be seen that the average energy efficiency is 90%, thus 
satisfying the set constraint to limit energy wastage to a maximum of 10%. This 
shows the energy efficiency in the six-month period in which solar energy is utilized 
with minimal energy loss in the grid distribution system (Table 12.5).
12.3.2 solar ProduCtion site breakdown
Site selection is a variable considered in the study to help decision-makers identify the 
number of sites (solar energy supply) required to satisfy the demand for energy and 
move toward the use of renewable energy sources. Three sites were determined as pos￾sible locations for solar energy generation. Solar energy-producing sites are exposed 
to the environment and other elements of nature in which these sites can be affected 
by natural causes such as typhoons, earthquakes, and the like. Hence, the possibility 
of such occurrence is consequently explored. Taking this into consideration, it was 
assumed that the solar production site would not function within a month due to the 
assumption that it would have to undergo repair. Therefore, the breakdown prevents 
any amount of solar energy from being produced from that site within the given month.
Figure 12.5 shows the schedule of breakdown for the three sites and the effect 
these breakdowns had on the model results. With the site expected to produce no 
solar energy during the time of breakdown, all three solar-producing sites would 
have to be invested upon instead of just two (site A and C from the base run). This 
TABLE 12.4
Solar Produced Energy Released Directly (in kW)
Month
1 2 3 4 5 6
2,763,900 2,952,900 3,865,300 5,207,700 3,519,400 4,600,000
TABLE 12.5
Energy Efficiency Results Objective per Period (in %)
Period 1 2 3 4 5 6 Ave
Energy efficiency 89.13 89.05 90.30 93.82 92.46 82.25 90.00
Energy wastage 10.87 10.95 9.70 6.18 7.54 14.75 10.00216 Optimization for Energy Systems and Supply Chains
shows that the foreseen decrease in supply necessitates the acquisition of another site 
in order to help satisfy demand. Furthermore, it is also evident that all three batteries 
are now utilized in the first month. The base run had the following purchase sched￾ule: Battery 1 purchased in month 2, battery 2 in month 3, and battery 3 in month 1. 
On the other hand, looking into the site breakdown scenario, all batteries would be 
purchased in the first month and utilized throughout the succeeding months.
The site breakdown led to a total system cost of $208,659 compared to the initial cost 
of $174,300. The occurrence of a site breakdown required the immediate use of another 
site as well as the use of all battery storage units in the early months. The breakdown 
also led to an increase in battery energy storage and usage investment. From a decision 
maker’s perspective, expecting sites to breakdown creates the need to purchase addi￾tional sites to account for the potential loss of generating capacity. The acquisition of 
multiple sites is also accompanied by increase in the use of battery energy storage due to 
the presence of energy loss and the ability to continue the use of solar-produced energy.
12.3.3 battery storage breakdown
Battery units primarily store solar energy that could be used for the succeeding 
months to satisfy the demand for energy as well as to lessen the dependency on coal￾produced energy. Given this, it is highly likely that some battery storage units may 
also breakdown and be unavailable for use for a period of time.
Battery failure implies that a unit will not be able to store solar energy for a 
month. If this unit had energy stored beforehand, this would be considered waste 
as it was not utilized prior to the breakdown. Up to three batteries could be used in 
the model for storage of solar energy. Three variations were tested for this scenario. 
Scenario 1 1involves battery storage unit 1 breaking down on month 2. Scenario 2 
assigns battery storage unit 2 to breakdown on months 2 and 3, while scenario 3 
assigns battery storage unit 3 to breakdown on months 2, 3, and 6.
FIGURE 12.5 Results of site breakdown scenario.Multi-Objective Optimization for Energy Network Planning 217
With some batteries expected not to be able to store solar energy during the time 
of breakdown, the model had determined that only solar-producing sites A and C 
would be invested upon similar to that which was determined within the base run. 
This shows that the expectation of the batteries not to store in certain months in the 
future determines that there is still no need to acquire another site in order to help 
satisfy demand. This site selection plan is true to all scenario sets in battery break￾down. The resulting decisions can be seen in Figure 12.6.
In the first scenario, the model decided to buy battery 1 immediately on month 1, 
while batteries 2 and 3 were both purchased on month 2. Meanwhile, the second and 
third scenarios required that both batteries 1 and 2 be purchased on the first month while 
Battery 3 on the succeeding month. As a point of comparison, the base scenario required 
one battery for each of months 1, 2, and 3. Therefore, the breakdowns necessitated the 
acquisition of additional batteries to supplement the decrease in energy storage capacity. 
Furthermore, the period and frequency for which the breakdowns occur also dictate the 
schedule for procuring the batteries. The total system cost increased to around $186,000, 
which is naturally higher than the base case but lower than the site breakdown scenarios 
(lower investment costs of the batteries). This shows that the model is sensitive to poten￾tial energy wastage since it will impact the 90% energy efficiency rating it seeks to 
maintain throughout the planning horizon. Nevertheless, it still chose to compensate for 
storage capacity even if this meant increasing total system costs.
12.4 CONCLUSIONS AND RECOMMENDATIONS
The chapter focused on a design model specific for solar energy plants that simulta￾neously optimizes energy efficiency and system costs. Minimizing either economic 
costs or maximizing the solar energy efficiency objective individually, as single 
FIGURE 12.6 Results of battery breakdown scenario. 218 Optimization for Energy Systems and Supply Chains
optimization models, created an emphasis on the contradictory nature of the two 
objectives. The multi-objective perspective used in this study, therefore, led to a com￾promise between these two conflicting objectives.
The computational experiments demonstrated that the model is effective in optimiz￾ing battery energy storage in energy distribution for solar energy integrated electrical 
distribution grids. These sets of decisions can range from one-time decisions such as 
investing in a new battery energy storage unit and utilizing this to store solar energy. 
The decisions could also be operational in nature such as determining the amount of 
solar energy to store, release directly to the grid, and release indirectly from previously 
stored solar energy. The experiments considered scenarios of up to 6 months and the 
utilization of up to three solar energy 60 MW lithium-ion battery storage units.
Site breakdowns, battery malfunctions, and even the type of battery storage units 
used were shown to have an impact on the network plan. It comes down to proper 
site selection decisions and ways to compensate for the lack of energy efficiency for 
site breakdowns. This led to the utilization of all three sites. For battery breakdown, 
proper allocation and changes in amounts of energy storage to each battery were 
taken into account, allowing the system to still meet the demand and maintain the 
energy efficiency objective.
Further improvements can be taken by changing the time period intervals from 
a monthly basis to a daily/weekly basis. This would improve the accuracy and effi￾ciency of the use of electricity and have a smoother demand for energy in the grid. 
Another direction for improvement could be in the aspect of a range of number of 
solar energy plants and battery energy storage units to be considered to allow a larger 
scale for the model to optimize. Lastly, the flexibility of the efficiency range can be 
manipulated for the desired energy efficiency/wastage rate for a more feasible or 
cheaper alternative to solar energy as a supplement for traditional energy being uti￾lized in the decisions of interested future investors in solar energy technology.
REFERENCES
Department of Energy Philippines, Philippine Power Statistics: Department of Energy 
Philippines, https://www.doe.gov.ph/philippine-power-statistics, 2019, (Accessed: 
January 6, 2020).
European Nuclear Society, Fuel Comparison: European Nuclear Society, https://www.euro￾nuclear.org/info/encyclopedia/f/fuelcomparison.htm, 2019, (Accessed: December 6, 
2021).
Kabir, E., Kumar, P., Kumar, S., Adelodun, A. A., Kim, K.-H., Solar energy: Potential and 
future prospects. Renewable and Sustainable Energy Reviews, 82, 894–900, 2018.
Madanayake, B. N., Gan, S., Eastwick, C., Ng, H. K., Biomass as an energy source in coal 
co-firing and its feasibility enhancement via pre-treatment techniques. Fuel Processing 
Technology, 159, 287–305, 2017.
Orumie, U. C., Ebong, D., A glorious literature on linear goal programming algorithms. 
American Journal of Operations Research, 4(2), 59–71, 2014.
Pérez-Fortes, M., Laínez-Aguirre, J. M., Bojarski, A. D., Puigjaner, L., Optimization of pre￾treatment selection for the use of woody waste in co-combustion plants. Chemical 
Engineering Research and Design, 92(8), 1539–1562, 2014.Multi-Objective Optimization for Energy Network Planning 219
Ramos, A., Monteiro, E., Silva, V., Rouboa, A., Co-gasification and recent developments on 
waste-to-energy conversion: A review. Renewable and Sustainable Energy Reviews, 81, 
380–398, 2018.
Rollan, C. D., Li, R., San Juan, J. L., Dizon, L. B., Ong, K. B., A planning tool for tree species 
selection and planting schedule in forestation projects considering environmental and 
socio-economic benefits. Journal of Environmental Management, 206, 319–329, 2018.
San Juan, J., Aviso, K., Tan, R., Sy, C., A Multi-objective optimization model for the design 
of biomass co-firing networks integrating feedstock quality considerations. Energies, 
12(12), 1–24, 2019. Doi:10.3390/en12122252.
San Juan, J., Sy, C., Multi-objective target-oriented robust optimization of biomass Co-firing 
networks under quality uncertainty. Journal of Sustainable Development of Energy, 
Water and Environment Systems, 9(2), 1–26, 2021.
Savic, D. Single-objective vs. Multi-objective Optimization for Integrated Decision Support. 
9th International Congress on Environmental Modelling and Software, 119, 7–12, 
2002.
Sinn, H., Buffering volatility: A study on the limits of Germany energy revolution. European 
Economic Review, 99, 130–150, 2017.
Sufyan, M., Rahim, N., Aman, M., Tan, C., Raihan, S., Sizing and applications of battery 
energy storage technologies in smart grid system: A review. Journal of Renewable and 
Sustainable Energy, 11(1), 014105–1-16, 2019.
U.S. Energy Information Administration, International Energy Outlook 2017(DOE/EIA￾0484(2017)). Retrieved January 2018, from U.S. Energy Information Administration: 
https://www.eia.gov/outlooks/ieo/pdf/0484(2017).pdf, 2017, (Accessed: April 15, 
2020).
Wan, C. Zhao, J., Song, Y., Zhao, X., Lin, J., Hu, Z., Photovoltaic and solar power forecast￾ing for smart grid energy management. Journal of Power and Energy Systems, 1(4), 
38–46, 2015.
Wang, G., Ciobotaru, M., Agelidis, V., Power smoothing of large solar PV plant using hybrid 
energy storage. IEEE Transactions on Sustainable Energy, 5(3), 834–842, 2014.
Winston, W. L. Operations Research: Applications and Algorithms (Vol. IV). Boston, MA: 
Cengage Learning, 2004.
Yang, H., Huang, C., Huang, Y., Pai, Y., A weather-based hybrid method for 1-Day ahead 
hourly forecasting of PV power output. IEEE Transactions on Sustainable Energy, 5(3), 
917–926, 2014.
Zandi Atashbar, N., Labadie, N., Prins, C., Modeling and optimization of biomass supply 
chains: A review and a critical look. IFAC-PapersOnLine, 49(12), 604-615, 2016.
Zeng, Y., Cai, Y., Huang, G., Dai, J., A Review on Optimization Modeling of Energy Systems 
Planning and GHG emission Mitigation under Uncertainty. Energies, 4(1), 1624–1656, 
2011.
Zerrahn, A., Schill, W., Kemfert, C., On the economics of electrical storage for variable renew￾able energy sources. European Economic Review, 108, 259–279, 2018.
APPENDIX 
Demand: The demand for electricity is based on the previous data given by the 2018 
power statistics from the Department of Energy (DOE) in the Philippines for the 
Luzon region. These were set by month to show the peak demand for electricity 
(Department of Energy Philippines, 2018).220 Optimization for Energy Systems and Supply Chains
Solar Battery: The figure below shows and displays a sample of overall costs and 
capacity for a solar energy battery with a capacity of 60-MV. These costs involve 
the maintenance, operational, and investment costs that were used within the model 
(Ran et al, 2018).
FIGURE A.1 Monthly system peak demand for power.
FIGURE A.2 Sample detailed cost breakdown for a lithium-ion solar battery.221
Index
A
aggregate production planning 133
B
biochar 52–65
designer biochar 53
biodiesel 56, 58. 64, 169–170, 175–176, 178
bioenergy 53–64, 169–172, 175–178
BTEX mitigation 116, 118
C
chilled water 9, 93–95, 98, 100–102, 104, 107
cogeneration 6, 8–9
conversion factor 20, 25, 107, 173
D
diesel 4, 94–96, 100–107
distributed energy systems 184
E
economic planning 162
economic structure 151
efficient ant colony optimization (EACO) 112
energy
final energy 4
primary energy 3–4, 6–8, 10, 12, 17
secondary energy 4–6, 12, 97
G
global warming 202
glycerine pitch 94–95, 101–107
greenhouse gas (GHG) 3, 153, 156, 160–162, 
202–204
H
hybrid renewable energy system 76, 82
hydrogen 10, 47, 56, 58, 61–62, 64, 74–77, 82–89
I
input-output analysis 151–152
input-output model 152–156, 162
L
land use change 170, 172, 174–178
Leontief system 151, 153, 157, 162
linear programming (LP) 31
LINGO 21, 25, 29, 31, 33, 68, 70, 101, 156–158, 
160, 162, 177
M
mathematical model, 15–16, 19–22, 25, 38, 42, 
46–47, 54, 59, 95, 134, 138, 141, 169, 
171, 177–178, 183, 202
optimization model 78, 80, 87, 95, 136, 140, 
142, 152, 162, 202–203, 205, 211, 
214, 218
mathematical optimization 13, 15–16, 19, 22, 38, 
80, 94
mathematical programming 53, 134, 162
microgrid 74, 182, 185, 187
mixed-integer linear programming (MILP) 
53–54, 64–65, 75, 77
mixed-integer non-linear programming (MINLP) 
95, 101, 107, 183
multi-objective optimization 22, 112, 115, 117, 
120–121, 123, 134, 152, 203
N
natural gas processing 111, 114, 117, 127
near-optimal solutions 55, 59, 63, 65
negative carbon footprint 53, 64
non-linear programming (NLP) 38, 101, 117, 129, 
134, 136, 143, 156, 162
O
optimal allocation 153
P
Pareto frontier Analysis 77, 80, 84, 86–87, 
114–116, 118–119, 121, 123–129
p-graph or process-graph 21, 75, 80–81, 83–84, 
86–88
plantation expansion 170, 172, 174–175, 177–179
polygeneration 6, 10, 12, 93–107
power plant 6–8, 106, 152–153, 161, 170, 204222 Index
process systems engineering 13, 15–16, 21, 42
production planning 133, 137
R
renewable energy 3–4, 6, 10, 12, 74–77, 82, 89, 
94, 182–183, 202, 204–206, 208, 215
robust multi-objective optimization (RMOO), 
112–114, 117–119, 120, 129
S
simulation 77, 81, 89, 112–113, 116–117, 119, 
123–124, 127, 202
solar energy 94, 204–211, 213, 215–218
superstructure, 16–23, 25, 38, 63, 89, 94–95, 101, 
107, 171–172, 175–176, 184–186
supply chain 4–6, 13, 15, 33, 38, 152, 169–172, 
175–176, 178, 182, 194, 196, 202
support vector regression (SVR) 112, 116
steel industry 142
T
TEG dehydration 112–115, 129
TOPSIS 77, 80, 84, 86–88
trigeneration 6, 8–10
U
uncertainty (or uncertainties) 20, 89, 112–113, 
117, 120, 127, 129, 133–146
W
waste heat 75–76, 82, 87
wastewater treatment 6–9, 94–95, 98, 100, 
102, 108
