❦
❦ ❦
❦
Multiphase Transport of Hydrocarbons in Pipes❦
❦ ❦
❦❦
❦ ❦
❦
Multiphase Transport of Hydrocarbons in
Pipes
Juan J. Manzano-Ruiz
PetroConsulting and Associates
USA
Jose G. Carballo
USA❦
❦ ❦
❦
Copyright © 2024 by John Wiley & Sons Inc All rights reserved.
Published by John Wiley & Sons, Inc., Hoboken, New Jersey.
Published simultaneously in Canada.
No part of this publication may be reproduced, stored in a retrieval system, or transmitted
in any form or by any means, electronic, mechanical, photocopying, recording, scanning,
or otherwise, except as permitted under Section 107 or 108 of the 1976 United States
Copyright Act, without either the prior written permission of the Publisher, or
authorization through payment of the appropriate per-copy fee to the Copyright
Clearance Center, Inc., 222 Rosewood Drive, Danvers, MA 01923, (978) 750-8400, fax
(978) 750-4470, or on the web at www.copyright.com. Requests to the Publisher for
permission should be addressed to the Permissions Department, John Wiley & Sons, Inc.,
111 River Street, Hoboken, NJ 07030, (201) 748-6011, fax (201) 748-6008, or online at
http://www.wiley.com/go/permission.
Trademarks: Wiley and the Wiley logo are trademarks or registered trademarks of
John Wiley & Sons, Inc. and/or its affiliates in the United States and other countries and
may not be used without written permission. All other trademarks are the property of
their respective owners. John Wiley & Sons, Inc. is not associated with any product or
vendor mentioned in this book.
Limit of Liability/Disclaimer of Warranty: While the publisher and author have used
their best efforts in preparing this book, they make no representations or warranties with
respect to the accuracy or completeness of the contents of this book and specifically
disclaim any implied warranties of merchantability or fitness for a particular purpose.
No warranty may be created or extended by sales representatives or written sales
materials. The advice and strategies contained herein may not be suitable for your
situation. You should consult with a professional where appropriate. Further, readers
should be aware that websites listed in this work may have changed or disappeared
between when this work was written and when it is read. Neither the publisher nor
authors shall be liable for any loss of profit or any other commercial damages, including
but not limited to special, incidental, consequential, or other damages.
For general information on our other products and services or for technical support,
please contact our Customer Care Department within the United States at (800)
762-2974, outside the United States at (317) 572-3993 or fax (317) 572-4002.
Wiley also publishes its books in a variety of electronic formats. Some content that
appears in print may not be available in electronic formats. For more information about
Wiley products, visit our web site at www.wiley.com.
Library of Congress Cataloging-in-Publication Data:
Names: Manzano-Ruiz Juan, J., author. | Carballo, Jose G., author.
Title: Multiphase transport of hydrocarbons in pipes / Juan J.
Manzano-Ruiz, Jose G. Carballo.
Description: Hoboken, New Jersey : Wiley, [2024] | Includes index.
Identifiers: LCCN 2023057850 (print) | LCCN 2023057851 (ebook) | ISBN
9781119888512 (cloth) | ISBN 9781119888529 (adobe pdf) | ISBN
9781119888536 (epub)
Subjects: LCSH: Multiphase flow. | Hydrocarbons.
Classification: LCC TA357.5.M84 M36 2024 (print) | LCC TA357.5.M84
(ebook) | DDC 665.5/44–dc23/eng/20240128
LC record available at https://lccn.loc.gov/2023057850
LC ebook record available at https://lccn.loc.gov/2023057851
Cover Design: Wiley
Cover Image: © Hirkophoto/Getty Images
Set in 9.5/12.5pt STIXTwoText by Straive, Chennai, India❦
❦ ❦
❦
To my Parents Juan Vicente and Carmen Teresa; my wife Lucy; my children
Juan Carlos, Anabella, Andres Simon, and Raul Rodrigo; my beloved
grandsons Juan Diego and Marcelo; my siblings Liliana and Juan Vicente;
and my in-laws
August 2023 Juan J. Manzano-Ruiz
To my beloved wife Mariale; my cherished son Benjamin; and my parents
Gilberto and Nicole
August 2023 Jose G. Carballo❦
❦ ❦
❦❦
❦ ❦
❦
vii
Contents
Preface xv
About the Authors xvii
Acknowledgments xix
Nomenclature xxi
About the Companion Website xxix
1 Introduction 1
1.1 What Is Multiphase Flow 1
1.2 Single- and Multicomponent Fluids 3
1.3 Challenges to Model Multiphase Flow 4
1.3.1 Experiments and Scale-up 4
1.3.2 Multidimensional Fluid Flows 5
1.3.3 Time Fluctuations 6
1.3.4 Slow Transients 6
1.3.5 Compositional Simulation 7
1.4 Hydrocarbon Flow 7
1.5 Modeling Approaches 8
References 9
2 Fundamentals of Multiphase Flow 11
2.1 Multiphase Flow in the Production of Oil and Gas 11
2.2 Multiphase Flow Concepts 15
2.2.1 Void Fraction and Hold-up 15
2.2.2 Phase Velocity, Slip Factor, and Volumetric Flow 16
2.2.3 Volumetric Flux and Superficial Velocities 17
2.2.4 Density 18
2.2.5 Mass Flows 18
2.2.6 Mass Velocity 19
2.2.7 Mass Quality and Volumetric Quality 19❦
❦ ❦
❦
viii Contents
2.2.8 Drift Velocities and Drift Fluxes 19
2.3 Modeling Strategy 20
2.3.1 Area Averaging and One-dimensional Flow 20
2.3.2 Pseudo-steady Flow 20
2.3.3 Time Averaging of Turbulent Fluctuations 21
2.3.4 Mechanistic Approach 21
2.3.5 Boundary and Initial Conditions 21
2.3.6 Boundary-value and Marching-scheme Strategies 22
2.3.7 Closure Equations 23
2.4 Two-Phase Flow Measurements 23
2.4.1 Well Testing and Production Allocation 23
2.4.2 Multiphase Flow Meter (MPFM) and Field Application 24
2.4.3 Density Meters 27
2.4.4 Void Fraction Meters 28
2.4.5 Momentum Flux Meters 28
2.4.6 Flow Pattern Identification 28
2.4.7 Uncertainty in Multiphase Flow Measurement 29
2.5 Future Measuring Trends 30
References 31
3 Hydrocarbon Fluid Properties and
Thermodynamics 33
3.1 Phase Behavior 33
3.1.1 Empirical Data 33
3.1.2 Pure Compound Phase Behavior 35
3.1.3 Binary Systems 36
3.1.4 Multicomponent Fluid Phase Behavior 36
3.2 Physical Properties 39
3.2.1 Gas Compressibility Factor 39
3.2.2 Gas and Oil Density 41
3.2.3 Gas, Oil, and Water Viscosity 43
3.2.4 Solution Gas Ratio (Rs) 44
3.2.5 Bubble Point 45
3.2.6 Oil Formation Volume Factor (Bo) 46
3.2.7 Gas Formation Volume Factor (Bg) 47
3.3 Equation of State (EOS) 47
3.3.1 Ideal Gas 48
3.3.2 Van der Waals 49
3.3.3 Benedict–Webb–Rubin 49
3.3.4 Redlich–Kwong 50
3.3.5 Peng–Robinson 50❦
❦ ❦
❦
Contents ix
3.3.6 Other Equations of State 51
3.3.7 Equilibrium and Fugacity Coefficient 51
3.3.8 Mixing Rules 52
3.4 C7
+ Characterization 53
3.5 Thermal and Transport Properties 54
3.5.1 Enthalpy 54
3.5.2 Heat Capacity 55
3.5.3 Joule–Thomson Coefficient 56
3.5.4 Speed of Sound 56
3.5.5 Thermal Conductivity 57
3.5.6 Surface Tension 57
3.6 Types of Hydrocarbon Fluids 57
3.6.1 Black Oils 57
3.6.2 Volatile Oils 58
3.6.3 Retrograde Gas Condensate 59
3.6.4 Wet Gas 59
3.6.5 Dry Gas 61
3.7 PVT Analyses 61
3.7.1 Constant Composition Expansion (CCE) 62
3.7.2 Constant Volume Depletion (CVD) 62
3.7.3 Differential Liberation (DL) 63
3.7.4 Separator Test 64
3.7.5 Viscosities 64
3.8 Strategy for Modeling Fluid Properties 65
3.8.1 Compositional versus Tabular 65
3.8.2 EOS or Black Oil Models 66
3.8.3 Blending of Different Streams 66
3.9 Commercial Software 67
References 67
4 Multiphase Flow Patterns 69
4.1 Gas–Liquid Flow 69
4.2 Dispersed versus Separated Flow Regimes 70
4.3 Vertical and Inclined Flow Maps 71
4.4 Quasi-Horizontal Flow Maps 72
4.5 Liquid–Liquid Flow Map 77
4.6 Three-Phase Flow 78
4.7 Liquid–Solid Flow 79
4.8 Gas–Solid Flow 81
4.9 Conclusions 82
References 82❦
❦ ❦
❦
x Contents
5 Two-Phase Flow in Pipelines 85
5.1 Introduction 85
5.2 Conservation Principles 85
5.2.1 Local Instantaneous Equations 86
5.3 Space-Averaged Equations 89
5.4 Time-Averaged Equations 91
5.5 Composite-Averaged Equations 92
5.6 Two-Fluid Model (TFM) 93
5.6.1 OLGA® Software (SLB) 94
5.7 Constitutive Equations 96
5.8 One-Dimensional Modeling 97
5.9 Homogeneous Equilibrium Model (HEM) 98
5.10 Separated Flow Model 99
5.11 Kinematic Models 101
5.11.1 Bankoff Model (1960) 101
5.11.2 Zuber–Findlay Model (1965) 102
5.11.3 Drift–Flux Model (DFM) 103
5.12 Mechanistic/Phenomenological Models 105
5.13 Empirical Models 107
5.13.1 Flanigan Model (1958) 107
5.13.2 Beggs and Brill Model (1973) 108
5.13.3 Void Fraction Empirical Models 111
5.14 Computational Fluid Dynamics (CFD) 111
References 112
6 Two-Phase Flow in Wells 117
6.1 Introduction 117
6.2 Reservoir Boundary Conditions 118
6.2.1 Well Production String: Vertical, Inclined, and Horizontal
Wells 118
6.3 NodalTM Analysis 120
6.4 Wells Cluster and Manifolds 121
6.5 Water and Gas Coning 124
6.6 Legacy Models 125
6.6.1 Poettmann–Carpenter Model (1952) 126
6.6.2 Griffith–Wallis Model (1961) 126
6.6.3 Duns–Ros Model (1963) 129
6.6.4 Hagedorn–Brown Model (1965) 133
6.6.5 Orkiszeski Model (1967) 136
6.6.6 Beggs–Brill Model (1973) 137
6.6.7 Gray Model (1978) 137❦
❦ ❦
❦
Contents xi
6.6.8 Mukherjee and Brill Model (1985) 138
6.7 Mechanistic Models for Well Flow 141
6.7.1 Ansari et al. Model (1994) 141
6.7.2 Unified Mechanistic Models 144
6.7.3 Hasan and Kabir Model (2002) 144
6.8 Comparison of Flow Models 147
6.9 Severe Slugging Phenomenon 148
6.10 Gas Lift 151
References 151
7 Two-Phase Flow Through Restrictions and Piping
Components 155
7.1 Introduction 155
7.2 Flow Through Restrictions 155
7.3 Critical Flow 156
7.4 Choke Valves 159
7.5 Sudden Pipe Enlargement 164
7.6 Sudden Pipe Contraction 165
7.7 Flow Orifice 166
7.8 Gate and Globe Valves 167
7.9 Elbows and Bends 168
7.10 Tee Junctions and Manifolds 168
References 171
8 Two-Phase Flow Thermal Modelling 173
8.1 Introduction 173
8.2 Normal and Transient Operation 174
8.3 Offshore and Onshore Pipelines 174
8.4 Heat Transfer Mechanisms 175
8.5 Internal Heat Transfer Coefficients 176
8.5.1 Turbulent Flow Forced-convection Inside Tubes 176
8.5.2 Laminar Flow Forced convection Inside Tubes 177
8.5.3 Two-phase Disperse bubble Flow in Horizontal Pipe 177
8.5.4 Two-phase Stratified Flow in Horizontal Pipe 178
8.5.5 Two-phase Slug flow in Horizontal Pipe 178
8.5.6 Natural Convection in a Stagnant Fluid Within a Horizontal
Pipe 179
8.5.7 Forced Convection in Vertical Two-phase Flow 180
8.6 External Heat Transfer Coefficient 180
8.7 Thermal Insulation 181
8.8 Overall Heat Transfer Coefficient (OHTC) 183❦
❦ ❦
❦
xii Contents
8.9 Buried Pipelines 187
8.10 Temperature Profile 189
8.11 Flowline Cooldown 193
8.12 Document Navigation Heat Transfer in the Wellbore 194
References 197
9 Advanced Simulations 199
9.1 Introduction 199
9.2 Nature of Transient Flow 200
9.3 Transient Flow Applications 202
9.4 Transient Modeling Challenges 204
9.5 Current Weaknesses of Simulating Two-Phase Flow in
Pipelines 205
9.6 Future of Two-Phase Flow Simulations 207
9.7 Simulation Philosophies 214
References 214
10 Multiphase Flow Simulations 217
10.1 Introduction: Simulation Challenges 217
10.1.1 Mathematical Models for Two-Phase Flow Simulation 217
10.1.2 Challenges in Two-Phase Flow Simulation 218
10.1.3 Results Validation 218
10.2 Multiphase Flow Simulation Considerations 220
10.2.1 Integration Time Step 220
10.2.2 CFL Condition 221
10.2.3 Round-off Error 221
10.2.4 Geometry Representation 222
10.2.5 Cell-Size Ratio - the Ratio of “2” 222
10.2.6 Dispersion Effects 223
10.2.7 Constant Composition Versus Compositional Simulation 223
10.2.8 Initial Conditions 224
10.2.9 Deepwater Settings 224
10.3 Multiphase Flow Applications 225
10.4 Production Wells Simulation 225
10.4.1 Onshore Well Operating in Steady State 227
10.4.2 Onshore Well Initial Start-up Example 229
10.4.3 Onshore Well Shutdown Example 235
10.5 Offshore Flowlines 236
10.5.1 Offshore Flowline Simulations in Steady State 238
10.5.2 Oil Flowline System in a Steady-State Example 239
10.5.3 Offshore Flowline Transient Simulations 242❦
❦ ❦
❦
Contents xiii
10.5.4 Slugging Example 244
10.5.5 Hydrodynamic Slugging Example 244
10.5.6 Severe Slugging Example 245
10.5.7 Ramp-up and Ramp-down Operations 247
10.5.8 Offshore Flowline Ramp-down and Ramp-up Example 248
10.5.9 Cooldown Transient 249
10.5.10 Offshore Flowline Cooldown Example 249
10.5.11 Depressurization Operation 249
10.5.12 Offshore Flowline Depressurization Example 251
10.5.13 Blowdown (Flowline Rupture) Transient 254
10.5.14 Offshore Flowline Rupture Blowdown Example 256
10.5.15 Shutdown Operation 257
10.5.16 Offshore Flowline Planned Shutdown Example 258
10.5.17 Offshore Flowline Restart After Planned Shutdown
Example 261
10.5.18 Unplanned Shutdown and Dead Oil Circulation in Flowline
Loop 261
10.5.19 Offshore Flowline Loop with Hot Oil Circulation Example 264
10.5.20 Pigging Example 265
10.6 Summary 270
References 271
11 Fluid–Solid Transport 273
11.1 Characteristics of Solid–Fluid Flow 274
11.2 Fundamental Equations 276
11.2.1 Mixture Density 276
11.2.2 Fluid Phase Mass Conservation 276
11.2.3 Solid-Phase Mass Conservation 276
11.2.4 Solid–Fluid Mixture Mass Conservation 277
11.2.5 Mixture Momentum Equation 277
11.2.6 Dilute Suspensions in Turbulent Flow 277
11.3 Simplified Horizontal Flow Models 277
11.3.1 Homogeneous Flow Model 278
11.3.2 Heterogeneous Flow Model 279
11.4 Minimum Deposit Velocity 282
11.5 Sand Production 283
11.6 Sand Distribution 284
11.7 Pipe Erosion and Erosional Velocity 285
11.8 Application Examples 286
References 287❦
❦ ❦
❦
xiv Contents
A Multiphase Flow Software Tools 289
A.1 Thermodynamics and Transport Properties Simulators 289
A.1.1 Pvtsim Nova® 290
A.1.2 Multiflash® 291
A.1.3 Aspen Hysys® 291
A.1.4 Refprop® 292
A.1.5 Pvtp® 293
A.1.6 Dwsim® 293
A.2 Steady-State Multiphase Simulators 294
A.2.1 Pipesim® 294
A.2.2 Gap® and Prosper® 295
A.2.3 Olga-S® (SLB) 296
A.2.4 Pipephase® 297
A.3 Transient Multiphase Simulators 297
A.3.1 Olga® 297
A.3.2 LedaFlow® 299
A.3.3 Gap Transient 300
Index 301❦
❦ ❦
❦
xv
Preface
Welcome to Multiphase Flow in Pipelines, an in-depth journey into the
subject of the co-current flow of gas, liquids, and solids resulting from the
production of hydrocarbons from underground reservoirs. This book is
designed to be a comprehensive guide for both novices and experts seeking
to gain a profound understanding of the core principles, best practices, and
cutting-edge advancements in the realm of multiphase flow.
In today’s fast-paced and ever-evolving technological landscape, staying
ahead of the curve is vital for engineers, technicians, and students alike. The
purpose of this book is to provide you with the practical knowledge and tools
needed to understand field operations or to participate in projects to develop
new fields.
We have chosen a variety of topics, blending theory, and practice, illus￾trated with examples taken from real projects. This book could be helpful
to students embarking on an educational journey or to seasoned practition￾ers aiming to sharpen skills by understanding the first principles underlying
the fluid flow and heat transfer models built into the commercial software
available.
Key features of this book include the following:
Coverage: We explore all fundamental concepts and advanced topics
related to multiphase flow in pipes that could add value to real projects
or improve production performance. From basic models to the most
intricate aspects, each chapter builds upon the previous one to foster a solid
understanding.
Real-world applications: We believe in bridging the gap between theory
and practice. As such, every concept discussed within these pages is accom￾panied by real-world applications, and examples to illustrate how the knowl￾edge can be put to use effectively.
References: We include key references that provide in-depth knowledge
supporting the material presented in each chapter.❦
❦ ❦
❦
xvi Preface
Future horizons: A brief introductory chapter is included expressing the
authors’ views regarding potential technology evolution into the world of
artificial intelligence, machine learning, data science, and artificial neural
networks, with the humble hope that the reader may be initiated in the bril￾liant future developments in these amazing fields.
We encourage you to approach this book with curiosity, determination,
and an open mind. Our hope is that the book triggers your interest in the
transport of hydrocarbons through pipelines and empowers you to explore,
innovate, and make significant contributions to the field. Should you have
any feedback, questions, or suggestions, we look forward to your correspon￾dence. Please refer to the companion website for color graphs included in
this book.
2024, Katy Juan J. Manzano-Ruiz
Texas Jose G. Carballo❦
❦ ❦
❦
xvii
About the Authors
Juan J. Manzano-Ruiz, M.Sc., M.E., Ph.D., P.E., is a mechanical engineer
by background, who gathers 40-plus years of experience in the energy
industry, holding leadership and executive managerial positions with
PdVSA-Intevep, BP-Amoco, Jacobs Engineering, Technip, and Bechtel O,
G, and C. He earned three diplomas from the Massachusetts Institute of
Technology and completed an MBA minor from the Sloan School of MIT.
He taught undergraduate and graduate engineering courses for 16 years
at universities in Caracas, Venezuela. He is currently a consultant and
President of Petroconsulting and Associates LLC in Texas, USA (Email:
petroconsultingllc@gmail.com).
Jose G. Carballo, M.Sc., P.E., is a flow assurance and hydraulics
engineer, with 20 years of experience consulting for the energy industry.
He is currently Vice President of FlowAssure Engineering in Texas, USA
(Email: jose@flowassureng.com).❦
❦ ❦
❦❦
❦ ❦
❦
xix
Acknowledgments
In the first place, I acknowledge the organizations that allowed me to
learn and gain field experience in the subject of multiphase flow. These
remarkable organizations include PdVSA-Intevep, BP-Amoco Venezuela,
Jacobs Engineering, Technip, and Bechtel Oil, Gas, and Chemicals. The
positions held at these organizations exposed me to practical situations
comprising research and development, projects, field operations, and facili￾ties construction. Thanks to such experiences I had the immense privilege
of applying lessons learned from four giants in this field, namely Prof.
Pete Griffith, the key advisor for my doctoral thesis at MIT; Dr. Jean-Marc
Delhaye, a legend in the most rigorous analyses in this discipline; the late
Prof. “Abe” Dukler; and Prof. Yehuda Taitel, who were the pioneers of the
modern mechanistic methodology.
To my friend and co-author in this endeavor, Jose G. Carballo, M.Sc.,
P.E., who deserves the greatest acknowledgment for his work, thanks to his
valuable 20 years of project experience, fine skills performing difficult sim￾ulations with commercial code, his ability to simplify field conditions, and
for his great character and integrity. It has been a real pleasure working with
Jose, who was my undergraduate student almost three decades ago.
I was extremely lucky to have a huge technical and editorial review collab￾oration in this book from Maria A. Nass, M.Sc., P.E., MBA, who happens
to be Jose’s wife. Maria has a long-standing and successful career in projects
requiring advanced multiphase flow knowledge, while holding positions for
Total, BP p.l.c., and currently for Subsea 7. Many thanks, Maria, for your
outstanding contributions.
On a personal level, this work could not have been even attempted with￾out the loving, permanent, and unconditional support from my family for
the past two and a half years. Their time sacrifices do not go unrecognized❦
❦ ❦
❦
xx Acknowledgments
because their backing was the true driver to bring this book to fruition.
My endless love and heartfelt recognition to them all.
Juan J. Manzano-Ruiz,
Katy, Texas
I wish to convey my sincere appreciation to my dear friend, esteemed men￾tor, and lead author, Dr. Juan J Manzano-Ruiz, for graciously involving me
in this project, and for his exceptional dedication in sharing his wealth of
knowledge and expertise that has been instrumental in bringing this book
to fruition.
Additionally, I express my sincere gratitude to my wife Mariale for her
contribution to reviewing this text.
Jose G. Carballo
Katy, Texas❦
❦ ❦
❦
xxi
Nomenclature
List of Symbols
SI units FPS units
A Cross-sectional area m2 ft2
B Formation volume factor m3/sm3 bbl/stb
c Speed of sound m/s ft/s
csolid Volumetric concentration of
solids
% vol. % vol.
C Empirical constant of
erosional velocity
kg1/2/s.m1/2 lb1/2/s.ft1/2
Cp Specific heat coefficient at
constant pressure
J/Kg K Btu/lbmF
CV Valve’s flow coefficient gpm/psi0.5
d Pipe internal diameter m Inch
D Pipe external diameter m inch
Dh Hydraulic diameter m Inch
e Fluid internal energy J/kg Btu/lbm
f Friction factor — —
g Gravitation acceleration m/s2 ft/s2
gc Force–mass conversion factor — 32.17 lbm ft/lbf s2
G Mass velocity kg/m2 s lbm/ft2 h
GOR Gas–oil ratio at standard
conditions
sm3/sm3 scf/stb
h Fluid enthalpy J/kg Btu/lbm
hf Friction head m ft
(Continued)❦
❦ ❦
❦
xxii Nomenclature
SI units FPS units
hi Internal heat transfer
coefficient
W/m2 K Btu/hr ft2 F
hL Depth of liquid in stratified
flow
m ft
H Enthalpy J/kg Btu/lbm
HFT Hydrate formation
temperature
∘C or ∘K ∘F or ∘R
HL Liquid holdup — —
ID Internal diameter mm inch
j Superficial velocity,
volumetric flux
m/s ft/s
j
lg Slip drift flux m/s ft/s
k Thermal conductivity W/m K Btu/h ft R
L Pipeline length m ft
m Mass flow rate kg/s or kg/h lbm/h
M Amount of mass kg lbm
MW Molecular weight kg/kgmol lbm/lbmol
n Number of moles in ideal gas
model
— —
p Pressure Pa,abs or bara psia
Pi Phase-to-phase contact
interface
m inch
Pw Wet (in contact with pipe
wall) perimeter
m inch
q” Heat flux per unit area W/m2 Btu/h ft2
Q Flow rate m3/s ft3/s
Q Heat flow rate W Btu/h
R Gas universal constant J/kgmol K lbf ft/lbmol R
R Specific gas constant J/kg K lbf ft/lbm R
Rs Solution gas ratio sm3/sm3 scf/stb
s Entropy J/kg K Btu/lb F
S Slip factor — —
S Specific gravity — —
Sg Wet perimeter of gas phase m inch
SHT Heat transfer shape factor m ft
Si Perimeter of gas–liquid
interface
m inch
Sl Wet perimeter of liquid phase m inch❦
❦ ❦
❦
Nomenclature xxiii
SI units FPS units
S Salinity % w. % w.
t Time s s
T Temperature ∘C or ∘K ∘F or ∘R
u Actual fluid velocity m/s ft/s
V, v Volume m3 ft3
V M Volume of one molecular
weight
m3 ft3
yc Critical pressure ratio (orifice) — —
yi Molar fraction of component
“i” in gas phase
% m. % m.
x Mass quality — —
x Direction of change for 1-D
models
m ft
xi Molar fraction of component
“i” in liquid phase
% m. % m.
z Elevation (vertical)
coordinate
m ft
Zc Compressibility factor — —
zi Molar fraction of component
“i” in the feed
% m. % m.
Abbreviations
AERE Atomic Energy Research Establishment, Harwell, Oxfordshire, UK
AGA American Gas Association, Washington, D.C., USA
ANS American Nuclear Society, Illinois, USA
API American Petroleum Institute, Washington, D.C., USA
ASME American Society of Mechanical Engineers, New York, N.Y., USA
bbl, bbls barrels at local conditions
bpd,blpd barrels of liquid per day
bopd barrels of oil per day
CAPEX capital expenditures
CD cooldown transient
CS control surface
CV control volume
DC drill center
DOC dead-oil circulation
(Continued)❦
❦ ❦
❦
xxiv Nomenclature
EOS equation of state
EVR erosion velocity ratio
FPSO Floating Production Storage and Offloading Vessel
gpm U.S. gallons per minute
GPSA Gas Processors Suppliers Association, Tulsa, OK, USA
HC Hydrocarbons
HOC hot-oil circulation
IPR inflow performance relationship
mscfd thousands of standard cubic feet per day
mmscfd millions of standard cubic feet per day
ODE ordinary differential equation
OHTC overall heat transfer coefficient
OPEX operational expenditures
PDE partial differential equation
ppg density expressed in pounds per gallon
R&D research and development
scf cubic feet @ standard conditions
SPS subsea production system
stb barrels of liquid @ stock-tank conditions
TOTEX combined CAPEX and OPEX expenditures
TPR tubing performance relationship
TUFFP Tulsa University Fluid Flow Projects, Tulsa, OK, USA
USC upstream of choke condition
VIT vacuum insulated tubing
VLP vertical lift performance
WC water cut
Dimensionless Groups
Fr Froude number, V/(gL)0.5
Gr Grashof number, L3𝜌2𝛽g𝛥T/𝜇2
Nu Nusselt number, hD/k
Pr Prandtl number, cp𝜇/k
Ra Rayleigh number, g𝛽𝛥Td3/(𝜇/𝜌)
2
Re Reynolds number, 𝜌DV/𝜇❦
❦ ❦
❦
Nomenclature xxv
Greek Letters
SI units FPS units
𝛼 void fraction — —
𝛽 volumetric quality — —
𝛽s isentropic compressibility Pa−1 psi−1
𝜒 Lockhart–Martinelli parameter — —
𝛾 specific gravity — —
𝛤 volumetric mass transfer rate kg/m3 s lbm/ft2 hr
𝛿 layer thickness or property increment mm inch
𝛿 increment of a parameter — —
𝛥 change in a property
𝜀 wall roughness mm inch
𝜂 efficiency — —
𝜂 Joule–Thomson coefficient K/Pa F/psi
𝜂 apparent viscosity of non-Newtonian fluid s Pa cP
𝜃 inclination with respect to horizontal direction radian radian
𝜇 dynamic viscosity s Pa cP
𝜐 specific volume m3/kg ft3/lbm
𝜉 isentropic expansion coefficient — —
𝜋 Pi number 3.1416 3.1416
𝜌 density kg/m3 lbm/ft3
𝜎 surface tension N/m dyne/cm
𝜏 shear stress Pa psi
𝜏 time sec sec
𝜑 two-phase multiplier — —
𝜑 fugacity coefficient — —
𝜙 subtended angle in stratified horizontal flow radian radian
𝜔 acentric factor — —❦
❦ ❦
❦
xxvi Nomenclature
Subscripts
a air phase
acc acceleration
b bubble point, bubble
coat coating conductance or resistance
ch choke
crit, c critical condition
CS control surface around a control volume
CV control volume
D-W Darcy–Weisbach friction factor
ext external heat transfer to environment
f, fric friction
f fluid
fric friction component
F fanning friction factor
G, g, gas gas phase
geoth geothermal gradient
grav gravitation
h hydraulic diameter
H homogeneous model
HC hydrocarbon
HT heat transfer
i interface
int internal heat transfer
𝓁 axial pipeline direction
L, l, liq liquid phase
m, mix mixture
o, oil oil phase
p pipe
pc pseudo-critical
pr pseudo-reduced
r radial direction
r reduced condition for pressure or temperature
s, solid solid phase
(Continued)❦
❦ ❦
❦
Nomenclature xxvii
s slip, slip velocity
S superficial flow (based on overall cross-section)
stag stagnation (rest) condition
std standard conditions: 15.56 ∘C and 1.01325 bara
total total thermal conductance or resistance
w water phase
wf downhole well flowing
wh wellhead
W pipe’s internal wall surface
x axial pipeline direction
z vertical (gravity) direction
1 inlet conditions
2 outlet conditions
Superscripts
′′ double prime: property per unit flux area
– bar above variable: time average over a period❦
❦ ❦
❦❦
❦ ❦
❦
xxix
About the Companion Website
This book is accompanied by a companion websites.
www.wiley.com/go/Manzano-Ruiz/Multiphasetransport
The website includes:
● Coloured Figures❦
❦ ❦
❦❦
❦ ❦
❦
1
1
Introduction
1.1 What Is Multiphase Flow
Multiphase flow means the simultaneous transport of matter in the form
of liquids, gases, solids, or any combination of these. The coexistence of
at least two of these phases poses a complex time-dependent topology to
describe even in the simplest cases. The spatial distribution of phases adopts
the form of droplets, bubbles, solid particles, films, and chunks of liquids in
an ever-changing process (time-dependent), determining the transfer phe￾nomena of mass, species, thermal energy, and momentum. Figure 1.1 shows
a sketch of typical flow patterns in horizontal flow.
Figure 1.1a corresponds to an evaporating liquid flowing from left to
right. Figure 1.1b shows separated flows with distinctive continuous phases.
Figure 1.1c shows dispersed flows of either bubbles in liquids or droplets in
gas. Needless to say the current state of the art in multiphase pipeline flow
modeling requires several approximations and simplifications.
An effortless way to tackle the topology conundrum is to identify
flow regimes that show similar patterns and characteristics with a set
of boundaries expressed in terms of key parameters or non-dimensional
groups. Many flow pattern maps are available in the two-phase (gas–liquid)
flow literature aimed to predict different flow orientations, that is,
quasi-horizontal, vertical upward and downward, and inclined flow
upward and downward. Chapter 4 of this book reviews the principal flow
pattern maps proposed.
Multiphase flow in hydrocarbon production systems may include various
phases, namely oil, gas, produced water, and solids (e.g. sand fines, asphal￾tene, and wax). In this book, the approach is to consider a single liquid phase
made up of oil and produced water. Comprehensive coverage of solid–gas or
Multiphase Transport of Hydrocarbons in Pipes, First Edition.
Juan J. Manzano-Ruiz and Jose G. Carballo.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
Companion Website: www.wiley.com/go/Manzano-Ruiz/Multiphasetransport❦
❦ ❦
❦
2 1 Introduction
Liquid
Liquid Liquid droplets or solid particles
Gas
Liquid droplets
Liquid
Gas bubbles
Vapour bubbles
(a)
(b)
(c)
Gas Gas Liquid Gas
Figure 1.1 Two-phase flow in horizontal flowline.
solid–liquid transport in pipelines is beyond the scope of this book. However,
a very brief introduction to the field of solid–fluid transport is included in
Chapter 11. Thus, the main focus of this book is on two-phase gas–liquid
flow.
Another important characteristic of multiphase flow is phase slippage,
easily distinguished when an integral modeling approach is adopted. The
differences in phases’ velocities cause flow instabilities, flow regime transi￾tions, and enhanced transport phenomena at the interfaces.
In this book, the one-dimensional methodology is followed. This means
that conservation principles and closure equations will be expressed
with equations aligned to the pipeline axis. This simplification stems
from the cross-sectional integral application to obtain representative
one-dimensional (1-D) properties and parameters for each phase. Such a
methodology, on the one hand, simplifies the governing set of equations
but, on the other hand, introduces the need for additional closure equations
to account for the phases’ interactions.❦
❦ ❦
❦
1.2 Single- and Multicomponent Fluids 3
1.2 Single- and Multicomponent Fluids
Multiphase flow is present in the steam–water phases of the boiling water
reactors (BWR, Figure 1.2) of the nuclear industry, for which intense R&D
work has been done during the past 70 years. Introduction to the field of
nuclear power generation utilizing the technology of BWR can be found in
the texts by Lahey and Moody (1993) and Tong and Tang (1997). The boiling
water within the BWR experiences a variety of successive changes in flow
regime, ranging from bubble, plug, slug, churn, annular, and misty flow,
inside vertical tubes. There is inclusive a possibility to have reverse liquid
flow within the tubes, a phenomenon known as flooding.
Due to advances in the nuclear power generation industry, the study of
single-component two-phase flow has enjoyed impressive R&D financing,
producing a wealth of valuable experimental data and proposed models to
match the data.
Vapor–liquid phases are also present in evaporators and condensers of
a mechanical refrigeration system. Flows of steam and hot water are also
observed in oilfield distribution systems to stimulate heavy-oil production
(enhanced oil recovery technique). All these examples have in common that
working fluid is a simple substance with well-known properties, described
by simple thermodynamics relationships.
Cooling tower
Water pool
Reactor
core and
control
rods
Containment
structure
Steam line
Feedwater pump
Stream
turbine
Demineralized
water
Generator
Cooling water
Stream
condenser
Transmission lines
G
Boiling water reactor
Figure 1.2 Boiling water reactor with steam–water flow.❦
❦ ❦
❦
4 1 Introduction
Multicomponent mixtures are completely different fluids from the
standpoint of the thermodynamics description and mathematical handling.
The common hydrocarbon produced from a reservoir comprises thousands
of single components, subject to attraction and repulsion intermolecular
forces. The prediction of fluid thermodynamic and transport properties is in
general a challenge in comparison to a single-component system. Chapter
3 addresses the challenges and issues of compositional models required to
describe the flow performance of hydrocarbons in pipeline systems.
1.3 Challenges to Model Multiphase Flow
This section summarizes the majority of the challenges experienced in
attempting to predict the two-phase flow performance of oil and gas
through a production system. As pointed out before, the flow topology
and the complexity of the phases’ interaction hinder rigorous analysis, for
which available simplified models provide approximate answers in many
situations. A brief comment on the primary challenges follows.
1.3.1 Experiments and Scale-up
The need to add closure equations to complement the conservation prin￾ciples still requires laboratory testing to generate reliable data. The issue
with lab testing is threefold: test fluid(s), pressure, and scale. Traditional
modeling fluids at the test labs have been air and water because of cost,
availability, and safety. Most flow pattern maps were developed using
air–water mixtures at different mass ratios to cover a wide range of fluid
velocities in vertical and horizontal flow. Unfortunately, the fluid properties
of air–water mixtures are quite different from the fluid properties of oil
and natural gas, requiring property-scaling parameters or mechanistic
approaches to make use of the experimental data.
Very few data at high pressure and field-size piping are available to
validate the two-phase flow models for hydrocarbon transport applications.
Proprietary databases obtained from hydrocarbon flow at field conditions
have been gathered with the financial support of the members of joint
industry projects (JIP). Renown JIPs include OLGA’s software, initially
developed under the Statoil, IFE, and SINTEF JIP in 1984; LedaFlow
Improvements to Flow Technology (LIFT), initially developed in 2013
under the Chevron, ConocoPhillips, ExxonMobil, Shell, Statoil, TotalEn￾ergies, and Woodside JIP; and the University of Tulsa Fluid Flow Projects
(TUFFP) since 1973. Thus, the most reliable technical information about
multiphase flow in pipes is reserved for the JIP members. Additional data❦
❦ ❦
❦
1.3 Challenges to Model Multiphase Flow 5
obtained from research in the academic world make their way into journal
papers although to a limited extent. For these reasons, the most prestigious
commercial codes in the market today tap experimental data through the
JIP to fill the gap left between conservation principles and the number of
unknowns, that is, valuable closure equations.
1.3.2 Multidimensional Fluid Flows
The standard practice to deal with the intractable three-dimensional field
of multiphase flow has led most practitioners to focus on 1-D models. This
strategy simplifies the governing equations for system’s sections with large
L/D ratio and makes the set amenable to mathematical solution. However,
there is a price for this simplification in terms of additional closure equations
to compensate for the loss of multidimensional information. In general, the
1-D models rely on the cross-sectional integral methodology.
Given that most production systems are exceedingly long compared
to the piping ID, the 1-D axis-line approach has gained overwhelming
acceptance for multiphase flow simulations. More recently, since 2016,
two-dimensional (2-D) and quasi-three-dimensional (Q3D) analyses are
becoming commercially available, obviously adding noticeable computa￾tion time if the full production system is simulated. For the simulation
of specific pipeline accessories (e.g. a choke) with sudden changes in
flow properties and geometry, the preferred option is computational fluid
dynamics (CFD) code, enabling either Eulerian or Lagrangian formulations
of the gas–liquid–solid flow field over a huge amount of nodes/cells.
The hold-up property (or its converse, the void fraction) captures part of
the essence of the topology challenge. The 1-D hold-up is defined as the
ratio of the cross-sectional pipe area occupied by the liquid(s) phase to the
total cross-sectional area. This parameter embodies the relative weight of
liquid(s) and gas phases to estimate important mixture properties such as
density, viscosity, and thermal conductivity.
The other challenge of the flow topology is to identify distinctive flow
regimes with common similarities in phase distribution. The objective is
to have a limited number of flow patterns with common characteristics to
apply specific models that capture the core of each regime. The best option
to focus on flow topology is to identify either dispersed flows or separated
flows (Brennen, 2005). A dispersed flow comprises bubbles in a continuous
liquid phase or droplets in a continuous vapor phase. The dispersed flow
regime is more difficult to represent due to the numerous particles interact￾ing with the continuous phase and among themselves. The separated flow
consists of two continuous phases exchanging transport phenomena (mass,
momentum, and energy).❦
❦ ❦
❦
6 1 Introduction
1.3.3 Time Fluctuations
The standard multiphase flow modeling approach rests on the assumption
that the time scale of interest is orders of magnitude larger than the turbu￾lence frequency of the smallest eddies. Nevertheless, the fluctuating nature
of intermittent flow and the phases’ topology pose daunting challenges.
Rigorous modeling of the instantaneous multiphase flow properties
and parameters is unfeasible. A time-filtering methodology, similar to the
traditional velocity fluctuations smoothing technique for turbulent flows,
is necessary to obtain a well-approximated set of equations with reasonable
computation time. We can speculate that commercial codes work utilizing
time-filtering techniques for multiphase flow parameters, but without
access to the code program, it is not possible to confirm such conjecture.
1.3.4 Slow Transients
One important simplification of the dynamic performance of multiphase
flow is the distinction between fast and slow transients. Transient operations
are planned and executed to change the production flow rate from state A
to state B.
An example of a transient operation is a well startup, originating from a
shut-in state and aiming to achieve a target production rate. This example
may be regarded as a slow transient because the rate of change in fluid
properties is gradual, and there are no appreciable compressibility phe￾nomena. Similar examples are quite common in the industry, such as well
shutdown, system planned shutdown, ramp-up, and system pigging, among
others. In general, most transient field operations could be classified as
slow transients and are characterized by their time and velocity scales.
On the other hand, a fast transient is triggered by an abrupt change in
operation, involving substantial elastic phenomena (i.e. compressibility)
in the bulk of the fluid. In fast transients, fluid compressibility dominates
over the friction and gravity factors, and wave perturbations travel at very
high velocities labeled the speed of sound. Such waves are usually modeled
assuming that the fluid compressibility is an elastic phenomenon transmit￾ted via isentropic processes. Fast transients have very small characteristic
time and very large characteristic velocity (i.e. speed of sound), quite the
opposite of slow transients. One example of a fast transient is when bulk
fluid is subject to exceedingly high acceleration due to the rupture (loss
of containment) of a pipeline operating at high pressure, followed by the
system inventory blowdown. In this example, at the rupture location, gas
could attain the speed of sound, and the flow is considered “choked,”❦
❦ ❦
❦
1.4 Hydrocarbon Flow 7
which means that the phenomenon is not controlled by the downstream
(surroundings) conditions but rather by the upstream conditions.
It is important to point out that localized choked flow may occur at
pipeline accessories, having a small flow cross area, despite the pipeline
being operated under a steady state. This scenario happens when gas flows
through a choke valve partly open, and the production flow rate remains
constant because the fluid(s) cannot flow faster than the speed of sound.
A simple criterion to identify a slow transient from a fast transient is the
criterion expressed by equation (1.1), if it holds across the entire production
system.
(u
c
)
mix
≪ 1 (1.1)
1.3.5 Compositional Simulation
An exact representation of the fluid properties is never possible with
state-of-the-art thermodynamic modeling, although impressive approxima￾tions are nowadays feasible with cubic equations of state (EOS) and newer
PC-SAFT EOS. Exact representation means, in this regard, the capability
to precisely match all laboratory results of the PVT routine assays. For this
reason, before multiphase simulations of multicomponent pipeline flow
are attempted, it is necessary to characterize the fluid composition with a
number of pseudo-components to enable the equation to state to reproduce
the lab assays performed. This characterization process is painstaking and
does not always guarantee that all lab test results can be replicated with the
EOS chosen.
The customary way to generate look-up fluid properties tables has been
to perform pressure-temperature flashing calculations. This is the preferred
approach to save time during thermo-hydraulics modeling, instead of calcu￾lating thermodynamic equilibrium at each point and for every time step.
However, there are several instances in which the compositional simula￾tion is needed at the excessive cost of computational time; one example is
when commingling vastly different streams at a node. A newer trend that
adds accuracy to the properties estimations for single-component systems is
based on pressure–enthalpy relationships.
1.4 Hydrocarbon Flow
Multicomponent mixtures of hydrocarbons show a variety of pipe flow
characteristics not found in single-phase flow. At one end, we have live oil
carrying dissolved light hydrocarbons that are released from solution by❦
❦ ❦
❦
8 1 Introduction
pressure and temperature changes. This process generates a two-phase flow
with marked characteristics of oil properties. Once the dissolved gas and
any possible water are removed in a process plant, the remaining oil phase
is known as dead oil and shows fluid properties of single-phase flow, just as
the gas and water will do as well.
On the other end, we have gas-condensate fluids with prevalent fluid prop￾erties of the gas phase, although along the production system will drop liq￾uid hydrocarbon condensate. Between these two limits, any combination of
fluid properties can arise adding to the complexity of the simulations.
1.5 Modeling Approaches
The challenges aforementioned define a strategy to model hydrocarbon
flows based on a set of abridging assumptions. These assumptions have
proved to yield reasonable modeling results in agreement with field mea￾surements while making the set of equations tractable for calculations. The
principal assumptions are as follows:
◾ The representation of the thermodynamic fluid properties using
cubic EOS,
◾ The interpolation of fluid properties from look-up P–T tables to save com￾puting simulation time,
◾ The use of a point-to-point compositional model to predict fluid proper￾ties for unusual cases such as fluid blending, gas-condensate flows, and
processes with high acceleration effects (e.g. blowdown),
◾ One-dimensional fluid flow to simulate long spans of pipelines,
◾ Slow-transient operations without wave phenomena,
◾ Division of production system domain into cells small enough to consider
uniform properties within the control volume,
◾ Explicit integration schemes with small time-integration steps to satisfy
the Courant–Friedrich–Lewy (CFL) condition (Peyret, 1983),
◾ Implicit integration schemes to warrant computational stability with
methodologies such as Crank–Nicholson (Peyret, 1983), but at the cost
of handling large sparse matrices,
◾ Closing the set of equations by means of complementing closure
equations and jump conditions (e.g. hold-up correlations),
◾ Using flow-regime-specific correlations to close a system of equations
(mechanistic approach),
◾ Heat transfer to the environment is accounted for through an energy
equation, in order to predict temperature changes along the flowline
which introduce major changes in phases’ composition, and❦
❦ ❦
❦
References 9
◾ Neglecting heat-transfer transient effects in pipeline steel and
thermal-insulation coatings (to be addressed later).
In the next sections, use of the assumptions listed is made to present
two-phase flow models applicable to quasi-horizontal, inclined, and
vertical flow.
References
Brennen, C. (2005). Fundamentals of Multiphase Flow. Cambridge, UK:
Cambridge University Press.
Lahey, R. and Moody, F. (1993). The Thermal-Hydraulics of a Boiling Water
Nuclear Reactor, 2e. La Grange Park, Illinois, USA: American Nuclear
Society.
Peyret, R. (1983). Computational Methods for Fluid Flow. New York, NY, USA:
Springer-Verlag.
Tong, L. and Tang, Y. (1997). Boiling Heat Transfer and Two-Phase Flow, 2e.
Washington, D.C., USA: Taylor and Francis Publishers.❦
❦ ❦
❦❦
❦ ❦
❦
11
2
Fundamentals of Multiphase Flow
The following sections address the basis for having a solid foundation to
simulate multiphase flow in pipelines that unfolds in subsequent chapters.
The topics covered herein are as follows:
● Examples of multiphase flow in the oil and gas industry
● Nomenclature of multiphase flow
● Strategy to model multiphase flow
● Measurement techniques for two-phase flow
2.1 Multiphase Flow in the Production of Oil
and Gas
In the oil and gas industry, the production activity from the reservoir to
the fluid processing facilities might encompass several phases, namely oil,
natural gas, produced water, sand fines, and potentially other solid particles
resulting from the precipitation of heavy ends.
Multiphase flow may be present in various places along the production
path of oil and gas. First, in the reservoir, there may exist a gas cap when
the trapped fluid is below the bubble point, leading to the production of
a two-phase flow from the reservoir. Multiphase flow in porous media is
beyond the scope of this book and will not be addressed. Second, in the
tubing string of a production well, gas may progressively separate from the
bulk of the hydrocarbon liquid due to the pressure loss in the ascending flow.
In this case, the wellhead flowing pressure would be below the bubble point
of the mixture. The flow may adopt different patterns (Figure 2.1) depending
on the relative amount of gas and liquid, as well as on the average velocities
Multiphase Transport of Hydrocarbons in Pipes, First Edition.
Juan J. Manzano-Ruiz and Jose G. Carballo.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
Companion Website: www.wiley.com/go/Manzano-Ruiz/Multiphasetransport❦
❦ ❦
❦
12 2 Fundamentals of Multiphase Flow
Bubbly Slug/Plug Churn Annular
Figure 2.1 Flow regimes in vertical flow.
of each phase. Third, the production system is quite likely to have flowing
mixtures of multiphase flow, in particular at the production riser of offshore
facilities.
The regimes in vertical flow are strongly influenced by gravity and tend
to form axisymmetric patterns. The presence of phases in the well string
determines local mixture density, hold-up, and total pressure drop. There￾fore, the well production depends on the driving pressure gradient imposed
by both the single- and the two-phase flow sections. The latter is always
larger than the single-phase flow gradient, and the point within the well
at which the bubble point is reached is key to knowing which regime is
dominating the performance.
Downstream of the well choke, there is a production system comprising
flowlines (and a riser for offshore wells). In offshore fields, subsea wells
tie well trees to a subsea manifold via subsea flowlines. For onshore fields
with multiple wells, a gathering system collects production from the cluster
via flowlines that deliver the hydrocarbons to a battery station (Figure 2.2)
where gas and liquids are separated.
The flowlines convey production in multiphase form and again the
higher pressure gradients determine the amount of production delivered
per well and per cluster. Some authors like to visualize the total pressure
gradients, which need to be overcome with the reservoir energy, by a series
of flow resistances, as an analog to an electrical circuit with resistors in series❦
❦ ❦
❦
2.1 Multiphase Flow in the Production of Oil and Gas 13
Figure 2.2 Partial view of onshore gathering system. Source: Max Phillips (Jeremy
Buckingham MLC)/Flickr/CC BY 2.0.
and parallel. The production flow going through such flow resistances is
equivalent to the electrical current. Such flow resistances are highly non￾linear and variable, in comparison to common electrical resistors, and are
a function of several flow variables that will be addressed in later chapters.
The complete set of flow resistances (or “chokes”) from the reservoir to
the processing facility is also known as the choke model and serves well
to quickly envision ways to enhance production flow through the reduction
of the “chokes.”
Subsea field developments are more complex compared to onshore fields,
from the standpoint of the subsea equipment, controls, and installation in
a harsh environment. The subsea production system (SPS) can adopt four
typical arrays, namely a cluster of wells, satellite well, daisy-chain, and tem￾plate of wells. These subsea gathering system configurations are shown in
Figure 2.3.
The selection of the development architecture depends on the drilling
location of the wells’ tophole. If the well’s locations are very distant from
each other, a daisy-chain development would suit best because the wells
will not have to be of extended reach (high deviation wells). If the reservoir
production targets can be reached from a single drill center (DC), the wells’
template will save CAPEX for flowlines, jumpers, and umbilical; however,
the wells’ drilling and completion costs will be higher because of the longer
measured depth (MD). If the wells’ cost is extremely sensitive to drilling❦
❦ ❦
❦
14 2 Fundamentals of Multiphase Flow
Host
Risers
Satellite well
4-wells template
3-wells daisy-chain
Cluster of satellite wells
Figure 2.3 Subsea gathering system options.
deviation and the drill sites are not too far apart, then a cluster satellite
development could minimize overall TOTEX. The latter term refers to
the total cost of the facility over the life cycle, that is, CAPEX and OPEX.
Finally, isolated wells can be produced as satellite tiebacks. In summary,
the subsea development design is a compromise between wells’ TOTEX (the
highest cost of all) and the SPS TOTEX, which are driven by the location of
the drilling sites.
Regardless of the subsea development design, all fields will produce
multiphase flow through the flowlines and risers. Long flowlines in
deepwater, exposed to low seawater temperatures and large pressure
drops, are most likely to endure the consequences of multiphase transport.
However, there are some exceptional examples of long subsea flowlines
built in shallow waters, posing minimum hydrate formation risk despite
the presence of produced gas and water due to the low internal pressure
and the warm seawater environment.
From an operations perspective, onshore gathering systems are easier to
produce than their subsea counterparts. Onshore gathering systems can be
installed in trenches for enhanced safety and soil thermal insulation. The
cost of trenches is extremely low compared to the installation equipment
cost in offshore applications. Should any repair or system intervention of❦
❦ ❦
❦
2.2 Multiphase Flow Concepts 15
the onshore gathering system be necessary, its cost will be a small fraction
of the cost of a similar intervention in a subsea gathering system.
2.2 Multiphase Flow Concepts
Multiphase flow in pipelines requires a specific nomenclature for the
dynamic magnitudes involved. Two-phase flow is a subset of multi￾phase flow, and in this section, we focus on the nomenclature applicable
to gas–liquid flows. The nomenclature presented herein can be extrapo￾lated to other analogous two-phase flows such as solid–liquid (slurries),
solid–gas, and oil–water. Moreover, the same definitions introduced below
can be extrapolated to more cumbersome three- and four-phase flow
applications. For this reason, we depart from full multiphase flow at this
place and focus on two-phase gas–liquid flow, with opportune comments to
extend models to multiple phases.
The following sub-sections address the most important parameters for
gas–liquid pipe flow following the practical and customary one-dimensional
(1-D) model approach (Wallis, 2020), based on the concept of cross-area
averaging. Also, the conventional use of the statistical stationary process by
Delhaye (Bergles et al., 1981) is utilized everywhere to simplify the time
variation of magnitudes in the models.
2.2.1 Void Fraction and Hold-up
Consider the following phase-density function (Bergles et al., 1981) denot￾ing the presence (Pk) of either phase at a specific point of the flow field at
a time “t”:
Pk(x⃗, t) =
⎡
⎢
⎢
⎢
⎣
1 if at point x⃗ phase “k” is present at time “t”
0 if at point x⃗ phase “k” is absent at time “t”
k = l (liquid), or g (gas)
⎤
⎥
⎥
⎥
⎦
(2.1)
The fraction of time (over a period of time “𝜏”) the gas phase occupies
the control volume at the location x⃗ is the local instantaneous void fraction
𝛼 (Lahey and Moody, 1993) defined as
𝛼(x⃗, t) ≡ 1
𝜏 ∫
t+𝜏
t
Pk(x⃗, t
′
)dt′ (2.2)
This concept can be applied to a finite control volume within the pipe, as
it is sometimes used to measure the instantaneous volumetric void fraction
by section isolation, to yield❦
❦ ❦
❦
16 2 Fundamentals of Multiphase Flow
𝛼(t) ≡
∫∫∫
Vg
dv
∫∫∫
Vg+Vl
dv = Vg(t)
Vg(t) + Vl
(t) (2.3)
The 1-D models make extensive use of the practical void fraction con￾cept at cross-sections of the flowlines. The angled parentheses ⟨⟩ are used
to signify the area average of a multiphase property, but often such nota￾tion is dropped for simplification but with the same meaning. For statis￾tically stationary processes (i.e. steady-state analysis approximation), time
integrated over a prolonged period of time “𝜏,” the cross-sectional stationary
void fraction (Lahey and Moody, 1993) becomes
𝛼 = ⟨𝛼⟩ ≡ 1
𝜏 ∫
t+𝜏
t
⎛
⎜
⎜
⎜
⎝
Δx∫∫
Ag
dACS
Δx ∫∫
Ag+Al
dACS
⎞
⎟
⎟
⎟
⎠
dt′ = Ag
Ag + Al
= Ag
A (2.4)
The concept of the stationary void fraction at a cross-section leads to the
equivalent hold-up concept collectively used in the oil and gas industry (Brill
and Mukherjee, 1999):
HL = ⟨HL⟩ ≡ 1 − ⟨𝛼⟩ (2.5)
For hydrocarbon mixture flows through flowlines, it is customary to adopt
the cross-sectional stationary void fraction approximation in the hydrody￾namic equations, even for slow transient processes, by implicitly assuming
that the integration period of time 𝜏 is far smaller than the time constant
for the transient. In other words, the cross-sectional void fraction “adjusts”
quickly to local perturbations in comparison to the longer time constant of
the transient phenomenon, and any time variation of the local section void
fraction follows the slow-transient trend.
2.2.2 Phase Velocity, Slip Factor, and Volumetric Flow
The instantaneous local phase velocity vectors for vapor and liquids are,
respectively, represented in this book by
−u
→
g (x⃗, t) and →−ul (x⃗, t) (2.6)
For the 1-D models presented in this book, the following area-averaged
and statistically stationary approximations are utilized for the phase velocity:
ug = ⟨ug⟩ ≡ 1
Ag𝜏 ∫
t+𝜏
t
⎛
⎜
⎜
⎜
⎝
∫ ∫
Ag
−u
→
g(x⃗, t) ⋅
−−−→ dACS
⎞
⎟
⎟
⎟
⎠
dt′ (2.7)❦
❦ ❦
❦
2.2 Multiphase Flow Concepts 17
ul = ⟨ul
⟩ ≡ 1
Al
𝜏 ∫
t+𝜏
t
⎛
⎜
⎜
⎝
∫ ∫
Al
→−ul (x⃗, t) ⋅
−−−→ dACS
⎞
⎟
⎟
⎠
dt′ (2.8)
One fact about gas–liquid flow is that in general the gas phase velocity is
larger than the liquid phase velocity, and it is accounted for with the slip
velocity concept
us = ⟨us⟩ ≡ ⟨ug⟩ − ⟨ul
⟩ (2.9)
This is true for any orientation except for incipient bubbly flow in hori￾zontal flowlines and for certain applications with downward flow. The ratio
of gas-to-liquid phase velocities is known as slip factor S,
S ≡ ⟨ug⟩
⟨ul
⟩ = ug
ul
(2.10)
The 1-D statistically stationary volumetric flows of gas and liquids are
defined based on the phase velocity concepts expressed by equations (2.7)
and (2.8), yielding
Qg = ⟨Qg⟩ ≡ 1
𝜏 ∫
t+𝜏
t
⎛
⎜
⎜
⎜
⎝
∫ ∫
Ag
−u
→
g (x⃗, t) ⋅
−−−→ dACS
⎞
⎟
⎟
⎟
⎠
dt′ = ugAg (2.11)
Ql = ⟨Ql
⟩ ≡ 1
𝜏 ∫
t+𝜏
t
⎛
⎜
⎜
⎝
∫ ∫
Al
→−ul (x⃗, t) ⋅
−−−→ dACS
⎞
⎟
⎟
⎠
dt′ = ul
Al (2.12)
Q ≡ Qg + Ql (2.13)
These time- and area-averaged concepts are ordinarily used for long
flowlines and risers modeling with gradual transient operations. Thus, the
previous rigorous presentation of the parameters’ definition will be left
aside in the following chapters to concentrate on the practical application
of these principles while understanding the implicit assumptions.
2.2.3 Volumetric Flux and Superficial Velocities
The essence of the 1-D model allows us to define the volumetric flux
(Collier and Thome, 1994), best known in the multiphase flow literature as
superficial velocity, as the ratio of volumetric flow and overall cross-sectional
area. As such, the volumetric flux provides a lower bound estimate of phase
velocity because it is based on a constant flow area (pipe). The definitions
for vapor and liquids are❦
❦ ❦
❦
18 2 Fundamentals of Multiphase Flow
jg = ⟨ jg⟩ ≡ ⟨Qg⟩
A = 4Qg
𝜋d2 = 𝛼 ug (2.14)
jl = ⟨ jl
⟩ ≡ ⟨Ql
⟩
A = 4Ql
𝜋d2 = (1 − 𝛼)ul (2.15)
The mixture or total volumetric flux is defined as
j = ⟨ j⟩ ≡ ⟨ jg + jl
⟩ = jg + jl (2.16)
The use of the superficial velocity concept is amply utilized for flow pat￾tern maps, the drift–flux model, and the separate flow models, as will be
covered in a later chapter.
2.2.4 Density
The density property can be defined with the 1-D model, for each phase
and for the mixture. The area-averaged and statistically stationary density
definitions are
𝜌g = ⟨𝜌g⟩ ≡ 1
𝜏Ag ∫
t+𝜏
t
⎛
⎜
⎜
⎜
⎝
∫ ∫
Ag
𝜌gdACS
⎞
⎟
⎟
⎟
⎠
dt′ (2.17)
𝜌g = ⟨𝜌g⟩ ≡ 1
𝜏Al ∫
t+𝜏
t
⎛
⎜
⎜
⎝
∫ ∫
Al
𝜌l
dACS
⎞
⎟
⎟
⎠
dt′ (2.18)
𝜌m = ⟨𝜌m⟩ ≡ 1
𝜏A∫
t+𝜏
t
⎛
⎜
⎜
⎜
⎝
∫ ∫
Ag
[𝜌gdACS] + ∫ ∫
Al
[𝜌l dACS]
⎞
⎟
⎟
⎟
⎠
dt′
= 𝜌g𝛼 + 𝜌l
(1 − 𝛼) (2.19)
2.2.5 Mass Flows
The area-averaged and statistically stationary mass flow rate definitions,
according to the 1-D model, are
mg = ⟨mg⟩ ≡ ∫ ∫
Ag
𝜌g
−u
→
g (x⃗, t) ⋅
−−−→ dACS = 𝜌gug𝛼A (2.20)
ml = ⟨ml
⟩ ≡ ∫ ∫
Al
𝜌l
→−ul (x⃗, t) ⋅
−−−→ dACS = 𝜌l
ul
(1 − 𝛼)A (2.21)
mm = A[𝜌gug𝛼 + 𝜌l
ul
(1 − 𝛼)] (2.22)❦
❦ ❦
❦
2.2 Multiphase Flow Concepts 19
Dividing equation (2.20) by equation (2.21) yields a useful mass conserva￾tion principle for area-averaged and statistically stationary flows to solve for
the void fraction parameter when there is a slip-factor correlation available:
mg
ml
=
(𝜌g
𝜌l
) ( 𝛼
1 − 𝛼
) ug
ul
=
(𝜌g
𝜌l
) ( 𝛼
1 − 𝛼
)
S (2.23)
2.2.6 Mass Velocity
The concept of mass velocity relates mass flow rate to constant flow area.
This parameter enables us to express principles in terms of superficial
velocity. The definitions are
Gg ≡ mg
A = 𝜌gug𝛼 = 𝜌g jg (2.24)
Gl ≡ ml
A = 𝜌l
ul
(1 − 𝛼) = 𝜌l jl (2.25)
G ≡ m
A = Gg + Gl = 𝜌g jg + 𝜌l jl (2.26)
2.2.7 Mass Quality and Volumetric Quality
The mixture quality in terms of mass and volume is defined by the following
expressions:
xm ≡ mg
ml + mg
= mg
m
(2.27)
𝛽m ≡ Qg
Q (2.28)
2.2.8 Drift Velocities and Drift Fluxes
The gas and liquid drift velocity represents the relative velocity of either
phase with respect to the volumetric flux (mixture superficial velocity),
defined by
ugj = ⟨ugj⟩ ≡ ⟨ug − j⟩ ≅ ug − j (2.29)
ulj = ⟨ulj⟩ ≡ ⟨ul − j⟩ ≅ ul − j (2.30)
The drift–flux of one phase is the volumetric flux relative to a surface mov￾ing at the mixture superficial velocity, defined by the following expressions:
jgl = ⟨ jgl⟩ ≡ ⟨𝛼(ug − j)⟩ = ⟨ jg(1 − 𝛼) − jl
𝛼⟩ ≅ jg(1 − 𝛼) − jl
𝛼 (2.31)❦
❦ ❦
❦
20 2 Fundamentals of Multiphase Flow
jlg = ⟨ jlg⟩ ≡ ⟨(1 − 𝛼)(ul − j)⟩ = ⟨ jl
𝛼 − jg(1 − 𝛼)⟩ ≅ jl
𝛼 − jg(1 − 𝛼)
(2.32)
jgl = ⟨ jgl⟩ ≡ ⟨us𝛼(1 − 𝛼)⟩ ≅ us𝛼(1 − 𝛼) (2.33)
The equations above are useful to introduce the drift–flux model in a later
chapter.
2.3 Modeling Strategy
The solution of the set of rigorous two-phase flow equations is abso￾lutely impractical, and the application of simplified models is necessary.
This section summarizes a brief description of the major approximations
that have produced good simulation results.
2.3.1 Area Averaging and One-dimensional Flow
For flowlines and risers, the ratio of flow length to pipe’s internal diameter
is dominant. Therefore, the expected changes (fluid and flow properties) in
the axial direction are greater than the changes in radial or circumferential
directions. However, multiphase flow through accessories such as elbows,
tees, and valves experiences rapid acceleration and property changes in all
directions.
The practice of dealing with area-averaged properties, that is, the 1-D
model, is standard in the simulation world of multiphase flow. Zuber and
Findlay’s (1965) model, which will be reviewed in Chapter 5, proposes
the concept of correcting the 1-D modeling approach by incorporat￾ing factors that account for cross-sectional variation of the parameters.
Pipeline singularities (e.g. pipeline accessories such as valves, elbows,
and expansions) may or may not influence the performance simulation.
Long flowlines are most commonly insensitive to changes introduced by
accessories. Short flowlines, on the contrary, can be affected by accessories
and require special simulation tools such as CFD (computational fluid
dynamics).
2.3.2 Pseudo-steady Flow
The modeling strategy for normal production of multiphase flow is to assume
the actual flow as pseudo-steady, filtering out the inevitable fluctuations in
parameters that field production has. In other words, the pseudo-steady￾state hypothesis asserts that fluid properties and other parameters are
time-invariant. Parameters change only along the flow path in the
production system.❦
❦ ❦
❦
2.3 Modeling Strategy 21
2.3.3 Time Averaging of Turbulent Fluctuations
All multiphase flow models include the time averaging of turbulent
fluctuations in the governing equations. The time averaging is performed
over a period of time larger than the turbulence frequency of the smallest
eddies. Thus, in transient simulations of multiphase flow, the unsteadiness
of the flow is captured through the time-derivative term without turbulent
fluctuations.
2.3.4 Mechanistic Approach
The Lagrange modeling of multiphase flow (Brennen, 2005) is sometimes
attempted for dispersed type of flows. This methodology seeks to represent
the flow field of small particles immersed in a continuous phase (droplets
in gas phase, or bubbles in liquid phase), including the interaction among
particles. Obviously, this task is quite challenging and requires lots of com￾puting power. The modern approach is to use commercial CFD codes with
adapting mesh and dynamic updating of boundary conditions.
The other approach is to express the governing equations following the
Euler methodology jointly with closure equations. To facilitate the burden of
the set of equations, a mechanistic approach is taken, whereby the equations
are tailored to conform to the most probable flow regime present. Thus,
after identification of the prevailing flow pattern, specific models applica￾ble to such regime are used to close the system of equations. In this regard,
the flow regimes considered can vary from a very concise set of dispersed
versus separate patterns, to more elaborate sets comprising 4–5 different
regimes. The downside of this approach is the necessary prediction capacity
(uncertainty) of the flow pattern maps for any flow orientation and the lack
of established knowledge concerning multiphase flow development length
(after changes in direction or passing through system components).
2.3.5 Boundary and Initial Conditions
Typically, the integrated modeling of a hydrocarbon production system,
framed by the reservoir conditions at the start point and by the host at the
delivery point, defines the achievable production flow rate. Such conditions
become the boundary conditions (BC) to solve the conservation equations.
At the reservoir end, at the well’s perforations, the fluid temperature is
fairly close to the constant reservoir temperature. The flowing bottomhole
pressure (bhp) of the well is, however, changing in time due to reservoir’s
mass depletion (i.e. reservoir performance decline). The bottomhole pres￾sure is lower than the reservoir pressure due to the pressure drops through❦
❦ ❦
❦
22 2 Fundamentals of Multiphase Flow
the porous media and the completion perforations, fracking, and sand
screen. Such pressure loss is flow-dependent, and it is known as the well’s
drawdown. Thus, pressure and temperature are referred to as the upstream
boundary conditions.
At the host facilities, the arrival constant pressure set at the first-stage
separator becomes the downstream boundary condition for the production
system. At this end, temperature is not fixed, and it floats depending on the
thermal-hydraulic performance of the overall system. The arrival tempera￾ture though is an important parameter in flow assurance studies to identify
potential flowing issues related to paraffins, hydrates, and emulsions.
For transient process simulations, a system’s initial condition must be
defined. The initial condition may be fluid(s) at rest as in the case of system
startup after shutdown. In this case, the initial condition specification shall
include system’s profiles of densities, hold-up, temperature, and pressure.
Another common initial condition is steady-state flow followed by tran￾sient flow ramp-up, flow ramp-down, or system shutdown. In this case, the
simulation tool is switched from the steady-state flow, with all the property
distribution information (i.e. the initial conditions), into transient simulator
mode. Transients, in general, are process shifts between two stable operating
conditions.
2.3.6 Boundary-value and Marching-scheme Strategies
The boundary conditions described in Section 2.3.5 cast the simulation as
a boundary-value problem, that is, the system performance is driven by the
two-end conditions. This type of problem poses challenges for the nonlinear
set of governing equations.
One common solving strategy is to adopt a marching scheme starting from
upstream BC, assuming a mass flow rate and solving cell by cell the dis￾cretized domain, to estimate the arrival fluid properties at the delivery point.
This numerical approach is referred to as a “shooting method” (Gerald, 1980)
and seeks to estimate the right mass flow rate by several trials trying to match
the arrival pressure at the host.
The alternative to the marching scheme is to state conservation in terms of
finite difference equations for each cell of the discretized domain and solve
the resulting set of linearized equations by numerical methods. Usually, the
resulting set of equations creates sparse matrices requiring optimized tech￾niques to minimize storage and accelerate convergence by Gauss–Jordan or
LU techniques (Gerald, 1980).❦
❦ ❦
❦
2.4 Two-Phase Flow Measurements 23
2.3.7 Closure Equations
Conservation equations have more unknowns than the number of
equations, and the need for model closure is a classic problem of multi￾phase flow modeling. Such closure equations are a blend of empirical data
and mechanistic models, with value limited by the degree of similitude
between the experimental information and the problem attempted to
solve. Nevertheless, the lack of similar field data (fluids, actual conditions)
that have been used in the majority of the available correlations has not
dissuaded workers to apply them in the simulations despite the differences
because of the lack of better information.
The typical closure equations added to the conservation principles include
correlations for void fraction of bubbles in the liquid phase, shear stress at
the pipe wall (for each phase), interfacial shear stress between the phases,
void fraction of droplets in gas phase, and mixture enthalpy.
2.4 Two-Phase Flow Measurements
Uncertainty in the results obtained from simulators is not only associated
with the uncertainty in the simplifications made of the conservation prin￾ciples (e.g. one-dimensional model, thermal equilibrium) but also related
to the uncertainty in the data utilized to generate the closure correlations.
The data collected also have measurement uncertainty that feeds into the
correlations. Moreover, comparing field data gathered with instruments
(also subject to uncertainty readings) has to be assessed with judgment
while comparing to simulation results.
This section addresses the role of experimental measurements and their
accuracy in providing useful information to the operators.
2.4.1 Well Testing and Production Allocation
Wells have to be independently and periodically tested for reservoir surveil￾lance, reservoir management, and to comply with local legal regulations.
During the execution of the test, it is extremely important to have the well in
stable flowing condition. The total field production and the isolated well test
help estimate the production allocation factors. The allocation factors are
necessary to allow the individual contribution of every single well within
the overall production gathered.❦
❦ ❦
❦
24 2 Fundamentals of Multiphase Flow
The task of a well test is to measure the flow rate of gas, oil, and water at
a particular set of choke beans, separator pressure, and fluid temperature
at the separator. For onshore wells, it is common to have a test separator
at the wellsite of a cluster of wells. For subsea wells, there is usually a
separate testing flowline that conveys only the production from the well
tested to a separator installed at the topside facilities. Sampling ports are
provided at the test site to collect fluid samples for composition analyses
(i.e. surface–fluid recombination). Well-calibrated flow meters, pressure
transmitters, and temperature transmitters provide local and remote data
for recording and calculations. Alternatively, local multiphase flow meters
can be installed near a cluster of wells, either onshore or subsea, to waive
the use of a test separator and remotely measure the desired parameters in
real time, as described in the section below.
The information gathered serves for
● Logging cumulative production per well,
● Verifying the well is producing the scheduled plan,
● Estimating allocation factors,
● Estimating reserves left,
● Updating well’s decline curve,
● Calculating local gas–oil ratio (GOR),
● Calculating oil–water ratio (OWR),
● Sampling and identifying changes in hydrocarbon composition,
● Monitoring increments in produced water or gas flow rates,
● Noticing presence of foam, asphaltene, and emulsions, and
● Identifying impending need for well’s workover job.
A well to be tested is isolated from the rest and is aligned to the test flow￾line ending at a test separator downstream. The well testing process requires
a test header, isolation valves, and a dedicated test flowline to reach a test
separator downstream. A sketch of a three-phase test separator is shown in
Figure 2.4.
2.4.2 Multiphase Flow Meter (MPFM) and Field Application
The in-line multiphase flow meter technology underwent advanced devel￾opment in the 1990s aiming to fill gaps in field applications such as
● Remote location of wells and clusters, far from processing centers,
● Multiphase flow meter (MPFM) built into the well’s Christmas tree,
● Platform topsides with limited space for test separator,❦
❦ ❦
❦
2.4 Two-Phase Flow Measurements 25
Gas sampling
Oil sampling
Water cut
GOR @ P & T
Oil flowrate @
Std conditions
Water flowrate
Gas flowrate @
Std conditions
P T
Gas
meter
Oil
meter
Water
meter
Well tested flow
Figure 2.4 Test separator.
● Optimize the choke setting for each producing well with instantaneous
fluids’ flow rate measurement, and
● Quickly monitor water cut (WC) with minimal risk of emulsions.
The MPFM can be used independently in a field application or integrated
with a conventional test separator for periodic calibrations. Figure 2.5
shows a well-test scheme with separator and MPFM; this scheme allows
aligning the well to be tested and selecting either the separator or the
MPFM to record the measurement.
Production
header HP production
separator
Test separator
Multiphase flow meter
MPFM
Test
header
Well 1
Gas
Water
Oil
Gas
Water
Oil
Well 2
Well 3
Figure 2.5 Integrated MPFM and test separator.❦
❦ ❦
❦
26 2 Fundamentals of Multiphase Flow
References such as Falcone et al. (2010) and Folgero et al. (2013) describe
the fundamentals of the various components comprising the MPFM and the
level of uncertainty to expect from the measurements taken.
In general, there are four types of MPFM, depending on the type of devices
utilized to generate measurement signals. These types (Falcone et al., 2010)
are as follows:
● Homogenizer followed by two instruments in series, plus a sampling
instrument. The homogenizer helps create a pseudo-homogeneous flow
pattern of droplets and bubbles, with minimal slip among the phases.
Thus, a homogeneous equilibrium model (HEM) can be applied to
provide mass and momentum conservation equations. The instruments
in series can be a venturi tube and a gamma-densitometer unit to estimate
average mixture velocity and density. The third instrument operating on
a fluid sample provides an estimate of the oil–water ratio (i.e. WC).
● The next option is similar to the previous one of a homogenizer but with
three instruments in series and no sampling. The third instrument should
be able to estimate the WC, for instance, a neutron attenuation device.
● The third option does not have a homogenizer and requires up to five
instruments if no periodic calibrations are made. The instrumentation is
more sophisticated and appropriate to laboratory experimentation rather
than fieldwork.
● The fourth alternative is symbolic because it comprises the separation of
the three phases O/W/G and becomes the test separator option addressed
before.
Well 1
Well 4
Well 3
Separator
Oil
Gas
Manifold
Well 2
MPFM
MPFM
MPFM
MPFM
Figure 2.6 Field array of MPFMs.❦
❦ ❦
❦
2.4 Two-Phase Flow Measurements 27
The value of the MPFM becomes evident for remote or subsea fields where
the test separator option requires pad space or dedicated test lines. Figure 2.6
shows a sketch of an array of MPFM feeding remote data to the control room
of downstream processing facilities.
For detailed information about the application of MPFM at a full scale,
please refer to “Handbook of Multiphase Flow Metering,” The Norwegian
Society for Oil and Gas Measurement, Norway (2005).
2.4.3 Density Meters
There are several measurement techniques applicable for laboratory
experiments and field tests. All measurement devices require specific
correlations with respect to a reference standard to improve the accuracy
of the measurement. For instance, reference conditions are pipe full of the
liquid transported and pipe full of the gas transported, both at stagnant
conditions. These two limits set the measurement bounds required for a
good density estimate under flowing conditions.
By far the foremost methodology applicable at field level is gamma
densitometry (usually referred to as gamma-d). The gamma-densitometer
(Falcone et al., 2010) could have a single-collimated high-energy beam,
but in general it is a multi-beam (3–7 beams) device to sweep the pipe’s
cross-section. A source of Cesium-137 radiates the beam, which is attenu￾ated by the flowing multiphase mixture, and the radiation is captured by
detector photo-multiplier tubes. The attenuated energy from the radiation
beam is detected with a device diametrically positioned on the piping (or
coating) surface. An algorithm (previously calibrated for the pipe size)
applied to the weighted averaged beams’ measurements produces an esti￾mate for the area-averaged mixture density. The attenuation phenomenon
involves three basic physical processes, namely photoelectric, Compton
effect, and pair production.
At the laboratory level, several techniques have been implemented such as
● Weighted section of pipe utilizing strain gauges,
● Vibrating section of pipe by means of electromagnetic forces to generate
a response in the frequency domain,
● Acoustic attenuation using an emitter and a receiver, and
● Electrical impedance to measure the capacitance of the multiphase
medium with electrodes. This technique has also been applied for
liquid–liquid flows (oil–water) in MFM.❦
❦ ❦
❦
28 2 Fundamentals of Multiphase Flow
2.4.4 Void Fraction Meters
For field applications, the hold-up, or its converse void fraction, can be
inferred utilizing a gamma-densitometer device (Hewitt, 1978), usually
with five beams crossing the flow area. The gamma-d is normally part of a
multiphase flow meter, discussed in Section 2.4.2, to estimate the local void
fraction.
At the laboratory scale, a set of consecutive quick-closing valves (Hewitt,
1978; Dukler and Taitel, 1982) may trap a sample of a flowing multiphase
mixture. The trapped sample is evaluated to measure the volume of each
phase and therefore derive the hold-up and the WC of the mixture. The
valves can be fitted in the horizontal or the vertical direction but should have
an extremely fast closing time.
The laboratory techniques discussed in the previous sections have also
been utilized with varying degrees of success to estimate local void fraction
at the lab to generate empirical correlations.
2.4.5 Momentum Flux Meters
The venturi-tube meter is the favorite choice for field and lab applications
because of the wealth of data for single- and two-phase flow. In combination
with an upstream homogenizer, it is a good device to estimate the momen￾tum flux 𝜌U2
m, jointly with the HEM (see Chapter 3).
A venturi tube is also a common instrument found in the MFM. Other
momentum flux devices (or pressure drop devices), such as the orifice plate
and the flow nozzle, may yield analogous results with proper calibration and
correlation, but the venturi-tube device offers greater erosion resistance (e.g.
against sand fines) and better momentum recovery due to its shape.
2.4.6 Flow Pattern Identification
Hewitt (1978) and Dukler and Taitel (1982) reviewed the techniques to iden￾tify the boundaries of flow regimes in pipe flow. The research in this area is
not free of controversy because of the potential subjectivity of the regimes
identified by different workers. It is fair to say that the relative position of
the flow regimes within a 2-D flow map is universal among the number of
maps proposed; the potential controversies stem from the regime transitions
observed and the uncertainty associated with such transitions. Most flow
maps have been derived from lab data gathered in small-diameter piping
with air–water mixtures.❦
❦ ❦
❦
2.4 Two-Phase Flow Measurements 29
The methodologies applied to determine pattern transitions are as follows:
● Still photography, high-speed photography, and videos. This technique
requires transparent piping (which usually require low-pressure flows)
and clean, transparent fluids.
● X-ray absorption fluctuations. Probability density functions of the output
signal can be interpreted to match some flow regimes. This technique can
be applied to non-transparent piping and fluid flows at high pressure.
● Analysis of pressure fluctuations. A quartz pressure transducer can mon￾itor and follow rapid pressure fluctuations. This method is capable of dif￾ferentiating between dispersed and separated flow regimes.
● Wall shear stress measurement with the electrochemical method. This
is a laboratory technique monitoring the fluctuations in shear stress and
establishing corresponding correlations for each regime.
In practice, field hydrocarbon production operations do not pursue iden￾tifying flow regimes with actual measurements. Instead, multiphase flow
simulators have programmed flow pattern maps to implement mechanistic
models.
2.4.7 Uncertainty in Multiphase Flow Measurement
The uncertainty in the multiphase flow measurements has to be viewed from
the standpoint of laboratory data gathering and from the standpoint of oil
and gas field applications. Obviously, multiphase data gathering must have
minimal uncertainty to be of any value. However, the spatial distribution
of the phases (i.e. flow regime) poses quite a challenge to obtain accurate
measurements.
The paper by Folgero et al. (2013) discusses at length the sources of error
present while utilizing an MFM and the uncertainty level in the measured
mass flow rate of hydrocarbons. It is extremely important to work with
measurements on a mass basis because it is conserved, whereas volumetric
measurements depend upon varying local conditions of pressure and
temperature. The error propagation in the mass flow rate of hydrocarbons
can be estimated using equation (2.34), if all contributing measurements
follow normal distributions (i.e. follow truly random performances),
𝛿mHC
mHC
=
⎡
⎢
⎢
⎢
⎣
( mo
mHC )2(𝛿𝜌o
𝜌o
)2
+
( mg
mHC )2(𝛿𝜌g
𝜌g
)2
+
( mo
mHC )2(𝛿Ql
Ql
)2
+
+
( mg
mHC )2(𝛿Qg
Qg
)2
+
( 𝜌omw
𝜌wmHC )2(𝛿WC
WC )2
⎤
⎥
⎥
⎥
⎦
0.5
(2.34)❦
❦ ❦
❦
30 2 Fundamentals of Multiphase Flow
based on the following relationships:
mHC = mo + mg (2.35)
m = mHC + mw (2.36)
WC ≡ mw
mo + mw
(2.37)
Thus, the uncertainty in the hydrocarbon’s total mass depends on the error
propagation caused by the following five uncertainty variables:
● Oil density uncertainty 𝛿𝜌o,
● Gas density uncertainty 𝛿𝜌g,
● Liquid volumetric flow rate 𝛿Ql
,
● Gas volumetric flow rate 𝛿Qg, and
● Water cut uncertainty 𝛿WC.
Calibration of MFM at field conditions is either too difficult or impossible,
depending on the environment of the system. The industry recommenda￾tion is to provide an MFM per well and a set of two additional MFM at the
topsides or central processing facility. These two other units being within a
process facility may be connected to the first-stage separator and to a test
header connected to a test separator. Such measurement system serves the
purpose of frequent calibration of the MFM units within the battery limit of
the process facility. In turn, the total mass flow rate of hydrocarbons mea￾sured by the calibrated battery limit MFMs is used to calibrate the sum of all
field MFM total mass flow rates of hydrocarbons. This methodology allows
to periodically generate mass correction factors to estimate the allocation
factors per well.
In summary, to minimize the uncertainty in production mass flow rate of
hydrocarbons and produced water, it is necessary to constantly update the
PVT data of the fluids (e.g. taking samples at the test separator) and the ther￾modynamic estimation of fluids’ density, as well to minimize measurement
uncertainty in the volumetric flow rate of all fluids produced.
2.5 Future Measuring Trends
What should be expected to improve the accuracy of multiphase flow
field measurements, in particular, flow rate and density? A glimpse at the
future trend is presented in the excellent monograph by Falcone et al.
(2010). A combination of advanced artificial neural network (ANN), tuned❦
❦ ❦
❦
References 31
and calibrated with field data, and a learning algorithm to minimize
performance deviations could produce far better predictions than the
output from real-time operations dynamic flow simulators, or from other
empirically determined correlations. The power of ANN methodologies
enables them to use the available data and minimize the field uncertainty in
a way equivalent to how the human brain thinks, but at dazzling speed and
to the extent of evaluating all feasible options. Field data are usually split to
“train” the ANN algorithm, usually with the help of fuzzy logic algorithms,
and the other part of the database serves to test the accuracy of the trained
algorithm.
References
Bergles, A.E., Collier, J.G., Delhaye, J.M. et al. (1981). Two-Phase Flow and Heat
Transfer in the Power and Process Industries. New York, NY, USA: McGraw
Hill Book Company.
Brennen, C. (2005). Fundamentals of Multiphase Flow. Cambridge, UK:
Cambridge University Press.
Brill, J. and Mukherjee, H. (1999). Multiphase Flow in Wells. Richardson, TX,
USA: Society of Petroleum Engineers Inc.
Collier, J. and Thome, J. (1994). Convective Boiling and Condensation, 3e.
Oxford, UK: Clarendon Press.
Dukler, A. and Taitel, Y. (1982). A Short Course on Principles of Modelling
Gas-Liquid Flow and on Modern Measuring Methods,” Chapter IX.
University of Houston, Houston, TX, USA.
Falcone, G., Hewitt, G.F., and Alimonti, C. (2010). Multiphase Flow Metering,
1e. Amsterdam, The Netherlands: Elsevier Publishing.
Folgero, K., Lyng, E., Kocbach, J., Kjell-Eivind, F., Kleppe, K., and Abro, E.,
Uncertainty Analysis of Multiphase Flow Meters Used for Allocation
Measurements. Paper Presented at the 31st International North Sea Flow
Measurement Workshop, Tønsberg, Norway, (October 22–25) 2013.
Gerald, C. (1980). Applied Numerical Analysis, 2e. Reading, MA, USA:
Addison-Wesley Publishing Company.
The Norwegian Society for Oil and Gas Measurement (2005). Handbook of
Multiphase Flow Metering. Oslo, Norway: The Norwegian Society for Oil and
Gas Measurement.
Hewitt, G.F. (1978). Measurement of Two-Phase Flow Parameters. London, UK:
Academic Press.❦
❦ ❦
❦
32 2 Fundamentals of Multiphase Flow
Lahey, R. and Moody, F. (1993). The Thermal-Hydraulics of a Boiling Water
Nuclear Reactor, 2e. La Grange Park, IL, USA: American Nuclear Society.
Wallis, G. (2020). One-Dimensional Two-Phase Flow. Garden City, NY, USA:
Dover Publications Inc.
Zuber, N. and Findlay, J. (1965). Average Volumetric Concentration in
Two-Phase Flow Systems. ASME J. Heat Transfer 87: 453–468.❦
❦ ❦
❦
33
3
Hydrocarbon Fluid Properties and Thermodynamics
3.1 Phase Behavior
A fluid’s phase behavior refers to the relationship between pressure,
temperature, and volume. The fluid may be a pure compound, a mixture
of two compounds (a binary system), or a more complex mixture of many
compounds – a multicomponent fluid.
To capture the essence of the P–V–T relationship, it is often presented
in graphical form with scales of pressure versus temperature or pressure
versus volume. However, the most useful form of the relationship is an EOS
validated with empirical data.
3.1.1 Empirical Data
Experiments conducted in high-pressure cells allow the generation of empir￾ical P–V–T data under thermodynamic equilibrium conditions. The PVT
cells let to change the pressure by varying it with a liquid mercury pump.
Figure 3.1 illustrates a constant pressure experiment by removing the mass
of mercury from the cell while heating it to evaporate the liquid and expand
the volume.
To perform these laboratory tests, it is necessary to have a representa￾tive sample of the production fluid. Although sampling in general is a
routine operation, either at surface level or downhole a well, it is difficult to
ensure the sample is truly representative of the production stream. Refer
to the monograms of Whitson and Brule (2000) and Pedersen et al. (2015)
for ample description of field sampling methodologies.
Figure 3.2 shows another typical laboratory test, a constant temperature
experiment, by removing the mass of mercury from the cell while heating to
evaporate the liquid and expand the vapor volume.
Multiphase Transport of Hydrocarbons in Pipes, First Edition.
Juan J. Manzano-Ruiz and Jose G. Carballo.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
Companion Website: www.wiley.com/go/Manzano-Ruiz/Multiphasetransport❦
❦ ❦
❦
34 3 Hydrocarbon Fluid Properties and Thermodynamics
Liquid
Liquid
Liquid
Hg
Hg
Hg
Hg
T1
 < TVapor
P > PVapor
T2
 = TVapor
P = PVapor
Heated cell
Hg removed
T2
 = TVapor
P = PVapor
Heated cell
Hg removed
T3
 > TVapor
P ≈ PVapor
Heated cell
Hg removed
Gas
Gas
Gas
P PV PV ≈ PV
Figure 3.1 Constant vapor pressure test.
Liquid
Liquid
Liquid
Hg
Hg
Hg
Hg
T1
 < TVapor
P1
 > PVapor
T2
 = TVapor
P = PVapor
Hg removed
T2
 = TVapor
P = PVapor
Hg removed
T3
 > TVapor
P < PVapor
Hg removed
Gas
Gas
Gas
P1 PV PV P3
Figure 3.2 Constant temperature test.❦
❦ ❦
❦
3.1 Phase Behavior 35
3.1.2 Pure Compound Phase Behavior
PVT cell experiments as described in the previous section allow to generate
vapor–liquid data to gain understanding of the phase transitions. Figure 3.3
shows isobaric transitions for a pure substance, below and above the critical
point. The vapor curve, represented by pressure versus temperature scales,
shows how a liquid state can transform into a vapor phase by increasing
temperature at constant pressure or vice versa.
Changes in temperature at pressures above the critical point take place
without noticeable variations at the vapor–liquid interface. Below the crit￾ical pressure, the phase change presents bubble formation at the interface
when the liquid temperature is increased.
Similarly, a liquid state can transform into a vapor state at constant tem￾perature by reducing the pressure, as illustrated in Figure 3.4. Again, pressure
changes above the critical temperature take place without distinctive
vapor–liquid interface variations.
Vapor pressure data are valuable for single-component fluid flow in
pipelines. However, hydrocarbon fluids are a much more complex blend
of thousands of components, posing a challenge to modeling the thermo￾dynamic behavior in the pressure–temperature domain.
Solid state
Pressure
Liquid state
T1 T2
Tv, Pv
T3 T4
Critical point
Temperature
Vapor state Vapor pressure line
Melt point l
ine
Triple point
Figure 3.3 Simple-component phase change at constant pressure.❦
❦ ❦
❦
36 3 Hydrocarbon Fluid Properties and Thermodynamics
Solid state
Pressure
Liquid state
p1
p2
Tv, Pv
p3
p4
Critical point
Temperature
Vapor state Vapor pressure line
Melt point l
ine
Triple point
Figure 3.4 Simple-component phase change at constant temperature.
3.1.3 Binary Systems
Blending two hydrocarbons at a time and determining the phase envelope
provide insight into the contribution of different boiling points toward the
thermodynamic performance of more complex mixtures. Thermodynamic
states enclosed within a certain envelope are coexisting states of vapor
and liquid in equilibrium. Sage and Lacey (1939) performed pioneering
research work with alkane hydrocarbon binary systems and also with
nitrogen, carbon dioxide, and hydrogen sulfide, determining the critical
loci for such systems. Thus, a multicomponent mixture of hydrocarbons
and other components can be considered as the superposition of individual
binary mixtures with distinctive phase envelopes.
3.1.4 Multicomponent Fluid Phase Behavior
Multicomponent hydrocarbon fluids in general are a rich fusion of hundreds
or thousands of components. The simulation of multicomponent mixture
properties requires focusing on the modeling of the dominating components
and adjusting based on PVT empirical data obtained from lab tests, to derive
a representative thermodynamic EOS.
Notice that the critical point of the mixture does not coincide with the
cricondenbar point. The bubble point and the dew point lines delimit the
condensate, the gas–liquid, and the gas regions in the P–T map. Figure 3.5
shows a handy tool to visualize the different phase areas crossed by a❦
❦ ❦
❦
3.1 Phase Behavior 37
‒150.0 ‒100.0 ‒50.0
Temperature (°C)
20
40
60
80
Pressure (bara)
100
120
140
0
0.0
Cricondentherm
Phase envelope ‒ gas example (78% C1)
Bubble-point line
Dew-point line
Critical point
Gas‒liquid mixture
Supercritical fluid
Condensate (liquid) Gas
50.0 100.0
Cricondenbar
Figure 3.5 Example of gas mixture phase envelope.
production fluid flowing through a pipeline. Notice the region above the
phase envelope denominated supercritical fluid. Fluids under supercritical
conditions (also referred to as dense fluid) exhibit blended properties
between the liquid and the vapor states, without clear transitions.
The assessment of supercritical fluid properties is beyond the scope of this
book. Consult Stephan and Lucas (1979) for a comprehensive review of
dense fluid properties. For a revision of the impact of supercritical fluid
properties in the simulation of a gas pipeline, please refer to Manzano-Ruiz
et al. (2014).
The hydrocarbon phase envelope in the pressure–temperature graph
could be understood as the mix of the individual binary envelopes addressed
in the previous section. Figure 3.5 shows an example of a natural gas phase
envelope, with a cricondenbar of 115 bar absolute and cricondentherm of
50 ∘C. The gas composition is presented in Table 3.1.
The interesting phenomenon of retrograde condensation in gas￾condensate fluids can be illustrated on a phase envelope graph. Figure 3.6
shows the isothermal path 1–2–3–4–5, whereby lowering gas pressure❦
❦ ❦
❦
38 3 Hydrocarbon Fluid Properties and Thermodynamics
Table 3.1 Example of a natural
gas composition.
Component Mole %
Methane 78.33
Ethane 9.65
Propane 6.63
i-Butane 0.98
n-Butane 2.70
i-Pentane 0.63
n-Pentane 0.64
n-Hexane 0.37
Heptane 0.07
100.00
Bubble point line
Pressure
Retrograde area
Dew point line
100% vapor
Temperature
0% vapor
2
3
4 20% 40% 60% 80%
5
Critical point
Figure 3.6 Retrograde condensation phenomenon.❦
❦ ❦
❦
3.2 Physical Properties 39
from point “1” to point “2” induces the first drops of condensate to appear.
Further pressure reductions below point “2” produce more condensate,
until reaching a maximum drop-out at point “3.” Further isothermal
pressure reductions on the mixture reverse the condensation process,
progressively starving the condensate phase, until reaching point “4” where
the mixture becomes fully vapor again. At temperatures lower than the
critical point, no retrograde condensation occurs.
3.2 Physical Properties
This section describes the principal thermodynamic and transport proper￾ties required to complement the conservation principles used to model mul￾tiphase flow in pipelines. Some of these properties have a direct effect on
momentum or energy conservation equations, but there are other proper￾ties, herein addressed, that have an indirect influence on multiphase flow
modeling via changes in the flow pattern. The properties needed apply to all
phases, namely oil, gas, produced water, and emulsions as well.
The emphasis in this section is on approximate correlations that have
an empirical basis, usually referred to as “black oil” correlations. Such an
approach, albeit with accuracy limitations, provides a fast way to generate
fluid properties in simulation work. The following section focuses on
models based on thermodynamic fundamental relationships labeled EOS.
Despite the more theoretical basis of the EOS, there is a minimum of
experimental input to incorporate the molecular force effects.
3.2.1 Gas Compressibility Factor
The gas compressibility factor “Z” accounts for the real gas effects associated
with molecules’ attractions and repulsions while using the modified ideal
gas model, as follows:
pV = ZnRT (3.1)
An isothermal example of the compressibility factor behavior is shown in
Figure 3.7, displaying the equilibrium shift among repulsive and attractive
molecular forces (i.e. the compressibility factor shows a minimum in the
plot).
Based on the concept of the corresponding states, Standing and Katz
(1944) plotted the gas compressibility factor as a function of the reduced
temperature (nondimensional absolute temperature, referenced to the crit￾ical temperature) and the reduced pressure (nondimensional pressure,❦
❦ ❦
❦
40 3 Hydrocarbon Fluid Properties and Thermodynamics
0.88
0.90
0.92
Z factor
0.94
0.96
0.98
1.00
0.86
0.84
0 500 1000
Pressure (psia)
Gas compressibility factor (T = 250 F)
1500 2000
Figure 3.7 Isothermal performance of gas compressibility factor.
referenced to the critical pressure). An alternative to the Standing and Katz
(1944) and GPSA (2012) compressibility factor graph is the correlation
published by Dranchuk and Abou-Kassem (1975), herein replicated in
terms of the reduced temperature, pressure, and density. The parameters
used in this correlation are summarized in Table 3.2.
Z = 1 + c1𝜌r + c2𝜌2
r − c3𝜌5
r + c4 (3.2)
𝜌r ≡ 0.27pr
ZTr
(3.3)
c1 = A1 +
A2
Tr
+
A3
T3
r
+
A4
T4
r
+
A5
T5
r
(3.4)
c2 = A6 +
A7
Tr
+
A8
T2
r
(3.5)
c3 = A9
(A7
Tr
+
A8
T2
r
)
(3.6)
c4 = A10 (
1 + A11𝜌2
r
) ( 𝜌2
r
T3
r
)
exp (
−A11𝜌2
r
) (3.7)❦
❦ ❦
❦
3.2 Physical Properties 41
Table 3.2 Dranchuk and
Abou-Kassem correlation
parameters.
A1 0.3265
A2 −1.0700
A3 −0.5339
A4 0.0157
A5 −0.0517
A6 0.5475
A7 −0.7361
A8 0.1844
A9 0.1056
A10 0.6134
A11 0.7210
The nondimensional reduced properties Tr and Pr are calculated with the
critical constants Tcrit (absolute temperature) and Pcrit, for pure substances,
or with pseudo-critical properties (Ppc and Tpc) for gas mixtures using the
following equations:
Tr ≡ T
Tcrit
(3.8)
Pr ≡ P
Pcrit
(3.9)
Pseudo-critical properties for mixtures can be estimated with Sutton
(1985) correlations using the gas-specific gravity as follows:
Ppc = 756.8 − 131𝛾g − 3.6𝛾2
g (3.10)
Tpc = 169.2 − 349.5γg − 74γ2
g (3.11)
3.2.2 Gas and Oil Density
The gas density can be estimated from equation (3.12) with the modified
ideal gas equation, the compressibility factor, and the gas molecular weight
MWg
𝜌g = ZRT
p
(3.12)❦
❦ ❦
❦
42 3 Hydrocarbon Fluid Properties and Thermodynamics
The gas standard conditions are 101.325 kPa (14.7 psia) and 15.6 ∘C
(60 ∘F). The nondimensional specific gravity concept refers the gas density
to the air density both at standard conditions:
𝛾g ≡
( 𝜌g
𝜌a
)
std
= MWg
28.97 (3.13)
The oil density being produced from the reservoir initially experiences a
reduction in value when the pressure is reduced (because of volume expan￾sion) until reaching the bubble point at the corresponding temperature.
Further pressure reductions below the bubble point produce an increment
in oil density because of gas-in-solution liberation. This effect is shown in
Figure 3.8.
An old but accurate correlation to estimate the oil density, as a function
of pressure and temperature and when the fluid composition is available,
was published by Standing and Katz (1942a,1942b), based on the standard
conditions pseudo-liquid density and pressure and temperature corrections.
Whitson and Brule (2000) provide an explicit correlation that closely fits the
Standing–Katz graph, and it is easy to program.
0 1000 2000 3000 4000 5000
Pressure (psia)
Oil density (lbm/ft3
) 35
40
45
50
Reservoir oil density (T = 250 F)
Figure 3.8 Oil density changes around the bubble point.❦
❦ ❦
❦
3.2 Physical Properties 43
3.2.3 Gas, Oil, and Water Viscosity
One of the most used correlations to estimate gas viscosity is Lee et al. (1966)
herein presented by equations (3.14) and (3.15) – with 𝜇g in centipoise, T in
degree Rankine, and 𝜌g in g/cm3. Other standard correlations can be found
in Whitson and Brule (2000).
𝜇g = (9.379 + 0.01607Mg)T1.5
104(209.2 + 19.26Mg + T)
exp [
𝜙𝜌(2.447−0.2224𝜙)
g
]
(3.14)
𝜙 = 3.448 +
986.4
T
+ 0.01009Mg (3.15)
A graph of liberated gas viscosity from a reservoir fluid is shown in
Figure 3.9 at a constant temperature.
Oil viscosity estimation depends on whether the fluid is undersaturated
or saturated with associated gas. Saturated oils are modeled based on the
viscosity of dead oil (gas-free oil) and solution gas/oil ratio. Undersaturated
oils are correlated with bubble point viscosity estimates. Figure 3.10 shows
a plot of oil viscosity at reservoir conditions.
0 500
0.005
0.000
0.015
0.010
0.020
1000
Pressure (psia)
1500 2000 2500
Liberated gas viscosity (T = 250 F)
Gas viscosity (cP)
Figure 3.9 Pressure effect upon gas viscosity at constant temperature.❦
❦ ❦
❦
44 3 Hydrocarbon Fluid Properties and Thermodynamics
0.00
0.10
0.20
0.30
Fluid viscosity (cP) 0.40
0.50
0.60
0.70
0.80
Reservoir fluid viscosity (T = 250 F)
0 1000 2000 3000 4000 5000
Pressure (psia)
Figure 3.10 Oil viscosity at constant temperature.
McCain (1990) correlated produced water density and viscosity with the
salinity “S” (weight % solids) by the following equations (density in kg/m3,
viscosity in centipoise, and temperature in degree centigrade):
𝜌w = 999 + 7.026S + 0.02564S2 (3.16)
𝜇w =
(
109.6 − 8.406S + 0.3133S2 +
8.722
103 S3
)
(1.8T + 32)
𝜙 (3.17)
𝜙 = −1.122 +
2.640
102 S − 6.795
104 S2 − 5.471
105 S3 +
1.556
106 S4 (3.18)
3.2.4 Solution Gas Ratio (Rs)
The produced oil phase always carries gas in solution, labeled associated
gas, and the specific property to characterize the amount of gas in solu￾tion at a specific temperature and pressure is the solution gas-oil ratio Rs.
Figure 3.11 shows how the solution gas-oil ratio changes with pressure at
reservoir temperature.
The rigorous method (Ahmed, 2007) to evaluate the solution gas-oil ratio
is based on the oil stock-tank specific gravity at standard condition, the oil❦
❦ ❦
❦
3.2 Physical Properties 45
0 1000 2000 3000 4000 5000
Pressure (psia)
Rs (scf/stb)
100
200
300
400
500
600
700
800
900
1000
1100
1200
1300
1400
0
Solution gas-oil ratio (T = 250 F)
Figure 3.11 Solution gas ratio at a constant temperature.
formation volume factor (see Section 3.2.6), the oil density (kg/m3) at the
pressure and temperature conditions, and the gas-specific gravity averaged
between the separator and the stock-tank conditions. The equation is
Rs = Bo𝜌o − 1000𝛾o
1.2𝛾g
(3.19)
3.2.5 Bubble Point
The bubble pressure correlations are based on the solution gas-oil ratio, the
gas-specific gravity, the oil gravity expressed in API, and the temperature.
McCain (1990) recommends using the gas-specific gravity from a sample
taken at a separator. Ahmed (2007) listed the best-known bubble point
correlations in full detail. These correlations are Standing, Lasater, Whitson
and Brule, Vasquez-Begg, Glaso, Marhoun, and Petrosky-Farshad. Here,
we present as an example the Standing correlation for the bubble point
pressure (Rs in sm3gas/sm3oil, pressure in bar abs., temperature in degree
centigrade):
pb = 1.255
⎡
⎢
⎢
⎣
10(0.00162T−0.0125API+0.0288)
(
5.615Rs
𝛾g
)0.83
− 1.4
⎤
⎥
⎥
⎦
(3.20)❦
❦ ❦
❦
46 3 Hydrocarbon Fluid Properties and Thermodynamics
3.2.6 Oil Formation Volume Factor (Bo)
The oil formation volume factor is a nondimensional parameter, determined
during the PVT laboratory tests, which measures the ratio of one barrel of
oil (including gas in solution) at reservoir conditions to the volume of the
dead oil at standard conditions.
The oil in reservoir conditions, at the start of production, usually is
undersaturated, meaning that the liquid phase cannot hold more gas in
solution. This can be appreciated in Figure 3.11 where the solution gas
ratio remains constant despite increments in pressure above the bubble
point.
During production, the oil volume at reservoir conditions expands due to
pressure reduction, which is reflected in Figure 3.12 by an increment in Bo
until reaching the bubble point. At pressures below the bubble point, the oil
phase volume contracts because gas begins to come out from the solution;
consequently, the value of Bo diminishes.
0 1000 2000 3000 4000 5000
Pressure (psia)
1.1
1.0
1.3
1.2
1.4
1.6
1.5
Bo (bbl/stb)
1.7
1.8
2.0
1.9
Oil formation volume factor (T = 250 F)
Figure 3.12 Oil formation value at a constant temperature at a constant
temperature.❦
❦ ❦
❦
3.3 Equation of State (EOS) 47
Gas formation volume factor (T = 250 F)
Bg (ft3/std. ft3
)
Pressure (psia)
0
0.0
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1.0
1.1
1.2
500 1000 1500 2000 2500
Figure 3.13 Gas formation volume factor at constant temperature.
A correlation for oil formation volume factor reported by Ahmed (2007)
follows, where the temperature is in degree Kelvin and Rs is in sm3 gas/sm3
oil.
Bo = 0.9759 + 0.000951
⎡
⎢
⎢
⎣
2.25T + Rs
√
Sg
So
⎤
⎥
⎥
⎦
1.2
(3.21)
3.2.7 Gas Formation Volume Factor (Bg)
The gas behavior in terms of volume changes is contrary to the oil volume
changes. Figure 3.13 reveals that Bg remains constant above the bubble point
but grows rapidly below the bubble point pressure. This behavior can be
explained by the enhanced compressibility of the gas phase.
3.3 Equation of State (EOS)
Without any doubt, the modern trend to generate the necessary fluid
properties rests on thermodynamic relationships based on equations of❦
❦ ❦
❦
48 3 Hydrocarbon Fluid Properties and Thermodynamics
state. There are numerous EOS proposed in the literature since the last
quarter of the nineteenth century, with varying degrees of success and
complexity to attempt to reproduce the data obtained at laboratories. This
section covers the mainstream equations of states that have found a solid
place of application for multiphase flow in pipelines. Many technical ref￾erences are available addressing this important topic of EOS, for instance,
Ahmed (2007), McCain (1990), Firoozabadi (1999), and Whitson and
Brule (2000).
In general, an EOS is a relationship between pressure, temperature, and
volume (i.e. density) with several coefficients that are tuned to match PVT
data. One example of such adjusting parameters, the binary-interaction
parameters (BIP), is covered in Section 3.3.8.
The EOS can be processed using thermodynamic relationships (James
Clerk Maxwell relationships) to derive various key thermal properties such
as enthalpy, specific heat, Joule–Thomson (JT) parameter, and speed of
sound. Furthermore, EOS is also used to obtain the important transport
properties of viscosity and thermal conductivity.
Mixtures of pure components pose a simulation challenge to the model
chosen to derive properties based on mixing rules (Danesh, 1998).
Despite the remarkable success of using EOS in multiphase flow simula￾tion work, it is important to point out two main downsides of this practice.
First, EOS does require broad tuning work to match PVT data before relying
on its predictive capability. Second, the computing time of multiphase
flow code employing EOS for point-to-point calculations (compositional
modules) is orders of magnitude larger than simulation codes that rely on
pre-estimated tables of fluid properties or partly on black oil correlations.
These two downsides demand careful judgment to define the required
accuracy in the fluid properties and the nature of the simulation, either
steady-state or transient simulations.
3.3.1 Ideal Gas
The simplest EOS is without doubt the ideal gas model proposed by
Clasius–Clapeyron in the nineteenth century, combining previous work
done by Boyle, Charles, Avogadro, and Gay-Lussac. The ideal gas behavior
is devoid of intermolecular forces and has a compressibility factor equal
to 1. In real applications, the ideal gas model finds a place at extremely low
pressures and elevated temperatures, and conditions necessary to neglect
the intermolecular forces of attraction and repulsion. The model equation
for ideal gas is equation (3.1) skipping the compressibility factor Z.❦
❦ ❦
❦
3.3 Equation of State (EOS) 49
3.3.2 Van der Waals
The Dutch scientist Johannes Diderik van der Waals published his famous
EOS in his Doctoral Dissertation in 1873. This remarkable research
contribution was not only a thermodynamic accomplishment in van der
Waals’s career, but he also proposed the model of the corresponding state
based on critical properties.
The value of the Van der Waals EOS is the surprisingly uncomplicated way
to account for the non-ideality of real gases influenced by intermolecular
forces. Presently, the Van der Waals EOS is not directly used in multiphase
flow simulations. This model is referred to as a two-parameter cubic EOS
because it has three roots for the gas volume within the two-phase domain.
This pioneering approach inspired the way to develop the cubic EOS with
enhanced accuracy, the most popular models currently in ample usage, such
as the Redlich–Kwong and Peng–Robinson EOS.
The impact of this EOS was to consider a term (co-volume b) to account
for molecule volume and the corrective term a/V2 for the attractive inter￾molecular forces. The EOS proposed is
p = RT
V − b − a
V2 (3.22)
Applying equation (3.22) at the critical point and comparing the equation
form with equation (3.1), it can be demonstrated that the compressibil￾ity factor is a constant (Zc) equal to 0.375 for any gas according to this
EOS. Real gases though have lower Zc because of the complexity of the
intermolecular forces which are not well characterized by the simple
model expressed by equation (3.22). At low pressure, the gas volume V
is large compared to the co-volume, and the attractive forces are weak.
Thus, the gas behavior follows the ideal gas law, equation (3.1), with the
compressibility factor equal to 1.
The model of the corresponding states proposed by Van der Waals opened
the way to generalize gas behavior simulation scaled with the critical
properties via reduced nondimensional parameters, see equations (3.8) and
(3.9). This scaling modeling allowed us to capture, in a single plot such as
Figure 3.9, the intricate behavior of the compressibility factor.
3.3.3 Benedict–Webb–Rubin
The BWR EOS is an old (1931) but accurate model with a number of empir￾ical constants that are derived from laboratory tests, although many simple
hydrocarbon constants are already tabulated (McCain, 1990). Despite the
accuracy that can be attained with the BWR EOS to estimate thermodynamic❦
❦ ❦
❦
50 3 Hydrocarbon Fluid Properties and Thermodynamics
parameters, its use is limited because of the intractable mixture’s rules. The
EOS is
p = RT
VM
+
B0RT − A0 − C0∕T2
V2
M
+
bRT − a
V3
M
+
a𝛼
V6
M
+
c
T2V3
M
(
1 + 𝛾
V2
M
)
exp (
− 𝛾
V2
M
)
(3.23)
Please refer to McCain (1990) for the tabulated constants for alkanes to
C7, some non-hydrocarbons, and some olefins.
3.3.4 Redlich–Kwong
Redlich and Kwong (1949) proposed an innovative cubic EOS inspired
by the work of Van der Waals, well received because of its simplicity and
remarkable success in modeling thermodynamic properties. Two decades
later, Soave (1972) improved the constants of the Redlich–Kwong model
making it a favorite for practitioners of multiphase flow and process
engineering, becoming the Soave–Redlich–Kwong (SRK) EOS. The SRK
model for a simple substance is
[
p +
aT
VM(VM + b)
]
(VM + b) = RT (3.24)
The constants aT and b are determined from the following equations and
the Pitzer acentric factor 𝜔 (McCain, 1990):
aT = 0.42747 (RTc)
2
pc
[1 + (0.480 + 1.574𝜔 − 0.176𝜔2
)(1 − √Tr)]2
(3.25)
b = 0.08664
RTc
pc
(3.26)
𝜔 = − (
1 + log10
pvap
pc
)
(3.27)
3.3.5 Peng–Robinson
Peng and Robinson (1976) published a slightly different EOS to the SRK
EOS. The volume term was modified in order to improve the predictions
of liquid density. PR EOS for a simple substance is
[
p +
aT
VM(VM + b) + b(VM + b)
]
(VM + b) = RT (3.28)
aT = 0.45724 (RTc)
2
pc
[1 + (0.480 + 1.574𝜔 − 0.176𝜔2)(1 − √Tr)]2
(3.29)❦
❦ ❦
❦
3.3 Equation of State (EOS) 51
b = 0.07780
RTc
pc
(3.30)
3.3.6 Other Equations of State
The use of cubic EOS for multiphase flow outweighs the use of any other.
However, accuracy requirements have motivated us to develop more
advanced EOS for specific applications. Two of the best-known equations
of state are GERG (Kunz and Wagner, 2012) developed for natural gas
applications and PC-SAFT (Gross and Sadowski, 2001) based on statistical
mechanics but inspired by the virial equation of state (McCain, 1990).
GERG-2008 EOS is often used for natural gas custody transfer applications
and also for estimating LNG properties. PC-SAFT is an EOS that is gaining
more attention in flow assurance applications at substantial risk of wax and
asphaltene deposition.
Another important EOS is Lee and Kesler (1975), based on the BWR EOS
and focused on properties deviation from reference substances and scaling
following the law of corresponding states. It is recognized that the LK EOS
provides the best estimates of enthalpy.
3.3.7 Equilibrium and Fugacity Coefficient
Thermodynamics is a science based on equilibrium states, and for the case
of two coexisting phases, it establishes the principle of balanced chemical
potentials. What this means is that there is an equal flux of vapor molecules
and liquid molecules changing phase at any time. The function that
measures the potential is the fugacity “f ” function, and its ratio with the
system pressure is known as the fugacity coefficient “𝜙.” The importance
of the fugacity concept is that under liquid–vapor equilibrium, for a pure
substance or for a mixture of pure substances, the liquid fugacity function
should match the vapor fugacity function.
It is easy to demonstrate (McCain, 1990) that cubic EOS such as SRK and
PR can be transformed into a cubic equation in terms of compressibility
factor, namely
Z3 − (1 − B)Z2 + (A − 2B − 3B2
)Z − (AB − B2 − B3
) = 0 (3.31)
where the constants A and B are given by
A = aTp
(RT)2
(3.32)
B = bp
RT
(3.33)
and the parameters aT and b are obtained from equations (3.25) and (3.26),
or equations (3.29) and (3.30), depending on the EOS chosen.❦
❦ ❦
❦
52 3 Hydrocarbon Fluid Properties and Thermodynamics
Equation (3.31) is cubic, and the three roots may be either three real roots
or one real root and two conjugate complex roots. For liquid and vapor in
equilibrium, three real roots can be solved from equation (3.31), applied to
both phases. The smallest root is the liquid compressibility factor ZL, and
the largest root is the gas compressibility factor ZG.
When the pressure and temperature are known for a vapor–liquid equilib￾rium state of a pure substance, the compressibility factors allow to calculate
the densities of either phase from the following equations:
𝜌L = pML
ZLRT
(3.34)
𝜌G = pMG
ZGRT
(3.35)
If either temperature or pressure of the vapor–liquid equilibrium is
unknown, a trial-and-error solution is required to match the fugacity
coefficients of the phases, by assuming the unknown parameter. The liquid
and vapor fugacity coefficients are
𝜙L = exp [
(ZL − 1) − Ln(ZL − B) − 0.3536A
B
Ln (ZL + 3.828B
ZL − 1.828B
)]
(3.36)
𝜙G = exp [
(ZG − 1) − Ln(ZG − B) − 0.3536A
B
Ln (ZG + 3.828B
ZG − 1.828B
)]
(3.37)
3.3.8 Mixing Rules
Mixing rules are necessary to obtain weighted-average properties for real
production fluids. The fluids from oil and gas wells have thousands of
components that pose a challenge to characterize their phase behavior.
Judgment is required to focus on the dominating components and their
interactions through mixing rules applied to the EOS. There have been
several mixing rules proposed to estimate multicomponent mixture prop￾erties, but by far the most popular is Kay’s rule (Kay, 1936) of mixing for
its simplicity. This rule defines gas pseudo-critical properties based on the
molar fractions and the components’ critical properties as follows:
ppc = ∑i=n
i=1
yi
pc,i (3.38)
Tpc = ∑i=n
i=1
yi
Tc,i (3.39)❦
❦ ❦
❦
3.4 C7
+ Characterization 53
Vpc = ∑i=n
i=1
yi
Vc,i (3.40)
Kay’s mixing rule applied to the liquid phase reads as follows:
aT,L = ∑i=n
i=1
∑
j=n
j=1
[xi
xj
√aT,i
aT, j
(1 − 𝛿i, j
)] (3.41)
AL = aT,Lp
(RT)2
(3.42)
bL = ∑i=n
i=1
xi
bi (3.43)
BL = bLp
RT
(3.44)
enabling to estimate the liquid compressibility factor and the liquid fugacity
coefficient from the following equations:
Z3
L − (1 − BL)Z2
L + (
AL − 2BL − 3B2
L
)
ZL − (
ALBL − B2
L − B3
L
)
= 0
(3.45)
𝜙L,j = exp[
(ZL − 1)𝜍L,j − Ln(ZL − BL) −
0.3536AL
BL
(𝜓L,j − 𝜍L,j
)
× Ln (ZL + 3.828BL
ZL − 1.828BL
)] (3.46)
𝜓L,j ≡
(2
√aT,j
)
i
∑=n
i=1
xi
(1 − 𝛿i,j
)
√aT,i
aT,L
(3.47)
𝜍L,j ≡ bj
bL
(3.48)
The parameter 𝛿i,j is known as the BIP which accounts for the interactions
among different molecules of the multicomponent mixture. In general, in
regular simulations, it is assumed that 𝛿i,j =0; however, these parameters
serve to adjust (i.e. tune) the EOS model to improve the match with labo￾ratory PVT data. Lists of typical 𝛿i,j parameters are offered by Whitson and
Brule (2000) and Firoozabadi (1999). The Kay’s mixing rule applied to the
gas phase is equivalent to equations (3.41) through (3.48) making the corre￾sponding changes in fluid properties.
3.4 C7
+ Characterization
The objective of the characterization task is to expand the heavy-end fraction
of the fluid mixture seeking to get a better match with PVT data with the❦
❦ ❦
❦
54 3 Hydrocarbon Fluid Properties and Thermodynamics
selected EOS. A customary way to report production fluid composition is a
list of alkanes from C1 through n-C6, N2, CO2, H2S, and C7
+. The heavy ends
comprising the higher molecular weight substances are usually lumped into
the C7
+ fraction and reporting the equivalent molecular weight and density
of such fraction.
Properties simulation based on this type of composition normally
yields poor results because lumping thousands of components into the
single C7
+ fraction simply is too ambitious. Therefore, a characteriza￾tion of the C7
+ fraction is routinely performed to generate a number of
pseudo-components, with their own molecular weight and density data,
which will provide flexibility to match laboratory tests.
A source of generalized properties of petroleum groups is Whitson and
Brule (2000), providing average boiling temperature, specific gravity, acen￾tric factor, critical properties, and molecular weight for carbon numbers
from C7 to C45+.
There are a few methods to characterize the C7
+ fraction, for instance,
Whitson and Brule (2000), Ahmed (2007), and Pedersen et al. (2015). These
methods divide the plus fraction into several carbon number fractions
(pseudo-components) and define their properties, guaranteeing that the
molar-averaged molecular weight and density match the C7
+ fraction
respective property data.
3.5 Thermal and Transport Properties
The prediction of thermal properties is currently dominated by thermo￾dynamic relationships derived from EOS. This is covered in the next four
subsections.
Transport properties depend on laboratory data, as described in Section
3.2.3 for the already addressed dynamic viscosity property.
3.5.1 Enthalpy
The enthalpy property, as a function of pressure and temperature, can be
derived (Riazi, 2005) from the first law of thermodynamics and the defi￾nition of heat capacity (see next section) to obtain the change in enthalpy,
equation (3.49), between two states:
dH = CpdT +
[
V − T
(𝜕V
𝜕T
)
p
]
dp (3.49)❦
❦ ❦
❦
3.5 Thermal and Transport Properties 55
The residual enthalpy function is evaluated at constant temperature and
measures the departure of said property from the reference state of ideal gas
as follows:
[H − H(i)
]T = ∫
p
0
[
V − T
(𝜕V
𝜕T
)
p
]
dp (3.50)
The nondimensional residual enthalpy function can be obtained by evalu￾ating the bracket term under the integral sign with an appropriate EOS. This
nondimensional ratio becomes
[H − H(i)
]T
RT
= −T∫
p
0
(𝜕Z
𝜕T
)
p
dp
p
(3.51)
It has become customary to introduce the scaling parameters of the
corresponding states principle into equation (3.51) and use the Lee and
Kesler (1975) EOS, as shown in the next equation. The latter provides the
best estimates of enthalpy function as compared to using cubic equations of
state.
[
H − H(i)
RTc
]
Tr
= −T2
r ∫
p
0
( 𝜕Z
𝜕Tr
)
pr
dpr
pr
(3.52)
The enthalpy property can be obtained from equation (3.53) with the help
of tabulated results for the residual enthalpy, Lee and Kesler (1975).
H = H(i) + RTc
[
H − H(i)
RTc
]
Tr
(3.53)
3.5.2 Heat Capacity
The heat capacity property is defined by equation (3.54):
Cp ≡
(𝜕H
𝜕T
)
p
(3.54)
Using Maxwell’s relationships, it can be shown (Riazi, 2005) the following
equation ready for evaluation with a proper EOS:
Cp = −T
(𝜕2V
𝜕T2
)
p
(3.55)
Similarly, it is convenient to evaluate the residual heat capacity through
an isothermal path for easier calculation:
Cp − C(i)
p = −∫
p
0
[
T
(𝜕2V
𝜕T2
)
p
]
T
dp (3.56)❦
❦ ❦
❦
56 3 Hydrocarbon Fluid Properties and Thermodynamics
3.5.3 Joule–Thomson Coefficient
The Joule–Thomson (J–T) coefficient is defined by equation (3.57) as the
change in temperature due to a pressure change at constant enthalpy. Gases
typically chill during a pressure reduction and oils usually warm during
the pressure expansion. This behavior evolves because the J–T coefficient
changes sign at a point called the inversion temperature. Most gases have
a high inversion point as compared to the local temperature and therefore
when they expand the temperature drops. On the contrary, oils have a low
inversion point compared to the local temperature, and thus they warm on
expansion. The J–T coefficient property is particularly useful to character￾ize throttling processes such as passage through a choke valve. The partial
derivative is determined with the help of a proper EOS.
𝜂 ≡
(𝜕T
𝜕p
)
H
(3.57)
3.5.4 Speed of Sound
The speed of sound is a property associated with the fluid compressibility
under the assumption of an isentropic process. Phenomena that take place
at high velocity may experience drastic changes in fluid elasticity. A common
way to measure the fluid elastic is using the isentropic compressibility factor
defined by equation (3.58):
𝛽s ≡ 1
𝜌
(𝜕𝜌
𝜕p
)
s
(3.58)
The isentropic compressibility is closely related to the definition of speed
of sound, equation (3.59). The speed of sound is an important physical
parameter measuring how fast perturbations in the flow field can propagate.
The application of equation (3.59) to single-phase flow is straightforward
but not so for multiphase flow (please refer to Section 7.3 addressing critical
flow):
c =
√(𝜕p
𝜕𝜌)
S
= 1
√𝜌𝛽s
(3.59)
When the fluid velocity reaches the local speed of sound, the phenomenon
of choking sets in. One typical scenario where large velocity might develop
is in small flow areas or constrictions. Any pressure reduction downstream
of the choked point becomes insensitive to the upstream fluid flow because
perturbations created downstream cannot migrate upstream because the
fluid travels at the speed of sound.❦
❦ ❦
❦
3.6 Types of Hydrocarbon Fluids 57
Very rarely, the flow chokes in multiphase flow through pipelines, except
in choke valves with large pressure drops across it, or at the location of a
pipe rupture with loss of containment.
3.5.5 Thermal Conductivity
Prediction methodologies for thermal conductivity are not well developed
as compared to other properties. Pedersen et al. (2015) have condensed
the state of the art of estimating thermal conductivity based on the law of
corresponding states and some complex rules applicable to hydrocarbon
mixtures. An old but effective correlation for oils in general was published
by Cragoe (1929) herein reproduced (temperature in degree centigrade and
thermal conductivity in Wm-K),
k ≃ 1.406
So
(1 − 0.00054T) (3.60)
3.5.6 Surface Tension
Oil surface tension can be estimated with the following correlation (Riazi,
2005), where Kw is the Watson parameter, Tr is the reduced temperature,
and the surface tension is in dyne-cm:
𝜎 = 673.7(1 − Tr)
1.232
KW
(3.61)
3.6 Types of Hydrocarbon Fluids
It is customary to classify hydrocarbons into five generic groups with com￾mon characteristics and corresponding modeling approaches. These five
groups are black oils, volatile oils, retrograde gas condensate, wet gas, and
dry gas. Not surprisingly, there are no sharp boundaries among these five
types of hydrocarbons and the following subsections depict generic phase
behaviors.
3.6.1 Black Oils
Black oil fluid refers to a multicomponent hydrocarbon mixture with a
critical temperature relatively higher than the reservoir temperature of the
fluid. In other words, the locus of dew points is shifted far to the right of the
isotherm crossing the reservoir conditions. This means that the production
process never crosses the dew point line when entering the two-phase❦
❦ ❦
❦
58 3 Hydrocarbon Fluid Properties and Thermodynamics
Temperature
Topsides Vapor state
Liquid state
Dew point
80% liq.
50% liq.
30% liq.
Critical point
Bubble point
Reservoir
Pressure
Figure 3.14 Black oil typical phase envelope.
envelope. The hydrocarbon expansion process goes from liquid state to
two-phase state passing the bubble point line.
In general, the black oil fluid could be modeled well with black oil
correlations previously addressed, sparing somehow the need to employ
more time-consuming EOS estimations. Figure 3.14 shows a sketch of how
a typical black oil fluid envelope would look like.
3.6.2 Volatile Oils
Volatile oil fluid is a lighter hydrocarbon mixture with a critical tempera￾ture closer to the reservoir temperature of the fluid but still larger than the
reservoir temperature. The locus of dew points is also shifted to the right
of the isotherm crossing the reservoir conditions, signaling that the produc￾tion process never crosses the dew point line. The hydrocarbon expansion
process also goes from liquid state to two-phase state passing the bubble
point line.
In general, the volatile oil fluid needs to employ the EOS approach because
the neighborhood of the critical point requires greater accuracy for good
modeling. Figure 3.15 illustrates a typical volatile oil fluid envelope.❦
❦ ❦
❦
3.6 Types of Hydrocarbon Fluids 59
Pressure
Temperature
Vapor state Topsides
Liquid
Critical
point
Dew point Bubble point
30% liq.
80% liq.
50% liq.
Reservoir
Figure 3.15 Volatile oil phase envelope.
3.6.3 Retrograde Gas Condensate
The retrograde gas fluid mixture has a reservoir temperature larger than the
critical temperature but lower than the cricondentherm. The locus of bubble
points is shifted to the left of the isotherm crossing the reservoir conditions,
signaling that the production process will cross the dew point line into the
two-phase state.
The retrograde gas fluid not only will need to employ an accurate EOS
approach, but the flowline calculations will require compositional
modeling.
Figure 3.16 shows a sketch of a typical retrograde gas fluid envelope.
3.6.4 Wet Gas
The wet gas fluid mixture has a reservoir temperature lower than the cricon￾dentherm. Retrograde behavior may or may not be observed. The two-phase
state is approached by crossing the dew point.
The wet gas fluid can be modeled with the EOS approach, or with black
oil models for gases (if there is no retrograde behavior). Figure 3.17 shows a
sketch of a typical wet gas fluid envelope.❦
❦ ❦
❦
60 3 Hydrocarbon Fluid Properties and Thermodynamics Pressure
Temperature
Topsides Vapor state
20% liq. 10% liq.
Critical
point
Dew
point
Liquid
Reservoir
Bubble point
80% liq.
50% liq.
Figure 3.16 Retrograde gas phase envelope. Pressure
Temperature
Vapor state
Bubble point
Topsides
Liquid
Critical
point
Dew
point
Reservoir
5% liq.
25% liq.
50% liq.
Figure 3.17 Wet gas phase behavior.❦
❦ ❦
❦
3.7 PVT Analyses 61
Pressure
Temperature
Vapor state Topsides
Liquid
Dew
point
Critical
point
Reservoir
Bubble point
1% liq.
25% liq.
Figure 3.18 Dry gas phase behavior.
3.6.5 Dry Gas
The dry gas fluid mixture has a reservoir temperature higher than the
cricondentherm. Two-phase states might or might not be observed in the
field application because of the large fraction of light alkanes in the fluid
mixture.
The dry gas fluid can be well modeled with the simpler EOS (3.1) and the
compressibility factor correlation or graph. Figure 3.18 illustrates a typical
dry gas fluid envelope.
3.7 PVT Analyses
This section reviews the typical PVT lab tests performed to gain an under￾standing of the production fluid. Although the majority of the tests are
focused on the fluid performance at reservoir conditions, before production
starts and during depletion, useful data are gathered to tune and character￾ize the EOS of state chosen to model the fluid. The following subsections
briefly address the typical tests captured in the PVT report.❦
❦ ❦
❦
62 3 Hydrocarbon Fluid Properties and Thermodynamics
Obviously, a paramount requisite to perform the PVT work is to have avail￾able a good-quality and representative sample, in enough quantity to enable
several tests. This implies not only the sampling procedure in the field but
also the sample preservation during the transporting to the lab. Samples in
general can be gathered downhole the well, or at the wellhead, or at a nearby
separator equipment on the topsides or at the well pad. During the sam￾pling process, it is necessary to have a stable (quasi-steady-state) production
flow. Flowrate(s), pressure, and temperature at the sampling port shall be
recorded with the greatest accuracy possible, in order to recreate the down￾hole conditions as much as possible.
3.7.1 Constant Composition Expansion (CCE)
CCE is a standard PVT test that allows to determine the saturation point
(Pb) at isothermal reservoir conditions (usually the CCE reports only
the reservoir temperature) by gradually reducing the PVT cell pressure.
A volumetric relationship as a function of pressure is determined during
the test as illustrated in Figure 3.19.
The PVT cell equipment utilized to conduct a CCE test is sketched in
Figure 3.20.
The test results from a CCE are plotted in Figure 3.21, from which the
saturation point can be determined.
3.7.2 Constant Volume Depletion (CVD)
In general, this kind of test is performed in the lab for volatile oil and ret￾rograde gas fluids. This test simulates a depletion process, for a constant
volume reservoir producing rich gas, while in thermodynamic equilibrium
with liquid fraction present. It differs from the differential liberation test
Reservoir
fluid
Hg Hg Hg
Oil
Gas
Gas
Gas
Gas
Oil
Oil
Oil Hg Hg Hg
Reservoir
fluid
p > psat p = psat p1
 < psat p2
 < p1 p3
 < p2 p4
 < p3
Figure 3.19 Constant composition expansion at constant temperature.❦
❦ ❦
❦
3.7 PVT Analyses 63
Figure 3.20 PVT cell
equipment for CCE tests.
PVT cell
Thermostat
Pressure
gauge
Mercury
pump
Figure 3.21
Saturation point
determination for a
black oil from CCE
test results.
Pressure
Volume
Psat = Pbubble
(see next subsection) in that no gas is withdrawn. This test is performed for
fluids where large volumes of gas are released from solution during pressure
expansion.
3.7.3 Differential Liberation (DL)
DL reproduces the reservoir depletion process, and the test involves isother￾mal withdrawal of mass from the PVT cell. Thus, this test gives the reservoir
engineers a hint about how the fluid will change during the production life
cycle. Volumetric and compositional data are obtained from the DL test.
Typical parameters derived from the test are the relative volumes of gas and
oil for each pressure level, the gas in solution Rs, and the gas compressibility❦
❦ ❦
❦
64 3 Hydrocarbon Fluid Properties and Thermodynamics
Reservoir
fluid Oil
Hg Hg
Oil
Gas
Hg
Oil
Gas
Hg
Oil
Hg
Oil
Hg
Repeat
n
times
Oil
Hg
Oil
Hg
p > psat p = psat p1
 < psat p1 p2 p2 (p0
, Tres)
V2
 (Gas, p0 V , 60 F) 1
 (Gas, p0
, 60 F)
(p0
, 60 F)
Figure 3.22 Differential liberation process at constant temperature.
factor Z at each pressure. In summary, the DL could provide a wealth of
information to attempt to match with a tuned EOS. A tuned EOS is critical
to feed accurate properties to the mass, momentum, and energy balances of
the simulation task. A sketch of the DL process is shown in Figure 3.22.
3.7.4 Separator Test
The PVT study may include a separator test, at a single or at different pres￾sure levels. The objective of this work is to mimic in the lab the separation
stages of a future field operation. Samples of liquids and gas are taken from
each stage of separation to determine gas and oil composition. Gas–oil ratio
(GOR) is calculated at each stage, and in particular at stock-tank conditions,
and adjusted for standard temperature. This information is useful to mini￾mize oil tank boil-off during storage.
Separator lab tests can be used to check the equilibrium constants
obtained with EOS flash simulations and build trust in the property
modeling for steady-state and dynamic simulations.
3.7.5 Viscosities
The two more common laboratory tests for oil viscosity are the rolling ball
and the capillary tube viscometer. The first method (RBV) comprises a
sphere inside a tube with minimal clearance, which rolls down a specific
length (between two detectors) under a tube inclination; the travel time of
the rolling ball is recorded and used in a correlation for this meter.
The second method (CTV) measures the pressure drop across the capil￾lary length, for a given and controlled flowrate of the fluid (using a constant
flowrate pump). The oil viscosity is determined by assuming laminar flow
and using Poiseuille equation for pipe flow. Figure 3.23 illustrates the equip￾ment of a capillary tube viscometer.❦
❦ ❦
❦
3.8 Strategy for Modeling Fluid Properties 65
Coil
Cell Thermostat
Pressure gauge
Constant flowrate
pump
Separator DP
transducer
Figure 3.23 Capillary tube viscometer.
3.8 Strategy for Modeling Fluid Properties
The importance of estimating the thermodynamic and transport phenom￾ena properties has been emphasized throughout this chapter. However,
there are practical questions to address, for example,
● What is better, a compositional tracking module or property tables to
interpolate?
● Does the black oil model have any place in modeling, or the use of EOS is
necessary?
● How should we handle a case where different streams, with different com￾positions, meet/blend at a point in the system (e.g. manifolds, daisy-chain
tie-in)?
● Are there shortcuts for reducing the computing time of compositional
modeling (e.g. curve fitting)?
The questions above concern not only the novice to the field of multiphase
flow modeling in pipelines but also the skilled practitioner who has access
to commercial tools. The answers provided here are generic because each
case should be evaluated independently.
3.8.1 Compositional versus Tabular
Most modern commercial codes come with an integrated properties’ pack￾age (from other suppliers) that seamlessly interfaces with the calculation❦
❦ ❦
❦
66 3 Hydrocarbon Fluid Properties and Thermodynamics
engine for multiphase flow modeling. Therefore, while setting up the
steady-state or the transient case, it is required to decide if a compositional
analysis will be done at every cell of the calculation domain (the overall
production system). If we look back at Sections 3.3.4 through 3.5.2, we
realize the huge amount of iterative calculations that would be done at
each cell to obtain densities, vapor or liquid fraction, enthalpies, and
heat capacities. Therefore, we would use compositional tracking modules
only when absolutely necessary. Thus, the economy in computational
time achieved by using pre-calculated property tables and point-to-point
interpolation dominates most projects.
Examples of applications where compositional modeling accuracy makes
a difference include commingling of different composition streams, retro￾grade gas applications, operation near the critical point of the production
fluid, and deposition of wax or asphaltene.
3.8.2 EOS or Black Oil Models
EOS is more accurate (although more complex) and has a wider range of
applications than black oil models that originated from a database with
limited validity. Nevertheless, there are certain cases where black oil models
do a decent job and are orders of magnitude faster to calculate as compared
to EOS. Examples of potential application of black oil models are dry gas
fluids, black oil fluids, and sometimes wet gases as well.
3.8.3 Blending of Different Streams
Modeling a tie-in point of two or more different composition streams (e.g.
well clusters/manifolds) poses quite a challenge. Although pre-calculated
interpolation tables of properties may be available for the blending streams,
the issue is to know in advance the commingling ratio of the streams, that
is, the mass flowrates of each stream are unknown and depend on the
thermo-hydraulic analysis of the overall production system – it becomes an
iterative trial-and-error problem. In these cases, the use of a compositional
tracking module is indicated at the excessive cost of computational time.
A more rudimentary approach to avoid compositional tracking and
solve the commingling issue of two streams would be creating a set of
interpolation of tables for the blended (“child”) stream as a function of the
commingling ratio of the “parent” streams.
● Evaluate fluid properties for each parent stream using interpolation tables
upstream of the tie-in point,❦
❦ ❦
❦
References 67
● Create tables of properties for a family of blending ratios say, by steps of
10% change,
● Carry the integration of the system of differential equations using the cor￾responding boundary conditions but assuming some mass flowrate,
● Interpolate mass flowrate once two assumed ratios bracket the solution,
● With the interpolated mass flowrate, do the interpolations of properties
for the child stream based on the properties of the parent streams.
3.9 Commercial Software
There are many commercial codes capable of performing accurate thermo￾dynamic calculations with a multiplicity of equations of state to choose from.
Given the difficulty of performing such calculations, it is quite common
to integrate properties estimating software into multiphase flow simula￾tors with seamless performance. This integration enables compositional
analyses point-to-point but at a high computational (i.e. time) cost.
To save computational time most codes offer the option of creating
pre-calculated tables of properties for interpolation during the execution of
the dynamic multiphase flow code.
Please refer to the Appendix of this book for a brief summary of commer￾cial codes.
References
Ahmed, T. (2007). Equations of State and PVT Analysis. Houston, Texas, USA:
Gulf Publishing Company.
Cragoe, C. (1929). Thermal Properties of Petroleum Products. Washington:
United States Government Printing Office.
Danesh, A. (1998). PVT and Phase Behavior of Petroleum Reservoir Fluids.
Amsterdam, The Netherlands: Elsevier.
Dranchuk, P. and Abou-Kassem, J. (1975). Calculation of Z Factors for Natural
Gases using Equations of State. J. Pet. Technol. 36–36.
Firoozabadi, A. (1999). Thermodynamics of Hydrocarbon Reservoirs. New York,
New York, USA: McGraw-Hill.
GPSA (2012). Engineering Data Book, 13e, vol. FPS Vol. I and II. Tulsa,
Oklahoma, USA: GPSA.
Gross, J. and Sadowski, G. (2001). Perturbated-Chain SAFT: And Equation of
State Based on Perturbation Theory for Chain Molecules. Ind. Eng. Chem.
Res. 40: 1244–1260.❦
❦ ❦
❦
68 3 Hydrocarbon Fluid Properties and Thermodynamics
Kunz, O. and Wagner, W. (2012). The GERG-2008 Wide Range Equation of
State for Natural Gases and Other Mixtures: An Expansion of GERG-2004.
J. Chem. Eng. Data 57: 3032–3091.
Lee, A., Gonzalez, M., and Eakin, B. (1966). The Viscosity of Natural Gases.
J. Pet. Technol. 237: 997–1000.
Lee, B. and Kesler, M. (1975). A Generalized Thermodynamic Correlation
Based on Three-parameter Corresponding States. AICHE J. 21: 510–527.
Kay, W. (1936). Density of Hydrocarbon Gases and Vapors at High Pressure and
Temperature. Ind. Eng. Chem. 28: 1014–1019.
Manzano-Ruiz, J., Lu, Y., Janardhanan, K., and Liang, C., “Natural-Gas
Supercritical Fluid Properties Characterization for Pipeline Applications,”
GPA Convention Mobilizing Midstream: A Global Connection, Dallas,
Texas, USA (2014).
McCain, W. (1990). Petroleum Fluids, 2e. Tulsa, Oklahoma, USA: PennWell
Books.
Pedersen, K., Christensen, P., and Shaikh, J. (2015). Phase Behavior of
Petroleum Reservoir Fluids, 2e. Boca Raton, Florida, USA: CRC Press.
Peng, D. and Robinson, D. (1976). A New Two-constant Equation of State.
Ind. Eng. Chem. Fundam. 15 (1): 59–64.
Redlich, O. and Kwong, J. (1949). On the Thermodynamics of Solutions – An
Equation of State. Chem. Rev. 44: 233–244.
Riazi, M. (2005). Characterization and Properties of Petroleum Fractions. West
Conshohocken, PA, USA: ASTM International.
Sage, B. and Lacey, W. (1939). Volumetric and Phase Behavior of Hydrocarbons.
Stanford, California, USA: Standford University Press.
Soave, G. (1972). Equilibrium Constants From a Modified Redlich-Kwong
Equation of State. Chem. Eng. Sci. 27 (6): 1197–1203.
Standing, M. and Katz, D. (1942a). Density of Natural Gas. Trans. AIME 146:
140–149.
Standing, M. and Katz, D. (1942b). Density of Crude Oils Saturated with
Natural Gas. Trans. AIME 146: 159–165.
Standing, M. and Katz, D. (1944). Vapor-Liquid Equilibria of Natural
Gas-Crude Oil Systems. Trans. AIME 155: 232–245.
Stephan, K. and Lucas, K. (1979). Viscosity of Dense Fluids. New York, New
York, USA: Plenum Press.
Sutton, R. (1985). Compressibility Factors for High-Molecular Weight Reservoir
Gases. Richardson, TX, USA: SPE Paper 14265.
Whitson, C. and Brule, M. (2000). Phase Behavior. Richardson, TX, USA:
Society of Petroleum Engineers Inc.❦
❦ ❦
❦
69
4
Multiphase Flow Patterns
4.1 Gas–Liquid Flow
The processes a hydrocarbon mixture is exposed while flowing through
a production system causes pressure and temperature drops. One
can visualize the thermodynamic path of the mixture in a pressure–
temperature plot to verify what saturation line (either bubble or dew point)
will be crossed while entering the gas–liquid region. Crossing the phase
envelope into a two-phase region produces a few small bubbles (bubble
point) or liquid droplets (dew point) which start to increase in number
while agglomerating into larger volume particles.
Figure 4.1 shows a picture of a diabatic flow (with heat transfer at the
boundary) transitioning from a few isolated bubbles in the continuous liq￾uid phase (bubbly flow), followed by formation of a large centerline bubble
(plug flow), followed by rupture of the large bubble and gas channeling at
the centerline (churn flow), and finally liquid swept radially out with a clear
core of centered gas phase and a few small droplets in it (annular-mist flow).
It is obvious from Figure 4.1 that it is impossible to computationally track
every fluid particle in the flow domain at every instant of time. Two-phase
flow modeling requires simplifications and assumptions that are focused on
each generic flow regime, to make tractable the solution of the system of
equations. These simplifications center on properties time-variance, liquid–
gas interface shear and mass transfer, and cross-sectional averaging of fluid
and flow properties.
Multiphase Transport of Hydrocarbons in Pipes, First Edition.
Juan J. Manzano-Ruiz and Jose G. Carballo.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
Companion Website: www.wiley.com/go/Manzano-Ruiz/Multiphasetransport❦
❦ ❦
❦
70 4 Multiphase Flow Patterns
Two-phase flow evolution (diabatic flow)
Separated two-phase flow
Dispersed two-phase flow
Bubbles Droplets
Gas
Liquid
Figure 4.1 Evolution of gas phase in two-phase horizontal flow.
4.2 Dispersed versus Separated Flow Regimes
One striking and high-level characteristic of two-phase flow in pipelines
arising from flow observations is that regimes could be broadly classified in
either dispersed or separated flows. Dispersed refers to a pattern comprising
many small particles (bubbles or droplets) surrounded by a connected con￾tinuous phase, as depicted in Figure 4.1 at the bottom. Separated two-phase
flow implies distinctive streams of continuous phase, with entrained parti￾cles, interacting between them, as shown in the middle of Figure 4.1. These
two-phase flow regimes could preserve their phase distribution character￾istics when the heat transfer at the boundary is limited or negligible (i.e.
adiabatic flow).
When heat transfer is considerable at the piping boundary (i.e. diabatic
flow such as evaporation or condensation), the flow characteristic evolves
along the flow path. The top picture in Figure 4.1 shows an evolving regime
of two-phase flow.❦
❦ ❦
❦
4.3 Vertical and Inclined Flow Maps 71
Dispersed and separated flow regimes are different mechanisms driving
the balance of forces at play. Dispersed flows are dominated by surface
tension and drag forces acting on the particles entrained in a continuous
medium. Separated flows are driven by fluids’ density difference or by the
fluid motion in turbulent flow (Brennen, 2005).
4.3 Vertical and Inclined Flow Maps
Multiphase upward flow in pipelines, either vertical or inclined, shows a
trend toward axisymmetric patterns. Two extreme regimes that exhibit this
clear trend of symmetry are the bubbly and the annular upward flow. Some
slight departure from symmetry is shown by intermediate regimes such as
plug-slug and churn flows. For slow liquid velocity in vertical flow, a remark￾able symmetrical Taylor bubble (Taylor, 1950) rises while liquid slides on the
sides of the bubble. Plug flow resembles the flow of a Taylor bubble but often
shows a “skirt” end with a trail of small bubbles. Refer to Figure 2.1 for the
types of vertical two-phase upflow.
Patterns such as slug and churn are intermittent in nature, meaning that
there is some approximation to cycling flow where a pattern is repeated
periodically. However, the prediction of the liquid slug frequency and the
length of the slug is quite challenging using principles, and empirical rules
are often used.
Upward flow in inclined pipelines departs from the symmetry observed
in true vertical flow. Bubbles tend to move driven by buoyancy toward the
upper zones of the pipe. However, it is customary to use the vertical flow
pattern maps to identify regimes when the inclination is less than ±10∘ with
respect to the vertical direction. Figure 4.2 sketches the common patterns in
inclined flow.
One of the first flow maps developed for vertical upward flow is Hewitt and
Roberts (1969). Although this map was set up from small diameter tubing
and air/water fluids, it is still in use to qualitatively estimate flow regime.
Bubbly flow Slug flow Churn flow Annular flow
Figure 4.2 Typical flow patterns of upward-inclined flow.❦
❦ ❦
❦
72 4 Multiphase Flow Patterns
1.E+04
1.E+03
Hewitt‒Roberts (1969)
1.E+02
1.E+01
1.E+00
1.E+00 1.E+01
Churn flow Bubbly flow
Plug flow
Annular flow Wispy-Annular flow
1.E+02 1.E+03 1.E+04 1.E+05
1.E‒01
𝜖G j
G
2 (kg/ms2)
𝜖L j
L
2 (kg/ms2)
Figure 4.3 Vertical flow map. Source: Hewitt and Roberts (1969)/U.S. Department
of Energy/Public domain.
The coordinates of this map represent the superficial momentum of liquid
and gas. Figure 4.3 shows this flow map.
One more recent flow pattern map, with a mechanistic background, was
published by Taitel et al. (1980). Figure 4.4 shows this mechanistic flow map.
4.4 Quasi-Horizontal Flow Maps
Horizontal flow regimes are greatly influenced by the gravity force. Two
distinctive limits are experimentally observed. At low gas superficial
velocity and high liquid superficial velocity bubbly flow predominates. At
exceedingly high gas superficial velocities there is a clear trend toward
annular flow, characterized by liquid flow close to the pipe wall, and gas
moving faster around the pipe centerline.
For two-phase pipe flow subject to significant heat transfer rates (i.e.
diabatic flow) at the boundary wall, for example, liquid evaporation in a❦
❦ ❦
❦
4.4 Quasi-Horizontal Flow Maps 73
1.E+01
1.E+02
1.E+03
1.E+00
1.E‒01
1.E‒02
1.E+00
Taitel‒Barnea‒Dukler (1980)
1.E‒02 1.E‒01 1.E+01 1.E+02 1.E+03
j
L (m/s)
j
G (m/s)
Bubbly flow
Churn-Slug flow Annular flow
Dispersed-bubble flow
Figure 4.4 Vertical flow map. Source: Adapted from Taitel et al. (1980).
Flow inlet
Single-phase
liquid
Bubbly
flow
Plug
flow
Slug
flow
Churn
flow
Annular
flow
Droplet
flow
Single-phase
vapor
Flow outlet
Heated pipe
Two-phase flow
Figure 4.5 Diabatic gas–liquid horizontal flow in regime transition. Licensed
under CC BY.
heat exchanger, the flow may experience several pattern transitions in short
spans, as depicted in Figure 4.5.
Given the complexity of the flow dynamics when more than one phase
is present, the interest of researchers in classifying the flow regimes began
in the 1940s. Baker (1954) published the first flow pattern map based on❦
❦ ❦
❦
74 4 Multiphase Flow Patterns
field-scale oil and gas pipeline observations. Although this map is in disuse,
it is still amenable for hand-calculation confirmation of the flow regime in
small-size piping (≈ 50 mm). The coordinates for Baker’s map are the nondi￾mensional parameters 𝜆 and𝜓 based on fluid properties (see Figure 4.6). The
parameters are calculated with the following equations and with the water
and air properties at standard conditions:
𝜆 ≡
√𝜌g
𝜌a
𝜌l
𝜌w
(4.1)
𝜓 ≡
(𝜎w
𝜎l
) [
𝜇l
𝜇w
(𝜌w
𝜌l
)2
]1∕3
(4.2)
Mandhane et al. (1974) published a horizontal flow pattern map
(Figure 4.7) that has found great popularity due to its simple coordinates
(superficial velocity). The authors based their study on the most compre￾hensive database available at the time, the AGA-API Two-Phase Flow Data
(kg/ms2)
1.E+02
Wavy flow Annular flow
Stratified flow
Slug flow
Plug flow
Bubbly
flow
Dispersed flow
1.E+01
1.E+00
1.E‒01
GL𝜝 (kg/ms2)
1.E+00 1.E+01 1.E+02 1.E+03 1.E+04
𝜐
GG
Baker (1954)
λ ρG ρL
ρL
⅓
ρair ρwater
ρwater σwater
σ μwater
μL
≡
ψ ≡
Figure 4.6 Flow pattern map for horizontal pipeline. Source: Adapted from Baker
(1954).❦
❦ ❦
❦
4.4 Quasi-Horizontal Flow Maps 75
Wavy flow
Annular flow
Dispersed buble flow
Stratified flow
Slug flow
Bubbly flow
1.E+01
1.E+00
1.E‒01
1.E‒02
1.E–01 1.E 1.E+00 1.E+01 +02
Mandhane (1973)
Figure 4.7 Flow pattern map for horizontal pipeline. Source: Mandhane et al.
(1974)/Elsevier.
Bank, and also added additional data points. The core of the data used for
the flow map is air–water data containing more than one thousand test
points. Estimates obtained from this map show the right trends although
they are biased toward fluids with properties similar to air and water.
The first mechanistic pattern map for semi-horizontal flow was proposed
by Taitel and Dukler (1976), better known as a T–D map. The regime
transitions of this map, based on physical phenomena principles, provide a
solid foundation not found in previous pattern maps empirically derived.
Obviously, the map transitions could not be fully developed on principles,
but additional experimental data permitted to close the models.
The unifying criterion in this map is that all regimes are converted into
an equivalent separated flow model, that is, stratified two-phase flow. The
one-dimensional equations of mass and momentum conservation yield a set
of algebraic equations in terms of the nondimensional parameters X, Y, and
the liquid non-dimensional depth hL/d. The parameter X is the square root
of the Lockhart–Martinelli parameter (Shoham, 2006). The parameter X is❦
❦ ❦
❦
76 4 Multiphase Flow Patterns
calculated from equation (4.3):
X ≡
(1 − x
x
)0.9( 𝜇L
𝜇G
)0.1(𝜌G
𝜌L
)0.5
(4.3)
The parameter Y accounts for the gravitation effect on the momentum
equation, and it is estimated from equation (4.4). This model applies to any
pipe inclination 𝜃 (i.e. the angle with respect to the horizontal direction).
Y = 10.87(𝜌L − 𝜌G)g sin 𝜃
(d0.8𝜇0.2
G
j
1.8
G 𝜌1.2
G
)
(4.4)
Taitel and Dukler (1976), in their original paper, included the nonlin￾ear equation (7), which is the algebraic relationship between X, Y, and
the equivalent liquid depth hL/d. All terms in the algebraic equation
are nondimensional. Such equation (7) from the original paper could be
solved iteratively to obtain the equivalent liquid depth hL/d. Otherwise,
the authors offer a graphical solution in Figure (2) of their paper with the
same objective. Figure (2) was subsequently corrected by Dukler and Taitel
(1982) with a factor of 840 multiplying the Y values of Figure (2).
The regimes’ transitions, according to the Taitel and Dukler (1976)
model, depend on the parameters F and T which can be calculated with
equations (4.5) and (4.6).
● Stratified to non-stratified (for annular-dispersed and intermittent flows)
transition,
F = jG
√gd cos 𝜃
√ 𝜌G
𝜌L − 𝜌G
(4.5)
● Intermittent to annular-dispersed transition,
T =
√
2fL,S𝜌L j
2
L
(𝜌L − 𝜌G)gd cos 𝜃 (4.6)
Using the parameters X, T, and F, it is possible to identify the flow pattern
for gas–liquid flow using the map shown in Figure 4.8.
The void fraction 𝛼 (or holdup HL) can be determined by solving
equations (4.7) and (4.8). The subtended angle 𝜑 corresponds to the
equivalent stratified flow regime and defines the interface gas–liquid.
𝜑 = 2cos−1
(2hL
d − 1
)
(4.7)
𝛼 = 𝜑 − sin 𝜑
2𝜋 (4.8)
The transition between annular dispersed and dispersed bubble in the
map was assumed to occur at hL/d ≈0.35 (X ≈1.61).❦
❦ ❦
❦
4.5 Liquid–Liquid Flow Map 77
Intermittent flow
Annular-Dispersed flow Dispersed Bubble flow
Stratified flow
1.E+01
1.E+00
1.E‒01
1.E‒02
1.E‒03
X (Lockhart‒Martinelli parameter)
T and F parameters
1.E‒03 1.E 1.E‒02 1.E–01 1.E 1.E+00 1.E+01 +02 +03 1.E+04
Taitel‒Dukler (1976)
Figure 4.8 Flow pattern map for horizontal pipeline. Source: Adapted from Taitel
and Dukler (1976).
4.5 Liquid–Liquid Flow Map
Two-phase liquid–liquid flow has a propensity to form droplets at the inter￾face of stratified flow patterns (Sunder Raj et al., 2005) of immiscible fluids.
In two-phase gas–liquid flows, the interface evolves into a larger bubble or
plug, or in a developed slug. This performance difference between liquid–
liquid and gas–liquid flows prevents the extension of the latter flow
pattern maps.
The literature available concerning flow regimes in liquid–liquid flow is
limited. A classic and pioneering reference in this area is Govier and Aziz
(1972). Presently, such maps have a visualization value rather than being
a regular tool supporting mechanistic models for momentum and energy
balances. Ibarra et al. (2014) performed experiments and identified nine
possible flow patterns in liquid–liquid flow, namely stratified, stratified
wavy, dispersions of oil-in-water and water-in-oil with/without continuous
layer, dual continuous, intermittent, and annular flow. Sunder Raj et al.
(2005) observed regime transitions by increasing the superficial velocity of❦
❦ ❦
❦
78 4 Multiphase Flow Patterns
Dispersed
oil in water
Stratified wavy
Dual
continuous
Dispersed
water in oil
Stratified/Stratified
wavy
Dual continuous
Rivulet
0.2 0.3 0.4
Oil superficial velocity (m/s)
0.0 0.1 0.5 0.6
0.1
0.2
0.3
Water superficial velocity (m/s)
0.4
0.5
0.6
0.7
Edomwonyi‒Otu and Angeli (2015)
0.8
0.9
0.0
Figure 4.9 Liquid–liquid flow map. Source: Edomwonyi-Otu and Angeli
(2015)/Elsevier.
the lighter kerosene liquid. Progressively, the flow pattern changed from
smooth-stratified flow, water at the bottom, to stratified wavy. Further
increment of the flow rate of kerosene led to form fine drops of water
dispersed in the top layer.
Three-layer pattern would form by further increments in the superficial
velocities, with a combination of droplets of both phases at the interface.
More recently, Edomwonyi-Out and Angeli (2015) published a flow pattern
map for the horizontal flow of oil and water based on the superficial veloci￾ties of the phases. This plot is shown in Figure 4.9.
4.6 Three-Phase Flow
Three-phase flow in a horizontal pipe is sensitive to the magnitude of
the superficial velocities of the phases. Smooth-stratified flow pattern
is observed for low superficial liquid velocities and low gas velocities.
For increased liquid velocity, there is a probability that the gas becomes❦
❦ ❦
❦
4.7 Liquid–Solid Flow 79
1.0E+00
1.0E‒01
1.0E‒01 1.0E+00
Lee (1993)
1.0E+01
Liquids superficial velocity (m/s)
Gas superficial velocity (m/s)
Rolling wave
Annular
Pseudo
slug
Plug
Slug
Wavy
stratified
Smooth stratified
Figure 4.10 Flow pattern map for three-phase flow. Source: Adapted from Lee
and Lee (1993).
entrained within the liquid phases, as well as bubbles may flow along the
pipe’s top. Interface instabilities develop with further increments in liquid
flow and slug flow may set in. In general, slug flow becomes the dominating
pattern at high liquids’ superficial velocities.
There are few three-phase flow patterns available due to the richness of
flow regimes (and the means to identify and define the regime transitions).
One of these flow maps is by Lee and Lee (1993) herein presented in
Figure 4.10.
4.7 Liquid–Solid Flow
There is an extensive list of liquid–solid literature driven by the interest
in slurry flow through pipelines. Comprehensive monographs include
Nayyar (2000), Crowe (2006), Cheremisinoff (1986), and Govier and Aziz
(1972). There are several applications of slurry transport such as minerals❦
❦ ❦
❦
80 4 Multiphase Flow Patterns
in water flows, industrial paints, coal–oil mixtures, and even some rocket
fuel applications.
The distinction of liquid–solid slurries is the particle size, which in the
case of fine elements enables the particles’ suspension in the continuous
phase and lessens the settling tendency. In this regard, turbulence level
contributes to enhance particle drag while promoting a trend of axisym￾metric particle concentration profile. However, liquid flow rate reduction
leads to particle settling toward the bottom of horizontal pipelines, named
asymmetric suspension flow pattern. The asymmetric flow pattern con￾duces to particle bouncing off from formed “dunes”, agglomerating settled
particles.
The complexity of liquid–solid flows cannot be captured in a single-flow
pattern map, as it is approximated in the case of gas–liquid flow. Doron
and Barnea (1996) demonstrated that flow pattern maps at least depend
on the particles’ relative density to the carrier liquid, on the particles’
average size, on the pipe diameter, and on the concentration of particles.
Doron‒Barnea map (1996)
10.0
1.0
0.1
0.01 0.10 1.00
Superficial velocity of solids (m/s)
10.00
Stationary bed
Moving bed
Blockage
Full suspension
Superficial velocity of liquid (m/s)
Figure 4.11 Solid–liquid flow map. Source: Adapted from Doron and Barnea
(1996).❦
❦ ❦
❦
4.8 Gas–Solid Flow 81
Concisely, several maps may be required to identify a dominating flow
pattern. An example of a flow pattern map describing typical flow regimes
is shown in Figure 4.11 taken from Doron and Barnea (1996). The solid
particles were 3 mm in diameter and had a density of 1240 kg/m3, flowing
in a water stream.
4.8 Gas–Solid Flow
The flow of solids in gas pipeline streams shares several characteristics with
the liquid–solid flows as well. The main difference is the higher gas veloc￾ities, and turbulence, required to keep particles suspended in the carrier
stream. This holds true because in pneumatic solid transport the relative
density between solids and gas is larger than in solid–liquid flows, causing
a diminished buoyancy effect. Additionally, drag force of gas carrier upon
particles is proportional to its density, which involves larger gas velocity to
entrain the solid particles.
As for liquid–solid flows, it is difficult to cast the potential flow patterns
of gas–solid flows into a single map. Similar comments apply to the present
case of gas–solid flows as in the previous section. A sketch illustrating
typical flow patterns encountered in pneumatic solid transport is shown in
Figure 4.12.
Figure 4.12 Typical gas–solid flow
regimes in horizontal flow.
Homogeneous flow
Dune flow
Slug flow
Packed bed❦
❦ ❦
❦
82 4 Multiphase Flow Patterns
4.9 Conclusions
This chapter summarizes some visualization tools to identify typical
multiphase flow structures, that is, flow patterns or regimes, based on
simple coordinates related to flow rate or superficial velocity. It is not
always possible to develop a single map, as for solid–liquid and solid–gas
flows, due to the number of governing parameters that hinder a simple
approach. The case of gas–liquid flows has been extensively studied, and
there is more clarity as to the possibility of casting several flow regimes
onto a 2-D map. However, the factor underpinning the transition among
flow regimes is the stability criteria to balance dynamical forces. One of
these criteria, if not the most important of all, is the Kelvin–Helmholtz
instability conducive to the formation/amplification of interfacial waves.
Another important criterion is the balance between surface tension forces
and turbulent stresses that determine the size and the number of droplets
and bubbles formed at shear layers of the continuous phase.
The value of a representative flow pattern maps cannot be underrated
because of the associated issues of idealistic sharp transitions and uncer￾tainty in defining a specific regime; flow pattern maps do help develop
valuable mechanistic models, applicable to specific regimes and with better
chance of simulating the physics of the flow.
References
Baker, O. (1954). Simultaneous Flow of Oil and Gas. Oil Gas J. 53: 185–195.
Brennen, C. (2005). Fundamentals of Multiphase Flow. Cambridge, U.K.:
Cambridge University Press.
Cheremisinoff, N. (1986). “Encyclopedia of Fluid Mechanics,” Vol. 5, “Slurry
Flow Technology”. Houston, Texas: Gulf Publishing Company.
Doron, P. and Barnea, D. (1996). Flow Pattern Map for Solid-Liquid Flow in
Pipes. Int. J. Multiphase Flow 22 (2): 273–283.
Dukler, A. and Taitel, Y. (1982). Lecture Notes of the Two-Phase Gas-Liquid Flow
course. University of Houston, Chemical Engineering Department.
Crowe, C. (2006). Multiphase Flow Handbook. Boca Raton, FL, USA: CRC
Taylor & Francis.
Edomwonyi-Otu, L. and Angeli, P. (2015). Pressure Drop and Holdup
Predictions in Horizontal Oil-Water Flows for Curved and Wavy Interfaces.
Chem. Eng. Res. Des. 93: 55–65.
Govier, G. and Aziz, K. (1972). The Flow of Complex Mixtures in Pipes.
New York, USA: Van Nostrand Reinhold Company.❦
❦ ❦
❦
References 83
Hewitt, G. and Roberts, D. (1969). “Studies of Two-Phase Flow Patterns,”
AERE-M2159.
Ibarra, R., Markides, C., and Matar, O. (2014). A Review of Liquid-Liquid Flow
Patterns in Horizontal and Slightly Inclined Pipes. Multiph. Sci. Technol.
26 (3): 171–198.
Lee, A. and Lee, A.H. (1993). Study of Flow Regime transitions for Oil-Water-Gas
Mixture in Large Diameter Horizontal Pipelines, MSc thesis. College of
Engineering and Technology, Ohio University.
Mandhane, J. et al. (1974). A Flow Pattern Map for Gas-Liquid Flow in
Horizontal Pipes. Int. J. Multiphase Flow 1: 537–553.
Nayyar, M. (2000). Piping Handbook, 7e. New Yor, USA: McGraw-Hill.
Shoham, O. (2006). Mechanistic Modeling of Gas-Liquid Two-Phase Flow in
Pipes. Richardson, Texas, USA: Society of Petroleum Engineers.
Sunder Raj, T., Chakrabarti, D., and Das, G. (2005). Liquid-Liquid Stratified
Flow Through Horizontal Conduits. Chem. Eng. Technol. 28 (8): 899–907.
Taitel, Y., Barnea, D., and Dukler, A.E. (1980). Modeling Flow Pattern
Transition for Steady Upward Gas-Liquid Flow in Vertical Tubes. AICHE J.
26 (3): 345–354.
Taylor, G.I. (1950). The Mechanics of Large Bubbles Rising Through Extended
Liquids and Through Liquids in Tubes. Proc. R. Soc. A CC: 375–390.
Taitel, Y. and Dukler, A. (1976). A Model of Predicting Flow Regime Transitions
in Horizontal and Near Horizontal Gas-Liquid Flow. AICHE J. 22: 47–55.❦
❦ ❦
❦❦
❦ ❦
❦
85
5
Two-Phase Flow in Pipelines
5.1 Introduction
The conservation equations for two-phase flow are covered in this chapter,
followed by the boundary and initial conditions necessary to close the
system of differential equations. Additional constitutive equations and
empirical (field practitioners) or semi-empirical (lab researchers) models
can make the system of equations tractable. Purely empirical correlations
derive from field measurements and some nondimensional post-processing
analysis. Therefore, such empiricism may only succeed when the applica￾tion operating conditions match the conditions under which the original
data were gathered.
The energy conservation equation plays a vital role, jointly with the mass
and momentum equations, to link fluid properties, temperature changes,
and heat transfer to the surrounding environment. The coverage of this key
principle is included in one section of this chapter.
The overarching goal for this chapter is to thoroughly cover the funda￾mentals of the governing thermal-hydraulic models expressing the changes
experienced by a multiphase flow mixture through pipelines.
5.2 Conservation Principles
The foundations of the physical principles applied to multiphase flow were
cast in the publications of Delhaye (1968, 1981). Delhaye’s work sets the
framework for the local instantaneous equations addressed in Section 5.2.1.
However, the intricacy of the resulting set of equations demands approxi￾mations inspired by the experimental work and the empirical data gathered
Multiphase Transport of Hydrocarbons in Pipes, First Edition.
Juan J. Manzano-Ruiz and Jose G. Carballo.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
Companion Website: www.wiley.com/go/Manzano-Ruiz/Multiphasetransport❦
❦ ❦
❦
86 5 Two-Phase Flow in Pipelines
during the past 80 years. The approximations include space-averaged and/or
time-averaged, leading to simplified composite-averaged equations. The pop￾ular one- and two-dimensional modelsimplemented in commercial transient
codes nowadays become the simulation standard to design and monitor the
thermal-hydraulics of hydrocarbons through production gathering systems.
Aside from the space- and time-averaged models another useful approach
is to consider two limiting topologies, the disperse and the separated
topologies (Brennen, 2005), embracing the variety of spatial distribution
flow patterns. A dispersed topology may be either bubbles entrained within
a continuum liquid medium or droplets distributed within a gas phase.
A separated topology comprises two or more continuum media with
distinctive interface(s).
5.2.1 Local Instantaneous Equations
The conservation principles in this section are presented in their integral
form, applied to a fixed control volume encompassing both the liquid and the
gas phases. The instantaneous equations in integral form rely on the identi￾fication of the fraction of control volume occupied by each phase (Vg,Vl
) and
the fraction of the control surface (Ag,Al
) per phase. Figure 5.1 illustrates the
mass conservation in integral form, equation (5.1), for a control volume.
Mas∶
d
dt
⎡
⎢
⎢
⎢
⎣
∫
Vg
𝜌gdV + ∫
Vl
𝜌l
dV
⎤
⎥
⎥
⎥
⎦
+ ∫
Ag
𝜌g(u⃗g ∘ n⃗g)dA + ∫
Al
𝜌l
(u⃗l ∘ n⃗l
)dA = 0
(5.1)
In the momentum conservation principle, equation (5.2), the acting
surface forces are represented by the stress tensor (surface pressure and
shear stresses), and the volume force is represented by the gravity force.
𝜌g(ug o ng m = )dA
g,net
∙
Ag
→ → 𝜌l
(ul
 o nl m = )dA l,net
∙
Al
→ →
ΔL
𝜌g = dV + dMCV
Vg
𝜌l
dV
Vl
d
dt dt
Figure 5.1 Mass conservation equation for a control volume.❦
❦ ❦
❦
5.2 Conservation Principles 87
𝜌l
ul
Al
→ (ul
 o nl
→ →
)dA
𝜌gug
Ag
→
(ug o ng
→ →
)dA
Ap (p + dp)
pAp
ΔL
𝜃
Vl
𝜏l
 o nl dA ( (
𝜌l
Ag
𝜏g o ng
dA ( (
𝜌g
→ → 𝜌g
Vg
ugdV ul
dV
+ 𝜌l d
Vl dt
→ → 𝜌g
Vg
gdV gdV + 𝜌l
Vl
Figure 5.2 Momentum balance on a control volume element.
The summation of the acting forces and the net flux of momentum through
the control surface shall be equal to the net change in fluid momentum of
both phases within the control volume. The overall balance is shown in
Figure 5.2.
MM∶
d
dt
⎡
⎢
⎢
⎢
⎣
∫
Vg
𝜌gu⃗gdV + ∫
Vl
𝜌l
u⃗l
dV
⎤
⎥
⎥
⎥
⎦
+ ∫
Ag
𝜌gu⃗g(u⃗g ∘ n⃗g)dA + ∫
Al
𝜌l
u⃗l
(u⃗l ∘ n⃗l
)dA
= ∫
Ag
𝜌g(𝜏⃗g ∘ n⃗g)dA + ∫
Al
𝜌l
(𝜏⃗l ∘ n⃗l
)dA + ∫
Vg
𝜌ggdV ⃗ + ∫
Vl
𝜌l
gdV ⃗ (5.2)
where the stress tensor has nine components as shown in equation (5.3) for
cylindrical coordinates:
𝜏⃗ ≡
⎛
⎜
⎜
⎝
−p + 𝜏rr 𝜏rz 𝜏r𝜃
𝜏zr −p + 𝜏zz 𝜏z𝜃
𝜏𝜃r 𝜏𝜃z −p + 𝜏𝜃𝜃
⎞
⎟
⎟
⎠
(5.3)
The stress tensor for the gas phase and the liquid phase should be deter￾mined and introduced into equation (5.2). The shear stress components of
the stress tensor relate to the viscous effects through Stokes equations (Brod￾key, 1967).
The energy conservation principle in its integral form, equation (5.4),
involves work terms associated with gravitational force and shear stress on❦
❦ ❦
❦
88 5 Two-Phase Flow in Pipelines
𝜌g(ng o qg)dA +
Vg
→ → 𝜌l
(nl
 o ql
)dA
Vl
→ →
ΔL
Vg
ng o 𝜏g o ug ( ( dA+
Vl
nl
 o 𝜏l o ul ( ( dA
𝜌g
Vg
ug ( o g dV ( + 𝜌l
Vl
ul ( o g dV(
𝜌g
Vg
Ag
e dV+ dV g+ 𝜌l
Vl
d
dt
ug
2
2 el +
ul
2
2
𝜌l
Ag
hl +
ul
2
2 (ul
 o nl
)dA → →
𝜌g hg+
ug
2
2 (ug o ng)dA → →
Figure 5.3 Conservation of total energy for a control volume.
the control surface. There are also heat flux terms across the control surface
incrementing the total energy inside the control volume, and there is a flow
of enthalpy per phase through the control surface. The summation of the
previous term’s balances with the change of internal and kinetic energy
inside the control volume. Such balance is sketched in Figure 5.3.
∶
d
dt
⎡
⎢
⎢
⎢
⎣
∫
Vg
𝜌g
(
eg +
u2
g
2
)
dV + ∫
Vl
𝜌l
(
el +
u2
l
2
)
dV
⎤
⎥
⎥
⎥
⎦
= ∫
Ag
𝜌g
(
Hg +
u2
g
2
)
(u⃗g ∘ n⃗g)dA + ∫
Al
𝜌l
(
Hl +
u2
l
2
)
(u⃗l ∘ n⃗l
)dA
+ ∫
Vg
𝜌g(u⃗g ∘ g⃗)dV + ∫
Vl
𝜌l
(u⃗l ∘ g⃗)dV
+ ∫
Vg
(n⃗g ∘ 𝜏⃗g) ∘ u⃗gdA + ∫
Vl
(n⃗l ∘ 𝜏⃗l
) ∘ u⃗l
dA
+ ∫
Vg
𝜌g(n⃗g ∘ q⃗g)dA + ∫
Vl
𝜌l
(n⃗l ∘ q⃗l
)dA (5.4)
The difficulty of the integral-form approach is accounting for the time
and space variations of the surfaces of discontinuity, that is, phase interfaces.
Such surfaces of discontinuity require additional jump conditions to connect
the properties of the two phases. Extensive coverage of appropriate jump
conditions can be found in Delhaye’s (1981) book.❦
❦ ❦
❦
5.3 Space-Averaged Equations 89
The integral balance principles can be transformed into partial differential
equations utilizing the Leibniz rule and the Gauss theorem as follows for
each phase:
● Mass conservation (continuity equation)
𝜕𝜌g
𝜕t +∇∘(𝜌gu⃗g) = 0 (5.5)
𝜕𝜌l
𝜕t +∇∘(𝜌l
u⃗l
) = 0 (5.6)
● Momentum conservation
𝜕𝜌gu⃗g
𝜕t
+ u⃗g[∇ ∘ (𝜌gu⃗g)] = 𝜌gg⃗ +∇∘ 𝜏⃗g (5.7)
𝜕𝜌l
u⃗l
𝜕t
+ u⃗l
[∇ ∘ (𝜌l
u⃗l
)] = 𝜌l
g⃗ +∇∘ 𝜏⃗l (5.8)
● Energy conservation
𝜕
𝜕t
[
𝜌g
(
eg +
u2
g
2
)] +∇∘ [
𝜌gu⃗g
(
hg +
u2
g
2
)]
= 𝜌gg⃗ ∘ u⃗g +∇∘(𝜏⃗g ∘ u⃗g)+∇∘ q⃗g (5.9)
Equations (5.5)–(5.9) are the rigorous backbone of the multiphase flow
modeling through pipelines.
5.3 Space-Averaged Equations
The application of equations from the previous section is most challeng￾ing due to the space distribution of the phases. The space-averaging process
on pipeline geometries rests on the integration of the governing PDEs at
cross-sections. Average gas and liquid mass flow, velocities, momentum, and
energy represent a compromise between accuracy and simplicity.
A rigorous treatment of the space-averaging processes can be found in Del￾haye (1982), supported by the Gauss theorems and the Leibniz rule. The
space-averaging technique involves splitting the pipeline cross-section into
gas area and liquid area, separated by the interface boundary C(z,t). The
phase cross-sectional averaging operator is denoted with angle brackets, as
defined by equation (5.10) for a generic property “f ,”
⟨fg⟩g ≡ 1
Ag ∫
Ag(z,t)
fg(r,z,𝜃,t)dA
⟨fl
⟩l ≡ 1
Al ∫
Al(z,t)
fl
(r,z,𝜃,t)dA (5.10)❦
❦ ❦
❦
90 5 Two-Phase Flow in Pipelines
The space-averaging technique yields the following set of equations that
include integrals that have to be evaluated along the interface gas–liquid,
the interface gas–pipe, and the interface liquid–pipe:
● Mass conservation of gas
𝜕
𝜕t
[Ag⟨𝜌g⟩] + 𝜕
𝜕z
[Ag⟨𝜌gug⟩]=Γg (5.11)
Γg = volumetric mass transfer rate into the gas phase
= − ∫
C(z,t)
𝜌g(u⃗g − u⃗i
) ∘ n⃗gdC
n⃗g ∘ n⃗g,C
(5.12)
● Mass conservation of liquid
𝜕
𝜕t
[Al
⟨𝜌l
⟩] + 𝜕
𝜕z
[Al
⟨𝜌l
ul
⟩]=Γl (5.13)
Γl = volumetric mass transfer rate into the liquid phase
= − ∫
C(z,t)
𝜌l
(u⃗l − u⃗i
) ∘ n⃗l
dC
n⃗l ∘ n⃗l,C
(5.14)
and Γg + Γl = 0 is a boundary condition at the gas–liquid interface, also
referred to as a “jump condition.”
● Gas-phase momentum
𝜕
𝜕t
[Ag⟨𝜌gu⃗g⟩] + 𝜕
𝜕z
[Ag⟨𝜌gugu⃗g⟩]
= Ag⟨𝜌gg⃗⟩ − 𝜕
𝜕z
[Ag⟨pgn⃗z⟩] + 𝜕
𝜕z
[Ag⟨n⃗z ∘ 𝜏⃗g⟩]
− ∫
C(z,t)
[𝜌gu⃗g(u⃗g − u⃗i
) ∘ n⃗g − n⃗g ∘ 𝜏⃗g]dC
n⃗g ∘ n⃗g,C
+ ∫
C(z,t)
n⃗g ∘ 𝜏⃗gdC
n⃗g ∘ n⃗g,C
(5.15)
● Liquid-phase momentum
𝜕
𝜕t
[Al
⟨𝜌l
u⃗l
⟩] + 𝜕
𝜕z
[Al
⟨𝜌l
ul
u⃗l
⟩]
= Al
⟨𝜌l
g⃗⟩ − 𝜕
𝜕z
[Al
⟨pl
n⃗z⟩] + 𝜕
𝜕z
[Al
⟨n⃗z ∘ 𝜏⃗l
⟩]
− ∫
C(z,t)
[𝜌l
u⃗l
(u⃗l − u⃗i
) ∘ n⃗l − n⃗l ∘ 𝜏⃗l
]dC
n⃗l ∘ n⃗l,C
+ ∫
C(z,t)
n⃗l ∘ 𝜏⃗l
dC
n⃗l ∘ n⃗l,C
(5.16)❦
❦ ❦
❦
5.4 Time-Averaged Equations 91
● Gas-phase energy conservation
𝜕
𝜕t
[
Ag
⟨
𝜌g
(
eg +
u2
g
2
)⟩] +
𝜕
𝜕z
[
Ag
⟨
𝜌gug
(
hg +
u2
g
2
)⟩]
= Ag⟨𝜌gg⃗ ∘ u⃗g⟩ +
𝜕
𝜕z
[Ag⟨(𝜏⃗g ∘ u⃗g) ∘ n⃗z⟩] − 𝜕
𝜕z
[Ag⟨q⃗g ∘ n⃗z⟩]
− ∫
C(z,t)
[
𝜌g(u⃗g − u⃗i
) ∘ n⃗g
(
eg + u2
g
2
)
− (𝜏⃗g ∘ u⃗g) ∘ n⃗g + q⃗g ∘ n⃗g
]
dC
n⃗g ∘ n⃗g,C
+ ∫
Cg(z,t)
q⃗g ∘ n⃗gdC
n⃗g ∘ n⃗g,C
(5.17)
● Liquid-phase energy conservation
𝜕
𝜕t
[
Al
⟨
𝜌l
(
el +
u2
l
2
)⟩] +
𝜕
𝜕z
[
Al
⟨
𝜌l
ul
(
hl +
u2
l
2
)⟩]
= Al
⟨𝜌l
g⃗ ∘ u⃗l
⟩ +
𝜕
𝜕z
[Al
⟨(𝜏⃗l ∘ u⃗l
) ∘ n⃗z⟩] − 𝜕
𝜕z
[Al
⟨q⃗l ∘ n⃗z⟩]
− ∫
C(z,t)
[
𝜌l
(u⃗l − u⃗i
) ∘ n⃗l
(
el +
u2
l
2
)
− (𝜏⃗l ∘ u⃗l
) ∘ n⃗l + q⃗l ∘ n⃗l
]
dC
n⃗l ∘ n⃗l,C
+ ∫
Cg(z,t)
q⃗l ∘ n⃗l
dC
n⃗l ∘ n⃗l,C
(5.18)
Evidently, the set of space-averaged equations (5.11)–(5.18) still poses
intractable solution challenges related to evaluating the interface integrals,
that is, unknown location of the boundaries.
5.4 Time-Averaged Equations
Performing the time averaging of the conservation principles yields addi￾tional simplification benefits based on statistics. The phase time averaging
operator is denoted with an overbar, as defined by equation (5.19) for a
generic property “f ” (Yadigaroglu and Hewitt, 2017),
fg ≡ 1
Tg ∫
[Tg]
fg(r,z,𝜃,t)dt
fl ≡ 1
Tl ∫
[Tl]
fl
(r,z,𝜃,t)dt (5.19)❦
❦ ❦
❦
92 5 Two-Phase Flow in Pipelines
The time integration intervals [T] should be selected in a way that
unsteady trends are preserved while eliminating the turbulence fluctuations
by the integration process (Yadigaroglu and Hewitt, 2017).
Of particular interest is the time averaging of the local instantaneous void
fraction 𝜀g(r,z,𝜃,t), representing the presence of the gas phase at the location
at time “t.” This is characterized by the gas-phase density or gas-presence
function Pg(r,z,𝜃,t) defined by
Pg(⃗r, t) ≡
{1 if ⃗r is in the gas phase
0 if ⃗r is in the liquid phase}
(5.20)
Utilizing definition (5.19) and the Ergodic hypothesis from Statistics
allows us to express the local time-averaged void fraction as follows, where
the last term represents the fraction of experimental observations of the gas
phase at such location:
𝜀g(⃗r) = 1
T ∫
[Tg]
𝜀g(⃗r, t)dt = Pg(⃗r) =
Tg
T (5.21)
Similar time-averaged properties can be derived, analogous to the deriva￾tion of the local time-averaged void fraction, to obtain time-smoothed
properties for the system of equations (5.5)–(5.9). It is important to note the
assumption of considering the phases’ interface as discontinuous changes
in density (i.e. negligible interphase thickness).
The local time-averaged void fraction can be space-averaged over the
cross-sections of the pipelines to estimate the more familiar 1-D void
fraction (𝛼) parameter. This illustrates the core of the next section to
reduce even further the conservation principles for two-phase flow. The
cross-sectional void fraction expression is
𝛼 = ⟨𝜀g⟩ = 1
A∫
A
𝜀g(⃗r)dA = 1
A∫
A
1
T ∫
A
Pg(⃗r, t)dtdA (5.22)
5.5 Composite-Averaged Equations
From the previous two sections, it is obvious the advantage of performing
time and space averages. In this section, we explore the simultaneous
application of both averaging techniques that are conducive to the stan￾dard 1-D models in two-phase flow. It is immaterial the order of the two
averaging processes (Delhaye, 1982) because both lead to the same set of
equations.❦
❦ ❦
❦
5.6 Two-Fluid Model (TFM) 93
One crucial element in performing the averaging processes is the
following fundamental relationship reproduced in the Yadigaroglu and
Hewitt (2017) monograph, only applicable to the product of a property
times the void fraction:
⟨𝜀g fg⟩ ≅ ⟨𝜀g⟩⟨fg⟩ (5.23)
The resulting set of composite-averaged equations is summarized in
Section 1.2.4.3 of Delhaye’s (1982) monograph.
5.6 Two-Fluid Model (TFM)
The two-fluid model is a one-dimensional methodology where the proper￾ties vary only along the pipeline axis. This model is a simplified application
of the composite-averaged equations for a pipeline geometry. As such, the
model considers the separate flow of the gas and the liquid phases with inter￾acting boundaries. This type of model blends well with separate types of flow
patterns such as annular flow or stratified horizontal flow.
The TFM comprises six conservation equations requiring closure models
to match the number of unknowns. The set of conservation principles is as
follows:
Continuity (gas phase)∶ 𝜕
𝜕t
[𝜌g𝛼] + 𝜕
𝜕L
[Gx]=Γg (5.24)
Continuity (liquid phase)∶ 𝜕
𝜕t
[𝜌l
(1 − 𝛼)] + 𝜕
𝜕L
[G(1 − x)] = Γl (5.25)
Jump condition∶ Γl + Γg = 0 (5.26)
The variables Γg and Γl are the volumetric mass transfer rates defined by
equations (5.24) and (5.25). A positive value of Γl means gas condensing into
liquid phase, and conversely a positive value of Γg means gas liberation from
the liquid phase.
Gas phase momentum:
𝜕
𝜕t
(Gx) + 𝜕
𝜕L
(
G2x2
𝜌g𝛼
)
= v̂Γg − 𝛼
dpg
dL − 𝜏W,gPW,g
Ap
− 𝜏i
Pi
Ap
− 𝜌gg𝛼 sin 𝜃
v̂ = ug if Γg ≤ 0 (5.27)
Liquid phase momentum:
𝜕
𝜕t
[G(1 − x)] + 𝜕
𝜕L
[
G2(1 − x)
2
𝜌l
(1 − 𝛼)
]
= v̂Γl − (1 − 𝛼)
dpl
dL❦
❦ ❦
❦
94 5 Two-Phase Flow in Pipelines
− 𝜏W,l
PW,l
Ap
+ 𝜏i
Pi
Ap
− 𝜌l
g(1 − 𝛼)sin 𝜃
v̂ = ul if Γl ≤ 0 (5.28)
Gas phase energy:
𝜕
𝜕t
[
𝜌g𝛼Eo
g
]
+
𝜕
𝜕L
[
GxHo
g
]
= −ho
l Γl +
PW,gqε
g − Pi
qε
i
Ap
− Gxg sin 𝜃 + pg
𝜕𝛼
𝜕t − 𝜏i
Pi
Gx
Ap𝜌g
(5.29)
Liquid phase energy:
𝜕
𝜕t
[
𝜌l
(1 − 𝛼)Eo
l
]
+
𝜕
𝜕L
[
G(1 − x)Ho
l
]
= ho
l Γl +
PW,l
qε
l + Pi
qε
i
Ap
− G(1 − x)g sin 𝜃 + pl
𝜕
𝜕t
(1 − 𝛼)
+ 𝜏i
Pi
G(1 − x)
Ap𝜌l
(5.30)
It is interesting to point out that equations (5.24)–(5.30) were the orig￾inal set of equations to develop the well-known OLGA® transient code
(Bendiksen et al., 1991) discussed below.
5.6.1 OLGA® Software (SLB)
This section highlights some of the basics of the benchmark code for oil
and gas transient and steady-state simulation work in pipelines. OLGA is
a software based on the two-fluid model that has undergone numerous
improvements in terms of closure equations and numerical schemes. To
validate the OLGA code, the experimental data from reputed laboratories
have been key for the success of this tool. The laboratories providing
experimental data include Norway’s SINTEF (Stiftelsen for industriell og
teknisk forskning), IFP (Institute of French Petroleum), University of Tulsa,
Imperial College, Colorado School of Mines, and the Norwegian University
of Science and Technology (NTNU).
The two-fluid model presented in the previous section was extended
by Bendiksen et al. (1991) to improve the transient code OLGA. The first
version of OLGA was available in 1983 through a joint research program
between IFE and SINTEF. At that time only liquid and gas phases were
considered, and the pressure drop calculations sometimes reached 50% off￾set with respect to experimental data. The major contribution of the paper❦
❦ ❦
❦
5.6 Two-Fluid Model (TFM) 95
by Bendiksen et al. (1991) was to include a liquid phase entrained within
the gas phase in the form of entrained droplets. The result of this addition
was successful in diminishing the prediction’s uncertainty.
The set of mass conservation balances comprising the core of the OLGA
code, including the inclusion of the entrained droplets, is
𝜕
𝜕t
[𝜌GVG] + 𝜕
𝜕L
[𝜌GVGuG]=ΓG (5.31)
𝜕
𝜕t
[𝜌LVL] + 𝜕
𝜕L
[𝜌LVLuL] = −ΓG
( VL
VL + VD
)
− ΓE + ΓD (5.32)
𝜕
𝜕t
[𝜌LVD] + 𝜕
𝜕L
[𝜌LVDuL] = −ΓG
( VD
VL + VD
)
+ ΓE − ΓD (5.33)
Similarly, momentum conservation balances including the entrained
droplets terms are
𝜕
𝜕t
[𝜌GVGuG] + 𝜕
𝜕L
[
𝜌GVGu2
G
]
+ VG
𝜕p
𝜕L
+ fG𝜌GuG|uG|SG
2(𝜋d2)
+ fi
𝜌Gur|ur|Si
2(𝜋d2) − 𝜌GgVG sin 𝜃 − ΓG(uL + uD) + FD = 0 (5.34)
𝜕
𝜕t
[𝜌LVDuD] + 𝜕
𝜕L
[
𝜌LVDu2
D
]
+ VD
𝜕p
𝜕L − 𝜌LgVD sin 𝜃
+ ΓGuD
( VD
VL + VD
)
− ΓEui + ΓDuD − FD = 0 (5.35)
𝜕
𝜕t
[𝜌LVLuL] + 𝜕
𝜕L
[
𝜌LVLu2
L
]
+ VL
𝜕p
𝜕L
+ fL𝜌LuL|uL|SL
2(𝜋d2) − fi
𝜌Gur|ur|SL
2(𝜋d2)
− 𝜌LgVL sin 𝜃 + ΓG
( VL
VL + VD
)
(uG + uD)+ΓEui − ΓDuD = 0
(5.36)
The set of equations (5.31)–(5.36) represents a formidable challenge to
solve the velocity and density field. The solution option is the application
of the finite difference methodology to a discretized domain. A highly effec￾tive technique is the control volume (Patankar, 1980) applied to each cell
element of the grid.
The momentum equations (5.34)–(5.36) pose a numerical challenge due
to the presence of the pressure gradient term. In fact, the velocity field can
only be determined when the pressure field is known in advance via an
iterative process. An initial guess of the pressure field is the starting point to
obtain the velocity field, and velocity corrections are obtained by the residue
of the continuity equations (5.31)–(5.33). To obtain the pressure field, the
OLGA code uses the following pressure-correction equation derived by❦
❦ ❦
❦
96 5 Two-Phase Flow in Pipelines
Bendiksen et al. (1991) from the mass conservation equations and assuming
that the gas density is a function of temperature, pressure, and gas fraction:
[
VG
𝜌G
𝜕𝜌G
𝜕p
+
(1 − VG)
𝜌L
𝜕𝜌L
𝜕p
] 𝜕p
𝜕t = − ( 1
A𝜌G
) 𝜕
𝜕L
[𝜌GAVGuG]
−
( 1
A𝜌L
) 𝜕
𝜕L
[𝜌LAVLuL] − ( 1
A𝜌L
) 𝜕
𝜕L
[𝜌LAVDuD]+ΓG
( 1
𝜌G
− 1
𝜌L
)
= 0
(5.37)
The proprietary code OLGA® currently is owned by SLB (formerly known
as Schlumberger) and constantly keeps evolving to suit novel applications.
Newer versions of OLGA such as the HD (high-definition version) and
OLGA 2021.1 have incorporated many improvements that include
● Mass transfer rates equations between fluid phases,
● Up to nine commingled phases:
– Core gas phase
– Oil core phase
– Water core layer
– Bubbles of gas in the oil core and the water core phases
– Droplets of oil in the gas core and the water core phases
– Droplets of water in the oil core and the gas core phases
● A two-dimensional velocity profile for stratified flow yielding a semi￾three-dimensional flow approximation,
● Pressure-enthalpy tables for single-component systems,
● Separate specialized modules to complement the basic code, such as
– Comptracking – to perform node-by-node phase equilibrium and
property estimation
– Corrosion – for internal corrosion estimation
– Slugtracking – to model hydrodynamic slugging phenomena more
accurately
– FEMTherm – for improved estimation of convection and conduction
heat transfer coefficients
– Complex Fluids – to handle fluids with non-newtonian behavior
– Multiphase Pumps – to simulate the performance of commingled gas
and liquid through a pump
● FieldTwinTM integration to generate a digital copy of the physical system,
● Improved handling of CO2 property estimation.
5.7 Constitutive Equations
The conservation principles are not sufficient to fully describe the
thermal-hydraulic performance of the fluid flow. Constitutive equations are❦
❦ ❦
❦
5.8 One-Dimensional Modeling 97
indispensable to “close” the set of governing principles and match number
of unknowns to number of equations. In the most general sense, two-phase
flow problems have 12 unknowns (Hsu and Graham, 1976):
● Void fraction (1)
● Liquid-phase velocity vector (3 components)
● Gas-phase velocity vector (3 components)
● Gas-phase density (1)
● Liquid-phase density (1)
● Pressure (1) – assuming equality of gas- and liquid-phase pressure
● Temperature (2) – non-thermal equilibrium
The set of equations that would match up the set of unknowns is
● Liquid-phase continuity equation (1)
● Gas-phase continuity equation (1)
● Momentum conservation in liquid phase (3 components)
● Momentum conservation in gas phase (3 components)
● Energy conservation in liquid phase (1)
● Energy conservation in gas phase (1)
● EOS for the liquid phase (1)
● EOS for the gas phase (1)
Thus, the equations of state are constitutive equations closing the set of
conservation principles. Nevertheless, additional empirical data and models
find their way into the problem formulation. Examples of support informa￾tion required are as follows:
● void fraction correlation as a function of pressure, temperature, and flow
pattern
● friction factors to characterize the shear stress of each phase at the wall,
and the interfacial shear stress
● heat transfer coefficients needed to estimate heat losses.
5.8 One-Dimensional Modeling
One-dimensional models focusing on property changes along the axial
direction of the pipeline are the standard for two-phase flow simulations.
Most major commercial and proprietary codes available to date are based
on the simplification of the 1-D model. Nevertheless, to improve accuracy,
some codes superimpose two-dimensional (radial) transport phenomena
upon the 1D axial model, with encouraging results. An example of this
effective methodology is the combination of the two-fluid model (TFM)❦
❦ ❦
❦
98 5 Two-Phase Flow in Pipelines
with the kinematic drift–flux model (DFM) to simulate steady-state and
transient pipeline operations.
5.9 Homogeneous Equilibrium Model (HEM)
The simplest model that can be postulated is the one-dimensional HEM,
based on the transformation of the multiphase mixture into an equivalent
single-phase fluid with space- or volumetric-averaged properties. One great
advantage is that the set of differential equations is amenable to straightfor￾ward numerical integration.
The HEM is a good option to obtain a preliminary solution to accelerate
the convergence of more complex and accurate models. Also, the HEM can
provide fast answers to sensitivity scenarios at an extremely low computing
cost when the objective is to explore a trend rather than pursue an accurate
answer.
The implicit assumptions of the HEM are
● No relative velocity between the phases (no slippage, S = 1),
● Thermodynamic equilibrium between the phases, and
● Pseudo-fluid mixture having mass-weighted density and viscosity.
In general, this model underpredicts pressure drop in pipeline flow, but
there are cases where the HEM yields reasonable estimates. The exceptional
cases where HEM is an option are
● For dispersed types of two-phase flow such as bubble and mist flow
patterns,
● The core of annular flow, and
● When the mixture mass velocity G exceeds 2,000 kg/m2 s.
The conservation principles for the HEM follow easily from the TFM
equations by assuming a single fluid. The HEM equations benefit from
using the mass velocity G because of constant-area pipelines and slow
changes in mass flow rate. The unsteady-state equations are
Triangular relation:
ṁ g
ṁ l
= x
1 − x = 𝜌g
𝜌l
( 𝛼
1 − 𝛼
)
(5.38)
Void fraction: 𝛼 = 𝜌l
x
𝜌l
x + 𝜌g(1 − x) ; 1 − 𝛼 = HL = 𝜌g(1 − x)
𝜌l
x + 𝜌g(1 − x)
(5.39)
Fluid density: 𝜌H ≡ (1 − 𝛼)𝜌l + 𝛼𝜌g = 1
x
𝜌g
+ (1−x)
𝜌l
(5.40)❦
❦ ❦
❦
5.10 Separated Flow Model 99
Mass velocity: G = 𝜌Hj = function(t) (5.41)
Continuity: 𝜕𝜌H
𝜕t
+
𝜕
𝜕L
G = 0 (5.42)
Momentum: 𝜕G
𝜕t
+
𝜕
𝜕L
(G2
𝜌H
)
= −[
dp
dL + 𝜏W PW
Ap
+ 𝜌Hg sin 𝜃
]
= −[
dp
dL +
fDarcyG2
2D𝜌H
+ 𝜌Hg sin 𝜃
]
(5.43)
where 𝜏W PW
Ap
is the friction pressure gradient, 𝜌Hg sin 𝜃 is the gravitation pres￾sure gradient, and 𝜕
𝜕L
( G2
𝜌H
)
is the acceleration pressure gradient (usually
negligible except at choke points).
Energy∶
[ 𝜕
𝜕t
(𝜌HEo
) + 𝜕
𝜕L
(𝜌HjHo
)
]
= −PW q′′
Ap
(5.44)
The wall shear stress in equation (5.43) relates to the friction factor defi￾nition through
𝜏W = fF
G2
2𝜌H
(5.45)
and the Darcy–Weisbach can be approximated for smooth wall piping by
fDarcy ≈ 0.316
Re0.2 Re ≡ 𝜌Hjd
𝜇H
(5.46)
The viscosity of the homogeneous fluid has been subject to diverse defini￾tions; two of the popular choices to estimate fluid viscosity for the Reynolds
number calculation are
𝜇H = 𝜇g
jg
j + 𝜇l
jl
j (5.47)
1
𝜇H
= x
𝜇g
+ (1 − x)
𝜇l
(5.48)
5.10 Separated Flow Model
The two limiting flow patterns framing two-phase flow in pipelines are
disperse phase and separated flows (Brennen, 2005). A disperse phase flow
includes a finite number of either bubbles in a continuous liquid medium
or droplets in a continuous gas medium. The identity of each discrete and❦
❦ ❦
❦
100 5 Two-Phase Flow in Pipelines
unconnected element is preserved at any instant of time but may evolve in
spatial location, shape, or thermo-mechanical state. The continuous media
do transfer mass, momentum, and energy with discrete particles in an
extremely complex manner but following the laws of physics.
Currently, there is no accurate description of the full field flow with item￾ized dispersed particles, even utilizing code based on the Lagrange approach.
Dispersed flows are dealt with, with an approximated continuous field and
the HEM.
Separate flows involve phase identities that enable the Eulerian approach
and the use of models such as the TFM. However, separate flow is yet chal￾lenging and does require simplifications, constitutive equations, and empir￾ical correlations.
The simplification of the TFM can be obtained by lumping the phase
equations (Collier and Thome, 1994), leading to the simpler mixture model
with three conservation equations. Thus, the mixture model does not
include the interface shear stress, the volumetric mass rate terms, or the
heat transfer flux between the phases. The relevant stresses of the mixture
model are only the phases’ shear stress with the pipe wall and a single value
pressure term common for both phases. The expressions for shear stress are
given by
𝜏W,l = fD−W
𝜌l
u2
l
8 (5.49)
𝜏W,g = fD−W
𝜌gu2
g
8 (5.50)
The friction factor depends on the Reynolds number and the nondimen￾sional wall roughness 𝜀/d. The friction factor can be estimated either graph￾ically from the Moody diagram (Figure 5.4) or from empirical correlations.
For laminar flow, the Poiseuille equation provides an exact expression of
friction factor. For turbulent flow, the Colebrook–White implicit correlation
and the Swamee and Jain (Streeter and Wylie, 1979) explicit formula yield
excellent friction factor estimates:
fD−W = 64
Re (Poiseuielle) (5.51)
1
√fD−W
= −0.8686Ln (
𝜀∕d
3.7
+
2.51
Re√fD−W
)
(Colebrook–White)
(5.52)
fD−W ≅
1.325
[
Ln (𝜀∕d
3.7 + 5.74
Re0.9 )]2 (Swamee–Jain) (5.53)❦
❦ ❦
❦
5.11 Kinematic Models 101
0.1
0.09
0.08
0.07
0.06
0.05
0.05
0.04
0.03
0.015
0.005
0.002
0.001
5×10‒4
2×10‒4
5×10‒5
5×10‒6
10‒4
10‒5
10‒6
0.01
0.02
0.04
0.03
0.02
0.015
0.01
103 104 105 106
𝜌dV
𝜇
107
Smooth pipe Friction factor =
Reynolds number ≡ 
Complete turbulence
Material 𝜀 (mm)
Concrete, coarse
Concrete, new smooth
Drawn tubing
Iron, cast
Sewers, old
Water mains, old
Steel, structural or forged
Steel, rusted
Steel, mortar lined
Glass, Plastic Perspex
0.25
0.025
0.0025
0.15
3.0
1.0
0.025
0.5
0.1
0.0025
Laminar flow
Transition region
Relative pipe roughness ε/d
Moody diagram
Darcy‒Weisbach friction factor
108
64
Re
2d
𝜌V2l
ΔP
Figure 5.4 Darcy–Weisbach friction factor.
5.11 Kinematic Models
Kinematic is defined as the branch of mechanics concerned with the motion
of objects without reference to the forces which cause the motion. In regard
to two-phase flow, kinematic models have been developed based solely on
the conservation of mass principle. These models were pioneered by the
work of Bankoff (1960) and Zuber and Findlay (1965), establishing the foun￾dation for the drift–flux model later consolidated by Wallis (1969).
The kinematic models support the one-dimensional models with
cross-sectional corrections for void fraction and velocity profile. Such
corrections enhance the accuracy of the 1-D estimates by attempting to
incorporate effects of a 3-D flow field.
In this section, we review the Bankoff (1960), the Zuber and Findlay
(1965), and the Wallis (1969) kinematic models.
5.11.1 Bankoff Model (1960)
An early attempt to correct 1-D models for two-dimensional (i.e. radial)
effects was published by Bankoff (1960) for two-phase steam–water systems.
The model postulates that the radial velocity and void fraction profiles can❦
❦ ❦
❦
102 5 Two-Phase Flow in Pipelines
be expressed by the following power functions:
u(r)
umax,r=0
=
(R − r
r
) 1
m 𝛼(r)
𝛼max,r=0
=
(R − r
r
)1
n
(5.54)
The space-average void fraction at the pipe section can be estimated with
the power functions as
⟨𝛼⟩ = Ca𝛽 = Cajg
j (5.55)
Ca = 2(m + n + mn)(m + n + 2mn)
(n + 1)(2n + 1)(2m + 1)(m + 1) (5.56)
Although there was no formal method proposed to estimate the value of
the parameters “m” and “n,” there is indication that for one-component
two-phase flow, such parameters fall in the ranges 0.5<n<1.0, and
2< m <7. Therefore, the value of the constant Ca is in the range 0.70–0.90.
Reported empirical values for the constant Ca by other experimenters are
in the range 0.83–0.89.
Bankoff also obtained a relationship between the slip factor S and the
cross-sectional void fraction involving a parameter that he called “K,” which
is a function of pressure, mass flow rate, and mass quality, and which usually
falls in the interval 0.5–1.0. The relationship is
S = ⟨ug⟩
⟨ul
⟩ = 1 − ⟨𝛼⟩
K − ⟨𝛼⟩ (5.57)
The Bankoff parameter K can be shown (Zuber, 1960) to relate to the aver￾age void fraction and the volumetric quality 𝛽 by the following equation:
K = ⟨𝛼⟩
⟨𝛽⟩ (5.58)
which combined with the slip factor S produces
S =
[ ⟨𝛽⟩
1 − ⟨𝛽⟩
] [ 1 − ⟨𝛼⟩
⟨𝛼⟩
]
(5.59)
5.11.2 Zuber–Findlay Model (1965)
Zuber and Findlay (1965) proposed a model applicable to any two-phase
flow regime to estimate the cross-sectional void fraction. In this regard, the
objective for this model was similar to Bankoff’s (1960) objective, to improve
the accuracy of one-dimensional models with a correction.
The model incorporates the effect of radial properties variation, that is,
non-uniform flow and concentration profiles. It is noteworthy that this❦
❦ ❦
❦
5.11 Kinematic Models 103
paper established the basis for developing the drift–flux model (covered in
subsection below) and the effect of the slip velocity between the phases.
Zuber and Findlay developed their model utilizing the weighted
mean-value definition for the kinematic parameters. This definition applied
to the gas velocity yields
ug = ⟨𝛼ug⟩
⟨𝛼⟩ =
∫
A
𝛼ugdA
∫
A
𝛼dA (5.60)
which can be related to the superficial velocity and led the authors to define
the parameter Co:
Co ≡ ⟨𝛼j⟩
⟨𝛼⟩⟨j⟩ (5.61)
ug = ⟨ jg⟩
⟨𝛼⟩ = ⟨𝛼j⟩
⟨𝛼⟩ +
⟨𝛼ugj⟩
⟨𝛼⟩ = Co⟨j⟩ +
⟨𝛼ugj⟩
⟨𝛼⟩ (5.62)
enabling to express the space-averaged void fraction as
⟨𝛼⟩ = ⟨𝛽⟩
Co⟨j⟩ + ⟨𝛼ugj⟩
⟨𝛼⟩⟨j⟩
(5.63)
Zuber and Findlay (1965) explored a range of potential non-uniform
cross-sectional profiles, finding that for those that resemble most empirical
data, the parameter Co lies in the range 1.0–1.2.
5.11.3 Drift–Flux Model (DFM)
The drift–flux model is a kinematic methodology to account for cross￾sectional non-uniform profiles of velocity and void fraction. The DFM may
complement the TFM, the mixture model, or the mechanistic model to
improve prediction accuracy.
The original work based on local relative velocity between the phases was
by Behringer (1936), who developed an expression for the gas velocity as the
sum of the total volumetric flux and the terminal rise velocity of a bubble.
The DFM was shaped by the work of Bankoff (1960), Griffith and Wallis
(1961), and Zuber and Findlay (1965).
The book by Wallis (1969) condensed the theory behind the DFM and
demonstrated the model’s capacity to simulate dispersed bubble and
slug flow. Thus, the DFM can support the limiting cases of two-phase
flow, disperse and separate flow patterns, adding a relationship between
space-averaged void fraction and volumetric mass quality, as if it were an
equation of state for two-phase one-dimensional flow.❦
❦ ❦
❦
104 5 Two-Phase Flow in Pipelines
Some authors call the DFM the void-quality analysis due to the way
Zuber and Findlay (1965) developed it. The suitability of the DFM has
been distinguished in important nuclear industry simulation codes such
as RELAP5/MOD3, and also in the IFP-SimSci code TACITE, see Pauchon
and Dhulesia (1994), for oil and gas transport simulations.
Equations (5.60) through (5.63) collect the essence of the DFM. The focus
of development for this model is the concentration parameter Co and the
drift velocity term ⟨ugj⟩. Two additional useful expressions sometimes used
in the DFM (Lahey and Moody, 1993) are
⟨𝛼⟩ = ⟨ jg⟩
Co⟨j⟩ + ⟨ugj⟩ = ⟨x⟩
Co
[
⟨x⟩ +
𝜌g
𝜌l
(1 − ⟨x⟩)
]
+
𝜌g⟨ugj⟩
G
(5.64)
S = Co +
( 𝜌l
𝜌g
)
⟨x⟩
(1 − ⟨x⟩)
(Co − 1) +
𝜌l
⟨ug⟩
G(1 − ⟨x⟩) (5.65)
Rassame and Hibiki (2018) presented a summary of correlations for the
concentration parameter and the drift velocity that enable to predict the
space-averaged void fraction. Hibiki (2019) later issued a corrigendum
for the case of horizontal flow. Hibiki’s correlations for the concentration
parameter and the drift velocity are as follows:
Vertical Upward Flow
Co =
(
1.2 − 0.2√𝜌g
𝜌l
) [
1 − exp (
−22
db
D
)] (5.66)
● Bubbly flow
⟨ugj⟩ =
√
2(1 − ⟨𝛼⟩)
1.75[
(𝜌l − 𝜌g)g𝜎
𝜌2
l
]0.25
(5.67)
● Slug flow
⟨ugj⟩ = 0.35[(𝜌l − 𝜌g)gD
𝜌l
]0.5
(5.68)
● Churn flow
⟨ugj⟩ =
√
2
[
(𝜌l − 𝜌g)g𝜎
𝜌2
l
]0.25
(5.69)❦
❦ ❦
❦
5.12 Mechanistic/Phenomenological Models 105
● Annular flow
⟨ugj⟩ = 1 − ⟨𝛼⟩
⟨𝛼⟩ +
√1+75𝜌g(1−⟨𝛼⟩)
𝜌l
√⟨𝛼⟩
⎡
⎢
⎢
⎣
⟨j⟩ +
√
(𝜌l − 𝜌g)gD(1 − ⟨𝛼⟩)
0.015𝜌l
⎤
⎥
⎥
⎦
(5.70)
Horizontal Flow
⟨ugj⟩ is negligible because buoyancy forces are perpendicular to the hori￾zontal direction.
Co = 0.8 (
1 −
√𝜌g
𝜌l
)
exp
⎡
⎢
⎢
⎣
0.9545(⟨
j
+
g
⟩
⟨j
+⟩
)1.5⎤
⎥
⎥
⎦
+
√𝜌g
𝜌l
for 0 ≤
j
+
g
j
+ < 0.9
(5.71)
Co = 9.08 − 8.08 [⟨
j
+
g
⟩
⟨j
+⟩ −
(⟨
j
+
g
⟩
⟨j
+⟩ − 1
)√𝜌g
𝜌l
]
for 0.9 ≤
j
+
g
j
+ ≤ 1
(5.72)
where the volumetric fluxes are defined by
⟨j
+⟩ ≡ ⟨j⟩
(
g𝜎Δ𝜌
𝜌2
l
)0.25 (5.73)
⟨
j
+
g
⟩ ≡ ⟨ jg⟩
(
g𝜎Δ𝜌
𝜌2
l
)0.25 (5.74)
⟨
j
+
g
⟩
⟨j
+⟩ ≃ 1
1 +
⟨1 − x
x
⟩ ⟨𝜌g
𝜌l
⟩ (5.75)
Research work focused on the drift–flux model started in the 1960s. Bhag￾wat and Ghajar (2014) published a comprehensible summary of 13 drift–flux
correlations (concentration parameter and the drift velocity) spanning four
decades of research work.
5.12 Mechanistic/Phenomenological Models
The mechanistic model is a simplification technique to the rigorous conser￾vation principles equations. The assumption is that it is possible to identify
in advance the flow pattern before applying a simple model exploiting the❦
❦ ❦
❦
106 5 Two-Phase Flow in Pipelines
characteristics of such flow pattern. Thus, the success (or failure) of the
mechanistic models relies on the capacity to pinpoint the flow regime, with
a sound flow pattern map, regardless of the previous comment concerning
sharp transitions among flow regimes. Sharp boundary transitions are an
idealization process; regime transitions are gradual and show characteris￾tics of both regimes involved. Therefore, there is some risk that at certain
location of the pipeline flows the wrong regime is identified and an incor￾rect flow model is applied. One strategy followed in one code to circumvent
the uncertainty in the prevailing flow pattern is to perform void fraction and
pressure drop calculations using both neighboring regime’s models. These
two calculations are then weight-averaged to estimate a “transition” regime
performance.
Mechanistic models are one-dimensional tools, with emphasis on the
patterns depending on the pipe orientation. For horizontal flow, there are
stratified, slug-plug, disperse bubbly, and annular flow models. For inclined
upward and vertical flow, there are bubbly, churn-turbulent, slug, and
annular flow models.
There are two trends of mechanistic models. Older models use the Taitel
and Dukler (1976) map or Barnea (1987) map before selecting the corre￾sponding set of equations to calculate the local holdup and the pressure gra￾dient. Representative examples of this trend are Ansari et al. (1994), Shoham
(2006) for vertical upward two-phase flows, Xiao et al. (1990) for horizontal
two-phase flow, and more recently Petalas and Aziz (2000). Obviously, this
generation of older models carries the risk of wrong identification of flow
patterns for full-scale field applications, because such flow pattern maps
were developed at laboratory scale and conditions.
More recent efforts such as Zhang (2003a, 2003b) and Gomez et al. (2000)
have generalized the mechanistic approach evolving toward a “unified”
methodology, whereby dispersed flow and separate flow regimes are both
applied to estimate the two-phase flow parameters, followed by a validation
process to verify the flow pattern. The advantage of the unified approach
is that right from the onset dynamic analyses determine the flow pattern
rather than utilizing a standard map which was created with different
operating conditions. Furthermore, the dynamical analyses for transient
phenomena (Shirdel and Sepehrnoori, 2012, 2017) may lead to flow pattern
identification with a higher probability of success as opposed to traditional
flow maps obtained at steady-state laboratory conditions.
Mechanistic models for specific flow patterns are becoming trendy in
the literature; for example, models for slug flow have been published by
Al-Safran et al. (2005) and Wang et al. (2014). A mechanistic model for
stratified flow has been presented by Moradi et al. (2015). The extensive
details of the specific mechanistic models are left to the references.❦
❦ ❦
❦
5.13 Empirical Models 107
5.13 Empirical Models
At first sight, there seems to be no room for empirical models due to the
availability of commercial software developed with the latest technical infor￾mation. However, sometimes during preliminary design of gathering system
or during troubleshooting facilities infrastructure, the objective is not to
have an accurate answer but rather a quick and approximate estimate or per￾formance trend. Moreover, empirical methods serve well to double-check
results obtained with the commercial tools or to get initial estimates for
iterative solutions of advanced codes.
Not surprisingly the two-phase flow literature for the oil and gas industry
has numerous legacy empirical models, given the practical need to design
and simulate flowlines and the extraordinary complexity of the conserva￾tion principles. The earliest models were published in the period between
1940s and 1970s. Examples of the initial models are Lockhart and Martinelli
(1949), Baxendell (1955), Flanigan (1958), Eaton (1967), and the well-known
Brill and Beggs (1973). Consequently, the empirical approach started to fade
away when the mechanistic models started to be published in the mid-1970s
and continue to improve to these days.
In this section, we focus on the Flanigan and the Beggs and Brill methods
that still find keen users, with the caveat that should be integrated into a
discretized pipeline domain jointly with
● An equation of state to predict phase split ratio and phase densities
● Friction factor and viscosities correlations
● The energy conservation balance to estimate temperature changes
5.13.1 Flanigan Model (1958)
This is an empirical and proven method that gives good estimates for
gas-dominated flows such as gas-condensate flow with limited loading.
The model is inspired by the Panhandle A method (GPSA, 2012) for single￾phase gas flow but calibrated with field measurement data. The model can
be resolved by hand calculations with average fluid properties determined
in advance.
The wet gas flow rate in million standard cubic meters per day for this
model is
Qsc = 42.12Etp
⎡
⎢
⎢
⎢
⎣
d4.854 (
P2
1 − P2
2,corrected)
TmLzms
0.8539
g
⎤
⎥
⎥
⎥
⎦
0.5394
(5.76)❦
❦ ❦
❦
108 5 Two-Phase Flow in Pipelines
The units in equations (5.76): d [m]; P [kPa]; Tm [K]; L [m]. Etp is a
two-phase efficiency parameter given by
Etp ≅ 4.719 − 0.364( jg
R0.32 )−0.5
(5.77)
R represents the local liquid–gas ratio, expressed in bbls/mmscf, and
P2, corrected is the exit pressure of the segment corrected for gravitational
effects,
P2,corrected = P2 + 0.00981 [
𝜌l
Eh
∑(head)up − 𝜌g
∑(head)down]
(5.78)
Eh ≅
1
1 + 0.33(3.94jg)0.92 (5.79)
This empirical model gives superior results for gas-condensate pipelines
with low liquid loading.
5.13.2 Beggs and Brill Model (1973)
This empirical and simple 1-D model has been a popular tool to design oil
and gas pipelines for 50 years. Even in our time Beggs and Brill is a popular
option to quickly estimate gathering system performance without the has￾sle of solving intricate systems of PDEs, whenever an approximated rather
accurate estimate is sought. The rapid convergence of this method, its appli￾cability to any flow orientation, and the quality of the answers make it an
ideal first approximation before attempting more advanced models. Some
practitioners apply the Beggs and Brill method throughout the full length
of the pipeline for computational economy; this practice leads to substan￾tial errors in the prediction. It is much better to discretize the full pipeline
domain into a number of sections and apply the Beggs and Brill model in a
piecewise manner.
The model depends on the type of flow regime, namely segregated, inter￾mittent, transition, and distributed. To identify the flow pattern is neces￾sary to estimate the “L” parameters, the volumetric liquid quality, and the
mixture Froude number. Knowing the flow regime allows us to predict the
holdup for any fluid flow orientation.
The total pressure gradient is the sum of the friction, gravitation, and
acceleration (usually negligible compared to the other terms) gradients.
The two-phase flow friction factor is calculated from a single-phase Darcy❦
❦ ❦
❦
5.13 Empirical Models 109
friction factor correlation (e.g. Colebrook, with Reynolds number and
nondimensional roughness), and corrected with a normalized factor which
is a function of the volumetric liquid quality and the holdup. The method,
applied to a subsection of the pipeline, comprises the following steps:
(a) Calculate the nondimensional Froude number
NFr = j
2
gd (5.80)
(b) Calculate the Kutateladze number
NKu = jl
( 𝜌l
g𝜎l
)0.25
(5.81)
(c) Calculate the volumetric liquid quality
𝜆L = jl
j = 1 − 𝛽 (5.82)
(d) Calculate the “L” parameters:
L1 = 316𝜆0.302
L (5.83)
L2 = 0.0009252
𝜆2.4684
L
(5.84)
L3 = 0.1
𝜆1.4516
L
(5.85)
L4 = 0.5
𝜆6.738
L
(5.86)
(e) Estimate the holdup for the pipe section inclined at an angle 𝜙 with
respect to the horizontal using the parameters listed in Table 5.1. The
segregated uphill pattern is identified when 𝜆L is less than 0.01 and NFr
is less L1, or 𝜆L is larger than 0.01 and NFr is less than L2. The intermit￾tent uphill pattern occurs when 𝜆L is between 0.01 and 0.4 and when NFr
is between L3 and L1, or when 𝜆L is larger than 0.4 and NFr is between
L3 and L4. The distributed uphill pattern is identified when 𝜆L is less
than 0.4 and NFr is larger than L1, or when 𝜆L is larger than 0.4 and NFr
is larger than L4. The transition regime between the segregated and the
intermittent regimes is handled with equation (5.89).
hL =
⎧
⎪
⎨
⎪
⎩
HL =
(a𝜆b
L
Nc
Fr
)
𝜓 if a𝜆b
L
Nc
Fr
> 𝜆L
HL = 𝜆L𝜓 if a𝜆b
L
Nc
Fr
≤ 𝜆L
(5.87)❦
❦ ❦
❦
110 5 Two-Phase Flow in Pipelines
Table 5.1 Parameters for holdup correlation. Source: Adapted from Brill and
Beggs (1973).
Regime ab cd e f g
Segregated uphill 0.98 0.4846 0.0868 0.011 −3.77 3.54 −1.61
Intermittent uphill 0.845 0.5351 0.0173 2.96 0.305 −0.447 0.098
Distributed uphill 1.065 0.5824 0.0609 0.124 −0.506
Downhill 4.7 −0.37 0.124 −0.506
𝜓 = 1 + (1 − 𝜆L)Ln (
d𝜆e
LNf
KuNg
Fr) {
sin(1.8𝜙) − sin3
(1.8𝜙)
3
}
(5.88)
HL(transition) = (L3 − NFr)HL(segregated)+(NFr − L2)HL(intermittent)
L3 − L2
(5.89)
(f) Estimate two-phase and homogeneous densities:
𝜌 = 𝜌l
HL + 𝜌g(1 − HL) (5.90)
𝜌H = 𝜌l
𝜆L + 𝜌g(1 − 𝜆L) (5.91)
(g) Estimate homogeneous and two-phase friction factors:
NRe = 𝜌Hjd
𝜇l
𝜆L + 𝜇g(1 − 𝜆L) (5.92)
fH = fDarcy (
NRe,
𝜀
d
)
(5.93)
𝜛 = Ln ( 𝜆L
H2
L
)
(5.94)
fTP = fH exp [ 𝜛
0.0185𝜛4 − 0.873𝜛2 + 3.18𝜛 − 0.0523
]
(5.95)
(h) Evaluate the gravitation and friction pressure gradients. Neglect (for pip￾ing) the acceleration pressure gradient.
(dp
dx )
grav
= 𝜌g sin 𝜙 (5.96)
(dp
dx )
fric
= fTP𝜌Hj
2
2d (5.97)
(dp
dx )
acc
<< min[(dp
dx )
fric
,
(dp
dx )
grav]
(5.98)❦
❦ ❦
❦
5.14 Computational Fluid Dynamics (CFD) 111
(i) Calculate the change in total pressure, inlet minus outlet pressure, for
the piping section and advance the calculations for the next one (pout):
pout ≅ pin − Δx
[(dp
dx )
grav
+
(dp
dx )
fric]
(5.99)
It is important to emphasize that gas and liquid properties such as density
and viscosity are a function of pressure and temperature. Thus, the analy￾sis of each subsection requires compositional information (thermodynamic
equilibrium) and the solution of the energy conservation equation coupled
to the mass and momentum conservation equations.
5.13.3 Void Fraction Empirical Models
There are some good references summarizing the state of the art in
empirical void fraction correlations, such as Garcia et al. (2005), Wolde￾semayat and Ghajar (2007), and Bhagwat and Ghajar (2014). The latter
reference is centered on the DFM distribution parameter and the drift
velocity.
In the nuclear industry, extensive experimental and theoretical studies
have been carried out by the Electric Power Research Institute (Chexal
et al., 1997) or EPRI for short. The Chexal–Lellouche void fraction model
described in this reference is independent of flow patterns, and it is included
in the RELAP5 and RETRAN-3D thermal-hydraulic models.
5.14 Computational Fluid Dynamics (CFD)
CFD is simulating physical fluid flow and heat transfer phenomena with
mathematical models solved with numerical methods using computer
resources.
With the developments in computer power and numerical methods,
the field CFD found several applications in two-phase flow. The power of
CFD lies in the discretization of the domain with small-size and adaptive
mesh to follow specific surface contours. Full three-dimensional domain
modeling became possible for pipeline accessory geometries opening the
door to solutions not viable with the 1-D models. However, CFD comes
at the price of computing time and memory size to describe the physical
phenomena with better resolution.
Due to the high computing time involved, CFD is left to solve small seg￾ments or accessories in the gathering system of the hydrocarbon production.❦
❦ ❦
❦
112 5 Two-Phase Flow in Pipelines
Full pipeline modeling by CFD is untenable at the current time, and practi￾cal use of this tool is limited to coupled solutions with other transient tools
such as Schlumberger’s OLGA or Kongsberg’s LEDAFLOW applied to the
vast majority of the pipeline domain.
The advanced CFD code available nowadays can be set up to adopt either
a Lagrangian or an Eulerian (control volume) approach. The Lagrangian
approach following the particles is particularly useful for dispersed types
of flows. Furthermore, the majority of two-phase flows are turbulent, and
the CFD codes offer a selection of turbulence models such as k-𝜀, DNS, LES,
RANS, and Langevin, among others.
The system of equations in CFD codes is aimed at continuum media and
comprises continuity, Navier–Stokes (momentum), and energy conserva￾tion equations. Realistic and practical boundary conditions, interface jump
conditions, and initial conditions for the fluid flow are the challenges faced
by the CFD user. Local fluid properties require either tabular pre-estimated
data, as a function of pressure and temperature, or compositional
subroutines supported by equations of state.
Some examples of the use of CFD tools in two-phase flow are
● Thermal analysis of materials (e.g. steel) subject to extremely low temper￾atures due to Joule–Thomson rapid gas expansion. The analysis allows us
to identify cold spots, thermal gradients, and verify design strength limits.
● Modeling of two-phase flow through production wells choke valve.
● Choked two-phase flow through orifice plates (blowdown safety opera￾tion).
● Thermal modeling of partly buried, backfilled, rock dump, and mattressed
pipelines.
● Simulation of entrained solids causing pipeline erosion and identifi￾cation of hot spots. Typical application being simulation of sand fines
entrainment and accumulation at points of low velocity.
● Study the phenomenon of two-phase maldistribution at tees and
manifolds.
● Simulation of slug catchers (vessels, finger-type).
● Transient water hammer local effects during quick closure of shutoff
valves in two-phase flow.
References
Al-Safran, E., Sarica, C., Zhang, H., and Brill, J. (2005). Probabilistic/
Mechanistic Modeling of Slug-Length Distribution in a Horizontal Pipeline,
160–172. SPE Production and Facilities.❦
❦ ❦
❦
References 113
Ansari, A., Sylvester, N., Sarica, C. et al. (1994). A Comprehensive Mechanistic
Model for Upward Two-phase Flow in Wellbores, 143–152. SPE Production
and Facilities.
Bankoff, S. (1960). A Variable Density Single-Fluid Model for Two-Phase Flow
with Particular Reference to Steam-Water Flow. J. Heat Trans. 82: 265.
Barnea, D. (1987). A Unified Model for Predicting Flow Pattern Transitions for
the Whole Range of Pipe Inclinations. Int. J. Multiphase Flow 13: 1.
Baxendell, P. (1955) Fourth World Petroleum Congress, Section 2/E,
Paper No. 4, Rome, Italy.
Behringer, H. (1936). The Flow of Liquid-Gas Mixtures in Vertical Tubes. Zeit.
Ges. Kalte.- Ind. 43: 55–58.
Bendiksen, K., Malnes, D., Moe, R., and Nuland, S., (1991) “The Dynamic
Two-Fluid Model OLGA: Theory and Application,” SPE Paper 19451.
Bhagwat, A. and Ghajar, A. (2014). A Flow Pattern Independent Drift Flux
Model Based Void Fraction Correlation for a Wide Range of Gas-Liquid
Two-Phase Flow. Int. J. Multiphase Flow 59: 186–205.
Brill, J. and Beggs, H. (1973). A Study of Two-Phase Flow in Inclined Pipes.
J. Pet. Technol. 25: 607.
Brennen, C. (2005). Fundamentals of Multiphase Flow. Cambridge, U.K.:
Cambridge University Press.
Brodkey, R. (1967). The Phenomena of Fluid Motions. Reading, MA, USA:
Addison-Wesley.
Chexal, B., Merilo, M., Maulbetsch, J. et al. (1997) “Void fraction technology for
design and analysis,” EPRI TR-106326, California, USA
Collier, J. and Thome, J. (1994). Convective Boiling and Condensation, 3e.
Oxford, U.K.: Oxford Science Publications.
Delhaye, J. (1968). “Equations fondamentales des écoulements diphasiques,”
Commissariat a L’energie Atomique, Rapport CEA-R-3429.
Delhaye, J. (1981). Two-Phase Flow and Heat Transfer in the Power and Process
Industries,” Chapter 2 (ed. A. Bergles). New York, NY, USA: Hemisphere
Publishing Corporation.
Delhaye, J. (1982). Handbook of Multiphase Systems (ed. G. Hestroni). New
York, NY, USA: Hemisphere Publishing Corporation Chapter 1, Section 1.2.
Eaton, B. (1967). The Prediction of Flow Patterns, Liquid Holdup, and Pressure
Losses Occurring During Continuous Two-Phase Flow in Horizontal. J. Pet.
Technol. 815–828.
Flanigan, O. (1958). Effect of Uphill Flow on Pressure Drop in Design of
Two-Phase Gathering Systems. Oil Gas J. 132.
Garcia, F., Garcia, R., and Joseph, D. (2005). Composite Power Law Holdup
Correlations in Horizontal Pipes. Int. J. Multiphase Flow 31: 1276–1303.❦
❦ ❦
❦
114 5 Two-Phase Flow in Pipelines
Gomez, L., Shoham, O., Schmidt, Z. et al. (2000). Unified Mechanistic Model
for Steady-State Two-Phase Flow: Horizontal to Vertical Upward Flow. SPE
J. 5 (3): 339–350.
(2012). GPSA Engineering Data Book, 13e. Tulsa, OK, USA: Gas Processors
Suppliers Association (GPSA).
Griffith, P. and Wallis, G. (1961). Two-phase Slug Flow. J. Heat Transfer, Trans.
ASME, Ser. C 83: 307.
Hibiki, T. (2019). Personal Communication (2021), Corrigendum to
“One-dimensional drift-flux correlations for two-phase flow in medium-size
channels”. Exp. Comput. Multiphase Flow 1 (2): 85–100.
Hsu, Y. and Graham, R. (1976). Transport Processes in Boiling and Two-Phase
Systems. Washington DC, USA: Hemisphere Publishing Company.
Lahey, R. and Moody, F. (1993). The Thermal Hydraulics of a Boiling Water
Nuclear Reactor, 2e. The American Nuclear Society.
Lockhart, R. and Martinelli, R. (1949). Proposed Correlation of Data for
Isothermal Two-Phase Two-Component Flow in Pipes. Chem. Eng. Prog. 45:
39–48.
Moradi, B., Hossain, M., and Oluyemi, G. (2015). Mechanistic Model for
Four-Phase Sand/Water/Oil/Gas Stratified Flow in Horizontal Pipes. In:
Computational Methods in Multiphase Flow VIII, vol. 89, 335–346. WIT Press.
Patankar, S. (1980). Numerical Heat Transfer and Fluid Flow. New York, NY:
Hemisphere Publishing Corporation.
Pauchon, C. and Dhulesia, H. (1994). “TACITE: A Transient Tool for
Multiphase Pipeline and Well Simulation,” SPE Paper No. 28545, Dallas, TX,
USA.
Petalas, N. and Aziz, K. (2000). A Mechanistic Model for Multiphase Flow in
Pipes. J. Can. Pet. Technol. 39: 43–55.
Rassame, S. and Hibiki, T. (2018). Drift-flux Correlation for Gas-Liquid
Two-Phase Flow in a Horizontal Pipe. Int. J. Heat Fluid Flow 69: 33–42.
Shirdel, M. and Sepehrnoori, K. (2012). Development of a Transient
Mechanistic Two-Phase Flow Model for Wellbores. SPE J. 942–955.
Shirdel, M. and Sepehrnoori, K. (2017). Development of a Transient
Mechanistic Three-phase Flow Model for Wellbores. SPE J. 374–388.
Shoham, O., (2006). Mechanistic Modeling of Gas-Liquid Two-Phase Flow in
Pipes,” SPE, Dallas, TX, USA.
Streeter, V. and Wylie, E. (1979). Fluid Mechanics, 7e. New York, NY, USA:
McGraw Hill Book Company.
Taitel, Y. and Dukler, A. (1976). A Model of Predicting Flow Regime Transitions
in Horizontal and Near Horizontal Gas-Liquid Flow. AICHE J. 22: 47–55.
Wallis, G. (1969). One-Dimensional Two-Phase Flow. New York, NY, USA:
McGraw Hill Book Company.❦
❦ ❦
❦
References 115
Wang, S., Zhang, H., Sarica, C., and Pereyra, E. (2014). A Mechanistic
Slug-Liquid-Holdup Model for Different Oil Viscosities and Pipe-Inclination
Angles, 329–336. SPE Production and Operations.
Woldesemayat, M. and Ghajar, A. (2007). Comparison of Void Fraction
Correlations for Different Flow Patterns in Horizontal and Upward Inclined
Pipes. Int. J. Multiphase Flow 33: 347–370.
Xiao, J., Shoham, O., Brill, J., (1990). “A Comprehensive Mechanistic Model for
Two-phase Flow in Pipelines,” SPE paper 20631-MS, Dallas, TX, USA.
Yadigaroglu, G. and Hewitt, G. (2017). Introduction to Multiphase Flow.
Switzerland: Springer.
Zhang, H., Wang, Q., Sarica, C. et al. (2003a). A Unified Mechanistic Model for
Slug Liquid Holdup and Transition Between Slug and Dispersed Bubble
Flows. Int. J. Multiphase Flow 29: 97–107.
Zhang, H., Wang, Q., Sarica, C. et al. (2003b). Unified Model for Gas-Liquid
Pipe Flow via Slug Dynamics. ASME J. Energy Res. Technol. 125: 266–283.
Zuber, N. (1960). On the Variable-Density Single-Fluid Model for Two-Phase
Flow. J. Heat Transfer, Trans. ASME, Ser. C 82: 255–258.
Zuber, N. and Findlay, J. (1965). Average Volumetric Concentration in
Two-Phase Flow Systems,” Trans. ASME, Ser. C. 87: 453.❦
❦ ❦
❦❦
❦ ❦
❦
117
6
Two-Phase Flow in Wells
6.1 Introduction
This chapter covers the dominating factor of gravity on two-phase flow in
quasi-vertical piping. Three-phase flow (O/W/G) is customarily modeled as
a two-phase liquid–gas flow. Some reference is also made to horizontal well
flow despite not being a quasi-vertical flow.
A review of legacy models developed for well flow is included in
Section 6.6 because some of these models are still in significant use in
commercial software, spreadsheets, or even hand calculations. Newer
mechanistic models, supported by flow pattern predictions (see Chapter 4),
provide a firmer ground to predict two-phase flow performance in wells.
The well flow model serves to determine the production operating point
by superimposing the inflow production relationship (IPR) jointly in a graph
with a well flow model. This useful methodology is introduced in Section 6.3,
better known as nodal analysis.
During the life cycle, the production stream changes composition.
One detrimental phenomenon affecting the wells’ production process is
water coning, introduced in Section 6.5. Another interesting effect is the
GOR for an oil well which also covered in Section 6.5.
Intermittent well flow, that is, slugging, may cause perturbation on surface
facilities. The phenomenon of slugging is discussed in Section 6.9, with an
aim at production rate.
For well production affected by increment in fluid density, that is, pro￾duced water, it is necessary to assist the well with artificial lift. Section 6.10
touches on gas lift, one of the common and economical ways to assist pro￾duction by means of downhole gas injection.
A brilliant monograph covering all the topics in this chapter is the book
by Brill and Mukherjee (1999), where the reader can find further details on
topics skipped herein in pursuit of a streamlined chapter.
Multiphase Transport of Hydrocarbons in Pipes, First Edition.
Juan J. Manzano-Ruiz and Jose G. Carballo.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
Companion Website: www.wiley.com/go/Manzano-Ruiz/Multiphasetransport❦
❦ ❦
❦
118 6 Two-Phase Flow in Wells
6.2 Reservoir Boundary Conditions
The reservoir conditions of pressure, temperature, and fluid composition
represent the upstream boundary conditions for the system of dynamic
equations describing the production processes. During the production life
of the project, the hydrocarbon reserves are depleted (Craft and Hawkins,
2015) due to the hydrocarbon withdrawal. This depletion process translates
into lower pressure at the upstream end of the production model as time
goes by. In some reservoirs, there may be a large underlying aquifer
supporting pressure for a long time and enabling a prolonged life-cycle
operation. Without an artificial lift, the only source of energy to deliver
the hydrocarbon stream comes from the reservoir, and its decline has a
profound effect on production.
Although reservoir temperature remains constant during the life cycle, the
produced fluid composition will change, for example, increasing amounts
of water produced, and increased amounts of gas are released. All these
changes will determine the reservoir’s true recovery factor.
The logical approach to simulate hydrocarbon production is to consider an
integrated production model, from the sand face, through the well string,
followed by the gathering system toward the processing facilities. For off￾shore fields, the gathering system is known as the SURF (subsea umbilical,
risers, and flowlines) infrastructure, delivering the production at the topside
facility for preliminary processing.
6.2.1 Well Production String: Vertical, Inclined, and Horizontal
Wells
The production well joins the gap between the reservoir and the gathering
system infrastructure. The well itself could also be viewed as a restriction for
the stream flow when the gravitational and frictional effects are accounted
for. Wells are designed, drilled, and completed to meet the expected
production rates at high pressure and temperature. The production string
is the tubing enclosed by layers of casing piping that protects the integrity
of the hole. Aside from the different casing sizes and depths, the tubing
may be of a single size or telescopic.
The effects of friction and gravity relate to two key factors in every well,
namely the measured depth (MD) and the true vertical depth (TVD). The
effect of gravity manifests through the TVD. The effect of friction relates to
MD. The latter should be better understood as measured length to also apply
to horizontal wells. Both terms are normally referenced with respect to the
rotating table of the drilling rig.❦
❦ ❦
❦
6.2 Reservoir Boundary Conditions 119
Very seldom a well is truly vertical but has some degree of inclination
in pursuit of the reservoir’s objective. An inclined well deviates from
the vertical direction below the so-called kick-off point (KOP). In some
instances, the deviation angle is quite pronounced, and the well is labeled
highly deviated or extended reach wells due to the step-out. The purpose of
drilling extended wells sideways is to reach far objectives from a specific pad
or cluster enabling farther objectives from a given location. These locations
are known as drill centers where the rig is stationed, eliminating the
need to mobilize the rig to several other drill locations. The savings in rig
mobilization are, however, offset by drilling time associated with longer
drilling paths; thus, there is a Capex tradeoff between drilling time and rig
mobilization costs. Additionally, drilling risks must be evaluated too for the
drill center option. A sketch of a subsea well completion including casings
piping and production tubing is shown in Figure 6.1.
Annulus “c”
Seafloor
Annulus “B”
Annulus “A”
Tubing pressure
Figure 6.1 Well completion sketch. Source: This photo by unknown author is
licensed under CC BY-ND.❦
❦ ❦
❦
120 6 Two-Phase Flow in Wells
The simulation of the production system requires starting from the
upstream reservoir boundary condition. Therefore, the wells must be
integrated into the flow model, with their completion details (e.g. tubing
string, perforation intervals, kick-off point, SSCSV, layers of casings, and
packers’ fluid). This information is crucial to simulate the well performance
(thermal and hydraulic).
The well hydraulic performance is driven by gravitational effects.
The gravitational component of pressure drop is proportional to the
two-phase flow density. Thus, it is vital to have a good estimate of the liquid
holdup distribution along the well to obtain the best estimate of the local
two-phase flow density. It is not unusual to realize, for large-size tubing
strings, that the frictional component is about two orders of magnitude
smaller than the gravitational component of pressure drop. Conversely,
there are high-performing wells (e.g. gas wells with extraordinary potential)
that must be provided with extra-large production string (i.e. completed
with casing pipe) to handle the large frictional component of pressure drop
which may be comparable to the gravitational component.
The technology of drilling horizontal wells allows to tap production
zones with larger production zones. This technology matured with the
advent of geo-steering multidirectional drill technology. The horizontal
well has greater contact with the production sand and therefore boosts the
productivity index of the well. For the past 15 years, the combination of
horizontal well and reservoir-fracturing technologies successfully enabled
the great productivity of tight unconventional reservoirs, that is, shale
reservoirs, with extremely low permeability and porosity. The objective of
the horizontal well is to tap multiple pay zones, with semi-vertical bedding.
The productivity of the horizontal well is proportional to its length, but at
additional drilling time, risks, and costs. Nowadays, horizontal wells have
been drilled with a record lateral of about 5.5 km.
Aside from horizontal producers, the technology has been exported to
injector wells for improving well injectivity due to the augmented reservoir
contact, making them best for enhanced-oil-recovery (EOR) applications.
6.3 NodalTM Analysis
Nodal analysis is the trademark of SBL (former Schlumberger company),
and it is a methodology employed to determine the well performance.❦
❦ ❦
❦
6.4 Wells Cluster and Manifolds 121
Herein, well performance means the achievable standard flow rate of the
production fluid and the pressure at the nodal point.
The nodal analysis is the balance between the reservoir energy, repre￾sented by the reservoir inflow relationship, and the lifting requirements
of the production stream through the well completion. Implicit in this
lift requirement is the wellhead pressure (Pwh) imposed by the gathering
system at the surface. In other words, the well performance is subject to
the performance of the overall production system. The IPR is the function
(Economides et al., 2013) connecting the production flow rate with the
available bottom-hole flowing pressure (Pwf). The oil stream production
rate is stated in terms of the equivalent stock-tank flow rate to avoid the
uncertainty of the volumetric flow rate at other conditions. Similarly, for
gas wells, the flow rate is expressed at standard conditions (i.e. 1.01 bara
and 15.6 ∘C). This practice of expressing flow at standard conditions is
equivalent to specifying the mass flow rate which is conserved.
The lift performance of the well is referred to as the vertical lift perfor￾mance (VLP) relationship or sometimes labeled tubing performance rela￾tionship (TPR). The nodal analysis does the matching of IPR against VLP
to determine the resulting flow rate and the bottom-hole pressure Pwf . The
nodal graph offers the possibility for sensitivity analyses to explore different
well completions and also the effect of well choking at the tree level.
Figure 6.2 illustrates a nodal analysis for an oil well during various stages
of the life cycle. The IPR curves decline from early life to late life, while
the VLP remains constant (e.g. constant fluid composition, constant well￾head pressure, same well completion). It is obvious from the IPR curves
that the reservoir is depleted, and the reservoir pressure declines apprecia￾bly. The expected well performance drops from an initial 456 sm3/d (2,868
stb/d) to 255 sm3/d (1,604 stb/d).
6.4 Wells Cluster and Manifolds
When multiple wells are drilled to deplete a hydrocarbon reservoir, it makes
sense to minimize the cost and time of rig mob/demob (i.e. mobilization).
Thus, several wells may be drilled from a small footprint or pad, forming
a cluster of wells feeding into a production manifold. The manifold is a
structure assembled with shutoff valves to isolate each individually well.
For subsea manifolds (Figure 6.3), the valves are remotely operated either❦
❦ ❦
❦
122 6 Two-Phase Flow in Wells
Life-cycle nodal analysis of a well
500
450
400
350
300
250
Downhole pressure (bara) 200
150
100
50
0
0 100 200 300 400
351
456
255
Stock-tank liquid flowrate (sm3
/d)
500 600 700
Late life IPR
Mid life IPR
VLR
Early life IPR
Figure 6.2 Example of a Nodal AnalysisTM.
Figure 6.3 Subsea manifold. Source: Jason Woodhead/Flickr/CC BY 2.0.❦
❦ ❦
❦
6.4 Wells Cluster and Manifolds 123
Well
Pipeline
PLEM
Manifold Jumper
Figure 6.4 Subsea wells tie into the manifold. Source: Rui et al. (2023)/John Wiley
& Sons/CC BY 4.0.
hydraulically or electrically. Usually, the production manifold has spare slots
to connect at a future time when additional local drilling may be performed.
Typically, subsea trees are connected via a jumper structure (see
Figure 6.4) directly to a manifold or with a jumper and a short flowline
tie-in to a production manifold. A multiphase flowline conveys the pro￾duction from the manifold to the processing facilities or taps another
multiphase flow trunk line. The production manifold normally connects to
an independent test flowline that could be selectively aligned with a single
well to be tested. This test line enables the operator to execute the regular
testing of each well to determine allocation factors and perform reservoir
management in general.
The production manifold structure facilitates workover operations of
several cluster wells if needed, without rig mobilization. Often, for onshore
applications, a gas–liquid production separator and/or a test separator may
be present at the cluster pad. For subsea applications, there are a handful of
fields that have subsea processing and boosting. In both cases, the objective
is the same – to separate gas from liquids as early as possible to eliminate
the higher hydraulic losses caused by multiphase flow in pipes.
The comparison between onshore fields and subsea field developments
leads to a striking difference in the number of wells and drilling and
completion costs. Onshore wells overwhelm the number of subsea wells.
Subsea wells carry an exceedingly high price tag as compared to onshore
drilling; for this reason, subsea developments are justified when the
materiality (i.e. reserves) of the reservoir, the potential productivity index
of the wells, and the smaller number of wells can deliver a profitable❦
❦ ❦
❦
124 6 Two-Phase Flow in Wells
production profile for a long life cycle. In this case, a small footprint of
subsea manifold(s) minimizes investment and future maintenance costs.
6.5 Water and Gas Coning
Water and/or gas coning refers to the fluid migration overriding the oil pro￾duction in the reservoir formation. The water coning problem arises when
free water in the lower layers of the reservoir is driven to the wellbore by
the drawdown pressure gradient. Similarly, gas coning from the gas cap gas
encroaches through the perforation zone in the near-wellbore area when the
remaining oil in place is saturated.
Produced water will break through during the life cycle because most
hydrocarbon traps are supported by aquifers. In general, the production of
water will increase requiring a handling and disposal management program
(Arnold and Stewart, 2008).
When water encroaches, the near-wellbore area creates several problems
diminishing fluid production. The operational issues arising from water con￾ing are as follows:
● Decreased lift capacity. The reservoir will face a larger back pressure
because the average density of the production fluid within the tubing
string will be higher.
● Risk of hydrate formation. The incremental presence of water, the presence
of gas in the solution released, and the higher pressure within the tubing
might create the conditions to form hydrate and potentially plug the well.
● Emulsions. The presence of water and the shear stresses (turbulence
effects) on the oil phase might enhance the chance of creating some tight
emulsions if there are natural surfactants at play.
● Scale. Water breakthrough is the signal of scaling issues setting in, due to
the dissolved salts that may come out of the solution depending on the
local temperature and pH.
Gas coning in oil wells may or may not enhance oil production.
The additional amount of gas pulled from the reservoir gas cap may serve
as a gas lift mechanism favoring liquid lifting. This beneficial effect applies
to low rates of liquid flow produced, but for high rates, the contrary takes
place because of the higher friction losses caused by the faster gas phase
velocity.❦
❦ ❦
❦
6.6 Legacy Models 125
6.6 Legacy Models
Older models published in the period 1940–1970 relied on the basic momen￾tum equation to estimate the pressure drop components (always neglecting
the acceleration component) and were well supported with empirical field
data correlations (e.g. holdup, friction coefficient). An outstanding summary
of methodologies before the 1980s was compiled in the course by Dukler and
Taitel (1982).
In general, all models share the same pressure gradient calculation proce￾dure, characterized by equations (6.1)–(6.6). Even the mechanistic models
also split the total pressure gradient into three terms. The total pressure
gradient along the tubing axis 𝓁 is
( dp
d𝓁
)
total
≅
( dp
d𝓁
)
fric
+
( dp
d𝓁
)
grav
(6.1)
after neglecting the acceleration term with respect to the other terms:
( dp
d𝓁
)
acc
≪
( dp
d𝓁
)
grav
or∕and ( dp
d𝓁
)
fric
(6.2)
The friction term is expressed in terms of the tubing’s internal diameter d,
a characteristic two-phase flow density 𝜌m and velocity um depending on the
model considered
( dp
d𝓁
)
fric
= f 𝜌mu2
m
2d (6.3)
The Darcy–Weisbach friction factor is obtained from either Figure 5.4
or from a correlation using the Reynolds number (equation (6.5)) and the
nondimensional roughness parameter:
f = function (
Re,
𝜀
d
)
(6.4)
Re = 𝜌mumd
𝜇
(6.5)
The gravitation pressure gradient term is also calculated with a character￾istic density 𝜌m depending on the model considered:
( dp
d𝓁
)
grav
= 𝜌mg (6.6)
To date, some of the models covered in this chapter are still popular,
successfully supporting the nodal analysis for well producers. Given the
strong influence of the field database used to develop these correlations, it
is important to select the models that historically have given satisfactory
results depending on the type of fluid or the type of well completion.❦
❦ ❦
❦
126 6 Two-Phase Flow in Wells
6.6.1 Poettmann–Carpenter Model (1952)
This pioneering model is the longest-standing legacy one, with some use
by field practitioners due to its simplicity lending to hand calculations
(Poettmann and Carpenter 1952).
The model is expressed in FPS units as originally published, with the
caveat that our correlation of the friction factor has been included below.
Densities are expressed in lbm/ft3, mixture velocity j is expressed in ft/s,
tubing internal diameter is expressed in ft, and the total pressure gradient
(neglecting acceleration effects) is expressed in psi/ft.
The characteristic density for this model is evaluated with the volumetric
quality (equation 2.28):
𝜌m = 𝜌n = 𝜌G𝛽 + 𝜌L(1 − 𝛽) (6.7)
And the liquid density is evaluated with the water cut (WC),
𝜌L = 𝜌W WC + 𝜌O(1 − WC) (6.8)
The characteristic friction factor was presented by the authors in graphical
form as a function of the parameter 𝜛 (expressed in lbm/ft-s):
𝜛 ≡ 𝜌n jd (6.9)
fP−C ≃ 1
0.163𝜛1.5 − 1.45 + 5.99 Ln(𝜛)
𝜛2
(6.10)
The total pressure gradient equation becomes
dp
d𝓁 ≅ 0.00694𝜌n + fP−C𝜌n j
2
9,265d (6.11)
As pointed out before, for vertical or slanted wells, the first term above
(gravitation term) dominates over the friction term (for regular-size tubing
design). Therefore, the accuracy of equation (6.11) is as good as the mixture
density estimate. In this particular model, the void fraction parameter has
been approximated by the volumetric gas quality 𝛽 for simplicity, which is
not a good assessment for the ample spectrum of flow patterns in vertical
upward flow. Order-of-magnitude estimates for pressure gradients can be
expected from the Poettmann and Carpenter model.
6.6.2 Griffith–Wallis Model (1961)
Griffith and Wallis (1961) published a study on slug and bubble flow in
vertical upward flow, which became a standard for vertical upward flow
modeling and training (Griffith, 1978) in two-phase flow. The original
work was amply covered in the monograph by Wallis (1969). This work❦
❦ ❦
❦
6.6 Legacy Models 127
was imported into later models such as Hagedorn and Brown (1965) and
Orkiszewski (1967).
According to this method, the boundary between bubbly and slug flow is
(in SI units)
jG =
(
1.071 − 0.06762 j
2
d
)
j, with j <
√
13.9d (6.12)
In other words, when the actual jG is less than the value obtained from
equation (6.12), the flow pattern would be bubbly. The liquid holdup can
then be estimated using
HL = (uS − j) + √(uS − j)2 + 4uS jL
2uS
(6.13)
In this model, the slip velocity uS is approximated by the constant value
0.2439 m/s. The Reynolds number is calculated with the liquid density 𝜌L
and the liquid velocity jL/HL as characteristic parameters. The equations for
estimating the friction pressure gradients are
Re = 𝜌L jLd
HL𝜇L
(6.14)
( dp
d𝓁
)
f
= f 𝜌L
2d
( jL
HL
)2
(6.15)
The gravitation pressure gradient is evaluated with the characteristic
density 𝜌s in the case of bubbly flow:
𝜌S = [𝜌LHL + 𝜌G(1 − HL)] (6.16)
When the gas superficial velocity exceeds the value obtained from
equation (6.12), the flow pattern would be slug flow. This regime is charac￾terized by the bubble rise velocity ub, and the relevant Reynolds numbers
for slug flow can be computed from
ub = C1C2
√gd (6.17)
NRe,b = 𝜌Lubd
𝜇L
(6.18)
NRe,L = 𝜌L jd
𝜇L
(6.19)
and the parameters C1 and C2 are read from Figures 6.5 and 6.6.
These parameters allow us to calculate the friction component of the
pressure gradient, in combination with equations (6.4), (6.6), and (6.13)
through (6.19), after an iterative solution for equations is attained jointly
with Figures 6.5 and 6.6.❦
❦ ❦
❦
128 6 Two-Phase Flow in Wells
0.4
0.3
C
0.2 1
0.1
0.0
0 10 20 30
NRe,b
C1
 funtion
40 50
Figure 6.5 C1 function for Griffith–Wallis model.
1000
1.1
1.2
1.3
1.4
1.5
1.0
0 2000 3000
NRe,b <= 3,000
NRe,b = 4,000
NRe,b = 5,000
NRe,b = 6,000
NRe,b >= 8,000
4000 6000 5000
NRe,L
C2
C2
 function
Figure 6.6 C2 function for Griffith–Wallis model.❦
❦ ❦
❦
6.6 Legacy Models 129
The two-phase flow density in the gravitation term shall be evaluated with
the following density expression to be used in equation (6.6) in the case of
slug flow:
𝜌slug = 𝜌L( jL + ub) + 𝜌G jG
j + ub
(6.20)
6.6.3 Duns–Ros Model (1963)
This is another model based on empirical field measurements which has
been extensively used and still is in vogue in some commercial codes applied
for oil wells.
The basis of the model is the flow pattern identification followed by
choosing the corresponding correlations. The proposed flow pattern map is
illustrated in Figure 6.7 and comprises bubbly/plug, churn/slug, annular￾mist, and transition between slug and mist flow.
The methodology starts by calculating three nondimensional parame￾ters – the liquid velocity number NLV , the gas velocity number NGV , and
the pipe diameter number Nd,
0
10
20
30
40
50
60
0 200 400
Duns and Ros vertical upward flow map
600 800 1000
NVG
NVL
Region I (bubbly and plug flow)
Region II
(churn and slug flow)
Region III
(annular mist flow)
Transition
Figure 6.7 Duns and Ros flow pattern map.❦
❦ ❦
❦
130 6 Two-Phase Flow in Wells
● Liquid velocity number:
NLV = jL
( 𝜌L
g𝜎L
)1∕4
(6.21)
● Gas velocity number:
NGV = jG
( 𝜌L
g𝜎L
)1∕4
(6.22)
● Pipe diameter number:
Nd = d
(g𝜌L
𝜎L
)1∕2
(6.23)
The flow pattern is identified based on the parameters L1 and L2, from
Figure 6.8, and the following criteria:
● Bubbly and plug flow:
NGV < L1 + L2NLV (6.24)
L1 and L2
Duns and Ros L1
 and L2
 functions
L1
L2 0.5
0.0
1.5
1.0
2.5
2.0
0 50 100 150 200 250
Nd
Figure 6.8 Functions L1 and L2 to identify flow pattern.❦
❦ ❦
❦
6.6 Legacy Models 131
● Churn and slug flow:
L1 + L2NLV < NGV < 50 + 36NLV (6.25)
● Annular-mist flow:
NGV > 75 + 84N0.75
LV (6.26)
● Transition:
50 + 36NLV < NGV < 75 + 84N0.75
LV (6.27)
The next step in the method is to estimate the slip factor S corresponding
to the flow pattern as summarized by the following equations:
● Bubbly and plug flow:
S = F1 + F2NLV +
(
F3 − F4
Nd
) ( NGV
1 + NLV )2
(6.28)
● Churn and slug flow:
S = (1 + F5)
(
N0.982
GV + F6 + 0.029Nd
)
(1 + F7NLV)2 (6.29)
● Annular-mist flow:
S = 0 (6.30)
The parameters F1 through F7 were empirically determined and are
presented in Figures 6.9 and 6.10, using the liquid viscosity number
NL from equation (6.38). The liquid holdup can be estimated with
equation (6.13), where the slip velocity uS is calculated by
uS = S
(g𝜎L
𝜌L
)1∕4
(6.31)
For annular-mist flow, the slip velocity is assumed to be zero and the
holdup is equal to 1−𝛽.
Once the liquid holdup is estimated, the characteristic density for this
model is 𝜌S (equation (6.16)). The two-phase flow friction factor “f ” depends
on the three parameters f 1, f 2, and f 3, obtained by
● Estimate Reynolds number
ReL = 𝜌L jLd
𝜇L
(6.32)
● Read friction factor f 1 Moody diagram (Figure 5.4) using Reynolds
number❦
❦ ❦
❦
132 6 Two-Phase Flow in Wells
0.0
0.5
F4
F3
F1
F2
1.0
1.5
2.0
F1, F2, F3, and F4 2.5
3.0
3.5
4.0
4.5
0.000 0.500 1.000 1.500 2.000
NL
Duns and Ros functions F1 through F4
Figure 6.9 Functions F1, F2, F3, and F4.
● Read f 2 from Figure 6.11 with the parameter
f1
(jG
jL
)
N0.66
d (6.33)
● Calculate f 3 from
f3 = 1 + f1
4
√
jG
50jL
(6.34)
● Compute friction factor
f = f1f2
f3
(6.35)
Finally, the pressure gradients are evaluated with the following equations:
● Friction:
( dp
d𝓁
)
f
= f 𝜌L jL j
2d (6.36)❦
❦ ❦
❦
6.6 Legacy Models 133
0.00
0.05
0.10
0.15
F5, F6, and F7 0.20
0.25
0.30
0.35
0.0 0.5 1.0 1.5 2.0
NL
Duns and Ros functions F5 through F7
F6
F5
F7
Figure 6.10 Functions F5, F6, and F7.
● Gravitation:
( dp
d𝓁
)
g
= 𝜌Sg (6.37)
6.6.4 Hagedorn–Brown Model (1965)
According to a study done by Ansari et al. (1994), the empirical model of
Hagedorn and Brown (H–B) produces as good estimates of pressure drop in
two-phase flow through oil wells as the mechanistic models available at that
date. Currently, this model stands as a regular choice in commercial codes
to simulate well performance via TPR.
Aside from the three nondimensional parameters defined by equations
(6.21)–(6.23), the H–G model needs the liquid viscosity number NL,
NL = 𝜇L
(
g
𝜌L𝜎3
L
)1∕4
(6.38)❦
❦ ❦
❦
134 6 Two-Phase Flow in Wells
0.0
0.2
0.4
0.6
0.8
1.0
1.2
f
2
0.001 0.010 0.100 1.000 10.000 100.000 1,000.000
f
1
(j
G/j
L
)(Nd)0.66
Duns and Ros f
2
 function
Figure 6.11 Function f 2.
These parameters serve to read the variables NLC, 𝜓, and HL/𝜓, from
Figures 6.12, 6.13, and 6.14.
Once the parameters NLC, 𝜓, and HL/𝜓 are read, the liquid holdup HL will
follow, and the two-phase flow density can be obtained from equation (6.16).
The two-phase flow viscosity can be estimated with the liquid holdup HL
and the following equation:
𝜇s = 𝜇HL
L 𝜇(1−HL)
G (6.39)
and the Reynolds number is obtained from equation (6.40) using
equation (6.7):
Re = 𝜌n jd
𝜇s
(6.40)
to read the friction factor f from Figure 5.4. Then, the frictional pressure
gradient can be obtained from equation (6.41):
( dp
d𝓁
)
f
= f 𝜌2
n j
2
2d𝜌S
(6.41)
and the gravitation pressure gradient can be calculated using equation (6.10).❦
❦ ❦
❦
6.6 Legacy Models 135
0.001
0.010
0.100
0.001 0.010
Hagerdorn and Brown NLC function
0.100 1.000
NL
NLC
Figure 6.12 Hagedorn–Brown model function NLC .
1.1
1.0
0.0 0.1 0.2 0.3 0.4
NGV(NL)0.38/(Nd)2.14
0.5 0.6 0.7 0.8 1.0 0.9
1.3
1.2
1.4
1.6
1.5
1.8
1.7
1.9
2.0
Hagerdorn and Brown ψ function
ψ
Figure 6.13 Hagedorn–Brown model function 𝜓.❦
❦ ❦
❦
136 6 Two-Phase Flow in Wells
0.1
0.0
1.E‒06 1.E‒05 1.E‒04 1.E‒03 1.E‒02
NLV/(NGV)
0.575(NLC/Nd)(p/pSC)
0.1
0.3
0.2
0.4
0.6
0.5
0.8
0.7
HL
/ψ
0.9
1.0
Hagerdorn and Brown HL
/ψ function
Figure 6.14 Hagedorn–Brown model function HL/𝜓.
The Hagedorn–Brown model can sometimes predict incorrect liquid
holdup for the slug flow regime. It is known that under certain circum￾stances the holdup obtained from Figure 6.14 could be smaller than the
value predicted assuming a no-slip condition among the phases, that is,
HL = 1−𝛽. In such case, the recommendation is to substitute the holdup
factor with the no-slip estimate.
Another improvement in this methodology is to apply Griffith and Wal￾lis’s (1961) model when this other model predicts bubbly flow. A similar
approach has been followed by Orkiszewski (1967).
6.6.5 Orkiszeski Model (1967)
Orkiszewski (1967) compared the accuracy of the previous well flow cor￾relations available and concluded that none of the models did a decent job
predicting the performance of the full spectrum of flow regimes in a well.
From the previous models, Orkiszewski borrowed the following models:
● Griffith and Wallis (1961) for bubbly/plug upward flow. The same flow
pattern map from this model is used to differentiate between bubbly/plug
and slug/churn regimes.❦
❦ ❦
❦
6.6 Legacy Models 137
● A modified Hagedorn and Brown (1965) model for slug/churn flow and,
● Duns and Ros (1963) for annular/mist flow. The same flow pattern
map from this model is used to differentiate between annular/mist and
slug/churn regimes.
In this section, we focus on the modified H–B model for slug flow because
the other flow regimes have been covered in previous sections.
Once the pattern identification indicates slug flow, the characteristic
density is a modification of equation (6.16) to include the effects of
slipping liquid film surrounding slugging the Taylor’s bubbles and the
entrained droplets within the bubbles themselves. This led to add the liquid
distribution coefficient Γ,
𝜌slug = 𝜌L( jL + ub) + 𝜌G jG
j + ub
+ 𝜌LΓ (6.42)
Orkiszewski (1967) provided correlations for the liquid distribution coef￾ficient Γ based on the identification of the continuous phase (either oil or
water).
The friction pressure gradient is calculated with
( dp
d𝓁
)
f
= f 𝜌L j
2
2d
[
jL + ub
j + ub
+ Γ]
(6.43)
6.6.6 Beggs–Brill Model (1973)
The popular Beggs and Brill (1973) model applies to the inclined and
vertically upward flow over a discretized domain, with the support of a
compositional fluid model (e.g. phase equilibrium). The results obtained
with this model are within +30/−20% compared to mechanistic models or
two-fluid models. Despite this level of uncertainty, the model is useful for a
first approximation or to quickly discern among design options.
Section 5.13.2 covered the Beggs and Brill model for flowlines, but the
same methodology can be applied to wells by appropriate adoption of angle
of inclination 𝜙.
6.6.7 Gray Model (1978)
Gray (1978) method finds its application in vertical gas-condensate wells,
including water production. The restriction of applying this method involves
gas velocity up to 15 m/s, tubing ID larger than 89 mm, and liquid load￾ings exceeding 280 m3 (condensate) per mmsm3 (millions of standard cubic
meters of gas), and 28 m3 (water) per mmsm3 (gas).❦
❦ ❦
❦
138 6 Two-Phase Flow in Wells
This model evaluates the liquid holdup as
HL = 1 −
1 − exp {
−2.314[
NV
(
1 + 205
ND
)]B
}
(
1 + jL
jG
) (6.44)
where the parameters NV , B, and Nd are evaluated with
NV = 𝜌2
n j
4
g𝜎L(𝜌L − 𝜌G) (6.45)
Nd = g(𝜌L − 𝜌G)d2
𝜎L
(6.46)
B = 0.0814
⎡
⎢
⎢
⎣
1 − 0.0554Ln
⎛
⎜
⎜
⎝
1 +
730
1 + jG
jL
⎞
⎟
⎟
⎠
⎤
⎥
⎥
⎦
(6.47)
The liquid holdup is used to calculate the two-phase flow density
(equation (6.16)), and the latter allows us to estimate the gravitation term
(equation (6.46)).
The friction factor can be read from Figure 5.4 with the following Reynolds
number and the modified nondimensional roughness parameter 𝜀/d:
Re = 𝜌s jd
𝜇s
(6.48)
for jL
jG
> 0.007 𝜀
d = 28.5𝜎L
𝜌n j
2d (6.49)
for jL
jG
< 0.007 𝜀
d = 𝜀single−phase gas
d
×
[
1 −
( jL
0.007jG
)] +
(28.5𝜎L
𝜌n j
2d
) ( jL
0.007jG
)
(6.50)
6.6.8 Mukherjee and Brill Model (1985)
This model is an improvement on the earlier Beggs and Brill (1973) model,
by incorporating newer data from an enlarged database. As such this model
is another empirical endeavor aimed to apply to any pipeline orientation,
that is, vertical up, inclined, downward, and horizontal as well.
The model strategy is similar to the earlier Duns and Ros (1963) approach
of first recognizing the flow pattern and following with an empirical model
specific to the identified regime. The next step consists of estimating the
liquid holdup of such flow pattern to evaluate the two-phase flow density
and the Reynolds number. With these results, the friction factor can be read❦
❦ ❦
❦
6.6 Legacy Models 139
from the Moody graph, and the gravitation and friction pressure drop can
be computed.
The two boundaries separating the bubbly from the slug flow, and the slug
from the annular-mist flow are expressed in terms of the tubing inclination
𝜃 with respect to the horizon. These boundaries are as follows:
● Bubbly-Slug flow:
jL,bubbly−slug =
(g𝜎L
𝜌L
)1∕4
10(Log10NGV + 0.94 + 0.074 sin 𝜃 − 0.855sin2𝜃 + 3.695NL)
(6.51)
● Slug-Annular flow:
jG,slug−annular =
(g𝜎L
𝜌L
)1∕4
10[1.401 − 2.694NL + 0.521(NLV)
0.329] (6.52)
The parameters required in equations (6.51) and (6.52) are obtained with
equations (6.21), (6.22), and (6.38). The liquid holdup for slanted wells is
computed from
HL = exp [
(
−0.380 + 0.130 sin 𝜃 − 0.120sin2
𝜃 + 2.34N2
L
)
(N0.476
GV
N0.289
LV )]
(6.53)
The friction pressure drop estimate depends on the flow regime identified
with expressions (6.51) or (6.52). The corresponding equation
( dp
d𝓁
)
fric,bubbly∕slug
=
f
(
NRe, 𝜀
d
)
[𝜌LHL + 𝜌G(1 − HL)] j
2
2d(1 − Ek) (6.54)
( dp
d𝓁
)
fric,annular
=
f
(
NRe, 𝜀
d
)
fR[𝜌G𝛽 + 𝜌L(1 − 𝛽) ] j
2
2d(1 − Ek) (6.55)
where
NRe = jd [ 𝜌G𝛽 + 𝜌L(1 − 𝛽)
𝜇G𝛽 + 𝜇L(1 − 𝛽)
]
(6.56)
Ek = jG j[𝜌LHL + 𝜌G(1 − HL)]
p
(6.57)
fR = 1 for HR ≡ 1 − 𝛽
HL
< 0.2 and HR > 1 (6.58)
fR = −7.832H4
R + 20.13H3
R − 19.84H2
R + 8.646HR − 1.008
for 0.2 ≤ HR ≤ 1 (6.59)❦
❦ ❦
❦
140 6 Two-Phase Flow in Wells
Lastly, the gravitation pressure drop is found in equations (6.6) and
(6.16).
Example 6.1 Legacy Models
Consider an oil reservoir with an original pressure of 450 bara and tem￾perature of 98 ∘C. The reservoir will be drilled with a vertical well down to
2900 m, completed with a vertical tubing of 114 mm internal diameter, and
casing perforated at 2800 m TVD. The reservoir has been simulated with
Fetkovich’s model (Economides et al., 2013), assuming an open potential of
600 sm3/d, and an exponent equal to 0.89. The well has a choke at the tree
with a bean size of 50 mm. Plot the well performance in terms of equivalent
oil production (sm3/d) in the abscissa, and downhole flowing pressure (bara)
in the ordinate, for the following models: Duns and Ros (Section 6.6.3),
Hagedorn and Brown (Section 6.6.4), Orkiszeski (Section 6.6.5), Beggs and
Brill (Section 6.6.6), and Mukherjee and Brill (Section 6.6.8).
The solution to this problem is captured in Figure 6.15, superimposing the
five TPR models with the IPR curve.
100
150
200
Downhole pressure (bara) 250
300
350
400
500
450
50
0
0 100 200 300 400
Stock-tank liquid flowrate (sm3
/d)
Life-cycle nodal analysis of a well
Inflow performance
Hagerdorn and Brown (453 sm3
/d)
Duns and Ros (519 sm3
/d)
Orkiszeski (462 sm3
/d)
Beggs and Brill (435 sm3
/d)
Mukherjee and Brill (419 sm3
/d)
500 600
Figure 6.15 Example 6.1 – Comparison of legacy models.❦
❦ ❦
❦
6.7 Mechanistic Models for Well Flow 141
The first conclusion from the previous graph is that the potential oil
production may lie within the range of 420–460 sm3/d, and Pwf may be in
the range of 230–260 bara. The second conclusion is that Duns and Ros
model far overpredicts (+18%) the potential production rate and the well
drawdown.
Although there are visible differences among four of the TPR models, the
uncertainty in flowrate is ±4.5% which is surprisingly good for modeling
two-phase flow for this specific reservoir-well case.
6.7 Mechanistic Models for Well Flow
Mechanistic models refer to involving conservation principles to represent
the physical phenomena for each specific flow pattern. Broader and more
dependable models (Shoham 2006) have been developed using physical
principles with the help of experimental data. Validation of such models
has been done at different scales but only to estimate the necessary
closure parameters that underpin the core of fundamentals. One of the best
keynote lectures on multiphase flow is Brill (2012) who summarized the
state of the art in the scope of mechanistic models available to date.
The strategy behind the mechanistic models is the application of
fundamentals to particular flow regimes after the proper identification
of the pattern has been confirmed. This strategy is aimed at both the
hydrodynamic and the heat transfer phenomena involved.
Three mechanistic models are reviewed in this section with a minimum
of details due to the added complexity of the models. The avid reader seek￾ing more details can refer to the original publications. Although at first sight
the equations presented below might look as simple empirical correlations,
as those presented for the legacy models, it is important to keep in mind
that mechanistic equations are supported by mass and momentum conser￾vation principles with a minimum of experimental data to close the system
of equations.
6.7.1 Ansari et al. Model (1994)
Like all other mechanistic models, the flow pattern map takes a vital role,
with distinctive hydrodynamic models for each flow pattern. The model
applies to vertical and slanted wells.
To differentiate between bubbly, dispersed, slug/churn, and annular flow,
Ansari et al. (1994) selected the flow map of Barnea (1987) which is a unified
improvement of the mechanistic model of Taitel et al. (1980).❦
❦ ❦
❦
142 6 Two-Phase Flow in Wells
The flow regime boundaries for the unified model Barnea (1987) are as
follows:
● Bubble-Slug:
jG = 0.383[
g𝜎L(𝜌L − 𝜌G)
𝜌2
L
]0.25
+ 0.333jL (6.60)
● Bubble-Disperse:
jG = j
⎡
⎢
⎢
⎢
⎣
0.482j
1.2√
0.4𝜎L
g(𝜌L − 𝜌G)
+
(𝜌L
𝜎L
)0.6⎛
⎜
⎜
⎜
⎝
fTP (
NRe, 𝜀
d
)
2d
⎞
⎟
⎟
⎟
⎠
0.4
− 0.175
⎤
⎥
⎥
⎥
⎦
2
(6.61)
● Slug-Annular:
jG = 3.1[
g𝜎L(𝜌L − 𝜌G)
𝜌2
G
]0.25
(6.62)
● Dispersed-Slug:
jG = 3.17jL (6.63)
This model also uses equations (6.1)–(6.6) to calculate the pressure gradi￾ents specific for each flow regime as follows:
● Bubble and disperse flow
𝜌TP = 𝜌G𝛽 + 𝜌L(1 − 𝛽) (6.64)
𝜇TP = 𝜇G𝛽 + 𝜇L(1 − 𝛽) (6.65)
NRe,TP = 𝜌TPjd
𝜇TP
(6.66)
fTP (
NRe,TP,
𝜀
d
)
(6.67)
● Slug and churn flow
These flow regimes require to estimate the length ratio (𝛇) between the
Taylor bubble (LTB) and the whole slug unit (LSU) and the liquid holdup in
the liquid slug volume (HLLS) – see original paper by Ansari et al. (1994).
The slug/churn model estimates the total pressure drop with the following
set of equations:
𝜁 = LTB
LSU
(6.68)❦
❦ ❦
❦
6.7 Mechanistic Models for Well Flow 143
𝜌LS = 𝜌G(1 − HLLS) + 𝜌LHLLS (6.69)
𝜇LS = 𝜇G(1 − HLLS) + 𝜇LHLLS (6.70)
NRe,TP = 𝜌LS jd
𝜇LS
(6.71)
( dp
d𝓁
)
fric
=
fTP (
NRe,TP, 𝜀
d
)
𝜌LS j
2
2d (1 − 𝜁) (6.72)
( dp
d𝓁
)
grav
= 𝜌LSg sin 𝜃 (6.73)
● Annular-Mist flow
The model for these flow regimes requires an estimate of the nondimen￾sional liquid film (𝛿/d) by means of an iterative solution – see original paper
by Ansari et al. (1994).
ucrit = 10,000 (jG𝜇G
𝜎L
)√𝜌G
𝜌L
(6.74)
FE = 1 − exp [
−ucrit − 1.5
8
]
(6.75)
𝜆LC = 1
1 +
( jG
FE jL
) (6.76)
𝜌C = 𝜌G(1 − 𝜆LC) + 𝜌L𝜆LC (6.77)
𝜇SC = 𝜇G(1 − 𝜆LC) + 𝜇L𝜆LC (6.78)
uSC = FE jL + jG (6.79)
NRe,TP = 𝜌CuSCd
𝜇SC
(6.80)
𝛿 ≡ 𝛿
d (6.81)
Z = 1 + 300𝛿 for FE < 0.9, or Z = 1 + 24𝛿
( 𝜌L
𝜌G
)1∕3
for FE > 0.9
(6.82)
( dp
d𝓁
)
fric
=
⎡
⎢
⎢
⎢
⎣
fTP (
NRe,TP, 𝜀
d
)
𝜌Cv2
SC
2d
⎤
⎥
⎥
⎥
⎦
[ Z
(1 − 2𝛿)5
]
(6.83)❦
❦ ❦
❦
144 6 Two-Phase Flow in Wells
( dp
d𝓁
)
grav
= 𝜌Cg sin 𝜃 (6.84)
6.7.2 Unified Mechanistic Models
Barnea (1986) and Barnea (1987) work initiated the trend to develop unified
two-phase flow models for pipe flow of any spatial orientation, including
flow pattern transitions. These papers were followed by other unified
models by Felizola and Shoham (1995), Gomez et al. (2000a), and Zhang
et al. (2003a, 2003b). The idea of a unified model found its cradle at Tulsa
University with the TUFFP (Tulsa University Fluid Flow Project) since
the mid-1980s until now. The objective of the unified model is to capture
all potential flow regimes and their hydrodynamic features under a single
methodology based on first principles.
The complexity of the unified models goes beyond the intent of this
chapter, which is to present streamlined methodologies to simulate vertical
and inclined to upflow in pipes, covering the range from fully empirical to
phenomenological models. The references listed should be consulted for
the minute details of the methodologies described herein.
Gomez et al. (2000b) proposed one valuable contribution to the unified
models to improve Ansari et al. (1994) slug/churn model by simplifying the
estimation of liquid slug volume (HLLS) with the following expression:
HLLS = exp (
−0.00785𝜃 − 0.00000248𝜌L jd
𝜇L
)
(6.85)
valid for well inclinations 𝜃 (in degrees measured with respect to horizontal)
ranging from vertical to horizontal.
6.7.3 Hasan and Kabir Model (2002)
The Hasan and Kabir (2002) model includes its own regime map and holdup
correlations specific per flow pattern. The model comprises the following:
Flow pattern map
● Bubble-Slug flow transition
jG = sin 𝜃
⎛
⎜
⎜
⎜
⎝
C0 jL + 1.53[ g𝜎L(𝜌L−𝜌G)
𝜌2
L
]0.25
4 − C0
⎞
⎟
⎟
⎟
⎠
(6.86)❦
❦ ❦
❦
6.7 Mechanistic Models for Well Flow 145
where the parameter Co is
C0 = 1.2 if d < 0.12 m or if jL > 0.02 m∕s
C0 = 2.0 if d > 0.12 m or if jL < 0.02 m∕s (6.87)
with the understanding that if the gas superficial velocity is less than the
value from equation (6.86), the flow pattern is bubble, and the converse is
slug flow.
● Bubble-Disperse flow transition
j = 3.967d0.4286[
g(𝜌L − 𝜌G)
𝜎L
]0.4464(𝜎L
𝜌L
)0.5357( 𝜌L
𝜇L
)0.0714
(6.88)
Again, if the mixture velocity is less than the value from equation (6.88),
the flow pattern is bubble, and the converse is dispersed flow.
● Slug-Annular flow transition. This transition is the same as equation (6.62),
derived from the Ansari et al. (1994) model.
Pressure drop
● Bubble and dispersed flow
HL = 1 − jG
C0 j + 1.53[ g𝜎L(𝜌L−𝜌G)
𝜌2
L
]0.25 (6.89)
NRem = 𝜌L jd
𝜇L
(6.90)
𝜌S = 𝜌LHL + 𝜌G(1 − HL) (6.91)
( dp
d𝓁
)
grav
= 𝜌Sg sin 𝜃 (6.92)
( dp
d𝓁
)
fric
=
fTP (
NRem , 𝜀
d
)
𝜌S j
2
2d (6.93)
● Slug and churn flow
HL = 1 − jG
1.2j + 0.35√
sin 𝜃(1 + cos 𝜃)1.2[ gd(𝜌L−𝜌G)
𝜌L
]0.5 (6.94)
This regime uses equations (6.92)–(6.93) to compute the pressure drop
terms.❦
❦ ❦
❦
146 6 Two-Phase Flow in Wells
● Annular-Mist Flow
The model starts by calculating the root square of the Lockhart–Martinelli
parameter:
𝜒 ≡
(1 − x
x
)0.9(𝜌G
𝜌L
)0.5( 𝜇L
𝜇G
)0.1
(6.95)
and follows with the next set of equations and equation (6.74):
𝜆LC = (1 + 𝜒0.8)
−0.378 (6.96)
fC = 0.046
(𝜌GjGd
𝜇G
)0.2 (1 + 75𝜆LC) (6.97)
FE = 0.0055u2.86
crit if ucrit < 4 (6.98)
FE = 0.857(log10ucrit) − 0.2 if ucrit > 4 (6.99)
𝜌C = 𝜌G jG + 𝜌L jLFE
jG + jLFE
(6.100)
( dp
d𝓁
)
grav
= 𝜌Cg sin 𝜃 (6.101)
( dp
d𝓁
)
fric
= fC𝜌C
2d
( jG
1 − 𝜆LC )2
(6.102)
Example 6.2 Mechanistic Models
Consider again the same oil reservoir and well from Example 6.1, Section 6.8.
Plot the well performance, in terms of equivalent oil production (sm3/d)
in the abscissa, and downhole flowing pressure (bara) in the ordinate,
for the Ansari et al. model (Section 6.7.1), and the Unified TUFFP model
(Section 6.7.2).
The solution with the mechanistic models is shown in Figure 6.16, super￾imposing the two TPR models with the same IPR curve from Example 6.1.
The mechanistic models provide remarkably close results with uncer￾tainty of ±1.3%, and Pwf in the range of 235–244 bara. This type of result
builds confidence in the flowrate achievable and the necessary well
drawdown.
Comparing the results of Examples 6.1 and 6.2 leads to conclude that the
legacy models provide a similar estimate with a bit more uncertainty. How￾ever, the simulation effort to produce results with legacy models is less than
the effort of running mechanistic models. Thus, there is a tradeoff of accu￾racy versus speed of computation.❦
❦ ❦
❦
6.8 Comparison of Flow Models 147
0 100 200 300 400 500 600
Stock-tank liquid flowrate (sm3
/d)
100
150
200
Downhole pressure (bara) 250
300
350
400
500
450
50
0
Life-cycle nodal analysis of a well
Inflow performance
Unified TUFFP (453 sm3
/d)
Ansari et al. (441 sm3
/d)
Figure 6.16 Example 6.2 – Comparison of mechanistic models.
6.8 Comparison of Flow Models
Shoham (2006) presents a comprehensive comparison (Table 6.1) among
seven well simulation methods. To compare the relative merits of each
model, the performance factor FRP was calculated, ranging between “0”
(perfect score) and “6” (worst case). The comparison was done with a full
database of 1712 experiments, comprising 1086 vertical wells and the rest
were deviated wells. The database was evaluated with and without the data
from the Hagedorn and Brown (H–B) database.
The results indicate that the two methods that do best are Hagedorn and
Brown (legacy) and Ansari et al. (mechanistic). However, 30% of the vertical
wells and 19% of the full database were experiments performed by Hagedorn
and Brown which tilted the FRP index in favor of their correlation. The last
two columns of Table 6.1 show the best performance by Ansari et al. after
eliminating the experiments by Hagedorn and Brown from the full database.
It is obvious from the data above that Hagedorn–Brown is a dependable
model comparable in performance to a mechanistic model.❦
❦ ❦
❦
148 6 Two-Phase Flow in Wells
Table 6.1 Comparison of seven models with database.
Full
database
Vertical
wells
Deviated
wells
Vertical
wells
w/o H-B
Deviated
wells
w/o H-B
No. experiments 1712 1086 626 755 1381
Ansari et al. 0.7 1.12 1.38 0.08 0
Hagedorn–Brown 0.59 0.6 0.92 0.88 0.77
Duns–Ros 1.72 1.68 1.68 1.71 1.79
Hasan–Kabir 1.94 2.01 2.2 1.84 1.78
Beggs–Brill 2.98 2.91 3.45 3.32 3.41
Orkiszeski 4.26 5.27 2.32 5.84 4.69
Mukherjee–Brill 4.88 4.65 6 3.91 4.6
6.9 Severe Slugging Phenomenon
The mechanistic models presented in the previous section address the
phenomenon of slugging in vertical and inclined well geometries, on the
basis of a time average. Such averaging should be understood as the statis￾tical performance of multiple slugs with different lengths and frequencies.
However, aside from the regular slug flow regime, there is another more
harmful condition known as severe slugging.
Severe slugging is an intermittent flow pattern having exceedingly long
liquid slugs that form at the last section of a near-horizontal flowline, at the
entrance of a riser pipeline. A liquid slug is generated when the incoming
flow is larger than the exit liquid flow into the riser. This phenomenon gets
enhanced when the flowline has a negative slope toward the base of the riser.
There are four recognized phases in severe slugging that follow a cyclic
mechanism. These phases are slug generation, slug production, bubble
penetration, and gas blowdown, as described by Schmidt et al. (1980) and
Fabre et al. (1990). The pressure build-up in the flowline at some point
overcomes the forces acting on the liquid slug and pushes it up through the
riser. Once most of the liquid slugs leave at the top, a gas bubble penetrates
the riser, and the process ends with gas blowdown at the top. The cycle
then reinitiates with more liquid storage at the base of the riser. Figure 6.17
shows a sketch depicting these four phases with an indication of the relative
duration of each of these.
The severe slugging hydrodynamic phenomenon is quite complex to
model. Numerous laboratory and field tests have been conducted to shed❦
❦ ❦
❦
6.9 Severe Slugging Phenomenon 149
Slug generation Slug production Bubble penetration
Bubble penetration
Gas blowdown Riser Riser
Flowline Flowline Flowline Pressure
Slug generation Slug production
Time
Gas
blowdown
Flowline
Riser Riser
Figure 6.17 Phenomenon of severe slugging.
some light and develop some empirical correlations. The two-phase flow
literature is rich in reporting slugging phenomena in vertical pipes and
risers. Some other important publications highlighting semi-theoretical
and empirical approaches to understand the slugging phenomena include
Bøe (1981), Schmidt et al. (1985), Taitel (1986), Pots et al. (1987), Taitel et al.
(1990), Sarica and Shoham (1991), Cai et.al. (1999), Shoham (2006), and
Al-Safran and Brill (2017).
Pots et al. (1987) offered an important criterion to predict the onset of
severe slugging. This criterion is the severe slugging group IISS defined as
IISS ≡
(mG
mL
) [ ZRT
MWGLFg(1 − HL)
]
(6.103)
In this expression, Z is the gas compressibility and T is the absolute tem￾perature, both evaluated at the conditions at the base of the riser. MWG is
the gas molecular weight, HL is an average value for the liquid holdup along
the whole flowline, and LF is the effective length of the flowline, calculated
as the product of the real flowline length times HL.
According to Pots et al., severe slugging takes place when IISS is less than
one. This criterion leads to the following inequality to identify the severe
slugging condition:
jL > jG
( p
𝜌LgLF
)
(1 − HL) (6.104)❦
❦ ❦
❦
150 6 Two-Phase Flow in Wells
Solving for the effective flowline length LF from the inequality (6.104),
we obtain an estimate for the liquid slug length that would trigger severe
slugging in the riser:
LF >
(jG
jL
) ( p
𝜌Lg
)
(1 − HL) (6.105)
In other words, an order of magnitude for the slug length during severe
slugging can be estimated as
Lslug ≈ Lriser
IISS
(6.106)
The slug’s frequency during severe slugging can be assessed from the fol￾lowing equation:
𝜔slug ≈ Lslug
j (6.107)
It is important to highlight that the analysis of severe slugging is
related to the maximum length of liquid slugs in the flowline upstream
of the riser, which has been amply researched for horizontal flow. Slug￾ging phenomenon in flowlines is implicit in the derivation of the severe
slugging group previously addressed. Brill et al. (1981) conducted a pio￾neering field-level (12 inch and 16 inch in size) two-phase flow study
in 3-mile-long pipelines, finding that the steady-state liquid slug lengths
follow a log-normal distribution. These field tests performed at Prudhoe
Bay, Alaska, had slug lengths in the range of 80–800 internal diameters,
as measured with gamma densitometers. Scott et al. (1987) developed a
model that predicted well the Prudhoe Bay slug length data. Scott et al.
(1989) presented a correlation for the slug length as a function of flowline’s
internal diameter (equation (6.108)). Barnea and Taitel (1993) reported
laboratory-scale air/water experiments performed by other researchers,
determining that Lslug/d is in the range 15–40 for horizontal pipes, and
Lslug/d is in the range 8–25 for vertical pipes.
Lslug ≃ exp{28.5[Ln(d)]0.1 − 25.4} d in inch and Lslug in feet (6.108)
Scott et al. (1989) equation (6.108) yields values of Lslug/d in the range
280–330 for typical size flowlines in the range 8 inch to 24 inch.
Recently, Al-Safran et al. (2005) published a mechanistic model to esti￾mate the slug length in horizontal pipelines based on probabilistic analyses.
In conclusion, there is significant spread regarding the various ranges of
Lslug/d observed at laboratory and field scales. Thus, it is important to realize
that the severe slugging group IISS was inspired by the works of Schmidt et al.
(1980) and Schmidt et al. (1985).❦
❦ ❦
❦
References 151
6.10 Gas Lift
A common production technique for ailing oil wells with high water cuts
is the injection of compressed gas. Conceptually, the hydrodynamic phe￾nomena taking place within the tubing are no different than the subject
addressed in this chapter, and therefore can also be described by the methods
listed.
Gas lift refers to a technique, Hernandez (2016) and Guo et al. (2017),
aimed to reduce the back pressure on the reservoir by lowering the aver￾age density of the produced liquids inside the tubing string. Gas lift (G/L)
facilities at the surface treat (dehydrate the gas) and compress the gas to be
injected at spaced intervals of the production string. Dehydrated natural gas
is necessary to avoid tubing plugging by hydrate formation at the G/L valves.
The gas injected is pumped through the annular space of the well tubing
at some pre-determined locations, where pre-installed mandrels will serve
to fit gas lift valves. The mandrels are deployed during well completion onto
the tubing string.
There are several types of G/L valves for conventional gas lift sys￾tems, either continuous or intermittent flow conditions service. The
most common valves are injection-pressure-operated (IPO), production￾pressure-operated (PPO), pilot-operated gas, and single-point injection
orifice valves. Typically, pressure-operated valves open by differential
pressure due to the higher gas pressure in the well annulus from the
compressed gas at the surface.
Gas lift, aside from its typical application to oil wells, it is frequently
applied to deliquefy gas wells when water coning sets in becoming a
"liquid-loading" issue.
An additional application for gas lift is to inject gas at the base of a long
riser to minimize severe slugging originating from terrain conditions. The
objective of this technique is to reduce the liquid accumulations at the base
of the riser and the slug sizes traveling up the riser. This practice helps avoid
separator flooding at the first stage on the topsides.
References
Al-Safran, E., Sarica, C., Zhang, H., and Brill, J. (2005). Probabilistic/
Mechanistic Modeling of Slug-length Distribution in a Horizontal Pipeline,
160–172. SPE Production and Facilities.
Al-Safran, E. and Brill, J. (2017). Applied Multiphase Flow in Pipes and Flow
Assurance. Dallas, TX, USA: SPE.❦
❦ ❦
❦
152 6 Two-Phase Flow in Wells
Ansari, A., Sylvester, N., and Sarica, C. (1994). A Comprehensive Mechanistic
Model for Upward Two-Phase Flow in Wellbores. SPE Prod. Eng. 9: 143–152.
Arnold, K. and Stewart, M. (2008). Surface Production Operations – Design of
Oil Handling Systems and Facilities, 3e. Burlington, MA, USA: Gulf
Professional Publishing.
Barnea, D. (1986). Transition from Annular Flow and From Dispersed-Bubble
Flow-Unified Models for the Whole Range of Pipe Inclination. Int. J.
Multiphase Flow 12: 733.
Barnea, D. (1987). A Unified Model for Predicting Flow Pattern Transitions for
the Whole Range of Pipe Inclinations. Int. J. Multiphase Flow 13: 1.
Barnea, D. and Taitel, Y. (1993). A Model for Slug Length Distribution in
Gas-Liquid Slug Flow. Int. J. Multiphase Flow 19 (5): 829–838.
Beggs, H. and Brill, J. (1973). A Study of Two-Phase Flow in Inclined Pipes.
J. Pet. Technol. 255: 607.
Bøe, A., “Severe Slugging Characteristics – Part 1 and 2”, Selected Topics in
Two-Phase Flow, Trondheim, Norway (1981).
Brill, J., Schmidt, Z., Coberly, W. et al. (1981). Analysis of Two-Phase Tests in
Large-Diameter Flow Lines in Prudhoe Bay field. Soc. Pet. Eng. J. 21: 363–378.
Brill, J. and Mukherjee, H. (1999). Multiphase Flow in Wells, vol. Vol. 17. Dallas,
TX, USA: SPE, Monograph.
Brill, J., “Multiphase Flow Technology – Past, Present and Future”, PIPESIM
User Group Meeting, Houston, Texas, USA (2012).
Dukler, A. and Taitel, Y. (1982). Lecture Notes of the Two-Phase Gas-Liquid Flow
course. University of Houston, Chemical Engineering Department.
Cai, J., Wang, H., Hong, T., and Jepson, W., “Slug frequency and length in
inclined large diameter multiphase pipeline.” Multiphase Flow and Heat
Transfer Proceedings of the Fourth International Symposium, pp. 195–202,
Xi’an, China (August) (1999).
Craft, B.C. and Hawkins, M. (2015). Applied Petroleum Reservoir Engineering.
New Jersey: Pearson Education Inc.
Duns, H., and Ros, N., “Vertical Flow of Gas and Liquid Mixtures in Wells,”
Proceedings Sixth World Petroleum Congress, p. 451, Tokio, (1963).
Economides, M.J., Hill, A.D., Ehlig-Economides, C., and Zhu, D. (2013).
Petroleum Production Systems, 2e. Hoboken, NJ, USA: Pearson Education
Inc.
Fabre, J., Peresson, L., Corteville, J. et al. (1990). Severe Slugging in
Pipeline/Riser Systems. SPE Prod. Eng. 5: 299–305.
Felizola, H. and Shoham, O. (1995). A Unified Model for Slug Flow in
Directional Wells. ASME J. Energy Res. Technol. 117: 7.❦
❦ ❦
❦
References 153
Gomez, L., Shoham, O., Schmidt, Z. et al. (2000a). Unified Mechanistic Model
for Steady-State Two-Phase Flow: Horizontal to Vertical Upward Flow.
SPE J. 5 (3): 339–350.
Gomez, L., Shoham, O., and Taitel, Y. (2000b). Prediction of Slug Liquid
Holdup-Horizontal to Upward Vertical Flow. Int. J. Multiphase Flow 26 (3):
517.
Gray, H. (1978). User’s Manual for API 14B, SSCSV Sizing Computer Program,
2e, 38–41. API, Appendix B.
Griffith, P. (1978). Class Notes Subject 2.57J/22.36J, “Two-phase Flow and Boling
and Heat Transfer”. Cambridge, Massachusetts: MIT.
Griffith, P. and Wallis, G. (1961). Two-phase slug flow. J. Heat Transfer Trans.
ASME, Ser. C 83: 307–320.
Guo, B., Liu, X., and Tan, X. (2017). Petroleum Production Engineering, 2e.
Cambridge, Massachusetts, USA: Gulf Professional Publishing.
Hagedorn, A. and Brown, K. (1965). Experimental Study of Pressure Gradients
Occurring During Continuous Two-Phase Flow in Small-Diameter Vertical
Conduits. J. Pet. Technol. 234: 475.
Hasan, A. and Kabir, C. (2002). Fluid Flow and Heat Transfer in Wellbores.
Dallas, TX, USA: SPE.
Hernandez, A. (2016). Fundamentals of Gas Lift Engineering. Cambridge,
Massachusetts, USA: Gulf Professional Publishing.
Orkiszewski, J. (1967). Predicting Two-Phase Pressure Drops in Vertical Pipes.
J. Pet. Technol. 240: 829.
Poettmann, F. and Carpenter, P. (1952). The Multiphase Flow of Gas, Oil and
Water through Vertical Flow Strings with Application to the Design and
Gas-Lift Installations, 257. American Petroleum Institute, Drilling and
Production Practice.
Pots, B., Bromlow, I., and Konijn, M. (1987). Severe Slug Flow in Offshore
Flowline/Riser System. SPE Prod. Eng. 2: 319–324.
Rui, S., Zhang, H., Xu, H. et al. (2023). Seabed Structures and Foundations
Related to Deep-Sea Resource Development: A Review Based on Design and
Research. Deep Underground Sci. Eng. DOI 10.1002/dug2.12042.
Sarica, C. and Shoham, O. (1991). A Simplified Transient Model for
Pipeline-Riser Systems. Chem. Eng. Sci. 46: 2167–2179.
Schmidt, Z., Brill, J., and Beggs, H. (1980). Experimental Study of Severe
Slugging in a Two-Phase-Flow Pipeline-Riser Pipe System. SPE J. 20:
407–414.
Schmidt, Z., Doty, D., and Dutta-Roy, K. (1985). Severe Slugging in Offshore
Pipeline-Riser Pipe Systems. SPE J. 25: 27–38.❦
❦ ❦
❦
154 6 Two-Phase Flow in Wells
Scott, S., Shoham, O., and Brill, J., “Modeling Slug Growth inn Large Diameter
Pipes,” 3rd International Conference on Multiphase Flow, The Hague,
Netherlands pp. 55-63 (1987).
Scott, S., Shoham, O., and Brill, J. (1989). Prediction of Slug Length in
Horizontal, Large-Diameter Pipes. SPE Prod. Eng. 4: 335–340.
Shoham, O. (2006). Mechanistic Modeling of Gas-Liquid Two-Phase Flow in
Pipes. Dallas, TX, USA: SPE.
Taitel, Y., Barnea, D., and Dukler, A. (1980). Modelling Flow Pattern
Transitions for Steady Upward Gas-Liquid Flow in Vertical Tubes. AICHE J.
26: 345.
Taitel, Y. (1986). Stability of Severe Slugging. Int. J. Multiphase Flow 12:
203–217.
Taitel, Y., Vierkandt, S., Shoham, O., and Brill, J. (1990). Severe Slugging in a
Riser System: Experiments and Modeling. Int. J. Multiphase Flow 16: 57–68.
Wallis, G. (1969). One-Dimensional Two-Phase Flow. New York, USA:
McGraw-Hill Book Company.
Zhang, H., Wang, Q., Sarica, C. et al. (2003a). A Unified Mechanistic Model for
Slug Liquid Holdup and Transition Between Slug and Dispersed Bubble
Flows. Int. J. Multiphase Flow 29: 97–107.
Zhang, H., Wang, Q., Sarica, C. et al. (2003b). Unified Model for Gas-Liquid
Pipe Flow via Slug Dynamics. ASME J. Energy Res. Technol. 125: 266–283.
350 (2000).❦
❦ ❦
❦
155
7
Two-Phase Flow Through Restrictions and Piping
Components
7.1 Introduction
Section 7.2 covers the main flow restrictions found in the hydrocarbon
production systems. Section 7.3 covers the important subject of critical flow,
also known as choked flow. The following sections cover specific types of
fittings found in production systems.
Most of the information presented in this chapter originated from studies
performed for the nuclear industry, in pursuit of mitigating safety concerns
before potential catastrophic scenarios such as loss-of-coolant accidents
(LOCA). The majority of the models and conclusions drawn for such
scenarios do apply to hydrocarbon two-phase flow in pipelines, despite the
fact that the technical results were developed for steam–water mixtures.
7.2 Flow Through Restrictions
Generally speaking, there are two groups of fittings regarding the relevance
of the associated pressure drop. One group comprises elements that modify
the system’s deliverability. In this group, we find
● Wellhead choke
● Delivery-point choke
● Flow orifice for system blowdown/depressurization
● Control flow valves
The second group includes flow elements that either ensure the safe oper￾ation of the production system or are key components of the gathering sys￾tem architecture. In general, such elements cause a local pressure drop that
is orders of magnitude smaller than the pressure difference between the
Multiphase Transport of Hydrocarbons in Pipes, First Edition.
Juan J. Manzano-Ruiz and Jose G. Carballo.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
Companion Website: www.wiley.com/go/Manzano-Ruiz/Multiphasetransport❦
❦ ❦
❦
156 7 Two-Phase Flow Through Restrictions and Piping Components
flowing wellhead pressure and the arrival pressure at the delivery point. This
second group includes elements such as,
● Isolation valves operating fully open
● Pressure safety valves (PSVs)
● Check or non-return valves
● Chemical injection metering valves (CIMVs)
● Reducers and expanders
● Elbows
● Splitting-tee junction
● Manifolds and headers with valves fully open
● Combining-tee junction
In this chapter, we review the two-phase flow characteristics across fittings
with more emphasis on the first group. The second group of fittings causes
negligible effects on the production system deliverability and some impact
the two-phase flow at the production processing facilities.
The most comprehensive coverage of the fundamentals of two-phase
flow-through restrictions can be found in Delhaye (1981).
7.3 Critical Flow
The critical flow phenomenon takes place when the flow rate cannot be
increased despite changes in operating conditions downstream from a
constriction or throttle section. This is a thermodynamic effect related to
the transmission velocity of small-magnitude waves (i.e. fluid compress￾ibility), also referred to as the speed of sound in the medium. Perturbations
occurring downstream from the throttle cannot travel upstream because
the local wave velocity cannot be exceeded. In this situation, the flow is
tagged as critical or choked (Hsu and Graham, 1976).
Critical flow is an important subject for two-phase flow because some fit￾tings such as choke valves and orifices operate under this condition when
the downstream-to-upstream pressure ratio adopts some minimum value.
In a way, we should look at choked flow as a means to control flow rate,
although it can operate either at critical conditions or at subcritical con￾ditions. Moreover, there are other two-phase flow scenarios where choked
flow may occur, for instance, during voluntary system blowdown or during
a loss-of-containment accident after a piping rupture.
The fundamentals of critical flow for single-phase fluid are very well
understood and covered in classical references such as Shapiro (1953)
and Liepmann and Roshko (1957). The key parameter for the theory of
compressible fluid flow is the speed of sound. The estimation of the speed of
sound for many single-phase substances can nowadays be easily computed❦
❦ ❦
❦
7.3 Critical Flow 157
by equations of state with great confidence. Unfortunately, this is not the
case for two-phase critical flow where there is ample debate on how to
define speed of sound in two compressible media interwoven in complex
flow patterns upstream of the constriction.
The intricacy of two-phase critical flow has driven the proposal of several
approximate models, namely isenthalpic, isothermal, isentropic, polytropic,
and frozen-flow, Levy (1999). Also, models with/without interphase slip
or with/without thermal equilibrium have been suggested. The common
ground among all these models is the reference state defined as the
stagnation state, symbolized by the subindex “stag,” applied to properties
such as pressure, temperature, and density. The term stagnation refers to
the fluid(s) brought to rest.
There are two categories of models, either homogeneous or nonhomo￾geneous flow. The homogeneous model (Griffith, 1978) is the simplest
and most straightforward model, supported by the fact that under large
acceleration pressure gradients, the flow pattern has a large probability
of being dispersed flow. The assumptions for homogeneous flow have
been addressed in Section 5.9. For instance, to develop an equation for
the maximum (choked) flow with the HEM, the density is expressed by
equation (5.40), the dynamic viscosity is given by equation (5.46) and the
friction factor is obtained from equation (5.46). Equivalent expressions can
be drawn for the homogeneous mixture enthalpy and entropy based on the
mass quality x:
hH = hL(1 − x) + hGx (7.1)
sH = sL(1 − x) + sGx (7.2)
Starting with the HEM momentum equation (5.43), and assuming isen￾tropic flow, the speed of sound (Wallis, 1969) for the homogeneous mixture
can be expressed in terms of the single-phase speed of sound for gas and
liquid, cL and cG,
cmix
cL
= 1
√
1 − 𝛼
(
1 − 𝜌G
𝜌L
)
√{
1 − 𝛼
[
1 −
( 𝜌L
𝜌G
) ( cL
cG
)2
]}
(7.3)
The assumption of constant entropy is an adequate approximation for
those fittings which, due to their reduced size, sustain negligible heat losses
(adiabatic flow) and friction. The major change in pressure drop in a fit￾ting is usually the acceleration term that dominates over friction and gravity
terms. Thus, the isentropic assumption is compatible with the low relevance
of friction and heat transfer in fittings.❦
❦ ❦
❦
158 7 Two-Phase Flow Through Restrictions and Piping Components
The speed of sound for the liquid phase cL can be computed with the fol￾lowing expression (Riazi, 2005):
cL ≡
√√√√−
( v2
L
MWL
) ( 𝜕p
𝜕vL
)
s
=
√
𝛾L
( 𝜕p
𝜕𝜌L
)
T
(7.4)
where 𝜐L is the molar volume, and 𝜌L is the mass density. The derivative
term should be evaluated with an equation of state. As a reference, typical
values of sonic speed for live oil vary in the range of 940–990 m/s at the tem￾perature of 60 ∘C within the pressure range of 1–10 bara. The speed of sound
for the gas phase follows from
cG =
√
ZRT𝛾G (7.5)
The homogeneous isentropic model can be further developed into
“frozen” and “equilibrium” models Whalley (1987). The frozen model
assumes that the mass quality remains constant across the fitting, implying
that there is no change of phase during this process. In other words, the
very brief residence time of the flow within the fitting, compared to the ther￾modynamic relaxation time of phase change, justifies the assumption of
nonequilibrium and constant mass quality. The equilibrium model, on the
contrary, assumes thermal equilibrium during the flow process with phase
and mass quality changes. Whalley (1987) indicates that the frozen model
provides the best estimates for the critical mass flux Gcrit, whereas the
equilibrium model gives the best results for the critical pressure ratio.
The frozen model critical mass flux is given by the following expression:
Gcrit =
√√√√√√√√
[ 2𝜉x1pO
𝜌G,O(𝜉+1)
]
[
1−x1
𝜌L,O
+ x1
𝜌G,O
( 2
𝜉+1
) 1
1−𝜉
]2 (7.6)
The mass quality x1 is the value upstream of the fitting where critical
flow occurs, and the stagnation properties should be evaluated with an EOS
to obtain the parameters through an isentropic path to where the fluid is
stagnant. The isentropic expansion index 𝜉 for the mixture should also be
evaluated with EOS calculations at the upstream conditions.
The critical pressure ratio for the frozen model is given by the following
expression which is equivalent to the single-phase ideal gas case. However,
the difference lies in the usage of an isentropic expansion index 𝛾 for the
ideal-gas mixture case instead of the ξ index.
pcrit
pO
=
( 2
𝜉 + 1
) 𝜉
𝜉−1
(7.7)❦
❦ ❦
❦
7.4 Choke Valves 159
The homogeneous equilibrium model can be used to estimate the critical
mass flux Gcrit using the following equation (Levy, 1999):
Gcrit =
√
2[hstag − (1 − x)hL(pcrit) − xhG(pcrit)]
( 1−x
𝜌L(pcrit) + x
𝜌G(pcrit)
) (7.8)
In contrast to the frozen model, the equilibrium model requires an itera￾tive solution. The critical pressure at the constriction area must be guessed
to evaluate the enthalpies, the fluid densities, and the mass quality from
x = sstag − sL(pcrit)
sG(pcrit) − sL(pcrit) (7.9)
The iterative process proceeds with several assumed values of critical pres￾sure until determining the maximum value for the critical mass flux Gcrit
from equation (7.8). This way the critical pressure ratio is obtained too.
7.4 Choke Valves
The choke valve is a key component of every production system. These
valves may be placed downstream of the well’s tree or at the topsides or
process plant downstream of the gathering system.
The choke valves carry several duties, namely
● Gradual start-up of production wells to achieve soft reservoir drawdown
while protecting tree valves,
● Gradual shut-in of production wells prior to master and wing valves shut￾down,
● Setting the well production rate,
● Pressure maintenance (balancing well clusters) and flow control at man￾ifolds,
● Sustain erosion and corrosion damage from powerful wells,
● Maintain the desired backpressure upon the production system at the
arrival point,
● Separator pressure letdown,
● Heater bypass to control gas pressure,
● Backpressure control on well annulus during drilling and cleanup,
● Water injection flow rate control,
● CO2 well injection flow control for EOR programs,
● Pressure or flow control for gas lift feed to wells,
● Control blowdown rate delivered to flare/vent.❦
❦ ❦
❦
160 7 Two-Phase Flow Through Restrictions and Piping Components
A choke valve may be intended to limit, but not modulate, the flow rate
through it. This type of choke is referred to as a valve with positive or fixed
bean, usually made out of material to withstand high-velocity erosion.
A typical body material is AISI 410 stainless steel, lined with tungsten
carbide or ceramic to protect it from corrosive and abrasive wear. The fixed
choke bean has typical bean size increments of 0.40–1.60 mm (1/64- or
1/16-inch) screwed to the choke box. A choke bean can be as large as 76 mm
(192/64 inches).
Flow modulation can be performed with different choke valve types such
as plug and cage, multistage trim, or external sleeve.
The flow-regulating choke valves are tested by the manufacturer, and
the choke flow capacity coefficient CV (customarily in FPS units, gallons per
minute of water at 16∘C, for a pressure drop of 1 psi across the valve) is
reported to verify the selection adequacy for the expected range of flow rates
during production. Figure 7.1 shows a typical shape of the flow coefficient
as a function of the opening fraction, usually expressed in 1/64-inch
(0.397 mm) intervals.
To determine the flow rate through a choke we have to distinguish
between single-phase or two-phase flow. Also, we need to verify whether
the choke would be under subcritical or critical conditions.
0
0
5
10
15
20
25
30
40
35
CV
20 40 60 80 100 120
Position (1/64 ‒ inch)
140 160 180
Figure 7.1 Cv coefficient as a function of stem position.❦
❦ ❦
❦
7.4 Choke Valves 161
The fundamentals of control valve flow rates apply to choke flow as well
with the appropriate empirically determined flow coefficient. The fun￾damentals for single-phase flow-through valves have been condensed in
the standard ANSI/ISA-75.01.01 (2012). The concepts addressed by this
standard rigorously apply to turbulent, single-phase single-component
fluid. For hydrocarbon multicomponent mixtures, the models from
ANSI/ISA-75.01.01 (2012) are still a particularly good approximation, if
the mixture is homogeneous, in single-phase state, and in thermodynamic
equilibrium.
The first step for single-phase choke valve calculation is to ascertain the
type of flow, subcritical, or critical (choked flow). ANSI/ISA-75.01.01 (2012)
recommends estimating the pressure-drop ratio, the ratio of specific heat fac￾tors, and the liquid pressure-recovery factor using the following equations:
x =
(
1 − p2
p1
)
(7.10)
F𝛾 =
( 𝜉
1.4)
(7.11)
FF = 0.96 − 0.28√pvap
pcrit
(7.12)
F𝛾 is a factor that compensates for the way valves are tested with air
(IEC60534-2-3, 2015), and the results can be extrapolated to other fluids
with equation (7.12).
The pressure-drop ratio factor at choked flow condition, xT, is measured
and supplied by the choke manufacturer. An approximate correlation of
representative xT values for different choke sizes (Emerson-Fisher, 2019) is
equation (7.13):
xT = 0.657 + 0.0134dch.,nom. (7.13)
Likewise, the FL factor is also supplied by the valve manufacturer. A cor￾relation of representative values for different choke sizes (Emerson-Fisher,
2019) is
FL = 0.872
d0.05
ch.,nom.
(7.14)
Based on ANSI/ISA-75.01.01 (2012), the criterion to identify subcritical
flow becomes
p2 − p1
F2
L[p1 − FFpvap]
< 1 (7.15)❦
❦ ❦
❦
162 7 Two-Phase Flow Through Restrictions and Piping Components
For single-phase undersaturated oil flow, the approximate volumetric flow
rate for subcritical conditions is ANSI/ISA-75.01.01 (2012),
QL = 0.865CV
√p1 − p2
SL
(7.16)
For single-phase undersaturated oil flow, the approximate volumetric flow
rate for critical conditions (ANSI/ISA-75.01.01, 2012) is given by the follow￾ing equation, although it is unlikely that the flow becomes critical due to the
exceedingly high speed of sound in the liquid state:
QL = 0.865CV
√
F2
L[p1 − FFpvap]
SL
(7.17)
The units for the terms in equations (7.15) and (7.16) are pressure [bar
absolute], CV [US GPM], SL is the dimensionless specific gravity of the oil,
dch.,nom. is the nominal size of the choke unit [inches], and the oil flow rate
QL (m3/s). An EOS is needed to estimate the oil critical pressure Pcrit and the
bubble point Pb on an isentropic path from the upstream condition p1 and
T1 to the choked pressure p2.
For gas flows in chokes, there is another criterion quite common to iden￾tify critical flow in chokes. This second criterion derives from the isentropic
flow assumption for ideal gases:
p2,crit
p1
=
( 2
𝜉 + 1
) 𝜉
𝜉−1
(7.18)
where
𝜉 ≡ cp
cv
(7.19)
The heat capacity ratio 𝜉 for gas hydrocarbons normally lies in the range
1.25–1.32, indicating that the critical pressure ratio for gases is of the order
of 0.54–0.56. In other words, critical flow in gases takes place when the
choke discharge pressure is about half the inlet pressure. For compressible
gas single-phase flow, the subcritical flow rate equation is
QG = 2, 250CV p1
[
1 − x
2.143𝜉xT
]√ x
T1Z1MW (7.20)
and the critical flow rate equation is
QG = 1, 268CV p1
√
𝜉xT
T1Z1MW (7.21)
The gas flow rate in the last two equations is expressed in (sm3/min). SG is
the nondimensional specific gravity of the gas, and Y is the expansion factor
which has a limit value of 2/3 for choked flow (ANSI/ISA-75.01.01, 2012).❦
❦ ❦
❦
7.4 Choke Valves 163
Single-phase flow fundamentals are very well supported by accurate
experimental work, and the theory behind it has been compiled in stan￾dards. Unfortunately, this is not the case for two-phase flow choke flow.
Modeling two-phase choke flow is much more challenging and empirical,
fully dependent on data supplied by the manufacturers.
There are several models available for two-phase choke flow and in
this section, we cover the highlights of the pioneering homogeneous
model by Ashford and Pierce (1975) and a more recent comprehensive
non-homogeneous model by Al-safran and Kelkar (2007).
Ashford and Pearce (1975) published a criterion to identify critical flow.
This criterion requires trial-and-error to solve the implicit equation (7.22)
for the critical pressure ratio yc,
(2R
𝜉
) [( R𝜉
𝜉−1
){
1 − y
( 𝜉−1
𝜉
)
c
}
+ 1 − yc
]
[
1 + R
y
( 1
𝜉 ) c
]
y
( 𝜉+1
𝜉
)
c
= 1 (7.22)
yc = p2,crit
p1
(7.23)
R = jG
jL
(7.24)
Al-safran and Kelkar (2007) also proposed another criterion to detect crit￾ical flow, requiring the calculation of the polytropic index n, the slip-factor
S, the parameter 𝜂, and the iterative solution of the following implicit
equation in yc:
n = x𝜉cV,G + (1 − x)cL
xcV,G + (1 − x)cL
(7.25)
S = (1 + 0.6e−5x
)
√
1 + x
( 𝜌L
𝜌G
− 1
)
(7.26)
𝜂 ≡ S(1 − x)𝜌G
x𝜌L
(7.27)
𝜂(1 − yc) + n
n−1
[
y
( n−1
n
)
c
] ⎡
⎢
⎢
⎣
( n
n−1
)
+
(n
2
) (
1 + 𝜂y
( 1
n
)
c
)2⎤
⎥
⎥
⎦
= 1 (7.28)
Generally, the estimation of the critical pressure ratio by equations (7.22)
and (7.28) yields similar results within the accuracy of both models.
Additionally, Al-safran and Kelkar (2007) included equations to estimate
the mass flow rate of two-phase flow-through subcritical and critical chokes.❦
❦ ❦
❦
164 7 Two-Phase Flow Through Restrictions and Piping Components
Forsubcritical chokes, Al-safran and Kelkar (2007) recommend the following
set of equations:
S =
( 𝜌L
𝜌G
)0.17
(7.29)
𝜂 ≡ S(1 − x)𝜌G
x𝜌L
(7.30)
y = p2
p1
(7.31)
ṁ =
√√√√√√√√√
0.75A2
chokep1
{
𝜂(1 − y) + n
n−1
[
1 − y
( n−1
n
)]}
x1
𝜌G,1
[
𝜂 + 1
y( 1
n )
]2 [
x1 + 1−x1
S
]
(7.32)
And for critical chokes Al-safran and Kelkar (2007) recommend this other
set of equations:
S = (1 + 0.6e−5x
)
√
1 + x
( 𝜌L
𝜌G
− 1
)
(7.33)
yc = p2,crit
p1
(7.34)
ṁ =
√√√√√√√√√√√
0.75A2
chokep1
{
𝜂(1 − yc) + n
n−1
[
1 − y
( n−1
n
)
c
]}
x1
𝜌G,1
[
𝜂 + 1
y
( 1
n ) c
]2 [
x1 + 1−x1
S
]
(7.35)
From the previous equations it is evident that two-phase critical flow
through a production choke is more difficult to estimate than single-phase
critical flow.
A comprehensive review of choke flow can be found in Haug (2012) thesis.
7.5 Sudden Pipe Enlargement
A sudden expansion in pipe diameter, although it is not common in hydro￾carbon production systems, slows down the fluids’ velocity and augments
the local pressure. Figure 7.2 shows a sketch of a pipe expansion.❦
❦ ❦
❦
7.6 Sudden Pipe Contraction 165
V1 p1A1 p2A2 V2
1
2
Figure 7.2 Sudden pipe expansion.
The sudden expansion creates a recirculation zone where turbulent
eddies dissipate mechanical energy. Thus, the increment in pressure
associated with the momentum change is diminished by local losses due to
turbulence.
The pressure increment across an abrupt diameter enlargement in the
system can be estimated using Chisholm (1986) model:
p2 − p1
G2
1
𝜌L
≅
(d1
d2
)2 [
1 −
(d1
d2
)2
]
(1 − x)
2
[
1 +
C
𝜒
+
1
𝜒2
]
(7.36)
where 𝜒 is the parameter calculated (Collier and Thome, 1994) with
equation (7.37):
𝜒 =
(1 − x
x
) (𝜌G
𝜌L
)0.5
(7.37)
and the constant “C” can be estimated (Collier and Thome, 1994) from
C =
{
1 +
[(𝜌G
𝜌L
)0.167
− 1
]√ 𝜌G
𝜌L − 𝜌G
}[√𝜌G
𝜌L
+
√𝜌L
𝜌G
]
(7.38)
Additional coverage about flow-through pipe enlargement can be found
in Salcudean (1986).
7.6 Sudden Pipe Contraction
A sudden contraction in pipe diameter accelerates the fluids’ velocity and
reduces the local pressure. Figure 7.3 shows an outline of a pipe contraction.❦
❦ ❦
❦
166 7 Two-Phase Flow Through Restrictions and Piping Components
V1 p1A1 p2A2 V2
1
2
Figure 7.3 Sudden pipe contraction.
The pressure drop across an abrupt diameter reduction in the production
system can be computed with equation (7.39), (Collier and Thome, 1994)
and (Lahey and Moody, 1993):
p1 − p2
G2
2
𝜌L
≅
1
2
(d1
d2
)2 [
1 +
( 1
CC
− 1
)2
−
(d2
d1
)2
] [
1 + x
( 𝜌L
𝜌L − 𝜌G
)]
(7.39)
and the constriction coefficientCC can be approximated (Collier and Thome,
1994) by
CC ≅ 0.573(d2
d1
)8
− 0.588(d2
d1
)6
+ 0.447(d2
d1
)4
− 0.018(d2
d1
)2
+ 0.586 (7.40)
Further material on pipe contraction flow can be found in Salcudean
(1986).
7.7 Flow Orifice
An orifice plate is a fitting commonly used to fix the flow rate of the pro￾duction stream. Thus, it is quite normal that the flow will be choked at this
fitting. The choked flow estimation is based on the methodology addressed
in Section 7.3.
Fluid flows through an orifice of area Ao undergo a deformation of the
streamlines forming a neck (i.e. “vena contracta”) downstream of the plate,❦
❦ ❦
❦
7.8 Gate and Globe Valves 167
usually about one orifice’s radius from the plate. The cross-section of the
vena contracta is labeled Ac, and the ratio Ac/Ao is slightly less than 1.
To estimate the pressure drop across an orifice plate in two-phase flow, first
evaluate the parameters 𝜁 and 𝜅 with the equations (7.41), (7.42), and (7.43):
𝜁 =
(1 − x
x
) (𝜌G
𝜌L
)0.5
(7.41)
For 𝜁 ≥ 1 𝜅 =
√
1 + x
( 𝜌L
𝜌L − 𝜌G
)
(7.42)
For 𝜁 < 1 𝜅 =
( 𝜌L
𝜌G
)0.25
(7.43)
Next evaluate the constant C from (7.44) at the vena contracta flow area,
C = 𝜅
√𝜌G
𝜌L
+
1
𝜅
√𝜌L
𝜌G
(7.44)
Ac = CDAc (7.45)
The discharge coefficient CD can be estimated from Appendix A, page
A-20 of Crane Corp (1988), as a function of the Reynolds number and the
area ratio (orifice area to approach pipe area). For Reynolds’ number above
10,000, the discharge coefficient varies in the range 0.61–0.64 depending
on the area ratio. Finally, the pressure drop across the orifice follows from
equation (7.46):
p1 − p2 ≅
( 1
2𝜌L
) [1 +
C
𝜁 +
1
𝜁 2
] [G1(1 − x1)A1
Ac
]2
(7.46)
For further details of two-phase flow-through orifices, please refer to the
publication by Lin (1986).
7.8 Gate and Globe Valves
Gate valves are isolating fittings which have two operating positions: fully
open or shut off. For an open gate valve, the constant Cc in equation (7.39) is
gate valve Cc =
{
1 + 0.5√ 𝜌G
𝜌L − 𝜌G
} [√𝜌G
𝜌L
+
√𝜌L
𝜌G
]
(7.47)
Globe valves are used to control fluid flow rate and can operate between
fully open or partly shut off. For an open globe valve, the constant C in❦
❦ ❦
❦
168 7 Two-Phase Flow Through Restrictions and Piping Components
Chisholm’s equation (7.39) is
globe valve Cc =
{
1 + 1.3√ 𝜌G
𝜌L − 𝜌G
} [√𝜌G
𝜌L
+
√𝜌L
𝜌G
]
(7.48)
The two-phase flow pressure drop across open gate and globe valves can
then be estimated using equation (7.49):
p1 − p2 ≅
( 1
2𝜌L
) [1 +
Cc
𝜁 +
1
𝜁 2
] [G1(1 − x1)A1
Ac
]2
(7.49)
For a globe valve partly open, the pressure-drop calculation is similar to
the orifice plate procedure with the caveat that the discharge coefficient has
to be determined empirically or obtained from the valve manufacturer.
7.9 Elbows and Bends
The two-phase flow-through bends can be estimated with Chisholm’s
(1986) model and a correlation for the constant C. The constant equation
for bends is
C =
⎧
⎪
⎨
⎪
⎩
1 +
⎡
⎢
⎢
⎢
⎣
2.2
(
2 + R
d
)
kfo
⎤
⎥
⎥
⎥
⎦
√ 𝜌G
𝜌L − 𝜌G
⎫
⎪
⎬
⎪
⎭
[√𝜌G
𝜌L
+
√𝜌L
𝜌G
]
(7.50)
where the loss coefficient for bends is approximated by
kfo ≅ 0.675d−0.208
nom. (7.51)
The two-phase flow pressure drop across elbows can then be esti￾mated relative to the single-phase liquid flow with equation (7.52) and
equation (7.37).
(p1 − p2)Two−phase
(p1 − p2)SP,liquid
= 1 +
C
𝜒
+
1
𝜒2 (7.52)
7.10 Tee Junctions and Manifolds
Mixing and splitting tees are common elements of gathering systems. These
elements serve to commingle production or to divide the flow. Figure 7.4
shows a sketch of a mixing tee.
Applying a simple homogeneous model (Azzopardi, 1986) across the
boundary of the control volume of Figure 7.4, and setting up steady-state❦
❦ ❦
❦
7.10 Tee Junctions and Manifolds 169
p1,A1,m1,Q1,𝜌1,h1
∙
p3,A3,m3,Q3,𝜌3,h3
∙
p2,A2,(m1 + m3),Q2,𝜌2,h2
∙ ∙
Heat losses ≈ 0
Mixing tee
Control volume
Figure 7.4 Schematics of a mixing/joining adiabatic tee.
momentum balances (neglecting gravitational effects) yields
p1 − p2 = 1
2
(
𝜌2 j
2
2 − 𝜌1 j
2
1
)
+
1
2
𝜌2 j
2
2
[
0.045 + 1.38 (j3
j2
)] (7.53)
p3 − p2 = 1
2
(
𝜌2 j
2
2 − 𝜌3 j
2
3
)
+
1
2
𝜌2 j
2
2
[
1.09 − 0.53 (j1
j2
)] (7.54)
The last terms of equations (7.53) and (7.54) (Blevins, 1992), respec￾tively, represent the mechanical-energy losses of blending stream 1 with
stream 3. Therefore, the pressure drops from these equations account
for the necessary incremental static pressure upstream of the mixing tee.
Also, due to mass conservation, equation (7.55) holds for the two-phase
mixing junction tee, as long as the overall flow rate is high enough to be
approximated by a homogeneous model:
j2 =
(𝜌1
𝜌2
)
j1 +
(𝜌3
𝜌2
) (d3
d1
)2
j3 (7.55)
From a practical point of view, the mixture densities at the three
ports of the control volume may vary slightly, enabling to approximate
equation (7.55) by equation (7.56):
j2 = j1 + j3
(d3
d1
)2
(7.56)
Equations (7.53) to (7.56) can support the simulation of mixing tees on
flowlines (e.g. daisy-chain tie-ins) and trunklines, or for the simulation of a
manifold collecting the flow from several wells from a tie-back.❦
❦ ❦
❦
170 7 Two-Phase Flow Through Restrictions and Piping Components
p1,A1,m1,Q1,𝜌1,h1
∙
p3,A3,m3,Q3,𝜌3,h3
∙
p2,A2,(m1 ‒ m3),Q2,𝜌2,h2
∙ ∙
Heat losses ≈ 0
Splitting tee
Control volume
Figure 7.5 Splitting/dividing adiabatic tee.
Mixing tees in general may pose a simulation challenge regarding the
estimation of fluid properties downstream of the fitting. When streams 1
and 3 (Figure 7.4) have different compositions, it is necessary to perform
compositional analysis invoking phase equilibrium computations with an
equation of state. Not only a local thermodynamic analysis is required, but
mass balances (per species) and an energy balance across the tee depend
upon the flow rates of streams 1 and 3. In conclusion, the presence of
mixing tees in the production system becomes an expensive item in terms
of simulation computing time, due to the need of including compositional
tracking if a rigorous job is intended.
Splitting or dividing tees can be present when “system looping” is utilized
to reduce the system backpressure on the production sources. Figure 7.5
illustrates a splitting tee.
One of the research challenges in two-phase flow-through diving tees is
the resulting flow patterns at the exiting streams and the length of pipe nec￾essary to develop a stable regime downstream. For further details about flow
regimes, consult the reference by Azzopardi (1986).
The main characteristic of the splitting tee is that the fluid properties of
the inlet stream 1 are shared by the two exiting streams 2 and 3, eliminating
the need to run compositional analysis.
Similar models can be drawn for a splitting tee, invoking the homogeneous
flow model to represent high flow rate two-phase flows. These are
p1 − p2 = 1
2
(
𝜌2 j
2
2 − 𝜌1 j
2
1
)
+
1
2
𝜌1 j
2
1
[
1.55(
0.22 − j3
j1
)2
− 0.03]
if j3
j1
≤ 0.22 (7.57)❦
❦ ❦
❦
References 171
p1 − p2 = 1
2
(
𝜌2 j
2
2 − 𝜌1 j
2
1
)
+
1
2
𝜌1 j
2
1
[
0.65(
0.22 − j3
j1
)2
− 0.03]
if 0.22 <
j3
j1
≤ 1 (7.58)
p1 − p3 = 1
2
(
𝜌3 j
2
3 − 𝜌1 j
2
1
)
+
1
2
𝜌1 j
2
1
[
0.99 − 0.82 (j3
j1
)
+ 1.02(j3
j1
)2
]
(7.59)
j2 = j1 −
(d3
d1
)2
j3 (7.60)
References
ANSI/ISA-75.01.01-2012 (60534-2-1 MOD) Industrial – Process Control
Valves – Part 2-1 (2012).
Al-Safran, E. and Kelkar, M. (2007). Predictions of Two-phase Critical Flow
Boundary and Mass Flow Rate Across Chokes. Richardson, Texas, USA: SPE
Paper 109243.
Ashford, F. and Pierce, P. (1975). Determining Multiphase Pressure Drops and
Flow Capacities in Down-hole Safety Valves. Journal of Petroleum
Technology 27: 1145–1152.
Azzopardi, B. (1986). Two-phase Flows in Junctions,” Chapter 25. In:
Encyclopedia of Fluid Mechanics, Vol. 3, Gas-Liquid Flows. Houston, USA:
Gulf Publishing Company.
Blevins, R. (1992). Applied Fluid Dynamics Handbook. Malabar, Florida, USA:
Krieger Publishing Company.
Chisholm, D. (1986). Predicting Two-phase Flow Pressure Drop,” Chapter 19.
In: Encyclopedia of Fluid Mechanics, Vol. 3, Gas-Liquid Flows. Houston, USA:
Gulf Publishing Company.
Collier, J. and Thome, J. (1994). Convective Boiling and Condensation, 3e.
Oxford, U.K.: Oxford Science Publications.
Crane Corporation (1988). Flow of Fluids Through Valves, Fittings, And Pipe,
Technical Paper No. 410, The Woodlands, Texas, Crane Valves North
America.
Delhaye, J. (1981). Two-Phase Flow and Heat Transfer in the Power and Process
Industries,” Chapter 4 (ed. A. Bergles). New York, NY, USA: Hemisphere
Publishing Corporation.
Emerson-Fisher (2019). Control Valve Handbook, 5e. Iowa, USA:
Emerson-Fisher.
Griffith, P. (1978). Class notes Subject 2.57J/22.36J, “Two-phase Flow and Boling
and Heat Transfer”. Cambridge, Massachusetts: MIT.❦
❦ ❦
❦
172 7 Two-Phase Flow Through Restrictions and Piping Components
Haug, R. (2012). Multiphase Flow Through Chokes. NTNU – Norwegian
University of Science and Technology, Master Thesis.
Hsu, Y. and Graham, R. (1976). Transport Processes in Boiling and Two-Phase
Systems. Washington DC, USA: Hemisphere Publishing Corporation.
IEC60534-2-3, International Electrotechnical Commission, Industrial – Process
Control Valves – Part 2-3: Flow Capacity – Test procedures (2015).
Lahey, R. and Moody, F. (1993). The Thermal Hydraulics of a Boiling Water
Nuclear Reactor, 2e. The American Nuclear Society.
Levy, S. (1999). Two-Phase Flow in Complex Systems. New York, USA: John
Wiley & Sons Inc.
Liepmann, H. and Roshko, A. (1957). Elements of Gasdynamics. New York,
USA: John Wiley & Sons.
Lin, Z. (1986). Two-phase Flow Measurements with Orifices. In: Encyclopedia
of Fluid Mechanics, Vol. 3, Gas-Liquid Flows, Chapter 29. Houston, USA: Gulf
Publishing Company.
Riazi, M. (2005). Characterization and Properties of Petroleum Fractions. West
Conshohocken, PA, USA: ASTM International.
Salcudean, M. (1986). Effect of Flow Obstructions on Flow Transitions and
Pressure Drop in Two-phase Flows. In: Encyclopedia of Fluid Mechanics,
Vol. 3, Gas-Liquid Flows, Chapter 26. Houston, USA: Gulf Publishing
Company.
Shapiro, A. (1953). The Dynamics and Thermodynamics of Compressible Fluid
Flow, vol. Vol. 1. New York, USA: The Ronald Press Company.
Wallis, G. (1969). One-Dimensional Two-Phase Flow. New York, NY, USA:
McGraw-Hill Inc.
Whalley, P. (1987). Boiling Condensation and Gas-Liquid Flow. Oxford, UK:
Oxford University Press.❦
❦ ❦
❦
173
8
Two-Phase Flow Thermal Modelling
8.1 Introduction
Two types of operating regimes and environments ascertain the magnitude
of the heat losses. Section 8.2 addresses the differences between normal
(i.e. quasi-steady-state) and transient operation regimes of the production
system. On the other hand, Section 8.3 refers to an offshore versus onshore
environment to identify the major drivers of heat losses.
Heat transfer manifests through three basic mechanisms: conduction,
convection, and radiation. The impact of such mechanisms on the system
heat transfer is briefly reviewed in Section 8.4.
Section 8.5 sets at the heels of the previous section summarizing the
best-known convection correlations for internal fluid flow. This section
includes forced and natural convective correlations applicable to flowing
and shutdown conditions. Section 8.6 is concerned with heat transfer due to
external fluid flow over the production system, namely, forced convection
due to wind on onshore applications or sea currents in subsea environments.
Heat losses, being a significant risk for system production targets, can be
somehow mitigated with thermal insulation to reduce the losses to an accept￾able level. The latter always leads to the tradeoff between Capex (insulation
cost) and production performance. Section 8.7 addresses typical materials
and configurations of thermal insulation.
The overall heat transfer coefficient (OHTC) combines all the thermal
resistances separating the temperature gradient between the production
stream and the environment. Section 8.8 addresses the calculation of the
U-value factor and the OHTC.
Section 8.9 touches on the widespread practice of using the Earth’s low
thermal conductivity as an equivalent thermal insulation system for buried
pipelines. Again, this practice is a compromise between Capex (trenching
Multiphase Transport of Hydrocarbons in Pipes, First Edition.
Juan J. Manzano-Ruiz and Jose G. Carballo.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
Companion Website: www.wiley.com/go/Manzano-Ruiz/Multiphasetransport❦
❦ ❦
❦
174 8 Two-Phase Flow Thermal Modelling
cost) versus production performance (mitigation of phase change by
reducing losses).
At a high level, the objective of thermal modeling is to predict the
temperature profile along the whole production system, that is, from
the reservoir wellbore to the production facility. Section 8.10 covers the
additional equations needed to model the system’s thermal performance.
Sections 8.11 and 8.12 address two important operating scenarios where
thermal modeling determines performance. These scenarios are system
cooldown and wellbore heat transfer.
8.2 Normal and Transient Operation
Normal operation resembles a steady-state process but with some small fluc￾tuations due to perturbations affecting the system. For a production sys￾tem, normal operation takes place 80% or more of the uptime. Transient
operations last little compared to normal operations yet heat losses may be
important too.
The heat losses for normal operation determine the temperature profile
along the production system and are dependent upon the level of thermal
insulation (or trenching) the system has. Thermal performance during
transient operations is also modified by the effectiveness of the insulation,
but in general, the thermal capacitance effect of such insulation is not
crucial to prevent appreciable heat losses.
For normal operation, the thermal performance is driven by the OHTC
and the magnitude of the temperature gradient with respect to the environ￾ment. For transient operations, the key factor is the duration of the transient
with respect to a thermal energy storage characteristic time. The latter is
discussed later in Sections 8.11 and 8.12 via practical applications.
8.3 Offshore and Onshore Pipelines
Subsea flowlines and risers are exposed to a saline environment at constant
conditions of temperature and currents’ velocity. In a way, for modeling,
this environment is simpler due to the steadiness of the prevailing external
conditions.
For onshore pipelines, the environment may ever be changing. The
system may be exposed to night/day insolation (unless it is buried),❦
❦ ❦
❦
8.4 Heat Transfer Mechanisms 175
varying wind velocity, four seasons, rain, and snow. From the standpoint of
simulation, the selection of the worst environmental conditions is necessary
to simulate the system, in order to realize the most adverse scenario of
internal two-phase flow. For example, if the pipeline’s service is for heavy
crude and it is not trenched, the oil flow rate can have noticeable swings
between day and night, just because of the heat gain due to insolation. For
offshore flowlines the thermal gradients are in general steady but of larger
magnitude compared to the onshore flowlines.
8.4 Heat Transfer Mechanisms
There are three basic heat transfer mechanisms, namely
● Conduction. This is a molecular-level thermal energy transfer driven by
a temperature gradient. This mechanism is characterized by the thermal
conductivity property k, the temperature difference between the bodies
exchanging heat, and the heat transfer area perpendicular to the tempera￾ture gradient (Carslaw and Jaeger, 1959). The governing heat conduction
equation is designated as Fourier’s law (equation 8.1). This mechanism is
important for heat transfer through pipe walls and thermal insulation.
● Convection. This is a mechanism where appreciable volumes of fluid
in motion (at a scale much larger than molecular) transport thermal
energy driven by a temperature gradient. The convection mechanism can
be either forced or natural (i.e. free). In forced convection, an external
source drives and determines the fluid flow characteristics. The source
could be a wind stream, a sea current, a pump, or a gas compressor.
Natural convection fluid motion is driven by buoyancy forces generated
by temperature differences in the bulk of the fluid. Forced convection is
usually the dominant mechanism for heat transfer inside and outside the
pipeline. However, natural convection drives internally the fluid motion
for shutdown pipelines.
● Radiation. Thermal radiation affects onshore pipelines exposed to sun￾light, also creating heat exchanges with the surroundings via infrared radi￾ation. The heat transfer rates are driven by the difference in the fourth
power of the absolute temperatures of the thermal-exchanging bodies, and
proportional to the Boltzmann constant (Incropera et al., 2003). Usually,
the radiation mechanism is orders of magnitude lower than the convec￾tion mechanism and it is then disregarded.❦
❦ ❦
❦
176 8 Two-Phase Flow Thermal Modelling
8.5 Internal Heat Transfer Coefficients
There are many correlations developed to predict forced convection inside
the piping. Sections 8.5.1 through 8.5.7 list a few of the best-known
correlations for single- and multi-phase flow inside a pipeline when the
internal flow pattern may be considered well developed (e.g. far down￾stream from changes in direction or diameter). The heat transfer convective
coefficient is universally distinguished as the h-coefficient, or simply h.
The trend in the past has been to start with single-phase flow correlations
and apply them along the periphery of the internal area depending on
the fluid phase in contact with the pipe wall. This is the mechanistic
approach (Shoham, 2006) adopted in this book for evaluating the internal
heat transfer coefficient. In all cases, the assumption made herein is
that the ratio of pipe length to diameter is extremely large (L/d ≫ 1)
justifying the condition of fully developed flow, even in the two-phase flow
case.
At the initial stages of a project, there may not be enough information to
enable rigorous calculation of the heat transfer coefficient. Therefore, some
rule-of-thumb heat transfer coefficients suffice for a first-pass thermal anal￾ysis. Table 8.1 shows generic single-phase flow values of h coefficients that
are useful for quick estimates of heat transfer rates without the drawback of
complex correlations.
8.5.1 Turbulent Flow Forced-convection Inside Tubes
The classic and highly referred to Colburn (1933) correlation, equation (8.3),
is the best-known equation applicable to developed single-phase turbu￾lent flow. This correlation is expressed in terms of the non-dimensional
Table 8.1 Order-of-magnitude single-phase heat transfer coefficients,
Incropera et al. (2003).
Case h (W/m2 K)
Forced convection developed gas flow inside tubes 25–250
Forced convection developed oil flow inside tubes 100–20000
Natural convection of gas inside a tube 2–25
Natural convection of oil inside a tube 50–1000❦
❦ ❦
❦
8.5 Internal Heat Transfer Coefficients 177
numbers: Nusselt (Nu) – equation (8.1), Reynolds (Re), and Prandtl (Pr) –
equation (8.2):
Nu ≡ hi
d
kf
(8.1)
Pr ≡
(cp𝜇
k
)
f
(8.2)
Nu = 0.023Re0.8Pr 1∕3 (8.3)
It is important to highlight that this form of the Colburn correlation is
used for cooling flows inside the tubing.
8.5.2 Laminar Flow Forced convection Inside Tubes
Developed laminar flow within tubes takes place when the Reynolds
number is below 2000. For this case, the Sieder and Tate (1936) correlation,
equation (8.4), is useful to estimate the single-phase flow heat transfer
coefficient for very viscous fluids.
Nu = 1.86(
Re Pr d
L
)1∕3 (𝜇bulk
𝜇wall )
(8.4)
8.5.3 Two-phase Disperse bubble Flow in Horizontal Pipe
Two-phase flow internal heat transfer occurs in the turbulent regime.
For the case of dispersed bubble flow, Shoham (2006) proposes a pseudo￾homogeneous no-slip flow model based on the liquid holdup equation (8.5).
𝜆l ≡ jl
jg + jl
(8.5)
The Nusselt number for dispersed bubble flow adopts the following
expression (subscript “H” indicating homogeneous flow):
NuH = hi
d
kH
= 0.023Re0.8
H Pr 1∕3
H (8.6)
The fluid mixture properties necessary to evaluate the Prandtl number are
calculated with
cp,H ≡ cp,l
𝜌l
𝜆l + cp,g𝜌g(1 − 𝜆l
)
𝜌l
𝜆l + 𝜌g(1 − 𝜆l
) (8.7)
kH ≡ kl
𝜆l + kg(1 − 𝜆l
) (8.8)❦
❦ ❦
❦
178 8 Two-Phase Flow Thermal Modelling
8.5.4 Two-phase Stratified Flow in Horizontal Pipe
The phases’ spatial segregation enables a simple approach for this regime,
supported by single-phase correlations applied at their respective flow areas
and wet-wall surfaces. Either equation (8.3) or equation (8.4) can be utilized
substituting the corresponding diameter by the hydraulic diameter of the
phase, defined by equations (8.9) through (8.13),
PW,l = d(𝜋 − 𝜑∕2) (8.9)
PW,g = d𝜑
2 (8.10)
where the subtended angle 𝜑 is calculated from the implicit equation (8.11)
and the stratified-flow void fraction,
𝛼 = 𝜑 − sin 𝜑
2𝜋 (8.11)
and the hydraulic diameters are calculated from equations (8.12) and (8.13):
dh,l = 4Al
PW,l
= 𝜋d(1 − 𝛼)
(𝜋 − 𝜑∕2) (8.12)
dh,g = 4Ag
PW,g
= 2𝜋d𝛼
𝜑
(8.13)
8.5.5 Two-phase Slug flow in Horizontal Pipe
The estimation of the heat transfer coefficient for an intermittent flow
pattern is fairly challenging. An extensive experimental work performed
by Shoham (2006) for horizontal flow determined that the heat transfer
coefficients vary with the mass flow rate of liquid and gas and have the
following typical (Table 8.2) values on different zones of a slug unit.
The conclusion from Shoham’s (2006) experimental work is that heat
transfer coefficients in intermittent slug flow regimes are high enough
Table 8.2 Order of magnitude of heat transfer
coefficients in slug flow, Shoham (2006).
Slug location Coefficient (W/m2 C)
Top of nose 2900–35,000
Bottom of nose 17,000–34,000
Top of body 2900–20,000
Bottom of body 13,000–25,000
Trailing gas bubble 5000–38,000❦
❦ ❦
❦
8.5 Internal Heat Transfer Coefficients 179
to neglect the internal thermal resistance (addressed in Section 8.8) for
pipelines that are thermally insulated. At these conditions, the thermal
resistance offered by insulating coating is an order of magnitude higher or
more than the internal resistance.
8.5.6 Natural Convection in a Stagnant Fluid Within
a Horizontal Pipe
During an extended system shutdown, the production stream of oil and/or
gas may be trapped while exchanging heat with the surrounding environ￾ment. Internally in the pipeline, natural convective currents set in due to
buoyancy. The technical literature on natural convection inside horizontal
pipes is scarce.
One of the few experimental works on this topic, performed by Martini
and Churchill (1960), indicates that the overall internal heat transfer
coefficient is insensitive to the natural convection drive force represented
by the product of the Prandtl (Pr) and Grashof (Gr) numbers. Figure 14
of the Martini and Churchill (1960) reference points at a constant Nusselt
number of 7.0 for single-phase fluids. The constancy of the Nusselt number
indicates a limiting case of heat conduction mechanism for stable processes
(long-time approximation).
Detailed numerical simulations with finite differences were performed
by Hellums (1960) and by Stewart et al. (1974) for the transient natural
convection problem inside cylindrical cavities. Newer work performed by
Ludovisi and Garza (2013) utilizing CFD (computational fluid dynamics)
focused on the four transient stages of natural convection inside cylindrical
enclosures. Stage 1 mechanism is heat conduction with a fast drop in
Nusselt number. Stage 2 is a developing flow regime that lasts a little.
Stage 3 is a steady-state regime characterized by equation (8.14). Stage 4
is a long-term heat conduction regime. For the last stage, Ludovisi and
Garza (2013) found that the Nusselt number approaches the value of 5.8 for
single-phase fluids when the Rayleigh number (equation 8.15) is negligible,
in reasonable agreement with the previous Nusselt number of 7.0 observed
by Martini and Churchill (1960).
In case fluid is trapped at the worst thermal location inside the horizontal
flowline (i.e. end of the line during a shutdown), the constant Nusselt num￾ber for long-term condition could provide a fair estimate for the internal
heat transfer coefficient during cooldown scenarios of horizontal flowlines.
However, in the general case of non-negligible Rayleigh number, the work
of Ludovisi and Garza (2013) recommends equation (8.14),
Nu = 1.15 Ra0.22 for 30,000 ≤ Ra ≤ 1010 (8.14)❦
❦ ❦
❦
180 8 Two-Phase Flow Thermal Modelling
where the Rayleigh number Ra characterizing the balance between
buoyancy and friction is defined by equation (8.15):
Ra ≡ Pr
⎡
⎢
⎢
⎢
⎣
g𝛽(Tavg − Tsurf)d3
i
(𝜇
𝜌
)2
⎤
⎥
⎥
⎥
⎦
(8.15)
8.5.7 Forced Convection in Vertical Two-phase Flow
Two-phase flow in wellbores and risers is characterized by quasi￾axisymmetric flow. For a well, the lower sections of the production
tubing may be flowing as single-phase fluid, and the heat transfer coeffi￾cient can be estimated with equation (8.3). Then, in the well, the fluid may
turn two-phase, and a mechanistic approach is recommended starting with
the flow pattern determination by sections.
For either dispersed bubble or mist flow patterns the homogeneous flow
approach is recommended, utilizing the equations included in Chapter 5.
Churn/slug and annular flow patterns can be modeled using the annular
flow model and the annular flow triangular relationship (Collier and Thome,
1994). For these regimes, there exists a liquid flow film attached to the wall
with a core of gas flow toward the centerline. The triangular relationship
connects 𝛿, the film thickness, with the velocity profile within the film and
the wall shear stress at the interface, using the momentum balance equation.
The customary methodology is to estimate the film thickness 𝛿 using the
triangular relationship and the following approximations:
hi ≈ hl, film
1 − 𝛼 (8.16)
1 − 𝛼 ≈ 4𝛿
d (8.17)
The film heat transfer coefficient in equation (8.16) can be estimated using
equation (8.6) substituting the pipeline’s internal diameter by the hydraulic
diameter of the film ≈2𝛿. Details of this model can be found in Collier and
Thome (1994).
8.6 External Heat Transfer Coefficient
External crossflow over pipelines, either submerged in seawater or above￾ground pipelines exposed to wind, represents another form of thermal
resistance to transfer energy from the production fluid to the environment.❦
❦ ❦
❦
8.7 Thermal Insulation 181
The correlation by Churchill and Bernstein (1977) can be used to estimate
the Nusselt number and thereafter the heat transfer coefficient for external
forced convection. This correlation is based on the external diameter of the
pipeline system, and it is valid for RePr >0.2.
Nu = 0.3 +
0.62Re1∕2Pr 1∕3
[
1 +
(0.4
Pr )2∕3
]1∕4
[
1 +
( Re
2,82, 000)5∕8
]4∕5
(8.18)
Churchill and Chu (1975) correlation, equation (8.19), can be used for an
unburied pipeline in stagnant air or water ambient. This correlation is based
on the dimensionless Rayleigh number Ra which is product of the dimen￾sionless Prandtl (Pr) and Grashof (Gr) numbers. The definition of Ra and Gr
numbers can be found in Incropera et al. (2003).
Nu = 0.68 +
0.67Ra1∕4
[
1 +
(0.492
Pr )9∕16]4∕9 (8.19)
For environments in which the fluid may alternate between stagnant and
flow conditions, the two previous equations may be applied. However, in
order to get a conservative (i.e. larger) estimate of heat losses, equation (8.18)
may be preferred regardless of whether natural or forced convection is the
dominant mechanism.
8.7 Thermal Insulation
Thermal insulation is the barrier for heat losses for steady-state operation
and for limited-time exposure during transients. This section summarizes
the most common coating materials utilized in the oil and gas industry for
offshore and onshore applications. In time the material will degrade, and the
thermal conductivity may slightly increase. For detailed engineering design,
it is recommended to seek assistance from the material manufacturer to have
access to the most reliable data.
For deepwater subsea applications, the insulation is molded directly
around the flowlines, forming the so-called wet insulation which does
not need an external protective jacket. Such type of insulation has been
designed and tested to sustain the high underwater pressures encountered
in deepwater applications. Table 8.3 summarizes representative typical
values of insulation thermal conductivity.
Table 8.4 shows representative thermal conductivity values for other coat￾ing material for onshore and offshore pipelines. Some of these coatings are❦
❦ ❦
❦
182 8 Two-Phase Flow Thermal Modelling
Table 8.3 Insulation thermal conductivity.
Material k (W/m ∘C)
Aerogel 0.010–0.024
Calcium silicate 0.05
Glass fiber 0.040–0.060
Polypropylene (PP) solid 0.170–0.220
Polypropylene (PP) syntactic 0.150–0.165
Polypropylene (PP) light foam 0.040–0.060
Polyurethane (PU) solid 0.022–0.025
Polyurethane (PU) syntactic 0.150–0.170
PU syntactic deep water 0.08
Polyurethane (PU) light foam 0.02
Table 8.4 Coating thermal conductivity.
Material k (W/m ∘C)
Coal tar enamel 0.19–0.22
Concrete (CWC) lightweight 0.10–0.30
Concrete (CWC) medium 0.40–0.70
Concrete (CWC) dense 1.0–1.8
Fusion bonded epoxy (FBE) 0.10–0.30
Neoprene 0.05–0.06
3-layer polyethylene (3LPE) 0.40–0.51
Adhesive PUF 0.22
used to enhance the adhesion of other coating materials. Concrete material
coating is typically applied to subsea pipelines to provide negative buoyancy
to the system.
Table 8.5 summarizes representative thermal conductivity values of
assorted environments for onshore and offshore pipelines.
Another option available to provide the best insulation possible (lowest
U-value) to the flowlines and risers is the pipe-in-pipe (PIP) alternative. This
option comprises two concentric pipes and centralizers, with an annulus
filled with material (passive insulation) of exceptionally low thermal❦
❦ ❦
❦
8.8 Overall Heat Transfer Coefficient (OHTC) 183
Table 8.5 Other material thermal conductivities.
Material k (W/m ∘C)
Clay (dry to moist) 0.15–1.8
Clay (saturated) 0.6–2.5
Seawater (10 ∘C) 0.56–0.58
Sand (dry) 0.15–0.25
Sand (moist) 0.25–2.0
Sand (saturated) 2.0–4.0
Soil, clay 1.1
Soil, organic matter 0.15–2.0
Soil, saturated 0.60–4.0
Vacuum ≈0
conductivity (e.g. Aerogel). The PIP alternative is costly in materials and
steep costs to reel and lay. Furthermore, very deep offshore applications
may have weight limitations.
8.8 Overall Heat Transfer Coefficient (OHTC)
The estimation of the temperature profile inside a pipeline requires con￾sidering the path followed by thermal energy, from the fluid temperature
to the surrounding environment temperature. The energy conservation
principle has to be satisfied to balance the change in enthalpy flow for
the production stream with the heat transferred to the external medium.
This is a crucial step in any simulation because the fluid properties and
the flashing equilibrium are very dependent on temperature and therefore
affect the conservation of mass and momentum.
Two operating thermal scenarios may take place: steady-state and tran￾sient heat transfer. For a steady-state scenario, the most useful tool is to
combine all thermal resistances into a single one referred to as the OHTC.
A key component of the OHTC is the U-value that combines all thermal
resistances associated with heat conduction, namely the piping mate￾rial wall, and the thermal insulation and coatings external to the piping.
The other components built into the OHTC are the internal and the external
heat convection thermal resistances.❦
❦ ❦
❦
184 8 Two-Phase Flow Thermal Modelling
Normally, heat radiation has a negligible contribution to the overall
thermal resistance except in cases of pipelines exposed to solar or sky
radiation. The concept of thermal resistor is addressed below in this section
by means of the electrical analogy.
Heat conduction is a diffusional molecular-level mechanism represented
by the thermal conductivity property. Heat convection is associated with
fluid in motion, forced by either external sources or buoyancy effects (called
natural or free convection). In either case, convective heat transfer may have
laminar or turbulent fluid motion.
In transient heat transfer modeling, two elements intervene, the thermal
resistors or conduction terms, and the capacitances storing thermal energy.
The latter include the mass and specific heat of the piping and the coating
materials. In general, the analysis of a discretized production field system,
using the finite-difference method of solution, demonstrates that the ther￾mal transient terms have a characteristic time orders of magnitude larger
than the residence time of the fluid at each domain cell. Thus, very often the
thermal capacitances are ignored in the transient simulation by assuming an
instantaneous rate of heat transfer as in the steady-state scenarios.
Modelling the OHTC or the U-value benefits from the concept of thermal
resistors (this is analog to Ohm’s law in electrical networks). The analog
considers heat fluxes as electric current, and temperature gradients equiva￾lent to electric voltage potential. There is a difference in this analogy; Ohm’s
law assumes constant linear performance of the electrical resistors, whereas
thermal resistors are commonly nonlinear and temperature-dependent.
Cylindrical coating layers covering a pipeline have thermal resistances per
unit length that can be estimated with equation (8.20); each layer is charac￾terized by its thermal conductivity km, and diameters Dm (internal) and Dm+1
(external).
R′
m =
Ln ( Dm+1
Dm
)
2𝜋km
(8.20)
Figure 8.1 shows an assembly of four coating layers covering a steel
pipeline, plus the internal/external convective resistors. The five layers of
coating in this sketch can be represented with equation (8.23), and the two
convective resistors can be represented with the next two equations:
R′
i = 1
hi
𝜋d (8.21)
R′
o = 1
ho𝜋D6
(8.22)❦
❦ ❦
❦
8.8 Overall Heat Transfer Coefficient (OHTC) 185
Ln(D3/D2)
2𝜋k2
Ln(D5/D4)
2𝜋k4
Ln(D6/D5)
2𝜋k5
Ln(D4/D3)
2𝜋k3
Ln(D2/d)
2𝜋k1
1
ho𝜋D6
1
hi
𝜋d
Tf T∞
Figure 8.1 Thermal resistance network.
Thus, the total thermal resistor for Figure 8.1 results
R′
T = 1
hi
𝜋d +
Ln ( D2
d
)
2𝜋k1
+
Ln ( D3
D2
)
2𝜋k2
+
Ln ( D4
D3
)
2𝜋k3
+
Ln ( D5
D4
)
2𝜋k4
+
Ln ( D6
D5
)
2𝜋k5
+
1
h0𝜋D6
(8.23)
The concept of total thermal resistance enables to obtain the heat transfer
rate per unit length by
Q̇ = ΔT
R′
T
= Tfluid − Tenvironment
R′
T
(8.24)
The coatings’ U-value, referred to the pipeline ID, is defined as
Ud = 2∕d
Ln( D2
d
)
k1
+ Ln( D3
D2
)
k2
+ Ln( D4
D3
)
k3
+ Ln( D5
D4
)
k4
(8.25)
It is convenient to justify the assumption aforementioned that the thermal
energy storage in the pipeline wall and the coatings is negligible compared to
the thermal energy transferred to the environment. This assumption simpli￾fies the transient simulations by eliminating the energy storage terms. The
support for such an assumption rests on comparing the characteristic time
for thermal energy storage to the residence time the fluid spends within a
discrete element in the pipeline.
For the sake of the argument and to simplify the thermal analysis, let us
consider a bare pipeline without any coating. Consider the temperatures of
the fluid, the steel wall, and the environment, respectively, as Tf , Tw, and
To. Thus, an energy balance on the domain element of length 𝓁 would be
given by equation (8.26):
(𝜌c)w𝓁𝜋
(
D2
o − d2
)
4
dTw
dt = hi
𝓁𝜋d(Tf − Tw) − ho𝓁𝜋Do(Tw − To)
(8.26)❦
❦ ❦
❦
186 8 Two-Phase Flow Thermal Modelling
It is easy to demonstrate that the characteristic time for thermal storage on
the pipe wall is given by equation (8.27) where 𝛿 is the steel wall thickness:
𝜏storage = (𝜌c)w
(
D2
o − d2
)
4hi
d ≈ (𝜌c)w𝛿
hi
(8.27)
On the other hand, the characteristic residence time within the domain
element of length 𝓁 is
𝜏residence = 𝜋d2𝓁
4Qmix
= 𝓁
j (8.28)
which leads to the following criterion, equation (8.29), to neglect energy
storage in thin-walled piping, by assuming that 𝓁 is of the order of d. This
argument could be validated with typical heat transfer coefficients, steel
properties, and mixture velocity.
𝜏residence
𝜏storage
≅
hi
j(𝜌c)w
≪ 1 (8.29)
For a conventional-coated pipeline by and large, the dominating thermal
capacitance lies on the steel, and the criterion of equation (8.29) is of the
order of 0.3%, easily extrapolating to such conventional assemblies.
Example 8.1 U-Value Calculation
An 8-inch flowline thermal design calls for the assembly listed in Table 8.6,
including dimensions and material properties. This type of insulation is
Table 8.6 Example of the calculation of U-value (in bold characters) based on internal
and external diameter.
ID
(m)
WT
(m)
OD
(m)
k
(W/mK) 𝝆 (kg/m3)
cp
(J/kg K)
RT
(mK/W)
Steel pipe 0.1937 0.0127 0.2191 45.0 7,849 460 0.0004
Coatings
FBE coating
(corrosion)
0.2191 0.00025 0.2196 0.200 1,300 1502 0.0018
Adhesive PUF 0.2196 0.00025 0.2201 0.220 900 2874 0.0017
PP – solid – inner 0.2201 0.00533 0.2308 0.190 900 2820 0.0396
Syntactic PP 0.2308 0.07620 0.3832 0.160 700 1615 0.5043
PP – solid – outer 0.3832 0.00508 0.3934 0.190 900 1611 0.0219
0.08712 0.5698
U (W/m2 K) 2.55 (based on pipe OD)
U (W/m2 K) 2.88 (based on pipe ID)❦
❦ ❦
❦
8.9 Buried Pipelines 187
Table 8.7 Example of the calculation of U-value (in bold character) based on internal
diameter of inner pipe for a pipe-in-pipe configuration.
ID
(m)
WT
(m)
OD
(m)
k
(W/m K)
𝝆
(kg/m3)
cp
(J/kg K)
RT
(mK/W)
Steel inner pipe 0.1937 0.0127 0.2191 45.0 7849 460 0.0004
Aerogel (annulus) 0.2191 0.03335 0.2858 0.015 10 1900 2.8192
Steel outer pipe 0.2858 0.0191 0.3239 45.0 7849 460 0.0004
FBE (external coating) 0.3239 0.00025 0.3244 0.200 1300 1502 0.0012
2.8213
U (W/m2 K) 0.58 (based on pipe ID)
called 5LPP (5 layers of polypropylene). The last column of this table has
the thermal resistances for each layer, calculated with equation (8.20).
Estimate the coating U-values based on the ID and OD of the pipeline.
The solution proves that U-values based on the outer pipe diameter are
lower than the U-values calculated based on the pipe’s internal diameter.
This is a natural conclusion because the external heat transfer area is larger
than the internal heat transfer area.
Example 8.2 Pipe-in-Pipe U-Value
Consider a pipe-in-pipe application comprising a 12-inch (286 mm ID,
324 mm OD) casing pipe, concentric and external to an 8-inch (194 mm
ID, 219 mm OD) internal piping. The internal annular space between the
two pipes is filled with Aerogel. Estimate the U-value based on the ID of
the internal pipe and compare the U-value based on the ID with the result
from Example 8.1.
The solution to this problem is shown in Table 8.7. The difference
in U-values based on the internal diameter, between the flowline of
Example 8.1 and the inner pipe of Example 8.2, is striking; the pipe-in-pipe
configuration reduces by 80% the U-value with respect to the option of a
single pipe insulated with 5LPP.
8.9 Buried Pipelines
It was pointed out before that pipeline trenching is done to utilize the soil
medium as an inexpensive thermal insulation material and for safety rea￾sons too. This practice is common for onshore pipelines which also have to
cross-rivers and creeks, and clear roads and rail tracks underneath.❦
❦ ❦
❦
188 8 Two-Phase Flow Thermal Modelling
The traditional way to calculate the thermal resistance of the surrounding
soil is based on two-dimensional (2-D) heat conduction (Incropera et al.,
2003). From such 2-D analysis, the shape-factor SHT (specified per unit
length of pipeline) is defined by equations (8.30) and (8.31) with the help
from Figure 8.2:
S′
HT = 2𝜋
Ln ( 4𝜍
Do
) for 𝜍
Do
> 1.5 (8.30)
S′
HT = 2𝜋
cosh−1
( 2𝜍
Do
) for 𝜍
Do
< 1.5 (8.31)
The thermal resistance of the soil per unit length for a fully trenched
pipeline becomes
Rsoil = 1
S′
HTksoil
(8.32)
This thermal resistance, equation (8.32), is added in series with the rest of
the network of thermal resistances: fluid-steel-coating and environment to
obtain an overall thermal resistance.
The heat losses from a buried pipeline are calculated by dividing the over￾all temperature gradient by the overall thermal resistance.
Dext
Buried
pipeline with
coating layers
Ground surface
𝜁
Figure 8.2 Buried pipeline heat transfer domain.❦
❦ ❦
❦
8.10 Temperature Profile 189
Table 8.8 Example of the calculation of U-value (in bold character) based on internal pipe
diameter for a buried flowline.
ID
(m)
WT
(m)
OD
(m)
k
(W/m K)
𝝆
(kg/m3)
cp
(J/kg K)
RT
(mK/W)
Steel pipe 0.1937 0.0127 0.2191 45.0 7849 460 0.0004
FBE (external
coating)
0.2191 0.00025 0.2196 0.200 1300 1502 0.0018
Soil ζ (m) = 1.11 0.300 SHT = 2.09 1.5947
1.5970
U (W/m2 K) 1.03 (based on pipe ID)
Example 8.3 Buried Flowline
Consider again the pipeline of Example 8.1, but only covered with the
FBE coating and buried one meter to the top of the pipe. Consider that
the trenched soil (organic matter) has a thermal conductivity of about
0.3 W/m K. Estimate the U-value based on the ID of the pipe, and compare
it against the result from Example 8.1.
The solution to this problem is summarized in Table 8.8. The difference
in U-value with respect to the solution to Example 8.1 is −64%, indicating
that from the thermal standpoint, it would be much better to bury the flow￾line than to provide the 5LPP coatings. Of course, the cost of trenching the
flowline has to be weighed against the cost of the 5LPP.
8.10 Temperature Profile
The principal objective of the thermal analysis is to determine the local tem￾perature at each cell of the discretized domain. The temperature property is
crucial to evaluate the fluid properties that support the conservation princi￾ples. Obviously, the result of the thermal analysis is the temperature profile.
For the pipeline design, it is necessary to estimate thermal expansion of
the steel material during service start-up, during normal operation, and
the ensuing material contraction after shutdown. Thus, a crucial piece of
information for the pipeline designer is the set of operating temperature
profiles the system may undergo under service and throughout the life
cycle. Example 8.4 illustrates the task of finding the temperature profile for
a normal operation scenario.❦
❦ ❦
❦
190 8 Two-Phase Flow Thermal Modelling
Example 8.4 Temperature Profile
Consider the subsea horizontal flowline of Example 8.1 which has a length
of 12-km transporting live oil and gas. Use the following data to estimate the
average OHTC and the temperature profile:
● Flow rate (kg/s): 4.6
● Pressure (bara): 56
● Temperature (∘C): 87
● Steel pipeline ID (mm): 193.7
● Coating external OD (mm): 406.3
● Mixture avg. thermal conductivity (W/m K): 0.0876
● Mixture avg. heat capacity (J/kg K): 2,265
● Mixture avg. density (kg/m3): 485
● Mixture avg. viscosity (s Pa): 0.0041
● Seawater temperature (C): 4
● Seawater current speed (m/s): 0.65
● Seawater thermal conductivity (W/m K): 0.60
● Seawater heat capacity (J/kg K): 3900
● Seawater density (kg/m3): 1035
● Seawater viscosity (s Pa): 0.0017
The hydrocarbon composition of McCain (1990) is shown in Table 8.9. The
calculation of the OHTC is shown in Table 8.10.
It is clear that incorporating the internal/external thermal resis￾tances reduces the conductance of the U-value found in Example 8.1.
Table 8.9 Fluid composition for
Example 8.4.
Component (% mol.)
C1 36.47
C2 9.67
C3 6.95
i-C4 1.44
n-C4 3.93
i-C5 1.44
n-C5 1.41
n-C6 4.33
C7+ 33.29
CO2 0.91
N2 0.16❦
❦ ❦
❦
8.10 Temperature Profile 191
Table 8.10 Example of the calculation of OHTC (in bold characters) based on the internal
diameter of the pipe for a long subsea flowline.
ID
(m)
WT
(m)
OD
(m)
k
(W/m K)
𝝆
(kg/m3)
cp
(J/kg K)
RT
(mK/W)
Steel pipe 0.1937 0.0127 0.2191 45.0 7849 460 0.0004
Coatings
FBE coating
(corrosion)
0.2191 0.00030 0.2197 0.200 1300 1502 0.0022
Adhesive
PUF
0.2197 0.00030 0.2203 0.220 900 2874 0.0020
PP – solid –
inner
0.2203 0.00650 0.2333 0.190 900 2820 0.0480
Syntactic
PP
0.2333 0.08000 0.3933 0.160 700 1615 0.5194
PP – solid –
outer
0.3933 0.00650 0.4063 0.190 900 1611 0.0272
0.09360 0.5993
Fluid properties j (m/s) 2.5
Density (kg/m3) 485 Re 57,709
Viscosity (s Pa) 0.0041 Pr 106
Thermal conductivity
(W/mK)
0.0876 Nu 701
Heat capacity (J/kg K) 2265 h (W/m2 K) 317 RT (mK/W) 0.0052
Seawater properties v (m/s) 0.65
Density (kg/m3) 1035 Re 92,337
Viscosity (s Pa) 0.0017 Pr 11
Thermal conductivity
(W/mK)
0.60 Nu 481
Heat capacity (J/kg K) 3900 h (W/m2 K) 1236 RT (mK/W) 0.0006
OHTC (W/m2C) 2.66 (based on pipe ID)
The conductance reduction due to the internal/external thermal resis￾tances is small of the order of 3%, because those resistances are from
liquid-dominated fluids.
It is interesting to note that it is common to perform thermal simulations
ignoring the external/internal resistance components, because of the small
contribution they add when the fluids are in the liquid phase, as is illustrated❦
❦ ❦
❦
192 8 Two-Phase Flow Thermal Modelling
in this example. To err on the safe side (i.e. conservative estimate) the
simulations may be carried out based on the U-value instead of the OHTC.
The solution to this problem was obtained with commercial software
linked to a compositional model. The temperature profile attained with the
software is shown in Figure 8.3 based on the constant OHTC of 2.66 W/m2 K
and yielding an arrival temperature of 13.3 ∘C.
It is very enlightening to solve the same problem by “hand,” using
equation (8.33), with an average-corrected heat capacity value taken from
the same compositional model. The average heat capacity from the com￾mercial software is 1987 J/kg K, a value 12% lower than the original average
value provided (2265 W/m K). The resulting estimate by hand is 13.9 ∘C
which is strikingly close to the result from the commercial software.
Tf − T∞
Ti − T∞
= Tf − 4∘C
87∘C − 4∘C =
= exp [
−OHTC(𝜋dL)
ṁ Cp
]
= exp [
−2.66 × 𝜋 × 12,000 × 0.1937
4.6 × 1987 ]
= 0.1194 (8.33)
2000 4000 6000 8000
Flowline distance (m)
0 10,000 12,000
0
10
20
30
40
50
Fluid temperature (°C)
60
70
80
90
100
Figure 8.3 Fluid temperature profile of flowline.❦
❦ ❦
❦
8.11 Flowline Cooldown 193
A plausible conclusion from this example is that for steady-state thermal
analyses the simple model of equation (8.33) is good enough to calculate
the flowline temperature profile. However, it is necessary to have a good
average estimate for the OHTC and for the fluid’s heat capacity, both
assumed constant along the system. Alternatively, as in this example, the
hand calculation serves to cross-check the output from the commercial tool.
8.11 Flowline Cooldown
The transient heat losses occurring during a system shutdown are com￾monly referred to as the cooldown scenario. Obviously, the system operator
is concerned that this situation entails a substantial risk of forming hydro￾carbon hydrates that quickly bond, forming a solid crystalline structure
plugging the pipeline and impeding the system restart afterwards.
This probable risk highlights the importance of simulating the cooldown
time to determine how long it will take to form hydrates. Cooldown time
relates to the so-called no-touch time that oilfield operators have established
in the operating procedures, preventing the consequences of hydrate plug￾ging. The no-touch time is the maximum time allowed to remediate any
failure in the system that caused the shutdown and to restart the system
and setting the live fluid in motion again. Obviously, no-touch time includes
a safety factor to account for the uncertainties implicit in the heat transfer
simulation.
Example 8.5 Cooldown
Estimate the internal heat transfer coefficient for the flowline of Example 8.4,
at the end of it (base of the riser location), during a shutdown scenario. Con￾sider the following scenarios: (a) the fraction of gas present at the location
is negligible; and (b) the liquid holdup ratio at the end of the flowline is
approximately 83% (from the steady-state simulation with the commercial
code).
Part (b) of this problem is an unlikely scenario because the end of the flow￾line (i.e. the base of the riser) will eventually receive oil rundown from the
riser. Thus, part (a) may be a more realistic scenario. Nevertheless, solving
part (b) enables us to compare the effect of two phases present.
● Part (a). Assuming a long-term heat conduction scenario following the
criteria of Martini and Churchill (1960), we get
hi = 7kf
d = 7 × 0.215
0.1937 = 7.77 W
mK❦
❦ ❦
❦
194 8 Two-Phase Flow Thermal Modelling
● Part (b). Assuming again long-term heat conduction for either phase, fol￾lowing the criteria of Martini and Churchill (1960), and substituting the
internal diameter for the hydraulic diameter for each phase, we get
dh,oil = 4Aoil
Pwet,oil
= 4 × 𝜋 × 0.19372 × 0.83
4 × 0.4164 = 0.235 m
dh,gas = 4Agas
Pwet,gas
= 4 × 𝜋 × 0.19372 × 0.17
4 × 0.1921 = 0.104 m
hi,oil = 7koil
dh,oil
= 7 × 0.215
0.235 = 6.40 W
mK
hi,gas = 7kgas
dh,gas
= 7 × 0.0538
0.104 = 3.62 W
mK
hi,total = 6.40 × 0.4164 + 3.62 × 0.1921
𝜋 × 0.1937 = 5.52 W
mK
It is important to highlight that the solution for part (b) is a gross approx￾imation of the total internal heat transfer coefficient. For a more accurate
solution, it is necessary to perform a CFD simulation that could provide the
required definition of the transport phenomena.
Notwithstanding the simplifications done on part (b), a lower internal
heat transfer coefficient occurs when two phases transfer heat in natural
convection as compared to the case of the flowline filled with liquid only.
Furthermore, to be safe in a risky cooldown scenario, some practitioners pre￾fer to estimate the internal heat transfer coefficient assuming the flowline is
filled with gas.
8.12 Document Navigation Heat Transfer
in the Wellbore
Wellbore heat transfer is in general a transient phenomenon. The stages of
well operation include start-up, stable production flow, and well shut-in.
All these stages involve heat transfer to an environment, that is the “well
formation”, which has an infinite heat capacity. Thus, throughout any of the
well operation stages, the heat losses to the formation change the geother￾mal gradient in the wellbore.
A well completion is a complex geometry comprising distinct size tubulars
such as:
● Conductor casing,
● Surface casing,
● Casing liner,❦
❦ ❦
❦
8.12 Document Navigation Heat Transfer in the Wellbore 195
Table 8.11 Representative U-values for well completions.
Well interval U-value (W/m2 K)
Lower end of tubing 4.8–6.5
Mid-zone of tubing 4.5–6.1
Upper end of tubing 4.0–5.5
Vacuum-insulated tubing (VIT) 0.4–0.46
● Intermediate casing,
● Production casing,
● Production liner, and
● Production tubing.
The gaps between consecutive casings usually are filled with completion
fluid which is a brine fluid with additives. The external side of the casings is
isolated from the formation by a cement layer to prevent fluid leaks. This is
a critical safety element for the well integrity.
It is beyond the scope of this book to discuss the many designs of well
completion for an oil or gas well. For further details about completions refer
to Bellarby (2009).
The evaluation of the U-values applicable to the different intervals of
the well completion obviously depends on the specifics of the well design.
The assessment of U-values per interval entails applying the equations
included in Section 8.8. Some typical U-values for a wellbore are shown in
Table 8.11. In any practical case, the thermal capacitance of the completion
layers is ignored for thermal transient simulations of the wells.
Ramey (1962) studied the transient thermal performance of the surround￾ing wellbore formation and proposed an analytical solution based on the
continuous line-source concept (Carslaw and Jaeger, 1959). This solution is
expressed in terms of the exponential integral function Ei
. This line-source
approximation in general is adequate for thermal performance beyond one
week after a change in operating condition.
The heat flux per unit length through the completion of the well formation
can be represented by equation (8.34), and the total thermal conductance by
equation (8.35), Brill and Mukherjee (1999). The function f(t) follows from
the line-source approximation. The temperature Tgeoth in equation (8.33) is
the local formation temperature obtained from the geothermal gradient.
Q̇ = Tfluid − Tgeoth
R′
T
= Ud𝜋d(Tfluid − Tgeoth) (8.34)❦
❦ ❦
❦
196 8 Two-Phase Flow Thermal Modelling
Ud = 1
1
hi
+ d
[
Ln( D2
d
)
2k1
+ . … …+ Ln( Dm
Dm−1
)
2km−1
+ f(t)
2kformation ] (8.35)
Defining the following parameters
tdiff ≡
( 4t
D2
m
) ( k
𝜌c
)
formation
(8.36)
𝜆 ≡ − 1
4tdiff
(8.37)
we could evaluate the exponential integral function Ei with its mathematical
definition as
f(t) = 0.5Ei
(𝜆)=−0.5∫
∞
−𝜆
exp[−t]
t
dt (8.38)
However, this evaluation is cumbersome, and the approximations pro￾posed by Hasan and Kabir (2002) give accurate enough estimates. These
equations are
f(t) = 1.1281√
tdiff(1 − 0.3√
tdiff) for tdiff ≤ 1.5
f(t)=[0.4063 + 0.5Ln(tdiff)] (
1 +
0.6
tdiff )
for tdiff > 1.5 (8.39)
It is important to realize that the line-source model applies to the
case of well start-up after an exceedingly long shut-in condition, when
the formation temperature corresponds to the geothermal gradient. For
pseudo-steady-state scenarios, following well start-up, the line-source
model also applies supported by equation (8.37) to evaluate f(t).
A cooldown scenario in a well after shut-in requires more attention.
The simulation involves estimating the transient thermal energy flow
into the formation caused by the time-dependent temperature of the fluid
trapped in the well tubing, and the simultaneous transient penetration
of heat into the formation. The analytical solution of the temperature
distribution in the semi-infinite formation is much more complex. Hahn
and Özi¸sik (2012) reference provides the temperature profile solution in the
reservoir domain based on Fourier–Bessel integrals.
Due to considerable flow assurance risk at the top of the tubing, some
wells are completed with a section of VIT (vacuum-insulated tubing with
ultra-low U-value), to enhance the arrival fluid temperature at the well’s tree
during normal operation. However, the VIT, due to its low thermal conduc￾tivity, prevents the top layers of wellbore from reaching higher temperatures
that otherwise would be reached without VIT. Therefore, when a well with❦
❦ ❦
❦
References 197
VIT shuts in and starts a cooldown process, the fluid trapped at the top of
the tubing will experience a larger temperature gradient that increases heat
losses, partially balanced by the larger thermal resistance induced by the
VIT section. In conclusion, during cooldown, there are two competing fac￾tors that would determine whether the presence of VIT would be beneficial
or not.
References
Bellarby, J. (2009). Well Completion Design. Amsterdam, Netherlands: Elsevier.
Brill, J. and Mukherjee, H. (1999). Multiphase Flow in Wells. Dallas, TX,
USA: SPE.
Carslaw, H. and Jaeger, J. (1959). Conduction of Heat in Solids. London,
UK: Oxford University Press.
Churchill, S. and Chu, H. (1975). Correlating Equations for Laminar and
Turbulent Free Convection from a Horizontal Cylinder. Int. J. Heat Mass
Transf. 18: 1049–1053.
Churchill, S. and Bernstein, M. (1977). A Correlating Equation for Forced
Convection from Gases and Liquids to a Circular Cylinder in Crossflow.
J. Heat Transf. 99 (2): 300–306.
Colburn, A. (1933). A Method of Correlating Forced Convection Heat Transfer
Data and Comparison with Liquid Friction. Trans. Inst. Chem. Eng. 29: 174.
Collier, J. and Thome, J. (1994). Convective Boiling and Condensation, 3e.
Oxford, U.K.: Oxford Science Publications.
Hahn, D. and Özi¸sik, N. (2012). Heat Conduction, 3e. Hoboken, New Jersey,
USA: John Wiley and Sons.
Hasan, A. and Kabir, C. (2002). Fluid Flow and Heat Transfer in Wellbores.
Dallas, TX, USA: SPE.
Hellums, J. (1960). Finite Difference Computation of Natural Convection Heat
Transfer,” PhD Dissertation. Michigan, USA: The University of Michigan.
Incropera, F., Dewitt, D., Bergman, T., and Lavine, A. (2003). Principles of Heat
and Mass Transfer, 7e. Hoboken, NJ, USA: John Wiley and Sons.
Ludovisi, D., and Garza, I., “Natural Convection Heat Transfer in Horizontal
Cylindrical Cavities: A Computational Fluid Dynamics (CFD)
Investigation,” Proceedings of the ASME 2013 Power Conference,
Power2013-98014, Boston, Massachusetts (2013).
Martini, W. and Churchill, S. (1960). Natural convection inside a horizontal
cylinder. AICHE J. 6 (2): 251–257.
McCain, W. (1990). The Properties of Petroleum Fluids, 2e. Tulsa, Oklahoma,
USA: PennWell Books.❦
❦ ❦
❦
198 8 Two-Phase Flow Thermal Modelling
Ramey, H. (1962). Wellbore Heat Transmission. J. Pet. Technol. 225: 427–435.
Shoham, O. (2006). Mechanistic Modeling of Gas-Liquid Two-Phase Flow in
Pipes. Dallas, TX, USA: SPE.
Sieder, E. and Tate, G. (1936). Heat Transfer and Pressure Drop of Liquids in
Tubes. Ind. Eng. Chem. 28 (12): 1429–1436.
Stewart, R., Sabol, A., and Boney, L., “Numerical and Experimental Studies of
the Natural Convection Within a Horizontal Cylinder,” NASA Technical
Note, NASA TN D-7728, Washington D.C., USA. (1974).❦
❦ ❦
❦
199
9
Advanced Simulations
9.1 Introduction
Section 9.2 defines the implications deriving from time-dependent change
upon the performance parameters. The physical significance of a transient
two-phase flow is addressed to distinguish between “slow” and “fast”
transients.
The normal course of changing the typical field operations, alternating
between prolonged periods of “steady-state” and transient states, is covered
in Section 9.3. The important realization that the highest operational risks
(i.e. Flow Assurance risks) arise during some of the transient states points
to the value of such simulations throughout the life cycle of production
systems.
Section 9.4 revisits complexities of the system of governing equations
covered in Chapter 5. The backbone of commercial codes currently
employed to simulate two-phase flow are the 1-D models governing the
transfer of mass, momentum, and energy, with additional closure models
to incorporate radial property variances and multiple interwoven phases.
Therefore, the deterministic approach based on first principles for pre￾dicting flow behavior constitutes what we call later the “programming”
methodology, in contrast with the “learning” methodology.
The understandable attitude of engineers and technical personnel trusting
the output from renowned commercial codes is reviewed and challenged
in Section 9.5 concerning the inevitable numerical uncertainty of the pro￾grammed models stemming from the data acquisition process used to feed
the models.
Section 9.6 provides a vision of where the modeling of transient two-phase
flow may head in the short- and mid-term to provide more badly needed
insight into this complex field. The emphasis in this section is to briefly
Multiphase Transport of Hydrocarbons in Pipes, First Edition.
Juan J. Manzano-Ruiz and Jose G. Carballo.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
Companion Website: www.wiley.com/go/Manzano-Ruiz/Multiphasetransport❦
❦ ❦
❦
200 9 Advanced Simulations
highlight the methodologies of artificial intelligence (AI) and machine
learning (ML). A skin-deep introduction to these evolving fields and some
application examples are presented in this section to familiarize the avid
reader with the forthcoming developments applied to two-phase flow in
pipelines, currently in their infancy. The most important message from this
section is the demystification of the “automated” evolution of these remark￾able technologies, born from the breathtaking digitalization advances and
assumed devoid of human intervention. That is not the reality of such devel￾opments because data scientists and engineers are needed to select data sets,
pre-process the data set, choose the learning algorithms, validate the mod￾els, and test the models on “unseen” data sets. Thus, hardly at least in the
short run, we should not expect to count on entirely self-developed artificial
intelligence codes without the supervised contribution of data scientists.
Section 9.7 closes this chapter by reviewing the two trending philosophies
for simulating two-phase flow in pipelines. This section has been added to
alert the reader of a potential forthcoming transition from the traditional
deterministic modeling methods toward statistical analysis of field data
sets. Brief references are made in this chapter to determine methods that
have been covered in previous chapters, and more emphasis is placed on
the statistical methodologies of AI.
This succinct chapter serves as an opening to the deterministic examples
presented in the next chapter, while at the same time providing an overview
of the modeling limitations of the state-of-the-art in this subject.
9.2 Nature of Transient Flow
A transient operation implies a change in the operating conditions.
Although the normal operation may seem like a steady-state process, reality
proves that hydrocarbon production through pipelines carries inherent
fluctuations due to external perturbations affecting the system. Thus, a
transient operation is herein defined as the transition process from one
operating condition to another state, with the objective of changing the
flow rate in anticipation of compliance with a production plan, handling
an emergency situation, or to follow a maintenance program. Typically this
includes start-up operations (e.g. a well, a cluster, or the complete system)
and shutdown (again, a well, or the entire system). Obviously, the extreme
case of emergency shutdown is included in the category of a transient
because of the rapid change of operating state.
The physical significance of a transient two-phase flow is a succession
of flow parameters, flow patterns, and changing fluid properties. Hence, it❦
❦ ❦
❦
9.2 Nature of Transient Flow 201
would be desirable to be able to model such transitions as a function of time
to predict potential risks within the production system. In this sense, the
forecasting of the produced liquids and the gas flow rates, the delivery pres￾sure, and temperature become the task of the simulation work to ensure the
system’s safety.
Heat losses to the environment will also undergo appreciable change, in
particular, when flow rates taper off because larger residence time in the
system offers more opportunity to transfer heat. In the ultimate case of a full
shutdown, the transient heat transfer becomes a substantial risk for solids
deposition and plugging. So again the significance of transient heat losses
is a potential severe condition for the technical integrity of the production
system.
System blowdown is another important transient operation that entails
rapid phase equilibrium changes and declining flow rates. Blowdown
operations are commonly executed to preserve the integrity of the system
and are triggered by an emergency situation such as during a lost-of￾containment event.
Not all the system evacuation operations are considered a blowdown. Sys￾tem depressurization is a gradual and limited evacuation process to prevent
the formation and plugging risk of hydrocarbon hydrates during a prolonged
duration shutdown.
It is essential to define the difference between a regular transient
two-phase flow phenomenon and the very fast transients characterized by
traveling waves back and forth across the production system. The latter
phenomenon, for single-phase flow, is popularly referred to as a water
hammer phenomenon, involving wave velocities of the order of the speed
of sound. The speed of sound is defined as
c ≡
(𝜕p
𝜕𝜌)
s
(9.1)
The thermodynamics definition of the speed of sound implies waves of
infinitesimal magnitude traveling under isentropic conditions in the fluid
medium. The measurement of the speed of sound in single-phase flow is
straightforward. For two-phase flow, the speed of sound definition and mea￾surement is much more complex and dependent on the flow pattern as well
as the phases’ properties.
The relevance of a “water hammer” phenomenon is the possibility of
“choking” the flow because any perturbation over the system taking place
downstream of the choking point cannot travel upstream. The risk of chok￾ing a two-phase flow is related to the fact that the speed of sound is lower
than the respective value for each of the phases present. For conventional❦
❦ ❦
❦
202 9 Advanced Simulations
hydrocarbon production systems, the chance of choked flow is low within
pipelines, but exceedingly high at narrow transition fittings such as valves,
tree chokes, or the exit route during blowdown.
Performance modeling under transient conditions is quite challenging
due to the added time dimension intervening in the two-phase flow realm.
This additional dimension numerically imposes time iterations upon the
domain grid (discretized physical system). Similar to steady-state flow
simulation, the physical system domain is discretized into a number of
representative cells upon which the conservation principles are applied.
One-dimensional numerical integration schemes such as finite differences
or finite element are regularly incorporated into commercial codes. One of
these standard schemes is the control-volume approach (Patankar, 1980)
applied upon staggered grids while selecting numerical-stable implicit
integration procedures.
The full three-dimensional physical flow-field simulation for hydrocar￾bon production is out of the question for typical systems, often spanning
distances stretching for many kilometers. The computer storage memory
and the shocking computational time requirements do not lend for rou￾tine simulations other than for short elements of the system, such as valves,
changes in direction, heat exchangers, and separators. Such 3-D codes are
usually classed as CFD (computational fluid dynamics) incorporating the
full Navier–Stokes momentum equations for each phase in either the Eule￾rian or the Lagrange frame of reference. The difference with transient sim￾ulation is therefore the time variation of fluid parameters and properties
within the discretized control volumes.
9.3 Transient Flow Applications
Routine two-phase transient operations could be simplistically visualized as
the sequence of events shown in Figure 9.1.
Normal operation
Ramp-down
Preparation
for
shutdown
Shutdown/Cooldown
Shutdown
Ramp-up
Start-up
Figure 9.1 Typical transient operations for a production system.❦
❦ ❦
❦
9.3 Transient Flow Applications 203
After the shutdown of well clusters the entire system has to be restarted.
The restart of a well involves the gradual opening of the tree choke to pro￾tect the reservoir from jittery transients conducive to the release of sand
fines. A large pressure gradient across the tree choke is a Joule–Thomson
risk in gas wells causing large temperature drops and potential hydrate plug￾ging. Thus, the transient simulation of a well start-up requires the accurate
modeling of the thermal hydraulics along the production string and across
the choke.
The restart simulation of a cluster of wells is a sequence of individual wells
started as described above. The overall system restart requires the initial
condition in flowlines and risers. Such initial condition is obtained from
running the simulation model under steady-state conditions and following
up with the ramp-down process and redistribution of phases after shutdown.
Moreover, depending on the cooldown process that follows the ramp-down,
phase distribution in the system will depend on heat losses affecting it after
shutdown.
Once the wells are restarted, the next step is to progressively ramp up
production to reach the steady-state production target. Ramp-up should be
gradual in order to minimize the risk of liquid surging downstream at the
production facility while increasing the production flow rate. In general,
the objective of ramp-up simulations is to predict the risk of flooding down￾stream separators.
Both the wells’ start-up process and the system ramp-up transient oper￾ation have a time scale of a few hours, depending on the magnitude of the
flow rates and the risk of sand production associated with drawdown.
The normal operation period, that is, quasi-steady-state process, will
outlast any other transient operation, in pursuit of delivering the pro￾duction plan. However, system perturbations or preventive maintenance
will eventually lead to the ramp-down process followed by the shutdown.
Temporary shutdowns to correct a minor problem, lasting a few hours, may
not need to flush the live production trapped in the system or the system
depressurization as pointed out before. In this case, the operator has a strict
“no touch-time” rule in place for when the shutdown lasts no more than
8–10 hours. Beyond such a rule, system flushing may be activated with dead
oil or hot oil to safely prepare the system for extended shutdown time.
The methodology to establish such a precautionary operation is to perform
a heat transfer analysis during the cooldown period until the fluids reach
the pre-defined high-risk temperature. The flushing operation in itself is
another transient two-phase flow application deserving proper simulation.
SURF facilities are constantly exposed to an environment at constant
temperature and current velocity. From the modeling standpoint, this is❦
❦ ❦
❦
204 9 Advanced Simulations
a simpler case compared to onshore flowlines. The latter are frequently
subjected to changing environmental conditions of wind, temperature,
insolation, rain, and snow, which determine the thermal performance of
the system. Partly for this reason, onshore flowlines are regularly buried
and have a constant environmental condition.
For safety reasons, production systems occasionally are blowdown to min￾imize life and environment risks when there is a contingency or a loss of
containment situation. A leak, a spill, may cause fire and explosion with
severe consequences. Therefore, venting or burning the hydrocarbons in a
flare unit is a safeguard to control an unsafe setting. The blowdown is a tran￾sient operation while the hydrocarbon inventory in the system is depleted.
The initial stage of a blowdown may take place at a constant flow rate if the
flow is choked downstream. The system pressure declines in time, and the
later stages will experience a declining exit flow rate.
Cooldown is the heat loss phenomenon that takes place after system shut￾down. The trapped production fluid would be semi-stagnant, with small
internal motion driven by buoyancy. As such, cooldown is not an operation
but a consequence of bringing the system to rest. For hydrocarbon systems,
the condition of cooldown carries the implicit risk of causing solids deposi￾tion and potential plugging. Thus, very often, the operator of the field would
attempt to flush the live production inventory with dead oil if an extended
shutdown situation is foreseen. In case the last operation is unfeasible, the
next option would be to depressurize the system to somehow control hydrate
formation risk.
9.4 Transient Modeling Challenges
The fundamental equations of two-phase transient flow have been out￾lined in Chapter 5. The TFM set of equations is the most common one￾dimensional tool implemented in most commercial codes, and the
pioneering development of OLGA® (Section 5.6.1) in the early 1980s set the
course for all other transient codes developed specifically for hydrocarbon
multiphase flow in pipelines.
The issue with transient simulations, in general, is the extraordinary
complexity of the set of governing equations, demanding exceptional
numerical integration schemes applied to staggered grids (Patankar, 1980),
while introducing closure equations to knit interface transport phenomena
among phases. Parameters such as the area/volume fraction of one phase
embedded in another require flow-pattern-specific correlations that are
invoked during the execution of mass and momentum balances at each cell❦
❦ ❦
❦
9.5 Current Weaknesses of Simulating Two-Phase Flow in Pipelines 205
of the grid. Thus, the time variable adds another difficulty dimension to
the already intricate dynamics of convection, diffusion, and source-term,
balancing at every node of the physical domain.
Section 5.6.1 very succinctly addressed the set of equations utilized by the
OLGA code in the early 1990s version. At that time, only three phases – oil,
gas, and droplets – were considered in dynamical equilibrium. Nowadays,
the OLGA code can consider nine concurrent phases pushing the envelope
of numerical convolutions even further.
One crucial decision in solving such a daunting set of equations is
opting for either the implicit or the explicit scheme of discretizing the
physical domain. OLGA code has opted for the implicit scheme because it
warrants integration stability for larger cell sizes. On the other hand, the
explicit integration scheme, although it is a straightforward time-marching
method, leads to unreasonably small cell sizes in order to meet the required
conditional stability criterion of Courant–Friedrichs–Lewy (CFL) (Pletcher
et al., 2013).
Regular operations of multiphase flow pipelines do have a “slow” type of
transients. In other words, the total time to execute a transient operation
is orders of magnitude larger than the residence time of the fluid at any
specific location. However, there may be very fast phenomena at which the
system dynamics occur at the speed of sound in the medium. One of such
event may be an accidental loss of containment of the system, triggering
sound and nonlinear waves traveling both ways while bouncing back from
boundary system elements. Such phenomenon, previously mentioned in
Section 9.2, takes place at the speed of sound in the multiphase medium
which usually is slower than the speed of sound in each of the phases
involved.
From the mathematical standpoint, “slow” transients, which are the rule
in multiphase flow pipelines rather than “fast” water hammer events, fall in
the category of semi-parabolic systems of equations. Water hammer events
are characterized by hyperbolic-class systems of equations of the Cauchy
problem (Pletcher et al., 2013) and require other integration schemes such
as the method of characteristics.
9.5 Current Weaknesses of Simulating Two-Phase
Flow in Pipelines
The simulation results from commercial software have a certain degree
of uncertainty due to the assumptions, simplifications, and models built
into the code, necessary to solve the intricated nature of multiphase flow❦
❦ ❦
❦
206 9 Advanced Simulations
combined with heat transfer. Such uncertainty in the results is very rarely
quoted because of the difficulties in identifying and quantifying the impact
of the semi-empirical models utilized to close the set of conservation
principles. Commercial software is proprietary code inaccessible to the user
interested in assessing the weaknesses of the models used. Furthermore,
very rarely do software users have access to the database of multiphase
experimental tests that enabled the code developer to generate closure
correlations; an exceptional case is the participant members of a JIP (joint
industry project). .
A list of sources of uncertainty in the results from deterministic simulation
tools follows.
● One-dimensional assumption. Unavoidably, eliminating two flow direc￾tions distorts the physics of the flow field, and most codes extend the 1-D
conservation principles to cover 2-D and 3-D domains through closure
equations (e.g. drift-flux model).
● Averaging processes. Space and time averaging techniques are used to
define key parameters such as hold-up and mixture density.
● Flow pattern recognition. For flow maps, this includes the issues related to
the experimental work: the universality of the fluids used, the scale of the
experimental facility, the extrapolation procedure to field scale, the sharp
transitions among flow regimes instead of gradual transitions, the effect of
developing length downstream of system components, and the possibility
of condensing infinite flow regimes into a single map.
● Production systems real data. Scarce public information regarding
accurate and granular field data about production performance to bench￾mark simulation results. Also, most data are focused on steady-state
performance.
● Uncertainty in measured data. Lack of information about the accuracy of
the instruments utilized to gather experimental data and a lack of uncer￾tainty propagation analysis for the calculated properties.
● Thermodynamic equilibrium. All codes are based on the assumption
of thermodynamic equilibrium for estimating fluids’ properties. This
assumption is a good approximation for steady-state and slow tran￾sients, but it fails at places with strong fluid acceleration or during fast
transients.
● Cubic equations of state. The cubic EOS is ubiquitous in multiphase flow
simulation for its simplicity and flexibility. However, cubic EOS has accu￾racy limitations in modeling the presence of more complex phenomena
(e.g. heavy-ends characterization, solids precipitation). Moreover, there is
debate as to the universal binary interaction coefficients required.❦
❦ ❦
❦
9.6 Future of Two-Phase Flow Simulations 207
● Intermittent flows modeling. There is appreciable uncertainty for esti￾mating slug frequency, slug length, and holdup for hydrodynamic and
terrain-induced slugging phenomena.
● Commercial code uncertainty reporting. Usually, commercial code does
not report the confidence level in the results, differentiated by source.
● Numerical errors. The integration of the partial differential equations
describing the multiphase flow performance depends on the accuracy
of the numerical algorithms (i.e. explicit, implicit, or semi-implicit), the
truncation and roundoff error propagation.
● System topology. Every simulation requires a faithful description of the
system geometry. The simulation of an existing system could be more reli￾able than the simulation of a system that is in the design stage.
Nonetheless, despite the list of weaknesses pointed out, the state-of-the-art
of simulating multiphase flow has progressed tremendously when com￾pared to the fully empirical black-box models published in the 1940–1950s.
The advanced status of modeling tools currently available is based on
physical phenomena, field measurements, inference from analogous cases,
and expanding the frontier knowledge with expanded databases.
9.6 Future of Two-Phase Flow Simulations
This section presents a personal point of view of incipient developments in
the field of multiphase flow in pipelines. Therefore, as a forewarning, this is
a biased vision of potentially dominating forthcoming trends.
The traditional way to predict two-phase flow performance in pipelines
is by programming algorithms derived from conservation principles (mass,
momentum, and energy), with fluid properties obtained through equations
of state manipulations, and with the help of closure equations and models
(e.g. friction factors, holdups among phases) of empirical origin. The sim￾ulation case is set up with proper boundary conditions (i.e. system’s inlet
and outlet properties) and with a specification of the initial state of the fluid
before running the programmed algorithms in the commercial code.
The weakness of the programmed simulation approach is the confidence
in the validity of the closure models and the predicted fluid properties, as
well as the certainty in representing the initial conditions of the overall sys￾tem. On top of those doubts, there are integration errors creeping in from
the application of the numerical scheme utilized. In summary, a simulation
result from a code always has an unknown degree of uncertainty despite the
remarkable effort put to develop such a tool and the necessary honed skills
of the program user.❦
❦ ❦
❦
208 9 Advanced Simulations
The state of the art in transient simulators, with the weaknesses, pointed
out before, has sparked an interest in alternative prediction methodologies
based on the extraction of patterns from large two-phase flow data sets.
The small-scale research laboratories and the semi-industrial scale test
facilities have been the established sources of two-phase flow data. How￾ever, the digitization phenomenon that has started to thrive in the oil and
gas industry in the last three decades has become a particularly important
source of field production data. This is the reason why the humongous
amount of data nowadays generated creates valuable data sets to “mine”
patterns and trends.
Data science (Kelleher and Tierney, 2018) is a field that combines prin￾ciples, algorithms, and processes in search of concealed patterns from
large data sets. The coined term data mining is often used interchangeably
with data science, although the focus of data mining is the extraction
and analysis of structured data and knowledge, somehow masked within
a vast amount of data. The objective of data mining is to transform the
dataset into a coherent structure for further use. Data mining involves data
management, pre-processing, modeling, metrics, and inference processes.
The digital data invading all fields of human activity have driven the
impressive size and complexity of data sets. The former manual procedure
of gathering experimental data has been replaced by inexpensive and
powerful computers.
ML (machine learning) is a novel approach to making use of the extracted
patterns and knowledge from a data set. ML can be defined (Kelleher and
Tierney, 2018) as a field of study that develops algorithms implemented
into computer programs in order to identify and extract patterns from data.
The field of machine learning encompasses the use of computer networks to
process pre-selected digital information with algorithms designed/chosen
by the data scientist. The vertiginous pace of machine learning evolution
has undergone notable and prolific algorithm representations/models
such as artificial neural networks (ANN), cluster analysis, convolutional
neural networks (CNN), regression analysis, genetic algorithms, knowl￾edge neural network (KNN), boosting algorithms, decision trees, and vector
machines. Fast computers with large storage capacity apply such specialized
algorithms in search of patterns to fulfill the data mining task.
ML is a gradual learning process (Alpaydin, 2021) in pursuit of an
optimized search performance of patterns. Therefore, similarly to the
knowledge evolution of human beings, the algorithms of the machine
learning process require training, either supervised or unsupervised.
Supervised learning is a mapping process from the inputs’ attributes into
the target attribute. The supervised process uses the data set as feedback to❦
❦ ❦
❦
9.6 Future of Two-Phase Flow Simulations 209
optimize the extraction model algorithm. This process is iterative, involving
many function trials seeking best mapping. As such, supervised learning
rests on the skills of the data scientist to choose appropriate models (i.e. pre￾ferred algorithms) introducing an element of learning bias. The supervised
learning process involves at least the following steps: example selection,
defining the input representation of the learned function, defining the
objective function of the learned function and learning algorithm, running
the learning algorithm on the gathered training set, assessing the error of
the objective function, and adjusting control parameters accordingly to
improve performance of the objective function. Supervised learning fits best
with numeric types of data sets.
Unsupervised learning is more akin to ordinal data sets (e.g. image
processing) rather than numeric data sets. The unsupervised learning
process has no target attribute, and the selected algorithms look for data
regularities, that is, subsets of the database that have similar characteristics.
One popular technique employed is cluster analysis which iteratively groups
the selected subsets and keeps redefining the similarities that identify the
groups. The optimization of the algorithm requires similarity metrics
during the learning process.
The training of machine algorithms is done with examples involving
well-defined inputs (independent variables) and dependent variable(s).
The highest value derived from machine learning is not the capacity to
duplicate (i.e. memorize) the data set during the training phase. Memo￾rizing code is nothing more than a “look-up” table algorithm that limits
the application exclusively to the training set. The highest value of ML lies
in the programming capacity to build by itself improved models capable
of predicting new performance scenarios beyond the training data set.
Such capacity for self-learning and self-improved performance toward new
challenges defines the objective of AI. It is important to highlight that
model improvement is an iterative and gradual process striving to achieve
optimum performance, very much as the human brain learns by trial and
error to succeed in more complex tasks.
The four more common techniques used in ML are Linear Regression,
ANN, CNN, and Decision Trees. Linear and Multi-Linear Regressions focus
on the output error defined in terms of the sum of the squared (SSE) errors
for each instance. The linear relations are weighed with parameters that are
changed until the SSE reaches a minimum. This process is also referred to
as the least square method. Obviously, this methodology is useful when the
data set shows linear trends.
ANN have become a favorite learning methodology to design extraction
algorithms. ANN mimics the human brain’s network activity whereby❦
❦ ❦
❦
210 9 Advanced Simulations
information processing and distribution are realized by communication
nodes (neurons) transmitting signals (i.e. inputs) replicating the synapsis
of the brain. Nevertheless, ANNs depart from the real brain because the
networks are static and symbolic, whereas the biological brain of most
living organisms is dynamic (plastic) and analog. In the ANN model, the
connection “signals” are real numbers, and the output of each neuron
is computed by some nonlinear functions (i.e. the activation functions)
applied to the sum of its inputs. Two of the frequent activation functions
used in ANN modeling are the hyperbolic tangent (tanh) and the logistic
functions (Kelleher and Tierney, 2018) because have limited outputs
regardless of infinity input. These inputs arriving at each neuron are
a weighted linear function from the originating neuron which, during
the course of the learning process, will be subject to numerous optimiz￾ing adjustments in pursuit of minimizing the error objective function
applied to the output signal. Thus, the resulting total input on each
neuron is a multiple-input linear-regression process. Neurons may have
thresholds that transmit signals when the aggregate signal overcomes
that threshold.
The ANN model comprises neurons collected into layers. The first layer
is always the input layer introducing the attributes from the input signals
taken from the data set. The last output layer may have one or more neurons,
from which the objective function to be optimized is attached to a single
of those neurons. In between the input/output layers, there may be several
“hidden” layers; depending on the complexity degree, the network is built
in. Figure 9.2 shows as an introductory example a simplified schematic of
a three-layer ANN, to clarify the role of the inputs to each neuron and the
applied activation functions.
Taking Figure 9.2 as an example that can be generalized to broader net￾works, inputs from the data set are represented by,
Im data inputs for m = 1, 2, 3, 4 (9.2)
The multi-input linear-regression functions and the variable weights
applied to the input signals are
multi-input linear-regression function: Ym,n = 𝜆m,n + 𝜔m,nIm (9.3)
𝜔m,n weight coefficient for inputs Im from hidden neurons n = 5, 6, 7
(9.4)
𝜆m,n independent weight coefficient from hidden neurons n = 5, 6, 7
(9.5)❦
❦ ❦
❦
9.6 Future of Two-Phase Flow Simulations 211
I
1
𝜔2,5
𝜔1,5
𝜔1,6
𝜔1,7
𝜔3,7
𝜔3,6
𝜔2,6
𝜔2,7
𝜔3,5
𝜔4,5
𝜔4,7
𝜔4,6
𝜔7,8
𝜔6,8
𝜔5,8 I
2
I
3
I
4
H5
H6
H7
O8 Output
Input layer Hidden layer Output layer
Figure 9.2 Simplified ANN schematic example.
The nonlinear functions resulting from applying activation functions
to the output signals departing the last hidden layer are represented
in equation (9.6). Notice the use of the hyperbolic tangent function to
characterize the nonlinear activation function.
Zp,8 = tanh(𝜔p,8Hp) =
exp(2𝜔p,8Hp) − 1
exp(2𝜔p,8Hp) + 1
for p = 5, 6, 7 (9.6)
The overall output from the example ANN in Figure 9.2 has been charac￾terized by the nonlinear logistic function as follows:
Output = logistic (
∑
p=7
p=5
𝜔p,8H8
)
= 1
1 + exp[−(𝜔5,8H5 + 𝜔6,8H6 + 𝜔7,8H7)] (9.7)
As pointed out before, the key step of ANN is the learning process from
the data set. This step follows after defining the number of hidden layers
and the output neuron(s), and the pre-selection of the algorithm methods
(e.g. linear regressions, activation functions) – the so-called learning bias
effect. This step involves starting from assumed initial weights on the input
functions to initiate the iterative optimization that minimizes the error in❦
❦ ❦
❦
212 9 Advanced Simulations
the output objective function. The optimization process requires that the
error-minimization function propagates upstream to the rest of the network
neurons. The propagation process algorithm that accomplishes this task is
the backpropagation. However, the upstream perturbation effect causes the
re-adjustment of all the weights 𝜔m,n for all the input functions, to a greater
or lesser extent depending on the optimization scheme. Hence, after many
iteration cycles back-to-forth adjusting the weights, a culled set of constants
emerges minimizing the output error. At this point, the data scientist may
feel confident that the ANN has reproduced the data set as best as possible.
The next step after completing the initial learning process is to validate the
models obtained. For this purpose, the full data set should have been previ￾ously separated into three subsets: the learning subset, the validation subset,
and the test subset. The “unseen” data in the validation data subset provide
an authentication of the learning process or may pinpoint necessary error
adjustments. In the latter case, the two subsets, learning and validation, are
combined and the learning process is repeated with such an expanded data
set. Following the second optimization, if necessary, prepares the ANN for
real prediction testing with the last data subset. This stage will yield an esti￾mate of the accuracy of the machine learning overall process by evaluating
the output error against real data. There is criterion freedom to split the total
data set into three subsets; some researchers use 50, 30, and 20% ratios when
the data set is fully accurate and comprehensive. Other people prefer 40, 25,
and 35% for added weight on prediction capability. In any case, there are
no rigid rules in this regard. In any event, any ANN process will involve
sample bias.
When the number of hidden layers is large, the learning process takes
another twist. This is called deep learning and might involve supervised
semi-supervised or unsupervised learning. Deep learning adopts several
methodologies such as networks, deep belief networks, deep reinforcement
learning, recurrent neural networks, and CNN that have been successfully
utilized in several other fields involving image recognition.
The decision tree (DT) technique is a powerful way to identify a structure or
pattern within a nominal or ordinal data set. The technique works on mak￾ing path decisions based on key inquiring of the data. The binary character
of the process sets a clear-cut way to go through the learning data set.
Despite the very promising developments to date in machine learning
artificial intelligence, there are some challenges. Aside from the challenges
of sample bias, data pre-processing, and learning bias, one other signifi￾cant challenge is the concept drift caused by the stationary assumption.
The latter is the common assumption that large comprehensive data sets
do not change over time. Data sets do change, requiring machine learning❦
❦ ❦
❦
9.6 Future of Two-Phase Flow Simulations 213
algorithms’ re-training from time to time to keep up with evolution. The list
of challenges for machine learning includes additional topics such as
nonlinearities, function complexity, bias-variance tradeoff, the sufficiency
of training data, data heterogeneity, the dimensionality of input space, and
very importantly output noise.
There are some examples of the application of machine learning tech￾niques to the field of two-phase flow. The following examples include a vari￾ety of other methodologies not described in this section for which the reader
should consult the addressed references.
Khamis et al. (2020) published a paper focused on the optimization of
choke-valve size for oil and gas flow, using artificial intelligence instead of
the customary deterministic set of available correlations. AI was chosen to
assess the optimum choke size to deliver a specified two-phase flow rate.
The AI techniques considered in this study were a six-layer ANN, fuzzy logic
(FL) with a genetic optimization algorithm, support vector machines (SVM)
and functional networks (FN). The resulting comparison of the testing
correlation coefficients among the methodologies yielded the following
predictability confidence coefficients R: 99.7% (SVM), 84.0% (ANN), 81.0%
(FL), and 81.0% (FN).
Arteaga-Arteaga et al. (2021) work on ML applications to predict two￾phase flow patterns centered on ML algorithms and deep learning to
address the intricate classification problem. The input variables considered
include phases’ superficial velocities, viscosities, densities, and superficial
tension. Two important additional inputs included were the angle of incli￾nation of the pipe, the flow orientation (horizontal, upflow/downflow), and
the internal diameter. Twelve databases (9029 instances) were combined
to perform the training and testing of the algorithms. The ML models
considered included ANN, CNN, Extra Trees (ET), Random Forest (RF),
Gradient Boosting (GB), SVM, DT, KNN, QDA, GNB, and AB. The Extra
Trees (ET) model classified best the data set flow patterns with the highest
degree of fidelity, achieving a confidence coefficient R of 98.8%.
A third example is the work by Alamoudi et al. (2021). In this paper, the
focus was detecting the thickness of depositing scale solids, using the gamma
attenuation technique, over the inner wall of pipes conveying two-phase oil
and gas. Three flow patterns were investigated in this study, namely strati￾fied, homogeneous, and annular flow. The void fraction for the two-phase
flow varied between 10% and 85%. The ML methodology used is the RBFNN
which is a combination of the radial basis function (RBF), a type of neural
network technique (to process the input data), followed by a neural network
algorithm. The successful application of AI to this problem yielded a train￾ing data confidence coefficient R of 98.4% and a testing-data confidence of❦
❦ ❦
❦
214 9 Advanced Simulations
98.7%. Such excellent results prove that the ML approach properly carried
out surpasses any deterministic modeling.
The last example (Ruiz-Diaz et al., 2021) in this section concerns a
two-phase liquid–liquid application of oil and water flow. The work used
an adaptive neuro-fuzzy inference (ANFIS) procedure jointly with ANN to
predict the holdup of a water and oil mixture through vertical pipes. The
input parameters used were the pipe’s internal diameter, surface velocities,
and oil viscosity. The data set for training and testing comprised 722
instances. The best ANN model generated had a hidden layer comprising
12 neurons and using the Levenberg–Marquardt training function with the
TanSig activation function. The confidence coefficient R was a remarkable
99.9%. Once more the extraordinary results for this AI application confirm
the power of this emerging field for oil and gas production systems.
9.7 Simulation Philosophies
At this point, it is convenient to review high-level simulation philosophies
for steady-state and transient two-phase flow. We could split the philoso￾phies into programming versus learning. The programming philosophy
seeks to create models based on conservation principles complemented
by semi-empirical closure equations, to match the number of equations
to the number of unknowns. This has been the conventional approach
followed during the past 80 years, yielding the superb commercial codes
currently available, despite the drawbacks pointed out in Section 9.5.
This programming philosophy is a deterministic viewpoint.
On the other hand, the learning philosophy emphasis is on using up the
hidden patterns and structures of reliable data sets comprising numerous
instances of accurate field measurement data. The discovery of performance
patterns allows to create particularly useful algorithms that with remarkable
accuracy are capable of predicting new performance through a proper learn￾ing, validation, and testing process. We confirmed the excellent predictabil￾ity of two-phase flow results with a small sample of examples introduced in
Section 9.6.
References
Alamoudi, M., Sattari, M., Balubaid, M. et al. (2021). Application of Gamma
Attenuation Technique and Artificial Intelligence to Detect Scale Thickness
in Pipelines in Which Two-Phase Flows with Differential Flow Regimes and
Void Fractions Exists. Symmetry 13 (1198): 1–16.❦
❦ ❦
❦
References 215
Alpaydin, E. (2021). Machine Learning. Cambridge, Massachusetts, USA: The
MIT Press Essential Knowledge Series.
Arteaga-Arteaga, H., Mora-Rubio, A., Florez, F. et al. (2021). Machine Learning
Applications to Predict Two-Phase Flow Patterns. PeerJ Comput. Sci. 7: e798.
DOI 10.7717/peerj-cs.798.
Khamis, M., Elhaj, M., and Abdulraheem, A. (2020). Optimization of Choke
Size for Two-Phase Flow Using Artificial Intelligence. J. Pet. Explor. Prod.
Technol. 10: 487–500.
Kelleher, J. and Tierney, B. (2018). Data Science. Cambridge, Massachusetts,
USA: The MIT Press Essential Knowledge Series.
Pletcher, R., Tannehill, J., and Anderson, D. (2013). Computational Fluid
Mechanics and Heat Transfer, vol. 3. Boca Raton, Florida, USA: CRC Press.
Patankar, S. (1980). Numerical Heat Transfer and Fluid Flow. New York, New
York, USA: Hemisphere Publishing Corporation.
Ruiz-Diaz, M., Hernández-Cely, M., and González-Estrada, O. (2021). Analysis
of Liquid-Liquid (Wáter and Oil) Two-Phase Flow in Vertical Pipes,
Applying Artificial Intelligence Techniques. J. Phys. Conf. Ser. 2046: 1–7.❦
❦ ❦
❦❦
❦ ❦
❦
217
10
Multiphase Flow Simulations
10.1 Introduction: Simulation Challenges
Multiphase flow refers to the simultaneous flow of three different fluids,
typically gas, liquid hydrocarbon, and water, in a single system. In oil and
gas systems, a two-phase flow occurs when liquid and gas are produced
from a reservoir and transported through pipelines to processing facilities.
Numerical simulation of multiphase flow is an essential tool for predicting
the behavior of oil and gas systems and for optimizing their design and
operation.
The simulation of multiphase flow is a complex task that presents several
challenges. Examples include modeling the interaction between the phases,
fluid phase change along the system, interaction of the gas and liquid
phases with the wall under the different flow regimes, and others. In
addition, there are numerical challenges related to the discretization of
the governing equations, the selection of appropriate boundary and initial
conditions, and the solution of nonlinear equations.
This chapter provides an overview of the challenges involved in numer￾ical multiphase simulation in oil and gas systems. We begin by discussing
the fundamental concepts of two-phase flow and the mathematical mod￾els used to describe it. We then highlight some of the critical challenges in
the numerical simulation of two-phase flow, including modeling, numeri￾cal, and computational challenges.
10.1.1 Mathematical Models for Two-Phase Flow Simulation
The mathematical models used to describe two-phase flow depend on the
type of flow regime and the nature of the fluids. In general, two-phase flow
in horizontal sections can be classified into four regimes: stratified, bubble,
slug, and annular flow. In bubble flow, small gas bubbles are dispersed in the
Multiphase Transport of Hydrocarbons in Pipes, First Edition.
Juan J. Manzano-Ruiz and Jose G. Carballo.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
Companion Website: www.wiley.com/go/Manzano-Ruiz/Multiphasetransport❦
❦ ❦
❦
218 10 Multiphase Flow Simulations
liquid phase. In slug flow, the gas phase forms elongated bubbles separated
by liquid slugs. In annular flow, the liquid phase forms a continuous ring
around the gas phase. In stratified flow, the liquid flows in a layer below the
gas phase. In vertical flow, only bubble, slug, and annular flow are possible.
For each of these regimes, different mathematical models are used to
describe the behavior of the two phases. In general, the governing equations
for two-phase flow include the continuity equation, the momentum
equation, and the energy equation. These equations are coupled through
the interfacial forces that exist between the two phases.
10.1.2 Challenges in Two-Phase Flow Simulation
Simulation of two-phase flow presents several challenges related to model￾ing, numerical, and computational aspects. These challenges are discussed
in more detail below.
Some of the modeling challenges in multiphase flow simulation include
the following:
● Interfacial Phenomena: The interaction between the phases is complex
and involves several interfacial phenomena, such as surface tension, wet￾ting, and capillary forces. Modeling these phenomena requires accurate
measurement and modeling of interfacial properties, which can be diffi￾cult to obtain experimentally.
● Phase Change: Phase change is a critical aspect of multiphase flow, par￾ticularly in oil and gas systems. The phase change occurs when the fluid
undergoes a change in state, such as from liquid to gas or vice versa. Accu￾rate modeling of phase change requires knowledge of the thermodynamic
properties of the fluids.
The numerical simulation of multiphase flow also presents several
challenges related to the discretization of the governing equations, the
selection of appropriate boundary conditions, and the solution of nonlinear
equations. The numerical methodology used in the simulation has an
important effect on the computation time.
10.1.3 Results Validation
Numerical simulation of two-phase flow is an essential tool for predicting
the behavior of oil and gas systems and optimizing their design and opera￾tion. However, the accuracy of the simulation results is critical for reliable
decision-making, and it is important, if possible, to validate these results❦
❦ ❦
❦
10.1 Introduction: Simulation Challenges 219
against experimental data. In this chapter, we discuss the challenges associ￾ated with validating simulation results with data gathered in the field.
Validation of numerical simulation results requires experimental data
that accurately represent the physical behavior of the system. In oil and
gas systems, the data can be obtained from various sources, including
field measurements, laboratory experiments, and pilot plant tests. The
data can include flow rates, pressure drops, temperature profiles, and fluid
properties such as density, viscosity, and interfacial surface tension.
Validation of numerical simulation results is a difficult task. The main
challenges in this regard include the following:
● Variability in experimental data: The experimental data obtained from the
field can be affected by various sources of variability, such as measurement
errors, changes in operating conditions, and natural variations in the sys￾tem (e.g. fluid composition change). These sources of variability can make
it difficult to identify and isolate the sources of discrepancies between the
simulation results and the experimental data.
● Sensitivity to model parameters: Numerical simulations use several model
parameters, such as transport fluid properties, interfacial tension, and
wall friction. These parameters can have a significant impact on the
simulation results and are difficult to measure. Small changes in the
model parameters can result in significant differences in the simulation
results, making it untenable to validate the simulation results.
● Intricate system dynamics: Oil and gas systems can exhibit complex
system dynamics (including nonlinear behavior, phase transitions, and
multiphase flow regimes) that exacerbate the difficulty to validate the
simulation results against experimental data.
Despite the challenges involved in validation, several approaches can be
used to validate the numerical simulation results. These approaches include
the following:
● Key Performance Indicators (KPIs): Key performance indicators can be
used to compare the simulation results with the experimental data.
KPIs can include flow rates, pressure drops, temperature profiles, and
fluid properties such as density and viscosity. Comparison of KPIs can
help to identify discrepancies between the simulation results and the
experimental data.
● Sensitivity Analysis: Sensitivity analysis can be used to assess the impact of
model parameters on the simulation results. Sensitivity analysis involves
varying the model parameters over a range of values and observing the
effect on the simulation results. This approach can help to identify the
criticalness of specific parameters in the simulation results.❦
❦ ❦
❦
220 10 Multiphase Flow Simulations
● Model Calibration: Model calibration involves adjusting the model param￾eters to improve the agreement between the simulation results and the
experimental data. Model calibration requires a thorough understanding
of the system dynamics and the accuracy of the experimental data. This
approach can help to improve the accuracy of the numerical model and
increase confidence in the simulation results, in particular, when field
data are available.
10.2 Multiphase Flow Simulation Considerations
Developing an accurate model that represents the physics of the process
and delivers results in a reasonable amount of time is the objective of a
multiphase flow simulation. This section addresses some of the concerns
to develop a multiphase flow simulation model.
10.2.1 Integration Time Step
In numerical methods for solving systems of partial differential equations
(PDEs), the time step plays a crucial role in determining the accuracy and
stability of the solution. The time step refers to the size of the intervals
between two consecutive time iterations, which are used to discretize the
equations in the time domain.
The size of the time step must be appropriate for the phenomena studied.
For instance, in water hammer simulations, the time step scales with the
speed of sound of the fluid being studied. In slow transients, such as during
a well ramp-up, the time step could be larger than that of a water hammer.
Choosing an inappropriate time step size could lead to unrealistic results or
to instability in the simulation.
The stability of the time step is also crucial. Some commercial simulators
attempt to optimize (i.e. increase) the time step based on certain parameters
within a determined range. For example, a slow transient simulation with a
constant time step of 0.15 seconds will generally produce better results than
a simulation whose time step is constantly oscillating between 0.001 and
0.10 seconds.
In general, using a smaller time step can increase the simulation time and
the accuracy of the results, all else being equal. However, there are some
exceptions to this rule. For instance, a very small time step may be prone
to round-off errors that can result in inaccurate results. Conversely, using a
larger time step can decrease the simulation time but may also reduce the
accuracy of the results. Increasing the time step should be done carefully in❦
❦ ❦
❦
10.2 Multiphase Flow Simulation Considerations 221
many simulators. If the time step is too large and the simulator does not con￾verge, the time step may be automatically reduced, and the simulated time
step may be repeated, significantly increasing the overall simulation time.
10.2.2 CFL Condition
The Courant–Friedrichs–Lewy (CFL) condition,see Pletcher et al. (2013), is a
mathematical stability constraint relating the time step and the spatial mesh
spacing applicable to PDEs. The condition is named after Courant et al.
(1928), who first proposed this condition as a means of ensuring stability in
numerical simulations of wave propagation. The CFL condition has become
a fundamental requirement for numerical simulations of hyperbolic PDEs
in various fields, including fluid dynamics, electromagnetics, acoustics, and
structural mechanics.
In multiphase flow simulations, for example, the CFL condition is used
to determine the maximum allowable time step size based on the local flow
velocities and the grid size. In multiphase flow simulation, the time step
should be small enough so that a fluid particle cannot travel more than one
cell in a one-time step.
10.2.3 Round-off Error
Round-off errors are a common issue in numerical simulations, especially
when dealing with large-scale problems that require high precision. These
errors arise due to the finite precision of the numerical representation of real
numbers in computers.
In numerical simulations, numbers are represented as floating-point
numbers with a finite number of digits. As a result, certain numbers cannot
be represented exactly, and small errors may occur in the calculations.
These errors can accumulate (i.e. creep in) over time and affect the accuracy
of the solution.
Round-off errors can be minimized by using higher precision data types
or by implementing numerical algorithms that are less sensitive to rounding
errors. In some cases, it may also be possible to scale the problem or change
the units to reduce the magnitude of the numbers involved and minimize
the effects of round-off errors.
Creating a suitable flowline segmentation and time step is essential for
minimizing round-off errors in numerical simulations. The flowline grid
segmentation refers to the number and size of the segments used to dis￾cretize the domain of the problem. A small segment size can help to capture
more details of the solution, but it may also increase the computational time❦
❦ ❦
❦
222 10 Multiphase Flow Simulations
and round-off errors due to the limited precision of the computer’s arith￾metic operations in extreme cases.
10.2.4 Geometry Representation
Reliable results in flowline simulations require accurate geometry rep￾resentation. In practice, the real geometry of the flowline may be too
complicated, and a simplified model of bathymetry or pipeline routing may
be necessary to avoid excessive computational time. This can be particularly
important for long flowlines where a high-resolution simulation of the
entire bathymetry may be impractical.
An oversimplification of the geometry can result in inaccurate simula￾tion results. For example, the simplified bathymetry may not accurately
capture the variations in the flowline geometry, which can lead to sig￾nificant errors in the pressure drop and liquid distributions, these errors
are particularly important in the gravity dominated regions where the
flow velocity is low. An example of such geometry is the low points (i.e.
valleys) found on quasi-horizontal flowlines, which at low two-phase flow
rates tend to accumulate and leave behind liquids at those low points.
Therefore, there is a trade-off balance between the level of detail in the
simulation and the computational resources required to perform the
simulation.
There are several methods to simplify geometry; these methods may
involve a combination of predetermined mathematical procedures, engi￾neering judgment, and overall observation of the available data. Regardless
of the method used, it is essential to validate the geometry selection by
comparing the main simulation results among different degrees of flowline
segmentations.
10.2.5 Cell-Size Ratio - the Ratio of “2”
It is generally recommended that the volume of two sequential cells
be approximately the same volume to avoid large differences in the
resolution between neighboring cells. Large differences in cell size can
lead to inaccurate results and may introduce numerical errors in the
simulation.
In practice, it may not be possible to have cells of equal size along the
entire flowline; in such cases, it is recommended to ensure that the volume
ratio of adjoining cells is between 0.5 and 2, a ratio widely used in the oil
industry.❦
❦ ❦
❦
10.2 Multiphase Flow Simulation Considerations 223
10.2.6 Dispersion Effects
In the numerical simulation of sharp front displacement processes (e.g.
fast wave phenomena), dispersion effects can occur due to the numerical
approximation of the governing equations and will lead to the smearing of
the front and uncertainties in the displacement process.
One approach to reduce, but not completely eliminate, the dispersion
effect is to decrease the size of the flowline segmentation and the time step;
in this way the resolution of the simulation can be increased, allowing for a
more accurate representation of the sharp front displacement process.
It is recommended to validate the results of the simulation against experi￾mental or field data, if possible, to adjust the flowline segmentation and time
step accordingly.
10.2.7 Constant Composition Versus Compositional Simulation
Simulations can be run as constant composition or as compositional sim￾ulations. Constant composition simulations assume that the total fluid
composition is constant in every cell and every time step. While the total
composition is constant, the relative gas and liquid amounts do change
as a function of the pressure and temperature in every flowline segment.
Additionally, thermodynamic equilibrium is assumed in every cell. For
instance, a flowline in steady-state production conditions can be simulated
as a constant composition system even if the pressure and temperature
(and therefore the relative gas–liquid amounts and properties) change
in every cell. This constant composition assumption simplifies the sim￾ulation process and reduces the computational time required to obtain
results.
In contrast, there are operations where the overall composition is chang￾ing. In a multiphase flowline depressurization, the composition of the fluids
in the flowline changes with every time step. In these cases, a compositional
simulation may be required to obtain detailed results of how the composition
changes in the flowline with respect to time.
Compositional simulations are more time-consuming than constant com￾position simulations. In a compositional simulation, a flash calculation is
performed in every segment at every time step, and the computational time
required to obtain results from a compositional simulation can be signifi￾cantly larger than that of a constant composition simulation. The number
of components used in a compositional simulation will have a large impact
on the total simulation time, as well as the option of having a three-phase
flash will also greatly affect the simulation time.❦
❦ ❦
❦
224 10 Multiphase Flow Simulations
Thermodynamic equilibrium is also commonly presupposed for composi￾tional simulations. This assumption can be manually overridden to assume
a certain degree of nonequilibrium if data are available.
It is important to note that compositional simulations can potentially be
more unstable and therefore prone to a certain degree of inaccuracy even in
the most benign cases.
It is the opinion of the authors that a fully compositional simulation is only
worth it in very limited and special cases where the predictions of the com￾position of the fluid are required for nonconstant composition cases. In most
cases, however, constant composition simulations are sufficient to predict
the overall behavior of fluids in pipelines and wells. In most practical cases,
having an approximate result with a clear idea of the margin of error asso￾ciated is more important than a supposedly “more accurate” compositional
simulation.
10.2.8 Initial Conditions
When running a transient multiphase flow simulation, the initial conditions
can greatly impact the accuracy and stability of the results. It is important to
ensure that the initial conditions are appropriate to avoid instabilities.
The first type of initial conditions is the user-provided initial conditions.
This involves manually setting the initial conditions such as the flow rates,
pressure, temperature, and holdup at the start of the simulation. While this
method is straightforward, it is often not accurate enough, and errors may
propagate through the simulation.
The second type of initial condition is when the system is flowing at
steady-state conditions. In this case, the simulation starts at a point where
the flow rates, pressures, and temperatures have reached steady-state con￾ditions. The simulator steady-state preprocessor can be a great initialization
tool for most cases, but in others, serious errors or “not-convergence” of
this tool can lead to completely unrealistic results.
The third type of initial condition is restarting from the last point of a
previous simulation. This method involves using, in most cases, the last sim￾ulated time of a previous case as the initial condition for a new simulation.
This method can be useful when running long or complex simulations.
10.2.9 Deepwater Settings
Deepwater settings present unique challenges for oil and gas systems due
to the possibly harsh operating conditions, remote location, and involved
geological structures. Multiphase flow simulation can be a valuable tool for
designing and optimizing multiphase flow systems in deepwater settings.❦
❦ ❦
❦
10.4 Production Wells Simulation 225
Some of the specific applications of multiphase flow simulation in deepwa￾ter settings include the following:
● Well performance: Simulations can evaluate the performance of individ￾ual wells in deepwater settings. This includes evaluating well productivity,
optimizing wellbore and completion designs, and identifying opportuni￾ties for artificial lift.
● Subsea production systems: Multiphase flow simulation can be used to
design and optimize subsea production systems. This includes selecting
flowline diameters, designing subsea manifolds, and assessing the use of
subsea processing and separation facilities.
● Subsea export pipelines: Simulations enable the design and optimization
of subsea export pipeline systems. This includes selecting pipeline diame￾ters, designing pipeline routes, and optimizing pumping and compressor
stations.
10.3 Multiphase Flow Applications
In this chapter, we discuss some typical multiphase flow applications to
illustrate how engineering companies and oil operators utilize simulation
for the design and operation of multiphase flow systems. At a high level, the
applications can be ascribed to the two following categories:
● Design and optimization of oil and gas production systems: Multiphase
flow simulation can be used to optimize the design and operation of
oil and gas production systems. This includes designing wellbore con￾figurations, selecting flowline diameters, and designing separation and
processing facilities.
● Prediction of flow assurance issues: Field production operations can be sim￾ulated to predict and mitigate flow assurance issues, such as hydrate for￾mation, wax deposition, and scale buildup. By modeling the fluid flow
and heat transfer within the system, the engineer can predict where these
issues are likely to occur and suggest preventative measures.
The following subsections describe representative production system
applications and include examples to illustrate simulation performance.
10.4 Production Wells Simulation
The objective of multiphase flow simulations for wells is to try to achieve
production target rates and minimize the risk of flow assurance issues. Some
of the key parameters that are typically modeled include the following:❦
❦ ❦
❦
226 10 Multiphase Flow Simulations
● Pressure and temperature profiles: Pressure and temperature profiles are
critical to understanding the flow behavior within the production well,
which determines the phase equilibrium and the fluids’ properties as a
function of the well’s depth.
● Flow rates: Predicting the flow rates of oil, gas, and water within the pro￾duction well’s string is critical to optimizing production rates and mini￾mizing the risk of flow assurance issues. Oil and gas flow rates are vital to
keeping track of performance and cumulative reserves produced.
● Flow regimes: The flow regime in a production well can have a significant
impact on the flow behavior and the risk of flow assurance issues due to
the different flow patterns.
● Production tubing and completion systems: Simulation is the proper means
to predict the flow behavior within the tubing and ensure that the system
size is designed to minimize the risk of flow assurance issues.
Multiphase flow simulation can be used to study various aspects of well
start-up, including the following:
● Slug Flow: Slug flow is a common flow regime that can occur during well
start-up, especially in long horizontal or highly deviated wells. In slug
flow, the liquid and gas phases alternate in the wellbore, resulting in large
pressure fluctuations and potential damage to the wellbore and surface
equipment. The simulation can be used to predict the onset of slug flow
and optimize the flow rate (e.g. through tree choke management) and
wellbore design to prevent slug flow from occurring.
● Flow Assurance: During well start-up, the temperature and pressure con￾ditions can change rapidly, which can lead to flow assurance issues such
as hydrate formation, wax deposition, and asphaltene precipitation.
● Wellbore and Surface Equipment Design: The simulation can be used
to optimize the location and design of choke valves, to control well￾bore performance and surface equipment during slug flow or pressure
fluctuations.
● Well clean-up: The simulation can predict and monitor in real time the
behavior of fluids during the clean-up process, including the velocity and
pressure of fluids, and the impact of fluid properties and flow rates on
the overall clean-up efficiency. By simulating different clean-up scenar￾ios, engineers can determine the most efficient and effective clean-up
procedure.
Well shutdown is an essential operation in the life cycle of a production
well. It can be either planned or unplanned. A planned shutdown is usu￾ally scheduled for routine maintenance, equipment inspection, or to per￾form interventions such as stimulation or workovers. On the other hand, an❦
❦ ❦
❦
10.4 Production Wells Simulation 227
unplanned shutdown can happen due to equipment failure, safety concerns,
or production issues.
During a well shutdown, it is essential to ensure that the well and sur￾rounding equipment are preserved and protected from blockage. One of the
main concerns in subsea wells is the formation of hydrates, which can occur
when gas and water mix at low temperatures and high pressure. Hydrates
can form in the wellbore and flow lines, obstructing the flow of fluids and
causing deferred production.
To prevent hydrate formation, methanol injection is commonly used.
Methanol is a chemical that acts as a hydrate inhibitor, preventing the
formation of hydrates in the wellbore and flow lines. Methanol can be
injected continuously or intermittently, depending on the well’s operating
conditions and the risk of hydrate formation.
The injection of methanol is usually done through the wellhead and the
tree components, which are the valves and fittings that control the flow of
fluids from the wellbore to the surface. These components are particularly
susceptible to hydrate formation due to their proximity to the wellbore and
their exposure to low temperatures (e.g. for deepwater systems) and high
pressures.
The well shutdown procedure can be simulated to minimize flow assur￾ance risks, including the injection of methanol (i.e. bullheading operation)
to prevent hydrate formation.
10.4.1 Onshore Well Operating in Steady State
In this section, we provide an example of onshore well simulation.
Table 10.1 summarizes the parameters of a simulated deviated well, the
production fluids, and the delivery point at a surface separator near the well￾head. Well’s elevations are expressed with respect to a datum located at the
wellhead elevation.
Figure 10.1 shows the well geometry as a function of the horizontal length
and as a function of the total length. In this chapter, the simulated results
are presented as a function of the total well length for a better appreciation
of the results.
Figure 10.2 shows the steady-state operating conditions of the simulated
well when flowing 8,000 blpd, The color lines represent the parameter pro￾files, and the black dotted line represents the well’s elevation curve. In all
graphs, the well geometry is represented as the black dotted line.
During steady-state conditions, the wellhead temperature is approx￾imately 150 ∘F. The bottom-hole flowing pressure is 2900 psia, and the❦
❦ ❦
❦
228 10 Multiphase Flow Simulations
Table 10.1 Simulated well characteristics—Onshore well.
Well location Onshore
Well type Build and hold (“J” Shape)
Well overall heat transfer
coefficient (OHTC)
1.6 btu/ft2 h ∘F (based on ID)
Well internal diameter (ID) 6.456 in.
Wellhead elevation 0 ft
Well kick-off point (KOP) 2,000 ft
Well bottom-hole elevation 7,000 ft (true vertical depth—TVD)
Extended reach (horizontally) 5,200 ft
Well tubing internal roughness 0.0018 in.
Static bottom-hole pressure (SBHP) 3,700 psia
Bottom-hole temperature 190 ∘F
Well brine density 74.9 lb/ft3
Well brine viscosity 7 cP
Well liquid productivity index (PI) 10 stb/day-psi
Target reservoir drawdown 800 psi
Geothermal gradient 70 ∘F @ wellhead level; 190 ∘F @
TVD
Reservoir fluid Black oil
Fluid gas–oil ratio (GOR) 422 scf/stb
Fluid API 27∘ API
Fluid water cut (%) 5%
Well choke CV curve Linear curve. CV fully open:
200 gpm/(psi)0.5
Separator pressure @ wellhead
(steady state)
500 psia
Steady-state well flow rate Liquid Rate: 8,000 stb/d
Water Rate: 400 stb/d
Oil Rate: 7,600 stb/d
Gas Rate: 3.2 mmscfd
wellhead flowing pressure downstream of the choke is 500 psia. The well
drawdown at this condition is 800 psi.
Note that at about 6,000 ft gas flashes out of solution, and the liquid holdup
and water holdup decrease as a result.❦
❦ ❦
❦
10.4 Production Wells Simulation 229
Well geometry
Horizontal length (ft)
Well total length (ft)
Well head
Well head
Bottom hole
Bottom hole
Elevation (ft) Elevation (ft)
2,000
0
0 1,000 2,000 3,000 4,000 5,000 6,000
0 1,000 2,000 3,000 4,000 5,000 6,000 7,000 8,000 9,000 10,000
‒2,000
‒4,000
‒6,000
‒8,000
2,000
0
‒2,000
‒4,000
‒6,000
‒8,000
Figure 10.1 Well geometry example.
10.4.2 Onshore Well Initial Start-up Example
After the well described in Table 10.1 is drilled and completed, the well
is left filled with completion fluid. In this section, it will be assumed that
the completion fluid is a brine (10 ppg density). The well is closed at the
wellhead. The normal wellhead flowing pressure is 500 psia. The reservoir
static pressure is 3700 psia. Initially, the well is filled with brine, producing
a bottom-hole hydrostatic pressure of approximately 3550 psi, and therefore
initially the wellhead pressure of the brine-filled well is about 150 psia,
which is below the normal operating wellhead pressure of the well (i.e.
500 psia). Under these conditions to start up the well, the wellhead pressure
has to be lowered below 150 psia, which means that the backpressure
imposed by the gathering system needs to be reduced.
The schedule shown in Table 10.2 was followed for the well start-up
simulation.
Figure 10.3 shows the well pressure at three locations: bottom hole, well￾head upstream the choke, and jumper downstream the choke; the choke
opening is also shown. The jumper is the connection between the well’s
tree and either a manifold or a flowline. The gray line shows that for the
first 45 minutes, the jumper pressure was lowered to 100 psi. Between 0.75
and 2 hours, the jumper pressure is increased from 100 to 500 psia, its nor￾mal operating level. After the second hour, the jumper pressure remains at
500 psia until the end of the simulation.❦
❦ ❦
❦
230 10 Multiphase Flow Simulations
0 2,000 4,000 6,000 8,000 10,000
0 2,000 4,000 6,000 8,000 10,000
0 2,000 4,000 6,000 8,000 10,000
0 2,000 4,000 6,000 8,000 10,000
0 2,000 4,000 6,000
Well total length (ft)
Well total length (ft)
Well total length (ft)
Well total length (ft)
Well total length (ft)
8,000 10,000
4,000 2,000
3,000
Pressure (psia) 2,000
1,000
0
200
190
180
Temperature (°F) Liquid hold-up (‒) Water hold-up (‒) EVR [
C = 100] (‒) 170
160
150
1
0.8
0.6
0.4
0.2
0
1
0.8
0.6
0.4
0.2
0
1
0.8
0.6
0.4
0.2
0
0
‒4,000
‒2,000
‒6,000
‒8,000
2,000
0
‒2,000
‒4,000
‒6,000
‒8,000
2,000
0
‒2,000
‒4,000
‒6,000
‒8,000
Elevation (ft) Elevation (ft) Elevation (ft)
2,000
0
‒2,000
‒4,000
‒6,000
‒8,000
Elevation (ft)
2,000
0
‒2,000
‒4,000
‒6,000
‒8,000
Elevation (ft)
Figure 10.2 Principal parameters profiles for a liquid rate of 8,000 blpd.❦
❦ ❦
❦
10.4 Production Wells Simulation 231
Table 10.2 Initial well start-up schedule.
Stage Initial time (h) Final time (h) Liquid flow (blpd) Well drawdown (psi)
Initial flow 0 8 2,000 200
Flow 2 8 14 4,000 400
Flow 3 14 20 6,000 600
Flow 4 20 8,000 800
4,000
3,500
3,000
2,500
2,000
1,500
1,000
500
0 0
0.25
0.5
0.75
1
0 5 10 15 20
Time (h)
Bottom hole Well head Jumper
Well pressures and choke opening during well
start-up
25 30 35 40
Pressure (psia)
Valve opening (‒)
Valve opening
Figure 10.3 Well pressures and choke opening during the well initial start-up.
The well choke (yellow line) remains completely opened (100%) during
the first 2 hours of the well start-up. At hour 2, the well choke is quickly
lowered to about 2.5% to maintain the reservoir drawdown at 200 psi during
the first 8 hours. At hours 8, 14, and 20, the well choke opening is increased
respectively to 4%, 8%, and 17% to maintain the scheduled drawdown
shown in Table 10.1. The rapid decrease in the well choke opening at hour 2
coincides with the arrival of gas to the surface facilities. This initial behavior
is characteristic of many natural-producing wells. The blue line shows the
bottom-hole flowing pressure, changing to follow the 200 psi drawdown
steps’ guideline.
The orange line represents the wellhead flowing pressure upstream of
the choke (WHFP), for the first 2 hours (while the choke is fully opened),❦
❦ ❦
❦
232 10 Multiphase Flow Simulations
8,000
9,000
7,000
6,000
5,000
4,000
3,000
2,000
1,000
0
0 5 10 15 20
Bottom hole liquid rate Well head water phase rate
Well head gas rate
Time (h)
Well flow trend during start-up
25 30 35 40
0
1
2
3
4
5
6
7
8
9
Liquid or water rate (bpd)
Gas rate (MMSCFD/d)
Figure 10.4 Well flow rates during the well initial start-up.
basically matches the jumper pressure. After hour 2, the WHFP reaches
about 900 psi during the initial flow period, and at flow period 4 (liquid rate
of 8,000 blpd), the WHFP reaches about 600 psi.
Figure 10.4 shows the flow rates associated with the initial well start-up.
The orange line shows the bottom-hole flow rate, where 2,000 blpd flow
steps can be observed at 0, 8, 14, and 20 hours. The blue line represents
the water phase flowing at wellhead conditions, showing a distinctive initial
water phase burst (brine exiting the well) between 0 and 2 hours. Note that
while the initial 2,000 blpd are being produced at the bottom hole, the water
flow rate at the wellhead is larger than that, which is due to the removal of
the brine and the gas expanding in the well as it travels through the tubing.
The red line represents the wellhead gas rate production, with gas break￾through occurring in about 2 hours.
Figure 10.5 shows the well temperature during the initial well ramp-up. In
this graph, the blue line shows the bottom-hole flowing temperature, in this
case, 190 ∘F. The orange and the gray lines represent the wellhead temper￾ature upstream (marked in orange) and downstream of the choke (marked
in gray). Notice that the two lines are very close to each other due to the
low-pressure differential across the choke and also due to the low gas flow
rate (relative to the liquid) being produced.❦
❦ ❦
❦
10.4 Production Wells Simulation 233
20
40
60
80
100
120
140
160
180
200
0
0 5 10 15 20
Bottom hole Well head
Time (h)
Jumper
Well temperature trend during start-up
25 30 35 40
Temperaure (°F)
Figure 10.5 Temperatures during the well initial start-up.
Figure 10.6 shows the well holdup profile during the initial start-up at
several times. Each graph shows the total liquid holdup (orange line), the
water phase liquid holdup dark blue, and the brine holdup (light blue); the
well geometry (as a function of the total length) is shown with the dashed
lines.
Initially (at 0 hours), the well is filled with brine; note that the brine
holdup is 1. At 2 hours, the lower 5,000 ft of the well have about 60%
of production fluid and the top of the well has between 10% and 20%
of production fluids; note that at 2 hours production fluid reaches the
wellhead and there is a gas breakthrough.
At 8 hours, the well has 100% production fluids only below 2,000 ft, while
the segment between 2,000 and 9,000 ft has a brine holdup of about 20%.
At 12 hours, brine completely exits the well; the increase of flow rate from
2,000 to 4,000 bpd helps to evacuate the remaining brine. Note that, in this
case, a production rate of 2,000 bpd could be considered to be small for a
7-in. well; this is the reason why the brine exits after 12 hours of production.
At 30 hours, the well is in normal operating condition. If the well is main￾tained at this production rate, the soil surrounding the well will warm up,
increasing the wellhead fluid temperature over time.
During the life of the well, it is expected that the reservoir conditions will
change. Some of the common changes are decreasing static reservoir pres￾sure, increasing water cuts, increasing GOR, reduction of the productivity❦
❦ ❦
❦
234 10 Multiphase Flow Simulations
Well hold-up profile, time = 0 hours
Well hold-up profile, time = 2 hours
Liquid hold-up Water phase hold-up Brine hold-up
0 2,000
1
0.8
Hold-up (‒) 0.6
0.4
0.2
0
4,000 8,000 10,000 6,000
Well total length (ft)
2,000
0
‒2,000
‒4,000
‒6,000
‒8,000
Elevation (ft)
0 2,000
1
0.8
Hold-up (‒)
0.6
0.4
0.2
0
4,000 6,000 8,000 10,000
Well total length (ft)
2,000
0
‒2,000
‒4,000
‒6,000
‒8,000
Elevation (ft)
Well hold-up profile, time = 8 hours
0 2,000
1
0.8
Hold-up (‒)
0.6
0.4
0.2
0
1
0.8
Hold-up (‒) 0.6
0.4
0.2
0
4,000 6,000 8,000 10,000
Well total length (ft)
2,000
0
‒2,000
‒4,000
‒6,000
‒8,000
Elevation (ft)
Well hold-up profile, time = 12 hours
0 2,000 6,000 4,000 8,000 10,000
Well total length (ft)
2,000
0
‒2,000
‒4,000
‒6,000
‒8,000
Elevation (ft)
1
0.8
Hold-up (‒) 0.6
0.4
0.2
0
Well hold-up profile, time = 30 hours
0 2,000 6,000 4,000 8,000 10,000
Well total length (ft)
2,000
0
‒2,000
‒4,000
‒6,000
‒8,000
Elevation (ft)
Figure 10.6 Well holdup profile during well initial start-up.❦
❦ ❦
❦
10.4 Production Wells Simulation 235
2,000 6,000 4,000 8,000 10,000
‒2,000
‒1,000
‒3,000
‒4,000
‒5,000
‒6,000
‒7,000
Time: 0 h Time: 1.5 h Time: 70 h Elevation Time: 11 h
Well total length (ft)
Well subcooling profile during well start-up
Subcooling (οF)
Elevation (ft)
0
‒40
‒20
0
‒60
‒80
‒100
‒120
‒140
0
Figure 10.7 Well subcooling profile during well initial start-up.
index, and others. Those cases will alter the normal operating conditions of
the well.
A final note, during the well restart, the ambient temperatures, and the
well conditions are expected to be outside the hydrate formation region.
Subcooling is defined as the difference between the hydrate formation tem￾perature (HFT) at a given pressure and the actual fluid temperature in a
given section. Defined this way, a negative subcooling value indicates that
the fluid temperature is higher than the HFT at that section; in other words,
a negative subcooling value indicates that there is “no risk” of hydrate for￾mation in that section.
Figure 10.7 shows the subcooling profile for the initial start-up operation.
The figure shows that the subcooling values are negative for the entire well
profile during the entire duration of the well initial start-up.
Having a well initial start-up completely outside the hydrate region is not
common for subsea wells. If there are well zones with positive subcooling,
careful consideration should be taken to how the well will be started up in
order to avoid a hydrate blockage. The details of such an operation are out￾side the scope of this chapter.
10.4.3 Onshore Well Shutdown Example
The objective of this example is to illustrate the well-fluid segregation during
a shutdown. In this section, a simplified onshore well example is studied.❦
❦ ❦
❦
236 10 Multiphase Flow Simulations
As stated, no hydrate concerns are expected in this well due to the high
onshore ambient temperatures. Initially, the well is produced at normal
operating conditions at 8,000 bpd. Figure 10.2 shows the normal operating
conditions of the simulated well. Notice that the objective of this chapter
is to illustrate the typical results of numerical multiphase flow simulations
and not to provide guidelines on how to safely operate wells under subsea
conditions.
Figure 10.8 shows the well condition after a 120-hour shutdown. The
wellbore pressure is shown in blue; the bottom-hole pressure is 3,700 psia
and the wellhead pressure is about 1,100 psia. The wellbore temperature
is shown in red; the bottom-hole temperature is 190 ∘F, and while the
wellhead temperature at soil level is approximately 90 ∘F, this indicates that
the well temperature has not reached ambient conditions after a 120-hour
shut-in. The ambient wellhead temperature is 70 ∘F. The slow cooldown
in the well is caused by the high thermal mass of the soil surrounding the
well. Note that in this simulation it was assumed that approximately 5 ft of
soil around the well is warmed prior to the well shut-in. This assumption is
valid only if the well has been produced for at least 6 to 12 months prior to
the shut-in.
The well liquid holdup (in orange) remains at 100% except at the very top
of the well; this is caused by the low GOR and low API gravity of the simu￾lated fluid.
During a shut-in, the fluid is segregated. The water-to-live-oil boundary
can be observed at about 1,000 ft from the bottom of the well (light blue line).
Complete water segregation is expected after 120 hours shut-in.
As it was stated before, the simulated well is not expected to have hydrate
issues. In the case of the shut-in of a subsea deepwater well, the hydrate
strategy of closing a well needs to be carefully planned and executed, since
the upper part of the well, from the SCSSV (surface-controlled subsurface
safety valve) to the wellhead, will most likely be inside the hydrate region
after an extended shutdown. Additionally, other subsea components, like
the wellhead and the well jumper, will likely enter the hydrate region in a
matter of hours.
10.5 Offshore Flowlines
In offshore oil and gas production, the flowlines that transport hydrocarbons
and other fluids are critical components of the overall production system.
Multiphase flow simulation is an essential tool for the design, optimization,
and operation of offshore flowlines. This chapter will focus on the modeling❦
❦ ❦
❦
10.5 Offshore Flowlines 237
0 2,000 6,000 4,000 8,000 10,000
0 2,000 6,000 4,000 8,000 10,000
0 2,000 6,000 4,000 8,000 10,000
0 2,000 4,000 8,000 10,000 6,000
0 2,000 4,000 6,000
Well total length (ft)
Well total length (ft)
Well total length (ft)
Well total length (ft)
Well total length (ft)
8,000 10,000
4,000 2,000
3,000
Pressure (psia) 2,000
1,000
0
200
150
100
Temperature (°F) Liquid hold-up (‒) Water hold-up (‒) EVR [
C=100] (‒)
50
0
1
0.8
0.6
0.4
0.2
0
1
0.8
0.6
0.4
0.2
0
1
0.8
0.6
0.4
0.2
0
0
‒2,000
‒4,000
‒6,000
‒8,000
2,000
0
‒2,000
‒4,000
‒6,000
‒8,000
2,000
0
‒2,000
‒4,000
‒6,000
‒8,000
Elevation (ft) Elevation (ft) Elevation (ft)
2,000
0
‒2,000
‒4,000
‒6,000
‒8,000
Elevation (ft)
2,000
0
‒2,000
‒4,000
‒6,000
‒8,000
Elevation (ft)
Figure 10.8 Well shutdown conditions after a 120-hour shutdown.❦
❦ ❦
❦
238 10 Multiphase Flow Simulations
of production and injection flowlines and how engineering companies and
oil operators use simulation to design multiphase flow systems.
Production flowlines transport hydrocarbons and other fluids from the
wellhead to the processing facilities on the platform or onshore. These flow￾lines are typically designed to operate at high flow rates, and the fluid prop￾erties can vary significantly over time due to changes in production rates and
the composition of the produced fluids. As a result, the design and operation
of production flowlines require a detailed understanding of the multiphase
flow behavior.
Injection flowlines are used to transport fluids such as water or gas from
the platform to the wellhead for injection into the reservoir. Injection flow￾lines are critical for maintaining reservoir pressure and increasing the recov￾ery factor of the field.
Modeling offshore flowlines presents unique challenges due to the oper￾ating conditions and the complex geometries of the flowlines. The flowlines
are subject to high pressures, temperatures, and corrosive environments,
which can affect the fluid properties and the performance of the flowline.
One of the main challenges in modeling offshore flowlines is the accu￾rate prediction of the pressure drop and flow rate. The flowlines are subject
to significant pressure losses due to friction, turbulence, and other factors.
Accurately predicting these losses is critical for optimizing the design and
operation of the flowline.
Another challenge is the modeling of multiphase flow behavior in
complex geometries. The flow behavior can be affected by the presence of
bends, manifolds, risers, and other components. Modeling these compo￾nents requires advanced simulation techniques, such as computational fluid
dynamics (CFD), to accurately capture the flow behavior and cooldown
time (cold spots).
In summary, common applications of multiphase flow simulation in sub￾sea flowlines include
● Optimization of flowline design and operation
● Evaluation of different production and injection strategies
● Prediction of the pressure drop and flow rate under different scenarios
● Assessment of the impact of flow assurance issues, such as hydrate forma￾tion and wax deposition
● Planning of maintenance and inspection activities
10.5.1 Offshore Flowline Simulations in Steady State
Steady-state simulations are a common method used to model single-phase
and multiphase flow in offshore production and injection flowlines. In a❦
❦ ❦
❦
10.5 Offshore Flowlines 239
steady-state simulation, the flow variables, such as pressure, temperature,
and flow rate, are assumed to remain constant over time. While this assump￾tion may not strictly hold in reality, steady-state simulations are often used
for initial design and optimization of flowlines due to their computational
efficiency. In a single-phase steady-state simulation, the fluid is either liq￾uid or gas. A straightforward simulation allows us to determine the pressure
drop and the temperature change along the flowline or the flow rate.
Multiphase steady-state simulations are more complex than single-phase
simulations, as they require the modeling of two or more phases flowing
together in the same line. In offshore production and injection systems, the
two primary phases are typically oil and gas, and the simulation must con￾sider the effects of their interactions on the flow behavior. Multiphase simu￾lations can also include the effects of water, sand, and other particles in the
fluid, which can impact flow behavior and cause erosion or corrosion.
Steady-state simulations can be used to design and optimize offshore pro￾duction and injection flowlines in normal operation. Steady-state simula￾tions also shed light to troubleshoot issues in existing systems. By simulating
different scenarios and parameters, such as changing the flow rate or adjust￾ing the pipe diameter, engineers can evaluate the performance of the system
and determine the optimal design for maximum production and efficiency.
10.5.2 Oil Flowline System in a Steady-State Example
Consider the multiphase flowline data summary in Table 10.3 operating in
steady state. The task is to simulate the main parameter profiles through
the flowline, such as pressure, temperature, holdup, and erosion velocity for
a constant liquid flow rate, and to run a liquid rate sensitivity for topsides
arrival temperature, system’s liquid content, and inlet pressure. The results
from this simulation provide ample information to design the flowline and
to predict future operation conditions at the topsides.
Figure 10.9 shows the flowline elevation profile as a function of the hor￾izontal length and as a function of the total length. In this section, profile
graphs will be plotted as a function of the flowline total length.
Figure 10.10 shows the plot of the flowline’s inlet pressure as a function
of the liquid rate (i.e. “J curve”) as the black line. The flowline liquid con￾tent as a function of the liquid rate is shown in orange. The J curve helps
to identify the gravity dominated region (i.e. less than 30,000 blpd) and the
friction-dominated region (i.e. flow rates above 30,000 blpd).
In a multiphase system, the pressure drop is a balance between the hydro￾static of the liquid content in the system and the frictional pressure drop. It is
recommended to operate the flowline in the frictional-dominated region to❦
❦ ❦
❦
240 10 Multiphase Flow Simulations
Table 10.3 Simulated subsea oil flowline characteristics.
System Flowline riser
Location Offshore
Flowline and riser insulation type Wet Insulation
Flowline and riser internal diameter (ID) 10.16 in.
Riser geometry Assumed vertical
Flowline horizontal distance ∼66,300 ft (20 km)
Flowline undulation Yes (PI∼80)
Flowline inlet point elevation –6,569 ft (–2,000 m)
Outlet elevation ∼ +131 ft (+40 m)
Flowline and riser internal roughness 0.0018 in.
Flowline and riser OHTC 1 btu/ft2 h ∘F (based on ID)
Water ambient conditions Depth (ft) Temperature (∘F) Velocity (fps)
0 70 3
–6,240 40 3
–6,569 40 3
Air ambient conditions Air temperature: 70 ∘F
Air velocity: 32 fps
Methanol density: 50 lb/ft3
Methanol viscosity: 0.7 cP
Assumed Methanol properties Max. Methanol injection rate: 5,000 bpd
Dead oil density: 55 lb/ft3
Assumed dead oil properties Dead oil viscosity: 300 cP
Max. dead oil circulation rate: 60,000 blpd
Inlet source type Fixed mass
Inlet source GOR 1,000 scf/stb
Inlet source water cut 25%
Inlet source temperature 180 F (during steady state)
FPSO valve diameter 10.15 in.
avoid flow instabilities in the system. Moreover, due to the numerical uncer￾tainties in the flow simulator, it is usually recommended to avoid operating
the pipeline too close to the minimum pressure in the J curve (in this case,
30,000 blpd). In this example, it would be recommended to operate the flow￾line at a liquid rate greater than 40,000 blpd.❦
❦ ❦
❦
10.5 Offshore Flowlines 241
Horizontal length (ft)
Flowline-riser geometry
Inlet manifold
Inlet manifold
Arrival topsides
facilities
Arrival topsides
facilities
Total lenght (ft)
Elevation (ft)
2,000
0
0 10,000 20,000 30,000 40,000 50,000 60,000 70,000 80,000
‒2,000
‒4,000
‒6,000
‒8,000
Elevation (ft)
2,000
0
0
10,000 20,000 30,000 40,000 50,000 60,000 70,000
‒2,000
‒4,000
‒6,000
‒8,000
Figure 10.9 Flowline elevation profile as function of horizontal and total lengths.
20,000
1,000
0
0
2,000
3,000
4,000
6,000 6,200
6,000
5,800
5,600
5,200
5,000
5,400
5,000
40,000 120,000 60,000 80,000 100,000
0 20,000
0
200
150
100
50
2.00
1.50
1.00
0.50
0.00
40,000 120,000 60,000 80,000 100,000
Inlet manifold pressure and flowline-riser liquid content,
steady state results
Inlet pressure (psia)
Liquid content (bbl) Arrival topside EVR, C = 100, (‒) 
Arrival topside fluid
temperature (°F) 
Liquid rate (bpd)
Liquid rate (bpd)
Arrival topside temperature and arrival topside erosional
velocity ratio (C = 100) steady state results
Inlet pressure (psia) Liq. content (bbls)
Arrival topside temperature (°F) EVR (–)
Figure 10.10 Flowline-riser J curve, arrival temperature, and EVR.❦
❦ ❦
❦
242 10 Multiphase Flow Simulations
The lower graph in Figure 10.10 shows the arrival topside temperature
and the erosional velocity ratio (EVR). The EVR is the ratio of the mixture
velocity to the erosional velocity. The latter is defined by equation (2.14)
from API RP 14E (2007), using an empirical constant “C.” The higher the
flow rate, the warmer the fluid within the flowline and the higher the EVR.
In this example in order to limit erosion, the flowline will be recommended
to be operated at a maximum flow rate of 80,000 blpd; at this rate, the
EVR (assuming the conservative value of C = 100) is 1.2, and the arrival
topside temperature is ∼140 ∘F. The maximum EVR that a flowline may
operate is the subject of specialized studies that are outside the scope of
this section.
In conclusion, for this example, the flowline simulated can be recom￾mended to be operated in the range of 40,000–80,000 blpd.
Figure 10.11 shows the profiles of five parameters of the flowline system
when operated at 80,000 blpd in normal operating conditions (i.e. steady
state).
10.5.3 Offshore Flowline Transient Simulations
While steady-state simulations are useful for predicting the behavior of
flowlines under normal operating conditions, transient simulations are
necessary for analyzing the dynamic response of the flow system to sudden
changes in operating conditions, such as start-up and shutdown procedures,
power outages, equipment failures, or changes in well production rates.
Transient simulations can also be used for analyzing safety scenarios, such
as pipeline ruptures or spills, and determining the resulting flow behavior
and consequences.
In transient simulations, it is crucial to accurately model the physical
phenomena that occur during the transient events. These phenomena
can include changes in pressure, temperature, fluid properties, flow
rates, and flow regimes. The simulation models must also consider the
time-dependent behavior of the system components, such as valves, pumps,
compressors, and separators.
One example of transient events in multiphase flow systems is the start-up
of a production well or a flowline. During start-up, the well and flowline
are usually filled with fluids that are at rest, and the initial flow rates are
zero. As the flow begins, the fluid properties and flow rates change rapidly,
and the system transitions from a static to a dynamic state. The simulation
models must accurately capture the pressure and flow behavior during this
transition period to avoid operational issues such as liquid slugging, flow
instability, or equipment damage.❦
❦ ❦
❦
10.5 Offshore Flowlines 243
0 10,000 20,000 30,000 40,000 50,000 60,000 70,000 80,000
0
Total length (ft)
2,000
3,000
4,000
5,000
Pressure (psia) 2,000
1,000
0
200
150
100
Temperature (οF) Liquid hold-up (‒) Water hold-up (‒) EVR [
C=100] (‒)
50
0
1
0.8
0.6
0.4
0.2
0
1
0.8
0.6
0.4
0.2
0
1
2
1.5
0.5
0
0
‒2,000
‒4,000
‒6,000
‒8,000
Elevation (ft)
10,000 20,000 30,000 40,000 50,000 60,000 70,000 80,000
Total length (ft)
2,000
0
‒2,000
‒4,000
‒6,000
‒8,000
Elevation (ft)
0 10,000 20,000 30,000 40,000 50,000 60,000 70,000 80,000
Total length (ft)
0 10,000 20,000 30,000 40,000 50,000 60,000 70,000 80,000
Total length (ft)
0 10,000 20,000 30,000 40,000 50,000 60,000 70,000 80,000
Total length (ft)
2,000
0
‒2,000
‒4,000
‒6,000
‒8,000
Elevation (ft)
2,000
0
‒2,000
‒4,000
‒6,000
‒8,000
Elevation (ft)
2,000
0
‒2,000
‒4,000
‒6,000
‒8,000
Elevation (ft)
Figure 10.11 Flowline profiles for normal operation (rate 80,000 blpd).❦
❦ ❦
❦
244 10 Multiphase Flow Simulations
Another example of a transient event is the shutdown of a well or flow￾line, which can be either planned or unplanned. During shutdown, the flow
rates stop, and the pressure and temperature of the fluid change. The sim￾ulation models must accurately capture the behavior of the system to avoid
operational problems.
10.5.4 Slugging Example
Slugging is a common flow regime in offshore oil and gas production, which
can cause operational problems such as flowline vibration, reduced produc￾tion rates, and even damage to equipment. Multiphase flow simulation is
used extensively during the design and operation of offshore fields to predict
and manage slugging events.
During the design phase, simulations are used to optimize the design of
the production system, including the sizing of the flowline and separators,
risers, and other equipment, to minimize the risk of operational disruptions.
The multiphase flow simulation can predict the occurrence of slugging,
determine the slugging severity, and evaluate the performance of different
mitigation strategies, such as the use of slug catchers or choke valves at the
arrival point.
During the operation phase, real-time monitoring and modeling of the
flowline conditions can help operators to identify and manage slugging
events. Simulations can be used to predict the expected behavior of the
system under different operating conditions and to assess the effectiveness
of different control strategies, such as adjusting the flow rates or activating
control valves.
10.5.5 Hydrodynamic Slugging Example
Hydrodynamic slugging is an amplified instability created at the interface
between the liquid and gas phases, and it is characterized by
● Rapid change in the liquid rate,
● Moderate or no change in the flowline inlet pressure and overall liquid
content of the flowline,
● Moderate or no liquid surge volume.
Modeling hydrodynamic slugging is complex. In general multiphase flow,
simulators predict accurately if hydrodynamic slugging conditions exist
or not.
Predicting the precise characteristics of hydrodynamic slugging is a more
difficult task. Some simulators generate artificial slugs with some arbitrary❦
❦ ❦
❦
10.5 Offshore Flowlines 245
frequency and let the flow simulator determine if slugging conditions exist
(if the slug continues or is dissipated); in this case, the slugging frequency
and other characteristics are arbitrary and can easily be manipulated
to obtain a different result. In more recent years, the multiphase flow
simulators mechanistically predict the slug frequency and claim that the
hydrodynamic slug calculations are therefore better.
In reality, it is very difficult to precisely describe the characteristics of
hydrodynamic slugging. It is the opinion of the authors that, in most cases,
identifying that the flowline will be operating under hydrodynamic slugging
is more important than trying to get specific flowing characteristics from the
flow simulator.
In flowline design, once a hydrodynamic slugging condition is identified,
the flowline and the riser have to be designed for a wide variety of inter￾mittent flow conditions. For hydrodynamic slugging fatigue and proper
flowline, anchoring are two of the most important considerations during
design.
Figure 10.12 shows an example of hydrodynamic slugging. This graph
illustrates a hypothetical hydrodynamic slugging behavior (based on experi￾ence, not actually simulated). Figure 10.12 shows a moderate inlet pressure
variation, with an average pressure of ∼2,900 psi (±15 psi), a rapid fluctua￾tion in the arrival liquid rate from 0 to 60,000 blpd, and an average flow of
30,000 blpd. The liquid content in the flowline stays constant, and the slug
frequency in this example is approximately 60 slugs per minute.
In practical terms, hydrodynamic slugging conditions can be present even
during the stable production of a flowline system. If the flowline system is
operated at low rates (inside the gravity dominated region), it is likely that
the oil flowline will be operated under terrain slugging conditions.
10.5.6 Severe Slugging Example
In Section 10.5.2, it was determined that the recommended operating
region for the simulated flowline system be from 40,000 to 80,000 blpd. It
is expected that operating the flowline at 5,000 blpd could create severe
slugging.
Severe slugging is characterized by the following cyclic behavior:
● When the flowline produces at low pressure, the flow rate is also low and
the gas phase cannot efficiently remove the liquid, which is left behind as
the gas is produced.
● The increased liquid content in the flowline creates an increase in the
flowline inlet pressure.❦
❦ ❦
❦
246 10 Multiphase Flow Simulations
0
2,920
2,915
2,910
2,905
2,900
2,895
2,890
2,885
70,000
60,000
50,000
40,000
30,000
20,000
10,000
0
1,200
1,000
800
600
400
200
0
10 20 30
Time (s)
Inlet pressure (psia) Arrival liq. rate (bpd) Liquid content (bpd)
40 50 60
0 10 20 30
Time (s)
40 50 60
0 10 20 30
Time (s)
40 50 60
Figure 10.12 Hydrodynamic slugging example.
● When the pressure is sufficiently high, the liquids are evacuated from
the flowline and the inlet pressure of the flowline decreases. This process
repeats in a cyclical manner.
Figure 10.13 shows the simulated severe slugging conditions of the flow￾line system from Section 10.5.2 operated at 5,000 blpd. Note the significant
pressure fluctuations (between 2,400 and 3,600 psia). The liquid rate is pro￾duced in batches, these liquid batches last for less than 1 hour and then the
liquid rate stops and is not produced for about 5 hours. The liquid content
in the flowline oscillates between 4,200 and 5,300 bbls.
It would be very difficult to operate the flowline system under these condi￾tions. The rapid production of liquids will likely flood the separator. Adding
system friction with a topside choke and increasing the separator operating
pressure are two of the common methods to mitigate the effects of severe
slugging.❦
❦ ❦
❦
10.5 Offshore Flowlines 247
2,000
200,000
150,000
100,000
Arrival liq. rate (bpd)
Liquid content (bbl) Inlet pressure (psia)
50,000
5,400
5,200
5,000
4,800
4,600
4,400
4,200
4,000
0
0 6 2 4 10 8 14 12
Time (h)
16 20 18 24 22
0 6 2 4 10 8 14 12
Time (h)
16 20 18 24 22
0 6 2 4 10 8 14 12
Time (h)
16 20 18 24 22
2,500
3,000
4,000
3,500
Figure 10.13 Severe slugging example.
10.5.7 Ramp-up and Ramp-down Operations
Ramp-up and ramp-down operations involve the gradual increase or
decrease in the flow rate of fluids within the system. These operations are
critical in ensuring the safe and efficient operation of the system and in
minimizing the risk of damage to the flowline.
Multiphase simulation can be used to optimize the ramp-up and
ramp-down process by predicting the behavior of fluids within the system
under different flow rates. This includes modeling the behavior of fluids
during the gradual increase or decrease in flow rate, as well as simulating
the effects of changes in temperature and pressure on the system. By sim￾ulating these processes, operators can identify potential issues and develop❦
❦ ❦
❦
248 10 Multiphase Flow Simulations
strategies to prevent overloading, slugging, sudden depressurization, and
damage to the flowline.
10.5.8 Offshore Flowline Ramp-down and Ramp-up Example
When a system is in ramp-down, care must be exercised to ensure the flow
rate warrants an arrival temperature above the hydrate formation region and
the flow stability is preserved to avoid severe slugging.
On the contrary, when the system is in ramp-up, consideration should be
made to the liquid slug that will be generated due to the rate increase.
The ramp-up/ramp-down example in this section is based on the flowline
described in Section 10.5.2. Figure 10.14 shows the flowline liquid rate (at
inlet and topside) and the liquid content during a ramp-down and ramp-up
simulation. From 0 to 10 hours, the system operates at 80,000 stb/d. At
the 10th hour, the flow rate is instantaneously reduced to 40,000 stb/d. At
the 22nd hour, the system is ramped up instantaneously from 40,000 to
80,000 stb/d.
Note that at the 22nd hour, the temporary increase in the arrival liquid
rate takes place. This increase generates a liquid slug that should be handled
by the topside separator. Assuming an actual separator liquid drain rate of
100,000 blpd, the ramp-up surge volume is about 50 bbl.
120,000
100,000
80,000
5,500
5,400
5,300
5,200
5,100
5,000
4,900
60,000
40,000
20,000
0
0 5 10
Ramp-down and ramp-up simulation
15 20
Time (h)
Topside liq. rate @ actual cond. Liquid content
Liquid rate (bpd or stb/d)
Liquid content (bbl)
Inlet liq. rate @ std. cond.
25 30 35
Figure 10.14 Ramp-down to 40,000 blpd and ramp-up to 80,000 blpd.❦
❦ ❦
❦
10.5 Offshore Flowlines 249
10.5.9 Cooldown Transient
Cooldown (CD) is the heat transfer process multiphase flowlines undergo
after system shutdown. If the shutdown is expected to be momentary and the
system will be restarted in a few hours, there is the challenge of managing
the temperature differential between the hydrocarbons and the surrounding
environment. The temperature differential can cause thermal stresses in the
flowlines, leading to deformation, cracking, and failure. Additionally, during
cooldown, there is the risk of hydrate formation which can also block and
damage the flowlines.
10.5.10 Offshore Flowline Cooldown Example
In this simulation, the flowline system of Section 10.5.2 is initially at a
production rate of 80,000 blpd. The flowline is shut (along with the inlet
source) at time 0. The flowline is shut-in for 120 hours. This simulation
was performed to illustrate a flowline cooldown process while disregarding
any hydrate formation consideration, and therefore no methanol inhibition
and no dead oil circulation were simulated. The following sections will
illustrate flowline inhibition and dead oil circulation as potential safeguard
methodologies.
Figure 10.15 shows the flowline profile for the liquid holdup, pressure,
and temperature up to the 120th hour. The liquid holdup shows the rapid
redistribution of the liquid across the pipeline in the first few hours. The
pressure profile shows that after closing the flowline pressure equilibrates
and then slowly decreases over time with the temperature decrease. The
temperature profile shows that the temperature reduction is quicker in the
gas pockets and slower in the liquid pockets of the flowline, due to the higher
heat capacity of the liquid with respect to the gas.
After 120 hours, the flowline is expected to be almost at ambient tem￾perature conditions. The flowline hydrocarbon fluid at a low temperature
(∼40 ∘F), with free water present and at a pressure above 125 psi, will have
all the conditions for hydrate formation. In the following sections, some of
the transient operations methods illustrate ways to maintain the flowline
system outside the hydrate region.
10.5.11 Depressurization Operation
Depressurization is a crucial process in deep offshore oil and gas systems
that involves the controlled reduction of pressure within a flowline or sys￾tem. This process is particularly important in deep offshore systems due to❦
❦ ❦
❦
250 10 Multiphase Flow Simulations
20,000 30,000 40,000
‒2,000
‒4,000
‒6,000
‒8,000
0
2,000
50,000
Total length (ft)
Time: 0 h
Time: 0 h
Time: 3 h
Time: 18 h
Time: 72 h
Time: 0.5 h
Time: 4 h
Time: 24 h
Time: 96 h
Time: 1.5 h
Time: 8 h
Time: 36 h
Elevation
Time: 2 h
Time: 12 h
Time: 48 h
Time: 1 h
Time: 5 h
Time: 30 h
Time: 120 h
Time: 0 h
Time: 3 h
Time: 18 h
Time: 72 h
Time: 0.5 h
Time: 4 h
Time: 24 h
Time: 96 h
Time: 1.5 h
Time: 8 h
Time: 36 h
Elevation
Time: 2 h
Time: 12 h
Time: 48 h
Time: 1 h
Time: 5 h
Time: 30 h
Time: 120 h
Time: 0.5 h Time: 1 h Time: 120 h Elevation
Liquid hold-up (‒) Pressure (psia) Temperature (°F)
Elevation (ft)
‒2,000
‒4,000
‒6,000
‒8,000
0
2,000
2,000
200
175
150
125
100
50
0
75
25
0
4,000
6,000
Elevation (ft)
‒2,000
‒4,000
‒6,000
‒8,000
0
2,000
Elevation (ft)
Liquid hold-up, 120 h shut-down
Pressure profile, 120 h shut-down
Temperature profile, 120 h shut-down
10,000 60,000 70,000 80,000
0.2
0.4
0.6
0.8
1
0
0
20,000 40,000
Total length (ft)
0 60,000 80,000
20,000 40,000
Total length (ft)
0 60,000 80,000
Figure 10.15 Holdup, pressure, and temperature profiles during the cooldown.❦
❦ ❦
❦
10.5 Offshore Flowlines 251
the challenging operating conditions, including high pressures and temper￾atures, harsh environments, and remote locations.
During planned shutdowns, depressurization is carefully planned and
executed to ensure the safe shutdown of the system for maintenance and
inspection. In deep offshore systems, depressurization is vital as it allows
workers to carry out maintenance, inspection, and repair work without
risking their safety in challenging operating conditions.
In contrast, unplanned shutdowns or system failures can result in sud￾den depressurization, which can pose a significant risk to workers and the
environment. In deep offshore systems, depressurization must be carried out
quickly and safely to prevent damage to the system and minimize the risk
of injury or environmental damage.
During operations, multiphase simulation is used to monitor the
behavior of fluids within the system and to optimize the depressurization
process. This includes monitoring the rate of depressurization, the pressure
and temperature within the system, and the behavior of fluids during
depressurization.
Slugging can occur during depressurization, particularly during
unplanned shutdowns or system failures, and can lead to mechanical
damage to the system, as well as a risk of environmental damage due to
the release of fluids. Engineers use multiphase simulation to optimize
the depressurization process and to design systems that are less prone to
slugging. This can include the use of flow control devices, such as choke
valves, to regulate the flow of fluids during depressurization and prevent
the formation of slugs.
10.5.12 Offshore Flowline Depressurization Example
In this example, depressurization is one of the methods to avoid hydrate
conditions in the flowline system. In the following example, the flowline
is initially operated at 80,000 blpd, and then the flowline is shut down for
8 hours (i.e. 4 hours of no-touch time plus 4 hours of light-touch time for
the unplanned unpacked shutdown). The depressurization simulation starts
after 8 hours of the shutdown.
The topside depressurization pressure was assumed to be 50 psia using a
1-in. or a 2-in. topside choke.
Figure 10.16 shows the flowline initial condition profile prior to the
depressurization. Note that the flowline settle-out pressure is 3,000 psia.
Figure 10.17 shows the flowline profile after 120 hours of depressurization
with a 1-in. choke. Note in this case that the maximum flowline settle-out
pressure is about 380 psia.❦
❦ ❦
❦
252 10 Multiphase Flow Simulations
20,000 30,000 40,000 50,000
Total length (ft)
10,000 60,000 70,000 80,000
2,000
4,000
3,000
2,000
1,000
150
100
50
1.0
0.8
0.6
0.4
0.2
0.0
0
0
‒2,000
‒4,000
Elevation (ft) Pressure (psia) Temperature (°F) Liquid hold-up (‒) ‒6,000
‒8,000
0
0
20,000 30,000 40,000 50,000
Total length (ft)
0 10,000 60,000 70,000 80,000
20,000 30,000 40,000 50,000
Total length (ft)
0 10,000 60,000 70,000 80,000
20,000 30,000 40,000 50,000
Total length (ft)
0 10,000 60,000 70,000 80,000
Figure 10.16 Flowline initial condition profile for depressurization (after 8-hour
CD).
Figure 10.18 shows the flowline profile after 120 hours of depressurization
with a 2-inch choke. Note in this case that the maximum flowline settle-out
pressure is about 250 psia.
Figures 10.19 and 10.20 show that the topside liquid and gas flow rates
are larger with the 2-inch depressurization simulation when compared to
the 1-inch simulation depressurization.❦
❦ ❦
❦
10.5 Offshore Flowlines 253
20,000 30,000 40,000 50,000
Total length (ft)
10,000 60,000 70,000 80,000
2,000
400
300
200
100
80
60
40
1.0
0.8
0.6
0.4
0.2
0.0
0
20
0
‒2,000
‒4,000
Elevation (ft) Pressure (psia) Temperature (°F) Liquid hold-up (‒) ‒6,000
‒8,000
0
0
20,000 30,000 40,000 50,000
Total length (ft)
0 10,000 60,000 70,000 80,000
20,000 30,000 40,000 50,000
Total length (ft)
0 10,000 60,000 70,000 80,000
20,000 30,000 40,000 50,000
Total length (ft)
0 10,000 60,000 70,000 80,000
Figure 10.17 Flowline profile after 120 hours of depressurization (1-inch choke).
The ideal objective of depressurization is to reach a settle-out pressure
below 125 psi, which is the hydrate formation pressure at 40 ∘F (seabed
ambient temperature). Depressurizing the flowline system is effective in
delaying the time when hydrates will form in the flowline, but in this case,
the depressurization process is unable to reach the necessary low settle-out
pressure to avoid indefinite hydrate formation.❦
❦ ❦
❦
254 10 Multiphase Flow Simulations
20,000 30,000 40,000 50,000
Total length (ft)
10,000 60,000 70,000 80,000
2,000
400
300
200
100
60
80
40
1.0
0.8
0.6
0.4
0.2
0.0
0
20
0
‒2,000
‒4,000
Elevation (ft) Pressure (psia) Temperature (°F) Liquid hold-up (‒) ‒6,000
‒8,000
0
0
20,000 30,000 40,000 50,000
Total length (ft)
0 10,000 60,000 70,000 80,000
20,000 30,000 40,000 50,000
Total length (ft)
0 10,000 60,000 70,000 80,000
20,000 30,000 40,000 50,000
Total length (ft)
0 10,000 60,000 70,000 80,000
Figure 10.18 Flowline profile after 120 hours of depressurization (2-inch choke).
In general, depressurization is more successful when the fluid is
very volatile, when the liquid content in the flowline is low prior to
depressurization, and when the water cut is close to 0.
10.5.13 Blowdown (Flowline Rupture) Transient
A rupture blowdown in multiphase pipelines refers to the rapid release of
fluids and gases from the pipeline due to a rupture in the pipe. This can occur❦
❦ ❦
❦
10.5 Offshore Flowlines 255
0.2 0.8 0.4
30
20
10
60
50
80
90
70
40
Gas rate (MMSCF/d)
0
0.6 1
Time (h)
Actual liquid rate Gas rate
Topside depressurization, 1ʺ choke
0
10,000
15,000
Actual liquid rate (bpd) 20,000
25,000
30,000
35,000
40,000
45,000
5,000
0
Figure 10.19 Topside gas and liquid rate, 1-inch choke depressurization.
0.2 0.8 0.4
30
20
10
60
50
80
90
70
40
Gas rate (MMSCF/d)
0
0.6 1
Time (h)
Topside depressurization, 2ʺ choke
0
10,000
15,000
Actual liquid rate (bpd) 20,000
25,000
30,000
35,000
40,000
45,000
5,000
0
Actual liquid rate Gas rate
Figure 10.20 Topside gas and liquid rates (2-inch choke).
when the pressure within the pipeline exceeds the strength of the pipe’s wall,
causing it to burst open. The sudden release of fluids and gases can result
in serious safety hazards, including fires, explosions, and environmental
damage.
When a pipeline rupture occurs, the pressure within the pipeline drops
rapidly, causing the fluids and gases to rapidly expand and escape through❦
❦ ❦
❦
256 10 Multiphase Flow Simulations
the rupture. This process is known as rupture blowdown and can occur in
both single-phase and multiphase pipelines.
In a multiphase pipeline, the liquids and gases have different densities, vis￾cosities, and chemical compositions. This can lead to complex flow behavior
during blowdown, with different phases behaving differently as they escape
from the pipeline. For example, liquids may form droplets or streams, while
gases may expand rapidly and create a cloud or plume.
The behavior of the fluids during blowdown can be predicted using
computer models that simulate the flow dynamics. These models consider
the properties of the fluids, as well as the geometry and conditions of the
pipeline. The models can help engineers to design pipelines that are more
resistant to blowdowns, as well as to develop emergency response plans in
the event of a pipeline rupture.
10.5.14 Offshore Flowline Rupture Blowdown Example
A transient multiphase flow simulation could be helpful in predicting the
behavior of the flowline during a pipeline rupture (or leak). Rupture simu￾lations provide important inputs to the HSE team to make fluid dispersion
calculations. One of the common questions is how big a leak needs to be in
order to be detected by the flowline sensors.
In this example, the simulated leak in the flowline described in Section
10.3 was assumed to occur in the middle. Since the flowline is subsea, the
expected pressure outside of the rupture was estimated to be 2605 psia.
In this simulation, the flowline is expected to have been operated at
80,000 blpd. According to Figure 10.11, the flowline pressure at the rupture
location is ∼3500 psia. Under these conditions, flowline fluid will leak into
the environment.
Three leak sizes were simulated 0.25, 0.5, and 2 inches in diameter.
Table 10.4 shows the flowline rupture simulation results, and Table 10.5
shows the performance differences in leak size with respect to steady-state
normal operation.
At this point is necessary to clarify that a flowline system as the one sim￾ulated is likely to have pressure and temperature gauges at the inlet and
topside outlet, and the flow rate is typically measured only in the topsides.
The bottom line is that a 0.25-inch pipeline rupture (in the middle of the
flowline) is likely to cause variations in the inlet pressure of ∼0.5% and vari￾ations in the flow rate in the order of 1%. Hours may pass before a 1% flow
rate difference is even detected, since this small flow variation may be inter￾preted as a normal variation of the rate (i.e. slugging), slight de-calibration of
the measuring devices, a slight loss of well productivity, or other. In general,❦
❦ ❦
❦
10.5 Offshore Flowlines 257
Table 10.4 Flowline rupture simulation results.
Leak
size
(inch)
Leak
location
(ft)
External
pressure
(psia)
Manifold
pressure
(psia)
Arrival
temp.
(
∘F)
Topsides
gas rate
(mmscfd)
Leak
gas rate
(mmscfd)
Topsides
liquid
rate
(blpd)
Leak
liquid
rate
(blpd)
0 32,800 2,800 4,256 145.6 60 0 95,800 0
0.25 4,235 145.2 59 0.8 94,600 1,200
0.50 4,180 144.2 57 2.9 91,300 4,500
2.00 3,720 135 40 20 63,200 32,600
Table 10.5 Normal operating condition differences during flowline rupture.
Leak
size
(inch)
Manifold
pressure
difference
(%)
Arrival
temperature
difference
(%)
Topsides
gas rate
difference
(%)
Topsides
liquid
rate
difference
(%)
0.25 −0.5 −0.3 −1.3 −1.3
0.50 −1.8 −1.0 −4.8 −4.7
2.00 −12.6 −7.3 −33.3 −34.0
the higher the GOR of the transported fluid, the bigger the leak needs to be
in order to be detected promptly.
Note in Table 10.5 that if the rupture has a 2-inch diameter, the pressure
and temperature difference is in the order of 10%, and the flow rate differ￾ence is in the order of 33%, these differences more easily to be noticed rapidly
by the flowline operator.
Leak detection technology in flowlines is a current topic of study in the
oil and gas industry. The details of the leak detection system are outside the
scope of this chapter.
10.5.15 Shutdown Operation
During start-up and shutdown operations, fluids must be introduced or
removed from the flowline gradually to prevent overloading, slugging,
sudden depressurization, and damage to the flowline. Multiphase simula￾tion can be used to predict the behavior of fluids within the system under
different operating conditions and flow rates, allowing operators to plan❦
❦ ❦
❦
258 10 Multiphase Flow Simulations
and execute these operations more safely and efficiently, this is especially
important during shutdown and start-up.
We will briefly address the differences between a planned (Section 10.5.16)
and an unplanned shutdown (Section 10.5.17).
10.5.16 Offshore Flowline Planned Shutdown Example
In this example, the flowline system of Table 10.3 is operated to deliver
80,000 blpd with hydrate protection in preparation for a planned shutdown.
The strategy is to inhibit the produced water in the flowline using methanol
prior to shutdown, minimizing the risk of hydrate formation during the
planned shutdown.
For simplicity, it is assumed that an inhibition rate of 0.5 barrels of MeOH
per barrel of produced water is sufficient to inhibit the flowline water. The
maximum methanol injection rate is assumed to be 5,000 bpd (146 gpm).
Under these conditions, the maximum amount of production water that
can be treated is 10,000 bpd. The total production stream has a 25% water
cut, which limits the maximum liquid flow rate successfully inhibited to
40,000 blpd.
Based on these numbers, the production should be reduced from 80,000
to 40,000 bpd, while the methanol Injection rate is increased from 0 to
5,000 bpd.
The idea is to simulate the time that it will take for the methanol holdup
to stabilize and reach the topsides.
Figure 10.21 shows the inhibition results. The figure shows that after
4–5 hours the methanol holdup stabilization is reached. It is customary in
the oil field that the flowline should be displaced twice in order to make
sure that methanol has fully inhibited the flowline water. Figure 10.21
shows that the assumption of two inhibiting volumes (10 hours injection) is
more than a confirmation of the result obtained at the 4th hour.
After the flowline is inhibited, the flowline is assumed to be shut down for
120 hours. Figure 10.22 shows the flowline system profile including pressure
and temperature right after inhibition (cooldown time at 0 hours), while
Figure 10.23 shows a similar graph after a 120-hour cooldown.
Figure 10.23 shows the liquid segregation expected during a pipeline
shut-in. Also, note that the flowline is at ambient conditions (∼40 ∘F).
Notice that the methanol holdup line represents about 33% of the water
phase pockets. This methanol holdup is in line with the concurrent flow
rates of water and methanol (i.e. 1 barrel of production water plus 0.5 barrels
of methanol).❦
❦ ❦
❦
10.5 Offshore Flowlines 259
20,000 30,000 40,000 50,000
Total length (ft)
Liquid rate 80 kbd, initial condition
Liquid rate 40 kbd, 5 kbd MeOH, time: 2 hours
Liquid hold-up Water phase hold-up Methanol hold-up Elevation
Liquid hold-up Water phase hold-up Methanol hold-up Elevation
Liquid hold-up Water phase hold-up Methanol hold-up Elevation
Liquid hold-up Water phase hold-up Methanol hold-up Elevation
Liquid rate 40 kbd, 5 kbd MeOH, time: 4 hours
(1 volume displacement)
Liquid rate 40 kbd, 5 kbd MeOH, time: 10 hours
(~2 volume displacement)
10,000 60,000 70,000 80,000
0.6
0.8
1
0.4
Hold-up (‒)
Elevation (ft)
0.2
‒2,000
‒1,000
1,000
0
‒4,000
‒3,000
‒6,000
‒5,000
‒7,000
‒2,000
‒1,000
1,000
0
‒4,000
‒3,000
‒6,000
‒5,000
‒7,000
0
0.6
0.8
1
0.4
Hold-up (‒)
Elevation (ft)
0.2
0
0.6
0.8
1
0.4
Hold-up (‒)
Elevation (ft)
0.2
‒2,000
2,000
0
‒4,000
‒6,000
0 ‒8,000
0.6
0.8
1
0.4
Hold-up (‒)
Elevation (ft)
0.2
‒2,000
2,000
0
‒4,000
‒6,000
0 ‒8000
0
20,000 30,000 40,000 50,000
Total length (ft)
0 10,000 60,000 70,000 80,000
20,000 30,000 40,000 50,000
Total length (ft)
0 10,000 60,000 70,000 80,000
20,000 30,000 40,000 50,000
Total length (ft)
0 10,000 60,000 70,000 80,000
Figure 10.21 Planned shutdown holdup profiles.❦
❦ ❦
❦
260 10 Multiphase Flow Simulations
20,000 30,000 40,000 50,000
Total length (ft)
Liquid hold-up Water phase hold-up Methanol hold-up Elevation
Methanol inhibited line, cool down time: 0 h
Methanol inhibited line, cool down time: 0 h
10,000 60,000 70,000 80,000
0.6
0.8
1
0.4
Hold-up (‒)
Pressure (psia)
Temperature (°F)
Elevation (ft)
0.2
3,500
3,000
200
150
100
50
0
2,500
2,000
1,500
1,000
500
0
‒2,000
0
1,000
‒1,000
‒5,000
‒4,000
‒3,000
‒6,000
0 ‒7,000
0
20,000 30,000 40,000 50,000
Total length (ft)
Pressure Temperature
0 10,000 60,000 70,000 80,000
Figure 10.22 Planned shutdown profile at the start of cooldown.
20,000 30,000 40,000 50,000
Total length (ft)
Liquid hold-up Water phase hold-up Methanol hold-up Elevation
Methanol inhibited line, cool down time: 120 h
Methanol inhibited line, cool down time: 120 h
10,000 60,000 70,000 80,000
0.6
0.8
1
0.4
Hold-up (‒)
Pressure (psia)
Temperature (°F)
Elevation (ft)
0.2
3,000 80
70
50
30
10
60
40
20
0
2,500
2,000
1,500
1,000
500
0
‒2,000
1,000
–1,000
‒3,000
‒5,000
‒7,000
0
‒4,000
‒6,000
0
0
20,000 30,000 40,000 50,000
Total length (ft)
Pressure Temperature
0 10,000 60,000 70,000 80,000
Figure 10.23 Planned shutdown profile after 120 hours of cooldown.❦
❦ ❦
❦
10.5 Offshore Flowlines 261
10.5.17 Offshore Flowline Restart After Planned Shutdown
Example
After the 120-hour planned shutdown (i.e. Figure 10.23), the system needs
to be restarted. The flowline is cold and new production flow needs to be
inhibited to prevent hydrate formation until the flowline is warm enough to
stop the methanol injection.
Similar assumptions will apply during the restart process; the maximum
liquid rate during start-up is 40,000 blpd with a methanol injection of
5,000 bpd in order to fully inhibit the incoming production. In this simpli￾fied example, the inlet source was assumed to increase its temperature from
40 to 180 ∘F in the interval from 0 to 8 hours. It will also be assumed that
the flowline system is warm when the topside temperature reaches 100 ∘F.
Figure 10.24 shows that the flowline arrival topside temperature reaches
100 ∘F after 14 hours of production. At the 14th hour, the methanol rate
stops, and the flowline production rate can be ramped up to 80,000 blpd
in 2 hours. This process causes no operational concern because, from the
example in Section 10.5.8, the expected surge volume during ramp-up is
expected to be less than 50 bbls.
10.5.18 Unplanned Shutdown and Dead Oil Circulation
in Flowline Loop
A subsea flowline system typically comprises a loop, that is, a system of two
flowlines and two risers, where the produced stream is divided at the subsea
10 20
10,000
40
20
0
100
120
140
160
80
60
20,000
30,000
40,000
50,000
60,000
70,000
80,000
90,000
0
0 30 40 50 60
Total length (ft)
Flowline restart after a planned shut-down
Liquid rate (bpd)
Prod. liquid rate Methanol rate Arrival fluid temp.
Temperature (°F)
Figure 10.24 Flowline restart after a planned shutdown trend.❦
❦ ❦
❦
262 10 Multiphase Flow Simulations
20,000
Manifold
Flowline loop elevation profile
Topside DOC inlet Topside outlet
40,000
Total length from topside inlet (ft)
0 60,000 80,000 100,000 120,000 140,000 160,000
‒4,000
‒5,000
‒2,000
‒1,000
1,000
0
‒3,000
‒6,000
‒7,000
Elevation (ft)
Figure 10.25 Flowline loop elevation profile.
manifold and delivered through the two flowlines toward the topside facil￾ities. A flowline loop configuration is customary in subsea systems to assist
in hydrate management and maintenance procedures.
During the unplanned shutdown simulation, the previous example sys￾tem is producing at 80,000 blpd per flowline (uninhibited), an unplanned
shutdown occurs at time 0 hour, and the system remains closed for 8 hours
(i.e. 4 hours of no-touch time plus 4 hours of light-touch time), at which time
dead oil is circulated from one riser toward the second flowline in order to
displace the live fluids and place the system in the safe condition against
hydrate risk.
Figure 10.25 shows the flowline loop elevation profile. This elevation pro￾file follows the dead oil circulation path
Hot oil and dead oil circulation (DOC) involves the introduction of either
hot or cold dead oil into the flowline to improve the flow of hydrocarbons
and to prepare the production system for an extended shutdown with min￾imum risk of solids’ deposition. Notice that hot oil is also dead oil but at a
higher temperature.
During the dead oil circulation, a dead oil rate injection condition of
60,000 bpd and 100 ∘F will be simulated; this rate provides a circulation
velocity of about 2 m/s in the flowline of Table 10.3, and under these
conditions, 1.5 flowline-riser volume displacement is expected to take place
within 9 hours.❦
❦ ❦
❦
10.5 Offshore Flowlines 263
20,000
Time: 0 h 1.5 h 4.5 h 3 h 6 h 9 h Elevation
Time: 0 h 1.5 h 4.5 h 3 h 6 h 9 h Elevation
Time: 0 h 1.5 h 4.5 h 3 h 6 h 9 h Elevation
40,000
Total length from topside inlet (ft)
Dead oil circulation
0 60,000 80,000 100,000 120,000 140,000
50,000 100,000 150,000
Total length from topside inlet (ft)
0
140
120
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.2
0.4
0.6
0.8
1
0
100
80
60
40
20
0
50,000 100,000 150,000
Total length from topside inlet (ft)
0
‒4,000
‒5,000
‒2,000
‒1,000
1,000
0
‒3,000
‒6,000
‒7,000
Elevation (ft)
Temperature (°F) Dead oil hold-up (‒) Hold-up (‒)
‒4,000
‒5,000
‒2,000
‒1,000
1,000
0
‒3,000
‒6,000
‒7,000
Elevation (ft)
‒4,000
‒5,000
‒2,000
‒1,000
1,000
0
‒3,000
‒6,000
‒7,000
Elevation (ft)
Figure 10.26 Flowline loop dead oil circulation profiles.
Figure 10.26 shows the DOC profile plot. The second graph shows that
the dead oil front is somewhat dispersed. The figure also shows that after 9
hours the flowline is filled with dead oil.❦
❦ ❦
❦
264 10 Multiphase Flow Simulations
0 2
4,000
3,000
2,000
120
100
200,000
150,000
100,000
50,000
0
100
80
60
40
20
0
80
60
40
20
0
1,000
Inlet pressure (psia) Outlet temperature (°F) Gas rate (MMSCF/d)
Liquid or DO rate (bpd)
0
6
Time (h)
Dead oil circulation trend results
4 10 8
0 6 2
Time (h)
4 10 8
0 6 2
Time (h)
4 10 8
0 6 2
Liquid
Dead oil
Time (h)
4 10 8
Figure 10.27 Flowline loop dead oil circulation trend.
Figure 10.27 shows the flowline DOC trend plot. Note that the maximum
required DOC inlet pressure is ∼3,000 psia. The liquid rate plot shows that
after 6 hours, only dead oil is received in the outlet node of the flowline loop.
10.5.19 Offshore Flowline Loop with Hot Oil Circulation
Example
In this section, it will be assumed that the DOC flowline from the previous
section was shut-in for 240 hours; therefore, the system is initially cold. In❦
❦ ❦
❦
10.5 Offshore Flowlines 265
order to limit the amounts of methanol during a restart, the operators replace
the cold dead oil with warm one in a process called hot oil circulation (HOC).
In this example, it will be assumed that the HOC conditions will
be 60,000 blpd at 140 ∘F. The HOC will last for 12 hours (two flowline
volumes).
Figure 10.28 shows the HOC profile plot. The first and second graphs show
a 100% dead oil-filled flowline system. The figure also shows that after 12
hours the topside outlet temperature is ∼80 ∘F. This simulation shows that
the HOC is successful in increasing the flowline temperature.
In general, the HOC increases the temperature sufficiently to help with
the hydrate management but not enough for complete wax resolution in case
paraffin deposits are present.
Figure 10.29 shows the flowline HOC trend plot; note that the maximum
required inlet pressure is ∼3,000 psia similar to the one obtained during the
DOC. The temperature plot shows that even after 20 hours the arrival topside
temperature is still about 80 ∘F.
10.5.20 Pigging Example
A pipeline inspection gauge or “pig” is used in the oil flowline systems for
several purposes such as
● liquid control,
● corrosion control,
● inspection,
● maintenance.
Pigging involves the use of a cleaning tool to remove debris and other
materials from the flowline. This operation is critical in ensuring the safe
and efficient operation of the system and in preventing blockages in the
flowline.
Multiphase simulation can be used to optimize pigging operations by pre￾dicting the behavior of fluids within the system under different operating
conditions and flow rates. This includes modeling the behavior of fluids dur￾ing the introduction of the pig into the flowline, as well as simulating the
effects of changes in temperature and pressure on the system. By simulating
these processes, operators can identify potential issues and develop strate￾gies to prevent overloading, slugging, sudden depressurization, and damage
to the flowline. The objective of the pig operation will determine the proper
initial conditions, the kick-fluid chosen, and the best pig velocity.
This section includes an example of a pig operation performed on the
inhibited flowline loop described in the planned shutdown section. The pig❦
❦ ❦
❦
266 10 Multiphase Flow Simulations
20,000 40,000
Total length from topside inlet (ft)
0 60,000 80,000 100,000 120,000 140,000
50,000
Total length from topside inlet (ft)
0 100,000 150,000
50,000
Total length from topside inlet (ft)
0 100,000 150,000
‒4,000
‒5,000
‒2,000
‒1,000
1,000
0
‒3,000
‒6,000
‒7,000
‒4,000
‒5,000
‒2,000
‒1,000
1,000
0
‒3,000
‒6,000
‒7,000
Elevation (ft)
Elevation (ft)
‒4,000
‒5,000
‒2,000
‒1,000
1,000
0
‒3,000
‒6,000
‒7,000
Elevation (ft)
0.2
0.4
0.6
0.8
1
0
Hold-up (‒)
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
Dead oil hold-up (‒) 140
160
120
100
80
60
40
20
0
Temperature (°F)
Hot oil circulation
Time: 0 h 1.5 h 6 h 3 h 12 h 24 h Elevation
Time: 0 h 1.5 h 6 h 3 h 12 h 24 h Elevation
Time: 0 h 1.5 h 6 h 3 h 12 h 24 h Elevation
Figure 10.28 Flowline loop hot oil circulation profiles.❦
❦ ❦
❦
10.5 Offshore Flowlines 267
0 5
100
10,000
0
20,000
30,000
40,000
50,000
60,000
70,000
80
60
40
20
12
10
8
6
4
2
0
0
Outlet temperature (°F) Gas rate (MMSCF/d) Liquid or DO rate (bpd)
Time (h)
Hot oil circulation trend results
10 15 20 30 25
0 5
Time (h)
10 15 20 30 25
5
Time (h)
0 15 20 30 10 25
0 5
Time (h)
10 15 20 30 25
Liquid
Dead oil
4,000
3,000
2,000
1,000
Inlet pressure (psia)
0
Figure 10.29 Flowline loop hot oil circulation trend.
will be assumed to have a 10.15-in. diameter, and it will be driven with a
60,000 blpd dead oil rate in order to achieve an average pig velocity of about
2 m/s.
Figure 10.30 shows similar behavior to Figure 10.26 (dead oil circulation)
but with less dead oil dispersion.❦
❦ ❦
❦
268 10 Multiphase Flow Simulations
20,000 40,000
Total length from topside inlet (ft)
0 60,000 80,000 100,000 120,000 140,000
Total length from topside inlet (ft)
0 50,000 100,000 150,000
Total length from topside inlet (ft)
0 50,,000 100,000 150,000
Time: 0 h 1 h 4 h 2.5 h 6 h 8 h Elevation
Time: 0 h 1 h 4 h 2.5 h 6 h 8 h Elevation
Time: 0 h 1 h 4 h 2.5 h 6 h 8 h Elevation
Pigging simulation
‒4,000
‒5,000
‒2,000
‒1,000
1,000
0
‒3,000
‒6,000
‒7,000
Elevation (ft)
‒4,000
‒5,000
‒2,000
‒1,000
1,000
0
‒3,000
‒6,000
‒7,000
Elevation (ft)
‒4,000
‒5,000
‒2,000
‒1,000
1,000
0
‒3,000
‒6,000
‒7,000
Elevation (ft)
140
120
0.1
0.2
0.3
0.4
0.5
0.6
0.7
0.8
0.9
1
0
0.2
0.4
0.6
0.8
1
0
100
80
60
40
20
0
Temperature (°F) Dead oil hold-up (‒) Hold-up (‒) Figure 10.30 Flowline loop pigging simulation profiles.❦
❦ ❦
❦
10.5 Offshore Flowlines 269
0 2
4,000
3,000
2,000
120
100
200,000
150,000
100,000
50,000
0
100
80
60
40
20
0
80
60
40
20
0
1,000
Inlet pressure (psia) Outlet temperature (°F) Gas rate (MMSCF/d)
Liquid or DO rate (bpd)
0
6
Time (h)
Pigging trend results
4 8
0 6 2
Time (h)
4 8
0 6 2
Time (h)
4 8
24 6
Time (h)
8
Liquid
Dead oil
Figure 10.31 Flowline pigging simulation trends (Part 1).
Figure 10.31 shows the flowline pig simulation trend plot; note that the
maximum required DOC inlet pressure is ∼3,000 psia similar to the one
obtained during the DOC.
Figure 10.32 shows the pig velocity, pig average velocity, and traveled dis￾tance as function of time. Note that the pig velocity is stable during the entire
pigging operation.❦
❦ ❦
❦
270 10 Multiphase Flow Simulations
0 2
Pig velocity (ft/s)
Avg. pig velocity (ft/s)
Pig distance (ft)
10
7.5
5
2.5
0
0
2
4
6
8
6
Time (h)
4 8
0 6 2
Time (h)
4 8
0 6 2
Time (h)
4 8
Pigging trend results
150,000
100,000
50,000
0
Figure 10.32 Flowline pigging simulation trends (Part 2).
10.6 Summary
This chapter addresses the normal production operation of multiphase
hydrocarbon production and also covers the common transient operations
that allow it to reach either the normal operation or the system shutdown.
Representative examples illustrate the thermal-hydraulic performance of
the production system hoping that such examples provide insight for future
designs and for the day-to-day operation of such gathering systems.
Needless to say, every project is different and the coverage of examples
in this chapter only intends to show typical trends and parameters and
to demonstrate the exceptional power of correctly using the simulation
tools available to design new systems and to monitor performance in
existing ones.❦
❦ ❦
❦
References 271
References
API Recommended Practice 14E (2007). Design and Installation of Offshore
Production Platform Piping Systems, 5e.
Courant, R., Friedrichs, K., and Lewy, H. (1928). Uber die Partiellen ˝
Differenzengleichungen der Mathematischen Physik. Math. Ann. 100: 32–74.
Pletcher, R., Tannehill, J., and Anderson, D. (2013). Computational Fluid
Mechanics and Heat Transfer, 3e. Boca Raton, Florida, USA: CRC Press.❦
❦ ❦
❦❦
❦ ❦
❦
273
11
Fluid–Solid Transport
The production of sand (i.e. sand fines) from oil and gas reservoirs is a for￾tuitous event, and the solids’ content is usually of the order of 1% volume
or less, creating liquid–solid flow throughout the production system with
potentially detrimental consequences. Obviously, higher concentrations are
feasible if a cure to the problem is not implemented in time.
Slurry flows are fundamentally an industrial process aimed at transport￾ing bulk solids with water, for chemical processes (e.g. coal transportation in
pipelines). Typically, a slurry represents a larger particulate content (more
than 10% in volume). Thus, dispersed sand fines through a flowline can be
considered a “light” slurry type of dispersed flow, with the suspended and
conveyed fines driven by drag forces affecting the pressure drop in the pipe
system.
An interesting phenomenon of slurries is the limited range of viable par￾ticles velocities as compared to the range of possibilities in the supporting
liquid continuum. Slurries could be characterized by the pipe Reynolds
number (driving the continuum) and the driving drag forces characteriz￾ing the relative motion between the continuum and the entrained solid
(Azbel 1981) particles (Reynolds number associated with the particles’ size
and the slip velocity). Both effects superimpose reaching a balance in slurry
flow or end up causing other effects such as solids deposition or even flow
blockage.
Gas–solid flows can be found in gas fields prone to produce sand fines
and also in several other industrial activities such as pneumatic conveying
(Crowe 2006, chapter 4). The gas phase is considered the continuum, and the
suspended solids are entrained due to drag forces. The industrial processes
(Marchello and Gomez-Plata 1976) are outside the scope of this appendix,
and there are quite a few examples of applications such as combustion of
crushed coal, pneumatic transport of small pellets, particulate pollution
control, sandblasting, and plasma-arc coating, among others.
Multiphase Transport of Hydrocarbons in Pipes, First Edition.
Juan J. Manzano-Ruiz and Jose G. Carballo.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
Companion Website: www.wiley.com/go/Manzano-Ruiz/Multiphasetransport❦
❦ ❦
❦
274 11 Fluid–Solid Transport
11.1 Characteristics of Solid–Fluid Flow
Single-phase phase flow is quite simple compared to fluid–solid two-phase
flow. The behavior and characteristics displayed by solid–liquid flow are
driven by particles’ parameters such as size, concentration, shape, and den￾sity. Also, the fluid’s rheological properties have a strong influence on the
two-phase flow performance. Major drivers of fluid–solid flow are as follows:
● Particle–fluid interaction. The drag force imposed by the fluid flow upon
the particles keeps the particles entrained (Azbel 1981) in the liquid
medium in a complex balance with other acting forces. This is typically
characterized by a drag coefficient (CD). For an in-depth analysis of the
nature of particle–fluid interaction forces, see Wallis (2020).
● Particle–particle interactions. Particles clash among themselves, depend￾ing on the solid’s concentration and spatial distribution, and such
collisions determine particles’ settling trend or particles’ suspension and
transportation.
● Buoyancy force and other forces. Particles’ motion is influenced by gravity
and buoyancy, while dragged by viscous force from the liquid medium.
Additionally, lift force (e.g. generated by Magnus effects) can be at play
contributing to the equilibrium state of acting forces.
● Particle concentration and spatial distribution. The concentration and dis￾tribution of solid particles produce flow patterns that determine the flow
behavior. Dilute suspensions, due to the low particle concentration, are
capable of following the flow field. Concentrated slurries have substantial
particle–particle interactions, which may lead to bulk agglomeration and
potential settling of particles.
● Flow Regimes. There are specific flow regimes depending on the preva￾lence of the previous factors. Particles may be entrained/suspended with
the fluid and transported along the flowline. If gravity force dominates
upon concentrated mixtures, the flow regime becomes settling on hori￾zontal flowlines. For inclined upward flow, fluidization is another flow
regime with the particles levitated/dragged in the bulk of the fluid.
● Rheology. Fluid viscosity and yield stress (e.g. mixtures with non￾Newtonian behavior) are the two principal rheological properties. Non￾Newtonian mixtures exhibit complex deformations under shear–stress
depending on the magnitude of the latter.
A rheogram plot provides useful insight regarding the relationship
between fluid stresses and the rate of strain due to fluid motion. Figure 11.1
illustrates a generic rheogram for a Newtonian fluid and three other
non-Newtonian fluids. A mixture of solid particles and a Newtonian❦
❦ ❦
❦
11.1 Characteristics of Solid–Fluid Flow 275
Shear stress
Shear strain
Pseudoplastic fluid
Plastic fluid
Newtonian fluid
Dilatant fluid
Generic fluids rheogram
Figure 11.1 Rheogram plot of solid–liquid two-phase fluids.
liquid can exhibit non-Newtonian mixture behavior depending on the
concentration and the average size of the particles.
A dilatant-fluid behavior is characterized by increased flow resistance
when the strain rate is increased (i.e. shear-thickening when flow rate is
increased). Shear-thickening behavior is fairly common in concentrated
suspensions of particulates.
A Newtonian fluid shows proportionality between flow resistance and
strain rate. Plastic fluid behavior has a limiting shearing stress value before
the fluid sets in motion and overcoming such a limit the plastic fluid exhibits
proportionality with rate of strain. On the contrary, a pseudoplastic fluid (i.e.
shear thinning) is easier to make it flow when the rate of strain is increased.
The non-Newtonian behavior is due to an intricate balance between
the particle–particle forces and the particle–fluid forces associated with
the fluid’s Newtonian viscosity and surface tension. Non-Newtonian
rheological properties can be described by simplified models derived from
empirical testing and illustrated by the rheogram plot. Accepted models to
capture the stress–strain performance of non-Newtonian fluids (Broadkey
1995) include Power Law, Powell–Eyring, Bingham plastic, Casson, and
Herschel–Bulkley, among others. Such models lead to defining the apparent❦
❦ ❦
❦
276 11 Fluid–Solid Transport
viscosity 𝜂 by equation (11.1) relating shear–stress (𝜏) and shear strain (𝛾),
𝜂 ≡ 𝜏
𝛾
(11.1)
A conclusion from equation (11.1) and Figure 11.1 is that the apparent
viscosity 𝜂 of a non-Newtonian fluid depends on the shear strain rate (i.e.
flow rate), whereas a Newtonian fluid exhibits a constant true fluid viscosity.
11.2 Fundamental Equations
This section addresses the basic one-dimensional governing equations
(Streeter et.al. 1988) to determine phase velocities and pressure drops.
These equations include properties such as the mixture density and the
mass diffusivity of the particles into the fluid.
The set of one-dimensional equations included in this section constitutes
a rigorous basis for the one-dimensional motion of solid–fluid mixtures in
pipelines. However, the set of equations is exceedingly intricate, even sim￾plifying or ignoring the detailed description of suspended particle motion
in a turbulent flow field (Azbel 1981), to add any value for a practical field
application. Thus, simplified models based on the methods presented in this
section provide a tenable approach for the cases encountered in field flow￾lines. Simplified models are covered in this section and in section 11.3.
11.2.1 Mixture Density
The mass density for solid–fluid mixtures can be defined by equation (11.2),
based on the average volumetric concentration csolid ( = 1−cfluid) of the
particles,
𝜌mix ≡ 𝜌solidcsolid + 𝜌fluid(1 − csolid) (11.2)
11.2.2 Fluid Phase Mass Conservation
The principle of mass balance for the fluid phase is given by equation (11.3):
𝜕
𝜕t
[𝜌fluid(1 − csolid)] + ∇∘[𝜌fluid(1 − csolid)V⃑fluid] = 0 (11.3)
11.2.3 Solid-Phase Mass Conservation
For the solid phase, the mass conservation principle is equation (11.4),
where DSL is the molecular diffusivity of the solid particles in the fluid
medium:
𝜕
𝜕t
[𝜌solidcsolid] + ∇∘[𝜌solidcsolidV⃑fluid] = ∇∘[DSL∇(𝜌solidcsolid)] (11.4)❦
❦ ❦
❦
11.3 Simplified Horizontal Flow Models 277
11.2.4 Solid–Fluid Mixture Mass Conservation
Adding equations (11.3) and (11.4) yields equation (11.5) in terms of V⃑mix
the mixture velocity,
𝜕
𝜕t
[𝜌mix] + ∇∘[𝜌mixV⃑mix] = 0 (11.5)
11.2.5 Mixture Momentum Equation
The momentum equation (11.6) involves the mixture’s stress tensor 𝜏∗
mix as
in single-phase flow:
𝜕
𝜕t
(𝜌mixV⃑mix) + ∇∘(𝜌mixV⃑mixV⃑mix)=−𝜌mixg∇z + (
∇∘𝜏∗
mix) (11.6)
11.2.6 Dilute Suspensions in Turbulent Flow
When the particles’ concentration csolid is low, of order 0.1% or less,
equation (11.6) can be simplified for dilute suspension neglecting the
gravitation and stress terms, yielding equation (11.7). See Brennen (2005)
for the criteria to identify the limits of dispersed flow regimes based on a
Froude number definition.
𝜕
𝜕t
(𝜌fluid) + ∇∘(𝜌fluidV⃑fluid) ≅ 𝜕
𝜕t
(𝜌mix) + ∇∘(𝜌mixV⃑fluid) ≅ 0 (11.7)
11.3 Simplified Horizontal Flow Models
The principal models covered in this section applied to solids transportation
through horizontal flowlines are the pseudo-homogeneous and the hetero￾geneous models. To better understand the logic behind these models, it is
important to review the flow regimes observed in real applications.
It is useful to visualize the variety of flow regimes possible for solid–gas
and solid–liquid pipeline flow. This visualization provides insight to
elaborate models that represent better the physics of the flow. Figure 11.2
illustrates typical flow regimes for horizontal flow of solid–liquid mixtures.
Pseudo-homogeneous, or simply “homogeneous,” flow may take place
when the solid particles are small in size and separated from each other
(i.e. dispersed flow). Obviously, the meaningful parameter to identify
particles’ separation is the distance ratio to the average particle diam￾eter. Pseudo-homogeneous suspensions are characterized by particles’
trajectories following the fluid’s streamlines.❦
❦ ❦
❦
278 11 Fluid–Solid Transport
Flow regimes
Flow with stationary bed
Moving bed saltation
(with and without suspension)
Heterogenous flow with
solids in suspension
Homogenous flow 2
1
Mean flow velocity
Particle size
Figure 11.2 Flow regimes for a settling solid–liquid mixture.
Heterogeneous models, on the other hand, embrace a variety of flow
regimes ranging from solids in suspension to settled and agglomerated
particles at the bottom of the pipe (i.e. stationary bed). These flow regimes
though exhibit random flowing patterns and carry larger size particles
entrained in the fluid.
From Figure 11.2, we can observe the sensitivity of regime transitions with
regard to mixture velocity. For a particular size of particles, we can modify
the flow regime from stationary bed, as shown in state 1, to homogeneous
flow (state 2) by increasing the mixture average speed. Also, when there is
substantial variance in particle sizes, for a given mixture velocity, we could
note intermittent transitions among two or more flow regimes.
11.3.1 Homogeneous Flow Model
The homogeneous model is an ideal state where small particles, of the order
of 100 μm or less, are entrained in the bulk of the fluid due to drag forces
while in balance with buoyance force. Also, typical solids’ concentration
by volume, csolid, to ensure model validity is of the order of 5% or less.
The distribution of particles is uniform, following the streamlines of the
carrier fluid.❦
❦ ❦
❦
11.3 Simplified Horizontal Flow Models 279
Figure 11.3 Pseudo-homogeneous solid–liquid mixture flow.
A qualitative sketch of pseudo-homogeneous mixture in horizontal flow
is depicted in Figure 11.3, showing the dispersion structure of solid particles
immersed in the liquid flow.
The modeling of this ideal flow regime follows the steps of homogeneous
equilibrium model (HEM) discussed for gas–liquid flow in Chapter 5. The
only departing consideration at this point for solid–liquid flow is the use of
a mixture viscosity based on Einstein’s equation (Govier and Aziz 1972) as
per equation (11.8):
𝜇hom,mix ≅ 𝜇liq(1 + 2.5csolid) (11.8)
The density of the homogeneous mixture is also evaluated with
equation (11.2). The friction factor to use in the momentum equation
depends on the transition Reynolds number, which for a Newtonian
mixture is of the order of 2000. Further information on the friction factors
for laminar and turbulent flow can be found in Chapter 11 of Nayyar (2000)
reference. With such equivalent properties, it follows that calculations for
pipeline transport of solid–liquid mixtures can be carried out with the set of
equations addressed in Section 5.9. This could include flow rate calculation
for a known pressure drop in a given pipeline span, or sizing of the pipeline
for given flow rate and pressure drop.
11.3.2 Heterogeneous Flow Model
The heterogeneous flow model considers distinct stages of suspended
particles, from fully suspended forming irregular patterns to fully settled/
sedimented (stationary bed) with few suspended particles. These generic
stages are illustrated by sketches in Figures 11.4–11.6.
The stage between fully suspended and fully sedimented particles is
an intermediate stage blending both characteristics. This intermediate
stage is referred to as moving bed with saltation (Govier and Aziz 1972).❦
❦ ❦
❦
280 11 Fluid–Solid Transport
Figure 11.4 Heterogeneous mixture flow with suspended particles.
Figure 11.5 Moving bed flow with saltation.
Figure 11.6 Mixture flow with stationary bed.❦
❦ ❦
❦
11.3 Simplified Horizontal Flow Models 281
Head loss gradient (Pa/m)
200
300
400
500
600
700
800
1,000
1,100
1,200
900
1.0 2.0 3.0
Slurry velocity (m/s)
4.0 5.0
2.5%
5%
Ud
7.5%
10%
12.5%
15%
Settled particles Suspended particles
Head loss gradient for different solid loading
(fine sand, 0.44 mm)
Figure 11.7 Slurry head loss gradient.
The latter refers to the uppermost particles that settle on top of the formed
dunes of particles, tumbling over one another causing top bed motion.
Larger particles form the stationary bed at the pipe bottom, and there
may be fine particles traveling above the bed entrained in the fluid. For an
in-depth coverage of the mechanistic models of particulate slurry transport,
please consult Chapter 7 of Cheremisinoff (1986) encyclopedia.
The stationary bed stage is dominated by either large-size particles sedi￾mented at the pipe’s bottom or by low fluid velocities allowing gravity forces
to overcome the drag forces.
Figure 11.7 shows a characteristic plot of head loss or pressure gradient
versus slurry velocity for horizontal flow of a mixture of particles with an
average size of 440 μm. The particle size may be considered above the limit
of small particles, and therefore it is considered in heterogeneous flow.
In Figure 11.7, we can observe the following features:
● For mixture concentrations below 5%, there is the possibility of having
settled solids.
● The curves of constant solid concentration exhibit a minimum, marked
with the dotted line and labeled as Ud (minimum deposit velocity).❦
❦ ❦
❦
282 11 Fluid–Solid Transport
● Fluid velocity below corresponding Ud enhances particle settlement.
● Fluid velocity above corresponding Ud enhances head loss but suspends
the particles.
● The larger the solids’ concentration, the larger the pressure gradient for
the same fluid velocity.
A simple pressure-loss model for heterogeneous solid–liquid mixtures
in flowlines has been summarized by Blevins (1992), assuming that the
fluid velocity exceeds the minimum deposit velocity calculated from
equation (11.13). This model can be applied to inclined upward flowlines,
varying from horizontal (𝜃 = 0∘) to vertical (𝜃 = 90∘). The pressure gradient
expression for stepwise calculations is given by equation (11.9).
dp
dx =
(𝜌liqV2
mix
2d
)
( fliq + fS cos 𝜃)+[𝜌liq + csolid(𝜌solid − 𝜌liq)]g sin 𝜃
(11.9)
The friction factor f liq in equation (11.9) can be estimated from the liquid
flow rate and the equations from Section 5.10. The friction factor f S in
equation (11.9) is obtained from Durand’s (1953) correlation referred to by
Blevins (1992):
fS = 85fliqcliq[
gd
V2
mix
√CD
(
𝜌solid
𝜌liq
− 1
)]1.5
(11.10)
The drag coefficient CD in equation (11.10) can be approximated
with Cheng’s (2009) correlation for Reynolds number below 2 * 105 by
equations (11.11) and (11.12):
CD = 24
Re (1 + 0.27Re)
0.43 + 0.47[1 − exp(−0.04Re0.38)] (11.11)
Re ≡ 𝜌liqdsolidVliq
𝜇liq
(11.12)
11.4 Minimum Deposit Velocity
This is the fluid velocity limit onset of particles settling at the bottom of a hor￾izontal flowline when the fluid velocity is reduced. An expression to estimate
the minimum deposit velocity (Saleh 2002) is equation (11.13):
Ud ≃ 1.32c0.186
solid (
dsolid
dpipe )0.167√√√√2gdpipe (
𝜌solid
𝜌liq
− 1
)
(11.13)❦
❦ ❦
❦
11.5 Sand Production 283
Equation (11.13) is empirical, and therefore it serves as a reference value
to approximate the minimum velocity required to maintain particles in sus￾pension assuming a heterogeneous flow regime.
11.5 Sand Production
Sand production from reservoirs is due to the weakening of the strength of
the rock and associated geomechanical local stresses in the wellbore and/or
the perforations (Bellarby 2009). Also, local loads caused by the well hole
itself, reduced pore pressure and formation water (Bellarby 2009) are major
contributing factors toward the fine production.
Sand production is a concern because it causes erosion in the production
system, for example, well tubing, valves, flowlines, and surface equipment
downstream, leading in due uncertain time to mechanical integrity risk
(i.e. loss of containment, leaks, fire, and explosion).
About 90% of hydrocarbon wells are located in sandstone reservoirs
(Bellarby 2009), and approximately one-third of sandstone reservoirs may
be prone to release sand. These rough figures explain the incidence of sand
fines production in the oil and gas industry. It is not the objective of this
chapter to dwell on the topic of rock strength, belonging to the field of
geomechanical, but only to point out the source of the commonness of the
sand production risk in the hydrocarbon exploitation process.
Often the sand production mechanism follows three distinctive stages
(Bellarby 2009), namely
● Transient sand production while the wellbore undergoes plastic deforma￾tions, with a characteristic peak production rate,
● A period of quasi-constant sand production rate when the hole is stable,
● Potential sand rate growth if the well drawdown is incremented in
pursuit of more hydrocarbon production or during speedy well start-up.
Also, late-life well operation at declined reservoir pressure may lead to
enhanced sand delivery.
There are two trends for mitigating the sand production issue. One trend
is to control sand production at the wellbore, and the second trend is to
tolerate some extent of production and cope with the issue (e.g. incremented
maintenance frequency and sand disposal). Some operating companies do
not accept the first trend because it leads to loss of productivity in the well,
potentially causing issues in future well workovers/recompletions, and
more costly interventions.❦
❦ ❦
❦
284 11 Fluid–Solid Transport
The second trend drives up preventive maintenance costs, system inter￾ventions, deferred production during pigging operations, sand collection at
separators, and cleaning and disposal costs of sand produced. Thus, it is not a
straightforward decision which trend to follow in any other field, but rather
it is a matter of judgment and practical experience one-on-one.
11.6 Sand Distribution
Hydrocarbon production has a long history of sand production data. Per ISO
14688 sand fines more often than not fall within the range of 60–200 microns
(ISO 2017). Sand grains up to 125 microns are classed as very fine sand,
and sand in the range of 125–250 microns is referred to as fine sand. Obvi￾ously, every field has its own sand probability distribution, which may shift
during production time. An example of a sand grain size cumulative distri￾bution is shown in Figure 11.8. This grain distribution has an average size
of 36 microns, and it can be considered very fine sand.
100%
90%
80%
70%
60%
50%
40%
30%
20%
10%
0%
0% 20% 40% 60%
Particle size (micron)
Cummulative distribution
80% 100%
Figure 11.8 Example of sand grain size distribution.❦
❦ ❦
❦
11.7 Pipe Erosion and Erosional Velocity 285
Figure 11.9 Microphotography of sand fine sample.
Sand samples are tested for weight of solids (typically in milligrams) and
volume of liquid filtered (usually in liters). Dividing the weight by the vol￾ume yields the TSS – total suspended solids – expressed in mg/lt. In the oil
industry, the TSS is converted into the FPS system and expressed in pounds
of solids per 1000 barrels by multiplying by the 0.3506 factor.
Sand composition is quite variable depending on the field. However,
sand composition usually contains oxygen, aluminum, silicon, potassium,
and iron. The silicon and oxygen weight composition dominate (i.e.
silicon oxide) over other components. Figure 11.9 shows an example of a
microphotography of a sample of sand.
11.7 Pipe Erosion and Erosional Velocity
The presence of sand fines in production flowlines is common in field
operations. Sand causes steel material erosion (i.e. metal material removal),
in particular, wherever the system exhibits a change in flow direction
(e.g. elbows, valve internals). Gas flowlines usually operate at high fluid
velocity, and if some sand fines are entrained such applications will carry❦
❦ ❦
❦
286 11 Fluid–Solid Transport
high integrity risk. Most flowlines in field applications operate in turbulent
flow regime, which enhances the damaging effect of erosion due to particle
impact driven by the Reynolds’ stresses. Pipe erosion sometimes is present
in combination with corrosion, causing an intensified process threatening
the mechanical integrity of the system.
From a best-practice viewpoint, there is the API RP 14E (2007) standard
offering a simple methodology, based on the erosion velocity concept, to
verify the risk for flowlines exposed to solid–fluid mixtures. This standard
recommends a conservative criterion for the maximum safe operating veloc￾ities which some other organizations have indicated could be made more
flexible depending on the particulate’s concentration.
Erosional velocity is defined in Section 2.5.a. of API RP 14E (2007), to
address erosion risk concerns in flowlines, manifolds, headers, and bends
transporting solid–fluid flow. Equation (11.14) for erosional velocity per API
RP 14E is
Verosion = C
√𝜌mix
(11.14)
The velocity in the equation above is in m/s, and the mixture density is in
Kg/m3. The constant “C” in equation (11.14) depends on the type of service
(continuous, sand-free, or intermittent). The values for constant C recom￾mended by API RP 14E (2007) are
● C=122 to 152 for continuous solid-free service
● C=183 to 244 for continuous solid-free service with corrosion inhibitor
present
● C=305 for intermittent service
● C<122 for continuous service with solids
11.8 Application Examples
Example 11.1
Determine the minimum deposit velocity for sand particles, 220 μm of
average size, flowing entrained in a production stream of hydrocarbon
condensate having a specific gravity equal to 0.78. The flowline has an
internal diameter of 154 mm. Assume the sand density is about 2070 Kg/m3,
and the solids’ concentration is 12% volume.
The condensate’s density is 780 Kg/m3. The minimum deposit velocity is
calculated from equation (11.13) as 0.67 m/s.
Ud = 1.32(0.12)
0.186(0.22
154
)0.167√
2∗9.81∗0.154 (2070
780 − 1
)
= 0.67 m
s❦
❦ ❦
❦
References 287
Example 11.2
Estimate the maximum allowable oil velocity in a flowline of 193.7 mm
ID following the erosion criterion stated by API RP 14E (2007). Consider
continuous service with corrosion inhibitor and no sand, and continuous
service with sand but no corrosion inhibitor. Assume the oil’s gravity is a
32.4∘ API and the concentration of sand fines (density≈2100 Kg/m3) is less
than 5% volume.
The crude oil density is 𝜌oil =
(
1000 Kg
m3
) ( 141.5
131.5+32.4)
= 863 Kg
m3
From equation (11.2), we have
𝜌mix ≡ 𝜌solidcsolid + 𝜌fluid(1 − csolid) = 2100∗0.05 + 863∗(1 − 0.05) = 925 Kg
m3
Using equation (11.14), and assuming a constant C = 122 for continuous
service with corrosion inhibitor added, and a constant C =80 for continuous
service with solids, we get the following conservative estimates:
● Maximum velocity with corrosion inhibitor Vmax = 122
√
925 = 4.0 m
s
● Maximum velocity flow without corrosion inhibitor Vmax = 80 √
925 = 2.6 m
s
In general, the effectiveness of a corrosion inhibitor is less than perfect,
because it might be unevenly distributed within the bulk of the produc￾tion stream. For this example, to be on the safe side, it is likely to limit
the maximum velocity to 2.6 m/s and the corresponding flow to 0.077 m3/s
(= 41,845 bpd).
References
API Recommended Practice 14E (2007). Recommended Practice for Design and
Installation of Offshore Production Platform Piping Systems, 5e. Reaffirmed.
Azbel, D. (1981). Two-Phase Flows in Chemical Engineering. Cambridge, UK:
Cambridge University Press.
Bellarby, J. (2009). Well Completion Design. Amsterdam, The Netherlands:
Elsevier.
Blevins, R. (1992). Applied Fluid Dynamics Handbook. Malabar, Florida, USA:
Krieger Publishing Company.
Brennen, C. (2005). Fundamentals of Multiphase Flow. Cambridge, UK:
Cambridge University Press.
Broadkey, R. (1995). The Phenomena of Fluid Motions. New York, USA: Dover
Publications Inc.❦
❦ ❦
❦
288 11 Fluid–Solid Transport
Cheng, N. (2009). Comparison of formulas for drag coefficient and settling
velocity of spherical particles. Powder Technology 189: 395–398.
Durand, R. (1953). Basic relationship of the transportation of solids in
pipes-Experimental research. In: Proceedings of IAHR Congress.
Minneapolis, Minnesota, USA: Hydraulics Research.
Cheremisinoff, N. (ed.) (1986). “Encyclopedia of Fluid Mechanics,” Volume 5
“Slurry Flow Technology”. Houston, Texas, USA: Gulf Publishing Company.
Crowe, C. (ed.) (2006). Multiphase Flow Handbook. Boca Raton, Florida, USA:
CRC Taylor & Francis Group.
Govier, G. and Aziz, K. (1972). The Flow of Complex Mixtures in Pipes.
New York, New York, USA: Van Nostrand Reinhold Company.
International Organization for Standardization, (2017), “Geotechnical
investigation and testing-Identification and classification of soil-Part 1:
Identification and description” ISO 14688-1:2017.
Marchello, J. and Gomez-Plata, A. (1976). Gas-Solids Handling in the Process
Industries. New York, USA: Marcel Dekker Inc.
Nayyar, M. (ed.) (2000). Piping Handbook. New York, New York, USA:
McGraw-Hill.
Saleh, J. (ed.) (2002). Fluid Flow Handbook. New York, New York, USA:
McGraw-Hill.
Streeter, V., Wylie, E., and Bedford, K. (1988). Fluid Mechanics, 9e. New York,
New York, USA: McGraw-Hill.
Wallis, G. (2020). One-Dimensional Two-Phase Flow. Garden City, New York,
USA: Dover Publications Inc.❦
❦ ❦
❦
289
Appendix A
Multiphase Flow Software Tools
This appendix addresses some of the existing codes to simulate multiphase
flow through pipelines. The codes described herein are representative but it
is not an exhaustive list of tools.
A.1 Thermodynamics and Transport Properties
Simulators
Any dynamic simulation code will require a solid estimator of ther￾modynamic properties such as phase densities, fraction of each phase,
compressibility factor, and speed of sound. Likewise, transport properties
such as dynamic viscosity, thermal conductivity, and mass diffusivity will
be necessary to support the mass, energy, and momentum conservation
equations.
The properties’ simulators use equation of state (EOS), fundamentally
cubic functions capable of doing straightforward flashing calculations to
estimate the fraction of either phase. Such simulators are used in two ways,
for either generation of look-up tables of properties or as compositional
models that estimate point-to-point the necessary parameters at each cell
of the grid.
The use of comprehensive look-up tables saves substantial amount of
time during the dynamic simulation because the properties are interpolated
frequently by a linear method. The property tables are commonly developed
using pressure–temperature or pressure–enthalpy independent variables.
Thus, a fast interpolation point-to-point provides a good approximation at
low cost in terms of computing time. The drawback of this methodology
lies when different fluids commingle at tees or manifolds. In this case, the
resulting mixture stream does not have a specific pre-calculated table for
quick interpolation. Therefore, for such a mixing case, the streams’ tables
Multiphase Transport of Hydrocarbons in Pipes, First Edition.
Juan J. Manzano-Ruiz and Jose G. Carballo.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
Companion Website: www.wiley.com/go/Manzano-Ruiz/Multiphasetransport❦
❦ ❦
❦
290 Appendix A Multiphase Flow Software Tools
have to be combined at each commingling point, at each time integration
interval, to estimate mixed properties weighed with the instantaneous flow
rate of the streams.
The compositional modeling of fluid properties may be orders of magni￾tude more time-consuming than the look-up tables because at each integra￾tion step the thermodynamics flashing is carried out. However, this method￾ology can handle well the mixing case of flow streams and generates more
accurate properties’ estimates than linear interpolation in tables.
Currently, a short list of popular commercial codes to generate fluid
properties are Pvtsim Nova®, Multiflash®, Aspen Hysys®, Refprop®, and Pvtp®,
because most of them seamlessly interface with the most common dynamic
codes. A brief description of each of these software follows. Detailed
information has to be sought through the links provided.
A.1.1 Pvtsim Nova® (Calsep, https://www.calsep.com/pvtsim￾nova/)
This product from Calsep A/S Copenhagen, Denmark, has been in the
market for over 30 years. The code includes several EOSs and offers several
packages: Basic PVT, PVT Lab, Reservoir, Flow Assurance, and Wax
deposition.
There is also a specific package to interface with Schlumberger’s OLGA®
and Kongsberg’s LedaFlow® dynamic simulators. Pvtsim comes as a
standard module complemented by specialized modules. The base mod￾ule provides compositional input including molar/weight percentage with
molecular weights and densities input for each C7
+ fraction, or extended gas
chromatograph (GC) fluid analyses. Several options of the Peng–Robinson
(PR) and Soave–Redlich–Kwong (SRK) cubic EOS are available with
volume-translation correction. The PC-SAFT EOS is available for general
flash and PVT simulations, and the GERG-2008 EOS is recommended for
high-accuracy gas properties’ predictions such as gas Z-factors and dew
points.
The flash and unit-operation module provides several phase envelope
options such as pressure versus temperature, pressure versus enthalpy,
pressure versus entropy, volume versus temperature, and enthalpy versus
entropy. Phase-equilibrium calculations yield K-constants. Water satu￾ration of the gas mixtures can be performed with this module too. Flash
calculations include phase percentage split, fluid composition, molar
volume, density, Z-factors, enthalpy, entropy, specific heat, Joule–Thomson
coefficient, velocity of sound, viscosity, thermal conductivity, surface
tension, and fugacity.❦
❦ ❦
❦
A.1 Thermodynamics and Transport Properties Simulators 291
Additional modules, useful for flow assurance risk assessment, include
the hydrate module, the wax module, the asphaltene module, and the scale
module.
A.1.2 Multiflash® (KBC, https://www.kbc.global/software/
advanced-thermodynamics/)
This code offered by KBC-Yokogawa company is an advanced thermody￾namics software focused on pipeline simulation work. This product comes
integrated with Schlumberger’s Pipesim steady-state software for composi￾tional calculations. Multiflash performs PVT modeling to match PVT lab
reports, flow assurance risks such as wax, asphaltene, and scale, and pre￾dicts physical properties from the reservoir to the refinery. In general, most
features available in PVTsim Nova can be found in Multiflash too.
Multiflash is a PVT and physical properties package that allows modeling
the phase behavior of complex mixtures and pure substances for upstream
flow assurance and production processes simulation in the oil and gas indus￾try. Multiflash can model hydrates, waxes, asphaltenes, and halide scales, as
well as track the partitioning of potentially damaging substances such as
mercury (Hg) and hydrogen sulfide (H2S).
Multiflash offers several valuable interfaces such as Excel, Cape-Open,
Visual Basic, and API to facilitate the I/O of data and predictions. Multiflash
PVT Lab® supports an advanced set of tools for EOS tuning that includes
fluid characterization from either compositional or black-oil data, model
tuning by fitting to data from PVT lab tests, and quality control of the
PVT data.
A.1.3 Aspen Hysys® (Aspentech, https://www.aspentech.com/
en/products/engineering/aspen-plus)
This code is a broader tool going beyond properties’ prediction. This software
is a Process Engineering powerhouse to simulate streams, unit-operation
equipment, whole plant performance, and even make cost estimations with
additional modules. Hysys software evolved as a fine tool from the precursor
Hysim developed in the 1980s, one of the first interactive codes for chemical
engineers. ASPEN Hysys has a large database of components and a thorough
list of EOS at the user’s disposal.
Aspen Plus® and Aspen Hysys have a long history in the process engineer￾ing market. The two software offer application programming interfacing
with the majority of the commercial steady-state and transient codes,
making these tools a convenient companion to estimate fluid properties for
pipeline multiphase flow simulations. Aspen Plus and Hysys go well beyond❦
❦ ❦
❦
292 Appendix A Multiphase Flow Software Tools
performing phase-equilibrium calculations and properties’ estimation.
Each software has a broad spectrum of simulation capabilities for unit
operations, to design production facilities, to size process to equipment,
to summarize facilities specs, and cost estimate the facilities. These codes
have been developed to support not only the upstream, midstream, and
downstream hydrocarbon industry but also the chemical industry in
general.
Aspen Plus and Hysys are supported by an extensive database of simple
substances with all the thermodynamic properties. The database includes
default binary interaction parameters that can be changed by the user. The
software allows us to define molar/weight mixtures of basic components and
to choose from a lengthy list of equations of state. The EOS applies to a broad
range of temperature and pressure, including subcritical and supercritical
conditions. The software can also model hydrocarbon mixtures that include
species such as H2S, N2, and CO2.
Some of the EOS and activity coefficient options are
◾ Redlich–Kwong
◾ Soave–Redlich–Kwong (SRK)
◾ Redlich–Kwong-ASPEN
◾ Soave–Redlich–Kwong-MHV2
◾ Soave–Redlich–Kwong-WS
◾ Peng–Robinson (PR)
◾ Peng–Robinson-MHV2
◾ Peng–Robinson-WS
◾ Lee–Kesler
◾ Chao–Seader,
◾ Grayson–Streed,
◾ UNIQUAC, and
◾ UNIFAC.
A.1.4 Refprop® (NIST, https://www.nist.gov/srd/refprop)
Refprop is a code developed by the National Institute of Standards and Tech￾nology (NIST), USA. This code offers fewer EOS options as compared to
the other codes indicated before, a limited number of components to simu￾late hydrocarbon mixtures, and does not have the capacity to deal with C7
+
fractions for characterization. Despite these limitations, Refprop is a remark￾ably accurate simulation tool within the range of application. Most other
commercial codes usually offer the option to perform calculations using Ref￾prop subroutines for accurate results.
This code offers the most accurate EOS models currently available:
high-accuracy Helmholtz energy equations of state, international standard❦
❦ ❦
❦
A.1 Thermodynamics and Transport Properties Simulators 293
equations for water, a variety of equations applicable to hydrocarbons,
ammonia, carbon dioxide, and others. The Benedict–Webb–Rubin (BWR)
equation of state is an additional option for the top accuracy predictions
near the critical point, and an extended corresponding states model can be
used for fluids with limited data. For mixtures of hydrocarbon, the excess
Helmholtz energy model gives excellent prediction for fluid properties.
The American Gas Association equation AGA8 (as an alternative to the
Helmholtz model) is another choice for natural gas properties.
Viscosity and thermal conductivity are based on fluid-specific correlations
(where available), either as a modification of the extended corresponding
states model or from the friction-theory model. An extensive list of available
properties includes density, internal energy, enthalpy, entropy, specific
heats, sound speed, compressibility factor, Joule–Thomson coefficient, gas
quality, second and third virial coefficients, second and third acoustic virial
coefficients, Helmholtz energy, Gibbs energy, heat of vaporization, fugacity,
fugacity coefficient, chemical potential, K-values, thermal conductivity,
dynamic viscosity, kinematic viscosity, thermal diffusivity, Prandtl number,
surface tension, isothermal compressibility, isentropic coefficient, adiabatic
compressibility, and several important derivatives of thermodynamic
functions.
A.1.5 Pvtp® (Petroleum Experts, https://www.petex.com/
products/ipm-suite/pvtp/)
Pvtp comprises thermodynamically consistent and precise EOS models for
fluids, offering lumping and de-lumping algorithms embedded into the pro￾gram to enable the user to create integrated systems in a straightforward
and consistent manner. Pvtp enables the user to perform and validate Pvtp
analyses by matching compositions to data available. Special treatment of
pseudo-components with quality checks enables a consistent set of param￾eters while offering a variety of regression techniques.
The Peng–Robinson and SRK EOS models in their original form have well￾known limitations when dealing with polar molecules, such as water and
CO2. To overcome these limitations, Pvtp modified the EOS to predict accu￾rately properties of CO2. Pvtp includes two- and three-phase flash engines
to facilitate the iterative calculations.
A.1.6 Dwsim®
This is a new software tool for simulating process plants and esti￾mating fluid properties. Dwsim is an open-source CAPE-OPEN
compliant software, and the basic version can be downloaded for
free. The thermodynamic models included are GERG-2008, PC-SAFT,❦
❦ ❦
❦
294 Appendix A Multiphase Flow Software Tools
CoolProp, Peng–Robinson, Peng–Robinson (1978), Soave–Redlich–Kwong,
Lee–Kesler, Lee–Kesler–Plöcker, UNIFAC, modified UNIFAC (Dort￾mund), UNIQUAC, NRTL, Chao–Seader, Grayson–Streed, Raoult’s law,
IAPWS-IF97 steam tables, IAPWS-08 seawater, black oil, and sour water.
The software includes the following utilities: phase envelope, hydrate calcu￾lations, pure component properties, critical point, spreadsheets, petroleum
cold flow properties, pseudo-component creator, bulk C7
+ component, and
distillation curves petroleum characterization, among others.
A.2 Steady-State Multiphase Simulators
The simulation of steady-state performance is necessary not only for reg￾ular normal operations but it also is necessary to create the preliminary
scenario before simulating a transient process such as ramp-up and run￾down, shutdown, and well start-up. Normal operation is by far the longest
activity during the field life cycle.
Among the several multiphase flow steady-state operation simulators,
we have the following brief list.
A.2.1 Pipesim® (SLB, https://www.software.slb.com/products/
pipesim)
The major features of the Pipesim software are:
Multiphase flow regime modeling. Mechanistic models based on the pre￾vailing flow pattern can be invoked by the user. For instance, the Tulsa mod￾els, the Olga-S model, and the Beggs–Brill model perform analyses based on
the established flow regime at any cell of the system’s physical domain. This
software can predict the risk of severe slugging in risers, hydrodynamic slug￾ging, and slug size and frequency. These features enable the user to optimize
line sizing design and downstream processing facilities.
Variety of gas–liquid models. Pipesim includes a diversity of industry￾standard multiphase flow correlations as well as advanced three-phase
mechanistic models, including Olga-S steady state, LedaFlow, and The
University of Tulsa Fluid Flow Projects (TUFFP) unified model. These
models enable the calculation of flow regimes, liquid holdup, slug char￾acteristics, and pressure loss for all nodes along vertical and horizontal
production paths at all inclinations. With this capability, users can design
and operate production gathering and distribution systems for different
life-cycle scenarios.
Heat transfer losses to the environment. The prediction of heat transfer
losses is paramount to predict temperature profile, fluid properties, and❦
❦ ❦
❦
A.2 Steady-State Multiphase Simulators 295
solids formation, and to assist the thermal design of the production system.
The Pipesim simulator performs comprehensive point-to-point energy￾balance calculations that involve heat transfer phenomena, such as forced
and free convection, molecular heat conduction, Joule–Thomson cooling
and heating, and frictional heating. The user can specify the internal and
external heat transfer coefficient calculations. Analytical heat transfer
models for convection in buried and partially buried pipes are another
option to forego complex finite-element numerical methods.
Fluid property estimation. The simulator offers industry-standard black
oil correlations and a vast range of EOS for compositional modeling
point-to-point. This includes Peng–Robinson (standard and corrected),
SRK (standard and corrected), Cubic Plus Association (CPA), BWRS, and
GERG-2008, among others.
Well performance and nodal analysis. The simulator can model vertical
and inclined multiphase flow from the reservoir to the wellhead. Artificial
lift options such as rod pumps, progressing cavity pumps (PCPs), electric
submersible pumps (ESPs), and gas lift are included. Well performance is
carried out with nodal analysis to create inflow–outflow plots at any point
in the system and perform sensitivity analyses on any system variable.
Slugging. Pipesim offerssevere slugging and hydrodynamic slugging model￾ing options. These scenarios can occur in systems consisting of a long flow￾line followed by a riser.
Networks. The complex topology of certain onshore production and injec￾tion networks is another upside Pipesim for the software. The simulator
provides users with an advanced network solver of the set of nonlinear
equations, of any size and topology. This capability truly considers the
interdependency of wells and surface equipment to determine system
deliverability. Furthermore, the built-in GIS network canvas delivers true
spatial representation of wells, equipment, and flowlines, to construct
networks interactively.
Facilities. One important feature of Pipesim is the simulation capability
for integrated facilities that define the upstream or downstream boundary
conditions for the production system. Equipments such as chokes, check
valves, multiphase flow pumps, single-phase pumps, separators, gas com￾pressors, heat exchangers, and chemical injection devices can be added to
the production network.
A.2.2 Gap® and Prosper® (Petroleum Experts, https://www
.petroleumexperts.com/products/ipm-suite/gap/)
Gap is a multiphase network modeling and optimization tool focused on
applications for the oil and gas industry. Prosper is a well simulator for❦
❦ ❦
❦
296 Appendix A Multiphase Flow Software Tools
multiphase flow production. Key features of these software include the
following:
Integration. The software was designed to eliminate artificial boundary
conditions in reservoir, well, and surface network models, through the cre￾ation of integrated models.
Solver. The fundamental calculations performed by the software balance
the principal parameters of pressure, flow, and temperature for the whole
production system. This task demands a fast and stable solver built for
unraveling fully integrated oilfield networks. Stability is a challenging
issue of intricate systems, and optimization is a step further. Nonlinear
global optimization is facilitated by the software because the user does
not have to provide starting points, and intelligence built into the system
allows for selecting the appropriate technique depending on the problem
at hand.
Well performance. The performance of wells is typically handled by
embedding Prosper software models in the integrated system, although
dynamic well models can be captured through native gap calculations.
Wells can therefore be evaluated and optimized over time with respect to
the back pressure response of the entire network. Design and performance
can be assessed through the life span of each well, considering artificial lift
(pumps, gas lift, and plunger lift).
Compositional support Gap can handle different PVT descriptions that are
used in the reservoir, wells, and surface network. The compositional model
can use the lumped composition and can perform de-lumping to a larger
composition. Either the black oil model or the compositional model offers
options to enhance performance and computational speed for the large inte￾grated models.
A.2.3 Olga-S® (SLB)
Olga-S is a subset of the popular transient Olga software, later described
in this appendix. This software uses mechanistic models to simulate each
flow regime in pipeline multiphase flow, determining the relevant flow
properties and parameters such as pressure drop, holdup, and flow regime.
Olga-S was developed by SLB in cooperation with the Institute for Energy
Technology (IFE) and SINTEF (Multiphase Flow Laboratory, Trondheim,
Norway). Olga-S is delivered in binary form as a library that can be dynam￾ically linked to a driver program. Most steady-state pipeline simulators
have Olga-S incorporated as a flow correlation, in addition to the standard
correlations.❦
❦ ❦
❦
A.3 Transient Multiphase Simulators 297
A.2.4 Pipephase® (Simsci-Esscor, https://www.sm-iot.net/
aveva-pipephase)
This software has been used for planning studies for an entire field.
Pipephase Pipeline Network Design covers the complete range of fluids
encountered in the petroleum industry, including single-phase, black
oil, and compositional mixtures. The field-proven network simulation
capability in Pipephase enables the user to model large networks of wells,
flowlines, and production facilities. The wellbore model has several inflow
performance (IPR) libraries, combined with a complete set of surface equip￾ment modules, allowing the user to configure the downstream separation
facilities.
The program may also be applied to single-component stream or CO2
injection networks. Pipephase integrates with model reservoirs by develop￾ing an interface with reservoir simulators, allowing the simulation of CO2
sequestration and steam-enhanced oil recovery of extra-heavy oil (Steam￾Assisted Gravity Drainage – SAGD).
The software provides thermodynamic property prediction required to
simulate complex oil and gas gathering networks, natural gas transmission
and distribution pipelines, steam injection networks, CO2 pipelines, gas
lift analysis, heat transfer analysis for heavy oil pipelines, and hydrate risk
prediction among other applications
A.3 Transient Multiphase Simulators
Transient codes are the top multiphase fluid flow simulators requiring sta￾ble integration schemes such as the implicit methodology. The development
of transient codes trails the availability of test data gathered at research insti￾tutions. Two examples of these institutions are SINTEF in Norway and the
University of Tulsa Fluid Flow Projects (TUFFP). Currently, two or three
software have the lead in transient multiphase simulation of oil and gas flow￾lines, as described below.
A.3.1 Olga® (SLB, https://www.software.slb.com/products/
olga/)
Olga is the oil and gas workhorse simulator developed in the early 1980s,
for the analysis of pipeline operations, through the collaboration of IFE
and SINTEF. Along the years, Olga has been supplemented with specific
modules such as hydrodynamic slugging (Slugtracking®), advanced heat❦
❦ ❦
❦
298 Appendix A Multiphase Flow Software Tools
transfer (FEMTherm®), tracking of individual components (Comptracking®),
well modeling (Olga Wells®), wax (Olga Wax®), hydrate risk (Olga Hydrate
Kinetics®), multiphase pumps, non-Newtonian behavior (Complex Fluids®),
advanced modeling of the hydraulics (Olga HD®), corrosion, and prediction
of single-component flows.
Olga is a transient 1-D multiple-phase model, numerically supported with
an implicit numerical scheme applied on a staggered grid. Although Olga
has been developed to deal with slow transients, it also can handle extremely
fast transients.
The Olga Online® production management system uses live production
data to reveal the multiphase flow behavior of the wells, flowlines, and
network performance in real time. Accessible through a web browser, Olga
Online has highly specific capabilities providing results during changing
production and field conditions to support operational decision-making
and production optimization. This software capability gives insight into
critical variables of the operation, such as liquid distribution, pipeline
pressures and temperatures, flow rates, and holdup profiles, and it is also
a tool for operator training purposes, instrumentation back-up, and data
inputs to other disciplines. The solution is delivered with the standard
Real-Time Digital Twin Core; other modes are available to provide digital
views of the production system under various simulation scenarios.
Two features of Olga Online are the Look Ahead Mode and the What If
Mode. Look Ahead can visualize what will happen to your flow over time to
anticipate where action would be required. Starting from current operating
conditions, the user can run forward-looking dynamic simulations, to fore￾cast future production parameters and potential upsets, and receive advisory
suggestions to keep your operation at optimum levels. The What if Mode
is a tool used offline to change the input variables in order to understand
how changes to the operating conditions will impact operating efficiency
and optimum performance.
Olga Online also offers the Leak Detection System® (LDS) option that
detects leaks in pipelines and networks using real-time data from the field
control system or production historian. The LDS is applicable to both single
and multiphase flows. This is achieved by comparing field pressure and
flow transients with results from the Olga simulator coupled with statistical
and mathematical algorithms. In addition, advanced pattern recognition
logics are used to solidify the solution’s accuracy.
Olga’s Real-Time Digital Twin Core® is a replica of your wells and pro￾duction network. It is used for solids formation risk analysis and integrity
management purposes, such as erosion and corrosion control, leak detection❦
❦ ❦
❦
A.3 Transient Multiphase Simulators 299
and, through its offline planning mode, evaluating the impact of planned
operational changes to improve operational behavior forecasting.
A.3.2 LedaFlow® (Konsberg, https://ledaflow.com/)
LedaFlow can be used for one-, two-, and three-phase applications and
has additional modules: Engineering 1D® stand-alone, Steady-state®, Profile
2D®, Quasi-3D®, Integrated Simulator®, and Online® monitoring tool. The
LedaFlow approach includes detailed modeling of water and oil dispersions
and gas bubbles in liquid phase. It also allows for modeling of three-phase
flows with solid particles such as sand and hydrates.
LedaFlow development has been supported by access to the experimental
data from SINTEF in Norway. The other experimental database used is from
TILDA® (database of test data acquired at SINTEF’s Multiphase Flow Lab￾oratory). The TILDA experiments include up to 12” diameter experiments,
up to 90 bar pressure, single-phase flow (gas, oil, or water), two-phase flow
(oil/gas, water/gas), three-phase flow (oil/water/gas), and particle (sand)
transport in single- and two-phase flow. Furthermore, the development of
LedaFlow has benefited from a close collaboration with its industrial part￾ners, who made experimental and field data available to validate the accu￾racy of LedaFlow code. The latter includes data from gas/condensate and
oil-dominated systems, broad range of GOR and WC, pipe diameters ranging
from 2′′ to 38′′, and a large variation in operational pressure.
LedaFlow has a multi-temperature approach for gas, oil, and water as
opposed to the conventional mixture temperature approach. This leads to
more accurate temperature and heat loss predictions. The software com￾prises separate momentum equations for gas, oil, and water, whereas other
codes may use only two momentum equations. This leads to an improved
calculation of the oil–water momentum exchange and slip among phases.
The nonequilibrium modeling concept inherent in all LedaFlow modules is
superior to existing models assuming equilibrium or near-equilibrium flow.
A unique formulation has been developed which enables simulation and
visualization of waves, slugs, droplets, and bubbles in a multiphase pipeline
flow. This formulation has been implemented in the Quasi-3D (Q3D) and
cross-sectional (2-D) profile modules. The Q3D model resolves the dynamics
of the flow and distribution of phases in multiple dimensions based on a
consistent CFD formulation. The profile model (2-D) gives information on
the velocity profile in the cross-section of the pipe.
LedaFlow fully integrates all its models: steady-state, 1-D transient, pro￾file model (2-D), and quasi-3D model (Q3D). Thus, the steady-state model is
used for the initialization of the 1-D transient calculations. The 1-D model❦
❦ ❦
❦
300 Appendix A Multiphase Flow Software Tools
will give a fast transient solution for long pipes. The profile model (2-D)
can use the values from a 1-D simulation as input for its calculation of the
phase velocities and volume fractions across the pipe diameter. The quasi-3D
model will be used to get detailed information on the critical pipe segments
of the production system (looking glass).
LedaFlow can be used as an operation monitoring tool to ensure optimal
performance during several operational stages such as commissioning, well
start-up and shutdown optimization, chemical use minimization, optimal
well allocation, monitor well and flowline performance, estimate flowline
holdup, detect leaks, look ahead, and calculate cooldown time among other
objectives.
A.3.3 Gap Transient (Petroleum Experts, https://www.petex
.com/products/ipm-suite/)
Gap Transient® is another enabling tool for field operation management,
optimization, forecasting, and development. This tool can model terrain￾induced or hydrodynamic slugging, liquid loading, wax formation, and
hydrate formation with easy switching between steady-state and transient
modeling.
Gap Transient harnesses the functionality from Pvtp and Prosper to model
well and flowline integration. Transient models require accurate boundary
conditions to capture the physics and the changes that are happening in the
field. Gap transient models transient multiphase flow as well as transient
reservoir performance. The integration of transient reservoir performance
response allows more accurate prediction of early-time behavior of wells
that dominate in the timescales of transient modeling. Well start-up and
the impact of changes due to optimization of the well controls are dras￾tically affected. Unconventional reservoir production, in tight-oil/shale oil
and gas plays as well as more complex reservoir performance in heavy oil, or
dual-porosity reservoirs all exhibit reservoir behaviors that can create com￾plex boundary conditions for transient multiphase flow modeling.❦
❦ ❦
❦
301
Index
a
Aboveground 180
Absorption 29
Acceleration 6, 8, 20, 99, 108,
125–126
Accelerational pressure gradient
99, 111, 157
Accessories 5, 7, 20, 112
Acentric 50, 54
Adaptive 112, 214
Additives 195
Adhesive 182, 186, 191
Adiabatic 70, 157, 169–170, 293
Aerogel 182–183, 187
Agglomerated 69, 274, 278
Alkanes 50, 54, 61
Allocation 23–24, 30–31, 123, 300
Ambient 181, 235–236, 240, 249,
253, 258
Analog 12, 184, 210
Annular-dispersed 76
Annular flow 3, 12, 69, 71–73,
76–77, 79, 93, 98, 105–106,
131, 137, 139, 141–143,
145–146, 151–152, 180, 187,
213, 217–218
Annulus 119, 151, 159, 182, 187
API gravity 236
Aquifer 118, 124
Arrival pressure 22, 155, 229,
231–232
Arrival temperature 192, 239, 241,
248, 257
Artificial neural network (ANN)
30–31, 208–214
Asphaltene 1, 24, 51, 66, 226, 291
Assembly 184, 186
Asymmetric 80
Attenuation 26–27, 213–214
Axisymmetric 12, 71, 80
b
Backfilled 113
Backpressure 159, 170, 229
Barrier 181
Batches 246
Bathymetry 222
Battery 12, 30
Binary interaction parameters (BIP)
48, 53
Binary system 33, 36
Black oil 39, 48, 57–59, 63, 65–66,
228, 294–297
Blending 8, 36, 66–67, 169, 280
Multiphase Transport of Hydrocarbons in Pipes, First Edition.
Juan J. Manzano-Ruiz and Jose G. Carballo.
© 2024 John Wiley & Sons, Inc. Published 2024 by John Wiley & Sons, Inc.
Companion Website: www.wiley.com/go/Manzano-Ruiz/Multiphasetransport❦
❦ ❦
❦
302 Index
Blockage 80, 227, 235, 265, 274
Blowdown 6, 8, 113, 148–149,
155–156, 159, 201, 204, 254,
256
Bottomhole 21
Boundary-value strategy 22
Brine 195, 228–229, 232–234
Bubble point 11–12, 36, 38, 42–43,
45–47, 58–61, 69, 162
Bubbly flow 12, 17, 69, 71–75, 104,
106, 127, 129–131, 136, 139,
141
Buildup 225
Bullheading 227
Buoyancy 71, 81, 105, 175,
179–180, 182, 184, 204, 274,
279
c
Calibration 25–26, 28, 30, 207,
220, 256
Capacitance 27, 173–174, 184,
186, 195
Capacity 21, 54–55, 66, 103, 106,
124, 160, 162, 171–172,
190–194, 208–209, 249, 292
Capex (CAPEX) 13–14, 119, 173
Carbon sequestration 297
Catchers 113, 244
Category 200, 205
Cavities 179, 197, 295
Cell 5, 8, 22, 33–35, 62–63, 65–66,
95, 184, 189, 202, 204–205,
221–223, 289, 294
Centralizers 182
Ceramic 160
Characterization 7, 53–54, 68,
172, 291–292, 294
Choked 6–7, 56, 113, 121,
155–157, 161–162, 164, 166,
201–202, 204
Chromatography 290
Churn flow 3, 12, 69, 71–73, 104,
106, 129, 131, 136–137,
141–142, 144–145, 180
Circulation 240, 249, 261–267
Circumferential 20
Cleanup (wells) 159
Closure of equations 2, 4–5, 8, 21,
23, 93–94, 113, 141, 199, 204,
206–207, 214
Cluster of wells 12–14, 24, 66, 119,
121, 123, 159, 164, 200, 203,
208–209
Commingling fluid streams 7, 66,
96, 168, 289–290
Completion (wells) 13, 22,
119–121, 123, 125, 151,
194–195, 197, 225–226, 229,
287
Components 3–4, 7, 21, 26, 35–36,
38, 48, 52, 54, 87, 96–97, 102,
114, 120, 125, 127, 155–156,
158–162, 164, 166, 168, 170,
172, 183, 190, 192, 206, 223,
227, 236, 238, 242, 284,
291–294, 297–298
Composite-averaged 86, 92–93
Composition 7–8, 24, 37–38, 42,
54, 62, 64, 66, 117–118, 121,
190, 219, 223–224, 238, 284,
290, 296
Compositional 4, 7–8, 48, 59, 63,
65–67, 111–112, 137, 170,
192, 223–224, 289–291,
295–297❦
❦ ❦
❦
Index 303
Compressibility 6, 39–41, 47–49,
51–53, 56, 61, 63, 68, 149,
156–157, 162, 172, 289, 293
Compressor 175, 225, 242, 295
Comptracking 96, 298
Computational fluid dynamics
(CFD) 5, 20–21, 112, 179,
194, 197, 202, 238, 299
Concentration 32, 80–81, 102,
104–105, 115, 273–277, 279,
281, 286–287
Concentric 182, 187
Concrete 101, 182
Condensate 8, 36–37, 39, 57, 59,
107–108, 137, 287, 299
Condensation 31, 37–39, 57, 70,
93, 103, 114, 161, 171–172,
197
Condenser 3
Conductance 190, 192, 195
Conduction 96, 173, 175, 179,
183–184, 188, 194, 197,
295
Conductivities 5, 48, 57, 175,
181–184, 189–191, 196,
289–290, 293
Conductor 194
Coning (gas) 124
Coning (water) 117, 124
Conservation principle 2, 5, 23,
39, 85–87, 91–93, 96–98, 141,
183, 202, 207, 214, 277
Constant volume depletion (CVD)
62
Constitutive relationship 85,
96–97, 100
Constriction 56, 156–157, 159,
166
Continuity 89, 93, 95, 97, 99, 112,
218
Continuum medium 86, 112,
273–274
Contraction 165–166, 189
Convection heat transfer 31, 68,
96, 114, 171, 173, 175–177,
179–181, 183–184, 194,
197–198, 205, 295
Convergence 22, 98, 108, 224
Convolutional 205, 208
Cooldown 174, 179, 193, 196–197,
202–204, 236, 238, 249–250,
258, 260, 300
Corrosion 96, 159–160, 186, 191,
238–239, 265, 286–287, 298
Courant–Friedrichs–Lewy
condition (CFL) 8, 205,
221–222
Cricondenbar 36–37
Cricondentherm 37, 59, 61
Critical 35–38, 58–61, 156–157,
171
flow 56, 155–158, 162–164
Crossflow 180, 197
Crude oil 175, 287
Crystalline structure 193
Cubic equation of state 7–8,
49–52, 55, 107, 137, 206,
289–290
Cubic-plus association equation of
state (CPA) 295
Custody transfer 51
d
Darcy–Weisbach friction factor
99, 101, 108, 111, 125
Data acquisition 199
Datum 227❦
❦ ❦
❦
304 Index
Dead oil 8, 43, 46, 203–204, 240,
249, 265–269
circulation 249, 261–264, 267
Declination (reservoir) 164
Deepwater 14, 175, 181, 224–225,
227, 236
Deferred production 227, 284
Dehydrated 151
Deliquefy 151
Delivery 21–22, 155, 201, 227, 284
Demineralized 3
Demobilization 121
Dense fluid 37
Densitometer 26–28, 150
Densitometry 27
Density 5, 12, 15, 18, 22, 26–27,
29–30, 40–42, 44–45, 48, 50,
52, 54, 66, 68, 71, 80–81, 92,
95–98, 107, 109, 111, 113,
115, 117, 120, 124–127, 129,
131, 134, 137–138, 151,
157–159, 169, 190–191, 206,
213, 219, 228–229, 240, 256,
276, 279, 286–287, 289–290,
293
Depleted 21, 61–63, 118, 121, 204
Deposition 51, 66, 201, 204,
225–226, 238, 262, 274, 290
Depressurization 155, 201, 203,
223, 248, 251–255, 257, 265
Detection 257, 298
Deviated well 119, 147, 226–227
Dew point 36, 57–59, 69, 290
Diabatic 70, 72
Differential 62, 67, 85, 89, 98, 151,
220, 233, 249
liberation 62–64
Diffusion 184, 205
Diffusivity 276–277, 289, 293
Dilatant fluid 275
Dilute suspension 274, 277
Dimensionless 162, 181
Directional 152
Discharge 162, 167–168
Discrete 22, 95, 99–100, 107–108,
112, 137, 184–185, 189, 202,
205, 217–218, 220–221
Dispersed 77, 86, 99, 103, 106,
142, 145, 177, 223, 256, 267,
279, 299
Displacement 223, 258–259, 262
Disposal 124, 284, 291
Disturbance 201
Domain 8, 22, 27, 35, 49, 66, 69,
95, 107–108, 112, 137,
184–186, 188–189, 196, 202,
205, 220–221, 294
Downflow 213
Downhole (wells) 33, 62, 117, 122,
140, 146–147
Drawdown (wells) 22, 124, 141,
146, 159, 203, 228, 231, 284
Drift flux 19
Drift-flux model (DFM) 18, 20, 98,
101, 103, 105
Drift velocity 19, 104–105, 111
Drill center 13, 119
Droplet 1–2, 5, 21, 23, 26, 69–70,
73, 77–78, 82, 86, 95–96, 99,
137, 205, 256, 299
Dry gas 57, 61, 66
Dune 80–81, 281
Dynamical 82, 106, 205, 296
e
Effectiveness 174, 244, 287
Efficiency 108, 226, 239, 245, 258,
298❦
❦ ❦
❦
Index 305
Elasticity 56
Electrical 123
Electrochemical 29
Electrodes 27
Electromagnetic 27, 221
Electrosubmergible pump (ESP)
295
Electrotechnical 172
Elevation 227–230, 234–235, 237,
239–241, 243, 250, 252–254,
259–260, 262–263, 266, 268
Elongated 218
Embedded 204, 293, 296
Emergency 200–201, 256
Emitter 27
Empirical 31, 75, 85, 131, 161, 168
Empirical models 107–109, 111,
133, 138
Emulsions 22, 24–25, 39, 124
Enclosed 36, 118, 179
Energy 1, 5, 8, 12, 27, 39, 64, 77,
85, 87–89, 94, 97, 99–100,
107, 111–112, 115, 118, 121,
152, 154, 165, 169–170,
174–175, 180, 183–186, 196,
199, 207, 218, 289, 292–293,
295–296
Enhanced oil recovery (EOR) 120,
159
Enlargement 164–165
Enthalpy 7, 23, 48, 51, 54–56, 66,
88, 96, 157, 159, 183,
289–290, 293
Entrainment 70–71, 79, 81, 86, 95,
113, 137, 273–275, 278–279,
281, 286
Entrance 148
Entropy 157, 290, 293
Envelope 36–37, 58–61, 69, 205,
290, 294
Environmental 174, 182, 204, 251,
255
Equation of state (EOS) 7–8, 33,
36, 39, 47–56, 58–59, 61,
64–66, 97, 158, 162, 203, 206,
289–293, 295
Equilibrium 7, 23, 26, 33, 36, 39,
51–52, 62, 64, 68, 96–98, 111,
137, 157–159, 161, 170, 183,
201, 205, 223–224, 226, 274,
279, 290, 292, 299
Equipment 13–14, 62–64,
226–227, 242, 244, 283,
291–292, 295, 297
Ergodic hypothesis 92
Erosion 28, 113, 159–160, 239,
241–242, 283, 286–287, 298
Erosion velocity ratio (EVR) 230,
237, 241–243
Errors 29–30, 52, 66, 108, 207,
209–212, 219–222, 224
Estimation 7, 30, 43, 58, 96, 144,
156, 163, 166, 170, 178, 183,
203, 206, 289, 291–292, 295
Eulerian approach 5, 100, 112,
202
Evaporation 1, 3, 70, 72
Evolution 70, 200, 208–209, 213
Exchanger 73, 202, 295
Expanders 156
Expansion 20, 42, 56, 58, 62–63,
68–69, 112, 158, 162,
164–165, 189
Experimental 3–5, 23, 26, 39, 72,
75, 85, 92, 94, 111, 141, 153,
163, 178–179, 198, 206–208,
218–220, 223, 288, 299❦
❦ ❦
❦
306 Index
Exploitation 105, 283
Explosion 204, 255, 283
Extended-reach well 119
Extraction 208–210
f
Facilities 11–14, 22, 24, 27, 30,
107, 113, 117–118, 123,
151–152, 156, 174, 203, 208,
217, 225, 231, 238, 241, 292,
294–295, 297
Feedwater 3
Fiber 182
Floating production storage and
offloading (FPSO) 240
Flow assurance 22, 51, 196, 199,
225–226, 238
Flowline 2, 8, 12–14, 16–17, 20,
24, 59, 107, 118, 123, 137,
148–150, 153, 169, 174–175,
179, 181–182, 186–187,
189–193, 203–204, 221–223,
225, 229, 236–249, 251–259,
261–273, 275–277, 281–283,
286–287, 295, 297–298, 300
restart 261
Flow pattern 1, 4–5, 21, 26, 28–29,
39, 69, 71–82
Flowrate 25, 62, 64–65, 67, 122,
140–141, 146–147
Fluctuating 6
Fluctuations 6, 20–21, 29, 92, 174,
200, 226, 246
Fluid 2–9, 11, 20–26, 29–30,
33–40, 42–44, 46–48, 50,
52–54, 56–69, 71, 74–75, 77,
82, 85, 87, 93–99, 107–108,
112–115, 117–118, 120–121,
124–125, 137, 144, 153,
156–159, 161, 164–167,
170–173, 175–177, 179–181,
183–185, 188–193, 195–197,
200–207, 215, 217–221,
223–229, 233, 235–236,
238–239, 241–242, 244, 247,
249, 251, 254–257, 261–262,
265, 271, 273–284, 286–291,
293–295, 297–298
Fluidization 275
Flux 17–20, 28, 51, 87–88, 98,
100–101, 103, 105, 114–115,
158–159, 195
Fluxes 105, 184
Foot pound second system (FPS)
67, 126, 160, 284
Formation 14, 35, 45–47, 69, 82,
124, 151, 194–196, 201, 204,
225–227, 235, 238, 248–249,
251, 253, 258, 261, 283, 295,
298, 300
Formula 5, 97, 100, 288, 299
Fracking 22
Fraction 5, 15–16, 19, 23, 28,
52–54, 61–62, 66, 68, 76, 86,
92–93, 96–98, 101–104, 106,
111, 113–115, 126, 160, 172,
178, 193, 204, 213–214,
289–290, 292, 300
Fracturing 120
Frequencies 6, 21, 27, 71, 148, 152,
206, 245, 284, 294
Friction 6, 97, 99–101, 107–108,
111, 118, 120, 124–127,
131–132, 134, 137–139, 157,
180, 197, 207, 219, 238–239,
246, 279, 282, 293, 295
Frictional pressure gradient 99,
111, 127, 134, 137❦
❦ ❦
❦
Index 307
Fugacity 51–53, 290, 293
Fusion-bonded epoxy (FBE) 182,
186–187, 189, 191
g
Gas condensate 37
Gas dynamics 172
Gas formation volume factor
47
Gas-in-solution 42, 46, 63, 124
Gas lift 117, 124, 151, 159,
295–297
Gas-oil ratio (GOR) 24–25, 64,
117, 228, 233, 236, 240, 257,
299
Gas Processors Suppliers
Association (GPSA) 40,
67–68, 107, 114
Gas reservoir 62
Gate valve 167
Genetic algorithm 208, 213
Geological 224
Geomechanical 283
Geometries 5, 89, 93, 112, 148,
194, 222, 227, 229, 233, 238,
240–241, 256
Geotechnical 288
Geothermal 194–196, 228
GERG equation of state 51, 68,
290, 293, 295
Globe valve 167–168
Gradient 12, 95, 99, 108, 111,
124–127, 134, 137, 174–175,
188, 194–197, 203, 228,
281–282
Granular 273
Gravitation pressure gradient 125,
127, 134, 140
Gravity 6, 12, 41–42, 44–45, 54, 72,
76, 86–87, 99, 108, 111,
117–118, 120, 125–127, 129,
134, 138–140, 157, 162, 169,
222, 236, 239, 245, 274–275,
277, 281, 287, 297
Grid 95, 202, 204–205, 221, 289,
298
h
Header 24–25, 30
Health, Safety, and Environment
(HSE) 256
Heat capacity 54–55, 162,
190–194, 249
Heater 159
Heating 33, 295
Heterogeneity 213
Heterogeneous 277–278, 280–281,
283
Holdup 76, 82, 106, 108–110,
114–115, 120, 125, 127, 131,
134, 136, 138–139, 142, 144,
149, 153–154, 177, 193, 206,
214, 224, 228, 233–234, 236,
239, 249–250, 258–259, 294,
296, 298, 300
Homogenizer 26, 28
Homogenous 278
Hot oil circulation 264–267
Hydrate 14, 22, 124, 151, 193, 201,
203–204, 225–227, 235–236,
238, 248–249, 251, 253, 258,
261–262, 265, 291, 294,
297–300
Hydraulic 7, 9, 22, 32, 66, 85–86,
96, 112, 114, 120, 123, 172,
178, 180, 194, 203, 270, 288,
298❦
❦ ❦
❦
308 Index
Hydrocarbon 1, 4, 7–8, 11–12, 16,
21, 24, 29–30, 33–38, 40, 42,
44, 46, 48–50, 52, 54, 56–60,
62, 64, 66–69, 85–86, 112,
117–118, 121, 124, 155,
161–162, 164, 173, 190, 193,
199–202, 204, 206, 217, 236,
238, 249, 262, 270, 273,
283–284, 286, 289, 292–293
Hydrodynamic 141, 144, 148, 151
slug 96, 244–246, 295, 297, 300
Hydrogen sulfide 36, 291
Hydrostatic 229, 239
Hyperbolic 205, 210–211, 221
i
Immiscible 77
Impedance 27
Inflow performance relationship
(IPR) 117, 121–122, 140,
146, 297
Inhibition 227, 249, 258, 260–261,
265, 286–287
Initialization 224, 299
Injection 117, 151, 156, 159, 227,
238–240, 258, 261–262, 295,
297
Injectivity 120
Injector 120
Instability 2, 79, 82, 220, 224, 242,
244
Instrumentation 26, 298
Insulation 9, 14, 173–175, 179,
181–183, 186–187, 195–196,
240
Integrated 16, 21, 25, 65, 107, 118,
120, 291, 293, 295–297, 299
Integration 8, 16, 67, 89, 92, 96,
98, 202, 204–205, 207, 220,
290, 296–297, 300
Integrity 118, 195, 201, 283, 286,
298
Interface 2, 35, 65, 69, 76–79, 82,
86, 88–92, 100, 112, 180, 204,
244, 290–291, 297
Interfacial 23, 82, 97, 218–219, 291
Intermittent 6, 71, 76–77,
108–110, 117, 148, 151, 178,
206, 227, 245, 279, 286
Intermolecular 4, 48–49
Interphase 92, 157
Interpolation 8, 65–67, 289–290
Interval 92, 102, 120, 151, 160,
195, 220, 261, 290
Intervention 14–15, 200, 202, 226,
284
Isenthalpic 157
Isentropic 6, 56, 157–158, 162,
201, 293
Isobaric 35
Isolation 15, 24, 155
Isothermal 37, 39–40, 55, 62–63,
114, 157, 293
Iterative 66, 95, 107, 127, 143, 159,
209, 211, 293
j
Joint industry project (JIP) 4–5,
206
Joule–Thomson effect (JT) 48
Jumper 13, 123, 229, 231, 233, 236
Junction 156, 168–169, 171
k
Kickoff point (KOP) 119, 228
Kinematic 98, 101, 103, 293❦
❦ ❦
❦
Index 309
Knowledge neural network (KNN)
208, 213
l
Lagrangian approach 5, 112
Laminar flow 64, 100–101, 177,
184, 197, 279
Leak 204, 256–257, 298
Liquified natural gas (LNG) 51
Loss of containment 6, 57, 156,
204–205, 283
Loss-of-coolant accident (LOCA)
155
m
Maldistribution 113
Manifold 12, 26, 65–66, 113,
121–124, 156, 159, 168–169,
225, 229, 238, 241, 257, 262,
286, 289
Map 28, 36, 71–83, 106, 129,
136–137, 141, 144
Marching scheme 22
Mass velocity 19, 98–99
Measured depth (MD) 13, 118
Measurement 8, 11, 23, 25–27,
29–31, 85, 107, 129, 172, 201,
206–207, 214, 218–219
Mechanical 3, 51, 82–83, 100–101,
115, 165, 169, 171–172, 215,
221, 251, 270, 283, 286, 288
Mechanism 71, 124, 148, 173, 175,
179, 181, 184, 283
Mechanistic 4, 8, 21, 23, 29, 72, 75,
77, 82–83, 103, 105–107,
113–115, 117, 125, 133, 137,
141, 143–148, 150–154, 176,
180, 198, 206, 245, 281, 294,
296
Mesh 21, 112, 221
Metering 27, 31, 156
Methanol injection 227, 258, 261
Midstream 68, 292
Migrate 56, 124
Mitigate 155, 173, 225, 244, 246,
284
Mixing rule 48, 52–53, 206
Mixture 4–5, 7, 11–12, 16, 18–19,
23, 26–28, 33, 36–37, 39, 41,
48, 50–53, 57–59, 61, 68–69,
80, 82–83, 85, 98, 100, 103,
108, 113, 126, 145, 152, 155,
157–158, 161, 169, 177, 186,
190, 193, 214, 242, 275–281,
286, 288–293, 297, 299
Mobilization 68, 119, 121, 123
Molecular 39, 41, 49, 54, 67–68,
149, 175, 184, 277, 290, 295
Momentum 1, 5, 26, 28, 39, 64, 72,
75–77, 85–87, 89–90, 95, 97,
99–100, 111–112, 125, 141,
157, 165, 169, 180, 183, 199,
202, 204, 207, 218, 273, 277,
279, 289, 299
Multicomponent 3–4, 7, 33, 36,
52–53, 57, 161
Multidimensional 5
Multidirectional 120
Multiphase 1–7, 9, 11–33, 39,
48–51, 56–57, 65–67, 69–72,
74, 76, 78, 80, 82–83, 85, 89,
96, 98, 113–115, 117, 123,
141, 151–155, 171–173, 197,
199, 204–207, 217–226, 228,
230, 232, 234, 236, 238–240,
242, 244–252, 254, 256–258,
260, 262, 264–266, 268–273,
288–292, 294–300❦
❦ ❦
❦
310 Index
Multiphase flow meter (MPFM)
24–25, 28
Multiplier 27
Multistage 160
n
Newtonian 96, 275–276, 279, 298
Nodal analysis 117, 120–122, 125,
140, 147, 295
Node 5, 7, 96, 205, 210, 264, 294
Non-dimensional 39, 41–42, 46,
49, 55, 74–76, 85, 100,
108–109, 125, 129, 133, 138,
143, 162
Non-equilibrium 158, 224, 299
Non-homogeneous 157
Nonlinear 13, 22, 76, 184, 205,
210–211, 213, 217–219,
295–296
Non-Newtonian 275
Non-stratified 76
Normal operation 174, 189, 196,
200, 202–203, 239, 243, 256,
270, 294
No-touch time 193, 251, 262
Nozzle 28
NTNU 94, 172
o
Offshore 12, 14, 153, 173–174,
181–183, 236–245, 247–249,
251, 253, 255–259, 261,
263–265, 267, 270, 287
Oilfield 3, 193, 296
Oil formation volume factor
46–47
Oil-water ratio (OWR) 24–25
One-dimensional 204
Operating expenses (OPEX) 14
Operator 23, 89, 91, 123, 193,
203–204, 225, 238, 244, 247,
257, 265, 298
Optimization 22, 25, 208–213,
215, 217–218, 220, 224–226,
236, 238–239, 244, 247, 251,
265, 294–296, 298, 300
Orifice 28, 113, 151, 155–156,
166–168, 172
Overall heat transfer coefficient
(OHTC) 173–174, 183–185,
190–193, 228, 240
p
Paraffin 22, 265
Particle 1–2, 5, 11, 21, 69–71,
80–81, 100, 112, 221, 239,
273–281, 283, 285–286, 288,
299
Particulate 273–275, 281, 286
Peng-Robinson 49–50, 290,
292–295
Perforated 21–22, 120, 124, 140,
283
Performance 4, 6, 12, 20–22, 29,
31, 36, 40, 61, 67, 77, 96,
106–108, 117, 120–121, 133,
136, 140, 146–148, 174, 184,
195, 199, 202, 204, 206–209,
214, 219, 225–226, 238–239,
244, 256, 270, 274, 276, 291,
294–298, 300
Permeability 120
Perturbation 6, 16, 56, 117, 156,
174, 200–201, 203, 212
Phenomena 2, 5–6, 8, 56, 75,
96–97, 106, 112–113, 141,
149, 151, 194, 204–205, 207,
218, 220, 223, 242, 288, 295❦
❦ ❦
❦
Index 311
Pig 265–269, 270
Pigging 6, 265, 268–270, 284
Pipe inclination 76
Pipeline 1–2, 4–9, 11, 15, 20, 35,
37, 39, 48, 57, 65, 68, 70–71,
74–75, 77, 79–81, 83, 85–86,
88–90, 92–94, 96–100, 102,
104, 106–109, 112–115, 138,
148, 150–153, 155, 173–176,
179–190, 193, 200, 202,
204–205, 207, 214, 217, 222,
224–225, 242, 249, 254–256,
258, 265, 273, 276, 278–280,
289, 291, 296–299
Plunger 296
Polyethylene 182
Polypropylene 182, 187
Polytropic 157, 163
Polyurethane 182
Porosity 120, 300
Porous 11, 22
Precipitation 11, 226
Pressure gradient 12, 95, 108,
124–126, 132, 203,
281–282
Pressure profile 249–250
Producers 120, 125
Production 1, 3–8, 11–13, 20–25,
27, 29–30, 33, 37, 46, 52, 54,
57–59, 61–63, 66, 69, 86,
112–113, 115, 117–121,
123–124, 137, 140–141, 146,
148–149, 151–153, 155–156,
159–160, 164, 166, 168, 170,
173–174, 179–180, 183–184,
194–195, 199–204, 206, 208,
214, 223, 225–227, 229,
231–233, 235–236, 238–239,
242, 244–246, 249, 258,
261–262, 270–271, 273,
283–284, 286–287, 291–292,
294–298, 300
string 118, 120, 151
Productivity 120, 124, 225, 228,
233, 256, 284
Pseudo 7, 20, 26, 41–42, 52, 54, 79,
98, 196, 277–279, 293–294
Pseudo-homogeneous 177
Pseudo-plastic 275–276
r
Radial 20, 69, 97, 101–102, 199,
213
Radiation 27, 173, 175, 184
Ramp-down 22, 202–203, 247–248
Ramp-up 6, 22, 202–203, 220, 232,
247–248, 261, 294
Reactor 3, 9, 32, 114, 172
Recirculation 165
Recombination 24
Recompletion 284
Recovery 3, 28, 118, 120, 161, 238,
297
Reducer 156
Regime 1–3, 5, 8, 12, 21, 28–29,
69–77, 79, 81–83, 102, 106,
108, 110, 115, 127, 136–139,
141–145, 148, 170, 173,
177–180, 214, 217–219, 226,
242, 244, 275, 277–279, 283,
286, 294, 296
Reservoir 4, 11–13, 21, 23, 42–44,
46, 57–64, 67–69, 118–121,
123–124, 140–141, 146,
151–152, 159, 164, 174, 196,
203, 217, 228–229, 231, 233,
238, 273, 283–284, 290–291,
295–297, 300❦
❦ ❦
❦
312 Index
Resistance 12–13, 28, 173,
179–180, 183–185, 187–188,
190, 192, 197, 275–276
Restart 193, 203, 224, 235, 249,
261, 265
Restriction 118, 137, 155–156,
158, 160, 162, 164, 166, 168,
170, 172
Retrograde 37–39, 57, 59–60, 62,
66
Rheogram 275–276
Rheological 274–276
Rheology 275
Riser 12, 14, 17, 20, 118, 148–154,
174, 180, 182, 193, 203, 238,
240–241, 244–245, 261–262,
294–295
Roughness 100–101, 108, 125,
138, 228, 240
Rundown 193, 294
Rupture 6, 57, 69, 156, 242,
254–257
Rusted 101
s
Safeguard 204, 249
Safety 4, 14, 113, 155–156, 171,
187, 193, 195, 201, 204, 227,
236, 242, 251, 255
SAFT equation of state 7, 51, 67,
290, 293
Salinity 44
Saltation 278, 280
Sandstone 283
Satellite 13–14
Saturation 62–63, 69, 290
Seawater 14, 180, 183, 188,
190–191, 294
Sedimented 280
Segmentation 221–223
Segregated 108–110, 178, 235–236,
258
Sensitive 13, 78, 221
Sensitivity 98, 121, 219, 239, 278,
295
Sensors 256
Separated flow model 75, 99
Separation 22, 24–27, 30, 45, 62,
64–65, 123, 151, 155, 159,
202–203, 225, 227–228, 242,
244, 246, 248, 278, 284, 295,
297
Severe slugging 148–151, 245–248,
294–295
Severity 244
Sewer 101
Shale oil 120, 300
Shutdown 6, 22, 159, 173, 175,
179, 189, 193, 200–204,
226–227, 235–237, 242, 244,
249, 251, 257–262, 265, 270,
294, 300
Shutoff 113, 121
Silicate 182
Silicon 284
Simulation 5, 7–8, 11, 20–23,
36–37, 39, 48–49, 53–54, 62,
64, 82, 86, 94, 96–98,
103–104, 107, 112–113, 115,
118, 120, 133, 140, 144,
146–147, 169–170, 174–175,
179, 183–185, 192–196,
199–214, 217–236, 238–240,
242, 244–252, 254, 256–258,
260, 262, 264–273, 289–300
Simulator 22–23, 29, 31, 67, 208,
220–221, 224, 242, 244–245,
289–291, 293–299❦
❦ ❦
❦
Index 313
Singlephase 107
Singularities 20
SINTEF 4, 94, 296–297, 299
Sleeve 160
Slip factor 16–17, 102, 131
Slippage 2, 98
Slug flow 3, 12, 71, 73–75, 77, 79,
81, 103–104, 106, 113–115,
126–127, 129, 131, 136–137,
139, 141–142, 144–145,
148–154, 178, 180, 206–207,
217–218, 226, 244–245, 248,
251, 294, 299
Slugging 96, 117, 137, 148–154,
244–248, 251, 256–257, 265,
294–295, 297, 300
Slugtracking 96, 297
Slurry 15, 79–80, 82, 273–274,
281–282, 288
Smoothed 6, 92
Soave-Redlich 50, 290, 292, 294
Solid-fluid 276, 287
Solidify 298
Solution 7, 43, 46, 228
Solution gas ratio 44–46
Sonic speed 158
Sparse matrix 8, 22
Spatial 1, 29, 86, 100, 144, 178,
221, 274, 295
Species 1, 170, 292
Specification 22, 207, 292
Spectrum 126, 136, 292
Speed of sound 6–7, 48, 56,
156–158, 162, 201, 205, 220,
289
Stability 8, 82, 154, 205, 220–221,
224, 248, 296
Stabilization 258
Stabilize 258
Staggered grid 202, 204, 298
Stagnant 27, 157–158, 179, 181,
204
Stainless steel 160
Standardization 288
Startup 6, 22
Static 169, 210, 228–229, 233, 242
Stationary 15–19, 80, 212, 278,
280–281
Statistical 15–19, 51, 148, 200, 298
Steadiness 174
Steam-assisted gravity drainage
(SAGD) 297
Steady-state 7, 16, 20, 22, 48, 62,
64, 66, 83, 94, 98, 106, 114,
150, 153–154, 168, 173–174,
179, 181, 183–184, 193, 196,
199–200, 202–203, 207, 214,
223–224, 227–228, 238–242,
256, 291, 294–296, 299–300
Stimulation 226
Storage 22, 64, 148, 174, 185–186,
202, 208
Stratified flow 74–79, 83, 93, 96,
106, 114, 178, 193, 207, 213,
217–218
Streamline 166, 278–279
Subcooling 235
Subcritical 156, 160–164, 292
Submersible 295
Subsea 12–15, 24, 27, 118–119,
121–124, 174–175, 181–182,
190–191, 225, 227, 235–236,
238, 240, 256, 261–262
Subsea umbilicals, risers, and
flowlines (SURF) 118, 203
Subsurface 236
Subtended 76, 178
Sulfide 36, 291❦
❦ ❦
❦
314 Index
Supercritical 37, 68, 292
Superficial velocity 17–19, 72, 74,
77–79, 82, 103, 127, 145, 180,
213
Superimpose 97, 117, 140, 146,
274
Superposition 36
Supervised 200, 209, 212
Surface control subsurface safety
valve (SCSSV) 236
Surfactants 124
Surge 203, 244, 248, 261
Surveillance 23
Suspension 80, 274–275, 277–278,
283
Symmetrical 71
Symmetry 71, 214
Syntactic insulation 182, 186, 191
t
Tabular 49–50, 55, 65, 112
TACITE software 104, 115
Tar 182
Tee 20, 113, 156, 168–170, 289
Telescopic 118
Temperature 7–8, 14, 21–22, 24,
29, 33–48, 52, 54–62, 64,
68–69, 85, 97, 107, 111–112,
118, 124, 140, 149, 157–158,
174–175, 179, 183–185,
188–193, 195–197, 201,
203–204, 219, 223–224,
226–228, 230, 232–233,
235–244, 247–254, 256–258,
260–269, 289–290, 292, 294,
296, 298–299
profile 174, 183, 189–193, 196,
219, 226, 249–250, 294
Tension 57, 71, 82, 213, 218–219,
276, 290, 293
Terrain induced slugging 245,
300
Test separator 24–27, 30, 123
Thermal design 186, 295
Thermal modelling 173–198
Thermal resistance 173, 179–180,
183–185, 187–188, 197
Thermodynamics 3–4, 7–8, 30,
33–36, 38–40, 42, 44, 46–52,
54, 56, 58, 60, 62, 64–69, 98,
111, 156, 158, 161, 170, 172,
201, 206, 218, 223–224,
289–293, 297
Thermostat 63, 65
Thickening 275
Thickness 92, 180, 186, 213–214
Three-phase flow 78–79, 117, 205,
299
Throttle 56, 156
Tiebacks 14
Tilted 147
Time scale 300
Tophole 13
Topology 1, 4–6, 86, 295
Topsides 24, 30, 58–62, 118, 151,
159, 239, 241–242, 246, 248,
251–252, 255–258, 261–263,
265–266, 268
Trajectories 277
Transducer 29, 65
Transient 6–9, 16–17, 21–22, 48,
66, 86, 94, 98, 106, 112–113,
115, 153, 173–174, 179, 181,
183–185, 193–196, 199–205,
207–208, 214, 220, 224, 242,
244, 249, 254, 256, 270, 283,
291, 294, 296–300❦
❦ ❦
❦
Index 315
Transmission 3, 156, 198, 297
Transmitters 24
Transportation 273–274, 277, 288
Trench 14, 173–175, 187–189
Triangular 98, 180
Troubleshoot 107, 239
True vertical depth (TVD) 118,
140, 228
Trunklines 169
Tubing inclination 139
Tubulars 194
TUFFP 4, 144, 146, 294, 297
Turbine 3
Turbulence 6, 21, 71, 80–82, 92,
100–101, 106, 112, 124, 161,
165, 176–177, 184, 197, 206,
238, 276–277, 279, 286
Two-fluid model 93–95, 97, 137
u
Umbilical 13, 118
Unburied 181
Uncertainties 21, 23, 26, 28–31,
82, 95, 106, 121, 137, 141,
146, 193, 199, 205–208, 223,
242
Unconventional 120, 300
Underpredicts 98
Undersaturated 43, 46, 69, 162
UNIFAC 292, 294
UNIQUAC 292, 294
Universally 176
Unplanned 226–227, 244, 251,
258, 262
Unstable 224
Unsteadiness 21, 92, 98
Upflow 71, 144, 213
Uptime 174
Utilities 294
U-value 173, 182–187, 189–190,
192, 195–196
v
Vacuum insulated tubing (VIT)
195–197
Valve 7, 20, 24, 28, 56–57,
112–113, 121, 151, 155–156,
159–161, 163, 167–168,
171–172, 202, 213, 226–227,
231, 236, 240, 242, 244, 251,
283, 286, 295
Vapor 3, 5, 16–17, 33–39, 51–52,
58–61, 66, 68, 73
Vaporization 293
Velocity 2, 4, 6, 11, 16–19, 26, 56,
71–72, 74, 77–82, 89, 95–99,
101, 103–105, 111, 113,
124–127, 129–131, 137, 145,
156, 160, 164–165, 174, 180,
186, 201, 203, 213–214,
221–222, 226, 239–242, 262,
265–267, 270–274, 276–279,
281–283, 286–288, 290,
299–300
Vena contracta 166–167
Venturi 26, 28
Virial 51, 293
Viscometer 64–65
Viscosity 5, 43–44, 48, 54, 64, 68,
98–99, 107, 111, 115,
133–134, 157, 190–191,
213–214, 219, 228, 240, 256,
275–276, 279, 289–290, 293
Void fraction 5, 15–16, 19, 23, 28,
76, 92–93, 97–98, 101–104,
106, 111, 113–115, 126, 178,
213–214
Volatile oil 57–59, 62, 254❦
❦ ❦
❦
316 Index
Volume 8, 15, 19, 28, 33, 42,
45–50, 62–63, 69, 86–88, 95,
112, 142, 144, 158, 168–170,
202, 204, 222, 244, 248, 259,
261–262, 273, 279, 284,
287–288, 290, 300
translation 290
Volumetric 15–19, 29–30, 32,
62–63, 68, 90, 93, 98, 100,
102–103, 105, 108–109, 115,
121, 126, 162, 276
Volumetric quality 19, 102, 126
w
Water cut (WC) 25–26, 28–30,
126, 299
Wavy 74–75, 77–79, 82
Wellbore 113, 115, 124, 152–153,
174, 180, 194–198, 225–227,
236, 283–284, 297
Wellhead 11, 62, 121, 155,
227–229, 232–233, 236, 238,
295
Wellhead flowing pressure (WHFP)
232
Well inclination 144
Wellsite 24
Well shut-in 194, 236
Well start-up 196, 226, 229,
231–232, 235, 284, 294, 300
Well test 23–25
Wet gas 57, 59–60, 66, 107
Wispy flow 72
Workover 24, 123, 226, 284
