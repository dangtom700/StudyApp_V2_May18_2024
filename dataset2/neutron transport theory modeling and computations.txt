Neutron 
Transport
Ramadan M. Kuridan
Theory, Modeling, and Computations
Graduate Texts in Physics
CODE
 INSIDEGraduate Texts in Physics 
Series Editors 
Kurt H. Becker, NYU Polytechnic School of Engineering, Brooklyn, NY, USA 
Jean-Marc Di Meglio, Matière et Systèmes Complexes, Bâtiment Condorcet, 
Université Paris Diderot, Paris, France 
Sadri Hassani, Department of Physics, Illinois State University, Normal, IL, USA 
Morten Hjorth-Jensen, Department of Physics, Blindern, University of Oslo, Oslo, 
Norway 
Bill Munro, NTT Basic Research Laboratories, Atsugi, Japan 
Richard Needs, Cavendish Laboratory, University of Cambridge, Cambridge, UK 
William T. Rhodes, Department of Computer and Electrical Engineering and 
Computer Science, Florida Atlantic University, Boca Raton, FL, USA 
Susan Scott, Australian National University, Acton, Australia 
H. Eugene Stanley, Center for Polymer Studies, Physics Department, Boston 
University, Boston, MA, USA 
Martin Stutzmann, Walter Schottky Institute, Technical University of Munich, 
Garching, Germany 
Andreas Wipf, Institute of Theoretical Physics, Friedrich-Schiller-University Jena, 
Jena, GermanyGraduate Texts in Physics publishes core learning/teaching material for graduate￾and advanced-level undergraduate courses on topics of current and emerging fields 
within physics, both pure and applied. These textbooks serve students at the MS- or 
PhD-level and their instructors as comprehensive sources of principles, definitions, 
derivations, experiments and applications (as relevant) for their mastery and teaching, 
respectively. International in scope and relevance, the textbooks correspond to course 
syllabi sufficiently to serve as required reading. Their didactic style, comprehensive￾ness and coverage of fundamental material also make them suitable as introductions 
or references for scientists entering, or requiring timely knowledge of, a research 
field.Ramadan M. Kuridan 
Neutron Transport 
Theory, Modeling, and ComputationsRamadan M. Kuridan 
Nuclear Engineering 
University of Tripoli 
Tripoli, Libya 
ISSN 1868-4513 ISSN 1868-4521 (electronic) 
Graduate Texts in Physics 
ISBN 978-3-031-26931-8 ISBN 978-3-031-26932-5 (eBook) 
https://doi.org/10.1007/978-3-031-26932-5 
© The Editor(s) (if applicable) and The Author(s), under exclusive license to Springer Nature 
Switzerland AG 2023 
This work is subject to copyright. All rights are solely and exclusively licensed by the Publisher, whether 
the whole or part of the material is concerned, specifically the rights of translation, reprinting, reuse 
of illustrations, recitation, broadcasting, reproduction on microfilms or in any other physical way, and 
transmission or information storage and retrieval, electronic adaptation, computer software, or by similar 
or dissimilar methodology now known or hereafter developed. 
The use of general descriptive names, registered names, trademarks, service marks, etc. in this publication 
does not imply, even in the absence of a specific statement, that such names are exempt from the relevant 
protective laws and regulations and therefore free for general use. 
The publisher, the authors, and the editors are safe to assume that the advice and information in this book 
are believed to be true and accurate at the date of publication. Neither the publisher nor the authors or 
the editors give a warranty, expressed or implied, with respect to the material contained herein or for any 
errors or omissions that may have been made. The publisher remains neutral with regard to jurisdictional 
claims in published maps and institutional affiliations. 
Cover image: IAEA 
This Springer imprint is published by the registered company Springer Nature Switzerland AG 
The registered company address is: Gewerbestrasse 11, 6330 Cham, SwitzerlandTo 
Fauzia, Khaled, Abdulrahim, AbdulalimPreface 
The aim of this book is to provide a thorough explanation of the physical concepts 
and present the general theory of neutron transport processes in nuclear reactors 
and emphasize the numerical computing methods that lead to the prediction of 
neutron behavior. Detailed derivation and thorough discussion are the prominent 
features of this book instead of brevity and conciseness a characteristic of most 
available textbooks on the subject. 
The titles covered in this book are suitable for mainly graduate students in the 
fields of nuclear engineering and physics with sufficient background in reactor 
theory and calculations during the undergraduate level. Therefore, basic concepts 
of reactor physics such as the fission process, cross sections, and neutron diffu￾sion are bypassed in this book. An adequate knowledge of mathematical subjects 
such as partial differential equations, eigenvalue problems, numerical analysis, and 
vector calculus is required. 
This book came about after many years of teaching the topics on neutron trans￾port to graduate students in the nuclear engineering department at the University 
of Tripoli. Certainly, I have benefited from their discussions and I am so thank￾ful to them. In particular M. Ben Ghzail and H. Aburebaiya. Special thanks to 
Professors Naeem Abdurrahman and Wajdi Ratemi from the nuclear engineering 
department at the University of Tripoli; Dr. Omran Abuzid, a senior research sci￾entist at the Libyan Atomic Energy Establishment; Prof. Mohamed Elsawi from 
Argonne National Laboratories for their fruitful advices and comments of the 
manuscript. 
A particular acknowledgment and gratitude must be expressed to the professors 
from the nuclear engineering department at the University of Michigan, who pro￾vided me with the knowledge and understanding of nuclear reactor physics and 
neutron transport during my BSc and MSc study programs. In particular, profes￾sors J. Duderstadt, W. Martin, and J. Lee, my gratitude extends to a long list of 
other scientists who provided the insight and inspiration through their books and 
research papers. 
Janzour, Tripoli, Libya Ramadan M. Kuridan
viiContents 
1 Neutron Transport—The Neutron Transport Equation .............. 1 
1.1 Fundamental Concepts .......................................... 1 
1.2 Derivation of the Neutron Transport Equation .................... 8 
1.2.1 Boundary Conditions ..................................... 12 
1.3 Simplified Forms of the Neutron Transport Equation ............. 14 
1.4 The Integral Method ............................................. 20 
References ........................................................... 25 
2 Neutron Diffusion—The Finite Difference Solution 
of the Neutron Diffusion Equation ................................... 27 
2.1 Finite Difference Formulation of the One-Dimensional 
One-Group Neutron Diffusion Equation .......................... 28 
2.1.1 Left Boundary ........................................... 32 
2.1.2 Right Boundary .......................................... 33 
2.2 Solution Algorithm .............................................. 35 
2.2.1 Boundary Conditions ..................................... 36 
2.2.2 Methods of Solution ..................................... 39 
2.2.3 Power Distribution ....................................... 43 
2.3 Finite Difference Formulation of the One-Dimensional 
Multi-group Neutron Diffusion Equation ......................... 44 
2.4 Finite Difference Formulation for the Multi-group 
Two-Dimensional (x − y) Neutron Diffusion Equation ........... 45 
2.4.1 Method of Solution ...................................... 56 
References ........................................................... 59 
3 Spherical Harmonics—The PN Method ............................. 61 
3.1 Derivation of the PN Equations in Plane Geometry .............. 61 
3.1.1 The PN Approximation .................................. 66 
3.2 Derivation of the PN Equations in Spherical Geometry ........... 70 
3.3 Boundary and Interface Conditions .............................. 74 
3.3.1 Free Surface Boundary Condition ......................... 74 
3.3.2 Interface Condition in Plane Interface ..................... 76 
3.3.3 Interface Condition in Curved Interface ................... 78 
3.3.4 Yvon’s Method .......................................... 78
ixx Contents
3.4 Difference Scheme for the One-Dimensional One-Speed 
P1 Equations .................................................... 83 
3.4.1 Plane Geometry .......................................... 83 
3.4.2 Difference Equations in Spherical Geometry .............. 89 
3.5 The Elastic Transfer Cross Section ............................... 92 
References ........................................................... 97 
4 The Adjoint Transport Equation—The Equation of Neutron 
Importance .......................................................... 99 
4.1 Mathematical Definitions ........................................ 99 
4.2 Derivation of the Equation of Neutron Importance 
(The Adjoint Function) .......................................... 101 
4.2.1 The Equation of Conservation of Importance ............. 101 
4.2.2 Boundary Condition ...................................... 105 
4.2.3 Final and Initial Conditions ............................... 105 
4.3 The Adjoint Neutron Diffusion Equation ......................... 107 
4.3.1 The Energy-Dependent Neutron Diffusion 
Equation (DE) ........................................... 107 
4.3.2 The One-Speed Neutron Diffusion Equation .............. 108 
4.3.3 The Multi-Group Neutron Diffusion Equation ............. 109 
4.3.4 The Two-Group Neutron Diffusion Equation .............. 111 
4.4 The Adjoint One-Speed P1 Equations ............................ 111 
4.5 Derivation of the Kinetic Parameters ............................. 114 
4.5.1 Transport Model ......................................... 114 
4.5.2 One-Node Model ......................................... 116 
4.5.3 Diffusion Model ......................................... 117 
4.5.4 Two-Node Model ........................................ 120 
References ........................................................... 124 
5 Perturbation Theory ................................................. 125 
5.1 Perturbation of the Effective Multiplication Factor (k) ............ 126 
5.2 Perturbations in the One Speed Diffusion Theory ................ 128 
5.3 Multigroup Perturbation Theory ................................. 130 
5.4 Perturbation of the Multiplication Rate Constant (α) ............. 132 
References ........................................................... 134 
6 The Method of Discrete Ordinates: The SN Method ................. 135 
6.1 Fundamental Concepts .......................................... 136 
6.2 The Combined Discrete Ordinates and Legendre Polynomials 
Equation ........................................................ 139 
6.2.1 Gauss Quadrature Set .................................... 142 
6.2.2 Anisotropic Scattering .................................... 144 
6.2.3 Multi-group DO Equations with Anisotropic 
Scattering and Fission Source ............................ 145 
6.2.4 The Double-PN Method in Discrete Ordinates ............ 147Contents xi
6.3 Numerical Solution of the Discrete Ordinate Equation ............ 147 
6.3.1 Plane Geometry .......................................... 147 
6.3.2 Spherical Geometry ...................................... 156 
6.3.3 General Geometry ........................................ 167 
6.4 Discrete Ordinates Computer Codes ............................. 167 
References ........................................................... 169 
7 Computer Simulation of Neutron Transport—The Monte Carlo 
Method .............................................................. 171 
7.1 Basic Statistical Definitions ...................................... 172 
7.2 Particle History Generation ...................................... 177 
7.2.1 History Generator ........................................ 178 
7.3 Modeling of Radiation Transport Parameters ..................... 179 
7.3.1 Source Parameters ........................................ 179 
7.3.2 Path Length .............................................. 182 
7.3.3 Collision Parameters ..................................... 185 
7.4 Variance Reduction Methods .................................... 190 
7.4.1 Particle Weight ........................................... 190 
7.4.2 Source Biasing Parameters ............................... 190 
7.4.3 Variance Reduction Techniques ........................... 191 
7.4.4 Neutron/Photon Problem ................................. 193 
7.5 Criticality Calculations .......................................... 194 
7.5.1 keff Cycle ................................................ 194 
7.5.2 keff Estimators ........................................... 196 
7.6 Particle Scoring ................................................. 196 
7.6.1 Neutron Tallies ........................................... 197 
7.7 Accuracy, Precision, Relative Error, and Figure of Merit ......... 198 
7.7.1 Precision ................................................. 199 
7.7.2 Relative Error ............................................ 199 
7.7.3 Figure of Merit .......................................... 199 
References ........................................................... 200 
8 Neutron Transport—The Variational Methods ...................... 203 
8.1 Variational Calculus ............................................. 203 
8.1.1 Functionals .............................................. 203 
8.1.2 The Euler–Lagrange Equation ............................ 205 
8.2 Variational Principles ............................................ 208 
8.2.1 Sturm–Liouville Differential Equations ................... 208 
8.2.2 Fredholm Integral Equations with Symmetric Kernels ..... 212 
8.2.3 Eigenvalue Problems ..................................... 213 
8.2.4 Inhomogeneous Problems ................................ 218 
8.3 Application of Variational Methods to Transport Theory .......... 222 
References ........................................................... 226 
9 Selected Problems Solutions ......................................... 227xii Contents
Appendix A: The concept of Directional Derivative ..................... 251 
Appendix B: Solid Angle and Differential Velocity ...................... 261 
Appendix C: Radiative Transport ....................................... 263 
Appendix D: Input Description of the 1D Program ...................... 269 
Appendix E: Sample Problems and Exercises for the 1D Program ...... 277 
Appendix F: Legendre Polynomials ..................................... 2811 Neutron Transport—The Neutron 
Transport Equation 
The neutron transport equation is the mother of all equations in reactor physics. 
All approximate analytical and numerical forms are derived from it. Therefore, the 
beginning chapter of the book has been allocated to the neutron transport equation. 
In the first section, the fundamental concepts of neutron density, flux, and current 
are presented. In the second section, a rigorous derivation is formulated along with 
the boundary and source conditions. Then simplified and approximate forms of the 
equation are discussed in Sect. 1.3. In Sect. 1.4, the integral method is applied to 
the non-multiplying and multiplying slab. The concept of directional derivatives, 
differential velocity, and solid angle important to the mathematics of the neutron 
transport equation are included in appendices A and B. Finally, in appendix C, 
other types of radiative transport are summarized [1–5]. 
1.1 Fundamental Concepts 
In this section, we introduce the basic definitions describing the neutron and its 
motion which will assist in the derivation of the neutron transport equation [6]. 
1. Neutron density 
Neutron density n is defined as the number of neutrons in a unit volume in a 
manner similar to nuclear density N. We designate the neutrons by their position 
r and kinetic energy E = 1 
2 mυ2, where mandυ are the neutron mass and speed, 
respectively, and direction of a unit vector Ω = υ
υ in spherical coordinates (θ , ψ). 
Therefore, we can express the neutron density using the fore mentioned indepen￾dent variables, e.g. n
)
r, E, Ω, t
)
at time t (Fig. 1.1). In addition to the units of 
volume extra units for the other variables are needed, i.e. a unit of energy, and 
a unit of solid angle [ neutrons 
cm3−eV−st ]
. Therefore, the neutron density is defined as
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2023 
R. M. Kuridan, Neutron Transport, Graduate Texts in Physics, 
https://doi.org/10.1007/978-3-031-26932-5_1 
12 1 Neutron Transport—The Neutron Transport Equation
Fig. 1.1 The angular density n
)
r, E, Ω, t
)
n
)
r , E, Ω, t
)
dV d EdΩ [neutrons]: The expected number of neutrons at position 
r in dV at energy E in dE in the direction Ω in the solid angle dΩ = sinθdθdψ
(Appendix B) at time t. 
The word expected indicates the statistical nature of the neutron density; hence, 
we always mean the average density of neutrons and not the actual density. 
n
)
r, E, Ω, t
)
is referred to as the angular density and, if integrated over direction, 
it becomes the total density 
n
)
r , E, t
)
=
(
4π
dΩn
)
r, E, Ω, t
)
And, it is still called the total density if integrated over energy 
n
)
r , t
)
=
(∞
0 
dEn)
r, E, t
)
The angular dependence of the neutron density is more apparent near bound￾aries or neutron sources. 
2. Neutron flux 
Neutrons are always in a state of motion and hence their speed and direction 
change continuously as a result of interactions. The neutron density alone does 
not represent this physical situation precisely. Therefore, we have to incorporate 
the neutron speed along with the density to obtain a new physical quantity such as 
the flow rate of neutrons or the commonly used terminology, neutron flux: ϕ = υn 
or the angular flux1.1 Fundamental Concepts 3
Fig. 1.2 The concept of angular flux 
ϕ
)
r , E, Ω, t
)
= υn
)
r, E, Ω, t
)
and units of [ n 
cm2−sec−eV−st ]
Accordingly, we can define the neutron flux ϕ as the number of neutrons cross￾ing a unit area perpendicular to Ω per sec: [ n 
cm2−sec ]
. It is a scalar quantity unlike 
the concept of flux used in electromagnetic theory which is a vector quantity closer 
to the concept of neutron current. Figure 1.2 shows the concept of angular flux. 
If the angular flux is integrated over all directions, we obtain the total flux 
which can be defined as the total number of neutrons crossing the unit area per 
second regardless of direction. 
φ
)
r, E, t
)
=
(
4π
dΩϕ
)
r, E, Ω, t
) (1.1) 
If the angular neutron flux is weakly dependent on angle (isotropic) which 
means that the neutrons move in different directions with equal probability, then 
ϕ
)
r , E, Ω, t
)
= φ
)
r, E, t
)
4π
(1.2) 
3. Neutron current density 
If the neutron velocity has replaced the neutron speed in the definition of the 
angular flux, we obtain the angular current density 
j
)
r, E, Ω, t
)
= υn
)
r, E, Ω, t
)
= Ωυn
)
r, E, Ω, t
)
= Ωϕ
)
r , E, Ω, t
)4 1 Neutron Transport—The Neutron Transport Equation
Or we call it by the unused terminology (vector flux). The angular current 
density has the same value and units as the angular flux
|
|
| j
|
|
| = |
|Ωϕ
|
| = |
|Ω|
||ϕ| = ϕ
The current density is defined as 
J
)
r , E, t
)
=
(
4π
dΩ j
)
r , E, Ω, t
)
And 
J
)
r , t
)
=
(∞
0 
d E (
4π
dΩ j
)
r , E, Ω, t
)
=
(∞
0 
dE J )
r, E, t
) (1.3) 
Notice that J
)
r , t
)
or J )
r , E, t
)
are vector quantities. 
4. Net neutron current density 
Now, since the current density is a vector quantity, we may be able to utilize it in 
expressing some physical quantities such as the net leakage rate through surfaces, 
unlike the scalar flux which may be utilized in the calculation of reaction rates. 
Consider an arbitrary differential surface area dA which can be expressed in a 
vector form dA = d An, where n is the out normal vector to the differential area 
as shown in Fig. 1.3. Here, we want to draw the attention of the reader to the 
confusion which may happen between the normal vector and the neutron density. 
The latter rarely appears again in equations to come. Suppose there is a neutron 
current making an angle θ with the unit normal vector n so what would be the 
number of neutrons which can pass through the area d A. Actually, only a fraction 
of the neutrons is capable of passing through because not all of them can see the 
whole area. If the angle θ = 90◦, none will pass; on the other hand, if θ = 0◦, all 
can pass.
Therefore, we can express this argument for the net current density mathemat￾ically using the dot product of vectors such as 
J
)
r , t
)
· dA = |
|J
)
r , t
)|
|
|
|n
|
|dA cos θ (1.4) 
which can be expressed as the net number of neutrons passing through the differ￾ential surface area dA oriented in any direction per sec. Integrating this quantity 
assuming a unit area of the surface1.1 Fundamental Concepts 5
Fig. 1.3 The concept of the net neutron current
J
)
r , t
)
· n =
(∞
0 
d E (
4π
dΩ n. j
)
r , E, Ω, t
)
=
(∞
0 
d E (
4π
dΩ)
n.Ω)
ϕ
)
r , E, Ω, t
)
=
(∞
0 
dE (
2π
0 
dψ
(π
0 
sin θdθcos θϕ)
r, E, θ, ψ, t
)
Hence, 
J
)
r, t
)
· n =
(∞
0 
dE (
2π
0 
dψ
(
+1
−1 
dμμϕ)
r , E, μ, ψ, t
) (1.5) 
where, n.Ω = cos θ and μ = cos θ
5. Partial neutron current density 
The partial current density is related to the net current density which corresponds 
to the total rates at which neutrons pass through a unit area from left to right (J+) 
and from right to left (J−) or from bottom to top or top to bottom, respectively. 
This means separating the net current into two components 
J ±)
r , t
)
=
(∞
0 
d E (
n.Ω>
<0 
dΩ n. j
)
r , E, Ω, t
) (1.6) 
or 
J ±)
r, t
)
=
(∞
0 
d E (
n.Ω>
<0 
dΩ)
n.Ω)
ϕ
)
r , E, Ω, t
)6 1 Neutron Transport—The Neutron Transport Equation
n.Ω>
<0 indicate weather cosθ positive or negative which imply the range of 
integration )
0, π/
2
) or )
π/
2, π)
. Using the definition of the solid angle dΩ =
sin θ dθ dψ and taking account of the relations: 
μ = cos θ; dμ = −sin θdθ
ϕ
)
r, E, Ω, t
)
dEdΩ = ϕ
)
r , E, θ, ψ, t
)
dE sin θdθdψ
ϕ
)
r , E, θ, ψ, t
)
sin θdθdψ = −ϕ
)
r, E, μ, ψ, t
)
dμdψ
We can express the partial currents as 
J +)
r , t
)
=
(∞
0 
dE (
2π
0 
dψ
π
(
/2
0 
sin θdθ(+cos θ)ϕ
)
r , E, θ, ψ, t
)
=
(∞
0 
dE (
2π
0 
dψ
(
0
+1 
(−dμ)(+μ)ϕ)
r , E, μ, ψ, t
)
=
(∞
0 
dE (
2π
0 
dψ
(
+1
0 
dμ μϕ)
r, E, μ, ψ, t
) (1.7) 
and 
J −)
r , t
)
=
(∞
0 
dE (
2π
0 
dψ
(π
π/2 
sin θdθ(−cos θ)ϕ
)
r, E, θ, ψ, t
)
=
(∞
0 
dE (
2π
0 
dψ
(−1
0 
(−dμ)(−μ)ϕ)
r , E, μ, ψ, t
)
=
(∞
0 
dE (
2π
0 
dψ
(−1
0 
dμ μϕ)
r, E, μ, ψ, t
) (1.8) 
Notice that the cosine is positive in the upper half of the spherical geometry 
and negative in the lower half. Figure 1.4 shows the partial currents.
Writing the partial currents in one equation 
J ±)
r , t
)
=
(∞
0 
dE (
2π
0 
dψ
(
±1
0 
dμ μϕ)
r , E, μ, ψ, t
)1.1 Fundamental Concepts 7
Fig. 1.4 The concept of partial currents
Subtracting Eq. (1.8) from (1.7) 
J + − J − =
(∞
0 
dE (
2π
0 
dψ
(
+1
0 
dμ μϕ)
r , E, μ, ψ, t
)
−
(∞
0 
dE (
2π
0 
dψ
(−1
0 
dμ μϕ)
r , E, μ, ψ, t
)
Changing the integral limits 
J + − J − =
(∞
0 
dE (
2π
0 
dψ
(
+1
0 
dμ μϕ)
r , E, μ, ψ, t
)
+
(∞
0 
dE (
2π
0 
dψ
(
0
−1 
dμ μϕ)
r , E, μ, ψ, t
)
Summing up the two integrals in one integration 
J + − J − =
(∞
0 
dE (
2π
0 
dψ
(
+1
−1 
dμ μϕ)
r, E, μ, ψ, t
)
Comparing the result to Eq. (1.5), we obtain 
J
)
r, t
)
· n = J +)
r , t
)
− J −)
r , t
)
which is called the net current density.8 1 Neutron Transport—The Neutron Transport Equation
6. Neutron reaction rates 
The macroscopic cross section is Σ)
r , E
)
= N
)
r
)
σ(E), where it is defined as the 
probability that a neutron makes an interaction as it moves a 1 cm distance in the 
medium, where N is the nuclear density and σ is the microscopic cross section 
for an interaction with a single nucleus. However, if neutrons are represented by 
the neutron flux in this medium then the reaction rate density will be 
R
)
r, E, t
)
= Σ)
r, E
)
φ
)
r , E, t
)
[ interactios 
cm3 − sec − eV ]
or in a more general form, the interaction rate at time t 
R(t)
(
dV (∞
0 
d E (
4π
dΩΣ)
r , E
)
ϕ
)
r, E, Ω, t
)
[
interactios 
sec ]
(1.9) 
1.2 Derivation of the Neutron Transport Equation 
There are a few reasonable assumptions which have to be mentioned before we 
proceed with the derivation [7]: 
1. The average neutron density and not the actual neutron density is used in the 
derivation where the statistical fluctuations are lower compared to the actual 
density. 
2. Only neutron–nucleus (n-N) reactions are considered and neutron–neutron reac￾tions are ignored for a simple reason: the neutron density is so low (109 n 
cm3 ) 
compared to nuclear density (1022 nuclie 
cm3 ). Therefore, the probability that a 
neutron encounters a neutron is so negligible. 
3. The neutron displacement during an n-N reaction is neglected because the reac￾tion time (10−14 s) as compared to the time taken between two consecutive 
reactions: 
(10−3 s to 10−6 s). 
4. Neglecting natural radioactive decay being a slow process compared to the fast 
neutron chain reaction. 
5. Neglecting attraction and electromagnetic forces because they are so weak 
compared to nuclear forces 
6. Neutron polarization and coherent scattering have no effect on neutron transport 
in the reactor. 
7. Delayed neutrons become important only during transients where such short 
transient times are comparable with the half-life of neutron precursors which 
produces delayed neutrons. Such a small number of delayed neutrons compared 
to a large number of prompt neutrons become important in determining the 
reactor response.1.2 Derivation of the Neutron Transport Equation 9
Fig. 1.5 Differential 
elements for the neutron 
conservation 
The aim of the derivation of the neutron transport equation is to establish a 
balance or imbalance of the mechanisms of production or loss that is the balance 
or imbalance of through differentials of all variables volume in space, energy, solid 
angle dV , d E, dΩ and at r, E, and Ω (Fig. 1.5). Therefore, the gain or loss of 
neutrons is not only entering or leaving dV but also entering or leaving dE and 
dΩ mainly through scattering processes. For example, a neutron scattered from 
energy E and direction Ω in dE and dΩ, respectively, to other energies and 
directions E,
, and Ω, in d E, and dΩ, is considered loss and inversely true for 
gain when neutrons are scattered from other energies and directions E,
, and Ω,
in d E, and dΩ, to energy E and direction Ω in dE and dΩ . 
The number of neutrons in all differential elements is just 
n
)
r, E, Ω, t
)
dV d E dΩ at time t. The total number of neutrons in volume 
V in dE in dΩ is just: 
⎡
⎣
(
V 
dV n)
r , E, Ω, t
)
⎤
⎦dEdΩ
And, the rate of change of this number is 
∂
∂t 
⎡
⎣
(
V 
n
)
r, E, Ω, t
)
dV 
⎤
⎦dEdΩ = gain rate in V and dEdΩ
− loss rate from V and dEdΩ
The source term is treated in the same way as the density term; hence, the total 
number of neutrons emitted by the source in volume V in dE in dΩ is just: 
⎡
⎣
(
V 
S
)
r , E, Ω, t
)
dV 
⎤
⎦dEdΩ10 1 Neutron Transport—The Neutron Transport Equation
The scattering rates in V from all other energies and directions to dEdΩ . 
⎡
⎣
(
V 
dV (∞
0 
d E,
(
4π
dΩ,
υn
)
r, E,
, Ω,
, t
)
Σs
)
r, E, → E, Ω, → Ω)
⎤
⎦dEdΩ
Rate of loss via absorption and scattering of neutrons in V from dE from dΩ
is just 
⎡
⎣
(
V 
υn
)
r , E, Ω, t
)
Σt
)
r , E, Ω)
dV 
⎤
⎦dEdΩ
The net flow of neutrons through the differential surface dS into and out of V 
is given by 
dS · Ωυn
)
r, E, Ω, t
)
= n · j
)
r , E, Ω, t
)
d S, and the total over the surface of 
V is the integration over the surface 
⎡
⎣
(
S 
dS · Ωυn
)
r, E, Ω, t
)
⎤
⎦dEdΩ
We change the integration from surface to volume integration using the Gauss 
theorem 
⎡
⎣
(
S 
dS · Ωυn
)
r, E, Ω, t
)
⎤
⎦dEdΩ
=
⎡
⎣
(
V 
dV ∇ · Ωυn
)
r, E, Ω, t
)
⎤
⎦dEdΩ
Rewriting the balance equation, we get 
⎡
⎣
(
V 
∂n 
∂t 
dV 
⎤
⎦dEdΩ =
⎡
⎣
(
V 
S
)
r, E, Ω, t
)
dV 
⎤
⎦dEdΩ
+
⎡
⎣
(
V 
dV (∞
0 
d E,
(
4π
dΩ,
υn
)
r , E,
, Ω,
, t
)
Σs
)
r , E, → E, Ω, → Ω)
⎤
⎦dEdΩ
−
⎡
⎣
(
V 
υn
)
r, E, Ω, t
)
Σt
)
r, E, Ω)
dV 
⎤
⎦dEdΩ1.2 Derivation of the Neutron Transport Equation 11
−
⎡
⎣
(
V 
dV ∇ · Ωυn
)
r , E, Ω, t
)
⎤
⎦dEdΩ
Canceling out dEdΩ and collecting terms integrated over dV and making use 
of the relation ϕ = nυ the reduction takes the form ( f
)
r
)
dV = 0 or f
)
r
)
= 0, 
we obtain the general form of the transport equation: 
1 
υ
∂ϕ
∂t = S
)
r, E, Ω, t
)
+
(∞
0 
d E,
(
4π
dΩ,
ϕ
)
r , E,
, Ω,
, t
)
Σs (r , E, → E, Ω, → Ω)
− ϕ
)
r , E, Ω, t
)
Σt
)
r, E, Ω)
− Ω · ∇ϕ
)
r , E, Ω, t
) (1.10) 
This is of course an integral differential equation of many variables. For exam￾ple, in a cartesian space, [
r : x, y,z; E; Ω : θ , ψ;t
]
and can be applied for many 
different situations. The source term can be external or localized with all or less 
variables, a point, line, surface or distributed, and so forth. In the case of a nuclear 
reactor core, it will be a fission source, e.g. 
S
)
r , E, Ω, t
)
= χ(E)
4π
(
4π
dΩ, (
∞
0 
d E,
ν
)
E,
)
Σ f
)
r, E,
)
ϕ
)
r , E,
, Ω,
, t
)
noticing that the fission spectrum χ(E) is isotropic and independent of the energy 
of the neutron causing fission (E,
). If short-time transients are considered the 
prompt and delayed neutrons are expressed separately in the fission source term 
and another equation is added for the rate of change of precursors. Some of the 
objectives for solving the transport equation are to obtain the multiplication factor, 
the neutron flux, the power distribution, reaction rates, etc. Solutions are almost all 
through numerical methods, except for the Monte Carlo method, for all possible 
core geometries such as: 
1. Multigroup methods, 
2. Escape probabilities, 
3. Spherical harmonics expansions, 
4. Diffusion approximation, 
5. Discrete ordinates method, 
6. Adjoint equation, perturbation theory, and variational methods. 
7. ……. 
Limited analytical solutions are possible and can help understand the physics of 
the problem and perhaps reduce the computational effort through approximations 
and cancellation of unnecessary mathematical terms.12 1 Neutron Transport—The Neutron Transport Equation
1.2.1 Boundary Conditions 
Generally, as a mathematical condition, the flux must be positive, real, and finite 
and if the solution comes up negative, imaginary, or infinite the solution should be 
rejected. The boundary conditions are necessary for the solution to be determined 
exactly otherwise it will be general. 
1. Initial condition: this is valid when the flux is time-dependent 
ϕ
)
r , E, Ω, t
)]
t=t0 = ϕ0
)
r, E, Ω)
which implies that the angular flux distribution should be well defined at the 
beginning of counting time. 
2. Free surface condition: the free surface is the one which the neutrons can’t 
return to after they leave it (a non-reentrant surface). An example is a surface 
surrounded by vacuum (Fig. 1.6) 
ϕ
)
rs , E, Ω, t
)
= 0 if n · Ω < 0 for all rs on S 
In addition to a condition of zero return current at the surface (Fig. 1.7), the 
return partial current is zero 
J −)
rs , t
)
=
(∞
0 
d E (
n·Ω<0 
dΩ)
n · Ω)
ϕ
)
rs , E, Ω, t
)
=
(∞
0 
dE (
2π
0 
dψ
(−1
0 
dμμϕ)
rs , E, μ, ψ, t
)
= 0
Allows neutrons 
to reenter 
Does not allow 
neutrons 
to reenter 
Fig. 1.6 Entrant and non-reentrant surfaces 1.2 Derivation of the Neutron Transport Equation 13
Surface 
S 
Fig. 1.7 Neutrons crossing the surface of a control volume in and out 
3. Interface condition: This condition applies when a sudden change in the prop￾erties of the medium takes place or at the interface between two media A and 
B at rs (Fig. 1.8) as an example 
ϕ A)
rs , E, Ω, t
)
= ϕB)
rs , E, Ω, t
)
.
Medium A 
Medium B 
Surface at interface 
Σ
Σ
Fig. 1.8 Interface between media A and B14 1 Neutron Transport—The Neutron Transport Equation
Fuel 
rods 
Fuel 
cell 
Fig. 1.9 Periodic boundary condition for a fuel lattice 
4. Periodic boundary condition: This condition applies when the medium is 
repeated as in the fuel lattice (Fig. 1.9) 
ϕ A)
r, E, Ω, t
)
= ϕB)
r + ma + nb, E, Ω, t
)
5. Condition at infinity: The neutron flux must be finite at all points and should not 
be infinite. If the medium is non-multiplying and contains no sources emitting 
neutrons, then 
lim 
r→∞ ϕ
)
r, E, Ω, t
)
= 0 
6. Source condition: The position of the source is treated as a singularity and hence 
the solution is obtained at all points except the position of the source. Then, 
use the source condition as 
lim 
r→r 0
(
A 
d A·Ωυn
)
r , E, Ω, t
)
= lim 
r→r 0
(
A 
n·Ωυn
)
r, E, Ω, t
)
dA = S
)
E, Ω, t
)
,
where dA is the differential area of the capsule surrounding the source and 
the source strength is equated to the net current through the area A. 
1.3 Simplified Forms of the Neutron Transport Equation 
Equation (1.10) can take different forms and can be subjected to several approxi￾mations. We will acknowledge some now.1.3 Simplified Forms of the Neutron Transport Equation 15
1. Velocity formulation 
The velocity variable is a vector quantity and, in 3D, it is defined as υ = υΩ. 
It can replace both the energy and direction variables. Therefore, the angular 
flux ϕ
)
r , E, Ω, t
)
can be rewritten as ϕ
)
r , υ, t
)
. Equating the two quantities will 
require the cancellation of units on both sides using the differentials 
ϕ
)
r , E, Ω, t
)
dEdΩ = ϕ
)
r, υ, t
)
dυ
And dυ = υ2dυdΩ (Appendix B) and E = 1 
2 mυ2. Using these relations, we 
convert Eq. (1.1) to the velocity form: (refer to the reference mentioned at the 
beginning of the chapter for more details) 
1 
υ
∂ϕ)
r , υ, t
)
S
)
r , υ, t
)
∂t
+
(
υ
dυ,
ϕ
)
r, υ,
, t
)
Σs
)
r, υ, → υ
)
− ϕ
)
r , υ, t
)
Σt
)
r , υ)
− Ω · ∇ϕ
)
r , υ, t
) (1.11) 
This form had been used in old reactor theory books. 
2. Short-term transients 
In the case of short transient times comparable to the delay times of neutrons emit￾ted from the decay of neutron precursors, it becomes necessary to incorporate the 
role of delayed neutrons in the neutron transport equation. The transport equation 
is written explicitly for the prompt and delayed neutrons as 
1 
υ
∂ϕ
∂t = −Ω · ∇ϕ
)
r , E, Ω, t
)
− Σt
)
r , E, Ω)
ϕ
)
r , E, Ω, t
)
+
(∞
0 
d E,
(
4π
dΩ,
Σs
)
r, E,
E, Ω,
Ω)
ϕ
)
r, E,
, Ω,
, t
)
+ (1 − β)χ(E) ×
(
4π
dΩ,
(∞
0 
d E,
ν
)
E,
)
Σ f
)
r, E,
)
ϕ
)
r , E,
, Ω,
, t
)
+Σ
6
i=1 
λi Ci
)
r, t
)
χi and i = 1,... 6, (1.12) 
where 
β the delayed neutron fraction, 
λi the ith precursor decay constant, 
χi the energy spectrum of the delayed neutrons produced from the decay of the 
ith precursor, and16 1 Neutron Transport—The Neutron Transport Equation
Ci the atom density of the ith precursor. 
The last term is the rate of delayed neutrons production from precursor decay and 
the preceding term represents the emission rate of prompt fission neutrons. The 
familiar precursor balance equation from previous knowledge of reactor kinetics 
is 
∂
∂t 
Ci
)
r, t
)
=
(
4π
dΩ,
(
d E,
βi ν
)
E,
)
Σ f
)
r, E,
)
ϕ
)
r , E,
, Ω,
, t
)
− λi Ci
)
r, t
)
;i = 1,... 6 (1.13) 
where βi is the delayed neutron fraction from the ith precursor. 
The first term on the right is the fraction of fission neutrons that are delayed 
which is equivalent to the precursor production rate and the last term is the pre￾cursor loss rate via decay. These two equations will be revisited when we derive 
the kinetic parameters. 
3. Steady state 
When the reactor is critical and operating at steady power, the neutron flux 
is also steady which implies that the flux is unchanging with time such that 
ϕ
)
r, E, Ω, t
)
→ ϕ
)
r , E, Ω)
and mathematically requires that: ∂ϕ
∂t = 0 Eq. (1.10) 
reduces to 
Ω · ∇ϕ
)
r, E, Ω)
+ ϕ
)
r , E, Ω)
Σt
)
r, E
)
= χ(E)
4π
(
4π
dΩ,
(∞
0 
d E,
ν
)
E,
)
Σ f
)
r , E,
)
ϕ
)
r, E,
, Ω,
)
+
(∞
0 
d E,
(
4π
dΩ,
ϕ
)
r , E,
, Ω,
)
Σs
)
r, E, → E, Ω, → Ω) (1.14) 
4. One speed 
When the neutrons are assumed to move with one speed, it implies no energy 
change while moving around and upon scattering. The fission source is also 
assumed to emit neutrons with a single energy upon capture at the same energy. 
In this case, the directional dependence is not affected and it may change upon 
scattering. The equation may look like this:1.3 Simplified Forms of the Neutron Transport Equation 17
1 
υ
∂ϕ
∂t = νΣ f
)
r
)
4π
(
4π
dΩ,
ϕ
)
r , Ω,
, t
)
+
(
4π
dΩ,
ϕ
)
r, Ω,
, t
)
Σs
)
r ,,Ω, → Ω)
− Ω · ∇ϕ
)
r, Ω, t
)
− Σt
)
r
)
ϕ
)
r, Ω, t
) (1.15) 
If isotropic scattering and isotropic flux are also assumed then 
1 
υ
∂φ
∂t = νΣ f
)
r
)
φ
)
r, t
)
− ∇.J
)
r, t
)
− Σa
)
r
)
φ
)
r, t
)
If steady state is assumed, then 
∇.J
)
r
)
+ Σa
)
r
)
φ
)
r
)
= νΣ f
)
r
)
φ
)
r
) (1.16) 
We can see how drastic the assumptions are. It will produce a non-representative 
equation to the actual reality in the reactor core. It might be only useful in 
understanding some of the physics of the reactor. 
5. One-dimensional transport equation 
The assumption of one dimension requires the disappearance of the other two 
dimensions and hence the dependence on the azimuthal angle ψ should be no 
longer valid even though this dependence is considered weak regardless of the 
effect of the assumption of one dimension. The angle θ extends from 0 to π. 
Figure 1.10 shows this. Based on the above assumptions, we make the following 
definitions: 
Fig. 1.10 One-dimensional neutron transport18 1 Neutron Transport—The Neutron Transport Equation
ϕ(z, μ, t) =
(
2π
0 
dψϕ)
z, Ω, t
)
S(z, μ, t) =
(
2π
0 
dψ S
)
z, Ω, t
)
Equation (1.10) with a fission source is integrated over ψ assuming isotropic 
scattering to obtain 
1 
υ
∂
∂t 
ϕ(z, μ, t) = νΣ f 
2 (
+1
−1 
dμ,
ϕ
)
z, μ,
, t
)
+
Σs 
2 (
+1
−1 
dμ,
ϕ
)
z, μ,
, t
)
− Σt ϕ(z, μ, t) − μ
∂
∂z 
ϕ(z, μ, t)
A steady state form is 
μ
∂
∂z 
ϕ(z, μ) + Σt ϕ(z, μ) = Σs 
2 (
+1
−1 
dμ,
ϕ
)
z, μ,
)
+
νΣ f 
2 (
+1
−1 
dμ,
ϕ
)
z, μ,
) (1.17) 
6. Diffusion equation 
We start by integration of the transport equation over all directions Ω, because in 
diffusion theory the basic assumption is the angular independence and hence the 
source, the flux, and scattering are isotropic.
(
4π
dΩ
⎡
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎣
1 
υ
∂ϕ
∂t = S
)
r , E, Ω, t
)
+ χ (E)
4π
(∞
0 
d E,
ν
)
E,
)
Σ f
)
r , E,
) (
4π
dΩ,
ϕ
)
r , E,
, Ω,
, t
)
+
1 
4π
(∞
0 
d E,
Σs (r, E, → E)
(
4π
dΩ,
ϕ
)
r , E,
, Ω,
, t
)
− ϕ
)
r , E, Ω, t
)
Σt
)
r , E, Ω)
− Ω · ∇ϕ
)
r , E, Ω, t
)
⎤
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎦1.3 Simplified Forms of the Neutron Transport Equation 19
And redefining 
φ
)
r , E, t
)
=
(
4π
ϕ
)
r , E, Ω, t
)
dΩ
S
)
r, E, t
)
=
(
4π
S
)
r, E, Ω, t
)
dΩ
J
)
r , E, t
)
=
(
4π
Ωϕ
)
r, E, Ω, t
)
dΩ
The leakage term requires special treatment
(
4π
Ω · ∇ϕ
)
r, E, Ω, t
)
dΩ =
(
4π
∇ · Ωϕ
)
r , E, Ω, t
)
dΩ
= ∇ ·
(
4π
Ωϕ
)
r , E, Ω, t
)
dΩ = ∇ · J (r, E, t)
Finally, we obtain the neutron continuity equation 
1 
υ
∂φ
∂t = S
)
r, E, t
)
+ χ(E)
(∞
0 
d E,
ν
)
E,
)
Σ f
)
r, E,
)
φ
)
r , E,
, t
)
+
(∞
0 
d E,
Σs
)
r , E, → E
)
φ
)
r , E,
, t
)
− Σt
)
r , E
)
φ
)
r , E, t
)
− ∇ · J
)
r , E, t
)
The diffusion approximation states that the net current is proportional to the 
negative gradient of the flux that is 
J
)
r, E, t
)
∝ −∇φ
)
r, E, t
)
The constant of proportionality is just the diffusion coefficient D. We rewrite 
the equation of proportionality as 
J
)
r , E, t
)
= −D
)
r, E
)
∇φ
)
r, E, t
)
Substituting this into the continuity equation, we get the diffusion equation 
1 
υ
∂φ
∂t = S
)
r , E, t
)
+ χ(E)
(∞
0 
d E,
ν
)
E,
)
Σ f
)
r , E,
)
φ
)
r, E,
, t
)20 1 Neutron Transport—The Neutron Transport Equation
+
(∞
0 
d E,
Σs
)
r , E, → E
)
φ
)
r, E,
, t
)
− Σt
)
r , E
)
φ
)
r , E, t
)
+ ∇ · D
)
r, E
)
∇φ
)
r , E, t
) (1.18) 
The geometrical representation of the flux is important so that when a 
dimension or two or three is used it is understood what it does mean. The 
3D neutron flux at a point anywhere in the sphere is ϕ(r,θ,ψ). A 2D flux 
ϕ(r, θ); ϕ(r, ψ); ϕ(θ , ψ) is the flux on a line, e.g. ϕ(r, θ) =
2
(π
0 
ϕ(r,θ,ψ)dψ is 
the total flux on rings at a certain θ and a certain r. The 1D flux φ(r ); ϕ(ψ); ϕ(θ)
is the total flux on a surface, e.g. φ(r) = (
π
0 
dθ
2
(π
0 
ϕ(r,θ,ψ)dψ is the total flux 
on the shells at a certain r. Other geometrical fluxes can be described in the same 
manner. For example, in plane geometry, the flux at a certain x is the total flux on 
a surface that extends in the y − z dimensions at a given x. The concepts of direc￾tional derivative, solid angle, and differential velocity are discussed and derived in 
appendices A and B. Other types of radiative transport equations are introduced in 
appendix C. 
1.4 The Integral Method 
1. Neutron transport in a non-multiplying infinite medium [1, 3] 
Assuming a distributed neutron source emitting S
(
r
,
)
n/sec in an infinite non￾multiplying absorbing medium (Fig. 1.11). The neutron flux at position r in 
direction Ω results from neutrons emitted in the same direction from the source 
at r, can be deduced from the basics of neutron attenuation. Firstly, the neutrons 
travel a distance |
|r − r,
|
| to point r. Notice that: r − r
,
= |
|r − r,
|
|Ω. The flux 
is reduced by a geometrical factor equal to the inverse of the surface area of the 
sphere ( 1 
4π|r−r,
|
2
)
as if the source is in a vacuum. Secondly, during this travel, the 
neutrons are attenuated due to absorption by the probability [
exp)
−Σa
|
|r − r,
|
|
)]
of neutron reaching point r without being absorbed. Therefore, the neutron flux is 
φ
)
r
)
=
(
d3
r,
S
)
r,
) exp)
−Σa
|
|r − r,
|
|
)
4π
|
|r − r,
|
|
2 (1.19)1.4 The Integral Method 21
Fig. 1.11 Neutron transport in an infinite medium 
2. Neutron transport in a non-multiplying slab 
If we convert this formulation above to a slab of non-multiplying medium, then 
we twist the geometry to suit an infinite slab as shown in Fig. 1.12. 
d3
r, = 2πr,
dx,
dr,
From Fig. 1.12, 
R2 = |
|x − x,
|
|
2 + r,2 
so that 
Rd R = r,
dr,
where |
|x − x,
|
| is a constant. Equation 1.19 takes the form 
φ(x) = 1 
2
(
dx,
(∞
|x−x,
|
dR S)
x,
) exp(−Σa R)
R (1.20)22 1 Neutron Transport—The Neutron Transport Equation
Fig. 1.12 Neutron transport 
in a semi-infinite 
non-multiplying slab
where the neutron flux at x is a result of contributions from all points at x,
. The 
integration over R gives the first-order exponential integral function 
E1
[
Σt
|
|x − x,
|
|
]
=
(∞
|x−x,
|
dR exp(−Σa R)
R 
Substituting back in Eq. (1.20), we get 
φ(x) = 1 
2 (a
−a 
dx,
S
)
x,
)
E1
[
Σa
|
|x − x,
|
|
] (1.21) 
If we want to generalize Eq. (1.20) to include the energy dependence, we have 
to add the scattering transfer term to the source and the absorption cross section 
is replaced by the total cross section.1.4 The Integral Method 23
3. Neutron transport in a multiplying slab 
Consider a slab of a multiplying material of width 2a described by the one￾speed theory and the assumption of isotropic scattering. Then the source term in 
Eq. (1.20) is replaced by a fission source νΣ f φ(x). If we account for the loss and 
production via scattering by replacing Σa by Σt and add Σs to the fission source. 
This modification is looked at as a makeup for the assumption of one-speed theory, 
then 
φ(x) = γ
2 (a
−a 
dx,
φ
)
x,
)
E1
[
Σt
|
|x − x,
|
|
] (1.22) 
where γ = [
νΣ f + Σs
]
. Equation (1.22) represents the integral form of the trans￾port equation. The value of γ is to be examined using variational methods in 
Chap. 8 when criticality of the slab is sought. 
Exercises 
1. In a cylindrical thermal reactor of extrapolated radius R and height H, the 
angular neutron flux is 
ϕ
)
r , E, Ω)
= φ0 
4π
Eexp(
− E 
kT )
cos 
πz 
H 
J0
(ν0r 
R
)
Compute the total number of neutrons in the reactor. 
2. Suppose that the angular neutron density is given by 
n
)
r , Ω)
= n0 
4π
(1 − cos θ)
where θ is the between Ω and the z-axis. If A is the area perpendicular to the 
z-axis, then what is the number of neutrons passing through the area A per 
second: (a) per unit solid angle at an angle of 45o with the z-axis, (b) from 
the negative z to the positive z direction, (c) net, and (d) total? 
3. Demonstrate that, in an isotropic flux, the partial current density in any 
direction is given by J ± = φ
/
4. 
4. Explain briefly whether or not the transport equation as we have derived it 
adequately describes the spatial and angular distributions of neutrons (a) in 
a flux of an order of magnitude of 100/
cm2 − s, (b) scattering in a single 
crystal, (c) passing through a thin pure absorber, and (d) originating within 
a very intense nuclear explosion in which the explosion debris are moving 
outward with very high velocities.24 1 Neutron Transport—The Neutron Transport Equation
5. Obtain the velocity form of the transport equation from the general form 
defined by Eq. (1.10). 
6. Derive Eqs. (1.12) and (1.13) which account for delayed neutrons by modify￾ing the general form Eq. (1.10). 
7. Show that the neutron transport equation in spherical coordinates with 
azimuthal symmetry (no dependence on the azimuthal angle ψ) can be written 
as 
μ
∂
∂r 
ϕ(r , μ) +
1 − μ2 
r 
∂
∂μϕ(r , μ) + Σt ϕ(r, μ)
= 2π
(
+1
−1 
dμ,
Σs (μ0)ϕ
)
r , μ,
)
+ S(r, μ)
We refer the reader to appendixes A and B. 
8. Obtain the one-dimensional form Eq. (1.17). 
9. Try to find solutions to the equation 
μ
∂
∂z 
φ(z, μ) + Σt φ(z, μ) = Σs 
2 (
+1
−1 
dμ,
φ
)
z, μ,
)
In the form φ(z, μ) = χ(μ)exp(−z/ν). Find χ(μ) and ν? 
10. Referring to the energy group structure shown convert the neutron transport 
equation to a multi-group form by integrating it over the group g where the 
flux and weighted group cross sections are defined as 
ϕg
)
r, Ω)
=
E
(g−1
Eg 
d Eϕ
)
r , E, Ω)
Σg
)
r
)
=
( Eg−1 
Eg d EΣ(r , E)ϕ
)
r, E, Ω)
( Eg−1 
Eg d Eϕ
)
r, E, Ω) = 1 
φg 
E
(g−1
Eg 
d EΣ(r , E)ϕ
)
r , E, Ω)References 25
11. Consider neutron transport in a one-dimensional rod [6]. That is the neutrons 
can move only to the left or to the right. If the neutron density of neu￾trons moving to the left is n−(x, E, t) and that to the right is n+(x, E, t), 
one needs only consider forward scattering described by Σ+
s
)
E, → E
) or 
backward scattering described by Σ−
s
)
E, → E
)
. 
(a) Derive the transport equations for n+ and n−. 
(b) Make the one-speed approximation in this set of equations, that is 
Σt = Σa + Σ+
s (E) + Σ−
s (E) = Σa + Σ+
s + Σ−
s 
Σ±
s
)
E, → E
)
= Σ±
s δ
)
E, → E
)
(c) Describe the boundary and initial conditions necessary to complete the 
specifications of the problem if the rod length is L. 
12. Explore the geometrical representation corresponding to the following physi￾cal quantities in the three geometries. 
(i) Finite sphere of radius R 
ϕ(r,θ,ψ); ϕ(r , θ); ϕ(r , ψ); ϕ(θ , ψ); φ(r); ϕ(ψ); ϕ(θ); φ
Finite cylinder of radius R and height H 
ϕ(r ,z, ψ); φ(r ,z); ϕ(r, ψ); ϕ(z, ψ); φ(r ); ϕ(ψ); φ(z); φ
(ii) Parallel piped of dimensions a, b, c 
φ(x, y,z); φ(x, y); φ(x,z); φ(y,z); φ(x); φ(y); φ(z); φ
Try to draw the resulting figures. 
References 
1. G. Bell, S. Glasstone, Nuclear Reactor Theory (Van Nostrand, New York, 1971) 
2. J. Duderstadt, W. Martin, Transport Theory (Wiley, New York, 1979) 
3. W. Martin, Lecture Notes on Transport Theory (University of Michigan, Nuclear Engineering, 
1981) 
4. E. Kreyszig, Advanced Engineering Mathematics (Wiley, New York, 1972) 
5. E.J. Allen, A finite element approach for treating the energy variable in the numerical solution 
of the neutron transport equation. Transp. Theory Stat. Phys. 15(4) (1986) 
6. J. Duderstadt, Lecture Notes, on Reactor Theory (University of Michigan, Nuclear Engineering, 
1977) 
7. J. Duderstadt, L. Hamilton, Nuclear Reactor Analysis (Wiley, New York, 1976)2 Neutron Diffusion—The Finite 
Difference Solution of the Neutron 
Diffusion Equation 
The neutron diffusion equation is a simpler form of the transport equation (derived 
in Chap. 1.3). It is the transport equation with an angular independence (isotropy) 
combined with what is known as Fick’s law (the diffusion approximation to the 
net current density). Solutions of the diffusion equation as a function of space, 
energy, and time are very reliable in many cases of reactor designs where they 
provide the neutron flux, the criticality constant, and the power distribution. The 
reactor physics problems and analytical solutions in the study of diffusion theory 
are not the subject of this book, rather we deal only with the numerical solution, 
in particular, the finite difference method. 
In Sect. 2.1, the mesh structure for the discretized space variable is well 
described and the transformation of the analytical form of the diffusion equation to 
numerical form is carried out with boundary points which are well represented in 
the scheme. Section 2.2 describes the solution algorithm. Numerical formulation 
of the one-dimensional multi-group diffusion equation is obtained in Sect. 2.3. In 
Sect. 2.4, the two-dimensional multi-group matrices are derived. In appendix, the 
ONED diffusion code (a one-dimensional bare and reflected slab and cylindrical 
reactor, with one or two energy groups) is run for different cases with test problems 
which are left for students to carry out. 
The general form of the steady-state neutron diffusion equation can be written 
as follows: 
Supplementary Information The online version contains supplementary material available at 
https://doi.org/10.1007/978-3-031-26932-5_2.
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2023 
R. M. Kuridan, Neutron Transport, Graduate Texts in Physics, 
https://doi.org/10.1007/978-3-031-26932-5_2 
2728 2 Neutron Diffusion—The Finite Difference Solution …
−∇ · D
(
r
)
∇φ
(
r
)
+ Σa
(
r
)
φ
(
r
)
= νΣ f
(
r
)
λ φ
(
r
)
where 
D is the diffusion coefficient, 
Σa is the absorption cross section, and 
φ is the scalar neutron flux. 
While, in differential equations, λ represents the eigenvalue, in reactor cores, it 
defines the multiplication factor k. 
2.1 Finite Difference Formulation of the One-Dimensional 
One-Group Neutron Diffusion Equation 
The one-group one-dimensional neutron diffusion equation in planar, cylindrical, 
and spherical geometries is written in the following form; in order to facilitate the 
numerical scheme, we will follow closely the references [1, 2, 3]: 
− 1 
x p 
d 
dx |
D(x)x p dφ
dx |
+ Σa(x)φ(x) = νΣ f (x)
λ φ(x) (2.1) 
where 
p =
⎧
⎨
⎩
0, x = x slab 
1, x = r cylinder 
2, x = r sphere 
In numerical methods, the continuous independent variable x is transformed 
into a finite number of mesh intervals within which the dependent variable or 
function will assume a constant value which is equal to the integrated value of the 
function across the mesh. Therefore, we end up with a system of algebraic equa￾tions where its dimensions correspond to the number of mesh intervals. Referring 
to the diffusion Eq. 2.1, the neutron flux will assume one value at each mesh 
(Fig. 2.1), and hence the larger the number of meshes the smaller the mesh thick￾ness, the nearer the estimated flux to the actual value of the neutron flux. Actually, 
this is the subject of the error analysis in the field of numerical methods.
The numerical form of the diffusion equation is based upon the following 
assumptions:
1. The choice of the mesh intervals has to be narrow and the material composition 
inside the interval is homogenous and hence the nuclear properties are uniform. 
2. The flux is defined on the mesh boundary.2.1 Finite Difference Formulation of the One-Dimensional One-Group Neutron … 29
Fig. 2.1 Dividing the independent variable into mesh intervals
3. Defining the flux gradient by the finite difference method. 
Figure 2.2 shows the definitions of different physical quantities on the mesh 
structure. Accordingly, the quantities are defined as follows: 
Σ(x) → Σn and D(x) → Dn x ∈ |
xn, xn+1
|
φ(x) → φn and x ∈ |
x0 
n−1, x0 
n
|
x0 
n = xn +
hn 
2 
and x0 
n−1 = xn−1 +
hn−1 
2 
hn = xn+1 − xn and hn−1 = xn − xn−1 
dφ
dx = φn+1 − φn 
hn 
and x ∈ |
xn, xn+1
|
The flux definition across the mesh boundary will guarantee continuity of the 
flux between meshes of different compositions, while the derivative will suffer 
the discontinuity. We begin by multiplying Eq. 2.1 by x p and integrate over the 
interval |
x0 
n−1, x0 
n
|
such that 
−
x0 
{ n
x0 
n−1 
dx 
d 
dx |
D(x)x p dφ
dx |
+
x0 
{ n
x0 
n−1 
dx x pEa(x)φ(x)
=
x0 
{ n
x0 
n−1 
dx x p νE f (x)
λ φ(x)30 2 Neutron Diffusion—The Finite Difference Solution …
Cross 
sectons 
Flux 
Flux 
derivatve 
Fig. 2.2 Mesh interval structure
Firstly: The leakage term 
I1 = −|
D(x)x p dφ
dx |x0 
n 
x0 
n−1 
= D
(
x0 
n−1
)(x0 
n−1
)p dφ
dx
|
|
|
|
x0 
n−1 
− D
(
x0 
n
)(x0 
n
)p dφ
dx
|
|
|
|
x0 
n 
Notice from Fig. 2.2 that D
(
x0 
n
)
= Dn and D
(
x0 
n−1
)
= Dn−1. Substituting for 
the derivatives using 
dφ
dx
|
|
|
x0 
n−1 
= φn−φn−1 
hn−1 and dφ
dx
|
|
|
x0 
n 
= φn+1−φn 
hn and substitute for the coordinates of 
x0 
n and x0 
n−1, we get 
I1 = Dn−1
(
xn−1 +
hn−1 
2
)p(φn − φn−1 
hn−1
)
− Dn
(
xn +
hn 
2
)p(φn+1 − φn 
hn
)
And we define 
Dn = Dn 
hn
(
xn + hn 
2
)p 
and Dn−1 = Dn−1 
hn−1
(
xn−1 + hn−1 
2
)p 
, we obtain 
I1 = Dn−1(φn − φn−1) − Dn(φn+1 − φn)
Or in the final form 
I1 = −Dn−1φn−1 + (
Dn−1 + Dn
)
φn − Dnφn+12.1 Finite Difference Formulation of the One-Dimensional One-Group Neutron … 31
Secondly: The absorption term. 
By definition, the neutron flux is constant in the range of integration, then 
I2 =
x0 
{ n
x0 
n−1 
dx x pΣa(x)φ(x) = φn 
x0 
{ n
x0 
n−1 
dx x pΣa(x)
The range of integration crosses the mesh boundary, so by dividing it the cross 
section also changes, we get 
I2 = φn {xn
x0 
n−1 
dx x pΣa(x) + φn 
x0 
{ n
xn 
dx x pΣa(x)I2 
= φnΣa,n−1 {xn
x0 
n−1 
dxx p + φnΣa,n 
x0 
{ n
xn 
dxx p 
= φnΣa,n−1
|
(xn)p+1 
p + 1 −
(
x0 
n−1
)p+1 
p + 1
|
+ φnΣa,n
|(
x0 
n
)p+1 
p + 1 − (xn)p+1 
p + 1
|
Defining, 
Σa,n = Σa,n−1
|
(xn)p+1 
p + 1 −
(
x0 
n−1
)p+1 
p + 1
|
+ Σa,n
|(
x0 
n
)p+1 
p + 1 − (xn)p+1 
p + 1
|
We obtain the second term as 
I2 = φnΣa,n 
Thirdly: The fission term. 
The steps are similar to the absorption term, and hence we have 
I3 = φnΣ f ,n 
where 
Σ f ,n = νΣ f ,n−1 
λ
|
(xn)p+1 
p + 1 −
(
x0 
n−1
)p+1 
p + 1
|
+
νΣ f ,n 
λ
|(
x0 
n
)p+1 
p + 1 − (xn)p+1 
p + 1
|
Collecting the three terms I1, I2, I3 
−Dn−1φn−1 + (
Dn−1 + Dn + Σa,n
)
φn − Dnφn+1 = φnΣ f ,n32 2 Neutron Diffusion—The Finite Difference Solution …
Finally, we obtain the system of algebraic equations representing the diffusion 
equation in its numerical form: 
anφn−1 + bnφn + cnφn+1 = Sn, n = 2, ··· N (2.2) 
where 
an = −Dn−1 
bn = (
Dn−1 + Dn + Σa,n
)
cn = −Dn 
Sn = φnΣ f ,n 
Equation 2.2 represents all points except x1 and xN +1 at the boundaries of the 
medium as shown in Fig. 2.1. In order to have a complete system of equations, we 
have to consider the points n = 1 and n = N + 1 separately. 
2.1.1 Left Boundary 
If the region on the left side of the left boundary (Fig. 2.3) consists of a material, 
then it is a part of the medium and should be included in the numerical formulation 
of the problem. Otherwise, it is a vacuum and it should be treated as a vacuum 
boundary from which neutrons are unable to return to the medium and the flux 
vanishes at the extrapolation distance.
Extending the mesh intervals inside the vacuum and by definition the density 
of vacuum is zero which leads to considering D0 = 0 and Σ0 = 0. Therefore, 
a1 = −D0 = − D0 
h0
(
x0 +
h0 
2
)p 
= 0
b1 = (
D0 + D1 + Σa,1
)
= 0 +
D1 
h1
(
x1 +
h1 
2
)p 
+ Σa0
|
(x1)p+1 
p + 1 −
(
x0 
0
)p+1 
p + 1
|
+ Σa,1
|(
x0 
1
)p+1 
p + 1 − (x1)p+1 
p + 1
|
b1 = D1 
h1
(h1 
2
)p 
+ Ea,1
|(
x0 
1
)p+1 
p + 1 − (x1)p+1 
p + 1
|2.1 Finite Difference Formulation of the One-Dimensional One-Group Neutron … 33
Cross 
sections 
Flux 
Flux 
derivative 
vacuum 
Fig. 2.3 Mesh structure on the left boundary
= D1 
h1
(h1 
2
)p 
+ Ea,1
|( h1/ 2
)p+1 
p + 1
|
c1 = −D1 = D1 
h1
(
x1 +
h1 
2
)p 
= D1 
h1
(h1 
2
)p 
S1 = φ1Σ f ,1 = νΣ f ,0 
λ
|
(x1)p+1 
p + 1 −
(
x0 
1
)p+1 
p + 1
|
φ1 
+
νΣ f ,1 
λ
|(
x0 
1
)p+1 
p + 1 − (x1)p+1 
p + 1
|
φ1 
= νΣ f ,1 
λ
|(
h1/2
)p+1 
p + 1 −
(
h1/2
)p+1 
p + 1
|
φ1 
Collecting terms, we obtain the left boundary equation 
b1φ1 + c1φ2 = S1 (2.3) 
2.1.2 Right Boundary 
Extending the mesh intervals inside the vacuum to the right of the boundary as 
shown in Fig. 2.4 and knowing that the nuclear properties in the mesh residing in 
the vacuum are ΣN +1 = 0 and DN +1 = 0.34 2 Neutron Diffusion—The Finite Difference Solution …
aN +1 = −DN = − DN 
hN
(
xN +
hN 
2
)p 
bN +1 = DN 
hN
(
xN +
hN 
2
)p 
+
DN+1 
hN +1
(
xN +1 +
hN +1 
2
)p 
+ ΣaN |
(xN +1)p+1 
p + 1 −
(
x0 
N
)p+1 
p + 1
|
+ Σa,N +1
|(
x0 
N+1
)p+1 
p + 1 − (xN+1)p+1 
p + 1
|
bN +1 = DN 
hN
(
xN +
hN 
2
)p 
+ ΣaN |
(xN+1)p+1 
p + 1 −
(
x0 
N
)p+1 
p + 1
|
cN +1 = −DN +1 = − DN +1 
hN +1
(
xN +1 +
hN +1 
2
)p 
= 0 
Collecting terms, we obtain the right boundary equation 
aN +1ϕN + bN +1ϕN +1 = SN +1 (2.4) 
Equations 2.2, 2.3, and 2.4 constitute the complete system of algebraic
Cross 
sections 
Flux 
Flux 
derivative 
Fig. 2.4 Mesh structure on the right boundary 2.2 Solution Algorithm 35 
SN +1 = φN +1Σ f ,N+1 
= φN +1 
νΣ f ,N 
λ
|
(xN +1)p+1 
p + 1 −
(
x0 
N
)p+1 
p + 1
|
+ φN+1 
Σ f ,N +1 
λ
|(
x0 
N+1
)p+1 
p + 1 − (xN +1)p+1 
p + 1
|
SN +1 = φN +1 
νΣ f ,N 
λ
|
(xN +1)p+1 
p + 1 −
(
x0 
N
)p+1 
p + 1
|
equations for the one-dimensional one-group neutron diffusion equation based 
on the three-point finite difference scheme. In the following sections, we use 
numerical techniques to search for a solution for λ and the flux profile. 
2.2 Solution Algorithm 
The system of linear algebraic Eqs. 2.2, 2.3, and 2.4 can be solved by different 
methods including the iterative methods. In the one-dimensional case, one can 
obtain a solution using the Gaussian elimination technique by the forward and the 
backward substitution. One suggests this algorithm 
φn = mn − qnφn+1 (2.5) 
Substituting in Eq. 2.2 for φn 
anφn−1 + bn
|
mn − qnφn+1
|
+ cnφn+1 = Sn 
anφn−1 + (cn − bnqn)φn+1 + [bnmn − Sn] = 0 (2.6) 
Equation 2.5 can be written as 
φn−1 = mn−1 − qn−1φn 
Substituting from Eq. 2.5 for φn again, we get 
φn−1 = mn−1 − qn−1(mn − qnφn+1)
Substituting for φn−1 in Eq. 2.6 
an
|
mn−1 − qn−1(mn − qnφn+1)
|
+ (cn − bnqn)φn+1 + [bnmn − Sn] = 036 2 Neutron Diffusion—The Finite Difference Solution …
and rearranging, we obtain 
(cn − bnqn + anqnqn−1)φn+1 + (anmn−1 + bnmn − anmnqn−1 − Sn) = 0 
It is sufficient to make the quantities in brackets equal to zero to obtain 
qn = cn 
bn − anqn−1 
(2.7) 
mn = Sn − anmn−1 
bn − anqn−1 
= qn 
cn 
(Sn − anmn−1) (2.8) 
The solution algorithm begins from the calculation of the initial pairs (q1, m1)
using Eqs. 2.3, 2.7, and 2.8 as q1 = c1 
b1 and m1 = S1 
b1 , then proceeding to higher 
order pairs (qn, mn) where 2 ≤ n ≤ N . Once the pairs are calculated, then Eq. 2.5 
is used to calculate φN from φN +1 on the right boundary such that 
φN = mN − qN φN+1 
The neutron flux φN +1 at the boundary point xN +1 should be known just like 
any other boundary value problems. The solution will proceed to φN −1 and so 
on to φ1. Notice that there is no need to calculate the pair (qN +1, mN +1). Equa￾tions 2.7 and 2.8 are equivalent to the forward substitution and Eq. 2.5 is equivalent 
to the backward substitution in the Gaussian elimination method. 
The numerical stability of a numerical algorithm is related to the accuracy of the 
procedure. An algorithm can have different levels of numerical stability because 
many computations can be achieved in various ways that are algebraically equiv￾alent but may produce different results. A robust numerical algorithm with a high 
level of numerical stability is desirable. Gaussian elimination is numerically stable 
for strictly diagonally dominant matrices or symmetric positive definite matrices. 
For matrices with a general dense structure, Gaussian elimination with partial 
pivoting is usually numerically stable in practice.11 
2.2.1 Boundary Conditions 
The neutron flux and current at the boundary points on the left- and right-hand 
side of the medium have to be known in order to reach a solution to the diffusion 
equation. The two boundary conditions are the zero flux and zero current at x1 and 
xN+1. 
(1) Zero flux at x1 
φ(x1) = φ1 = 02.2 Solution Algorithm 37
From Eq. 2.5 
φ1 = m1 − q1φ2 = 0 
which requires that 
m1 = q1 = 0 
Since m1 = S1 
b1 and S1 = 0 at x1 and φ2 /= 0. 
(2) zero current at x1 
Figure 2.3 does not apply to this case because the current is zero only at the center 
due to symmetry as shown in Fig. 2.5. From the definition of the current, we have 
dφ
dx
|
|
|
x=x1 
= 0. It requires revising the derivation of the leakage term because it 
contains the flux derivative 
I1 = −
x0 
1 
∫
x1 
dx 
d 
dx |
D(x)x p dφ
dx |
I1 = −|
D(x)x p dφ
dx |x0 
1 
x1 
= D(x1)(x1)p dφ
dx
|
|
|
|
x1 
− D
(
x0 
1
)(x0 
1
)p dφ
dx
|
|
|
|
x0 
1 
I1 = −D
(
x0 
1
)(x0 
1
)p dφ
dx
|
|
|
|
x0 
1 
= −D1
(
x0 
1
)p
|
φ2 − φ1 
h1
|
= D1φ1 − D1φ2 
where x1 = 0 
The coefficients a1 and b1 have to change due to this condition, i.e. 
a1 = 0
medium medium 
Fig. 2.5 Zero current condition at the center 38 2 Neutron Diffusion—The Finite Difference Solution …
b1 = D1 + Σa,1
|(
x0 
1
)p+1 
p + 1 − (x1)p+1 
p + 1
|
c1 = −D1 
S1 = νΣ f ,1 
λ
|(
x0 
1
)p+1 
p + 1 − (x1)p+1 
p + 1
|
φ1 
And the equation for this boundary becomes 
b1φ1 + c1φ2 = S1 
Comparing to Eq. 2.5 ( n = 1), we obtain 
m1 = S1 
b1 
, q1 = c1 
b1 
(3) zero flux at x = xN +1 
Because φ(xN +1) = φN +1 = 0, Eq. 2.5 becomes 
φN = mN 
from which the backward substitution is started. Figure 2.4 and the derivation that 
follows apply to this case. 
(4) zero current at x = xN +1 
We refer to Fig. 2.6 where we have dφ
dx
|
|
|
x=xN+1 
= 0. At the center, it can be easily 
shown that DN +1 = 0 
aN +1 = −DN 
bN +1 = DN + Σa,N
|
(xN +1)p+1 
p + 1 −
(
x0 
N
)p+1 
p + 1
|
cN +1 = −DN +1 = 0 
SN +1 = φN +1 
νΣ f ,N 
λ
|
(xN +1)p+1 
p + 1 −
(
x0 
N
)p+1 
p + 1
|2.2 Solution Algorithm 39
medium medium
Fig. 2.6 Zero current condition in a symmetric medium 
And the equation at the boundary becomes 
aN +1φN + bN +1φN +1 = SN +1 
Using φN = mN − qN φN +1, we get 
φN +1 = SN +1 − aN +1mN 
bN +1 − aN+1qN 
as we have done earlier. 
2.2.2 Methods of Solution 
We can now write the system of Eq. 2.2 in addition to the equations at the 
boundaries 3 and 4 in the following matrix form: 
A Φ = S (2.9) 
such that 
A =
⎡
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎣
b1 c1 0 
a2 b2 c2 0 
0 a3 b3 c3 
... ... ...
0 ... bN cN 
aN +1 bN +1 
⎤
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎦
, Φ =
⎡
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎣
ϕ1 
ϕ2 
ϕ3 
ϕN +1 
⎤
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎦
, S =
⎡
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎣
S1 
S2 
S3 
SN +1 
⎤
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎦
One can show that the algorithms 5, 7, and 8 are equivalent to factorizing the 
tri-diagonal matrix A into two matrices as 
A = LU (2.10)40 2 Neutron Diffusion—The Finite Difference Solution …
where L is a lower triangular matrix and U is an upper triangular matrix. 
Substituting from 9 into 8 and using matrix inversion, we get 
U Φ = L−1 S = M (2.11) 
Φ = U−1L−1 S = U−1M (2.12) 
where 
L =
⎡
⎢
⎢
⎢
⎢
⎢
⎢
⎣
c1/q1 
a2 c2/q2 0 
... ...
0 ... cN /qN 0 
aN+1 0 
⎤
⎥
⎥
⎥
⎥
⎥
⎥
⎦
, U =
⎡
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎣
1 q1 
... ... 0 
... ...
0 ... qN 
1 
⎤
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎦
,
M =
⎡
⎢
⎢
⎢
⎢
⎣
m1 
m2 
mN +1 
⎤
⎥
⎥
⎥
⎥
⎦
The matrix operation 10 represents the forward substitution algorithm and the 
matrix operation 11 represents the backward substitution algorithm. 
1. Inner iteration 
In the case of the eigenvalue problem when S = νΣ f φ
λ , the solution for the flux 
and the eigenvalue comes about through an iteration scheme. In the case of a one￾dimensional case and a known source distribution, there is no need for iterations. 
The iteration scheme for the purpose of finding a flux solution is called the inner 
iteration; on the other hand, the iteration scheme aiming at finding the eigenvalue 
λ is known as the outer iteration or the source iteration. 
2. Source iteration (Outer iteration) 
Power iteration is the most known method in the source iteration scheme. The flow 
chart in Fig. 2.7 summarizes the steps toward the solution. Rewriting Eq. 2.8 as 
A Φ = S = Q 
λ (2.13)2.2 Solution Algorithm 41
Fig. 2.7 A flow diagram for the inner and outer iterations 
The iteration procedure begins by guessing an initial value for the source dis￾tribution Q(0) in its difference form Q(0) n → νΣ f ,nΦ(0) n , n = 1, ··· N + 1 where 
νΣ f ,n is derived earlier without λ
Σ f ,n = νΣ f ,n−1 
λ
|
(xn)p+1 
p + 1 −
(
x0 
n−1
)p+1 
p + 1
|
+
νΣ f ,n 
λ
|(
x0 
n
)p+1 
p + 1 − (xn)p+1 
p + 1
|
Next, guessing λ initially λ(0)
, then solving for the first flux estimate Φ(1) from 
the system 
A Φ(1) = Q(0)
λ(0)
using the algorithm and matrix methods developed before.42 2 Neutron Diffusion—The Finite Difference Solution …
The second step is to obtain an improved value of Q from the equation 
Q(1)
n → νΣ f ,nΦ(1) n 
The eigenvalue is calculated from its definition as a multiplication factor 
λ = neutron production rate/
neutron loss rate 
And hence, 
λ(1) =
∫
V 
dV Q(1)
(
r
)
∫
V 
dV A o(1)
(
r
) =
N 
E
+1
n 
Q(1) n 
N 
E
+1
n
|
A Φ(1)
|
n 
=
N 
E
+1
n 
Q(1) n 
1 
λ(0)
N 
E
+1
n 
Q(0) n 
If we choose the initial normalization as 
1 
λ(0)
N 
E
+1
n 
Q(0)
n = 1 
then 
λ(1) =
N 
E
+1
n 
Q(1)
n =
N 
E
+1
n=1 
νΣ f ,nΦ(1) n 
Knowing Q(1) and λ(1) we find the second estimate for Φ(2) by solving the 
system 
A Φ(2) = Q(1)
λ(1)
And the iteration continues by repeating the same steps until convergence 
occurs. The above procedure can be summarized in the following steps: 
A Φ(i+1) = Q(i )
λ(i )
Q(i+1) = νΣ f ,nΦ(i+1) n 
λ(i+1) =
N
E
+1
n=1 
νΣ f ,nΦ(i+1) n2.2 Solution Algorithm 43
Many techniques have been developed in numerical methods to speed up the 
source iteration procedure such as 
Q(i+1)
λ(i+1) = Q(i)
λ(i ) + α
|
Q(i+1)
λ(i+1) − Q(i )
λ(i )
|
,i ≥ 1 
which states that after the calculation of Q(i+1) and λ(i+1) the ratio between the 
two values is modified using the same ratio obtained from the previous iteration 
step after introducing the factor α as indicated in the equation. The recommended 
value for the factor α is 1.8. The iteration procedure should not extend indefinitely, 
instead the eigenvalues in successive iterations will approach each other and the 
source distribution is like so. The accuracy of the final result is determined by the 
criteria set between successive iterations or the so-called convergence criteria. For 
example, the eigenvalue convergence criteria
|
|
|
|
λ(i+1) − λ(i )
λ(i+1)
|
|
|
|
< ελ (2.14) 
As with respect to source criteria, the difference ratio is calculated for all the 
points (n) and the convergence criteria is selected for the largest among them. 
max n
|
|
|
|
|
Q(i+1)
n − Q(i)
n 
Q(i+1)
n
|
|
|
|
|
< εp (2.15) 
The two parameters ελ and εp are small and positive and they are a measure 
for convergence of the eigenvalue and source distribution, respectively. Usually, 
λ converges faster than Q and the normally used values for the two parameters 
are ελ = 10−5 and εp = 10−4 in criticality calculations. The number of itera￾tions depends on core geometry and heterogeneity as well as the initial source 
distribution. A suitable choice of the source distributions should certainly reduce 
the number of iterations and a known distribution from previous calculations will 
suffice that. 
2.2.3 Power Distribution 
Once the flux is obtained, the power density distribution can be calculated using 
the formula 
P
(
r
)
= ω f Σ f
(
r
)
φ
(
r
)
where ω f is a constant in [watts per fission] which can be derived from the energy 
produced in the fission process.44 2 Neutron Diffusion—The Finite Difference Solution …
The criticality search problem can take other forms such as the critical thickness 
search or fissile concentration (enrichment) search or the search for the reactivity 
worth of control rods preserving the criticality. In all of these cases, λ is set to 
unity. 
2.3 Finite Difference Formulation of the One-Dimensional 
Multi-group Neutron Diffusion Equation 
In this section, we examine the numerical solution of the multi-group one￾dimensional neutron diffusion equation by referring to the discretized multi-group 
structure as shown in Fig. 2.8 [3, 4]. 
− ∇ · Dg
(
r
)
∇φg
(
r
)
+ ΣRg
(
r
)
φg
(
r
)
= E
g−1
g'
=1 
Σsg'
g
(
r
)
φg'
(
r
)
+ χg 
λ
S
(
r
)
,
g = 1, 2, 3, ··· , G (2.16) 
where 
ΣRg
(
r
)
= Σtg
(
r
)
− Σsgg(
r
)
S
(
r
)
= E
G
g'
=1 
νg'Σ f g'
(
r
)
φg'
(
r
)
We initiate the process by guessing the eigenvalue λ(0) and the source distri￾bution S(0)
(
r
) by following the same steps in the case of the one group. Then 
calculate the first group flux from 
−∇ · D1
(
r
)
∇φ(1)
1
(
r
)
+ ΣR1
(
r
)
φ(1)
1
(
r
)
= χ1 
λ(0) S(0)
(
r
)
group group group group
Fig. 2.8 Multi-group structure 2.4 Finite Difference Formulation for the Multi-group Two-Dimensional (x − y) … 45 
This equation is converted to a system of algebraic equations using the finite 
difference method and then applying the source iteration enables us to solve for 
ϕ(1)
1
(
r
)
which is substituted in the next equation for the second group 
−∇ · D2
(
r
)
∇φ(1)
2
(
r
)
+ ΣR2
(
r
)
φ(1)
2
(
r
)
= χ2 
λ(0) S(0)
(
r
)
+ Σs12φ(1)
1
(
r
)
where we solve for φ(1)
2
(
r
)
. This process is continued until we obtain 
φ(1)
1
(
r
)
,φ(1)
2
(
r
)
, φ(1)
3
(
r
)
, ··· , φ(1)
G
(
r
)
The next step is to calculate 
S(1)
(
r
)
= E
G
g'
=1 
νg'Σ f g'
(
r
)
φ(1)
g'
(
r
)
And a new estimate for the eigenvalue 
S(1)
(
r
)
= E
G
g'
=1 
νg'Σ f g'
(
r
)
φ(1)
g'
(
r
)
λ(1) = ∫ dr S(1)
(
r
)
1 
λ(0) ∫ dr S(0)
(
r
)
Notice that knowing the neutron flux at higher energy groups determines the 
source term in the following lower energy group and hence solving the equations 
downward. This is true if there is no up-scattering; however, if this assumption is 
not valid like in the case of dividing the thermal energy group into smaller energy 
groups where appreciable up-scattering is allowed, then the above procedure is 
no longer valid and should be replaced by simultaneous solution for the thermal 
groups. 
2.4 Finite Difference Formulation for the Multi-group 
Two-Dimensional (x − y) Neutron Diffusion Equation 
The multi-group (MG) two-dimensional diffusion equation is of course more real￾istic in reactor analysis than the one-dimensional diffusion equation. The fresh 
fuel assembly is uniform axially in LWRs and the variation of the composition is 
only in the horizontal x- and y-directions. Later in core life as the fuel depletes 
it becomes more heterogenous. Therefore, the two-dimensional geometry will be 
acceptable and often used in preliminary studies. Other geometries are left as an 
exercise. The mesh spacing in one-dimensional geometry is extended to include46 2 Neutron Diffusion—The Finite Difference Solution …
the transverse dimension as shown in Fig. 2.9 and follow the same steps [4−6]. 
The MG diffusion equation in the (x − y) geometry is given by 
− ∂
∂x Dg(x, y)
∂φg 
∂x − ∂
∂ y 
Dg(x, y)
∂φg 
∂ y 
+ ΣRg(x, y)φg(x, y) + E
g−1
g'
=1 
Σsg'
g(x, y)φg'(x, y)
+ χg 
λ
E
G
g'
=1 
νg'Σ f g'(x, y)φg'(x, y),
g = 1, 2, 3,..., G (2.17) 
The mesh boundaries are chosen such that the cross sections don’t vary inside 
the mesh and may differ from mesh to mesh as in the one-dimension case such 
that [6] 
Σg(x, y) = Σi,j 
g , x ∈ |
xi , xi+1
|
, y ∈ |
y j , y j+1
|
Dg(x, y) = Di ,j 
g , x ∈ |
xi , xi+1
|
, y ∈ |
y j , y j+1
|
The flux is defined across the mesh boundaries 
φg(x, y) ≈ φi,j 
g , x ∈ |
x0 
i−1, x0 
i
|
, y ∈
|
y0 
j−1, y0 
j
|
Fig. 2.9 Mesh spacing in Cartesian geometry 2.4 Finite Difference Formulation for the Multi-group Two-Dimensional (x − y) … 47 
The current is defined at the middle of the mesh such that the flux derivative is 
given by 
∂
∂x 
φg(x, y)
|
|
|
|
x0 
i 
≈ φi+1,j 
g − φi,j 
g 
hi 
, y ∈
|
y0 
j−1, y0 
j
|
(2.18) 
∂
∂ y 
φg(x, y)
|
|
|
|
y0 
j 
≈ φi,j+1 
g − φi ,j 
g 
h j 
, x ∈ |
x0 
i−1, x0 
i
|
i = 1, I and j = 1,J (2.19) 
We begin by integrating Eq. 2.16 between mesh centers as shown in Fig. 2.9 to 
cover the shaded rectangle ∫
x0 
i 
x0 
i−1 
dx ∫
y0 
j 
y0 
j−1 
dy. 
1st The leakage term: 
−
y0 
{
j
y0 
j−1 
dy 
x0 
{ i
x0 
i−1 
dx 
∂
∂x Dg(x, y)
∂
∂x 
φg(x, y)
= −
y0 
{
j
y0 
j−1 
dy|
Dg
(
x0 
i , y
) ∂
∂x 
φg(x, y)
|
|
|
|
x0 
i 
− Dg
(
x0 
i−1, y
) ∂
∂x 
φg(x, y)
|
|
|
|
x0 
i−1
|
= −|
Di ,j−1 
g 
h j−1 
2 + Di ,j 
g 
h j 
2
|
φi+1,j 
g − φi ,j 
g 
hi 
+
|
Di−1,j−1 
g 
h j−1 
2 + Di−1,j 
g 
h j 
2
|
φi ,j 
g − φi−1,j 
g 
hi−1 
−
x0 
{ i
x0 
i−1 
dx 
y0 
{
j
y0 
j−1 
dy 
∂
∂ y 
Dg(x, y)
∂
∂ y 
φg(x, y)
= −
x0 
{ i
x0 
i−1 
dx|
Dg
(
x, y0 
j
) ∂
∂x 
φg(x, y)
|
|
|
|
y0 
j 
− Dg
(
x, y0 
j−1
) ∂
∂x 
φg(x, y)
|
|
|
|
y0 
j−1
|
= −|
Di−1,j 
g 
hi−1 
2 + Di ,j 
g 
hi 
2
|
φi,j+1 
g − φi,j 
g 
h j 
+
|
Di−1,j−1 
g 
hi−1 
2 + Di,j−1 
g 
hi 
2
|
φi,j 
g − φi,j−1 
g 
h j−148 2 Neutron Diffusion—The Finite Difference Solution …
2nd The removal term: 
x0 
{ i
x0 
i−1 
dx 
y0 
{
j
y0 
j−1 
dyΣRg(x, y)φg(x, y) = φi ,j 
g 
y0 
{
j
y0 
j−1 
dy 
x0 
{ i
x0 
i−1 
dx|
ΣRg(x, y)
|
= φi,j 
g 
⎡
⎢
⎢
⎣
{xi
x0 
i−1 
dx 
y 
{
j
y0 
j−1 
dy|
ΣRg(x, y)
|
+
x0 
{ i
xi 
dx 
y 
{
j
y0 
j−1 
dy|
ΣRg(x, y)
|
+
{xi
x0 
i−1 
dx 
y0 
{
j
y j 
dy|
ΣRg(x, y)
|
+
x0 
{ i
xi 
dx 
y0 
{
j
y j 
dy|
ΣRg(x, y)
|
⎤
⎥
⎥
⎦
= φi,j 
g
|
Σi−1,j−1 
Rg 
hi−1 
2 
h j−1 
2 + Σi,j−1 
Rg 
hi 
2 
h j−1 
2 + Σi−1,j 
Rg 
hi−1 
2 
h j 
2 + Σi,j 
Rg 
hi 
2 
h j 
2
|
3rd The scattering term 
x0 
{ i
x0 
i−1 
dx 
y0 
{
j
y0 
j−1 
dy E
g−1
g'
=1
Eg'
g(x, y)φg'(x, y)
= E
g−1
g'
=1 
φi,j 
g'
y0 
{
j
y0 
j−1 
dy 
x0 
{ i
x0 
i−1 
dx|
Esg'
g(x, y)
|
= E
g−1
g'
=1 
φi,j 
g'
⎡
⎢
⎣
Ei−1,j−1 
sg'
g 
hi−1 
2 
h j−1 
2 + Ei ,j−1 
sg'
g 
hi 
2 
h j−1 
2 
+Ei−1,j 
sg'
g 
hi−1 
2 
h j 
2 + Ei ,j 
sg'
g 
hi 
2 
h j 
2 
⎤
⎥
⎦
4th: The fission term is likewise:
χg 
λ
x0 
i 
∫
x0 
i−1 
dx 
y0 
j 
∫
y0 
j−1 
dy E
G
g'
=1 
νg'Σ f g'(x, y)φg'(x, y)
= χg 
λ
E
G
g'
=1 
φi ,j 
g'
y0 
j 
∫
y0 
j−1 
dy 
x0 
i 
∫
x0 
i−1 
dx|
νg'Σ f g'(x, y)
|
= χg 
λ
E
G
g'
=1 
φi ,j 
g'
|
νg'Σi−1,j−1 
f g'
hi−1 
2 
h j−1 
2 + νg'Σi ,j−1 
f g'
hi 
2 
h j−1 
22.4 Finite Difference Formulation for the Multi-group Two-Dimensional (x − y) … 49
+ νg'Σi−1,j 
f g'
hi−1 
2 
h j 
2 + νg'Σi ,j 
f g'
hi 
2 
h j 
2
|
Collecting terms, we obtain 
−
|
Di ,j−1 
g 
h j−1 
2 + Di,j 
g 
h j 
2
|
φi+1,j 
g − φi ,j 
g 
hi 
+
|
Di−1,j−1 
g 
h j−1 
2 + Di−1,j 
g 
h j 
2
|
φi ,j 
g − φi−1,j 
g 
hi−1 
−
|
Di−1,j 
g 
hi−1 
2 + Di,j 
g 
hi 
2
|
φi ,j+1 
g − φi,j 
g 
h j 
+
|
Di−1,j−1 
g 
hi−1 
2 + Di ,j−1 
g 
hi 
2
|
φi ,j 
g − φi ,j−1 
g 
h j−1 
= E
g−1
g'
=1 
φi,j 
g'
|
Σi−1,j−1 
g'
g 
hi−1 
2 
h j−1 
2 + Σi,j−1 
g'
g 
hi 
2 
h j−1 
2 + Σi−1,j 
g'
g 
hi−1 
2 
h j 
2 + Σi ,j 
g'
g 
hi 
2 
h j 
2
|
+ χg 
λ
E
G
g'
=1 
φi ,j 
g'
|
νg'Σi−1,j−1 
f g'
hi−1 
2 
h j−1 
2 + νg'Σi ,j−1 
f g'
hi 
2 
h j−1 
2 
+ νg'Σi−1,j 
f g'
hi−1 
2 
h j 
2 + νg'Σi ,j 
f g'
hi 
2 
h j 
2
|
, g1, 2, 3,..., G (2.20) 
Rearranging the coefficients in Eq. 2.10, we get
{|Di−1,j−1 hi−1 
2h j−1 
+ Di,j−1 hi 
2h j−1
|
+
|
Di−1,j hi−1 
2h j 
+ Di ,j hi 
2h j
|
+
|
Di−1,j−1 h j−1 
2hi−1 
+ Di−1,j h j 
2hi−1
|
+
|
Di,j−1 h j−1 
2hi 
+ Di ,j h j 
2hi
|}φi ,j 
+
{
Σi−1,j−1 a 
hi−1 
2 
h j−1 
2 + Σi ,j−1 a 
hi 
2 
h j−1 
2 + Σi−1,j a 
hi−1 
2 
h j 
2 + Σi ,j a 
hi 
2 
h j 
2
}
φi,j 
−
|
Di−1,j−1 hi−1 
2h j−1 
+ Di,j−1 hi 
2h j−1
|
φi,j−1 −
|
Di−1,j hi−1 
2h j 
+ Di ,j hi 
2h j
|
φi ,j+1 
−
|
Di−1,j−1 h j−1 
2hi−1 
+ Di−1,j h j 
2hi−1
|
φi−1,j 
−
|
Di ,j−1 h j−1 
2hi 
+ Di,j h j 
2hi
|
φi+1,j = 1 
λ
Si,j (2.21) 
where 
Si,j = φi ,j
|
νΣi−1,j−1 
f 
hi−1 
2 
h j−1 
2 + νΣi,j−1 
f 
hi 
2 
h j−1 
250 2 Neutron Diffusion—The Finite Difference Solution …
+ νΣi−1,j 
f 
hi−1 
2 
h j 
2 + νΣi ,j 
f 
hi 
2 
h j 
2
|
Redefining the coefficients, Eq. 2.20 becomes
|
Σi,j a + Di,j
|
φi ,j +
|
−Di ,j−1
|
φi ,j−1 +
|
−Di ,j+1
|
φi ,j+1 +
|
−Di−1,j
|
φi−1,j 
+
|
−Di+1,j
|
φi+1,j = 1 
λ
|
νΣi,j 
f
|
φi,j = 1 
λ
Si ,j (2.22) 
The coefficients have been given the indices of the flux. Equation 2.21 in a matrix 
form: 
A o = 1 
λ
S (2.23) 
Equation 2.22 relates φi,j 
g to neighboring fluxes φi+1,j 
g , φi,j+1 
g , φi−1,j 
g , φi ,j−1 
g 
which is known as the five-point finite difference scheme. Using the appropriate 
boundary conditions as in the case of a one-dimensional geometry, the number 
of internal points will be equal to the number of unknown fluxes. The number of 
internal points in the x −direction is I and that in the y-direction is J so the number 
of difference equations will be GIJ with GIJ unknowns where G is the number of 
energy groups. There will be a solution only if the determinant of the coefficients 
GIJ × GIJ of the fluxes φi,j 
g is zero. The value of λ which causes the determinant 
to be zero and the fluxes to be positive in all of the internal points and energy 
groups are equal to the effective multiplication factor kef f of the reactor. There 
is always a unique solution to this large problem, especially when the number of 
groups and mesh points is large. 
Assuming only one energy group, then the matrix A which contains leakage and 
removal terms will be a five-diagonal matrix, which corresponds to the five-point 
finite difference scheme (Fig. 2.10a). Figure 2.10b shows a tri-diagonal matrix A 
for the one-dimensional case.
In the case of two-group diffusion, one diagonal is added to the matrix from 
below representing down-scattering terms (Fig. 2.10c). More diagonals are added 
corresponding to half the number of energy groups (G/2 diagonals for G groups) 
as shown in Fig. 2.10d. 
Example 1 Construct the matrix for the one-group diffusion equation in x − y 
geometry for the 4 × 3 mesh structure shown in Fig. 2.11 with I = 5 and J = 4. 
The double index needs to be converted to a single index using the formulae k =
i +(j − 1)(I − 1)such that the fluxes in Eq. 2.21 for the internal points and boundary 
points are denoted as shown in Table 2.1. For example, for the internal point (2, 2) 
the index is k = 2 + 1(3) = 5, hence φ2,2 → φ5.2.4 Finite Difference Formulation for the Multi-group Two-Dimensional (x − y) … 51 
Fig. 2.10 a A five-diagonal 
matrix. b A tri-diagonal 
matrix.c A five-diagonal 
matrix + a diagonal from 
below.d A five-diagonal 
matrix + G/2 diagonals from 
below
0 
(a) (b) 
(c) (d) 
0 
0 
0 
0 0
0 
Fig. 2.11 A (4 × 3) mesh 
spacing
Therefore, Eq. 2.21 is written for each point in Fig. 2.9 as follows:
|
Σ2,1 a + D2,1
|
φ2 +
|
−D2,2
|
φ5 +
|
−D1,1
|
φ1 +
|
−D3,1
|
φ3 = S2
|
Σ3,1 a + D3,1
|
φ3 +
|
−D3,2
|
φ6 +
|
−D2,1
|
φ2 +
|
−D4,1
|
φ4 = S3
|
Σ4,1 a + D4,1
|
φ4 +
|
−D4,2
|
φ7 +
|
−D3,1
|
φ3 +
|
−D5,1
|
φ5 = S4
|
Σ1,2 a + D1,2
|
φ4 +
|
−D1,1
|
φ1 +
|
−D1,3
|
φ7 +
|
−D3,1
|
φ5 = S452 2 Neutron Diffusion—The Finite Difference Solution …
Table 2.1 Conversion of double points to single index points 
i j k φi,j = φk Si ,j = Sk 
Boundary points 2 1 2 φ2,1 = φ2 S2,1 = S2 
3 1 3 φ3,1 = φ3 S3,1 = S3 
4 1 4 φ4,1 = φ4 S4,1 = S4 
1 2 4 φ1,2 = φ4 S1,2 = S4 
1 3 7 φ1,3 = φ7 S13 = S7 
Internal points 2 2 5 φ2,2 = φ5 S2,2 = S5 
3 2 6 φ3,2 = φ6 S3,2 = S6 
4 2 7 φ4,2 = φ7 S4,2 = S7 
2 3 8 φ2,3 = φ8 S2,3 = S8 
3 3 9 φ3,3 = φ9 S3,3 = S9 
4 3 10 φ4,3 = φ10 S4,3 = S10 
Boundary points 2 4 11 ara> φ2,4 = φ11 S2,4 = S11 
3 4 12 φ3,4 = φ12 S3,4 = S12 
4 4 13 φ4,4 = φ13 S4,4 = S13 
5 2 8 φ5,2 = φ8 S5,2 = S8 
5 3 11 φ5,3 = φ11 S5,3 = S11
|
Σ1,3 a + D1,3
|
φ7 +
|
−D1,2
|
φ4 +
|
−D1,4
|
φ10 +
|
−D2,3
|
φ8 = S7
|
Σ2,4 a + D2,4
|
φ11 +
|
−D2,5
|
φ14 +
|
−D1,4
|
φ10 +
|
−D2,3
|
φ8 
+
|
−D3,4
|
φ12 = S11
|
Σ3,4 a + D3,4
|
φ12 +
|
−D2,4
|
φ11 +
|
−D4,4
|
φ13 +
|
−D3,3
|
φ9 
+
|
−D3,5
|
φ15 = S12
|
Σ4,4 a + D4,4
|
φ13 +
|
−D3,4
|
φ12 +
|
−D5,4
|
φ14 +
|
−D4,3
|
φ10 
+
|
−D4,5
|
φ16 = S13
|
Σ5,2 a + D5,2
|
φ8 +
|
−D4,2
|
φ7 +
|
−D6,2
|
φ9 +
|
−D5,1
|
φ5 
+
|
−D5,3
|
φ11 = S8
|
Σ5,3 a + D5,3
|
φ11 +
|
−D4,3
|
φ10 +
|
−D6,3
|
φ12 +
|
−D5,2
|
φ82.4 Finite Difference Formulation for the Multi-group Two-Dimensional (x − y) … 53
+
|
−D5,4
|
φ14 = S11
|
Σ2,2 a + D2,2
|
φ5 +
|
−D2,1
|
φ2 +
|
−D2,3
|
φ8 +
|
−D1,2
|
φ4 
+
|
−D3,2
|
φ6 = S5
|
Σ3,2 a + D3,2
|
φ6 +
|
−D3,1
|
φ3 +
|
−D3,3
|
φ9 +
|
−D2,2
|
φ5 
+
|
−D4,2
|
φ7 = S6
|
Σ4,2 a + D4,2
|
φ7 +
|
−D4,1
|
φ4 +
|
−D4,3
|
φ10 +
|
−D3,2
|
φ6 
+
|
−D5,2
|
φ8 = S7
|
Σ2,3 a + D2,3
|
φ8 +
|
−D2,2
|
φ5 +
|
−D1,3
|
φ7 +
|
−D3,3
|
φ9 
+
|
−D2,4
|
φ11 = S8
|
Σ3,3 a + D3,3
|
φ9 +
|
−D3,2
|
φ6 +
|
−D2,3
|
φ8 
+
|
−D4,3
|
φ10 +
|
−D3,4
|
φ12 = S9
|
Σ4,3 a + D4,3
|
φ10 +
|
−D4,2
|
φ7 +
|
−D4,4
|
φ13 +
|
−D5,3
|
φ11 
+
|
−D3,3
|
φ9 = S10 
The notation |
Σi ,j a + Di,j
|
= Di,j a is used to reduce the matrix size for the 
above equations. The fluxes in the boundary points should be known using bound￾ary or reflective conditions depending on the location of the I × J mesh structure 
whether they are in a full core, a quarter core, or else. The solution algorithm is 
similar to the one-dimensional case.54 2 Neutron Diffusion—The Finite Difference Solution …
Fig. 2.12 A (3 × 2) mesh 
spacing 
The matrix form is 
Example 2 Write Eq. 2.21 in a two-group form and then construct the matrix for 
the 3 × 2 mesh structure shown in Fig. 2.12 with I = 4 and J = 3. 
Di,j 
Rg φi ,j 
g +
|
−Di ,j−1 
g
|
φi ,j 
g +
|
−Di ,j+1 
g
|
φi ,j+1 
g +
|
−Di−1,j 
g
|
φi−1,j 
g 
+
|
−Di+1,j 
g
|
φi+1,j 
g +
|
−Σi ,j 
sg−1→gφi,j 
g−1
|
= 1 
λ
Si,j 
g .........(23)
where Di ,j 
Rg =
|
Σi,j 
Rg + Di,j
|
and Σi ,j 
Rg = Σi ,j 
tg − Σi ,j sgg by definition and 
Si ,j 
g = χg E
G
g'
=1 
φi,j 
g'
|
νg'Σi−1,j−1 
f g'
hi−1 
2 
h j−1 
2 + νg'Σi ,j−1 
f g'
hi 
2 
h j−1 
2 
+ νg'Σi−1,j 
f g'
hi−1 
2 
h j 
2 + νg'Σi,j 
f g'
hi 
2 
h j 
2
|2.4 Finite Difference Formulation for the Multi-group Two-Dimensional (x − y) … 55 
Assumptions for the two-group theory: 
(i) Only directly coupled groups are considered. 
(ii) Up-scattering is ignored, hence only down-scattering into adjacent groups is 
allowed. 
(iii) Fission neutrons are born only in the fast group implying χ1 = 1 and χ2 = 0. 
(iv) The removal cross section as known from before. 
Σi,j 
R1 = Σi,j 
t1 − Σi ,j 
s11 = Σi,j 
a1 + Σi ,j 
s1 − Σi,j 
s11 
= Σi,j 
a1 + Σi ,j 
s11 + Σi,j 
s12 − Σi ,j 
s11 = Σi ,j 
a1 + Σi ,j 
s12 
Σi,j 
R2 = Σi ,j 
t2 − Σi,j 
s22 = Σi ,j 
a2 + Σi,j 
s22 + Σi ,j 
s21 − Σi ,j 
s22 = Σi,j 
a2 and Σi,j 
s21 = 0 
where no up-scattering is assumed. 
Considering fast and thermal energy groups, then Eq. 2.23 becomes 
g = 1 : Di,j 
R1φi ,j 
1 +
|
−Di ,j−1 
1
|
φi ,j 
1 +
|
−Di,j+1 
1
|
φi,j+1 
1 +
|
−Di−1,j 
1
|
φi−1,j 
1 
+
|
−Di+1,j 
1
|
φi+1,j 
1 = 1 
k 
Si,j 
1 
g = 2 : Di,j 
a2 φi ,j 
2 +
|
−Di,j−1 
2
|
φi ,j 
2 +
|
−Di ,j+1 
2
|
φi ,j+1 
2 +
|
−Di−1,j 
2
|
φi−1,j 
2 
+
|
−Di+1,j 
2
|
φi+1,j 
2 =
|
Σi ,j 
s1→2
|
φi ,j 
1 
where the source of neutrons in the thermal group is the slowing down source 
from fast group and the only neutron source in the fast group is the fission source. 
The matrix equation for fast group is 
(2.24)56 2 Neutron Diffusion—The Finite Difference Solution …
And the matrix equation for the thermal group is 
(2.25) 
2.4.1 Method of Solution 
The methodology of solution is quite similar to that of the two-group one￾dimensional case in Sect. 2.3 [4, 7]. 
Step 1: Make an initial guess of the fast group source vector Si,j(0)
1 , and λ(0)
, 
where (0) indicates the initial guess for commencing the iteration procedure. 
Using this guess for the source Eq. 2.24 is solved for the first iteration fast flux 
ϕ(1)
1 : 
A1 φ(1)
1 = 1 
λ(0) S(0)
1 
Substituting φ(1)
1 into Eq. 2.25 and solving for the thermal flux φ(1)
2 
A2 φ(1)
2 = E
1→2 
φ(1)
12.4 Finite Difference Formulation for the Multi-group Two-Dimensional (x − y) … 57 
Step 2: Calculate a new source value from Eq. 2.21 S(1)
1
|
v
El,j 
f
|
φ(1)
1 using φ(1)
1 
calculated in Step 1. Substituting back into 24 we obtain a new φ(2)
1 and λ(1)
. 
We continue the iterative scheme until the nth iteration where a criterion for 
accuracy is satisfied such as the percentage change in the eigenvalue between 
two successive iterations is less than a small preset acceptable convergence 
limit, e.g.
|
|
|
|
λ(n+1) − λ(n)
λ(n+1)
|
|
|
|
< eλ
A pointwise criterion can be applied as well,
|
|
|
|
|
S(n+1)
1i ,j − S(n)
1i,j 
S(n+1)
1i,j
|
|
|
|
|
< es 
The same procedure applies to obtain the fluxes in higher energy groups. 
Equations 2.24 and 2.25 can be solved using different methods which can be 
found in the literature of numerical methods starting from forward and backward 
substitutions in the Gaussian elimination method, the Jacobi method, Gauss–Seidel 
of the L-U factorization of matrix A, convergence acceleration techniques, etc. 
Several codes have been written to solve the neutron diffusion equation for 
a variety of energy groups and dimensions reading directly the collapsed cross 
section from spectrum codes and doing burn-up calculation as well [8, 9]. A widely 
used code by students is 2DB. It can do two-group or four-group two-dimensional 
core (Cartesian and cylindrical) along with burn-up and adjoint calculations. The 
elements of the matrix A and others are filled by the nuclear properties and dimen￾sions which are the characteristics of the reactor core. However, it is not a simple 
task because it has to undergo a huge process of homogenization and elementary 
cross-sectional data averaging using the spectra of the fundamental units of fuel 
cells. The spectral codes such as LEOPARD are assigned such a task. 
Exercises 
1. Choose a typical PWR where the raw data and geometry for the fuel cells, 
assemblies, and core are known. 
(a) Run LEOPARD code or any other spectrum code to obtain the cross sec￾tions for the fuel cell types and reflector. Ignore accounting for poison and 
non-lattice materials. 
(b) Try to link the cross sections from LEOPARD [10] to 2DB [11] and hence 
run 2DB or any other two-dimensional multi-group codes for the flux. You 
may as well link the available spectrum code to a space-dependent code of 
your choice.58 2 Neutron Diffusion—The Finite Difference Solution …
2. Write down the matrices of a three-group 2D mesh structure of Fig. 2.9. 
3. Assume a simple case of homogenous non-multiplying slab surrounded by 
vacuum with a uniformly distributed neutron source. 
(a) Rederive the difference equations for this case assuming one-group diffu￾sion. 
(b) Using the Taylor expansion, 
φi+1 = φ(xi+1) = φi + Δ
dφ
dx
|
|
|
|
i 
+
Δ2 
2 
d2φ
dx2
|
|
|
|
i 
+···
φi−1 = φ(xi−1) = φi − Δ
dφ
dx
|
|
|
|
i 
+
Δ2 
2 
d2φ
dx2
|
|
|
|
i 
+···
where Δ is the mesh spacing. Add the two expansions to obtain 
d2φ
dx2
|
|
|
|
i 
∼= φi+1 − 2φi + φi−1 
Δ2 +···
Substituting in the diffusion equation to obtain the difference form. Compare 
with the result in (a). 
4. Run the ONED code or any other one-dimensional diffusion codes for the bare 
slab core with the following nuclear cross sections: 
D Ea E f 
0.9 0.066 0.07 
By making small-sized meshes iterate on the critical core size. 
All the information you need for ONED (1D) [2, 12] code is in Appendices D 
and E. 
5. Consider a bare slab core and the cross sections in Problem 4. Write a com￾puter program which solves the one-group neutron diffusion equation. Draw 
the neutron flux and power profiles. 
(i) Compare the criticality constant and the flux and power profiles with the 
ONED results in part (a). 
(ii) Obtain an analytical solution for this simple case and compare the 
multiplication factor and the flux.References 59
References 
1. R.M. Kuridan, Nuclear reactor theory. National Bureau of Research and Development, Tripoli, 
Libya, (2004). (in Arabic) 
2. J.C. Lee, The ONED code, lecture notes, on reactor theory. University of Michigan, Nuclear 
Engineering, 1975–1976 
3. J.C. Lee, Nuclear reactor physics and engineering (Wiley, NJ, 2020) 
4. B. Quintero-Leyva, Numerical solution of the multi-group integro-differential equation of the 
neutron diffusion kinetics in 2D-Cartesian geometry. Ann. Nucl. Energy. 48, (2012) 
5. J. Duderstadt, L. Hamilton, Nuclear reactor analysis (Wiley, New York, 1976) 
6. A. Henry, Nuclear reactor analysis (MIT Press, Mass, 1982) 
7. W. Cheney., D. Kincaid, Numerical mathematics and computing, 6th edn (Thomson 
Brooks/Cole, 2008) 
8. A. Hébert, DRAGON5: Designing computational schemes dedicated to fission nuclear reactors 
for space. in Proceedings of nuclear and emerging technologies for space. (Albuquerque, NM, 
2013) 
9. A. Hébert, TRIVAC: A modular diffusion code for fuel management, (1987) 
10. R.F. Barry, Leopard: A spectrum dependent non-spatial depletion code. WCAP-3269–26, 
(1963) 
11. A 2DB-UM, A two-dimensional neutron diffusion burn up code. University of Michigan, 
Nuclear Engineering version 
12. R.M. Kuridan, ONED-LOPARD link for depletion calculation (1DB code). Master thesis, 
University of Michigan, Nuclear Engineering, unpublished, 19803 Spherical Harmonics—The PN 
Method 
The PN method is based on the expansion of the angular distribution of the neu￾tron flux (ϕ), i.e. the dependence on the direction Ω which is a function of the 
angles θ , ψ in a complete set of orthogonal functions, namely, the Legendre poly￾nomials. The angular flux and the transfer cross section are weakly dependent on 
the azimuthal angle ψ. Therefore, it is neglected from the analysis throughout the 
chapter. Actually, the Legendre polynomials are considered the best of all polys. 
Such that the difference between the value of the function before and after the 
expansion is small as compared to other polys. The resulting form of the transport 
equation is made practical for a solution by truncating the expansion to a practical 
number of terms. We will consider both the plane and curved geometries sepa￾rately. In Sect. 3.1, the PN equation for plane geometry is derived. From which 
the famous P1 equations are obtained. Followed by the derivation the PN equation 
in spherical geometry in Sect. 3.2. Marshak and Mark boundary conditions and 
interface conditions are presented in Sect. 3.3 for a free surface and plane and 
curved interfaces. Due to discontinuity the concept of double PN , the so-called 
Yvon’s method is introduced. In Sect. 3.4, the finite difference scheme is used for 
the solution of P1 equations in plane and curved geometries. Finally, in Sect. 3.5, 
the elastic transfer cross section is considered since its dependence on angle and 
energy requires a special treatment. 
3.1 Derivation of the PN Equations in Plane Geometry 
The general form of expansion is in the components θ , ψ of the direction Ω in 
what is called spherical harmonics [1, 2] 
Y m 
n
(
Ω)
= Y m 
n (θ , ψ) = Y m 
n (μ, ψ) =
{(2n + 1)(n − m)!
(n + m)!
}1/2 
Pm 
n (μ)exp i mϕ
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2023 
R. M. Kuridan, Neutron Transport, Graduate Texts in Physics, 
https://doi.org/10.1007/978-3-031-26932-5_3 
6162 3 Spherical Harmonics—The PN Method 
where n is real, positive, or zero and −n ≤ m ≤ n and Pm 
n (μ) are the associated 
Legendre polynomials. The flux expansion is as follows: 
ϕ
(
r, E, Ω)
= E∞
n=0 
En
m=−n 
φ(r , E)Y m 
n
(
Ω)
We will consider the one-speed transport equation in one dimension in order 
to make the problem simpler (look up Chap. 1). The energy dependence is not 
affected by the Legendre expansion. 
μ
∂
∂z 
ϕ(z, μ) + Σt ϕ(z, μ)
=
{
2π
0 
dψ
{
+1
−1 
dμ'
Σs
(
Ω' → Ω)
ϕ
(
z, μ'
)
+ S(z, μ) (3.1) 
where φ(z, μ) = { 2π
0 dψφ(z, μ, ψ) assuming no dependence on the azimuthal 
angle. 
The expansions are defined as 
ϕ(z, μ) = E∞
n=0 
(2n + 1)
4π
Pn(μ)φn(z) (3.2) 
S(z, μ) = E∞
n=0 
(2n + 1)
4π
Pn(μ)Sn(z) (3.3)
Es
(
Ω' → Ω)
= Es
(
Ω'
.Ω)
= Es
(
μ'
.μ)
= Es (μ0)
= E∞
n=0 
(2n + 1)
4π
Esn Pn(μ0)
The spherical harmonics satisfy the addition theorem let two vectors on the unit 
sphere having coordinate angles as shown in Fig. 3.1 (such vectors could be the 
neutron direction before and after scattering (Ω'
, Ω) then, 
cosθ0 = cosθ cosθ' + sinθ sinθ' cos(
ϕ − ϕ'
)
The addition theorem states 
Pn(cosθ0) = Pn(cosθ)Pn
(
cosθ'
)
or 
Pn(μ0) = Pn(μ)Pn
(
μ'
)
+ ···3.1 Derivation of the PN Equations in Plane Geometry 63 
′
′
′
Fig. 3.1 Coordinates for the addition theorem
where μ0 = cosθ0. Substituting the first term into the scattering x-section above, 
we get
Es
(
Ω' → Ω)
= Es (μ0) = E∞
n=0 
(2n + 1)
4π
Esn Pn(μ)Pn
(
μ'
) (3.4) 
Substituting 2, 3, and 4 into the transport Eq. (3.1) 
μ
∂
∂z 
E∞
n=0 
(2n + 1)
4π
Pn(μ)φn(z) + Σt E∞
n=0 
(2n + 1)
4π
Pn(μ)φn(z)
= 2π
{
+1
−1 
dμ'
E∞
n=0 
(2n + 1)
4π
Esn Pn(μ)Pn
(
μ'
)
ϕ
(
z, μ'
)
+E∞
n=0 
(2n + 1)
4π
Pn(μ)Sn(z)
First term: 
Substituting the recursion relation for the Legendre Polynomials (appendix F) into 
the first term in order to get rid of μ64 3 Spherical Harmonics—The PN Method 
μPn(μ) = n + 1 
2n + 1 
Pn+1(μ) + n 
2n + 1 
Pn−1(μ)
E∞
n=0 
(2n + 1)
4π
[μPn(μ)] 
dφn 
dz 
= 1 
4π
E∞
n=0
|
(n + 1)Pn+1(μ) + n Pn−1(μ)
|dφn 
dz 
The first term on the right side will not be affected if the series starts at n = 1. 
This will require a modification of the derivative 
1 
4π
E∞
n=0 
(n + 1)Pn+1(μ)
dφn 
dz = 1 
4π
E∞
n=1 
[(n)Pn(μ)] 
dφn−1 
dz 
= 1 
4π
E∞
n=0 
[(n)Pn(μ)] 
dφn−1 
dz 
where we have returned the beginning to n = 0 since the first term in the expansion 
is zero anyway. The second term on the right side with similar steps is 
1 
4π
E∞
n=0
|
n Pn−1(μ)
|dφn 
dz = 1 
4π
E∞
n=−1 
[(n + 1)Pn(μ)] 
dφn+1 
dz 
= 1 
4π
E∞
n=0 
[(n + 1)Pn(μ)] 
dφn+1 
dz 
Adding terms, we get the first term of the transport equation 
1 
4π
E∞
n=0
|
(n)Pn(μ)
dφn−1 
dz + (n + 1)Pn(μ)
dφn+1 
dz |
Second term: As it is. 
Third term: 
2π
{
1
−1 
dμ'
|
E∞
n=0 
(2n + 1)
4π
Σsn Pn
(
μ'
)
Pn(μ)
|
ϕ
(
z, μ'
)
=
2π
|
E∞
n=0 
(2n + 1)
4π
Σsn Pn(μ)
| {
1
−1 
dμ'
Pn
(
μ'
)
ϕ
(
z, μ'
)3.1 Derivation of the PN Equations in Plane Geometry 65 
Substituting for the angular flux from 2, we get 
2π
|
E∞
n=0 
(2n + 1)
4π
Σsn Pn(μ)
| {
1
−1 
dμ'
Pn
(
μ'
)E∞
n=0 
(2n + 1)
4π
Pn
(
μ'
)
ϕn(z)
In the integrand, Pn
(
μ'
)
multiplies all series terms and only one term is with 
the same order (the nth term) such that 
{
1
−1 
dμ'
| 1 
4π
Pn
(
μ'
)
P0
(
μ'
)
φ0(z) + ··· + (2n + 1)
4π
Pn
(
μ'
)
Pn
(
μ'
)
φn(z) + ···|
In this case, we employ the orthogonality property as 
{
1
−1 
dμ'
Pm (μ)Pn(μ) = 2δmn 
2n + 1 
, δmn =
{
0 m /= n 
1 m = n 
δmn is known as the Kronecker delta. Accordingly, all terms in the integrand must 
vanish except the nth term 
{
1
−1 
dμ'(2n + 1)
4π
Pn
(
μ'
)
Pn
(
μ'
)
φn(z) = 2 
4π
φn(z)
The third term becomes 
E∞
n=0 
(2n + 1)
4π
Σsn Pn(μ)φn(z)
Fouth term: As it is. 
Collecting terms, the transport equation becomes 
1 
4π
E∞
n=0
|
(n)Pn(μ) dφn−1 
dz + (n + 1)Pn(μ) dφn+1 
dz |
+Σt E∞
n=0 
(2n+1)
4π Pn(μ)φn(z)
= E∞
n=0 
(2n+1)
4π Σsn Pn(μ)φn(z) + E∞
n=0 
(2n+1)
4π Pn(μ)Sn(z)66 3 Spherical Harmonics—The PN Method 
Multiplying the equation by 4π Pn(μ), integrating over μ, and using the 
orthogonality, for example, 
4π
{
1
−1 
dμPn(μ)
1 
4π
E∞
n=0 
n Pn(μ)
dφn−1 
dz = 2n 
2n + 1 
dφn−1 
dz 
The neutron transport equation NTE becomes 
n 
2n + 1 
dφn−1 
dz + n + 1 
2n + 1 
dφn+1 
dz + (Σt − Σsn)φn(z)
= Sn(z); n = 0, 1, 2, ··· , N (3.5) 
This is the PN equation. 
Multiplying Eq. (3.2) by 4π Pn(μ), integrating over μ, and using the orthogo￾nality, we will be able to define φn(z)
4π
{
+1
−1 
dμPn(μ)ϕ(z, μ)
= 4π
{
+1
−1 
dμPn(μ)
E∞
n=0 
(2n + 1)
4π
Pn(μ)φn(z)
= 2φn(z)
or φn(z) = 2π
{ +1 
−1dμPn(μ)ϕ(z, μ)
3.1.1 The PN Approximation 
There are N + 1 equations making up Eq. (3.5) (n = 0, 1, 2,..., N ), however, it 
contains N + 2 coefficients φn(z) starting from φ0(z) knowing that φ−1(z) = 0 
and therefore the number of unknowns exceeds the number of equations by one 
and they can be made equal using 
dφN +1(z)
dz = 0 (3.6) 
In other words, 
dφn 
dz = 0 ; n > N 
And, this is called the PN approximation.3.1 Derivation of the PN Equations in Plane Geometry 67 
In the same fashion, we can write 
φN+1(z) = 2π
{
+1
−1 
dμPN +1(μ)ϕ(z, μ)
PN +1(μ) oscillates fast at large values of N (see the figure in the appendix of 
Fig. 6.2), where it changes sign N + 1 times in the interval −1 ≤ μ ≤ 1; hence, 
we can say that φN +1(z) is so small and the PN approximation becomes reasonably 
accurate. We can define Sn(z) and Σsnusing orthogonality and Eqs. (3.3) and (3.4) 
Sn(z) = 2π
{ +1 
−1 
dμPn(μ)S(z, μ)
Σsn(z) = 2π
{
+1
−1 
dμΣs (μ0)Pn(μ0)
Example Derive the P1 equations. 
Substituting n = 0, 1 in Eq. (3.5), we get 
dφ1 
dz + (Σt − Σs0)φ0(z) = S0(z)
1 
3 
dφ0 
dz +
2 
3 
dφ2 
dz + (Σt − Σs1)φ1(z) = S1(z)
According to the PN approximation Eq. (3.6): we require dφ2(z)
dz = 0 because 2 
is greater than the P1 order of (1). The P1 equations are 
dφ1 
dz + (Σt − Σs0)φ0(z) = S0(z)
1 
3 
dφ0 
dz + (Σt − Σs1)φ1(z) = S1(z) (3.7) 
where 
φ0(z) = 2π
{
+1
−1 
dμP0(μ)ϕ(z, μ) = 2π
{
+1
−1 
dμϕ(z, μ) = φ(z)
S0(z) = 2π
{
+1
−1 
dμP0(μ)S(z, μ) = 2π
{
+1
−1 
dμS(z, μ) = S(z)68 3 Spherical Harmonics—The PN Method 
Σs0(z) = 2π
{
+1
−1 
dμΣs (μ0)P0(μ0) = 2π
{
+1
−1 
dμΣs (μ0) = Σs 
are the flux, source strength, and scattering x-section, respectively. The last 
equation can be explained as follows if we write: 
Σs (μ0) = ΣsR(μ0) = ΣsR
(
μ' · μ
)
where R
(
μ' · μ
)
is the probability that the neutron will scatter between the angles 
θ , θ' and normalized to 1 as 2π { +1 
−1 dμR
(
μ' · μ
)
= 1. 
Σs0(z) = 2π
+
{
1
−1 
dμΣs (μ0)P0(μ0) = 2π
+
{
1
−1 
dμΣsR
(
μ' · μ
)
P0(μ0)
= 2πΣs 
+
{
1
−1 
dμR
(
μ' · μ
)
[1] 
= Σs
|
2π
+
{
1
−1 
dμR
(
μ' · μ
)
|
= Σs[1] = Σs 
The other quantities in the P1 equations are 
φ1(z) = 2π
{
+1
−1 
dμP1(μ)ϕ(z, μ) = 2π
{
+1
−1 
dμμϕ(z, μ) = J (z)
S1(z) = 2π
{
+1
−1 
dμP1(μ)S(z, μ) = 2π
{
+1
−1 
dμμS(z, μ) = u(z)
Σs1(z) = 2π
{
+1
−1 
dμ0Σs (μ0)P1(μ0) = 2π
{
+1
−1 
dμ0μ0Σs (μ0)
= Σs 
⎡
⎣2π
{
+1
−1 
dμ0μ0R
(
μ' · μ
)
⎤
⎦ = μ0Σs 
The net current, (physically un-defined source), and the scattering x-section 
multiplied by the average cosine of the scattering angle, respectively, Σs1(z) can 
be understood if we define: 
μ0 = 2π
{ +1 
−1dμ0μ0R(μ0)
2π
{ +1 
−1dμ0R(μ0)3.1 Derivation of the PN Equations in Plane Geometry 69 
If the source is isotropic such that S(z, μ) = S(z)
2 , so by substitution into the 
equation for S1(z), we get 
S1(z) = 2π
{
+1
−1 
dμ μ
S(z)
2 = 2π
S(z)
2 {
+1
−1 
dμ μ = 0 
Question: Why not considering the flux to be isotropic? 
Answer: If so, there will be no need for the PN method. It is introduced to 
eliminate the direction variable. Rewriting the P1 equations, 
dJ 
dz + (Σt − Σs )φ(z) = S(z)
1 
3 
dφ
dz + (Σt − μ0Σs )J (z) = 0 (3.8) 
using Σt − Σs = Σa and Σt − μ0Σs = Σtr Eq. (3.8) becomes 
dJ 
dz + Σaφ(z) = S(z)
1 
3 
dφ
dz + Σtr J (z) = 0 (3.9) 
From the second equation, 
J (z) = − 1 
3Σtr 
dφ
dz 
Substituting in the first equation, we get 
d 
dz |
− 1 
3Σtr 
dφ
dz |
+ Σaφ(z) = S(z)
If the diffusion coefficient is defined as D = 1 
3Σtr = λtr 
3 ,we arrive at the 
diffusion equation: 
−D 
d2φ
dz2 + Σaφ(z) = S(z) (3.10) 
Note: The P1 Eq. (3.8) are reduced to the one-speed diffusion equation by the 
virtue of the assumption that the source is isotropic. 
Let us take a look at the flux expansion Eq. (3.2) when the P1 approximation 
is considered:
ϕ(z, μ) = E
1
n=0 
(2n + 1)
4π
Pn(μ)φn(z)70 3 Spherical Harmonics—The PN Method
= 1 
4π
P0(μ)φ0(z) +
3 
4π
P1(μ)φ1(z)
= 1 
4π
[φ(z) + 3μJ (z)] 
Recall the definition of the partial currents from Chap. 1 and substitute from 
the expansion 
J ±(z) = 2π
{
±1
0 
dμμϕ(z, μ) = 2π
{
±1
0 
dμμ
1 
4π
[φ(z) + 3μJ (z)] 
1 
2 {
±1
0 
dμμ[φ(z) + 3μJ (z)] = 1 
2 {
±1
0 
dμ
|
μφ(z) + 3μ2 J (z)
|
J ±(z) =
|
φ(z)
4 
±
J (z)
2
|
From which, the net current is J (z) = J +(z) − J −(z), and using the diffusion 
approximation, 
J (z) = −D dφ(z)
dz 
J ±(z) =
|
φ(z)
4 ∓ D 
2 
dφ(z)
dz | (3.11) 
3.2 Derivation of the PN Equations in Spherical Geometry 
Consider the transport equation in spherical geometry (problem 7 in Chap. 1). 
Derivation of the PN form follows a similar procedure as in the plane geometry. 
We start by the substitution of the expansions of the flux, and anisotropic scattering 
cross section in Legendre polynomials as we have done before. Notice that fission 
is isotropic by nature and hence the fission cross section is not a function of μ. 
The fission source in one-speed form is just [1, 3] 
S f
(
r , t
)
= νΣ f 
4π
{
4π
dΩ'
ϕ
(
r , Ω'
, t
)
And assuming symmetry in the azimuthal angle and steady state, then 
S f
(
r
)
= νΣ f 
2 {
+1
−1 
dμ'
ϕ
(
r , μ'
)3.2 Derivation of the PN Equations in Spherical Geometry 71 
Upon substitution of the above expansions, we get 
E∞
n=0 
(2n + 1)
4π
∂φn 
∂r μPn(μ) +E∞
n=0 
(2n + 1)
4π
φn(r )
r
(
1 − μ2)d Pn(μ)
dμ
+ Σt E∞
n=0 
(2n + 1)
4π
Pn(μ)φn(r )
= E∞
n=0 
(2n + 1)
4π
Esn Pn(μ)
{
+1
−1 
dμ'
Pn
(
μ'
)
ϕ
(
r, μ'
)
+
νΣ f 
2 {
+1
−1 
dμ'
E∞
n=0 
(2n + 1)
4π
φn(r)Pn
(
μ'
) (3.12) 
Consider the recursion relation: 
μPn(μ) = n + 1 
2n + 1 
Pn+1(μ) + n 
2n + 1 
Pn−1(μ)
and the recursion relation
(
1 − μ2) ∂ Pn(μ)
∂μ = n(n + 1)
(2n + 1)
[Pn−1(μ) − Pn+1(μ)]
Substituting the last two recursion relations in Eq. (3.12), 
+
E∞
n=0 
(2n + 1)
4π
φn(r )
r
|
n(n + 1)
(2n + 1)
|
Pn−1(μ) − Pn+1(μ)
|
|
E∞
n=0 
(2n + 1)
4π
∂φn 
∂r
| n + 1 
2n + 1 
Pn+1(μ) + n 
2n + 1 
Pn−1(μ)
|
+ Σt E∞
n=0 
(2n + 1)
4π
Pn(μ)φn(r )
= E∞
n=0 
(2n + 1)
4π
Σsn Pn(μ)φn(r)
+
νΣ f 
2 
E∞
n=0 
(2n + 1)
4π
φn(r )
{
+1
−1 
dμ'
Pn
(
μ'
)72 3 Spherical Harmonics—The PN Method 
Collecting similar terms 
1 
4π
E∞
n=0 
(n + 1)Pn+1(μ)
|
∂φn 
∂r − n 
φn(r )
r
|
+
1 
4π
E∞
n=0 
n Pn−1(μ)
|
∂φn 
∂r + (n + 1)
φn(r)
r
|
+ Σt 
1 
4π
E∞
n=0 
(2n + 1)Pn(μ)φn(r )
= 1 
4π
E∞
n=0 
(2n + 1)Σsn Pn(μ)φn(r)
+
1 
4π
νΣ f 
2 
E∞
n=0 
(2n + 1)φn(r)
{
+1
−1 
dμ'
Pn
(
μ'
)
We change the indexes of the polynomials Pn±1 to Pn and the rest of the indexes 
as well 
1 
4π
E∞
n=0 
n Pn(μ)
|
∂φn−1 
∂r − (n − 1)
φn−1(r )
r
|
+
1 
4π
E∞
n=0 
(n + 1)Pn(μ)
|
∂φn+1 
∂r + (n + 2)
φn+1(r )
r
|
+ Σt 
1 
4π
E∞
n=0 
(2n + 1)Pn(μ)φn(r )
= 1 
4π
E∞
n=0 
(2n + 1)Σsn Pn(μ)φn(r)
+
1 
4π
νΣ f 
2 
E∞
n=0 
(2n + 1)φn(r)
{
+1
−1 
dμ'
Pn
(
μ'
)
Multiplying by 4π Pn(μ), integrating over μ and making use of orthogonality 
as before, however, we first treat the fission term separately and we imbed P0(μ)
inside the summation and inside the integral since it is equal to one and will have 
no effect 
4π
4π
νΣ f 
2 {
+1
−1 
dμPn(μ)
E∞
n=0 
(2n + 1)P0(μ)φn(r)
{
+1
−1 
dμ'
P0
(
μ'
)
Pn
(
μ'
)3.2 Derivation of the PN Equations in Spherical Geometry 73 
The orthogonality requires that 
{
+1
−1 
dμ'
P0
(
μ'
)
Pn
(
μ'
)
= 2δon 
2n + 1 = 2 since δon = 1 for n = 0 
Therefore, the fission term becomes 
2νΣ f ϕ0(r ) = 2νΣ f ϕ(r)
2n 
2n + 1
|
∂φn−1 
∂r − (n − 1)
φn−1(r )
r
|
+
2(n + 1)
2n + 1
|
∂φn+1 
∂r + (n + 2)
φn+1(r)
r
|
+ 2(Σt )φn(r)
= 2Σsnφn(r) + 2νΣ f φ(r)
Multiplying by 2n + 1 and dividing by 2, we obtain 
n
|
∂ϕn−1 
∂r − (n − 1)
ϕn−1(r)
r
|
+ (n + 1)
|
∂ϕn+1 
∂r + (n + 2)
ϕn+1(r)
r
|
+ (2n + 1)(Σt − Σsn)φn(r ) = (2n + 1)νΣ f φ(r )
Rearranging, we obtain the PN equation for a spherical reactor 
n
| d 
dr − (n − 1)
r
|
φn−1(r)
+ (n + 1)
| d 
dr + (n + 2)
r
|
φn+1(r )
+(2n + 1)(Σt − Σsn)φn(r) = (2n + 1)νΣ f φ(r);
n = 0, 1, 2,..., N (3.13) 
Finally, we obtain the P1 equations as
( d 
dr +
2 
r
)
J (r) + Σaφ(r) = νΣ f φ(r )
dφ(r)
dr + 3(Σt − Σs1)J (r) = 3νΣ f φ(r)
Substituting for the cross sections in the second equation, we get
( d 
dr + 2 
r
)
J (r) + Σaφ(r) = νΣ f φ(r )
1 
3 
dφ(r )
dr + Σtr J (r ) = νΣ f φ(r ) (3.14)74 3 Spherical Harmonics—The PN Method 
The free surface condition (follows in the next section) is as in the planar geom￾etry in addition to the zero net current condition at the center of the sphere, i.e. 
J −(R) = 0 
J (0) = 0 
where R is the radius of the sphere. 
3.3 Boundary and Interface Conditions 
3.3.1 Free Surface Boundary Condition 
Diffusion theory: When the medium is bounded by a void or a black absorber, 
where the neutrons escape and are not able to come back, we can either use the 
extrapolated boundary at which the neutron flux vanishes (φ(c˜) = 0) or use a zero 
negative partial current at the boundary z = c (J −(c) = 0) as shown in Fig. 3.2. 
Applying the condition at the boundary (Eq. 3.11), 
J −(c) = φ(c)
4 +
D 
2 
dφ(z)
dz
|
|
|
|
z=c 
= 0
Fig. 3.2 Free surface 
boundary condition 
Diffusion 
flux 
The true flux 
Multiplying 
medium 
void 3.3 Boundary and Interface Conditions 75
or 
dφ(z)
dz
|
|
|
|
z=c 
= −φ(c)
2D (3.15) 
In order to estimate the extrapolated distance z0, we extend the diffusion flux 
(with a negative slope near the boundary) until it crosses the z-axis. From the 
figure, the slope would be 
dφ(z)
dz
|
|
|
|
z=c 
= −φ(c)
z0 
(3.16) 
Substituting 3.15 into 3.16, we get 
−φ(c)
2D = −φ(c)
z0 
Therefore, z0 = 2D = 2 
3 λtr = 0.666λtr as compared to z0 = 0.7104λtr from 
transport calculation which indicates the invalidity of diffusion theory near the 
boundary and the true flux is as shown should remain constant simply because 
nothing should cause the flux to vanish. 
P1 approximation: 
For the PN equations in general, the one choice of the boundary conditions would 
be the Marshak boundary conditions Referring to Fig. 3.3, a semi-infinite slab 
surrounded by vacuum, 
+
{
1
0 
dμ ϕ(0, μ)Pn(μ) = 0 
{
0
−1 
dμ ϕ(a, μ)Pn(μ) = 0 
for n = 1, 3,..., N odd 
Fig. 3.3 Free surface 
boundary condition (P1 
approx.)
void 
Multiplying 
medium 
void 76 3 Spherical Harmonics—The PN Method 
In particular, for the P1 approximation, the zero incoming current is applied at 
the free surface 
J +(0) = 2π
{
+1
0 
dμμϕ(0, μ) = 2π
{
+1
0 
dμμ
1 
4π
[φ(0) + 3μJ (0)] = 0 
J −(a) = 2π
{
0
−1 
dμμϕ(a, μ) = 2π
{
0
−1 
dμμ
1 
4π
[φ(a) + 3μJ (a)] = 0 
Integrating over μ leads to 
J (0) = −φ(0)
2 ; J (a) = φ(a)
2 
Or more generally, n.J = φ
2 , where n is the outward normal vector. 
For vacuum (free surface) boundary, it is convenient and sufficiently accurate 
for most P1 calculations simply to set φ(0) = φ(a) = 0 at the extrapolation 
distance on both sides [3]. 
Notice: We have used the same condition in the diffusion theory with the definition 
of the incoming current using the diffusion approximation. 
An alternative choice known as the Mark boundary conditions sets 
ϕ(0, μi ) = ϕ(a, −μi ) = 0,i = 1, 2,..., N + 1 
2 
where μi are the positive zeros of PN+1(μ) = 0. 
3.3.2 Interface Condition in Plane Interface 
At the interfaces between different regions with different nuclear properties where 
the cross sections change, the angle-independent flux derived from diffusion the￾ory is always continuous across interfaces because neutrons diffuse either way due 
to neutron density difference until equilibrium is attained at the interface. How￾ever, the angular flux at the planar interface will be discontinuous at μ = 0 and 
continuous otherwise. It is explained as follows: 
Firstly, the flux is said to be continuous only when the fluxes have equal values at 
the interface. 
Secondly, considering Fig. 3.4a, both fluxes are at positions on both sides of the 
interface and in the same direction (μ /= 0); however, they originate from the same 
medium A and therefore they are equal (continuous).3.3 Boundary and Interface Conditions 77
Medium Medium 
Medium 
Medium 
(a) (b) 
Fig. 3.4 a Both fluxes originated from medium A. b Fluxes originated from media A and B 
Thirdly, considering Fig. 3.4b, both fluxes are at positions on both sides of the 
interface and in opposite directions (μ /= 0); however, they originate from different 
media A and B and therefore they are not equal (discontinuous). 
Fourthly, considering Fig. 3.5a, both fluxes are at positions on both sides of the 
interface and in the same direction (μ = 0); however, they originate from different 
media A and B and therefore they are not equal (discontinuous). 
Medium Medium 
Medium 
Medium 
(a) (b) 
Fig. 3.5 a Fluxes originating from media A and B. b Both fluxes originating from media B78 3 Spherical Harmonics—The PN Method 
3.3.3 Interface Condition in Curved Interface 
A simple and obvious example of discontinuity in the angular flux for μ = 0 at 
an interface arises in the case of a free (planar) surface. If, in the figures, medium 
B on the right produces neutrons, while medium A is a vacuum, it follows that 
φB (z0, μ) is finite for all values of μ > 0, but is zero for all μ < 0. Clearly, 
there must be a discontinuity in the angular flux for μ = 0 at a free surface. By 
applying the arguments developed above it can be shown that at a curved interface, 
the angular flux will not be discontinuous as a function of direction, μ.
Considering Fig. 3.5b for a curved boundary, both fluxes are at positions on 
both sides of the interface and in the same direction (μ = 0) and they originate 
from the same media B, therefore they are equal, hence continuous. Although the 
angular flux is not discontinuous at μ = 0, its derivative with respect to μ is 
discontinuous and the flux may change rapidly with μ near μ = 0.
3.3.4 Yvon’s Method 
When separate Legendre expansions are used for the two half-ranges in μ at a 
plane interface, the treatment is known as the double-PN approximation or J. J. 
Yvon’s method. In this approximation, it is possible to satisfy the free surface 
boundary condition exactly and also to allow for discontinuities at interfaces. As a 
result, the method is remarkably accurate in plane geometry. In order to examine 
the double-PN equations, a time-independent, one-speed transport problem will be 
considered in-plane geometries with no source, i.e. Eq. (3.1); thus, [1, 4] 
μ
∂
∂z 
ϕ(z, μ) + Σt ϕ(z, μ)
= E∞
k=0 
(2k + 1)
2
Esk Pk (μ)
{
+1
−1 
dμ'
Pk
(
μ'
)
ϕ
(
z, μ'
) (3.17) 
In the double PN approximation, it is assumed that 
φ(z, μ) = E
N
n=0 
(2n + 1)[φ+
n (z)P+
n (2μ − 1)
+ φ−
n (z)P−
n (2μ + 1)] (3.18) 
With the following definitions, 
P+
n (2μ − 1) = Pn(2μ − 1) μ ≥ 0 
= 0 μ < 0 
P−
n (2μ + 1) = Pn(2μ + 1) μ < 0 
= 0 μ ≥ 03.3 Boundary and Interface Conditions 79
It will be noted that, over a half-range, the argument (2μ ∓ 1) of the appropriate 
P±
n varies between −1 and +1. 
Proof 
The Legendre recursion relation 
μPn(μ) = n + 1 
2n + 1 
Pn+1(μ) + n 
2n + 1 
Pn−1(μ)
needs to be adjusted to suit the new argument of the polynomials such that μ →
2μ + 1 or μ → 2μ − 1 
(2μ+1)Pn(2μ + 1) = n + 1 
2n + 1 
Pn+1(2μ + 1) + n 
2n + 1 
Pn−1(2μ + 1)
We have 
(2μ+1)Pn(2μ + 1) = Pn(2μ + 1) + 2μPn(2μ + 1)
From which, 
2μPn(2μ + 1) = (2μ+1)Pn(2μ + 1) − Pn(2μ + 1)
Therefore, 
2μPn(2μ + 1) = n + 1 
2n + 1 
Pn+1(2μ + 1)
+ n 
2n + 1 
Pn−1(2μ + 1) − Pn(2μ + 1) (3.19) 
Likewise, 
(2μ−1)Pn(2μ − 1) = n + 1 
2n + 1 
Pn+1(2μ − 1) + n 
2n + 1 
Pn−1(2μ − 1)
And hence, 
2μPn(2μ − 1) = n + 1 
2n + 1 
Pn+1(2μ − 1)
+ n 
2n + 1 
Pn−1(2μ − 1)
+ Pn(2μ − 1) (3.20) 
rewriting the recursion relations (3.19) and (3.20) in the expanded form:80 3 Spherical Harmonics—The PN Method 
2μP+
n (2μ − 1) = n + 1 
2n + 1 
P+
n+1(2μ − 1)
+ n 
2n + 1 
P+
n−1(2μ − 1) + P+
n (2μ − 1) (3.21) 
2μP−
n (2μ + 1) = n + 1 
2n + 1 
P−
n+1(2μ + 1)
+ n 
2n + 1 
P−
n−1(2μ + 1) − P−
n (2μ + 1) (3.22) 
Substituting the expansion from Eqs. (3.18), (3.21), and (3.22) into (3.17). 
The first term: 
μ
∂
∂z 
φ(z, μ) = 1 
2 
E
N
n=0 
(2n + 1)
( n + 1 
2n + 1 
∂
∂z 
φ+
n (z)P+
n+1(2μ − 1)
+ n 
2n + 1 
∂
∂z 
φ+
n (z)P+
n−1(2μ − 1)
+
∂
∂z 
φ+
n (z)P+
n (2μ − 1)
)
+
1 
2 
E
N
n=0 
(2n + 1)
( n + 1 
2n + 1 
∂
∂z 
φ−
n (z)P−
n+1(2μ + 1)
+ n 
2n + 1 
∂
∂z 
φ−
n (z)P−
n−1(2μ + 1)
+
∂
∂z 
φ−
n (z)P−
n (2μ + 1)
)
transforming the Legendre polynomials to order n similar to the case of full μ
range done earlier 
μ
∂
∂z 
φ(z, μ) = 1 
2 
E
N
n=0 
(2n + 1)
| n 
2n + 1 
P+
n (2μ − 1)
∂
∂z 
φ+
n−1(z)
+ n + 1 
2n + 1 
P+
n (2μ − 1)
∂
∂z 
φ+
n+1(z)
+
∂
∂z 
φ+
n (z)P+
n (2μ − 1)
|
+
1 
2 
E
N
n=0 
(2n + 1)
| n 
2n + 1 
P−
n (2μ + 1)
∂
∂z 
φ−
n−1(z)
+ n + 1 
2n + 1 
P−
n (2μ + 1)
∂
∂z 
φ−
n+1(z)
− ∂
∂z 
φ−
n (z)P−
n (2μ + 1)
|3.3 Boundary and Interface Conditions 81
where we have retained the first term of the series to n = 0. Similar steps are 
followed for the second term on the left side 
Σt φ(z, μ) = E
N
n=0 
(2n + 1)Σt φ+
n (z)P+
n (2μ − 1)
+E
N
n=0 
(2n + 1)Σt φ−
n (z)P−
n (2μ + 1)
The right-hand side, however, contains terms involving products of the full￾range and half-range polynomials. 
E∞
k=0 
(2k+1)
2 Esk Pk (μ)
E
N
n=0 
(2n + 1)
+
{
1
−1 
dμ'
Pk
(
μ'
)|φ+
n (z)P+
n
(
2μ' − 1
)
+φ−
n (z)P−
n
(
2μ' + 1
)|
The constants p+
nk and p−
nk are defined by 
p+
nk =
{ +1 
−1 
dμPn(μ)P+
k (2μ − 1)
p−
nk =
{ +1 
−1 
dμPn(μ)P−
k (2μ + 1)
The right-hand side term becomes 
E∞
k=0 
(2k+1)
2 Esk Pk (μ)
E
N
n=0 
(2n + 1)
|
[φ+
n (z)
+
{
1
−1 
dμ'
Pk
(
μ'
)
P+
n
(
2μ' − 1
)
+φ−
n (z)
+
{
1
−1 
dμ'
Pk
(
μ'
)
P−
n
(
2μ' + 1
)
|
= E∞
k=0 
(2k+1)
2 Esk Pk (μ)
E
N
n=0 
(2n + 1)
|
φ+
n (z)p+
kn + [φ−
n (z)p−
kn|
Collecting and separating terms with (+) and (−) signs will yield two equations:
1 
2 
E
N
n=0 
(2n + 1)
| n 
2n + 1 
P+
n (2μ − 1)
∂
∂z 
φ+
n−1(z)
+ n + 1 
2n + 1 
P+
n (2μ − 1)
∂
∂z 
φ+
n+1(z)
+
∂
∂z 
φ+
n (z)P+
n (2μ − 1)
|82 3 Spherical Harmonics—The PN Method
+
E
N
n=0 
(2n + 1)Σt φ+
n (z)P+
n (2μ − 1)
= E∞
k=0 
(2k + 1)
2
Esk Pk (μ)
E
N
n=0 
(2n + 1)φ+
n (z)p+
kn) (3.23) 
1 
2 
E
N
n=0 
(2n + 1)
| n 
2n + 1 
P−
n (2μ + 1)
∂
∂z 
φ−
n−1(z)
+ n + 1 
2n + 1 
P−
n (2μ + 1)
∂
∂z 
φ−
n+1(z)
− ∂
∂z 
φ−
n (z)P−
n (2μ + 1)
|
+
E
N
n=0 
(2n + 1)Σt φ−
n (z)P−
n (2μ + 1)
= E∞
n=0 
(2k + 1)
2
Esk Pk (μ)
E
N
n=0 
(2n + 1)φ−
n (z)p−
kn (3.24) 
Note: If the two equations are added, we get the original unified equation. 
Equation 3.23 is multiplied by P+
m (2μ − 1); integrated over μ from −1 to 1 
and using the orthogonality of Legendre polynomials, we get 
m 
2m + 1 
∂
∂z 
φ+
m−1(z) + m + 1 
2m + 1 
∂
∂z 
φ+
m+1(z)
+
∂
∂z 
φ+
m (z) + 2Σt φ+
m (z)
= E∞
k=0 
(2k + 1)
2
Esk (z)p+
km 
E
N
n=0 
(2n + 1)φ+
n (z)p+
kn (3.25) 
Equation 3.24 is multiplied by P−
m (2μ + 1); integrated over μ from −1 to 1 
and the orthogonality is used again 
m 
2m + 1 
∂
∂z 
φ−
m−1(z) + m + 1 
2m + 1 
∂
∂z 
φ−
m+1(z) − ∂
∂z 
φ−
m (z)3.4 Difference Scheme for the One-Dimensional One-Speed P1 Equations 83 
+ 2Σt φ−
m (z)
= E∞
k=0 
(2k + 1)
2
Esk (z)p−
km 
E
N
n=0 
(2n + 1)φ−
n (z)p−
kn (3.26) 
Two Eqs. (3.21) and (3.22) are combined in one equation 
m 
2m + 1 
dφ±
m−1(z)
dz + m + 1 
2m + 1 
dφ±
m+1(z)
dz
±
dφ±
m (z)
dz 
+ 2Σt φ±
m (z)
= E∞
k=0 
(2k + 1)
2 p±
km Σsk 
E
N
n=0 
(2n + 1)[φ+
n (z)p+
kn + φ−
n (z)p−
kn] (3.27) 
In the particular case of isotropic scattering, the sum over k has only one term, 
for k = 0; it then follows that p±
0n is equal to the Kronecker delta δ0n. So, the 
right-hand side of Eq. (3.27) is 
Σs0
|
φ+
0 (z) + φ−
0 (z)
|
More generally, if the cross section expansion is terminated at k = K , then the 
sum over k contains only terms with n ≤ K . 
With the double-PN approximation, free-surface boundary conditions can be 
satisfied exactly. If the problem is over the domain 0 ≤ z ≤ a, the free-surface 
conditions are simply 
φ+
n (0) = 0 and φ−
n (a) = 0 
3.4 Difference Scheme for the One-Dimensional One-Speed 
P1 Equations 
3.4.1 Plane Geometry 
By importing the P1 Eq. (3.7) for planar geometry [5] 
dJ (z)
dz + Σaφ(z) = S(z)
1 
3 
dφ
dz + Σtr J (z) = S1(z)
}
(3.28)84 3 Spherical Harmonics—The PN Method 
we will follow a similar procedure to the numerical formulation for the diffusion 
theory in Chap. 2. The scheme assumes each interval could be characterized by 
its own nuclear properties hence allowing for heterogeneity in the medium. Also, 
in order to ensure continuity of the flux, it is defined to extend across the mesh 
boundary; however, as a result, the flux derivative is not. If the reactor core consists 
of many regions, then the mesh boundary is chosen at the regional interfaces. 
Referring to the schemes in Figs. 3.6 and 3.7, the definitions of the flux and current 
and the x-sections are 
1st term =
{ z0 
n 
z0 
n−1
|
dJ (z)
dz |
dz = J (z)| z0 
n 
z0 
n−1 
= J
(
z0 
n
)
− J
(
z0 
n−1
)
= Jn+1 − Jn−1 
2 
The second term φ(z) is defined as a constant value φn across the mesh and 
therefore we can take it out of the integral.
Fig. 3.6 Discretization of space variable 
cross 
sections 
Flux & 
current 
derivative 
Fig. 3.7 Mesh structure of the space variable 3.4 Difference Scheme for the One-Dimensional One-Speed P1 Equations 85 
2nd term =
φn 
z0 
{n
z0 
n−1 
Σa(z)dz = φn {
zn
z0 
n−1 
Σa(z)dz + φn 
z0 
{n
zn 
Σa(z)dz 
= φnΣan−1 {
zn
z0 
n−1 
dz + φnΣan 
z0 
{n
zn 
dz = φnΣan−1
(
zn − z0 
n−1
)
+φnΣan(
z0 
n − zn
)
= φnΣan−1 
hn−1 
2 + φnΣan hn 
2 
3rd term =
z0 
{n
z0 
n−1 
S(z)dz = Sn 
z0 
{n
z0 
n−1 
dz = Sn
(
z0 
n − z0 
n−1
)
= Sn 
hn−1−hn 
2 
Jn+1 − Jn−1 
2 + φn
(
Σan−1 
hn−1 
2 + Σan 
hn 
2
)
= Sn 
hn − hn−1 
2 
Summing up terms, 
multiplying by 2, we get 
Jn+1 − Jn−1 + φn(Σan−1hn−1 + Σanhn)
= Sn(hn − hn−1);
n = 2, 3, . . . ..N (3.29) 
There are two more equations for n = 1 and n = N + 1 to be determined by 
left and right boundary conditions, respectively. 
Second equation: 
z0 
{ n
z0 
n−1
|
1 
3 
dφ
dz + Σtr J (z) = S1(z)
|
dz 
Comparing the second P1 equation to the first, we can heuristically obtain the 
numerical form as 
1 
3 
(φn+1 − φn−1) + Jn(Σtrn−1hn−1 + Σtrnhn)
= S1n(hn − hn−1); n = 2, 3,... N (3.30) 
Also, there are two more equations at the boundaries for n = 1 and n = N +1. 
Similarly, we can integrate the second equation over the interval, zn ≤ z ≤ zn+1 
or zn−1 ≤ z ≤ zn86 3 Spherical Harmonics—The PN Method 
(φn+1 − φn) + 3Σtrnhn
( Jn + Jn+1 
2
)
= 3hn
( S1n + S1n+1 
2
)
(3.31) 
(φn − φn−1) + 3Σtrn−1hn−1
( Jn−1 + Jn 
2
)
= 3hn−1
( S1n−1 + S1n 
2
)
(3.32) 
3.4.1.1 Solving the P1 Equations 
It is more convenient to solve for Jn+1 − Jn−1, but first, from Eqs. (3.30) and 
(3.31), 
Jn + Jn+1 = 1 
Σtrn 
(S1n + S1n+1) − 2 
3Σtrnhn 
(φn+1 − φn)
Jn−1 + Jn = 1 
Σtrn−1 
(S1n−1 + S1n) − 2 
3Σtrnhn−1 
(φn − φn−1)
Subtracting the two equations, 
Jn+1 − Jn−1 = 1 
Σtrn 
(S1n + S1n+1) − 1 
Σtrn−1 
(S1n−1 + S1n)
+
2 
3Σtrn−1hn−1 
(φn − φn−1) − 2 
3Σtrnhn 
(φn+1 − φn)
Substituting in Eq. (3.28), 
φn(Σan−1hn−1 + Σanhn) + 2 
3Σtrn−1hn−1 (φn − φn−1)
− 2 
3Σtrn hn (φn+1 − φn)
= 1 
Σtrn (S1n + S1n+1) − 1 
Σtrn−1 (S1n−1 + S1n) + Sn(hn − hn−1)
We sort out the three-point fluxes
|
− 2 
3Σtrn−1hn−1
|
φn−1 
+
|
(Σan−1hn−1 + Σanhn) +
2 
3Σtrn−1hn−1 
+
2 
3Σtrnhn
|
φn +
|
− 2 
3Σtrnhn
|
φn+1 
=
| 1 
Σtrn 
− 1 
Σtrn−1
|
S1n +
| 1 
Σtrn |
S1n+13.4 Difference Scheme for the One-Dimensional One-Speed P1 Equations 87
+
|
− 1 
Σtrn−1
|
S1n−1 + |
hn−1 − hn
|
Sn ...(32)
Defining the coefficients of the fluxes, we arrive at 
anφn−1 + bnφn + cnφn+1 = dn S1n + en S1n+1 + fn S1n−1 + qn Sn 
Uniting the source, 
anφn−1 + bnφn + cnφn+1 = Qn; n = 2, 3,... N (3.33) 
There are N − 2 equations and we have N − 2 unknowns: 
φ1, φ2, φ3,.........φN+1. The remaining two equations are defined on the left at 
z1 and at right at zN +1. 
3.4.1.2 Boundary Equations (n = 1 and N + 1) 
The Marshak vacuum (free surface) boundary conditions for the P1 approxima￾tion has been discussed earlier. We stated that it is convenient for P1 calculations 
to set φ
(
z1 = 0
/)
= φ
(
zN+1 = a
/)
= 0 at the extrapolation distance on both sides 
of the slab. Figures 3.8 and 3.9 show the corresponding boundaries at z1 = 0 and 
zN+1 = a on the right. 
Fig. 3.8 Mesh structure for 
the left boundary88 3 Spherical Harmonics—The PN Method 
Fig. 3.9 Mesh structure for 
the right boundary 
(i) Left boundary: Fig. 3.8 
On the left boundary, Eq. (3.33) becomes 
a1φ0 + b1φ1 + c1φ2 = Q1; for n = 1
|
− 2 
3Σtr0h0
|
φ0 +
|
(Σa0h0 + Σa1h1) + 2 
3Σtr0h0 + 2 
3Σtr1h1
|
φ1 
+
|
− 2 
3Σtr1h1
|
φ2 
=
| 1 
Σtr1 − 1 
Σtr0
|
S1(0) +
| 1 
Σtrn |
S1(2) −
| 1 
Σtr0
|
S1(0) + [h1 − h0]S(1)
The subscripts between brackets in the source term refer to the values of n. No 
material exists on the left of the boundary (vacuum); therefore, nuclear properties 
are zero. Substituting in the above equation, we obtain the boundary equation for 
n = 1
|
(Σa1h1) +
2 
3Σtr1h1
|
φ1 −
| 2 
3Σtr1h1
|
φ2 
=
| 1 
Σtr1
|
S1(0) +
| 1 
Σtr1
|
S1(2) + [h1 − h0]S1(1)
Therefore, 
b1φ1 + c1φ2 = Q1; for n = 1 (3.34)3.4 Difference Scheme for the One-Dimensional One-Speed P1 Equations 89 
(ii) Right boundary: Fig. 3.9 
On the right boundary at n = N + 1, Eq. (3.32) becomes 
+
|
− 2 
3Σtr N hN
|
φN 
+
|
(ΣaN hN + ΣaN+1hN +1) +
2 
3Σtr N hN 
+
2 
3Σtr N +1hN +1
|
φN+1
|
− 2 
3Σtr N +1hN+1
|
φN +2 
=
| 1 
Σtr N +1 
− 1 
Σtr N |
S1(N+1) +
| 1 
Σtr N +1
|
S1(N +2) +
|
− 1 
Σtr N |
S1(N)
+ |
hN +1 − hN
|
SN +1 
The nuclear properties are zero on the right side of the slab. The equation 
reduces to
|
− 2 
3Σtr N hN
|
φN +
|
(ΣaN hN ) +
2 
3Σtr N hN
|
φN +1 
=
|
− 1 
Σtr N |
S1(N +1) +
|
− 1 
Σtr N |
S1(N)
+ |
hN+1 − hN
|
SN +1 
aN φN + bN +1φN +1 = QN +1 for n = N + 1 (3.35) 
3.4.1.3 Solution of theP1 Difference Equations 
Collecting results, the system of equations for slab geometry with N equations and 
N unknowns 
a1φ0 + b1φ1 + c1φ2 = Q1 
anφn−1 + bnφn + cnφn+1 = Qn 
aN φN + bN +1φN+1 = QN +1 
⎫
⎬
⎭
(3.36) 
From now on, the remaining task is the matrix formulation of the system 
of Eq. (3.36) making use of the boundary conditions and applying a suitable 
algorithm which is the subject of numerical methods. 
3.4.2 Difference Equations in Spherical Geometry 
Difference equations may be derived for spherical geometry, in much the same way 
as for plane geometry. Consider the P1 equation derived earlier for a sphere. You90 3 Spherical Harmonics—The PN Method 
Fig. 3.10 Discretizing the 
radial direction 
can easily show that ( d 
dr + 2 
r
)
J (r ) = 1 
r 2 
d 
dr r 2 J (r ); hence, we use this expression 
instead for a sphere 
1 
r 2 
d 
dr r 2 J (r) + Σaϕ(r ) = νΣ f ϕ(r )
1 
3 
dφ(r)
dr + Σtr J (r ) = νΣ f J (r )
}
(3.37) 
Figure 3.10 shows the spherical shells resulting from discretizing the one￾dimensional radial direction. 
Now, we discretize the radial direction of the sphere. In a similar scheme for 
the semi-infinite slab, if the scheme is tended for the PN equation and not the 
P1 equation, you may avoid using the subscript n. Therefore, we multiply the P1 
equations by 4πr 2 (the surface area of the spherical shell at r) and integrate over 
r from r 0 
n−1 to r 0 
n . When the surface area of the shell is multiplied by the thickness 
of the shell, dr we get the volume of the shell element 4πr 2dr. 
r 0 
{ n
r 0 
n−1 
4πr 2dr{ 1 
r 2 
d 
dr r 2 J (r) + Σaϕ(r ) = νΣ f ϕ(r )
1 
3 
dφ(r)
dr + Σtr J (r ) = νΣ f J (r)
Using the second equation in 3.36., 
J (r ) = 1 
3
(
νΣ f − Σtr )
dφ(r )
dr 
Substituting in the first equation (Fig. 3.11),
1 
3
(
νΣ f − Σtr )
r 0 
{ n
r 0 
n−1 
d 
dr (
r 2 dφ(r )
dr )
dr 
+ ϕn 
⎡
⎢
⎢
⎣
Σan−1 {rn
r 0 
n−1 
r 2dr + Σan 
r 0 
{ n
rn 
r 2dr 
⎤
⎥
⎥
⎦3.4 Difference Scheme for the One-Dimensional One-Speed P1 Equations 91 
cross 
sections 
Flux & current 
derivative 
Fig. 3.11 Mesh structure in spherical geometry integrating 
= ϕn 
⎡
⎢
⎢
⎣
νΣ f n−1 {rn
r 0 
n−1 
r 2dr + νΣ fn 
r 0 
{ n
rn 
r 2dr 
⎤
⎥
⎥
⎦
1 
3
(
νΣ f − Σtr )
(
r 2 dφ(r)
dr )|
|
|
|
r 0 
n 
r 0 
n−1 
+ϕn
|
Σan−1
(
r 3 
n 
3 − (r 0 
n−1)‘3 
3
)
+ Σan((r 0 
n )3 
3 − r 3 
n 
3
)|
= ϕn
|
νΣ f n−1
(
r 3 
n 
3 − (r 0 
n−1)‘3 
3
)
+ νΣ f n((r 0 
n )3 
3 − r 3 
n 
3
)|
Substituting for r 0 
n and r 0 
n−1,
1 
3
(
νΣ fn − Σtrn)
(
rn +
hn 
2
)2|
φn+1 − φn 
hn
|
− 1 
3
(
νΣ f n−1 − Σtrn−1
)
|
rn−1 +
hn−1 
2
|2|
φn − φn−1 
hn−1
|
+ φn 
⎡
⎢
⎣
Σan−1 
⎛
⎜
⎝r 3 
n 
3 −
|
rn−1 + hn−1 
2
|3 
3 
⎞
⎟
⎠ + Σan 
⎛
⎜
⎝
(
rn + hn 
2
)3 
3 − r 3 
n 
3 
⎞
⎟
⎠
⎤
⎥
⎦92 3 Spherical Harmonics—The PN Method 
= φn 
⎡
⎢
⎣
νΣ f n−1 
⎛
⎜
⎝r 3 
n 
3 −
|
rn−1 + hn−1 
2
|3 
3 
⎞
⎟
⎠ + νΣ fn 
⎛
⎜
⎝
(
rn + hn 
2
)3 
3 − r 3 
n 
3 
⎞
⎟
⎠
⎤
⎥
⎦
Collecting the coefficients, 
anφn−1 + bnφn + cnφn+1 = f φn;(n = 2, 3,... N ) (3.38) 
Boundary equations: (n = 1 and N + 1). 
The application of the boundary-free surface condition discussed earlier and the 
schematic diagrams at r = R is identical to the case of planar geometry, e.g. 
J −(R) = 0, or just the zero flux at the extrapolation distance on the outside of 
the sphere φ
(
R
/)
= φN +1 = 0. In addition to the zero net current condition at 
the center of the sphere, i.e. J (0) = 0. Therefore, instead, we use a zero-flux 
condition, i.e. 
3.5 The Elastic Transfer Cross Section 
When the directional dependence in the transport equation is important, the transfer 
cross section needs a special treatment, and therefore the way angular data of the 
cross section are organized. Taking into consideration that the elastic scattering 
from stationary nuclei is isotropic in the center of mass (COM) system [6, 7, 5]. 
The microscopic transfer cross section is given by 
σs
(
r, E' → E, Ω' → Ω)
dΩ = 2πσs
(
r , E' → E, μL
)
dμL (3.39) 
where Ω' → Ω ∼= Ω'
.Ω = cosθL = μL is the cosine of the scattering angle 
in the LAB system. Figure 3.12 shows the energy and directional change in the 
elastic scattering event. Recall from the subject of neutron kinematics 
μL = 1 
2
|
(A + 1)
/ E 
E' − (A − 1)
/ E'
E
|
= SL
( E 
E'
)
(3.40) 
where SL
( E 
E'
)
is usually referred to as S(μL ).
Notice that in some references the incident and the final energies are reversed 
and μL is normally written as μ0. 
Referring to Eq. (3.40), μL is determined solely from the incident and emerging 
energies such that given a value of E’ and E, there is only one value μL = S from 
all possible values of μL . Figure 3.13 clarifies this.3.5 The Elastic Transfer Cross Section 93
Fig. 3.12 Energy and 
direction change in elastic 
scattering
Fig. 3.13 Possible 
distributions of scattering 
angle 
Therefore, the microscopic transfer x-section can be written in terms of the 
Dirac delta function as 
σs
(
r , E' → E, μL
)
=
{ σs(r,E'
→E)
2π δ(μL − S), αE' ≤ E ≤ E'
0 E > E' or E < αE'
Substituting σs
(
r, E' → E
) = σs(r ,E'
)
(1−α)E' for isotropic elastic scattering in the 
center of mass (COM), 
σs
(
r , E' → E, μL
)
=
{ σs(r ,E'
)
2π(1−α)E' δ(μL − S), αE' ≤ E ≤ E'
0 E > E' or E < αE' (3.41) 
where α =
((A−1)
(A+1)
)2 
. The Dirac delta function δ(μL − S) is defined at μL = S 
and zero otherwise. We will utilize the property { f (x)δ(x − a)dx = f (a), where 
the delta function is centered about a. Therefore, by comparison,
{
f (μL )δ(μL − S)dμL = f (S)
where the range of integration includes μL = S.94 3 Spherical Harmonics—The PN Method 
The definition of Legendre orders scattering components are 
σsn(r , E'
→ E) = 2π
{ +1 
−1 
dμL σs
(
r, E'
→ E, μL
)
Pn(μL ) (3.42) 
Based on the Legendre expansion, 
σs
(
r, E' → E, μL
)
= E∞
n=0 
(2n + 1)
4π σsn(
r , E' → E
)
Pn(μL )
By inserting σs
(
r , E' → E, μL
)
from Eq. (3.41) into the integral Eq. (3.42), 
we get 
σsn(
r , E' → E
)
= 2π
{
+1
−1 
dμL 
σs
(
r , E'
)
2π(1 − α)E'
δ(μL − S)Pn(μL )
σsn(
r, E' → E
)
= σs
(
r , E'
)
(1 − α)E'
{
+1
−1 
dμL Pn(μL )δ(μL − S)
σsn(
r, E' → E
)
= σs
(
r, E'
)
(1 − α)E' Pn(S)
or 
σsn(
r , E' → E
)
=
{ σs(r ,E'
)
(1−α)E' Pn(S), αE' ≤ E ≤ E'
0 E' or E < αE' (3.43) 
We express the scattering cross section in a multi-group form. Figure 3.14 
shows the energy discretization [8]. 
Recall that the group g scattering cross section is defined as 
σsg =
{ Eg−1 
Eg d Eσs (E)φ(E)
{ Eg−1 
Eg d Eφ(E)
= 1 
φg 
E
{g−1
Eg 
d Eσs (E)φ(E)
group group group group
Fig. 3.14 Multi-group structure 3.5 The Elastic Transfer Cross Section 95
Fig. 3.15 Neutron scattering 
from g' to g 
group group 
The transfer x-section from another group g’ to group g as shown in Fig. 3.15 
takes the form: 
σsg'
→g =
{
g d E {
g' d E'
σs
(
E' → E
)
φ
(
E'
)
φg' = {
g' d E'
φ(E'
) (3.44) 
To obtain the multi-group form, we integrate the energy groups as before 
σsng'
→g
(
r
)
=
{
g d E {
g' d E'
σsn(
r, E' → E
)
φ
(
r, E'
)
φg' = {
g' d E'
φ
(
r , E'
)
And substituting for σsn(
r , E' → E
)
from Eq. (3.43), 
σsng'
→g
(
r
)
=
{
g d E {
g' d E' σs(r ,E'
)
(1−α)E' Pn(S)φ
(
r , E'
)
φg' = {
g' d E'
φ
(
r , E'
) (3.45) 
In some reactor calculation problems, we have to deal with high-order Legendre 
polynomials as a function of the scattering function 
Pn
(
SL
|
E/E'
|) and P0(S) = 1, P1(S) = S, P2(S) = 1 
2
(
3S2 − 1
)
,...
Therefore, the above integration in Eq. (3.45) is dealt with numerically by the 
execution of the summation over a micro-group structure within the group g. Equa￾tion (3.45) defines the Legendre order scattering matrix σsng'
→g
(
r
)
needed in the 
Legendre equation or the combined equation with discrete ordinates (PN − DO)
equation. The matrix has to be constructed from the basic group scattering x￾sections σsg'
→g
(
r
)
. It will be revisited when we study the discrete ordinates 
method. 
Exercises 
1. Show that 
J ± ≈ 1 
4 
φ(r ) ∓
D 
2 n.∇φ(r)
using the P1 approximation for the angular flux.96 3 Spherical Harmonics—The PN Method 
2. Re-derive the PN equation for one-speed, isotropic scattering, and plane 
symmetry—include time dependence. 
(a) In particular, obtain the P1 equation and solve for an equation describing 
the total flux 
3D 
ν2 
∂2φ
∂t2
(1 
ν
+
3DEa 
ν
)∂φ
∂t = D 
∂2φ
∂x2 − Eaφ(x, t) + S 
(b) Compare this equation with the neutron diffusion equation: 
1 
ν
∂φ
∂t = D 
∂2φ
∂x2 − Eaφ(x, t) + S 
and indicate what differences you might expect in the solutions to the P1 
description. Also indicate under what conditions or approximations the P1 
equations should yield results similar to diffusion theory. 
3. Assuming a fission source, rewrite Eq. (3.1) and obtain the PN equations 
and hence the P1 equations. 
4. Consider the one-speed transport equation with isotropic scattering and no 
sources. 
μ
∂
∂z 
φ(z, μ) + Σt φ(z, μ) = Σs 
2 {
+1
−1 
dμ'
φ
(
z, μ'
)
Use the first two terms of Legendre expansion which should look like 
φ(z, μ) = 1 
2 
P0(μ)ϕ0(z) +
3 
2 
P1(μ)ϕ1(z)
Substitute this into the equation and multiply by P0(μ), P1(μ), respec￾tively, and integrate over μ to obtain equations for ϕ0(z), ϕ1(z). Did you 
obtain the P1 equations? 
5. Rederive Eq. (3.5) assuming the energy dependence of the angular flux 
and the x-sections and a fission source. Discretize the energy variable into 
energy groups and obtain the multigroup P1 equations. 
6. Rewrite Eq. (3.12) assuming isotropic scattering (you may have to follow 
the evolution of the scattering term from the very beginning). 
7. Verify the numerical scheme leading to Eq. (3.32). 
8. Verify the numerical scheme leading to Eq. (3.35). 
9. Review the derivations leading to Eq. (3.38) and follow a similar procedure 
as in the planar case for the left and right boundaries, derive the equations 
for at n = 1 and N + 1).References 97
References 
1. G. Bell, S. Glasstone, Nuclear Reactor Theory (Van Nostrand, New York, 1970) 
2. E. Kreyszig, Advanced Engineering Mathematics (Wiley, USA, 1972) 
3. W. Martin, Lecture Notes on Transport Theory (University of Michigan, Nuclear Engineering, 
1980) 
4. J. Duderstadt, Lecture Notes, on Reactor Theory (University of Michigan, Nuclear Engineering, 
1977) 
5. J. Lee, Lecture Notes on Transport Theory (University of Michigan, Nuclear Engineering, 1975) 
6. H. Brockmann, Treatment of anisotropic scattering in numerical Neutron transport theory. Nucl. 
Sci. Eng. (1981) 
7. C.E. Siewert, M.M.R. Williams, The effect of anisotropic scattering on the critical slab problem 
in neutron transport theory using a synthetic kernel. J. Phys. D: Appl. (1977) 
8. J.K. Fletcher, The solution of the multigroup Neutron transport equation using spherical har￾monics. Nucl. Sci. Eng. (1983)4 The Adjoint Transport Equation—The 
Equation of Neutron Importance 
Consideration will be given to the equation which is adjoint to the neutron trans￾port equation. The solutions to an adjoint equation will be seen to be, in a sense, 
orthogonal to the solutions of the transport equation. Moreover, the former has 
a clear physical significance as the “importance” of neutrons within a particular 
system. For these and other reasons, the solutions to the adjoint transport equation 
are widely used in perturbation theory, kinetic parameters, variational methods, 
and other calculations related to the behavior of the nuclear reactor. 
The subject requires the introduction of some mathematical definitions, identi￾ties, and transport operators which are presented in Sects. 4.1 and 4.2. In Sect. 4.3, 
the derivation of the equation of neutron importance (the adjoint to the transport 
equation) is carried out along with boundary conditions. The adjoint multi-group 
neutron diffusion equation and the adjoint P1 equations are discussed in Sect. 4.4. 
Finally, the kinetic parameters of a one-node and two-node reactor are derived in 
Sect. 4.5 using the concept of adjoint flux. 
4.1 Mathematical Definitions [1, 2] 
Define the inner product between the two functions ψ, ϕ: 
(ψ, ϕ) = ∫ ψ(ξ )ϕ(ξ )dξ (4.1) 
where ξ stands for all possible variables defining the function ψ, ϕ. 
Requirement (1) 
If ψ, ϕ are well-behaved functions and M is a self-adjoint operator, then 
(ψ, Mϕ) = (ϕ, Mψ) (4.2)
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2023 
R. M. Kuridan, Neutron Transport, Graduate Texts in Physics, 
https://doi.org/10.1007/978-3-031-26932-5_4 
99100 4 The Adjoint Transport Equation—The Equation of Neutron Importance
The eigenfunctions of operators are orthogonal and the eigenvalues are always 
real. In neutron transport equation, operators are real, hence no need for conju￾gates, however they are not self-adjoint. 
Requirement (2) 
If L is not self-adjoint, then there is L∗ which is the adjoint of L and operates on 
the adjoint eigenfunction ϕ∗ and the operator L operates on the eigenfunction ϕ
then both satisfy:
(
ϕ∗, Lϕ
)
= (
ϕ, L∗ϕ∗) (4.3) 
The eigenfunctions of the adjoint operator, L∗, are then orthogonal to those of 
the operator L. Thus, if ϕ is an eigenfunction, then 
Lϕ = λϕ
and if ϕ∗ is also an eigenfunction, then 
L∗ϕ∗ = ηϕ∗
where λ and η are eigenvalues. Using the requirement (4.3) and substituting for 
Lϕ, L∗ϕ∗
(ϕ∗, λϕ) = (ϕ, ηϕ∗) and factorizing λ(ϕ∗, ϕ) = η(ϕ, ϕ∗), we get 
(λ − η)
(
ϕ, ϕ∗)
= 0 
(ϕ∗, ϕ) = (ϕ, ϕ∗) because they are commutative (from Eq. (4.1)) therefore, it is 
either (ϕ, ϕ∗) = 0 and hence (λ /= η)and ϕ, ϕ∗are orthogonal. If (ϕ, ϕ∗) /= 0 then 
λ = η. 
Transport operators: 
Recall the general steady-state form of the neutron transport equation in a 
multiplying medium from Chap. 1 
− Ω · ∇ϕ
(
r , E, Ω)
− Σt
(
r, E, Ω)
ϕ
(
r , E, Ω)
+
{∞
0 
d E'
{
4π
dΩ'
ϕ
(
r, E'
, Ω'
)
Σs
(
r, E' → E, Ω' → Ω)
+ χ(E)
4π
{
4π
dΩ'
{∞
0 
d E'
ϕ
(
r , E'
, Ω'
)
ν
(
E'
)
Σ f
(
r , E'
)
= 0 (4.4) 
Then it can be written using the operator notation in the form L φ
(
r, E, Ω)
= 0 
such that 
Lϕ
(
r , E, Ω)
= −Ω · ∇ϕ
(
r , E, Ω)
− Σt
(
r , E, Ω)
ϕ
(
r , E, Ω)
+4.2 Derivation of the Equation of Neutron Importance (The Adjoint Function) 101 
{∞
0 
d E'
{
4π
dΩ'
Σs
(
r , E' → E, Ω' → Ω)
ϕ
(
r , E'
, Ω'
)
+ χ (E)
4π
{
4π
dΩ'
{ ∞
0 
d E'
v
(
E'
)
Σ f
(
r , E'
)
ϕ
(
r, E'
, Ω' (4.5) 
4.2 Derivation of the Equation of Neutron Importance (The 
Adjoint Function) 
Generally speaking, neutrons may have different effects on the fission process 
depending on their energy, position, and direction. For example, a thermal neutron 
introduced anywhere in the core will be more capable of inducing fission in a 
U235 nucleus than a fast neutron. Furthermore, if the thermal neutron is placed 
near the edge of the core, it will be exposed more to leakage than if placed in the 
middle. A neutron moving in the direction toward the interior of the core should be 
expected to have a more chance to interact than a neutron moving in the outward 
direction. Therefore, the neutron energy, position, and direction play a major role 
in defining the concept of neutron importance [3]. 
Consider a neutron at position r with energy E and direction Ω in dV , d E, dΩ,
respectively, at time t having an importance ϕ∗(
r, E, Ω, t
)
(notice that it does not 
have the units of neutron flux). In a time interval /t, the neutron moves a distance 
dr = υ/t = Ωυ /t or |
|dr|
| = υ /t and its importance at t + /t becomes 
ϕ∗(
r + Ωυ /t, E, Ω, t + /t
)
. Figure 4.1 shows the change of importance. 
4.2.1 The Equation of Conservation of Importance 
The importance at time t is equal to the total importance of the collided and un￾collided neutrons during /t as shown in the diagram in Fig. 4.2. That is:
ϕ∗
(
r
−, E, y− , t
)
≡[1 − υ/tEt
(
r
−, E
)
] ϕ∗
(
r
− + υy− /t, E, y− , t + /t
)
+
|
υ/tEt
(
r
−, E
)|
Fig. 4.1 The change of importance during /t 102 4 The Adjoint Transport Equation—The Equation of Neutron Importance
Importance of 
neutrons at 
time t 
Prob. That a 
neutron will 
not collide in 
Importance of 
neutrons at 
time t+ 
Prob. of 
collision 
in 
Importance of 
neutrons expected to 
emerge from reactions 
= 
+ 
Fig. 4.2 The balance of neutron importance during /t 
×
⎡
⎢
⎣
{∞
0 
d E'
{
4π
dy'
Es
(
r
−, E → E'
, y− → y'
)
Et
(
r
−, E
) ϕ∗
(
r
−, E'
, y'
, t
)
⎤
⎥
⎦ +
|
υ/tEt
(
r
−, E
)|
×
⎡
⎢
⎣
{∞
0 
d E'
{
4π
dy'
ν(E)E f
(
r
−, E
)
χ
(
E → E'
)
4πEt
(
r
−, E
) ϕ∗
(
r
−, E'
, y'
, t
)
⎤
⎥
⎦ (4.6)
Simplifying the first term first 
ϕ∗(
r , E, Ω, t
)
≡ ϕ∗(
r + υΩ/t, E, Ω, t + /t
)
− υ /tΣt
(
r , E
)
ϕ∗(
r + υΩ/t, E, Ω, t + /t
)
Substituting from the chain rule of derivatives in the first term on the right-hand 
side 
ϕ∗(
r + dr , E, Ω, t + /t
)
= ϕ∗(
r, E, Ω, t
)
+ ∂ϕ∗
∂t
/t + ∇ · Ωϕ∗|
|dr|
| (4.7) 
where the second term on the right side is the partial change in importance due to 
time change and the third term is due to the position change. 
ϕ∗(
r, E, Ω, t
)
≡ ϕ∗(
r , E, Ω, t
)
+ ∂ϕ∗
∂t
/t + ∇ · Ωϕ∗|
|dr|
|
− υ /tΣt
(
r, E
)
|
ϕ∗(
r, E, Ω, t
)
+ ∂ϕ∗
∂t
/t + ∇ · Ωϕ∗|
|dr|
|
|
Subtracting ϕ∗(
r, E, Ω, t
)
from both sides and multiplying by 1 
υ /t = 1 
|dr|
, we 
get 
0 ≡ 1 
υ
∂ϕ∗
∂t 
+ ∇ · Ωφ∗ − Σt
(
r , E
)
ϕ∗(
r, E, Ω, t
)
− Σt
(
r, E
) ∂ϕ∗
∂t
/t4.2 Derivation of the Equation of Neutron Importance (The Adjoint Function) 103
+ ∇ · Ωϕ∗|
|dr|
|
The last two terms are too small (∂ϕ∗/t) and can be ignored, 
∇ · Ωϕ∗ = ∂ϕ∗
∂x i + ... and |
|dr|
| = υ /t, the last equation reduces to 
0 ≡ 1 
υ
∂ϕ∗
∂t 
+ ∇ · Ωϕ∗ − Σt
(
r, E
)
ϕ∗(
r , E, Ω, t
) (4.8) 
The above division 1 
υ /t = 1 
|dr| applies to other terms in Eq. (4.7) as well. Sub￾stituting (4.8) into (4.7) and Σt
(
r , E
)
is canceled out and knowing that the fission 
spectrum is independent from the initial energy χ
(
E → E'
)
= χ
(
E'
)
, we get 
− 1 
υ
∂ϕ∗
∂t = Ω.∇ϕ∗(
r, E, Ω, t
)
− Σt
(
r , E
)
ϕ∗(
r, E, Ω, t
)
+
{∞
0 
d E'
{
4π
dΩ'
Σs
(
r , E → E'
, Ω → Ω'
)
ϕ∗(
r , E'
, Ω'
, t
)
+
ν(E)Σ f
(
r, E
)
4π
{∞
0 
d E'
{
4π
dΩ'
χ
(
E'
)
ϕ∗(
r, E'
, Ω'
, t
) (4.9) 
This is the adjoint equation or the equation of neutron importance. Notice that 
the adjoint ϕ∗ represents the importance per neutron. Now compare to the forward 
neutron transport equation: 
+
1 
υ
∂ϕ
∂t = −Ω · ∇ϕ
(
r , E, Ω, t
)
− Σt
(
r, E, Ω)
ϕ
(
r , E, Ω, t
)
+
{∞
0 
d E'
{
4π
dΩ'
Σs
(
r , E' → E, Ω' → Ω)
ϕ
(
r , E'
, Ω'
, t
)
+ χ(E)
4π
{
4π
dΩ'
{∞
0 
d E'
ν
(
E'
)
Σ f
(
r, E'
)
ϕ
(
r , E'
, Ω'
, t
) (4.10) 
The time and space operators in the adjoint equation are both with a negative 
sign as if time is revered and motion in space is in the opposite direction. The 
energy transfer in scattering and fission is reversed (Fig. 4.3). As a consequence 
of characterizing the adjoint system as a reversable process, the neutron transport 
equation gained the name forward. The loss term via absorption and scattering out 
of the differential energy dE (the total reaction rate) is the same in both equations 
which makes it the only term which is self-adjoint.
An interesting interpretation of the adjoint flux ϕ∗(
r , E, Ω, t
)
—besides being 
the importance of a neutron at position r in dV and with energy E in dE and 
direction Ω in d Ω at time t—is through a time reversed neutron cycle such104 4 The Adjoint Transport Equation—The Equation of Neutron Importance
Fig. 4.3 Neutron scattering 
in both the forward and 
adjoint cases d d 
Forward 
adjoint 
that fast adjoint phantom causes fissions which yield k slow adjoint neutrons per 
fast neutron absorbed. These neutrons are moderated upward in energy until they 
become fast, then they cause more fissions yielding more slow adjoint phantom 
neutrons. 
Therefore, we have derived the adjoint operators making up the adjoint operator 
L∗. They are all not self-adjoint except the loss term operator. 
In the steady-state case Eq. 4.10 becomes 
0 = Ω · ∇ϕ∗(
r , E, Ω)
− Σt
(
r, E
)
ϕ∗(
r , E, Ω)
+
{∞
0 
d E'
{
4π
dΩ'
Σs
(
r, E → E'
, Ω → Ω'
)
ϕ∗(
r, E'
, Ω'
)
+
ν(E)Σ f
(
r, E
)
4π
{∞
0 
d E'
{
4π
dΩ'
χ
(
E'
)
ϕ∗(
r, E'
, Ω'
, t
) (4.11) 
and Eq. 4.11 becomes 
0 = −Ω · ∇ϕ
(
r , E, Ω)
− Σt
(
r, E, Ω)
ϕ
(
r , E, Ω)
+
{∞
0 
d E'
{
4π
dΩ'
ϕ
(
r, E'
, Ω'
)
Σs
(
r, E' → E, Ω' → Ω)
+ χ(E)
4π
{
4π
dΩ'
{∞
0 
d E'
ϕ
(
r, E'
, Ω'
)
ν
(
E'
)
Σ f
(
r, E'
) (4.12) 
So, the adjoint operator is written as 
L∗ϕ∗(
r , E, Ω)
= Ω · ∇ϕ∗(
r, E, Ω)
− Σt
(
r , E
)
ϕ∗(
r , E, Ω)
+
{∞
0 
d E'
{
4π
dΩ'
Σs
(
r , E → E'
, Ω → Ω'
)
ϕ∗(
r, E'
, Ω'
)
+
ν(E)Σ f
(
r , E
)
4π
{∞
0 
d E'
{
4π
dΩ'
χ
(
E'
)
ϕ∗(
r , E'
, Ω'
)4.2 Derivation of the Equation of Neutron Importance (The Adjoint Function) 105
Fig. 4.4 Boundary surface 
conditions for 
for 
And the forward operator in the steady state is 
Lϕ
(
r , E, Ω)
= −Ω · ∇ϕ
(
r , E, Ω)
− Σt
(
r , E, Ω)
ϕ
(
r , E, Ω)
+
{∞
0 
d E'
{
4π
dΩ'
Σs
(
r, E' → E, Ω' → Ω)
ϕ
(
r , E'
, Ω'
)
+ χ(E)
4π
{
4π
dΩ'
{∞
0 
d E'
ν
(
E'
)
Σ f
(
r, E'
)
ϕ
(
r , E'
, Ω'
)
4.2.2 Boundary Condition 
(i) ϕ∗(
r , E, Ω, t
) = 0 for n · Ω > 0 which means a zero importance for the 
lost outgoing neutrons. The motion outward is represented by n · Ω > 0 since 
n ·Ω = cos θ is positive > 0 and n is the out normal to the boundary surface 
(Fig. 4.4) [4]. 
(ii) Notice that the b.c. for the forward case ϕ
(
r, E, Ω, t
)
= 0 for n · Ω < 0 (zero 
incoming angular flux or the non-reentrant surface condition). 
4.2.3 Final and Initial Conditions 
The time operator is negative as if going backward in time, hence we use the 
final condition instead of the initial condition. 
ϕ∗(
r , E, Ω, t
)|
|
t=t f = ϕ∗(
r, E, Ω, t f
)
Which is the start point then by integrating backward in time to find the adjoint 
at earlier times. On the other hand, the initial condition for the forward case is 
ϕ
(
r , E, Ω, t
)|
|
t=t0 = ϕ
(
r, E, Ω, t0
)
Example Show that the streaming term operator L∗
st is the adjoint to Lst .106 4 The Adjoint Transport Equation—The Equation of Neutron Importance
We have derived that 
Lst ϕ
(
r , E, Ω)
= −Ω · ∇ϕ
(
r, E, Ω)
L∗
st ϕ∗(
r , E, Ω)
= Ω · ∇ϕ∗(
r , E, Ω)
therefore
(
ϕ∗, Lst ϕ
)
=
˚ ϕ∗(
r , E, Ω)(−Ω · ∇ϕ
(
r, E, Ω))dV d Edy
(
ϕ, L∗
st ϕ∗)
=
˚ ϕ
(
r , E, Ω)(Ω · ∇ϕ∗(
r , E, Ω))dV d Edy
In other words, we have to prove that the above should satisfy requirement (2): 
(ϕ∗, Lst ϕ) = (
ϕ, L∗
st ϕ∗)
or (ϕ∗, Lst ϕ) − (
ϕ, L∗
st ϕ∗)
= / = 0. 
Substituting from above and rearranging using (
Ω · ∇ϕ = ∇. Ωϕ
) and the 
adjoint Ω · ∇ϕ∗ = ∇ · Ωϕ∗, we have to show that / = 0
/ = −˚ ϕ∗(
∇.Ωϕ
)
+ ϕ
(
∇.Ωϕ∗)
dV d Edy
= −˚ ϕ∗(
Ω.∇ϕ
)
+ ϕ
(
Ω.∇ϕ∗)
dV d Edy
= −˚ (
Ωϕ∗.∇ϕ
)
+ (
Ωϕ.∇ϕ∗)
dV d Edy
Using the identity ( f g)
'
= f g' + g f '
, hence, accordingly 
∇.Ωϕϕ∗ = Ωϕ.∇ϕ∗ + ϕ∗∇.Ωϕ
= Ωϕ.∇ϕ∗ + ϕ∗Ω.∇ϕ
= Ωϕ.∇ϕ∗ + Ωϕ∗.∇ϕ
Therefore, we can substitute in the integrand by
/ = −˚ ∇. Ωϕϕ∗dV d Edy
where Ωϕ and ∇ϕ∗ are vectors and they are commutative. Using the divergence 
theorem to convert the volume integral into the surface integral
{
∇.ΩϕdV =
{
n.Ω>0 
n.ΩϕdS +
{
n.Ω>0 
n.ΩϕdS 
in spherical coordinates n.Ω > 0(cos θ+)and n.Ω < 0 (cos θ−), where n.Ω =
cosθ. Therefore, the integral covers up and down or right and left, i.e. inward and4.3 The Adjoint Neutron Diffusion Equation 107 
outward directions. n is the normal to the differential surface on the volume from 
which the neutron current passes. Applying the divergence theorem, we get
/ = −˚ ∇.Ωϕϕ∗dV d Edy = −˚ n.Ωϕϕ∗d Sd Edy
= − ¨ dEdy
⎧
⎪⎨
⎪⎩
{
n.Ω<0 
ϕ∗(
n.Ωϕ
)
dS +
{
n.Ω>0 
ϕ
(
n.Ωϕ∗)
dS 
⎫
⎪⎬
⎪⎭
The first term represents the inward current which is zero (b.c) and the sec￾ond term represents the outward importance equal to zero because it is lost (b.c). 
Therefore / = 0 which satisfies the requirement. 
The adjoint operator L∗ will not be self-adjoint even if only one term in the 
operator is not self-adjoint or even only the sign is opposite to the sign of the 
corresponding term. 
Now we are in the position to examine the adjoint equations to some familiar 
forms of the neutron transport equation. 
4.3 The Adjoint Neutron Diffusion Equation 
We recall the equations from Chap. 1 without going into details of their derivations. 
4.3.1 The Energy-Dependent Neutron Diffusion Equation (DE) 
− ∇ · D
(
r, E
)
∇φ
(
r, E
)
+ Σt
(
r, E
)
φ
(
r , E
)
−
{∞
0 
d E'
Σs
(
r , E' → E
)
φ
(
r, E'
)
− χ(E)
{∞
0 
d E'
v
(
E'
)
Σ f
(
r , E'
)
φ
(
r, E'
)
= 0 
(4.13) 
Ldi f f φ
(
r, E
)
= −∇ · D
(
r , E
)
∇φ
(
r, E
)
+ Σt
(
r , E
)
φ
(
r, E
)
−
{∞
0 
d E'
Σs
(
r , E' → E
)
φ
(
r , E'
)
− χ(E)
{∞
0 
d E'
v
(
E'
)
Σ f
(
r , E'
)
φ
(
r , E'
)108 4 The Adjoint Transport Equation—The Equation of Neutron Importance
where φ
(
r, E
) = ∫
4π
ϕ
(
r, E, Ω)
dΩ. By comparison with the transport equation 
(TE) we may deduce the adjoint operator for the (DE) such that 
1. The transfer terms’ scattering and fission are similar. 
2. The directional dependence is absent in the DE because it is based on the 
assumption of isotropic scattering and flux. 
3. The boundary conditions of the outgoing zero importance and the non-reentrant 
surface made the streaming term not self-adjoint in the TE. 
4. In the DE, the conditions in (3) are not applicable. 
Therefore, the streaming term is self-adjoint, hence we can write 
L∗
di f f φ∗(
r, E
)
= −∇ · D
(
r , E
)
∇φ∗(
r , E
)
+ Σt
(
r , E
)
φ∗(
r, E
)
−
{∞
0 
d E'
Σs
(
r , E → E'
)
φ∗(
r, E'
)
− v(E)Σ f
(
r , E
) {∞
0 
d E'
χ
(
E'
)
φ∗(
r, E'
)
4.3.2 The One-Speed Neutron Diffusion Equation 
Recall from Chap. 2 the one-speed (one-group) neutron diffusion equation 
−∇ · D
(
r
)
∇φ
(
r
)
+ Σa
(
r
)
φ
(
r
)
= vΣ f
(
r
)
φ
(
r
) (4.14) 
The operator form is 
L1speed φ
(
r
)
= −∇ · D
(
r
)
∇φ
(
r
)
+ Σa
(
r
)
φ
(
r
)
− vΣ f
(
r
)
φ
(
r
)
And the adjoint form can just be written down as 
L∗
1speed φ∗(
r
)
= −∇ · D
(
r
)
∇φ∗(
r
)
+ Σa
(
r
)
φ∗(
r
)
− vΣ f
(
r
)
φ∗(
r
)
Notice that the boundary condition applied to the transport equation at the left 
boundary ϕ
(
r 0, y)
= 0 for y > 0 and ϕ∗(
r 0, y)
= 0 for y < 0 or ϕ∗(
r 0, y)
= 0 
for y < 0 and ϕ∗(
r 0, y)
= 0 for y < 0. The unit vector y causes the streaming 
term in the TE to be of opposite sign. This is not the case in the diffusion theory 
where the flux is isotropic. Notice also j
(
r , y)
= yϕ
(
r, y)
and J
(
r
)
= yφ
(
r
)
are both vectors and ϕ
(
r, y)
and φ
(
r
)
are both scalars. The boundary conditions 
to the DE are 
J−
(
rs , E
)
= 0 and J ∗
+
(
rs , E
)
= 04.3 The Adjoint Neutron Diffusion Equation 109
Proof Applying requirement II to DE and its adjoint:
(
φ∗, −∇ · D∇φ + Σaφ − vΣ f φ
)
− (
φ, −∇ · D∇φ∗ + Σaφ∗ − vΣ f φ∗)
The absorption and fission terms are clearly self-adjoint and no need to show 
the proof. We prove only the streaming term:
{
−φ∗∇ · D∇φ +
{
φ∇ · D∇φ∗
Integration by parts for the two integrals, first integral is 
u = −φ∗; dv = ∇ · D∇φ
du = −∇φ∗; v = D∇φ
Apply the identity ∫ −φ∗∇ · D∇φ = uv−∫ vdu = −φ∗D∇φ +∫ D∇φ∇φ∗dV 
−φ∗D∇φ + φ∗D∇φ = 0 
and the second integral is likewise. Therefore, the streaming term is self-adjoint 
and hence the one-speed diffusion equation. 
4.3.3 The Multi-Group Neutron Diffusion Equation 
The steady-state multi-group DE with no up-scattering 
− ∇ · Dg
(
r
)
∇φg
(
r
)
+ ΣRg(
r
)
φg
(
r
)
= 1 
k 
χg
EG 
g'
=1 
νg'E f g'
(
r
)
φg'
(
r
)
+ E
G
g'
/=g;g'
>g
Esg'g
(
r
)
φg'
(
r
)
, g = 1, 2, 3, ··· , G 
where
ERg = Etg − Esgg = Eag + Esg − Esgg = Eag + E
G
g'
=1
Esgg'
(
r
)
− Esgg 
In a matrix form: 
A8 = 1 
k 
F8 
where A and F and 8 are given explicitly as110 4 The Adjoint Transport Equation—The Equation of Neutron Importance
A =
⎡
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎣
−∇ · D1∇ + ER1 0 0 ... 0 
−Es12 −∇ · D2∇ + ER2 0 ... 0 
−Es13 −Es23 −∇ · D3∇ + ER3 ... 0 
.
.
.
.
.
.
.
.
. .
.
. .
.
.
−Es1G −Es2G −Es3G ... −∇ · DG ∇ + ERG 
⎤
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎦
F =
⎡
⎢
⎢
⎢
⎢
⎢
⎣
χ1v1E f 1 χ1v2E f 2 χ1v3E f 3 ··· χ1vGE fG 
χ2v1E f 1 χ2v2E f 2 χ2v3E f 3 ··· χ2vGE fG 
χ3v1E f 1 χ3v2E f 2 χ3v3E f 3 ··· χ3vGE fG 
.
.
. .
.
. .
.
. ... .
.
.
χG v1E f 1 χG v2E f 2 χG v3E f 3 ··· χG vGE fG 
⎤
⎥
⎥
⎥
⎥
⎥
⎦
; o =
⎡
⎢
⎢
⎢
⎢
⎢
⎣
φ1 
φ2 
φ3 
.
.
.
φG 
⎤
⎥
⎥
⎥
⎥
⎥
⎦
Reversing the energy transfer terms, we can readily obtain the adjoint form 
− ∇ · Dg
(
r
)
∇φ∗
g
(
r
)
+ ΣRg(
r
)
φ∗
g
(
r
)
= 1 
k 
νgE f g(
r
)EG 
g'
=1 χg'φ∗
g'
(
r
)
+ E
G
g/=g'
;g>g'
Esgg'
(
r
)
φ∗
g'
(
r
)
, g = 1, 2, 3, ··· , G 
And the matrix form is (notice the same eigenvalue) 
A∗o∗ = 1 
k 
F∗o∗
where A∗ and F∗ are just the transpose of the matrices A and F, respectively, 
and o∗ /= 8, thus 
A∗ =
⎡
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎣
−∇.D1∇ + ER1 −Es12 −Es13 ··· −Es1G 
0 −∇.D2∇ + ER2 −Es23 ··· −Es2G 
0 0 −∇.D3∇ + ER3 ··· −Es3G 
.
.
.
.
.
.
.
.
. .
.
. .
.
.
000 ... −∇.DG ∇ + ERG 
⎤
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎦
F∗ =
⎡
⎢
⎢
⎢
⎢
⎢
⎣
χ1v1E f 1 χ2v1E f 1 χ3v1E f 1 ··· χG v1E f 1 
χ1v2E f 2 χ2v2E f 2 χ3v2E f 2 ··· χG v2E f 2 
χ1v3E f 3 χ2v3E f 3 χ3v3E f 3 ··· χG v3E f 3 
.
.
. .
.
. .
.
. ... .
.
.
χ1vGE fG χ2vGE fG χ3vGE fG ··· χG vGE fG 
⎤
⎥
⎥
⎥
⎥
⎥
⎦
; o∗ =
⎡
⎢
⎢
⎢
⎢
⎢
⎣
φ∗
1 
φ∗
2 
φ∗
3 
.
.
.
φ∗
G 
⎤
⎥
⎥
⎥
⎥
⎥
⎦4.4 The Adjoint One-Speed P1 Equations 111 
4.3.4 The Two-Group Neutron Diffusion Equation 
The matrix form is straightforward from the multi-group DE and its adjoint. The 
forward equation is
|
−∇.D1∇ + ER1 0 
−Es12 −∇.D2∇ + ER2
|| φ1 
φ2
|
= 1 
k
|
χ1ν1E f 1 χ1ν2E f 2 
χ2ν1E f 1 χ2ν2E f 2
|| φ1 
φ2
|
And the adjoint equation is
|
−∇.D1∇ + ER1 −Es12 
0 −∇.D2∇ + ER2
|| φ∗
1 
φ∗
2
|
= 1 
k
|
χ1ν1E f 1 χ2ν1E f 1 
χ1ν2E f 2 χ2ν2E f 2
|| φ∗
1 
φ∗
2
|
Most of the fission neutrons are born in the fast energy range, therefore χ1 =
1 and χ2 = 0. Also, from the definition of the removal of x-section ER1 =
Ea1 + Es12 and ER2 = Ea2 + Es21, however, Es21 = 0 because we have ignored 
up-scattering, therefore ER2 = Ea2 and we can rewrite the equations again
|
−∇.D1∇ + ER1 0 
−Es12 −∇.D2∇ + Ea2
|| φ1 
φ2
|
= 1 
k
|
ν1E f 1 ν2E f 2 
0 0 || φ1 
φ2
|
|
−∇.D1∇ + ER1 −Es12 
0 −∇.D2∇ + Ea2
|| φ∗
1 
φ∗
2
|
= 1 
k
|
ν1E f 1 0 
ν2E f 2 0
|| φ∗
1 
φ∗
2
|
Calculation of fluxes and adjoints can be performed using either deterministic 
methods or Monte Carlo methods through well known codes. One can use a one￾dimensional or two-dimensional code such as ONED or 2DB to obtain fluxes and 
adjoints of a reflected core and plot them to see the major differences between 
them. Referring to Fig. 4.5, we firstly notice the differences between fast and 
thermal fluxes, especially at the reflector peak and the higher fast flux in the core. 
Secondly, the differences between the fast and thermal adjoints where the adjoint 
of thermal neutrons is higher than the adjoint of fast neutrons indicating higher 
importance since it is more likely to induce fission as we have discussed earlier 
[5, 6, 7].
4.4 The Adjoint One-Speed P1 Equations 
∇ · J
(
r
)
+ (Σt − Σs )φ
(
r
)
= S0
(
r
)
1 
3 
∇φ
(
r
)
+ (Σt − μ0Σs )J
(
r
)
= S1
(
r
)112 4 The Adjoint Transport Equation—The Equation of Neutron Importance
0.000 
0.002 
0.004 
0.006 
0.008 
0.010 
0.012 
0.015 
0.020 
0.025 
0.030 
0.035 
0 4 8 12 16 Thermal flux 
fast flux and therm al & fast adjoints 
hight (cm) 
Fast flux Fast Adjoint Thermal Adjoint Thermal flux 
Fig. 4.5 Relative two-group flux and adjoint for the Tajoura Nuclear Research Center Research 
Reactor (TNRCRR)
which reduces to 
∇ · J
(
r
)
+ Σaφ
(
r
)
= S
(
r
) (4.15) 
1 
3
∇φ
(
r
)
+ Σtr J
(
r
)
= S1
(
r
) (4.16) 
They satisfy the boundary condition (from Chap. 3) 
J (0) = −φ(0)
2 ; J (a) = φ(a)
2 
or 
n.J = φ
2 
We can use the zero reentrant partial current boundary condition (J− = 0) and 
zero outgoing adjoint (J ∗
+ = 0) since the partial currents are angle integrated so 
we arrive at the adjoint form of Eq. 4.15 and Eq. 4.16 as 
−∇ · J ∗(
r
)
+ Σaφ∗(
r
)
= S∗(
r
) (4.17)113 
−1 
3
∇φ∗(
r
)
+ Σtr J ∗(
r
)
= S∗
1
(
r
) (4.18) 
They satisfy the boundary condition 
J ∗(0) = +φ∗(0)
2 ; J ∗(a) = −φ∗(a)
2 
and n.J ∗ = −φ∗
2 
Proof Use requirement (2) and the following steps: (i) assume isotropic sources 
(S1 = 0) and (S = 0); (ii) multiply Eq. 4.15 by φ∗ and Eq. 4.16 by J ∗; (iii) multiply 
(4.17) by φ and (4.18) by (J ); (iv) subtract iii from ii; and (v) add the resulting 
equations. Prove that / = 0. 
Steps (i), (ii), (iii) 
φ∗|
∇ · J
(
r
)
+ Σaφ
(
r
)|; J ∗|
∇φ
(
r
)
+ 3Σtr J
(
r
)|
and 
φ
|
−∇ · J ∗(
r
)
+ Σaφ∗(
r
)|; J
|
−∇φ∗(
r
)
+ 3Σtr J ∗(
r
)|
Subtract 
φ∗|
∇ · J
(
r
)
+ Σaφ
(
r
)| − φ
|
−∇ · J ∗(
r
)
+ Σaφ∗(
r
)|
J ∗|
∇φ
(
r
)
+ 3Σtr J
(
r
)| − J
|
−∇φ∗(
r
)
+ 3Σtr J ∗(
r
)|
Add the two equations
{
φ∗[∇ · J ] + J ∗[∇φ] + φ
|
∇ · J ∗|
+ J
|
∇φ∗|
dV 
=
{
∇ · [φ∗ J ]+∇·[φJ ∗]dV 
=
{
∇ · [φ∗ J ]+∇·[φJ ∗]dV 
Using the divergence theorem
{
∇ · [φ∗ J ]+∇·[φJ ∗]dV =
{ |(n · J
)
φ∗ + (
n · J ∗)
φ
|
dS 
Using the boundary conditions above
{ |
φφ∗
2 − φ∗φ
2
|
dS = 0114 4 The Adjoint Transport Equation—The Equation of Neutron Importance
4.5 Derivation of the Kinetic Parameters 
4.5.1 Transport Model 
In this section, we establish the methodology for a generic definition of the kinetic 
parameters used in the kinetic equations by weighing such parameters on the 
adjoint (importance function). The kinetic parameters are going to be derived 
from the neutron transport and the adjoint equations [8]. The transport equation is 
written explicitly for the prompt and delayed neutrons as (see Chap. 1) 
1 
υ
∂ϕ
∂t = −Ω · ∇ϕ
(
r , E, Ω, t
)
− Σt
(
r , E, Ω)
ϕ
(
r , E, Ω, t
)
+
{∞
0 
d E'
{
4π
dΩ'
Σs
(
r, E' → E, Ω' → Ω)
ϕ
(
r, E'
, Ω'
, t
)
+ (1 − β)χ(E) ×
{
4π
dΩ'
{∞
0 
d E'
ν
(
E'
)
Σ f
(
r, E'
)
ϕ
(
r , E'
, Ω'
, t
)
+E
6
i=1 
λi Ci
(
r, t
)
χi (E) (4.19) 
The last term is the number of delayed neutrons produced from precursor 
decay and the preceding term represents the prompt fission neutrons. The familiar 
precursor equation from previous knowledge of reactor kinetics is 
∂
∂t 
Ci
(
r , t
)
=
{
4π
dΩ'
{
d E'
βi v
(
E'
)
Σ f
(
r, E'
)
ϕ
(
r, E'
, Ω'
, t
)
− λi Ci
(
r , t
)
(4.20) 
The adjoint equation for a critical unperturbed reference reactor can be written 
in analogy to the above transport Eq. 4.19 as 
− Ω · ∇ϕ∗
0
(
r , E, Ω)
+ Σt
(
r , E
)
ϕ∗
0
(
r , E, Ω)
−
{∞
0 
d E'
{
4π
dΩ'
Σs
(
r, E → E'
, Ω → Ω'
)
ϕ∗
0
(
r, E'
, Ω'
)
= 1 
k 
ν(E)Σ f
(
r , E
) {∞
0 
d E'
|
(1 − β)χ
(
E'
)
+
E
6
i=1 
βi χi
(
E'
) {
dΩ'
ϕ∗
0
(
r , E'
, Ω'
)
|
(4.21)4.5 Derivation of the Kinetic Parameters 115
The overall system is subject to the boundary conditions discussed before. The 
derivation proceeds as follows: 
Equation 4.19 is multiplied by ϕ∗
0
(
r, E, Ω) and integrated over r, E, Ω and 
Eq. 4.21 is multiplied by ϕ
(
r , E, Ω, t
)
and integrated over r , E, Ω then the two 
are subtracted giving 
∂
∂t
{ ϕ∗
0 ϕ
υ dV d Edy = − {
Ω · ∇(
ϕ∗
0 ϕ
)
dV d Edy
+
k − 1 
k
{ { d E'
dΩ'
ϕ∗
0
(
r , E'
, Ω'
)|X'
|
×
˚ ν(E)Σ f
(
r, E
)
ϕ
(
r, E, Ω, t
)
dV d Edy
−
{
4π
dΩ'
{∞
0 
d E'
ϕ∗
0
(
r, E'
, Ω'
)
|
E
6
i=1 
βi χi
(
E'
)
|
×
˚ ν(E)Σ f
(
r , E
)
ϕ
(
r , E, Ω, t
)
dV d Edy
+E
6
i=1 
λi
{
ϕ∗
0
(
r, E, Ω)
Ci
(
r , t
)
χi (E)dV d Edy (4.22) 
where X' =
|
(1 − β)χ
(
E'
)
+ E
6
i=1 
βi χi
(
E'
)
|
.
The total reaction rate terms will cancel each other by subtraction and the scat￾tering terms are like so since integration over E and E' will remove the difference 
between the two terms and the direction of energy transfer wouldn’t matter. The 
boundary conditions on the exterior of the reactor volume, i.e. ϕ
(
rs , E, Ω, t
)
= 0 
for n · Ω < 0 and ϕ∗(
rs , E, Ω, t
)
= 0 for n · Ω > 0 can be applied if the inte￾gration over r extends to include the whole reactor core. As a result, the steaming 
term will disappear.
{
Ω · ∇(
ϕ∗
0 ϕ
)
dV d Edy =
{
Ω ·
(
ϕ∇ϕ∗
0 + ϕ∗
0∇ϕ
)
dV d Edy = 0 (4.23) 
where we have used the identity ∇
(
ϕ∗
0 ϕ
)
= ϕ∇
(
ϕ∗
0
)
+ ϕ∗
0∇(ϕ). 
However, if this integration is limited to a subregion of the reactor as in the 
case of core and reflector regions, there is no reason for this term to disappear. 
For example, at the core–reflector interface, a fraction of neutrons leaving the core 
will re-enter the core at a later time, hence their importance is non-zero. 
The shape function: 
The angular flux is separated into an amplitude factor and a shape function: 
ϕ
(
r , E, Ω, t
)
= n(t)ψ
(
r, E, Ω, t
) (4.24)116 4 The Adjoint Transport Equation—The Equation of Neutron Importance
For the following cases, where the point reactor model is accurate, hence, the 
shape function is not strongly varying function with time and it can be calculated 
using eigenvalue calculations: 
1 The transients have died out. 
2 The reactor is not anywhere near or above prompt critical. 
3 The reactor is near critical and the perturbations are small. 
Hence, we can write 
ψ
(
r, E, Ω, t
) ∼= ψ
(
r , E, Ω) (4.25) 
4.5.2 One-Node Model 
The core and reflector are considered as one node; therefore, the integration is over 
the reactor volume. First, we examine the left side of Eq. 4.22 by substituting for 
the flux in Eq. 4.24 
∂
∂t
{ ϕ∗
0 ϕ
υ dV d Edy = ∂
∂t
{ n(t)ψϕ∗
0 
υ dV d Edy
= ∂n 
∂t
{ ψϕ∗
0 
υ dV d Edy + n(t)
∂
∂t
{ ψϕ∗
0 
υ dV d Edy
Using the approximation in Eq. 4.25, the integration in the last term in the 
substitution above is constant with time and hence the derivative is zero 
∂
∂t
{ ϕ∗
0 ϕ
υ dV d Edy = ∂n 
∂t
{ ψϕ∗
0 
υ dV d Edy
Substituting in Eq. 4.22 and dividing the equation by ∫ ψϕ∗
0 
υ dV d Edy and using 
Eq. 4.23 and defining dξ = dV d Edy, we get 
∂n 
∂t = k − 1 
k n(t)
{ { d E'
dΩ'
ϕ∗
0
(
r , E'
, Ω'
)|X'
|˝ ν(E)Σ f
(
r , E
)
ψ
(
r , E, Ω)
dξ
{ ψϕ∗
0 
υ dξ
− n(t)
{
4π dΩ'
{ ∞
0 d E'
ϕ∗
0
(
r , E'
, Ω'
)|E6 
i=1 βi χi
(
E'
)|˝ ν(E)Σ f
(
r , E
)
ψ
(
r , E, Ω)
dξ
{ ψϕ∗
0 
υ dξ
+
E6 
i=1 λi
{ ϕ∗
0
(
r , E, Ω)
Ci
(
r , t
)
χi (E)dξ
{ ψϕ∗
0 
υ dξ
(4.26) 
From (4.26), we can designate ρ = k−1 
k and 
1
/ =
{ { d E'
dΩ'
ϕ∗
0
(
r , E'
, Ω'
)|X'
|˝ ν(E)Σ f
(
r , E
)
ψ
(
r , E, Ω)
dξ
{ ψϕ∗
0 
υ dξ4.5 Derivation of the Kinetic Parameters 117
βef f
/ =
{
4π dΩ'
{ ∞
0 d E'
ϕ∗
0
(
r , E'
, Ω'
)|E6 
i=1 βi χi
(
E'
)|˝ ν(E)Σ f
(
r , E
)
ψ
(
r , E, Ω)
dξ
{ ψϕ∗
0 
υ dξ
ci (t) =
{ ϕ∗
0
(
r , E, Ω)
Ci
(
r , t
)
χi (E)dξ
{ ψϕ∗
0 
υ dξ
The precursor Eq. 4.20 is also multiplied by ϕ∗
0
(
r , E, Ω)
χi (E) and integrated 
over all variables and divided by ∫ ψϕ∗
0 
υ dV d Edy, and we obtain 
∂
∂t
{ ϕ∗
0
(
r, E, Ω)
χi (E)Ci
(
r , t
)
dξ
{ ψϕ∗
0 
υ dξ
= n(t)
∫ ϕ∗
0
(
r, E, Ω)
βi χi (E)dξ
{
4π dΩ'
{ d E'
ν
(
E'
)
Σ f
(
r, E'
)
ψ
(
r, E'
, Ω'
)
{ ψϕ∗
0 
υ dξ
− λi
{ ϕ∗
0
(
r , E, Ω)
χi (E)Ci
(
r , t
)
dξ
{ ψϕ∗
0 
υ dξ
(4.27) 
where we define
(βi
/
)
ef f 
=
{
4π dΩ'
{ d E'
ϕ∗
0
(
r , E'
, Ω'
)
βi χi
(
E'
)˝ v(E)Σ f
(
r, E
)
ψ
(
r , E, Ω)
dξ
{ ψϕ∗
0 
υ dξ
Rewriting Eqs. 4.26 and 4.27 using the notations defined above and collecting 
terms, we obtain the single node or point kinetic equation 
∂n 
∂t = ρ − βef f
/ n(t) +E
6
i=1 
λi ci
(
r , t
)
∂ci
(
r, t
)
∂t =
(βi
/
)
ef f 
n(t) − λi ci
(
r, t
) (4.28) 
4.5.3 Diffusion Model 
From part A above in the section on the diffusion equation, the non-steady-state 
form is 
1 
υ
∂φ
∂t 
= ∇ · D
(
r , E
)
∇φ
(
r, E
)
− Σt
(
r, E
)
φ
(
r , E
)
+
{∞
0 
d E'
Σs
(
r, E' → E
)
φ
(
r , E'
)118 4 The Adjoint Transport Equation—The Equation of Neutron Importance
+ χ(E)
k {∞
0 
d E'
ν
(
E'
)
Σ f
(
r , E'
)
φ
(
r, E'
)
And the adjoint diffusion equation for a critical reference reactor is 
0 = ∇ · D
(
r , E
)
∇φ∗
0
(
r , E
)
− Σt
(
r, E
)
φ∗
0
(
r, E
)
+
{∞
0 
d E'
Σs
(
r , E → E'
)
φ∗
0
(
r , E'
)
+ ν(E)Σ f
(
r , E
) {∞
0 
d E'
χ
(
E'
)
φ∗
0
(
r, E'
)
We follow the same derivation steps performed based on the transport equation: 
∂
∂t
{ φ∗
0 φ
υ dV d E =
{ |
φ∗
0
(
r , E
)
∇ · D∇φ
(
r , E
)|dV d E 
−
{ |
φ
(
r , E
)
∇ · D∇φ∗
0
(
r , E
)|dV d E 
+
k − 1 
k
{ { d E'
φ∗
0
(
r , E'
)|X'
|˚ ν(E)Σ f
(
r , E
)
φ
(
r, E, t
)
dV d E 
−
{∞
0 
d E'
φ∗
0
(
r , E'
)
|
E6
i=1 
βi χi
(
E'
)
|˚ v(E)Σ f
(
r , E
)
φ
(
r , E, t
)
dV d E 
+E6
i=1 
λi
{
φ∗
0
(
r , E
)
Ci
(
r , t
)
χi (E)dV d E 
Integrating by parts the first two terms on the right-hand side following the same 
steps in the proof of the one-speed diffusion equation being self-adjoint leads to 
φ∗D∇φ−φ∗D∇φ = 0. The second term is also zero likewise. The above equation 
becomes 
∂
∂t
{ φ∗
0 φ
υ dV d E 
= k − 1 
k
{ { d E'
φ∗
0
(
r, E'
)|X'
|˚ ν(E)Σ f
(
r, E
)
φ
(
r , E, t
)
dV d E 
−
{∞
0 
d E'
φ∗
0
(
r , E'
)
|
E
6
i=1 
βi χi
(
E'
)
|˚ ν(E)Σ f
(
r, E
)
φ
(
r, E, t
)
dV d E 
+E
6
i=1 
λi
{
φ∗
0
(
r, E
)
Ci
(
r , t
)
χi (E)dV d E4.5 Derivation of the Kinetic Parameters 119
We finally obtain the kinetic parameters based on the diffusion theory: 
ρ = k − 1 
k 
1
/ =
{ { d E'
φ∗
0
(
r , E'
)|X'
| {{{ ν(E)Σ f
(
r, E
)
ψ
(
r, E
)
dV d E
{ ψφ∗
0 
υ dV d E 
βef f
/ =
{ ∞
0 d E'
φ∗
0
(
r, E'
)|E6 
i=1 βi χi
(
E'
)| {{{ ν(E)Σ f
(
r , E
)
ψ
(
r , E
)
dV d E
{ ψφ∗
0 
υ dV d E 
ci (t) =
{ φ∗
0
(
r , E
)
Ci
(
r, t
)
χi (E)dV d E
{ ψφ∗
0 
υ dV d E 
where we define
(βi
/
)
ef f 
=
{ d E'
φ∗
0
(
r, E'
)
βi χi
(
E'
) {{{ ν(E)Σ f
(
r , E
)
ψ
(
r , E
)
dV d E
{ ψφ∗
0 
υ dV d E 
3 Two-dimensional multi-group form for the diffusion model 
We can further obtain the multi-group form of the kinetic parameters for a 
two-dimensional reactor 
1
/ =
EN 
i=1
EM 
j=1
EG 
g'
=1 X'
g'φ∗ i,j 
0 g' /g'
EG 
g=1 νgEi,j 
fg ψi ,j 
g /g/i/j
EN 
i=1
EM 
j=1
EG 
g=1 
1 
υg φ∗ i,j 
0 g ψi,j 
g /g/i/j 
and X'
g' =
|
(1 − β)χg' + E
6
i=1 
βi χg'
i
|
. 
βef f
/ =
EN 
i=1
EM 
j=1
EG 
g'
=1 φ∗ i,j 
0 g' /g'
E6 
i=1 βi χg'
i
EG 
g=1 νgEi,j 
fg ψi ,j 
g /g/i/j
EN 
i=1
EM 
j=1
EG 
g=1 
1 
υg φ∗ i,j 
0 g ψi,j 
g /g/i/j 
ci=1,6(t) =
EN 
i=1
EM 
j=1
EG 
g=1 φ∗ i ,j 
0 g Ci,j 
i=1,6(t)χg 
i=1,6/g/i/j
EN 
i=1
EM 
j=1
EG 
g=1 
1 
υg φ∗ i,j 
0 g ψi ,j 
g /g/i/j
(βi
/
)
ef f 
=
EN 
i=1
EM 
j=1
EG 
g'
=1 φ∗ i ,j 
0 g' βi=1,6χg'
i=1,6/g'
EG 
g=1 νgEi ,j 
fg ψi,j 
g /g/i/j
EN 
i=1
EM 
j=1
EG 
g=1 
1 
υg φ∗ i,j 
0 g ψi,j 
g /g/i/j 
So far, we have derived the kinetic equations and the kinetic parameters asso￾ciated with it. The kinetic parameters are calculated from forward and adjoint 
transport or diffusion codes. More nodes such as two nodes for the core and reflec￾tor can be considered or two core nodes in what is known as the coupled reactor 
kinetics model, especially for certain reactor core types.120 4 The Adjoint Transport Equation—The Equation of Neutron Importance
4.5.4 Two-Node Model 
In the one-node model, the spatial effects are ignored though the reactor which 
is large in size where any disturbances at a given point are not felt further away 
in another point until later. Therefore, multi-nodes are more representative to the 
spatial effects; however, we will limit ourselves to a two-node model one for the 
core and one for the reflector. 
Example: A two-node reactor 
The reactor is to be divided into two nodes: core node and a reflector node 
(Fig. 4.6). The integrals over the core and reflector are expressed, respectively, 
as ∫
c 
= ∫
core 
dV d Edy and ∫
r 
= ∫
re f lector 
dV d Edy. Dealing with the integration 
over the core first; Eq. 4.26 becomes 
∂
∂t
{
c 
ϕ∗
0 ϕ
υ dV d Edy = − {
c 
Ω · ∇(
ϕ∗
0 ϕ
)
dV d Edy
+
k − 1 
k ˚ 
c 
d E'
dΩ'
ϕ∗
0
(
r, E'
, Ω'
)|X'
| {{{ ν(E)Σ f
(
r , E
)
ϕ
(
r , E, Ω, t
)
dV d Edy
−
{
c
{
4π
dΩ'
{∞
0 
d E'
ϕ∗
0
(
r , E'
, Ω'
)
|
E6
i=1 
βi χi
(
E'
)
| {{{ ν(E)Σ f
(
r , E
)
ϕ
(
r , E, Ω, t
)
dV d Edy
+E6
i=1 
λi
{
c 
ϕ∗
0
(
r , E, Ω)
Ci
(
r , t
)
χi (E)dV d Edy
Now we follow the same procedure as before in the one-node model by sub￾stituting with the shape function and dividing throughout by ∫
c 
ψφ∗
0 
υ dV d Edy. 
However, the streaming term will not disappear since the core is bounded by the 
reflector and in the previous argument 22 for a void boundary is not valid for this 
case, therefore we get
∂nc 
∂t = −nc(t)
{
S
{
n.y>0
|
|n · y
|
|
(
ϕ∗
0 ψ
)
d Sd Edy
{
c 
ψϕ∗
0 
υ dξ
+ nc(t)
{
S
{
n.y<0
|
|n · y
|
|
(
ϕ∗
0 ψ
)
d Sd Edy
{
c 
ψϕ∗
0 
υ dξ
Fig. 4.6 Two-node model 
core reflector void 
C4.5 Derivation of the Kinetic Parameters 121
+
k − 1 
k nc(t)
{
c
{ { d E'
dΩ'
ϕ∗
0
(
r , E'
, Ω'
)|X'
| {{{ ν(E)Σ f
(
r , E
)
ψ
(
r , E, Ω)
dξ
{
c 
ψϕ∗
0 
υ dξ
− nc(t)
{
c
{
4π dΩ'
{ ∞
0 d E'
ϕ∗
0
(
r , E'
, Ω'
)|E6 
i=1 βi χi
(
E'
)|˝ ν(E)Σ f
(
r , E
)
ψ
(
r , E, Ω)
dξ
{
c 
ψϕ∗
0 
υ dξ
+
E6 
i=1 λi
{
c ϕ∗
0
(
r , E, Ω)
Ci
(
r , t
)
χi (E)dV d Edy
{
c 
ψϕ∗
0 
υ dξ
(4.29)
where S is the surface of the core region and the coefficients except the two stream￾ing terms to the right and left are defined as before. The continuity of the partial 
currents at the interface is given by 
J c
+
(
rs , E
)
= Jr
+
(
rs , E
)
J c
−
(
rs , E
)
= Jr
−
(
rs , E
)
where rs is at the core-reflector interface. The condition of continuity can be 
expressed using the definition of the partial currents 
nc(t)
{
S
{
n.y>0
|
|n · y
|
|
(
φ∗
0 ψ
)
d Sd Edy
= nr (t)
{
S
{
n.y<0
|
|n · y
|
|
(
φ∗
0 ψ
)
d Sd Edy
nc(t)
{
S
{
n.y<0
|
|n · y
|
|
(
φ∗
0 ψ
)
d Sd Edy
= nr (t)
{
S
{
n.y<0
|
|n · y
|
|
(
φ∗
0 ψ
)
d Sd Edy
The equation for the reflector can be written as 
∂nr 
∂t = nc(t)
{
S
{
n.y>0
|
|n · y
|
|
(
ϕ∗
0 ψ
)
d Sd Edy
{
r 
ψϕ∗
0 
υ dV d Edy
− nr (t)
{
S
{
n.y<0
|
|n · y
|
|
(
ϕ∗
0 ψ
)
d Sd Edy
{
r 
ψϕ∗
0 
υ dV d Edy
(4.30) 
where we have defined the flux in the core 
ϕ
(
r , E, Ω, t
) ∼= nc(t)ψ
(
r, E, Ω)122 4 The Adjoint Transport Equation—The Equation of Neutron Importance
And the flux in the reflector is 
ϕ
(
r, E, Ω, t
) ∼= nr (t)ψ
(
r , E, Ω)
both with the same shape function. 
If the above equation is multiplied by
{
r 
ψϕ∗
0 
υ dV d Edy
{
c 
ψϕ∗
0 
υ dV d Edy
and redefining nr (t) as 
nr (t) ← nr (t)
{
r 
ψϕ∗
0 
υ dV d Edy
{
c 
ψϕ∗
0 
υ dV d Edy
Equation 4.28 becomes 
∂nr 
∂t = nc(t)
{
S
{
n.y>0
|
|n · y
|
|
(
ϕ∗
0 ψ
)
d Sd Edy
{
c 
ψϕ∗
0 
υ dV d Edy
− nr (t)
{
S
{
n.y<0
|
|n · y
|
|
(
ϕ∗
0 ψ
)
d Sd Edy
{
r 
ψϕ∗
0 
υ dV d Edy
(4.31) 
Then we will be able to define 
βr
/ =
{
S
{
n.y>0
|
|n · y
|
|
(
ϕ∗
0 ψ
)
d Sd Edy
{
c 
ψϕ∗
0 
υ dV d Edy
λr =
{
S
{
n.y<0
|
|n · y
|
|
(
ϕ∗
0 ψ
)
d Sd Edy
{
r 
ψϕ∗
0 
υ dV d Edy
and (4.29) and (4.31) become 
∂nc 
∂t = ρ − βef f
/ nc(t) +E
6
i=1 
λi ci
(
r, t
)
− βr
/ nc(t) + λr nr (t)
∂ci
(
r , t
)
∂t =
(βi
/
)
ef f 
nc(t) − λi ci
(
r , t
)
∂nr 
∂t = βr
/ nc(t) − λr nr (t) (4.32) 
The system of Eqs. 4.32 is a two-node or two-point reactor kinetic equations 
with the added parameters representing the delayed neutrons traveling back from4.5 Derivation of the Kinetic Parameters 123
the reflector. This effect will appear at the tail of the transfer function. βr
/ and λr 
can be calculated from the partial currents obtained from diffusion or transport 
calculation. It can also be extended to a multi-node arrangement [8]. 
Exercises 
1 Prove that the forward and adjoint operators of the total loss Lt , L∗
t ; scattering 
Ls , L∗
s ; and fission L f , L∗
f terms satisfy the requirement 2 and hence they have 
true adjoints as defined from Eqs. 4.12 and 4.13 as 
Lt ϕ
(
r , E, Ω)
= −Σt
(
r , E, Ω)
ϕ
(
r, E, Ω)
L∗
t ϕ∗(
r , E, Ω)
= −Σt
(
r, E
)
ϕ∗(
r, E, Ω)
Ls ϕ
(
r , E, Ω)
=
{∞
0 
d E'
{
4π
dΩ'
Σs
(
r, E' → E, Ω' → Ω)
ϕ
(
r , E'
, Ω'
)
L∗
s ϕ∗(
r , E, Ω)
=
{∞
0 
d E'
{
4π
dΩ'
Σs
(
r , E → E'
, Ω → Ω'
)
ϕ∗(
r , E'
, Ω'
)
L f ϕ
(
r , E, Ω)
= χ(E)
4π
{
4π
dΩ'
{∞
0 
d E'
ν
(
E'
)
Σ f
(
r, E'
)
ϕ
(
r , E'
, Ω'
)
L∗
f ϕ∗(
r , E, Ω)
= ν(E)Σ f
(
r , E
)
4π
{∞
0 
d E'
{
4π
dΩ'
χ
(
E'
)
ϕ∗(
r, E'
, Ω'
)
2 Examine the adjoint of the time-dependent DE by proving / = 0. 
(a) Modify the code ONED to obtain its adjoint version ONEDA using the adjoint 
version of the two-group one-dimensional neutron diffusion equation. 
(b) Run a test problem, e.g. a PWR using both codes. One way to be certain about 
the correctness of the modification is to check if the eigenvalues in both runs 
are identical. This is much easier than writing a computer program identical 
to the ONED code for the adjoint two-group one-dimensional slab, cylinder, 
and sphere with 10 heterogenous regions. 
(c) Write the kinetic parameters in a numerically integrated form based on two￾group one-dimensional diffusion theory for the particular geometry of the test 
problem. 
(d) Use the results of the two group fluxes and adjoints and the rest of the core 
data to calculate the kinetic parameters. 
4 Write down the energy-dependent P1 equations and from which try to deduce the 
adjoint form.124 4 The Adjoint Transport Equation—The Equation of Neutron Importance
5 Find out the adjoint angular and space-dependent discrete ordinate equation. 
6 Derive the last term in Eq. 4.20 
ν(E)Σ f
(
r , E
) {∞
0 
d E'
|
(1 − β)χ
(
E'
)
+E
6
i=1 
βi χi
(
E'
)
| {
dΩ'
ϕ∗
0
(
r, E'
, Ω'
)
7 Follow up the derivation of the kinetic parameters explicitly. 
8 Let J (E)dE be the source of neutrons slowing down to the energy interval between 
E and E +dE from collisions with a moderator of mass A which scatters neutrons 
isotropically in the center of mass system. JA(E) can be viewed as an integral 
operator acting on the flux φ(E)
JA(E) = Lφ(E) =
E
{
/α
E 
d E' EH 
s
(
E'
)
(1 − α)E'
φ
(
E'
)
where symbols are familiar from neutron slowing down theory [7]. Determine 
the adjoint L∗. 
References 
1. J. Duderstadt, Lecture Notes, on Reactor Theory (University of Michigan, Nuclear Engineering, 
1977) 
2. P. Saracco, S. Dulla, P. Ravetto, The adjoint neutron transport equation and the statistical 
approach for its solution. Eur. Phys. J. Plus (2016) 
3. N.R. Henry, Analysis (MIT Press, Mass, 1982) 
4. G. Bell, S. Glasstone, Nuclear Reactor Theory (Van Nostrand, New York, 1974) 
5. V. Vitali, S. Dulla, P. Ravetto, A. Zoia, Comparison of Monte Carlo methods for adjoint neutron 
transport. Eur. Phys. J. Plus (2018) 
6. J.E. Hoogenboom, Continuous energy adjoint Monte Carlo for coupled neutron-photon trans￾port. Adv. Monte Carlo Radiat. Phys., Part. Transp. Simul. (2001) 
7. O.P. Diop, C. Jouanne, Adjoint Monte Carlo neutron transport using cross-section probability 
table representation.Ann. Nucl. Energy (2014) 
8. Kuridan, Beynon, Monte Carlo versus discrete ordinates calculations of the kinetic and coupling 
parameters of a PWR core with a multi-node reflector. Ann. Nucl. Energy 21(6) (1994)5 Perturbation Theory 
In perturbation theory, the new state of the reactor as a result of the introduction 
of small perturbations can be predicted using a short cut without going in detailed 
and lengthy calculations. Suppose a critical system undergoes a small disturbance 
(perturbation) and it is required to determine the system response to this perturba￾tion e.g. what is k (the multiplication factor)? If the perturbation is small enough, 
it is not necessary to perform a new complete calculation for the new state, instead, 
by means of perturbation theory we use the adjoint function to obtain the response 
to small perturbations. 
Among the more important applications which will be described in this chapter 
are the following: and the effective multiplication factor, k, resulting from small 
changes in cross sections (discussed in Sect. 5.1); Perturbations in one speed and 
multi-group diffusion theory are introduced in Sects. 5.2 and 5.3. Determination 
of the changes in the multiplication rate constant, α is derived in Sect. 5.4. These 
are Examples of initiating perturbations subject to perturbation theory analysis: 
1. Changing the x-section e.g. absorption by insertion or withdrawal of some 
material (density perturbation) 
2. Moreover, in the performance of criticality calculations, it is useful to know 
how sensitive the computed eigenvalues are to uncertainties in the input cross 
sections. This sensitivity can be determined by considering the cross-section 
uncertainties as perturbations. 
3. Changing the geometry as a result of thermal expansion, burn-up, doppler effect 
4. It is a common practice in reactor calculations the actual geometry or cross 
sections may be simplified in order to obtain a problem which can be solved 
by means of a particular available code. The effects of such simplifications on 
criticality can often be estimated by perturbation theory.
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2023 
R. M. Kuridan, Neutron Transport, Graduate Texts in Physics, 
https://doi.org/10.1007/978-3-031-26932-5_5 
125126 5 Perturbation Theory
5.1 Perturbation of the Effective Multiplication Factor (k) 
Recall the adjoint and the neutron transport Eqs. 4.11 and 4.12 from Chap. 4 [1, 
2] 
Lϕ(r , E, o) = −o · ∇ϕ(r , E, o) − Et (r, E, o)ϕ(r , E, o)
+
{∞
0 
d E'
{
L 
do'
Es
(
r , E' → E, o → o
)
ϕ
(
r, E'
, o'
)
Fϕ(r , E, o) = χ (E)
{
do'
{
d E'
v
(
E'
)
E f
(
r, E'
)
ϕ
(
r, E'
, o'
) (5.1) 
where we have divided the operator L into L and F. Similarly, the adjoint equation 
is redefined as: 
L∗ϕ∗(r , E, o) = o · ∇ϕ∗(r , E, o) − Et (r, E)ϕ∗(r , E, o)
+
{∞
0 
d E'
{
4π
do'
Es
(
r , E → E'
, o → o'
)
ϕ∗(
r , E'
, o'
) (5.2) 
F∗ϕ∗(
r, E, o)
= ν(E)E f
(
r, E
) {∞
0 
d E'
{
4π
do'
χ
(
E'
)
ϕ∗(
r, E'
, o'
) (5.3) 
Hence, the transport equation and its adjoint are defined using the new operators 
(notice both have the same eigenvalue k) as: 
Lϕ = 1 
k 
Fϕ (5.4) 
L∗ϕ∗ = 1 
k 
F∗ϕ∗ (5.5) 
If we assume small perturbations take place in the system which will lead to 
small perturbations in the multiplication factor and the neutron flux then the new 
transport equation can be written as 
L'
ϕ
'
= 1 
k' F'
ϕ' (5.6) 
where the perturbations can be expressed in the form 
L' = L + /L; F' = F + /F; ϕ' = ϕ + /ϕ; k' = k + /k5.1 Perturbation of the Effective Multiplication Factor (k) 127 
The / is small enough so that the validity of the theory is not jeopardized. 
More explicitly
/Lϕ = L'
ϕ − Lϕ = −/Et ϕ +
{∞
0 
d E'
{
4π
do'
/Es
(
r , E → E'
, o → o'
)
ϕ
(
r , E'
, o'
)
/Fϕ = F'
ϕ − Fϕ = χ(E)
{
4π
do'
{∞
0 
d E'
ν
(
E'
)
/E f
(
r , E'
)
ϕ
(
r , E'
, o'
)
where /E = E' − E
Now multiply 6 by ϕ and 7 by ϕ∗, subtract and integrate over the range of 
variables
(
ϕ, L∗ϕ∗)
− (
ϕ∗, L'
ϕ'
)
= 1 
k
(
ϕ, F∗ϕ∗)
− 1 
k'
(
ϕ∗, F'
ϕ'
)
At this point we can carry on without making any further approximations to the 
perturbed flux ϕ' and obtain an exact expression for the reactivity change, however 
we want to use the unperturbed flux ϕ so that we save the effort of calculating the 
perturbed flux. This is where “perturbation theory” comes in. Assuming first order 
perturbations in the flux ϕ' = ϕ + /ϕ ∼= ϕ, in other words, neglecting first order 
errors in the flux. Rewriting,
(
ϕ, L∗ϕ∗)
− (
ϕ∗, L'
ϕ
)
= 1 
k
(
ϕ, F∗ϕ∗)
− 1 
k'
(
ϕ∗, F'
ϕ
)
Substituting for perturbations we get
(
ϕ, L∗ϕ∗)
− (
ϕ∗,(L + /L)ϕ
)
= 1 
k
(
ϕ, F∗ϕ∗)
− 1 
k'
(
ϕ∗,(F + /F)ϕ
)
Or
(
ϕ, L∗ϕ∗)
− (
ϕ∗, Lϕ) − (ϕ∗, /Lϕ
)
= 1 
k
(
ϕ, F∗ϕ∗)
− 1 
k'
(
ϕ∗, Fϕ
)
− 1 
k'
(
ϕ∗, /Fϕ
)
First and second term cancel each other (requirement) and also (ϕ, F∗ϕ∗) =
(ϕ∗, Fϕ) by the same requirement, therefore 
−
(
ϕ∗, /Lϕ
)
=
(1 
k − 1 
k'
)(
ϕ∗, Fϕ
)
− 1 
k'
(
ϕ∗, /Fϕ
)
(1 
k − 1 
k'
)
=
1 
k'(ϕ∗, /Fϕ) − (ϕ∗, /Lϕ)
(ϕ∗, Fϕ)128 5 Perturbation Theory
If we define the reactivity change /ρ/ρ
/ρ = ρ' − / = k' − 1 
k' − k − 1 
k = k
(
k' − 1
)
− k'
(k − 1)
kk'
= kk' − k − k'
k + k'
kk' = −k + k'
kk' = −k + k'
kk' = 1 
k − 1 
k'
Rearranging we arrive at
/ρ =
1 
k'(ϕ∗, /Fϕ) − (ϕ∗, /Lϕ)
(ϕ∗, Fϕ)
Approximating 1 
k' ∼= 1 then,
/ρ = (ϕ∗,(/F − /L)ϕ)
(ϕ∗, Fϕ) (5.7) 
Therefore, knowing the amount of change in the operators /L or /F 
or both one can estimate the reactivity change. More explicitly knowing:
/Et; /Es; /E f , we will be able to find /ρ from Eq. 8 without the need for 
the flux of the new state ϕ'
.ϕ'
.
5.2 Perturbations in the One Speed Diffusion Theory 
Consider the one speed diffusion equation [3] 
−∇ · D
(
r
)
∇φ
(
r
)
+ Ea
(
r
)
φ
(
r
)
= 1 
k 
νE f
(
r
)
φ
(
r
)
Lφ
(
r
)
= −∇ · D
(
r
)
∇φ
(
r
)
+ Ea
(
r
)
φ
(
r
)
Fφ
(
r
)
= νE f
(
r
)
φ
(
r
)
Remember that it is self-adjoint and φ∗ = φ and the perturbed operators
/Lφ
(
r
)
= −∇ · δD
(
r
)
∇φ
(
r
)
+ δEa
(
r
)
φ
(
r
)
δFφ
(
r
)
= νδE f
(
r
)
φ
(
r
)
And Eq. 5.8 becomes
/ρ =
{ dV((
νδE f
(
r
)
− δEa
(
r
))φ2
(
r
)
− δD
(
r
)|
|∇φ
(
r
)|
|
2
(
{ dV νE f
(
r
)
φ2
(
r
) (5.8)5.2 Perturbations in the One Speed Diffusion Theory 129
Example 1 Suppose an absorber is inserted into the reactor core at a point r 0 such 
that δEa
(
r
)
= δEaδ(r − r 0), what would be the reactivity change? 
The change in the absorption x-section although it could be small however it 
is localized and this does not go along with the validity of the perturbation theory 
where it is assumed small and uniform. If we disregard this condition Eq. 5.9 
becomes
/ρ = −
{ dV δEa
(
r
)
φ2
(
r
)
{ dV νE f
(
r
)
φ2
(
r
)
Substitute for δEa
(
r
)
using δEa
(
r
)
= δEaδ
(
r − r 0
)
the result would be
/ρ = −
{ dV δEaφ2
(
r
)
δ
(
r − r 0
)
{ dV νE f
(
r
)
φ2
(
r
) = −δEaφ2
(
r 0
)
C 
If we just for a moment write φ2
(
r 0
)
in its original definition
/ = −δEa 
C φ∗(
r 0
)
φ
(
r 0
)
or 
φ∗(
r 0
)
= −/ρ
Cφ(r 0)
The adjoint is proportional to the change in reactivity per neutron absorbed at 
r 0 or it is a measure of the effectiveness of an absorber inserted at any position in 
changing the core reactivity. 
Example 2 Consider a slab reactor as shown in Fig. 5.1 where an absorber is added 
uniformly in the region: 0 < x < h. If we imagine this to be a bank of control rods 
inserted to a depth h in the core, what would be the reactivity change? 
To allow the application of the perturbation theory we must assume this 
absorption is relatively small hence the perturbation is expressed as: 
δEa(r
−) =
{
δEa 0 < x < h 
0 h < x < a
Fig. 5.1 A control rod bank 
inserted in a slab reactor 
CR bank 130 5 Perturbation Theory
0 
0.0005 
0.001 
0.0015 
0.002 
0.0025 
0 
0.01 
0.02 
0.03 
0.04 
0.05 
0 10 20 30 40 50 
dρ/dh 
∆ρ
hight 
∆ρ
dρ/dh 
Fig. 5.2 Integral and differential control rod worth of the TNRCRR [4] 
The unperturbed flux for a slab reactor is given by: 
φ(x) = φ0sin 
πx 
a 
The reactivity change in a uniform medium is
/ρ(h) = −
{ h 
0 dxδEaφ2(x)
{ a 
0 dxνE f φ2(x)
= 2 
π
δEa 
νE f
|
πh 
2a − 1 
4 
sin 
2πh 
a
|
(5.9) 
The reactivity change due to such an absorber is known as the “worth” of 
the absorber. If h considered as the variable depth of the rod bank, then we can 
draw the relationship between the worth and the depth as shown in Fig. 5.2. Also, 
associated with it is the differential worth obtained from the differentiation of 
Eq. 5.10 as: 
dρ
dh = − δEa 
aνE f
|
1 − cos 
2πh 
a
|
(5.10) 
Data used in Fig. 5.2 are for the TNRCRR. 
5.3 Multigroup Perturbation Theory 
Referring to the matrix formulation of the multi-group diffusion equation and 
its adjoint form in Chap. 4 Sect. 4.4, the perturbations will assume a matrix 
formulation e.g. [2] 
A' = A + δA and F' = F + δF.5.3 Multigroup Perturbation Theory 131
Where δA and δF are the matrices of perturbations given by: 
δA =
⎡
⎢
⎢
⎢
⎢
⎢
⎢
⎣
−∇.δD1∇ + δER1 0 0 ··· 0 
−δEs12 −∇.δD2∇ + δER2 0 ··· 0 
−δEs13 −δEs23 −∇.δD3∇ + δER3 ··· 0 
.
.
.
.
.
.
.
.
. ... .
.
.
−δEs1G −δEs2G −δEs3G ... −∇.δDG∇ + δERG 
⎤
⎥
⎥
⎥
⎥
⎥
⎥
⎦
;
δF =
⎡
⎢
⎢
⎢
⎢
⎢
⎣
χ1δ
(
v1E f 1
) χ1δ
(
v2E f 2
) χ1δ
(
v3E f 3
) ··· χ1δ
(
vGE f G)
χ2δ
(
v1E f 1
) χ2δ
(
v2E f 2
) χ2δ
(
v3E f 3
) ··· χ2δ
(
vGE f G)
χ3δ
(
v1E f 1
) χ3δ
(
v2E f 2
) χ3δ
(
v3E f 3
) ··· χ3δ
(
vGE f G)
.
.
. .
.
. .
.
. ... .
.
.
χG δ
(
v1E f 1
)
χG δ
(
v2E f 2
)
χG δ
(
v3E f 3
)
··· χG δ
(
vGE f G)
⎤
⎥
⎥
⎥
⎥
⎥
⎦
For example, if the perturbations are only in the thermal absorption cross section 
which is represented by the last group. Therefore,
ERg = EtG − EsGG = EaG + EsG − EsGG = EaG + E
G
g'
=1
EsGg'
(
r
)
− EsGG 
The term before the last term means scattering to groups above the thermal 
group (up scattering) which is ignored, therefore ERg = EaG − EsGG. the per￾turbations are assumed in EaG only or δERg = δEaG and δEsGG = 0. Hence 
δF = 0 and δA become: 
δA =
⎡
⎢
⎢
⎢
⎢
⎢
⎣
000 ··· 0 
000 ··· 0 
000 ··· 0 
.
.
. .
.
. .
.
. ... .
.
.
000 ... δEaG 
⎤
⎥
⎥
⎥
⎥
⎥
⎦
And the reactivity change given by 5.8 assumes the matrix form:
/ρ =
(
o∗,
(
δF − δA
)
o
)
(
o∗, Fo
(
Example 
Consider the two-group diffusion theory 
δA =
|
00 
0 δEa2
|
and δF =
|
00 
0 0 |
.132 5 Perturbation Theory
Therefore,
/ρ = −
{ dV{|
φ∗
1 φ∗
2
|
|
00 
0 δEa2
|| φ1 
φ2
|}
{ dV{|
φ∗
1 φ∗
2
|
|
ν1E f 1 0 
ν2E f 2 0
|| φ1 
φ2
|}
Multiplying matrices, it reduces to
/ρ =
{ dV φ∗
2
(
r
)
δEa2φ2(r)
{ dV φ∗
1
(
r
)
ν1E f 1φ1
(
r
)
+ φ∗
2
(
r
)
ν2E f 2φ1
(
r
)
5.4 Perturbation of the Multiplication Rate Constant (α) 
The multiplication rate may increase or decrease such that [2, 5]: 
ϕ
(
r , E, o, t
) = ϕ
(
r, E, o)
e±αt where α is the multiplication rate constant. 
Taking the derivative w.r.t time and considering increased rate: 
∂
∂t 
ϕ
(
r , E, o, t
)
= αϕ(
r, E, o)
eαt = αϕ(
r, E, o, t
)
Therefore, the time dependent term in the NTE is 
1 
υ
∂ϕ
∂t = α
υ ϕ
(
r , E, o, t
)
Recalling the neutron transport equation, its adjoint and the perturbed form 
1 
υ
∂φ
∂t = Lϕ
(
r , E, o, t
)
;
1 
υ
∂ϕ∗
∂t = L∗ϕ∗(
r, E, o, t
)
;
1 
υ
∂ϕ'
∂t = L'
ϕ'
(
r , E, o, t
)
They are rewritten as 
α
υ ϕ
(
r , E, o, t
)
= Lϕ
(
r, E, o, t
) (5.11) 
α∗
υ ϕ∗(
r, E, o, t
)
= L∗ϕ∗(
r , E, o, t
) (5.12) 
α'
υ ϕ'
(
r, E, o, t
)
= L'
ϕ'
(
r , E, o, t
) (5.13) 
In a similar fashion when deriving the perturbation of the multiplication factor, 
Eq. 5.12 is multiplied by ϕ and Eq. 5.13 is multiplied by ϕ∗ and subtracting
(
ϕ,
α∗
υ ϕ∗
)
−
(
ϕ∗,
α'
υ ϕ'
)
= (
ϕ, L∗ϕ∗)
− (
ϕ∗, L'
ϕ'
)5.4 Perturbation of the Multiplication Rate Constant (α) 133
Using the assumption of first order perturbation approximation e.g. ϕ' ∼ ϕ and 
factorizing we get
(
α∗ − α'
) (ϕ, ϕ∗)
υ = (
ϕ, L∗ϕ∗)
− (
ϕ∗, Lϕ
)
− (
ϕ∗, /Lϕ
)
The first and second terms on the right side cancel each other (requirement), 
therefore
(
α∗ − α'
)
= −(ϕ∗, /Lϕ)
(ϕ,ϕ∗)
υ
Notice that α∗ = α the eigenvalue of the system and α' = α + /α or
(
α∗ − α'
)
= −/α, hence,
/α = (ϕ∗, /Lϕ)
(ϕ,ϕ∗)
υ
Therefore, /α is positive and there will be an increase in α. Also, we remind 
by the advantage of the perturbation theory that /α is computed using condi￾tions before the perturbations take place. If the changes in /L are large then the 
first order perturbation theory is no longer valid and we have to resort to routine 
calculation of either the multiplication factor k or constant αα
Exercises 
1. Why is the adjoint system is introduced in developing the perturbation equa￾tions? Illustrate your answer with an example showing that only the use of the 
adjoint system will yield the desired result. Define the importance function and 
discuss its significance physically and mathematically. 
2. Determine the first order change in reactivity δk 
k , where k is the multiplication 
factor, due to the perturbation in the scattering and absorption cross sections of 
the form
E'
a(r, E) = Ea(r , E) + δEa(r, E)
E'
s
(
r, E' → E, o' → o
) = Es
(
r, E' → E, o' → o
)
+ δEs
(
r , E' → E, o' → o
)
3. The accurate flux and the adjoint flux in a subcritical system can readily be 
calculated. The configuration of another subcritical system is only slightly dif￾ferent. Find an expression for the desired reaction rate (not the multiplication 
rate) integrated over the second system, such that the expression has only sec￾ond order errors and does not depend on variations from the flux and adjoint 
flux of the first system.134 5 Perturbation Theory
Core 
Core 
Core 
Reflector Reflector
Fig. 5.3 Reflected slab 
4. Demonstrate the validity of problem (5.3) by considering the following 
example: 
An infinite medium extends from x = 0 to ∞ and contains a plane source 
at x = 0. The flux is to be described by the one group diffusion theory. The 
first system has an absorption cross section Ea and a diffusion constant D. The 
second system has the same source and diffusion constant, but an absorption 
cross section Ea + δEa Calculate the absorption rate throughout exactly and 
according to the derived perturbation procedure. Then show that results differ 
by second order terms in δEa.
5. A critical system consisting of a slab surrounded on both sides by infinite reflec￾tors is to be described by two group diffusion theory. The center third of the 
core suddenly has its thermal group absorption cross section increased slightly. 
Find the change in criticality factor by perturbation theory. Compare to the 
immense amount of work would be done if the perturbation theory is not used 
(see Fig. 5.3). 
References 
1. G. Bell, S. Glasstone, Nuclear Reactor Theory (Van Nostrand, New York, 1970) 
2. J. Duderstadt, L. Hamilton, Nuclear Reactor Analysis (Wiley, New York, 1976) 
3. J. Duderstadt, Lecture Notes, on Reactor Theory” (University of Michigan, Nuclear Engineer￾ing, 1977) 
4. R. Kuridan, Calculation of the kinetic parameters of the TNRC Research Reactor, Arab 
conference on the peaceful uses of atomic energy (Tunis, 1998) 
5. D. A. Usikov, Estimate of perturbations in solving nonuniform neutron transport problems by 
the Monte Carlo method, Atomic Energy 42(1) 19776 The Method of Discrete Ordinates: 
The SN Method 
Unlike analytical methods, such as the spherical harmonics method, the essen￾tial basis of the SN method is that the angular distribution of the neutron flux is 
evaluated in a number of discrete directions. By considering enough directions, 
it is possible, in principle, to obtain a solution of the transport equation to any 
desired degree of accuracy, subject only to the limitations of the available com￾puting machine. It will be seen that some versions of these discrete methods are 
related to the method of spherical harmonics. In the solution of practical problems 
by discrete ordinates (DO) techniques, a discrete energy variable is introduced, 
by means of a multi-group approximation, and a discrete space mesh is used for 
the spatial coordinates. Consequently, all the independent variables of the time￾independent neutron transport equation, namely, space, r; direction, i; and energy, 
E, are treated as discrete. As compared with the method of spherical harmon￾ics, the distinguishing feature of the method of discrete ordinates is the discrete 
treatment of the angular (or direction) variable. 
The method of discrete ordinates is sometimes known as the SN method in 
which the angular variable is discretized into a small number of directions or rays, 
then the neutron transport equation is written for each ray. A number of new and 
important problems arise in the development of the method: 
(1) the choice of the particular discrete directions; 
(2) the approximation of the integrals over the direction variable; and 
(3) the approximation of the derivatives of the neutron angular flux with respect to 
the components of i appearing in the transport equation in curved geometries. 
In Sect. 6.1, the fundamental concepts of the choice of discrete directions are intro￾duced. In Sect. 6.2, the combined DO and Legendre polynomials equations with 
Gauss quadrature sets are defined and derived. Isotropic and anisotropic scattering 
with fission sources are treated within the multi-group DO. The numerical formu￾lation and solution for plane and spherical geometries are derived in Sect. 6.3. The
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2023 
R. M. Kuridan, Neutron Transport, Graduate Texts in Physics, 
https://doi.org/10.1007/978-3-031-26932-5_6 
135136 6 The Method of Discrete Ordinates: The SN Method
cell-centered finite difference and the off-center forward difference schemes are 
both examined. Error propagation is analyzed and conditions to insure positivity 
of the neutron flux are established. 
6.1 Fundamental Concepts 
The major steps of discrete ordinates approach to solving the neutron transport 
equation are as follows [1, 2]: 
1. Choosing a set of M directions im , m = 1, 2,...... M and correspond￾ing quadrature weights wm , m = 1, 2,...... M needed for the numerical 
integration over angle. 
2. The transport equation with anisotropic scattering from Chap. 1 is evaluated at 
each of the discrete directions:
im · ∇ϕ
(
r , im
)
+ Et
(
r , im
)
ϕ
(
r , im
)
= E
L
l=0 
E
l
n=−l 
Yln(
im
)
Esl {
4π
di'
Y ∗
ln(
i'
)
ϕ
(
r, i'
)
+ S
(
r , im
)
, and m = 1, 2,...... M (6.1) 
where spherical harmonics expansion for the scattering cross section is used. 
3. The integral term is evaluated using the discrete directions im and quadrature 
weights wm, thus Eq. 6.1 becomes
im · ∇ϕ
(
r , im
)
+ Et
(
r, im
)
ϕ
(
r , im
)
= E
L
l=0 
E
l
n=−l 
Yln(
im
)
Esl E
M
i=1 
wi Y ∗
ln(
ii
)
ϕ
(
r, ii
)
+ S
(
r, im
)
, and m = 1, 2,...... M 
4. The last equation is to be replaced by the one-dimensional form assuming 
isotropic scattering 
μ
∂
∂z 
ϕ(z, μ) + Et ϕ(z, μ) = Es 
2 {
+1
−1 
dμ'
ϕ
(
z, μ'
)
+ S(z, μ) (6.2) 
5. Choosing the same set above for the discrete directions but for μ instead of i, 
e.g. μm , m = 1, 2,...... M and corresponding quadrature weights wm , m =
1, 2,...... M. Substituting, 
μm 
∂
∂z 
ϕ(z, μm ) + Et ϕ(z, μm ) = Es 
2 
E
M
i=1 
wi ϕ(z, μi ) + S(z, μm ) (6.3)6.1 Fundamental Concepts 137
We have used the approximation of the numerical integration as 
{
+1
−1 
dμ'
ϕ
(
z, μ'
)
= E
M
i=1 
wi ϕ(z, μi ) (6.4) 
This set of M coupled differential equations can be solved by finite difference 
techniques once the boundary conditions are specified. So far nothing has been 
said about the choice of the set of direction cosines, {μm}, nor of the associated 
quadrature weights, {wm}. The accuracy which can be achieved in solving Eq. 6.3 
for a given M will depend, however, to a large extent on making a good choice. 
The following properties of wm and μm seem to be reasonable requirements: 
(1) Since the integral in Eq. 6.2 is always positive, it is required that 
wm > 0 for all m. 
(2) A symmetric choice of directions and weights about μ = 0
(
θ = π
2
)
, where 
μm > 0 is suggested 
μM+1−m = −μm (6.5) 
wM+1−m = wm , m = 1, 2,...... M (6.6) 
so that the formulation will be symmetric upon reflection. In other words, the 
solution will not depend on which side of a slab is designated as the right side 
and which as the left side. If, in a particular situation, the flux is known to be 
highly asymmetric, it may be advantageous to use unsymmetrical quadrature 
sets; for example, if the flux is peaked near μ = +1, it may be useful to have 
the discrete directions closer together in this vicinity. If the value of μm = 0 is 
considered as one of the directions, then it will cause the streaming term in the 
equation disappear and will be different from the rest and hence a discontinuity 
of the flux. 
Example Suppose M = 6, then m = 1,..., 6 hence from condition (5), μ6 =
−μ1;μ5 = −μ2;μ4 = −μ3. Notice that the formula repeats itself and hence we 
need to know only the values of μ1;μ2;μ3 to describe the six direction cosines. The 
weights are like so, w6 = w1;w5 = w2;w4 = w3. Figure 6.1 shows this.138 6 The Method of Discrete Ordinates: The SN Method
(3) It is required that if ϕ(z, μ) is a polynomial of low order in μ, then the quadra￾ture formula of Eq. 6.4 should give the exact value of the integral. Since, the 
angular flux is assumed a low-order polynomial of μ, then ϕ(z, μ) ∼ μl
, and 
{
+1
−1 
dμϕ(z, μ) =
{
+1
−1 
dμμl = μl+1 
l + 1
|
|
|
|
|
+1 
−1 = (+1)
l+1 
l + 1 − (−1)
l+1 
l + 1 
=
{ 2 
l+1 l even 
0 l odd 
Therefore, 
{
+1
−1 
dμϕ(z, μ) = E
M
i=1 
wi ϕ(z, μi ) = E
M
i=1 
wi μl 
i =
{ 2 
l+1 , leven 
0, lodd (6.7) 
Actually, the condition for l odd is guaranteed by property (2). The values of l 
for which these relations should be satisfied must now be considered. Suppose that 
M is even, then there are M values of μi and M values of wi or 2M parameters in 
all to be determined. Condition (2) implies that only M values are independent. If 
there were M independent parameters for fitting condition (3) with l even, then it 
might be possible to satisfy this condition for l = 0, 2, 4,...... 2M − 2, but not 
beyond (Fig. 6.1). 
If such a choice is made, it will determine μi and wi uniquely as the Gauss 
quadrature set of directions and weights, the weights are all positive and satisfy 
condition (1). It is not necessary, however, to satisfy condition (3) for so many
Fig. 6.1 Direction cosines 
for M = 6 6.2 The Combined Discrete Ordinates and Legendre Polynomials Equation 139 
values of l (with l even); in this event, there is some freedom to impose other 
conditions. 
Example Consider the case M = 2 directions, find the Gauss quadrature set. 
Equation 6.7 for M = 2 
E
2
i=1 
wi μl 
i = w1μl 
1 + w2μl 
2 = 2 
l + 1 
,l even 
or 
w1μl 
1 + w1(−μ1)
l = 2 
l + 1 
l even 
which reduces to w1μl 
1 = 1 
l+1 ,l even. Two unknowns require two equations and 
hence applying (l = 0, 2, 4,...... 2M − 2) to this case of M = 2 we get l =
0, 2,....[2(2) − 2] or l = 0, 2. For l = 0 w1 = 1 and from Eqs. 6.5 and 6.6 
w2 = 1 substituting in w1μ2 
1 = 1 
3 gives μ1 = √
1 
3 = 0.57735 and μ2 = −0.57735. 
6.2 The Combined Discrete Ordinates and Legendre 
Polynomials Equation 
Equation 6.2 when converted to the PN equation (Chap. 3) [3]: 
(n + 1)
dφn+1 
dz + n 
dφn−1 
dz + (2n + 1)Et φn(z)
= (2n + 1)Esnφn(z)δn0 + (2n + 1)Sn(z); n 
= 0, 1, 2, ··· , N and the PN approximation 
dφN+1 
dz = 0 
Since we are considering isotropic scattering, the scattering term is expressed to 
exclude anisotropy as 
(2n + 1)Esnφn(z) = (2n + 1)Esnφn(z)δn0 
=
{
(2n + 1)Es0φ0(z), n = 0 
0, n /= 0 
where φ0(z) = φ(z) and Es0 = Es and δn0 is the Kronecker delta. 
Before proceeding, we consider some special choices of μi and wi the rela￾tionship between the methods of discrete ordinates and spherical harmonics will140 6 The Method of Discrete Ordinates: The SN Method
be examined. In the PN method, the integral definition of the Legendre component 
flux from Chap. 3 is 
φn(z) = 2π
{
+1
−1 
dμPn(μ)ϕ(z, μ)
The equivalent quantities for the discrete ordinates treatment are defined by 
using the quadrature formula as in Eq. (6.4), thus 
φ˜n(z) = 2π
E
M
i=1 
wi ϕ(z, μi )Pn(μi ) (6.8) 
where the symbol φ˜n(z) is used to indicate an approximation to φn(z) that is 
obtained from the quadrature formula. To find equations satisfied by the φ˜n(z), 
Eq. (6.3) is multiplied by 2π(2n + 1)wm Pn(μm ) and summed over m, with the 
recurrence relation for Legendre polynomials and the requirement (Eq. 6.7) given 
above for all n ≤ M − 1, the result is 
E
M
m=1 
2π(2n + 1)wm μm Pn(μm )
∂
∂z 
ϕ(z, μm )
+ Et (z)
E
M
m=1 
2π(2n + 1)wm Pn(μm )ϕ(z, μm )
= Es (z)
2 
E
M
m=1 
2π(2n + 1)wm Pn(μm )
E
M
i=1 
wi ϕ(z, μi )
+ E
M
m=1 
2π(2n + 1)wm Pn(μm )S(z, μm )
Using orthogonality as before and the recurrence relations of Legendre poly￾nomials, we get the combined [discrete ordinates-spherical harmonics (DO-SH)] 
equation 
(n + 1)
d φ˜n+1 
dz + n 
d φ˜n−1 
dz + (2n + 1)Et φ˜n(z) = (2n + 1)Esnδn0 φ˜n(z)
+ (2n + 1)S˜
n(z); n = 0, 1, 2, ··· , M − 1 (6.9) 
It should be noted that Eq. 6.9 represents a set of M equations, selected since 
there are only M independent quantities ϕ(z, μi ) available. For n = M −1 Eq. 6.8 
can be written as 
φ˜M−1(z) = 2π
|
w1ϕ(z, μ1)PM−1(μ1) + ... + wM ϕ(z, μM )PM−1(μM )
|6.2 The Combined Discrete Ordinates and Legendre Polynomials Equation 141
In the spherical harmonics expansion of the angular flux, the series of terms in 
the summation of polynomials is truncated by assuming that dφN 
dz = 0 for a PN−1 
approximation and boundary conditions are used. It will be recalled that this trun￾cation or an equivalent is required in order to have the same number of unknown 
functions, φn, equal to the number of equations. But for the system of Eq. 6.9 it is 
not possible simply to set d φ˜M 
dz = 0, because φ˜M may be derived from the funda￾mental quantities ϕ(z, μi ) by means of Eq. 6.8, and therefore d φ˜M 
dz is determined. 
Another way of finding {μi} is by the method of Wick–Chandrasekhar in which 
μi are the M zeroes of the Legendre polynomial of order M (Fig. 6.2): 
PM (μi ) = 0(i = 1, 2,... M) (6.10)
d φ˜M 
dz is automatically zero. The set of Eq. (6.9) for isotropic scattering is then 
identical with the truncated set of spherical harmonics. From the properties of the 
Legendre polynomials, it is known that PM (μ) will have exactly M zeros in the 
range −1 ≤ μ ≤ 1 (check Fig. 6.2 for P1,..5 curves) and so these values form an 
acceptable set for the present requirement. For M even, there are even number of 
directions and even number of Eq. 6.9 corresponding to the odd order spherical 
harmonics equations. Thus, M = 2 in the discrete ordinates procedure corresponds 
to a P1 approximation. 
Finally, the discrete ordinate representation of the true vacuum boundary con￾dition for Eq. 6.9 corresponds to Mark’s prescription for obtaining boundary
-1
-0.75
-0.5
-0.25 
0 
0.25 
0.5 
0.75 
1
-1 -0.75 -0.5 -0.25 0 0.25 0.5 0.75 1 
P0 P1 
P2 Poly. (P3) 
direction cosines 
Legendre polynomials up to 
Fig. 6.2 Legendre polynomials (P0,..., P5)142 6 The Method of Discrete Ordinates: The SN Method
conditions for the PN method (Chap. 3, Sect. 6.3). Therefore, we have finally 
demonstrated that 
⎧
⎨
⎩
SN discrete ordinates 
equations with 
Gaussian quadrature 
⎫
⎬
⎭
⇔
⎧
⎨
⎩
PN−1equations with 
Mark boundary 
conditions 
⎫
⎬
⎭
6.2.1 Gauss Quadrature Set 
If the set {μi} is chosen to satisfy Eq. 6.10, then the set {wi} will be determined 
from requirement (7) for n ≤ M − 1. These quadrature parameters are, in fact, the 
Gauss quadrature set which is widely used in numerical integration (Table 6.1 for 
M = 2, 4, 6) [1]. 
Other higher Legendre order sets for other geometries are found in the literature 
and DO code manuals. A final note, for n ≥ M the value of φ˜n can be expressed 
in terms of {φ˜n} with n ≤ M − 1. The following steps summarize the procedure 
of finding ϕ(z, μi ): 
(1) Use Eq. 6.10 to cancel out the term d φ˜M 
dz from Eq. 6.9 since from Eq. 6.8: 
φ˜M (z) = 2π[w1ϕ(z, μ1)PM (μ1) + ... + wM ϕ(z, μM )PM (μM )] = 0 
(2) Find {φ˜n} from Eq. 6.9 with n ≤ M − 1.
(3) Solve Eq. 6.7: E
M
i=1 
wi μl 
i = 2 
l+1 l,l = 0, 2, 4,...... 2M − 2) for wi , μi . 
(4) Use Eq. 6.8 to obtain ϕ(z, μi ), i = 1, 2, ··· , M knowing {φ˜n} from step 2. 
(5) Use Eq. 6.10 to find a new set of μi from the zeros of the PM (μi ). 
(6) Use Eq. 6.7 and the newly found μi to obtain a new set of wi . 
(7) Using ϕ(z, μi ) obtained from step 3 with a new μi , and wi to obtain a new 
set {φ˜n} for n ≥ M. 
Example Assume M = 4.
Table. 6.1 Constants for the Gauss quadrature 
M = 2 w1 = 1.00000 w2 = 1.00000 μ1 = 0.57735 μ2 = −0.57735 
M = 4 w1 = 0.65215 w4 = 0.65215 μ1 = 0.33998 μ4 = −0.33998 
w2 = 0.34785 w3 = 0.34785 μ2 = 0.86114 μ3 = −0.86114 
M = 6 w1 = 0.46791 w6 = 0.46791 μ1 = 0.23862 μ6 = −0.23862 
w2 = 0.36076 w5 = 0.36076 μ2 = 0.66121 μ5 = −0.66121 
w3 = 0.17132 w4 = 0.17132 μ3 = 0.93247 μ4 = −0.93247 6.2 The Combined Discrete Ordinates and Legendre Polynomials Equation 143
Therefore Eq. 6.9 are written for n = 0, 1, ··· , M − 1 = 3. 
n = 0 d φ˜1 
dz + Ea φ˜0(z) = S˜
0(z)
n = 12 d φ˜2 
dz + d φ˜0 
dz + 3Et φ˜1(z) = 3 S˜
1(z)
n = 23 d φ˜3 
dz + 2 d φ˜1 
dz + 5Et φ˜2(z) = 5 S˜
2(z)
n = 34 d φ˜4 
dz + 3 d φ˜2 
dz + 7Et φ˜3(z) = 7 S˜
3(z)
Steps 
(1) Since PM (μi ) = P4(μi ) = 0, φ˜4(z) = 2π E
4
i=1 
wi ϕ(z, μi )P4(μi ) = 0 and 
hence d φ˜4 
dz and the last equation in the set become [n = 3 3 d φ˜2 
dz + 7Et φ˜3(z) =
7 S˜
3(z)]. 
(2) Solve Eq. 6.9 to find {φ˜0,1,2,3}. 
(3) Solve the equations E
4
i=1 
wi μl 
i = 2 
l+1 ,l = 0, 2, 4, 6 for w1,2,3,4, μ1,2,3,4. 
(4) Solve the system of Eq. 6.8 for ϕ
(
z, μ1,2,3,4
)
knowing {φ˜0,1,2,3} from step 2. 
(5) Use Eq. 6.10 to find a new set of μi from the zeros of P4(μi ). 
(6) Use Eq. 6.7 and the newly found μ'
1,2,3,4 in step 5 to obtain a new set of 
w'
1,2,3,4. 
(7) Using ϕ
(
z, μ1,2,3,4
)
obtained from step 4 with a new set μ'
1,2,3,4, w'
1,2,3,4 to 
obtain a new set {φ˜4,5,6,7} for n ≥ 4 and as in step1 d φ˜7 
dz = 0. 
The advantage of the choice of an even number of discrete ordinates appears when 
considering boundary conditions on both sides of the slab (Fig. 6.3):
(i) In the case of pure reflection, at z = 0, then 
ϕ(0, μm ) = ϕ(0, μM+1−m )
(
m = 1, 2,...... M 
2
)
Pure reflection: ϕ
(
0, μ1,2,3
)
= ϕ
(
0, μ4,5,6
)
. 
(ii) A free surface condition (interface to the void) at z = a, then 
ϕ(a, μm ) = 0
(
m =
( M 
2 + 1
)
,... M
)
No neutron flux re-entering the slab from the void: ϕ
(
0, μ4,5,6
)
= 0.144 6 The Method of Discrete Ordinates: The SN Method
void Reflecting 
medium 
Fig. 6.3 Reflective (left) and a free surface (right) conditions for M = 6
6.2.2 Anisotropic Scattering 
Recall the Legendre expansion of the anisotropic scattering term from Chap. 3 
2π
|
E∞
n=0 
(2n + 1)
4π
Esn Pn(μ)
| {
1
−1 
dμ'
Pn
(
μ'
)
φ
(
z, μ'
) (6.11) 
In practice, the sum over n will be cut off at M; it is then necessary to specify 
M cross sections, Esn, in order to perform the summation. Expressing the integral 
using the quadrature formula, it becomes 
2π
|
E
M
n=0 
(2n + 1)
4π
Esn Pn(μm )
|
2π
E
M
i=1 
wi ϕ(z, μi )Pn(μi ) (6.12) 
Substituting from Eq. 6.8 into Eq. 6.12, we get 
2π
|
E
M
n=0 
(2n + 1)
4π
Esn Pn(μm )
|
φ˜n(z)
This term replaces the isotropic scattering term in Eq. 6.9 and the equation 
is multiplied by 2π(2n + 1)wm Pn(μm ) and summed over m and employing the 
requirement in Eq. 6.7 given above for all n ≤ M −1, the result for the anisotropic 
term would be Esn φ˜n(z). Equation 6.9 becomes6.2 The Combined Discrete Ordinates and Legendre Polynomials Equation 145
(n + 1)
d φ˜n+1 
dz +n 
d φ˜n−1 
dz + (2n + 1)Et φ˜n(z)
=(2n + 1)Esn φ˜n(z) + (2n + 1)S˜
n(z); n = 0, 1, 2, ··· , M − 1 
(6.13) 
which is similar to Eq. 6.9 without the delta function. 
6.2.3 Multi-group DO Equations with Anisotropic Scattering 
and Fission Source 
In order to take account of the energy variable into the DO Eq. 6.13, the anisotropic 
scattering term needs a special treatment. The scattering term in the energy￾and angular-dependent transport equation has to undergo the changes which was 
applied to the rest of the terms up to Eq. 6.13. Starting from the one-dimensional 
form [4, 5] 
2π
{∞
0 
d E'
{
+1
−1 
dμ'
Es
(
z, E' → E, μ0
)
ϕ
(
z, E'
, μ'
)
expanding in Legendre polynomials 
2π
{∞
0 
d E'
{
+1
−1 
dμ'
|
E∞
n=0 
(2n + 1)
4π
Esn(z, E' → E)Pn
(
μ'
)
Pn(μ)
|
ϕ
(
z, E'
, μ'
)
2π
{∞
0 
d E'
|
E∞
n=0 
(2n + 1)
4π
Esn(
z, E' → E
)
Pn(μ)
| {
1
−1 
dμ'
Pn
(
μ'
)
ϕ
(
z, E'
, μ'
)
Expressing the integral using the quadrature formula and replacing μ by μm as 
in the DO equation 
2π
{∞
0 
d E'
|
E∞
n=0 
(2n + 1)
4π
Esn(
z, E' → E
)
Pn(μm )
|E
M
i=1 
wi ϕ
(
z, E'
, μi
)
Pn(μi )
Multiplying by 2π(2n + 1)wm Pn(μm ) and summing over m and using Eq. 6.8 
2π
{∞
0 
d E'
|
EM
m=1 
2π(2n + 1)wm Pn(μm )
E∞
n=0 
(2n + 1)
4π Esn(
z, E' → E
)
Pn(μm )
|
φ˜n
(
z, E'
)146 6 The Method of Discrete Ordinates: The SN Method
Applying requirement Eq. 6.7, it becomes 
(2n + 1)
{∞
0 
d E'
Esn(
z, E' → E
)
φ˜n
(
z, E'
)
Carrying on from Sect. 3.5 on the transfer x-section and substituting for
Esn(
z, E' → E
)
from Eq. 3.43
Esn(
z, E' → E
)
= Es
(
z, E' → E
)
Pn(S)
Substituting in the integral 
(2n + 1)
{∞
0 
d E'
Es
(
z, E' → E
)
Pn(S)φ˜n
(
z, E'
)
where Pn(S) is a function of (
E'
, E
) which take many forms according to the 
Legendre orders, 
P0(S) = 1, P1(S) = S, P2(S) = 1 
2
(
3S2 − 1
)
,.........
And the scattering term becomes 
(2n + 1)
E
{g−1
Eg 
dE E
G
g'
Eg{'−1
Eg'
d E'
Es
(
z, E' → E
)
Pn
(
S
(
E'
, E
))φ˜n(z, E)
= (2n + 1)
E
G
g'
Esg'
→g(z)Pn
(
Sg'
,g
)
φ˜ g'
n (z)
The fluxes on the left side of Eq. 6.13 are in the form φ˜n(z, E) and in order to 
obtain the multi-group form, we integrate Eq. 6.13 over the energy group (g). The 
left side becomes 
(n + 1)
d φ˜ g 
n+1(z)
dz + n 
d φ˜ g 
n−1(z)
dz + (2n + 1)Etg φ˜ g 
n (z)
We can express the source term as an isotropic fission source by referring to the 
treatment of the fission term in Chap. 3 
(2n + 1)
χg 
k 
E
G
g'
νg'E f g'(z)φ˜ g'
0 (z)6.3 Numerical Solution of the Discrete Ordinate Equation 147 
where from Eq. 6.8 
φ˜ g'
0 = 2π
E
M
i=1 
wi ϕg'
(z, μi )P0(μi ) = 2π
E
M
i=1 
wi ϕg'
(z, μi )
Therefore, the multi-group DO equation with anisotropic scattering and 
fission source is 
(n + 1)
d φ˜ g 
n+1(z)
dz + n 
d φ˜ g 
n−1(z)
dz + (2n + 1)Etg φ˜ g 
n (z)
= (2n + 1)
G
E
g'
=1
Esg'
→g(z)Pn
(
Sg'
,g
)
φ˜ g'
n (z) + (2n + 1)
χg 
k 
E
G
g'
νg'E f g'(z)φ˜ g'
0 (z), ;
n = 0, 1, 2,....M − 1; g = 1, 2,... G (6.14) 
Equation 6.14 forms the basis for criticality calculations in discrete ordinate 
codes. 
6.2.4 The Double-PN Method in Discrete Ordinates 
It was seen in Chap. 3 that there is a discontinuity in the angular neutron flux at 
μ = 0 at an interface or boundary in plane geometry. It was then found useful 
to treat each side of the discontinuity separately in solving the transport equation 
by expansion of the angular flux distribution in terms of Legendre polynomials. 
A similar double-PN approach can be used in the discrete ordinates method by 
making separate expansion in the ranges −1 ≤ μ ≤ 0 and 0 ≤ μ ≤ 1. We will 
limit ourselves to this point and further reading may be found elsewhere. 
6.3 Numerical Solution of the Discrete Ordinate Equation 
6.3.1 Plane Geometry 
A special aspect of plane geometry (or of rectangular Cartesian coordinates in 
general) is that the direction of a neutron, as specified by direction cosines relative 
to local coordinates, does not change as the neutron streams, that is, it moves 
through the medium without making any collisions (Fig. A.3 Chap. 1). In plane 
geometry, therefore, the only concern is with problems (1) and (2) mentioned in 
the introduction, i.e. choice of direction and the evaluation of integrals. The one￾dimensional transport equation with isotropic scattering in the presence of neutron 
sources, Eq. 6.3, is to be discretized only in the space dimension, since there is a 
first derivative in space and no derivatives with respect to direction. We will use 
the so-called cell-centered finite difference scheme in contrast with the off-center148 6 The Method of Discrete Ordinates: The SN Method
forward difference scheme which had been used in the diffusion and P1 equations. 
It will be used later for Eq. 6.3 to compare the advantages and disadvantages with 
the cell-centered scheme [3, 4, 6]. 
Integrating Eq. 6.3 from z0 
n−1 to z0 
n, we have 
μm 
z0 
{ n
z0 
n−1 
dϕ(z, μm )
dx dz +
z0 
{ n
z0 
n−1
Et (z)ϕ(z, μm )dz =
z0 
{ n
z0 
n−1 
q(z, μm )dz 
Referring to Fig. 6.4, the mesh spacing extends between mesh centers and the 
fluxes are constants between mesh boundaries. Naming Et (zn) = Etn, Es (zn) =
Esn, and hn = z0 
n − z0 
n−1. The terms of the integrated equation reduce to 
μm 
z0 
{ n
z0 
n−1 
dϕ(z, μm )
dx dz = μm 
z0 
{ n
z0 
n−1 
dϕ
= ϕ(z, μm )
|
|
|
|
z0 
n 
z0 
n−1 
= μm
|
ϕ
(
z0 
n, μm
)
− ϕ
(
z0 
n−1, μm
)|
z0 
{ n
z0 
n−1
Et (z)ϕ(z, μm )dz = Etn 
z0 
{ n
z0 
n−1 
ϕ(z, μm )dz 
= Etn 
⎡
⎢
⎢
⎣
{zn
z0 
n−1 
ϕ(z, μm )dz +
z0 
{ n
zn 
ϕ(z, μm )dz 
⎤
⎥
⎥
⎦
= Etn 
⎡
⎢
⎢
⎣
ϕ
(
z0 
n−1, μm
) {zn
z0 
n−1 
dz + ϕ
(
z0 
n, μm
) z0 
{ n
zn 
dz 
⎤
⎥
⎥
⎦
= Etn|
ϕ
(
z0 
n−1, μm
)hn 
2 + ϕ
(
z0 
n, μm
) hn 
2
|
= Etn 
hn 
2
|
ϕ
(
z0 
n−1, μm
)
+ ϕ
(
z0 
n, μm
)|
And the source term is like so 
= hn 
2
|
q
(
z0 
n−1, μm
)
+ q
(
z0 
n, μm
)|
Collecting terms, Eq. 6.3 reduces to
μm
|
ϕ
(
z0 
n, μm
)
− ϕ
(
z0 
n−1, μm
)| + Etn 
hn 
2
|
ϕ
(
z0 
n−1, μm
)
+ ϕ
(
z0 
n, μm
)|6.3 Numerical Solution of the Discrete Ordinate Equation 149
Fig. 6.4 Cell-centered difference approximations for plane geometry
= hn 
2
|
q
(
z0 
n−1, μm
)
+ q
(
z0 
n, μm
)|
Using shorter notations for the flux expressions such as ϕ
(
z0 
n, μm
)
= ϕ⎛m
⎝
0 
n 
⎞
⎠
, 
ϕ
(
z0 
n−1, μm
)
= ϕ⎛m
⎝
0 
n − 1 
⎞
⎠
, and ϕ
(
z0 
n+1, μm
)
= ϕ⎛m
⎝
0 
n + 1 
⎞
⎠
, and rearranging the 
above equation, we get 
μm 
⎡
⎢
⎢
⎢
⎣
ϕ⎛m
⎝
0 
n 
⎞
⎠
− ϕ⎛m
⎝
0 
n − 1 
⎞
⎠
⎤
⎥
⎥
⎥
⎦
+ Etn 
hn 
2 
⎡
⎢
⎢
⎢
⎣
ϕ⎛m
⎝
0 
n 
⎞
⎠
+ ϕ⎛m
⎝
0 
n − 1 
⎞
⎠
⎤
⎥
⎥
⎥
⎦
= hn 
2 
⎡
⎢
⎢
⎢
⎣
q⎛m
⎝
0 
n 
⎞
⎠
− q⎛m
⎝
0 
n − 1 
⎞
⎠
⎤
⎥
⎥
⎥
⎦
; ϕ⎛m
⎝
0 
n 
⎞
⎠
= (1 − hnEtn/2μm )
(1 + hnEtn/2μm )
ϕ⎛m
⎝
0 
n − 1 
⎞
⎠
+ qm 
n 
(μm /hn + Etn/2)
and μm > 0 
(6.15) 
where qm 
n = 1 
2 
⎡
⎢
⎢
⎢
⎣
q⎛m
⎝
0 
n 
⎞
⎠
− q⎛m
⎝
0 
n − 1 
⎞
⎠
⎤
⎥
⎥
⎥
⎦. 
As a general rule, if the boundary conditions are imposed on the incoming 
boundaries, it is clear that we should advance the solution away from the incom￾ing boundaries and in the direction of neutron motion. Table 6.2 contains some 
standard one-dimensional boundary conditions.
The solution of Eq. 6.15 sweeps from left to right starting from known incoming 
fluxes at z = 0, ϕ
(
z0 
0, μm
)
with fluxes pointing in the positive direction (μm > 0).150 6 The Method of Discrete Ordinates: The SN Method
Table. 6.2 Boundary conditions in 1D plane geometry 
Vacuum ϕ
(
z0 
0, μm
)
= 0 m > M 
2 ϕ
(
z0 
N , μm
)
= 0 m ≤ M 
2 
Inhomogeneous ϕ
(
z0 
0, μm
)
= fm m > M 
2 ϕ
(
z0 
N , μm
)
= fm m ≤ M 
2 
Albedo (α = 1)
(Reflecting) 
ϕ
(
z0 
0, μm
)
=
αϕ(
z0 
0, μM−m+1
) m > M 
2 ϕ
(
z0 
N , μm
)
=
αϕ(
z0 
N , μM−m+1
) m ≤ M 
2 
Periodic ϕ
(
z0 
0, μm
)
=
ϕ
(
z0 
N , μm
) m > M 
2 ϕ
(
z0 
N , μm
)
=
ϕ
(
z0 
0, μm
) m ≤ M 
2 
White* ϕ
(
z0 
0, μm
)
=
E M 
2 
i=1 wi μi ϕ
(
z0 
0,μi
)
E M 
2 
i=1 wi μi 
m > M 
2 ϕ
(
z0 
0, μm
)
=
EM 
i=M/2+1 wi μi ϕ
(
z0 
0,μi
)
EM 
i=M/2+1 wi μi 
m ≤ M 
2 
* White boundary condition: All neutrons approaching boundaries from within are reflected back 
with an isotropic distribution
For μm < 0 we should know the incoming fluxes ϕ
(
z0 
N , μm
)
at z = a as a starting 
point and hence the solution sweeps from right to left. In order to satisfy the last 
sweep, Eq. 6.15 is modified so that the fluxes of lower order are calculated from 
those of higher order such that the equation takes the form: 
ϕ⎛m
⎝
0 
n − 1 
⎞
⎠
= (1 + hnEtn/2μm )
(1 − hnEtn/2μm )
ϕ⎛m
⎝
0 
n 
⎞
⎠
+ qm 
n 
(−μm /hn + Etn/2)
and μm < 0 (6.16) 
Example Assuming a vacuum condition on the left side of the slab 
n = 1 : ϕ⎛m
⎝
0 
1 
⎞
⎠
= (1 − h1Et1/2μm )
(1 + h1Et1/2μm )
ϕ⎛m
⎝
0 
0 
⎞
⎠
+ qm 
1 
(μm /h1 + Et1/2)
and μm > 0 
ϕ⎛m
⎝
0 
0 
⎞
⎠
= 0 on the left boundary for all positive μm (vacuum condition). 
Therefore, for 
n = 1 : ϕ⎛m
⎝
0 
1 
⎞
⎠
= qm 
1 
(μm /h1 + Et1/2)
and μm > 06.3 Numerical Solution of the Discrete Ordinate Equation 151
and for 
n = N : ϕ⎛m
⎝
0 
n 
⎞
⎠
= (1 − hNEtN /2μm )
(1 + hNEtN /2μm )
ϕ⎛m
⎝
0 
N − 1 
⎞
⎠
+ qm 
N 
(μm /hN + EtN /2)
and μm > 0 
For the case of reflecting or periodic boundary conditions, if we specify a reflecting 
boundary condition at z = 0 and an inhomogeneous boundary condition at z = a, 
we would begin with the known incoming fluxes at z = a, ϕ⎛m
⎝
0 
N 
⎞
⎠
, μm < 0, and 
progress through the slab to z = 0. At this point, we would have computed the 
outgoing flux at [ϕ⎛m
⎝
0 
0 
⎞
⎠
, μm < 0]at z = 0. We could then impose the reflecting 
boundary condition ϕ
(
z0 
0, μM−m+1
) = ϕ⎛
M−m+1
⎝
0 
0 
⎞
⎠
= ϕ⎛m
⎝
0 
0 
⎞
⎠
, and use Eq. 6.16 to 
proceed back across the slab toward z = a. This scheme is presented schematically 
in Fig. 6.5 for M = 4, N = 6. 
The solution algorithm commences with the initial guess (t = 0) for the source 
function |
qm 
n
|(t=0) and hence following the same procedure used with the appro￾priate boundary conditions and all mesh points in Eqs. 6.15 and 6.16 to solve for
Fig. 6.5 Solution strategy for plane geometry (M = 4, N = 6) 152 6 The Method of Discrete Ordinates: The SN Method
the angular fluxes 
⎡
⎢
⎢
⎢
⎣
ϕ⎛m
⎝
0 
n 
⎞
⎠
, ϕ⎛m
⎝
0 
n − 1 
⎞
⎠
⎤
⎥
⎥
⎥
⎦
(1)
. Once ϕ(1) is known, we can calculate 
q(1) knowing the source distribution in advance and then calculate ϕ(2) and so on. 
Using some criteria for convergence, we arrive at a convergent solution for the 
angular flux distribution. 
If there are implicit boundary conditions on both sides, one can iterate on a 
guessed boundary flux which is then used to calculate the interior fluxes. We still 
use Eq. 6.15 for μm < 0 and Eq. 6.16 for μm > 0. The value of q(zn, μm )
can then be recalculated and the problem can be solved by iteration. An iterative 
scheme can be suggested such as 
⎡
⎢
⎢
⎢
⎣
ϕ⎛m
⎝
0 
n 
⎞
⎠
⎤
⎥
⎥
⎥
⎦
(t+1)
= (1 − hnEtn/2μm )
(1 + hnEtn/2μm )
⎡
⎢
⎢
⎢
⎣
ϕ⎛m
⎝
0 
n − 1 
⎞
⎠
⎤
⎥
⎥
⎥
⎦
(t+1)
+
|
qm 
n
|(t)
(μm /hn + Etn/2)
and μm > 0 
⎡
⎢
⎢
⎢
⎣
ϕ⎛m
⎝
0 
n − 1 
⎞
⎠
⎤
⎥
⎥
⎥
⎦
(t+1)
= (1 + hnEtn/2μm )
(1 − hnEtn/2μm )
⎡
⎢
⎢
⎢
⎣
ϕ⎛m
⎝
0 
n 
⎞
⎠
⎤
⎥
⎥
⎥
⎦
(t+1)
+
|
qm 
n
|(t)
(−μm /hn + Etn/2)
and μm < 0
|
qm 
n
|(t+1) = Esn 
2 
E
M
i=1 
wi
|
ϕm 
n
|(t+1) + Sm 
n 
The source distribution Sm 
n = S(zn, μm ) is supposedly known. It can be 
generalized for anisotropic scattering and fission source. 
6.3.1.1 Error Propagation 
Numerical stability of the solution algorithm to the difference scheme can be illus￾trated by a simple case of a homogeneous slab with constant mesh spacing and no 
source and a known incoming flux at x = 0. In this case, we ought to use Eq. 6.15 
applying the assumptions hn = / and Etn = Et (homogenous)
ϕ⎛m
⎝
0 
n 
⎞
⎠
= (1 − /Et /2μm )
(1 + /Et /2μm )
ϕ⎛m
⎝
0 
n − 1 
⎞
⎠6.3 Numerical Solution of the Discrete Ordinate Equation 153
Defining δ = (1−/E
t /2μm)
(1+/E
t /2μm) and rewriting the equation for the first mesh on the 
left side, 
ϕ⎛m
⎝
0 
2 
⎞
⎠
= (1 − /Et /2μm )
(1 + /Et /2μm )
ϕ⎛m
⎝
0 
1 
⎞
⎠
= δϕ⎛m
⎝
0 
1 
⎞
⎠
If there is some error ε in the initial flux guess, e.g. ϕ⎛m
⎝
0 
1 
⎞
⎠
/
= ϕ⎛m
⎝
0 
1 
⎞
⎠
+ ε. 
Substituting, ϕ⎛m
⎝
0 
2 
⎞
⎠
= δ
⎛
⎜
⎜
⎜
⎝
ϕ⎛m
⎝
0 
1 
⎞
⎠
+ ε
⎞
⎟
⎟
⎟
⎠ = δϕ⎛m
⎝
0 
1 
⎞
⎠
+ δε, we get 
ϕm 
3 = δϕ⎛m
⎝
0 
2 
⎞
⎠
= δ
⎛
⎜
⎜
⎜
⎝
δϕ⎛m
⎝
0 
1 
⎞
⎠
+ δε
⎞
⎟
⎟
⎟
⎠ = δ2ϕ⎛m
⎝
0 
1 
⎞
⎠
+ δ2ε
Upon reaching the nth mesh, the error becomes 
εn → δnε =
((1 − /Et /2μm )
(1 + /Et /2μm )
)n 
ε
Since δ < 1, the error will be damped and the algorithm is stable. 
6.3.1.2 Positivity of the Flux 
The angular flux should always be positive and the difference scheme should not 
yield a negative flux. Let us examine Eq. 6.15: it is guaranteed that ϕ⎛m
⎝
0 
n 
⎞
⎠
> 0 as 
long as ϕ⎛m
⎝
0 
n − 1 
⎞
⎠
> 0 and qm 
n > 0 along with the condition 
hnEtn 
2μm 
≤ 1 (6.17) 
The cell-centered difference scheme in one-dimensional plane geometry is pos￾itive if Eq. 6.17 is satisfied. Notice that Eq. 6.15 is used with μm > 0. However, 
it is difficult to meet this constraint in practice since for a high-order quadrature 
set, e.g. S16 the lowest direction cosine is μm = 0.095 which when substituted in 
Eq. 6.17 [hn ≤ 0.2/Etn] ≤ 1 
5
( 1
Etn )
. In other words, the mesh spacing is less than154 6 The Method of Discrete Ordinates: The SN Method
a fifth of one mean free path. This severe restriction on the mesh spacing increases 
computing time significantly. The diamond difference scheme cannot be guaran￾teed to yield a positive flux in two-dimensional geometry. DO codes usually have 
a negative flux fixup treatment whenever a negative flux is encountered either by 
modification of the scheme locally or just simply by setting it to zero. 
6.3.1.3 Off-Center Difference Scheme 
The cell-centered difference scheme which has just been used for Eq. 6.3 may 
lead to negative angular fluxes as we have shown. We want to show that using 
the off-center difference approximations (also known as the forward difference), 
the fluxes obtained will always be positive, no matter what the mesh spacing. 
Referring to Fig. 6.5, we integrate Eq. 6.3 from z0 
n−1 to z0 
n, 
μm 
z0 
{ n
z0 
n−1 
dϕ(z, μm )
dx dz +
z0 
{ n
z0 
n−1
Et (z)ϕ(z, μm )dz =
z0 
{ n
z0 
n−1 
q(z, μm )dz 
Referring to Fig. 6.6, the mesh spacing extends between mesh boundary and the 
fluxes are constants between mesh centers. The terms of the integrated equation 
reduce to 
μm 
z0 
{ n
z0 
n−1 
dϕ(z, μm )
dx dz = μm 
z0 
{ n
z0 
n−1 
dϕ
= ϕ
|
|
|
|
z0 
n 
z0 
n−1 
= μm
|
ϕ
(
z0 
n
)
− ϕ
(
z0 
n−1
)|
z0 
{ n
z0 
n−1
Et (z)ϕ(z, μm )dz = ϕ(zn, μm )
z0 
{ n
z0 
n−1
Et (z)dz 
= ϕ(zn, μm )
⎡
⎢
⎢
⎣
{zn
z0 
n−1
Et (z)dz +
z0 
{ n
zn
Et (z)dz 
⎤
⎥
⎥
⎦
= ϕ(zn, μm )
⎡
⎢
⎢
⎣
Etn−1 {zn
z0 
n−1 
dz + Etn 
z0 
{ n
zn 
dz 
⎤
⎥
⎥
⎦
= ϕ(zn, μm )
|
hn−1 
2
E
tn−1 
+
hn 
2
Etn|6.3 Numerical Solution of the Discrete Ordinate Equation 155
Fig. 6.6 Off-center difference approximations for plane geometry 
And the source term is like so 
q(zn, μm )
|
hn−1 
2 +
hn 
2
|
Collecting terms, Eq. 6.3 reduces to 
μm
|
ϕ
(
z0 
n, μm
)
− ϕ
(
z0 
n−1, μm
)| + ϕ(zn, μm )
|
hn−1 
2
Etn−1 +
hn 
2
Etn|
= q(zn, μm )
|
hn−1 
2 +
hn 
2
|
Applying the diamond rule for the first term 
μm
|
ϕ
(
z0 
n, μm
)
− ϕ
(
z0 
n−1, μm
)|
= μm
|
ϕ(zn, μm ) + ϕ(zn+1, μm )
2 −ϕ(zn−1, μm ) + ϕ(zn, μm )
2
|
= μm
|
ϕ(zn+1, μm )
2 − ϕ(zn−1, μm )
2
|
In a shorter notation, the equation becomes 
μm
|
ϕm 
n+1 − ϕm 
n−1
|
+ ϕm 
n
|
hn−1Etn−1 + hnEtn|
= qm 
n
|
hn−1 + hn
|
Separating terms, 
μm ϕm 
n+1 + |
hn−1Etn−1 + hnEtn|
ϕm 
n − μm ϕm 
n−1 = qm 
n
|
hn−1 + hn
|
The result is a system of equations with no conditions on the mesh size. The 
boundary conditions are modified to suit this mesh structure as presented in Table 
6.3. Quoting references, such difference equations are generally less accurate than 
the central difference equations.156 6 The Method of Discrete Ordinates: The SN Method
Table 6.3 Possible boundary and interface conditions in 1D plane geometry 
Vacuum ϕ
(
z1,μm
)
= 0 m > M 
2 ϕ
(
zN+1,μm
)
= 0 m ≤ M 
2 
Inhomogeneous ϕ(z1, μm ) = fm m > M 
2 ϕ(zN +1, μm ) = fm m ≤ M 
2 
Albedo (α = 1)
(Reflecting) 
ϕ(z1, μm ) =
αϕ(z1, μM−m+1)
m > M 
2 ϕ(zN +1, μm ) =
αϕ(zN +1, μM−m+1)
m ≤ M 
2 
Periodic ϕ(zN , μm ) =
ϕ(zN +1, μm )
m > M 
2 ϕ(zN +1, μm ) =
ϕ(zN , μm )
m ≤ M 
2 
White ϕ(z1, μm ) =
E M 
2 
i=1 wi μi ϕ(z1,μi )
E M 
2 
i=1 wi μi 
m > M 
2 ϕ(zN +1, μm ) =
EM 
i=M/2+1 wi μi ϕ(zN +1,μi )
EM 
i=M/2+1 wi μi 
m ≤ M 
2 
6.3.2 Spherical Geometry 
In curved geometry, i.e. in systems of spherical or cylindrical coordinates, how￾ever, the situation is different from that in the case of plane geometry. In addition to 
problems 1 and 2 mentioned in the introduction, problem 3, the angular derivatives 
in the transport equation must be approximated. These derivatives arise because, 
in streaming, the direction variable of a neutron changes continuously in curved 
geometry. Hence, the streaming term in the transport equation will introduce 
derivatives with respect to the neutron direction μ, i.e. the direction cosine rel￾ative to the radius vector (Fig. 6.7). Consequently, coupling is introduced between 
equations describing neutron flows in discrete directions. In spherical geometry, 
we recall the one-speed transport equation from Chap. 1 [1, 7]. 
μ
∂
∂r 
ϕ(r, μ) +
1 − μ2 
r 
∂
∂μϕ(r, μ) + Et ϕ(r , μ)
= 2π
{
+1
−1 
dμ'
Es (μ0)ϕ
(
r , μ'
)
+ S(r , μ) = q(r, μ) (6.18)
The difficulty in spherical geometry is how to approximate the second term on 
the left-hand side of Eq. 6.18 and especially the derivative ∂ϕ
∂μ. Various possibilities 
have been proposed, most of which introduce a complicated coupling between the 
angular fluxes, ϕ(r, μm ), for various values of μm. For example, Eq. 6.8 could be 
used with the Legendre expansion of the angular flux, with r replacing z, 
ϕ(r , μ) =
N
E−1
n=1 
(2n + 1)
4π
Pn(μ)φ˜n(r )6.3 Numerical Solution of the Discrete Ordinate Equation 157
Fig. 6.7 Change in direction cosine of streaming neutrons
Substituting for φ˜n(r ) from 8, we get 
ϕ(r, μ) =
N 
E−1
n=0 
(2n + 1)
2 
Pn(μ)
E
N
i=1 
wi ϕ(r , μi )Pn(μi )
Taking the derivative with respect to μ and evaluating at μ = μm 
∂ϕ
∂μ
|
|
|
|
μ=μm 
≈
N
E−1
n=0 
(2n + 1)
2 
∂ Pn(μ)
∂μ
|
|
|
|
μ=μm 
E
N
i=1 
wi ϕ(r , μi )Pn(μi )
= E
N
i=1
|N 
E−1
n=0 
(2n + 1)
2 
∂ Pn(μ)
∂μ
|
|
|
|
μ=μm 
wi Pn(μi )
|
ϕ(r, μi ) (6.19) 
The discrete ordinates result is equivalent to the spherical harmonics form in 
spherical geometry. 
6.3.2.1 Conservation Principle 
In spheres, the neutron directions μ = −1 and μ = +1 do not change as a result 
of streaming corresponding to motion straight in toward the center or straight out, 
respectively. This is similar but not exactly to the motion left and right from the 
center of a symmetric slab. At these values of μ, the coefficient 1−μ2 
r ∂
∂μ of ∂ϕ
∂μ
in Eq. 6.18 is zero, and the equation can be solved exactly as in plane geometry. 
The motion of the neutron at the origin of the sphere can be imposed as a symme￾try condition. In deriving the numerical approximation to the transport equation, 
one principle is very helpful. It is that a difference equation for a fundamental 
r and μ cell should obey an explicit conservation law for the neutron economy in 
that cell. When the conservation principle is included in the difference equations,158 6 The Method of Discrete Ordinates: The SN Method
they are usually more accurate than when the derivatives are simply replaced by 
differences without attention being paid to conservation. Moreover, in the absence 
of such a principle, the possible difference equations are so numerous that a good 
choice is difficult to make except by a process of trial and error. This is the reason 
why the neutron transport equation was expressed in conservation. Applying the 
conservation principle, Eq. 6.18 is rewritten as 
μ
r 2 
∂
∂r
(
r 2ϕ
)
+
1 
r 
∂
∂μ
|(1 − μ2)
ϕ
|
+ Et ϕ(r, μ)
= 1 
2
Es (r)
E
M
i=1 
wm ϕ(r, μm ) + S(r, μ) = q(r, μ) (6.20) 
Multiplying Eq. 6.20 by 4πr 2 and integrating over r from ri . to ri+1 and 
multiplying by 2π and integrating over all directions from μ = −1 to μ = +1, 
2π
{
+1
−1 
μdμ
{
ri+1
ri 
dr4πr 2 1 
r 2 
∂
∂r
(
r 2ϕ
)
+ 2π
{
+1
−1 
dμ
{
ri+1
ri 
dr4πr 2 1 
r 
∂
∂μ
|(1 − μ2)
ϕ
|
+ 2π
{
+1
−1 
dμ
{
ri+1
ri 
dr4πr 2Et ϕ(r , μ) = 2π
{
+1
−1 
dμ
{
ri+1
ri 
dr4πr 2q(r , μ)
Rearranging variables 
2π
{
+1
−1 
μdμ
{
ri+1
ri 
dr4π
∂
∂r
(
r 2ϕ
)
+ 2π
{
+1
−1 
dμ
{
ri+1
ri 
dr4πr ∂
∂μ
|(1 − μ2)
ϕ
|
= 2π
{
+1
−1 
dμ
{
ri+1
ri 
dr4πr 2[q(r , μ) − Et ϕ(r , μ)] 
= Production rate − Loss rate 
Integrating the first term over r, it becomes 
2π
{
+1
−1 
μdμ4π
|(r 2 
i+1ϕ(ri+1, μ)
)
− (
r 2 
i ϕ(ri , μ)
)|6.3 Numerical Solution of the Discrete Ordinate Equation 159
And integrating the second term over r and μ, it becomes 
2π
{
+1
−1 
dμ4π
(
ri+1 
∂
∂μ
|(1 − μ2)
ϕ(ri+1, μ)
|
−ri 
∂
∂μ
|(1 − μ2)
ϕ(ri , μ)
|
)
= 2π
(
4πri+1
|(1 − μ2)
ϕ(ri+1, μ)
|
− 4πri
|(1 − μ2)
ϕ(ri , μ)
|)
|
|
|
|
+1 
−1 = 0 
And the conservation equation becomes 
4πr 2 
i+12π
{
+1
−1 
dμ(μϕ(ri+1, μ)) − 4πr 2 
i 2π
{
+1
−1 
dμμϕ(ri , μ)
= Ai+1 Ji+1 − Ai Ji = Production − Loss (6.21) 
Ai+1 is the outer area of the spherical shell at radius ri+1, Ai is the inner area 
of the same shell at radius ri , and Ji+1andJi are the net currents at ri+1 and ri , 
respectively. And, 
Ji = 2π
{
+1
−1 
dμμϕ(ri , μ) and Ji+1 = 2π
{
+1
−1 
dμμϕ(ri+1, μ)
In other words, the conservation Eq. 6.21 states that the net rate at which neu￾trons flow out of the shell is equal to that produced by the source minus the 
neutrons lost due to interactions with the nuclei. 
6.3.2.2 Difference Equations 
The foregoing procedure will now be followed except that the integration will 
be over a cell-edged mesh point. Consider an N × M (μ,r) mesh structure, as 
shown in Fig. 6.8, where the space mesh is bounded between r 0 
n−1 and r 0 
n so that 
points occur on boundaries between homogenous regions and the cross sections are 
assumed to be constant within the interval {
r 0 
n−1,r 0 
n
}
. Since we must consider the 
angular derivative, we incorporate the quadrature set {μm} into an angular mesh 
structure where the points μm are the discrete directions [2, 8].
Equation 6.20 is multiplied by 4πr 2 and integrated over the azimuthal angle 
and between space mesh centers from r 0 
n−1 to r 0 
n and between the angular mesh 
centers from μ0 
m−1 to μ0 
m, and hence we have
8π2 
μ0 
{ m
μ0 
m−1 
μdμ
r 0 
{ n
r 0 
n−1 
∂
∂r
(
r 2ϕ
)
+ 8π2 
μ0 
{ m
μ0 
m−1 
dμ
r 0 
{ n
r 0 
n−1 
r ∂
∂μ
|(1 − μ2)
ϕ
|160 6 The Method of Discrete Ordinates: The SN Method
Fig. 6.8 Angular and space discretization in spherical geometry
= 8π2 
μ0 
{ m
μ0 
m−1 
dμ
r 0 
{ n
r 0 
n−1 
r 2[q(r, μ) − Et ϕ(r, μ)]
Dividing by 2π and integrating in steps 
4π
μ0 
{ m
μ0 
m−1 
μdμ
|(
r 0 
n
)2 
ϕ
(
r 0 
n , μ)
− (
r 0 
n−1
)2 
ϕ
(
r 0 
n−1, μ)|
+ 4π
r 0 
{ n
r 0 
n−1 
r
|{(1 − (
μ0 
m
)2
)}ϕ
(
r, μ0 
m
)
−
{(1 − (
μ0 
m−1
)2
)}ϕ
(
r , μ0 
m−1
)|
dr 
= 4π
μ0 
{ m
μ0 
m−1 
dμ[q(rn, μ) − Etnϕ(rn, μ)] 
r 0 
{ n
r 0 
n−1 
r 2dr 
= 4π
μ0 
{ m
μ0 
m−1 
dμ[q(rn, μ) − Etnϕ(rn, μ)]
((
r 0 
n
)3 − (
r 0 
n−1
)3
)
36.3 Numerical Solution of the Discrete Ordinate Equation 161
which reduces to 
4π
μ0 
{ m
μ0 
m−1 
μ
|(
r 0 
n
)2 
ϕ
(
r 0 
n , μ)
− (
r 0 
n−1
)2 
ϕ
(
r 0 
n−1, μ)|
dμ
+ 4π
r 0 
{ n
r 0 
n−1 
r
|{1 − (
μ0 
m
)2
}
ϕ
(
r , μ0 
m
)
−
{
1 − (
μ0 
m−1
)2
}
ϕ
(
r , μ0 
m−1
)|
dr 
= 4π
μ0 
{ m
μ0 
m−1 
dμ[q(rn, μ) − Etnϕ(rn, μ)]
((
r 0 
n
)3 − (
r 0 
n−1
)3
)
3 
By definition, the neutron flux ϕ(rn, μ) is assumed constant over the space mesh 
and q(rn, μ) is likewise, and the flux ϕ(r, μm ) is also constant over the angular 
mesh, and on substituting, we get 
4π
|(
r 0 
n
)2 
ϕ
(
r 0 
n , μm
)
− (
r 0 
n−1
)2 
ϕ
(
r 0 
n−1, μm
)|
μ0 
{ m
μ0 
m−1 
μdμ
+ 4π
|{1 − (
μ0 
m
)2
}
ϕ
(
rn, μ0 
m
)
−
{
1 − (
μ0 
m−1
)2
}
ϕ
(
rn, μ0 
m−1
)| r 0 
{ n
r 0 
n−1 
rdr 
= 4π[q(rn, μm ) − Etnϕ(rn, μm )]
|(
r 0 
n
)3 − (
r 0 
n−1
)3
|
3 
μ0 
{ m
μ0 
m−1 
dμ
The last step in the integration is 
4π
|(
r 0 
n
)2 
ϕ
(
r 0 
n , μm
)
− (
r 0 
n−1
)2 
ϕ
(
r 0 
n−1, μm
)|1 
2
{(
μ0 
m
)2 − (
μ0 
m−1
)2
}
+ 4π
|{1 − (
μ0 
m
)2
}
ϕ
(
rn, μ0 
m
)
−
{
1 − (
μ0 
m−1
)2
}
ϕ
(
rn, μ0 
m−1
)|1 
2
{(
r 0 
n
)2 − (
r 0 
n−1
)2
}
= 4π[q(rn, μm ) − Etnϕ(rn, μm )] 
1 
3
|(
r 0 
n
)3 − (
r 0 
n−1
)3
|{
μ0 
m − μ0 
m−1
}162 6 The Method of Discrete Ordinates: The SN Method
Defining the spherical shell inner and outer areas and volumes 
A0 
n 
=4π
(
r 0 
n
)2
; A0 
n−1 
= 4π
(
r 0 
n−1
)2
; V0 
n 
= 4π
3
(
r 0 
n
)3
;
V0 
n−1 
=4π
3
(
r 0 
n−1
)3 
and substituting in the above, we get
|
A0 
n 
ϕ
(
r 0 
n , μm
)
− A0 
n−1 
ϕ
(
r 0 
n−1, μm
)
|
1 
2
{(
μ0 
m
)2 − (
μ0 
m−1
)2
}
+
|{1 − (
μ0 
m
)2
}
ϕ
(
rn, μ0 
m
)
−
{
1 − (
μ0 
m−1
)2
}
ϕ
(
rn, μ0 
m−1
)|1 
2
|
A0 
n 
−A0 
n−1
|
= [q(rn, μm ) − Etnϕ(rn, μm )]
|
V0 
n −V0 
n−1
|{
μ0 
m − μ0 
m−1
}
Further, we define α 0 
m 
= 1 
2
{
1 − (
μ0 
m
)2
}
; α 0 
m − 1 
= 1 
2
{
1 − (
μ0 
m−1
)2
}
; and
/μm = {
μ0 
m − μ0 
m−1
}
; μm = 1 
2
{
μ0 
m + μ0 
m−1
}
, and noticing that
(
μ0 
m
)2 − (
μ0 
m−1
)2 = {
μ0 
m − μ0 
m−1
}{μ0 
m + μ0 
m−1
}
; Vshell =
|
V0 
n −V0 
n−1
|
.
Hence, on substituting we get 
μm/μm
|
A0 
n 
ϕ
(
r 0 
n , μm
)
− A0 
n−1 
ϕ
(
r 0 
n−1, μm
)
|
+
|
A0 
n −A0 
n−1
||
α0 
m 
ϕ
(
rn, μ0 
m
)
− α0 
m−1 
ϕ
(
rn, μ0 
m−1
)
|
=/μm Vshell[q(rn, μm ) − Etnϕ(rn, μm )] 
Dividing by Vshell/μm and rearranging, we get 
μm
|
A0 
n 
ϕ
(
r 0 
n , μm
)
− A0 
n−1 
ϕ
(
r 0 
n−1, μm
)
|
+
1 
Vshell/μm
|
A0 
n 
− A0 
n−1
|
×
|
α0 
m 
ϕ
(
rn, μ0 
m
)
− α0 
m−1 
ϕ
(
rn, μ0 
m−1
)
|
− Etnϕ(rn, μm ) = q(rn, μm ) (6.22) 
This equation can be generalized to one-dimensional plane, spherical, and 
cylindrical geometry with the definitions as given in Table 6.4.
There are too many unknowns in Eq. 6.22: 
ϕ
(
r 0 
n , μm
)
+
ϕ
(
r 0 
n−1, μm
)
}
: NM; ϕ
(
rn, μ0 
m
)
+
ϕ
(
rn, μ0 
m−1
)
}
: NM; ϕ(rn, μm ) : NM6.3 Numerical Solution of the Discrete Ordinate Equation 163
Table 6.4 Area and volume 
elements for one-dimensional 
geometries 
Parameter Slab Sphere 
A0 
n 1 4π
(
r 0 
n
)2 
A0 
n−1 1 4π
(
r 0 
n−1
)2 
V shell z0 
n −z0 
n−1 V0 
n −V0 
n−1
Incoming boundary at r = R:MM. 
Streaming inward along the radius vector (μ = −1): N 
q(rn, μm ) : Should be a known quantity 
which sums up to (3NM + N + M) unknowns as compared to NM equations 
(Eq. 6.22). 
In order to make up for the deficiency in the number of equations, we add two 
equations by relating the cell-centered fluxes to the cell-edged fluxes known as the 
diamond difference scheme (Fig. 6.9). 
ϕ(rn, μm ) = 1 
2
|
ϕ
(
r 0 
n , μm
)
+ ϕ
(
r 0 
n−1, μm
)|;
ϕ(rn, μm ) = 1 
2
|
ϕ
(
rn, μ0 
m
)
+ ϕ
(
rn, μ0 
m−1
)| (6.23) 
Equation 6.23 adds 2NM to the NM Eq. 6.22. 
The additional N equations are obtained by considering the starting direction 
μ0 
0 = −1, which corresponds to streaming inward along the radius vector. In this 
case, the transport equation is the same as that of the slab equation. If the flux on 
the surface in the direction of μ = −1; ϕ
(
r 0 
N = R, μ0 
0 = −1
)
is known, then we 
can solve for 
ϕ
(
r 0 
N−1, −1
)
; ϕ
(
r 0 
N −2, −1
)
;......ϕ(
r 0 
0 = 0, −1
)
Fig. 6.9 Cell-centered and 
cell-edged fluxes in a 
diamond scheme 164 6 The Method of Discrete Ordinates: The SN Method
The remaining M equations are streaming from the incoming boundary M/2 
for (μ < 0) at r = R and another M/2 for (μ > 0) at r = 0. That completes the 
necessary number of equations to balance the number of unknowns. 
Such a situation arises, approximately at least, near the center of a large sphere; 
in this case, there is no net current, and the conservation principle requires that 
q(rn, μm ) = Etnϕ(rn, μm ). For Eq. 6.22 to be consistent with this limiting situa￾tion, it is necessary that all the flux values are assumed the same, and they cancel 
out from the streaming term 
μm
|
A0 
n −A0 
n−1
|
+ 1 
Vshell/μm
|
A0 
n −A0 
n−1
|| α0 
m −α0 
m−1
|
= 0 
μm Vshell/μm
|
A0 
n −A0 
n−1
|
= −a0 
m +a0 
m−1 
(6.24) 
This is a recursion relation from which the value of a0 
m can be determined if 
a0 
m−1 
is known. 
Example (showing how a0 
0 
= 0) 
The angular derivative 1 
r ∂
∂μ
|(1 − μ2
)
ϕ
| in Eq. 6.20 as we have said earlier 
should be zero when integrated over all the directions; therefore, since this term 
corresponds to the second term in Eq. 6.22, then, using summation instead 
E
M
m=1
|
a0 
m 
ϕ
(
rn, μ0 
m
)
− a0 
m−1 
ϕ
(
rn, μ0 
m−1
)
|
= a0 
M 
ϕ
(
rn, μ0 
M
)
− a0 
0 
ϕ
(
rn, μ0 
0
)
Since ϕ
(
rn, μ0 
M
)
and ϕ
(
rn, μ0 
0
)
are arbitrary, it is necessary to have 
a0 
0 
= a0 
M = 0 
And Eq. 6.24 for m = 1 and a0 
0 
= 0 gives 
a0 
1 
= −μ1Vshell/μ1
|
A0 
n 
− A0 
n−1
|
And so on for m = 2 it allows to calculate all the coefficients a0 
m by recurrence. 
6.3.2.3 Solution of the Difference Equations 
Firstly Eq. 6.23 is used to rewrite Eq. 6.22 in the following two forms: 
ϕ(rn, μm ) = am 
n ϕ
(
r 0 
n−1, μm
)
+ bm 
n ϕ
(
rn, μ0 
m−1
)
+ cm 
n q(rn, μm ) (6.25) 
ϕ(rn, μm ) = am 
n ϕ
(
r 0 
n+1, μm
)
+ bm 
n ϕ
(
rn, μ0 
m−1
)
+ cm 
n q(rn, μm ) (6.26)6.3 Numerical Solution of the Discrete Ordinate Equation 165
where am 
n ; bm 
n ; and cm 
n are constants. Equation 6.25 is for μm > 0 since 
ϕ
(
r 0 
n−1, μm
) is the incoming flux and ϕ
(
r 0 
n , μm
) is the outgoing flux. Equa￾tion 6.26 is for μm < 0 since ϕ
(
r 0 
n , μm
)
is the incoming flux and ϕ
(
r 0 
n−1, μm
)
is the outgoing flux. The starting point is always from the incoming boundary 
right or left. 
(1) The incoming flux on the surface of the sphere in the direction of μ = −1 
along the radius vector (
ϕ
(
r 0 
N = R, μ0 
0 = −1
)) should be known, then we can 
solve for 
ϕ
(
r 0 
N−1, −1
)
; ϕ
(
r 0 
N −2, −1
)
......ϕ(
r 0 
0 = 0, −1
)
(2) Using Eq. 6.16 for plane geometry with x → r since along the radius and 
μ = −1 the transport equation is the same as in slab geometry. Using Eq. 6.23 
then we calculate 
ϕ(rN , −1); ϕ(rN−1, −1)......ϕ(r1, −1)
(3) Knowing the incoming flux ϕ
(
r 0 
N = R, μ1
)
, and the flux ϕ−1 
N calculated in 
step 1, the flux ϕ(rN , μ1) is obtained using Eqs. 6.25 and 6.26. The surface 
flux ϕ
(
r 0 
N = R, μm
)
is zero if it is a free surface. Next, Eq. 6.23 is modified 
to calculate new edge fluxes horizontally and perpendicularly: 
Horizontally: ϕ
(
r 0 
n−1, μm
)
= 2ϕ(rn, μm ) − ϕ
(
r 0 
n−1, μm
)
. 
Perpendicularly: ϕ
(
rn, μ0 
m
)
= 2ϕ(rn, μm ) − ϕ
(
rn, μ0 
m−1
)
. 
After r = 0 has been reached the next angular sweep m = 2 has begun. 
(4) Once ϕ(rn, μm ) for μm < 0 have been determined we use the reflecting 
boundary condition at r = 0 to determine ϕ
(
r 0 
0 , μM−m+1
)
= ϕ
(
r 0 
0 , μm
)
and 
sweep back to the right for each μm > 0. 
Example Consider the (2 × 2) angle-space mesh as shown in Fig. 6.10. Explain 
the solution progression by tracking the arrows using the appropriate equations 
mentioned above.
Step (1) 
The incoming flux on the surface of the sphere in the direction of μ = −1 along 
the radius vector (
ϕ
(
r 0 
2 = R, μ0 
0 = −1
)) should be known, then we can solve 
for ϕ
(
r 0 
1 , −1
)
; ϕ
(
r 0 
0 , −1
) using Eq. 6.15 for plane geometry with x → r since 
along the radius and direction μ = −1 the transport equation is the same as in 
plane geometry. 
ϕ
(
r 0 
1 ,−1
)
=ϕ−1 (
0 
1
)= (1+h2
E
t2 /2)
(1−h2
E
t2 /2) ϕ−1 (
0 
2
)+ q−1 
2 
(−1/h2+Et2/2) and 
ϕ
(
r 0 
0 ,−1
)
=ϕ−1 (
0 
0
)= (1+h1
E
t1 /2)
(1−h1
E
t1 /2) ϕ−1 (
0 
1
)+ q−1 
1 
(−1/h1+Et1/2)166 6 The Method of Discrete Ordinates: The SN Method
Fig. 6.10 Solution map through a spherical space-angle mesh (N = 2, M = 2)
Using Eq. 6.23, we get 
ϕ−1 
2 = ϕ(r2, −1) = 1 
2
|
ϕ
(
r 0 
1 , −1
)
+ ϕ
(
r 0 
2 , −1
)|;
ϕ−1 
1 = ϕ(r1, −1) = 1 
2
|
ϕ
(
r 0 
0 , −1
)
+ ϕ
(
r 0 
1 , −1
)|
Step (2) 
Knowing the incoming flux ϕ
(
r 0 
2 = R, μ1 = −0.58)
and the flux calculated in step 
1 ϕ−1 
2 and using Eq. 6.26, we calculate ϕ(r2, μ1)
ϕ(r2, −0.58) = a−0.58 
2 ϕ
(
r 0 
2 , −0.58)
+ b−0.58 
2 ϕ(r2, −1) + c−0.58 
2 q(r2, −0.58)
Substituting in Eq. 6.23, we obtain ϕ
(
r 0 
1 , μ1
)
; ϕ
(
r2, μ0 
1
)
. 
Horizontally: ϕ
(
r 0 
1 , −0.58)
= 2ϕ(r2, −0.58) − ϕ
(
r 0 
2 , −0.58)
.
Perpendicularly: ϕ(r2, 0) = 2ϕ(r2, −0.58) − ϕ(r2, −1).6.4 Discrete Ordinates Computer Codes 167 
We move down to the next point to calculate ϕ(r1, μ1) using Eq. 6.26 again 
ϕ(r1, −0.58) = a−0.58 
1 ϕ
(
r 0 
1 , −0.58)
+ b−0.58 
1 ϕ(r1, −1) + c−0.58 
1 q(r1, −0.58)
Next, we calculate the fluxes ϕ
(
r 0 
0 , μ1
)
; ϕ
(
r1, μ0 
1
)
using modified 23 again. 
Horizontally: ϕ
(
r 0 
0 , −0.58)
= 2ϕ(r1, −0.58) − ϕ
(
r 0 
1 , −0.58)
.
Perpendicularly: ϕ(r1, 0) = 2ϕ(r1, −0.58) − ϕ(r1, −1). 
Step (3) 
We use the reflecting boundary condition at (r = 0): 
In this example ϕ
(
r 0 
0 , μ2
)
= ϕ
(
r 0 
0 , μ1
)
. 
The next point in the left to right sweep is to calculate ϕ(r1, μ2) using 26 
ϕ(r1, 0.58) = a0.58 
1 ϕ
(
r 0 
0 , 0.58)
+ b0.58 
1 ϕ(r1, 0) + c−0.58 
1 q(r1, 0.58)
The flux ϕ
(
r 0 
1 , μ2
)
is calculated horizontally using modified 23. 
Horizontally: ϕ
(
r 0 
1 , 0.58)
= 2ϕ(r1, 0.58) − ϕ
(
r 0 
0 , 0.58)
.
The next point is to calculate ϕ(r2, μ2) using 26: 
ϕ(r2, 0.58) = a0.58 
2 ϕ
(
r 0 
1 , 0.58)
+ b0.58 
2 ϕ(r2, 0) + c−0.58 
2 q(r2, 0.58)
The flux ϕ
(
r 0 
2 , μ2
)
is calculated horizontally using modified 23. 
Horizontally: ϕ
(
r 0 
2 , 0.58)
= 2ϕ(r2, 0.58) − ϕ
(
r 0 
1 , 0.58)
.
6.3.3 General Geometry 
The forgoing analysis is sufficient for establishing the numerical methodology and 
the understanding of the solutions to the SN method. Applying it to other geome￾tries, e.g. two-dimensional Cartesian or cylindrical geometries can only add to the 
complexity in the derivations and method of solution. Those who are interested 
can find more details in the literature [9]. 
6.4 Discrete Ordinates Computer Codes 
There are several codes which are based on the discrete ordinates method. They 
differ mainly in dimensions and geometry and method of numerical solution [2]: 
ANISN (ORNL): ANISN is an efficient, multi-group, discrete ordinates (DO) 
code that may be used for neutron or Gamma transport in one-dimensional slab, 
spherical, cylindrical geometries. It allows general order anisotropic scattering. 
Cross-sectional data can be supplied to the code directly or from a cross-sectional 
code output. ANISN offers a wide variety of boundary condition options, source 
options, and criticality search options. It can perform both forward and adjoint 
calculations and produce flux weighted cross sections.168 6 The Method of Discrete Ordinates: The SN Method
DTF-IV (LASL): Similar to ANISN in its capabilities. 
ONETRAN (LASL): Generally similar to ANISN and DOF-IV except it incor￾porates the finite element (FE) method. It deals with problems with severe 
heterogeneity [5]. 
DOT (ORNL): DOT is a multi-group DO code for a two-dimensional geometry. 
It can treat general order anisotropic scattering and has a wide variety of options: 
boundary condition, source, and criticality searches. 
TWOTRAN (LASL): Its capabilities are similar to DOT. 
TRIDENT (LASL): It combines DO with FE. It can be applied to triangular and 
hexagonal meshes and treating strong heterogeneity. 
ORNL: Oak Ridge National Labs, USA. 
LASL: Loss Alamos Scientific Labs, USA. 
Exercises 
1. Rederive Eq. (6.9) explicitly assuming a fission source in the form: 
S˜
n(z) = 2π
E
M
i=1 
wi ν
E
f (z)ϕ(z, μi )Pn(μi )
2. Show that Eq. 6.20 is another form of Eq. 6.18. 
3. Derive the discrete ordinates equations with Gaussian quadrature for anisotropic 
scattering of order L, i.e. 
Demonstrate that these are indeed equivalent to the PN equations provided 
that L < N . 
4. Derive the discrete ordinates equations in 1D slab geometry for the case 
of N = 2 (e.g. the S2 equations). Assume isotropic scattering and choose 
the appropriate angles and weights. Compare the structure of these equations 
with the P1 equations. Assume a steady-state and a homogenous medium for 
convenience. 
5. Using the S2 equations developed in problem 2 derive equations satisfied by the 
sum and difference of the two angular flux components ϕ(z, μ1) = ϕ(z, μ2).
Then show that with appropriate choice of μ1 the flux will have the exact 
asymptotic diffusion length [10, 11]. 
6. By using the forward difference approximation for the derivative of the angular 
flux in the plane geometry discrete ordinates equations, i.e. 
∂ϕ
∂z
|
|
|
|
zn 
∼= ϕn+1 − ϕn
/z 
Show that the corresponding difference equations will yield a positive flux 
no matter what the mesh spacing. Such difference equations are less accurateReferences 169
than the central difference formulae equations which can lead to negative values 
of the angular flux. 
7. Derive the SN equation in spherical coordinates by using linear angular interpo￾lation to develop angular differentiation and quadrature formulas. Use Eq. 6.19 
and the recursion relations in appendix of Chap. 3. 
References 
1. G. Bell, S. Glasstone, Nuclear Reactor Theory (Van Nostrand, New York, 1970) 
2. J. Duderstadt, W. Martin, Transport Theory (Wiley, New York, 1979) 
3. W. Martin, Lecture Notes, on Transport Theory (University of Michigan, Nuclear Engineering, 
1979) 
4. S. Kashi, others, Mesh-free method for numerical solution of the multi-group discrete ordinate 
neutron transport equation. Annal. Nucl. Energy 106 (2017) 
5. T.R. Hill, ONETRAN: a discrete ordinates finite element code for the solution of the one￾dimensional multigroup transport equation (Los Alamos Scientific Lab., N. Mexico (USA) 
1975) 
6. E.T. Tomlinson, W.A. Rhoades, W.W. Engle, Jr., Flux extrapolation models used in the DOT 
IV discrete ordinates neutron transport code (Oak Ridge National Lab., 1980) 
7. J. Duderstadt, Lecture Notes, on Reactor Theory (University of Michigan, Nuclear Engineering, 
1977) 
8. R.E. Alcouffe, E.W. Larsen, W.F. Miller, Jr., B.R. Wienke, Computational efficiency of numer￾ical methods for the multigroup, discrete-ordinates neutron transport equations: the slab geom￾etry case. Nucl. Sci. Eng. 71(2) (1979) 
9. Y. Wu, Z. Xie, U. Fischer, A discrete ordinates nodal method for one-dimensional neutron 
transport calculation in curvilinear geometries. Nucl. Sci. Eng. (1999) 
10. S. Morató, others, Modes of the multi-group neutron transport equation using the discrete 
ordinates and finite difference method. Ann. Nucl. Energy (2019) 
11. J. Ching, E.M. Oblow, H. Goldstein, A discrete energy formulation of neutron transport theory 
applied to solving the discrete ordinates equations. Nucl. Sci. Eng. (1976)7 Computer Simulation of Neutron 
Transport—The Monte Carlo Method 
Applying the Monte Carlo (MC) method to radiation transport is analogous to 
modeling the principles from which the Boltzmann equation is developed. Thus, 
the MC method may be applied to radiation transport without reference to the 
Boltzmann equation. We can follow a totally different approach by simulating the 
particle transport directly on a computer without even referring to the transport 
equation. 
The Monte Carlo method is well suited to solving complicated three￾dimensional time-dependent problems because it does not use phase space boxes. 
No averaging approximation is required in space, energy, direction, and time. This 
is especially important in allowing detailed representation of all aspects of physical 
data. A main feature of the MC method is to use statistical sampling methods to 
simulate transport processes by developing a statistical analogue description of par￾ticle (in this book, we limit ourselves to the neutron) life history on the computer, 
using random sampling methods. Then by running a large number of histories, the 
results can be averaged to obtain estimates of the expected behavior of the particle 
population. MC computer codes can become quite complex. It requires modeling 
the relevant physics of each particle interaction event as accurately as possible by 
allowing the particles to stream freely between interactions. 
The chapter explains the Monte Carlo (MC) method rather than delving into 
the mathematics of physics of collisions. Therefore, in Sect. 7.1, statistical defini￾tions used throughout MC calculations are presented. The methodology of particle 
history generation is presented in Sect. 7.2. In Sect. 7.3, modeling of radiation 
transport parameters including source parameters such as selection randomly of 
the position of the initially emitted particle, its direction, and energy. Also ran￾dom selection of path length before making an interaction, collision parameters 
after interaction, material type upon which the particle is interacting, interaction 
type, and parameters after collision depending on the type of interaction. Methods 
of variance reduction techniques such as weight and source biasing are presented 
in Sect. 7.4. In Sect. 7.5, criticality calculations are discussed, especially the keff
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2023 
R. M. Kuridan, Neutron Transport, Graduate Texts in Physics, 
https://doi.org/10.1007/978-3-031-26932-5_7 
171172 7 Computer Simulation of Neutron Transport—The Monte Carlo Method
cycle and estimators. In Sect. 7.6, we discuss particle scoring and neutron tallies. 
Finally, accuracy, precision, relative error, and figure of merit are pointed out in 
Sect. 7.7. 
7.1 Basic Statistical Definitions 
The MC method has proved to be a powerful and versatile in solving particle 
transport problems of importance to [1]: 
1. Reactor designers 
2. Shield designers 
3. Medical therapy 
4. Complex radiation transport problems 
5. Other non-nuclear engineering problems: 
• Particle physics 
• Quantum field theory 
• Astrophysics 
• Molecular modeling 
• Semiconductor devices 
• Light transport calculations 
• Traffic flow simulations 
• Environmental sciences 
• Financial market simulations 
• Optimization problems 
A brief history: 
• Fermi (1930): random method to calculate the properties of the newly discov￾ered neutron. 
• Manhattan project (the 1940s): simulations during the initial development of 
thermonuclear weapons. 
• Von Neumann and Ulam coined the term “Monte Carlo”. 
• Metropolis (1948) first actual Monte Carlo calculations using a computer 
(ENIAC). 
• Berger (1963): first complete coupled electron-photon transport code that 
became known as ETRAN. 
• Exponential growth since the 1980s with the availability of digital computers. 
We now present statistical definitions used in MC calculation: 
1. Particle history 
The history includes the birth of a particle at its source point, its random walk 
through the transporting medium as it undergoes various scattering interactions, 
and its death which terminates the history.7.1 Basic Statistical Definitions 173
2. Event 
An event is a physical occurrence, for example, a coin toss resulting in a head or 
photon assuming a specific energy E. 
3. Event space 
An event space or sample is the set of all possible events within the process under 
consideration. 
Example: 
A coin toss: (head, tail) 
Photon energy: no. of discrete energy groups or a continuous spectrum. 
4. Random variable 
A variable is random (also called stochastic) if its value cannot be specified in 
advance of observing it, but it is possible to talk in terms of probabilities. It is 
defined as the mapping of an event into a real number. 
Example: 
A coin toss: (0 for head and 1 for tail) 
5. Tally 
Records of all particle parameters during simulation, e.g. flux, current, etc. 
6. Mean value distribution 
When values are discrete, 
x = μx = E
i xi f (xi ); for continuous variables: x = μx = { ∞
−∞ xf (x)dx: also 
called the expected value of (x). 
7. The expected value of g(x) 
g = E
i g(xi ) f (xi ) (discrete); g = { ∞
−∞ g(x) f (x)dx (continuous) 
Example: the mean square distance x2 = E
i x2 
i f (xi )
8. Variance 
The variance of a distribution function is a measure of how closely the distribution 
is grouped around the mean: 
σ2 
x = E
i (xi − μ)2 f (xi ) (discrete) 
σ2 
x = { ∞
−∞(x − μ)2 f (x)dx (continuous) 
show that σ2 
x = x2 − μ2 
x174 7 Computer Simulation of Neutron Transport—The Monte Carlo Method
9. Standard deviation (precision) 
Is often used instead of variance as a measure of the dispersion of the mean. 
σx = (σ2 
x )
1/2 
10. Relative error 
It is defined as the estimated standard deviation of the mean σx divided by the 
estimated mean x; R = σx 
x . It is a measure of the precision of the calculation. 
11. Biasing 
Defined as any means of distorting the sampling technique to advantage without 
losing accuracy. 
12. Probability density function (PDF) 
The probability density function f (x) also called probability distribution function 
or frequency function describes the relative frequency of occurrence of its random 
variable x and its domain (all possible values of x) constitutes the event space. 
13. Continuous event space 
Let P(x < x0 < x + /x) be the probability that a random variable x0 lies within 
interval (x, x + /x) of its event space the PDF f (x) is related to this probability 
by the equality: 
Therefore, f (x) = P(x0)
/x ≈ dP 
dx as dx becomes vanishingly small, thus the PDF 
is central to the prediction problem and the knowledge of the PDF enables one 
to obtain the probability of occurrence of a specific event. The above equation 
shows that the PDF f (x) gives the probability of occurrence per unit interval of 
the random variable x. Over larger interval PDF’s are used with differentials, thus 
P(a < x < b) =
{
b
a 
f (x)dx7.1 Basic Statistical Definitions 175
14. Properties of the PDF 
Since PDFs describe relative frequencies of occurrence of event within an event 
space, two properties of PDFs emerge, 
(i) f (x) ≥ 0 
(ii) { ∞
−∞ f (x)dx = 1 
The first property states that the relative frequencies (i.e. probability values) must 
be positive and the second property states that the property of finding a chosen 
event somewhere within its space must be unity. 
15. Discrete event space 
When the event space is discrete, the random variable can take on selected values, 
PDF f (x) is P(xi−1 < xi < xi+1) = f (xi ). 
Properties: 
(i) f (xi ) ≥ 0 
(ii) E
i f (xi ) = 1 
16. Cumulative density function (CDF) 
Let P(x < x0) be the probability that a random variable x has a value less than 
or equal to some fixed value x0 lies within the event space then the CDF f (x) is 
related to this probability by the equality: 
17. Continuous event space 
P(x < x0) = F(x0) =
{x0
−∞
f (x)dx 
With the restrictions, 
(i) lim 
x0→∞ F(x0) = 1 
(ii) lim x0→−∞ F(x0) = 0 
18. Discrete event space176 7 Computer Simulation of Neutron Transport—The Monte Carlo Method
When the event space is discrete, the random variable can take on selected values, 
CDF f (x) is 
P(xi ≤ xm ) = F(xi ) = Em
i=1 
f (xi )
Now the probability of finding x between a and b is 
P(a ≤ x ≤ b) =
{
b
a 
f (x)dx = F(b) − F(a) = P(x ≤ b) − P(x ≤ a)
19. The making of a PDF: 
If a given distribution does not satisfy the conditions for a PDF it can be 
transformed to a PDF. Suppose q(x) is positive for all values of x then 
f (x) = q(x)
∫+∞
−∞ q(x)dx 
and F(x0) = ∫x0 
−∞ q(x)dx 
∫+∞
−∞ q(x)dx 
Example 
Suppose q(x) = x2 for 2 ≤ x ≤ 4 it is obvious that it does not satisfy the 
conditions for a PDF. According to the last procedure, the PDF is 
f (x) = x2 
∫4 
2 x2dx = 3x2 
56 
and F(x0) = ∫x0 
2 x2dx 
∫4 
2 x2dx 
20. Problem solution 
1. choose f (x) or F(x) and 
2. select a random number ζ . Random numbers ζ from sequence or table of 
positive real numbers distributed uniformly (equally probable) on the interval 
[0, 1]. 
3. equate F(x0) = ζ and solve for x0 by the inverse method 
21. Method of sampling from a distribution function [2] 
Suppose we want to sample the random function cos θ and sin θ. In order to do 
that let us consider a unit circle as shown in Fig. 7.1 and the point (x1, x2) is 
somewhere inside the circle. In general terms, we can define the coordinates as 
x = −a + ζ (2a) and y = −b + ζ (2b) in a rectangle 2a × 2b in dimension with 
the origin at the center. For the square 2 × 2 in Fig. 7.1, x or y = −1 + ζ (2) =
2ζ −1, however, some of the points fall outside the circle but still inside the square, 
therefore,7.2 Particle History Generation 177 
Fig. 7.1 Sampling the 
random function cosθ and 
sinθ
1
-1 1
-1 
1. choose random numbers ζ1 and ζ2 
2. calculate x1, x2 using x1 = 2ζ1 − 1 and x2 = 2ζ2 − 1 
3. reject all points that fall outside the unit circle so that θ will be sampled 
uniformly between (0, 2π) 
4. calculate cos θ = x1 
(x2 
1+x2 
2 )1/2 and sin θ = x2 
(x2 
1+x2 
2 )1/2 
5. the efficiency of sampling is area of circle 
area of square = π
4 
This is the so-called rejection technique which has many applications such as the 
evaluation of integrals and transport kernels and many other things. 
7.2 Particle History Generation 
The following steps summarize the simulation of particle transport in the medium: 
(1) Create a series of life histories of the source particle by using random sampling 
techniques. 
(2) Sample the probability laws that describe the real particle’s behavior. 
(3) Trace out step by step the particle’s “random walk” through the medium. 
(4) The history of a particle is followed until it can no longer contribute 
information of interest to the problem in hand. 
(5) Life history is then terminated and a “new” particle is started from the source. 
(6) Secondary neutron and gamma photon products during collision events are 
tallied and also their histories are followed. 
Figure 7.2 shows the possible events encountered by neutron or photon during 
transport in a fissionable material. The Monte Carlo approach requires the con￾struction of case histories of travel of individual particles through the geometry 
and then analyzes these histories to derive the relevant data, such as flux density 
and dose rate. One particle history includes the birth of a particle at its source, its 
random walk through the transporting medium as it undergoes various scattering 
interactions and its death, which terminates the history. A death can occur when178 7 Computer Simulation of Neutron Transport—The Monte Carlo Method
3 
5 
6 7 
2 
1 
4 Event log 
1- neutron scatter. 
2- fission 
3- neutron capture. 
4- photon capture 
5- neutron leakage 
6- photon scatter. 
7- photon leakage. 
Fissionable material 
neutron 
photon 
Fig. 7.2 Possible events during transport in a fissionable material 
COMPUTE 
PARTICLE 
PARAMETERS 
AFTER 
COLLISION 
(4) 
CHOOSE 
SOURCE 
PARAMETERS 
(1) 
SELECT 
PATH 
LENGTH 
(2) 
SELECT 
COLLISION 
PARAMETERS 
(3) 
Fig. 7.3 Particle history generation 
the particle becomes absorbed leaves the geometric region of interest, or loses 
significance owing to other factors (e.g. low energy) [3]. 
The major steps involved in generating a particle track history after mathemat￾ical modeling of geometry are shown in Fig. 7.3. 
7.2.1 History Generator 
The loop 2 through 4 is continued until the particle parameters fall outside some 
predetermined limit of values such as geometrical bounds, minimum energy or 
minimum statistical weight this process only generates particle histories. Separate 
provision must be made for estimating desirable output quantities such as flux 
density, current density, or interaction densities. The three operations in Fig. 7.3 
involve the selection of parameters at random from a probability of all possible 
values of these parameters thus a sufficiently large number of selections of a given 
parameter would be distributed in the same manner as corresponding probabilities. 
The steps in making a random selection from such probability distributions are 
based on the use of numbers randomly distributed between the limits 0 and 1.7.3 Modeling of Radiation Transport Parameters [4–6] 179 
7.3 Modeling of Radiation Transport Parameters [4–6] 
7.3.1 Source Parameters 
The source parameters include energy, position point of origin, and direction of 
motion of the source particle as well as the biasing parameters. These parameters 
may be independent, or they may be interrelated in various ways for example, 
where the energy distribution is dependent on the direction of motion, the order of 
selection would call first for the selection of initial angle and then for the selection 
from energy distribution application to that angle. 
1. Selection of a spatial point: 
The problem of locating and tracking particles from point to point in material 
region is primarily one the geometry. The means of expressing geometric parame￾ters depend on the choice of the coordinate system: for example, infinite medium 
calculation lend themselves to spherical geometry, but many shielding problems 
are best handled in cylindrical or rectangular geometry. Some examples of the 
selection of source spatial position are discussed in the following paragraphs. 
Example: Selection of the initial source position from a uniformly distributed 
source on a disc (Fig. 7.4). The coordinates determining a point on a disc are 
(r, φ).
Firstly, we suggest the PDF f (r ) = ring area 
disc area = 2πrdr 
π R2 at the radial distance r. 
It stands for the probability that a particle is emitted from anywhere on the ring. 
Check that it satisfies the two conditions for a PDF. The cumulative function is 
ζ = F(r) = 2π ∫r 
0 rdr 
π R2 = r 2 
R2 which should be equated to the random number ζ
giving a random radius: r = R
√ζ . 
Secondly, the selection of the polar angle φ from the PDF f (φ) = diff. angle 
total angle =
dφ
2π which represents the probability that a particle is emitted from a point at angle 
φ at the radius r . ζ = F(φ) = ∫ϕ
0 dφ
2π = φ
2π which gives a random angle as 
φ = 2πζ (a new random number should be selected for each calculation). If 
φ is measured in the range ±π then ζ = F(φ) = ∫ϕ
−π dφ
2π = φ+π
2π , and hence 
φ = 2πζ − π = (2ζ − 1)π.
Fig. 7.4 Sampling of the 
emission position on a disc 
source 
R 180 7 Computer Simulation of Neutron Transport—The Monte Carlo Method
Fig. 7.5 Sampling of the 
position in the cylindrical 
source 
r 
R 
H 
Therefore, the coordinates (r , φ) are replaced by the random coordinates
(
R √ζ ,(2ζ − 1)π
)
. This may be extended to cylindrical geometry by consider￾ing the third dimension z since the disc is just the base of the cylinder (Fig. 7.5). 
The PDF in the axial direction is just f (z) = dz 
H which is just the probability that 
the particle will be emitted from dz at (r, φ). 
The CDF is 
ζ = F(z) = ∫z 
0 dz 
H = z 
H and hence, z = ζ H. 
Therefore, the cylindrical coordinates (r ,φ,z) are replaced by the random coor￾dinates (
R
√ζ ,(2ζ − 1)π, ζ H)
. Nonuniform source distribution can be considered 
as well. 
2. Selection from an energy distribution: 
The energy of the particles emitted from the source is sampled using the emission 
spectrum, κ(E) characteristic of the source but it has to be converted to a PDF 
f (E) first 
f (E) = κ(E)
∫Emax 
0 κ(E)dE 
where, Emax is the energy upper limit in the emission spectrum. The corresponding 
CDF F(E) is 
F(E) = ∫E 
0 κ(E)dE 
∫Emax 
0 κ(E)dE 
The function F(E) will always be monotonically increasing having a maximum 
value of 1.0 the random choice of the energy of emitted particle is done by using 
a random number within the range (0 ≤ ζ ≤ 1) such that 
ζ = F(E) = ∫E 
0 κ(E)dE 
∫Emax 
0 κ(E)d E7.3 Modeling of Radiation Transport Parameters [4–6] 181 
From this equation, the random value of E can be obtained by using any one 
of the root-finding techniques such as bisection method, Newton Raphson method, 
etc. When cumulative energy distribution is given at some energy data points, the 
source energy selection process is shown in Fig. 7.6. 
3. Selection of the initial direction: 
The unit vector o represents the direction of a particle. Figure 7.7 shows the 
cylindrical volume source. o is described by the two angles (θ , ϕ) in spherical 
coordinates. If isotropic emission is assumed, then it can be represented geometri￾cally by equally probable (isotropic) vectors from the point of emission as shown 
in Fig. 7.8. 
The calculation of the PDF proceeds for the angle θ first. The probability of 
emission with an angle θ in dθ is just the area of strip divided by the area of a
generate a 
Random 
Number 
set 
= 
Evaluate E 
From stored 
Values of 
 vs 
Fig. 7.6 Sampling of source energy 
Fig. 7.7 Source particle 
coordinates in a cylinder 
Fig. 7.8 Sampling of a 
source particle direction 
(θ , ϕ) in the spherical volume 182 7 Computer Simulation of Neutron Transport—The Monte Carlo Method
unit sphere (4π). The strip is a ring of radius sin θ and thickness dθ. Therefore, 
the strip area is 2π sin θdθ. The PDF is f (θ) = 2π sin θ
4π = sin θ
2 And the CDF is 
ζ = F(θ) =
1 
2 ∫θ
0 sin θdθ
1 
2 ∫π
0 sin θdθ = 1 
2 
(1 − cos θ)
from which θ = cos−1(1 − 2ζ ) The angle ϕ is selected as in the case of the 
angle ϕ of the position coordinates ϕ = (2ζ − 1)π. Finally, the random direction 
coordinates are defined as |
cos−1(1 − 2ζ ),(2ζ − 1)π
|
. Of course, the selection of 
direction parameters are independent of the shape of the spatial selection in the 
source volume. In the case of an isotropic surface source, the direction should be 
selected randomly from a 2π half-space 
ζ = F(θ) =
1 
2 ∫θ
0 sin θdθ
1 
2 ∫π/2 
0 sin θdθ = 1 − cos θ and θ = cos−1 ζ
Non-isotropic distributions can be considered as well. 
7.3.2 Path Length 
The path length along the parameters of initial direction defines the point at which 
an interaction occurs. 
1. Path length in a single region: 
Assume initially a single infinite region through which particles are being tracked. 
If the total macroscopic cross section of the region is Et (E), then the number of 
particles of energy E (making no collisions scattering or absorption) penetrating 
to depth L (Fig. 7.9) out of N0 trials is N0e−Et (E)L , hence the probability of 
penetration to depth L without making a collision is just 
P(L) = number penetrating to depth L 
number of trials = e−Et (E)L
The probability of particle interaction at some path length less than or equal to 
L is thus given by 
F(L) = 1 − P(L) =
|
1 − N0e−Et (E)L
|
If the path length L to first collision is to be sampled at random, the random 
number, ζ is set equal to F(L), or 
ζ = F(L) =
|
1 − e−Et (E)L
|
or7.3 Modeling of Radiation Transport Parameters [4–6] 183 
Fig. 7.9 Path length in a 
single region
L1 
L2 
L=A 
1 − ζ = e−Et (E)L 
giving 
L = − 1
Et (E)
ln(1 − ζ )
Since (1 − ζ ) is distributed in the same manner as ζ , we can rewrite: 
L = − 1
Et (E)
lnζ
Suppose now that a single region is bounded such that the boundary is encoun￾tered at path length = A, then, if the randomly selected path length exceeds the 
value of A then the particle will be assumed to have escaped the system and history 
will be terminated, otherwise, collision will be assumed to have occurred at the 
selected point and collision parameters will be calculated. As a matter of fact, the 
value of A will be a function of the initial direction of the particle and the geom￾etry of the region boundary and it is not the region thickness per say. It should be 
calculated after the source direction has been selected so that it will be available 
for test against L. 
2. Path length in a multi-region: 
Consider Fig. 7.10 where a point source is outside several homogenous layers 
with different properties. A ray extending in the direction of the particle motion 
encounters region boundaries in the various regions given by A1, A2,... AN with 
associated total x-sections given by
Et1(E), Et2(E), ······ EtN (E)184 7 Computer Simulation of Neutron Transport—The Monte Carlo Method
Fig. 7.10 Interaction 
probabilities for several 
homogenous layers 
The effect of successive probabilities is such that the escape probabilities 
from the entire system is equal to the product of the individual zone penetration 
probabilities. The total escape probability will be given by 
p = e−(Et1 A1+Et2 A2+······EtN AN )
The fate of the particle along the track could be determined in the following 
ways: 
First method: 
1. Select a path length at random assuming an infinite medium with cross section
Et1(E) using the equation L = − 1
Et1(E)lnζ above. 
2. If L1 exceeds A1, move the particle to the point where its track intersects the 
boundary between region 1 and region 2. 
3. Select a path length at random in the original direction, assuming an infinite 
medium with a x-section Et2(E). 
4. If L2 exceeds A2, move the particle to the point where its track intersects the 
boundary between region 2 and region 3. 
This procedure is repeated until one of the Li ≤ Ai or until the particle escapes. 
Second method: 
Instead of selecting path length in each of the materials successively as described 
in the first method, it would be perhaps simpler to decide the fate of the par￾ticle by selecting only one random number. For this purpose, we will define 
b = E
i AiEti (E) where Ai are defined as before lying along the particle path 
between the source point and the first collision. Then the total escape probability 
will be given by 
p = e−(Et1 A1+Et2 A2+······EtN AN ) = e−b7.3 Modeling of Radiation Transport Parameters [4–6] 185 
Fig. 7.11 Path length selection method for several homogenous layers 
The probability of interaction at some path length (≤ L) is given by 
ζ = F(L) =
|
1 − e−b
|
hence, b = lnζ . The process of finding the path length corresponding to the 
selected value of b is symbolized in the flow chart of Fig. 7.11. 
7.3.3 Collision Parameters 
When it has been determined on the basis of total material cross section that a 
collision has occurred, it is then necessary to determine which of the possible 
nuclear species is involved and which of the possible interactions of that species 
has taken place. 
7.3.3.1 Type of Material 
In a material containing several elements of atomic density Ni and total x-section 
σti such that the total cross section is defined as Et = EN 
i=1 Ni σti , the probability 
of a particle species being involved is given by the fraction of the total cross 
section represented by that species Ni σti
Et . The nucleus involved in a collision can 
be obtained by selecting a random number ζ and comparing it to the cumulative 
distribution function 
F(k) =
Ek 
i=1 Ni σti
Et 
= ζ
Solving for k (the kth species) where k is an integer between 1 and N .
Figure 7.12 shows the scale by total cross sections of the material mixture.
7.3.3.2 Type of Interaction 
The type of interaction can be determined by comparing the random number ζ to 
the CDF F(l) =
El 
j=1 σij 
σti = ζ where σij is the jth type of interaction belonging186 7 Computer Simulation of Neutron Transport—The Monte Carlo Method
Fig. 7.12 Random selection of material type from material mixture
Fig. 7.13 Random selection 
the type of interaction 
to the ith type nucleus determined previously and l is an integer between 1 and 
M and M is the total number of interaction types. For neutrons, σij can be the 
microscopic cross section for elastic scattering, absorption, (
n.n'
)
, (n.2n), (n.α), 
etc. Secondary neutrons or gamma rays resulting from the interaction are stored 
(banked) and later processed. Therefore, tracking is delayed until the histories of 
the incident particles are terminated in a separate program. For gamma rays,σij 
can be the cross section for Compton scattering (Cs), photoelectric absorption 
(pe), or pair production (pp) (electron–positron pair). In the case of pp and pe 
history will be terminated although two photons are eventually emitted by positron 
annihilation. 
Example 
Consider the x-sections σs = 20b, σc = 30b, σ f = 500b, and σt = 550b 
(Fig. 7.13). 
To select which type of interaction has occurred check the following: if ζ < 20 
550 
then the interaction is scattering; if 50 
550 > ζ ≥ 20 
550 then the interaction is capture; 
and if 1 > ζ ≥ 50 
550 then it is fission. The choice of collision parameters is not an 
easy task. First, a large amount of x-section data has to be formatted and coded 
properly in libraries with the associated interpolation subroutines. 
7.3.3.3 Parameters After Collision 
After determining the path length, we automatically assume a collision has taken 
place so the type of nucleus is determined followed by the type of collision. If 
the type of collision leads to the termination of particle history, then tracking is7.3 Modeling of Radiation Transport Parameters [4–6] 187 
stopped. Secondary particles if created are banked for later tracking. Otherwise, 
a scattering collision is assumed and the parameters after collision must be deter￾mined. Neutron transport in the reactor and hence criticality calculations are our 
main concern, therefore only MC applications to the interactions of neutrons are 
discussed in this chapter and MC simulation of gamma and electron interactions 
are excluded. 
1. Elastic scattering: (σe) 
In elastic scattering, the incident neutron gives off some of its energy to the recoil￾ing nucleus. It is isotropic in the COM for light elements. For heavy elements, it 
becomes more complicated and forward. Anisotropic scattering becomes important 
as the energy of the incident neutrons increases. The elastically scattered neutron 
energy is given by 
E'
E = A2 + 2A cos θc + 1 
(A + 1)2 
The angles in both systems are related by 
cos θL = A cos θc + 1
(
A2 + 2A cos θc + 1
)1/2 
A schematic diagram for elastic scattering in the LAB and COM before and 
after collision is shown in Fig. 7.14. The final energy is minimum (maximum 
energy loss) when the neutron is backscattered (θC = π), and hence Emin 
E = |
A−1 
A+1
|2 
. In the case of isotropic scattering in the COM the average cosine of the 
scattering angle in the LAB is given by cosθL = 2 
3A . The angle in the COM is 
selected randomly from μ = cosθc = 2ζ−1. For other distributions, the differen￾tial angular scattering cross section σ(θc, E) is used for random selection of the 
angle. The CDF is calculated from 
F(θc, E) = ∫θc 
0 σ(θc, E)dθc 
∫π
0 σ(θc, E)dθc 
= ζ
Once the scattering angle in the COM is obtained, the energy loss is calculated 
from relations which were presented previously. Once the angle and energy are 
obtained, the azimuthal angle ϕ (0 ≤ ϕ ≤ 2π) should be randomly selected from 
an isotropic distribution, hence ϕ = 2πζ . Figure 7.15 shows the steps of random 
calculations for elastic scattering angles and emerging energies.188 7 Computer Simulation of Neutron Transport—The Monte Carlo Method
Fig. 7.14 Elastic scattering in the LAB and COM before and after collisions
Fig. 7.15 Random selection of elastic scattering angles from the differential cross section 
2. Inelastic scattering: (σin)
In inelastic scattering, the neutron is absorbed by the target nucleus forming the 
compound nucleus which gives off a neutron and remains in the excited state 
which subsequently decays by photon emission. Neutron energies must be high 
enough to cause an inelastic reaction. It requires higher energies for light nuclei 
and lower energies for heavier nuclei. It is worth mentioning that the energy loss 
mechanism is via elastic scattering in the case of collisions with light nuclei and 
via inelastic scattering in the case of heavy nuclei. 
The total inelastic cross section is divided into two components firstly, σnn'(L)
which is the probability that the nucleus is excited to any level L from which189 
gamma rays are emitted and secondly, σnn'(C) which is the probability that the 
nucleus is excited to the region where levels are closely spaced and the emission 
is continuous. 
The kinematic equation for inelastic scattering is given by 
E'
E = 1 
(Ai + 1)2
|
1 + A2 
i
(
1 − ε
E
)
+ 2Ai cosθc
(
1 − ε
E
)1/2
|
cosθL = 1 + Ai cosθc
(
1 − ε
E
)1/2
|
1 + A2 
i
(
1 − ε
E
)
+ 2Ai cosθc
(
1 − ε
E
)1/2
|1/2 
The neutron energy required for an excitation of particular level is 
E > [(A + 1)/A]ε
where angles are defined as before and ε is the excitation energy of the tar￾get nucleus. Sampling from inelastic scattering cumulative distribution function 
is treated in the same manner as in elastic scattering. 
3. Calculation of the emergent direction cosines: 
If the direction cosines of the incident particle before the reaction are (α, β, γ ) and 
the direction cosines after scattering are (α'
, β'
, γ '
), and the scattering angle in the 
LAB is θL and the azimuthal angle is ϕ the relations between the two cosines are 
given by 
α' = αcosθL + γ α
sinθL cosϕ
(1 − γ 2)1/2 − β
sinθL sin ϕ
(1 − γ 2)1/2 
β' = βcosθL + γβ
sinθL cos ϕ
(1 − γ 2)1/2 − α
sinθL sin ϕ
(1 − γ 2)1/2 
γ ' = γ cosθL + (1 − γ 2)
1/2sinθL cos ϕ
if (
1 − γ 2
)
→ 0 
α' = sinθL cos ϕ
β' = sinθL sin ϕ
γ ' = γ cos ϕ190 7 Computer Simulation of Neutron Transport—The Monte Carlo Method
7.4 Variance Reduction Methods 
7.4.1 Particle Weight 
If the simulation is exactly a physical transport, then each simulated particle would 
represent one physical particle and would have a unit weight. However, for com￾putational efficiency, the simulation allows many techniques that do not exactly 
simulate physical transport. For instance, each simulated particle might represent 
a number w of particles emitted from a source. This number w is the initial weight 
of particle simulation. The w physical particles all would have different random 
walks, but the one simulated particle representing these w physical particles will 
only have one random walk. Clearly this is not an exact simulation; however, the 
true number of physical particles is preserved in the simulation in the sense of sta￾tistical averages and therefore in the limit of a large number of simulated source 
particles (of course including particle production or loss if they occur). Each sim￾ulated particle result is multiplied by the weight so that the full results of the 
w physical particles represented by each simulated particle are exhibited in the 
final results (tallies). This procedure allows users to normalize their calculations 
to whatever source strength they desire. A second normalization to the number of 
Monte Carlo histories is made in the results so that the expected means will be 
independent of the number of source particles actually initiated in the calculation. 
Therefore, the result is given per one source particle and the more histories simu￾lated the better the statistics. The real number of particles at any point is just [3, 
7, 8, 9]: 
[the actual source strength × MC result]
Noting that: 
Sometimes the number of sampled source particles are artificially increased in some direc￾tion or energy bins or position by a specified factor hence increasing the number of histories 
in order to improve statistics. At the end of the random walk, bias is neutralized by dividing 
the MC results by the same factor. 
7.4.2 Source Biasing Parameters 
In certain calculations it may be desirable to prejudice the selection of one or 
more source parameters to favor those most likely to contribute to the quantity of 
interest such as shield leakage or detector response. This can be done by selecting 
a larger number of source particles in the favored direction and assigning to each 
particle a number called its weight to adjust for a bias that was introduced. The 
benefit is to reduce drastically the tracking time.7.4 Variance Reduction Methods 191
Fig. 7.16 Biased tracking toward point B 
Table 7.1 Weight balance in a biased case 
Unbiased case Biased case 
No. of histories Weight (w) No. of histories Weight (w) 
Histories in /o 2000 1 8000 1/4 
Histories outside /o 9000 1 3000 3 
Total 11,000 11,000 
Example 
Suppose there is a total of 10,000 source particle histories to be tracked from 
which 2000 in /o (Fig. 7.16). However, the detector recording at B is the main 
objective of the calculation. Therefore, we will bias the flux in /o and make it 
6000 and leave the 4000 outside /o. This will require weight of (1/3) in /o and 
weight of (2) in the outside in order to neutralize the bias. In order to obtain a 
near true measurement at the detector, /o should be carefully chosen. Table 7.1 
explains the weight balance in this biasing case. 
Situations where biasing might be used include: 
(1) selecting more source points near the periphery of the reactor 
(2) selecting more particles with an initial direction toward the shield or detector 
(3) selecting more particles with a high energy or with an energy corresponding 
to a low total cross section. 
It is important to remember that an adjustment of one category (e.g. angle bin or 
energy group) effects not only the bin or group but the entire distribution. 
7.4.3 Variance Reduction Techniques 
When most of the computation time is spent on more probable particle histories 
that do not contribute to the desired result, extra effort is required to increase 
the sample size seeking accuracy in the less probable more important rare events. 
The wasteful effort may lead to exceeding the Random Number Generator (RNG) 
capability giving rise to correlated samples. Therefore, not just computer time and192 7 Computer Simulation of Neutron Transport—The Monte Carlo Method
economics are of concern, rather the RNG finite period may be exceeded. There￾fore, is it possible to reduce the relevant numerical and statistical uncertainty errors 
associated with the MC calculation without increasing sample size? The answer is 
through the variance reduction technique, the computer time can be reduced and 
still obtain results of sufficient precession. Common variance reduction techniques 
in Monte Carlo calculations are listed below: 
1. Energy cutoff 
Particles are terminated when their energy falls below a predetermined energy cut 
off. It should be noted that: It is a user supplied low limit on energy. 
• If particle energy falls below the specified limit it is killed with zero probability. 
• It should be used only when it is known that the low energy particle is not 
important. 
Remembering that: 
1. Low energy neutrons may produce high energy ones e.g. fission. 
2. Low energy neutrons may be in some regions have more importance e.g. reactor 
core. 
3. Neglecting weight of low energy particles by zero kill probability may make 
the answer biased low. Russian roulette (RR) is played to preserve weight. 
4. If particle is not killed with RR, it is continued but weight is increased by the 
reciprocal of the survival probability to conserve weight. 
2. Time cutoff 
Particles are terminated when their time exceeds the time cutoff. It is for time 
dependent problems. 
3. Importance 
We define the importance of a cell as the expected score when a unit weight 
particle will generate after entering a cell. 
Importance(expected score)=
total score generated by particles 
(and thier progony) entering the cell 
total weigt entering the cell 
After the importances have been generated the weights are assigned inversely 
proportional to the importances. Zero importance regions imply killing particles 
e.g. a surrounding infinite void where tracking is no longer desired.7.4 Variance Reduction Methods 193
Fig. 7.17 Particle splitting 
4. Geometry splitting/Russian roulette 
Particles are increased in number when move to important directions (Fig. 7.17). 
1. When m' > m, the particle is split into m'
m ∼ 2 or 4 ... splits, however weight 
is reduced by m 
m' to become W' = m 
m' W. 
2. When m' < m Russian roulette is played and the particle is killed with a 
probability of (
1 − m'
m
)
. 
3. Or followed further with a probability m'
/m and weight W' = m 
m' W. 
Russian roulette procedure (play) is used to randomly terminate particle his￾tory moving toward less important phase space regions. The importance number 
assigned to a region is dictated by how important it is and the number assigned 
will determine the action taken weather it is 1 or (2 or 3). 
5. Energy splitting/Russian roulette 
In space energy problems, particles are more important in some energy ranges 
than in others. For example, in a reactor core where fission occurs by thermal 
neutrons with a high probability so in the case of small number of fissions are 
taking place. Once a neutron falls below a certain energy level it can be split into 
several neutrons with appropriate weight adjustment. 
6. Weight cutoff 
It is a lower bound on weight e.g. if the weight of a particle reaches a preset lower 
bound Russian roulette is played and its weight is transferred to other particles. 
7.4.4 Neutron/Photon Problem 
When photons are produced in a neutron problem where photons are also tracked, 
such as in shielding problems, the weight of photons is 
WP = Wnσγ
σt194 7 Computer Simulation of Neutron Transport—The Monte Carlo Method
where, 
Wn neutron weight 
σγ photon production x-section 
σt total neutron x-section 
σγ , σt are calculated at the energy of the incident neutron. 
1. Capture 
(1) In analog capture, the particle is killed with a probability σa 
σt and σa =
σn,γ , σn,α, σn,d , ··· . Neutron energy and weight are deposited in the collision 
cell when particle is killed. 
(2) In Implicit capture, weight is reduced to W'
n as follows: 
W'
n =
|
1 − σa 
σt
|
Wn or W'
n =
|
σs 
σt
|
Wn 
It represents the probability of survival (no capture) and Wn − W'
n = |
σa 
σt
|
Wn is deposited in addition to energy. If W'
n is equal to a problem weight 
cut off (on a cut card), Russian Roulette is played and of course its weight is 
transferred to other particles resulting in fewer particles with larger weight. 
(3) Implicit capture along a flight distance to scatter l = − 1
Es ln(1 − ζ ). The 
particle weight is reduced at the scattering point by the capture loss W' =
W e−Eal since capture did not take place. 
A final remark on the variance reduction methods is that all the schemes employed 
aim at varying the importance sampling. One should be cautious in implementing 
schemes because they may increase variance. Fortunately, in criticality problem 
calculations we only need some simple schemes of cell importance. 
7.5 Criticality Calculations 
Nuclear criticality is the ability to sustain a chain reaction by fission neutrons, 
and characterized by keff is thought of as the ratio between the number of neu￾trons in successive generations, with the fission process regarded as the birth 
event that separates generations of neutrons. In criticality applications, the effective 
multiplication factor of an assembly is of primary interest [3, 10, 11]. 
7.5.1 keff Cycle 
A group of neutron histories is often referred to as a keff cycle or neutron gen￾eration with the multiplication factor of the assembly given by the ratio of the7.5 Criticality Calculations 195
number of neutrons generated at the end of the keff cycle (i.e., those created in fis￾sion events in this cycle) to the number of neutrons whose histories are evaluated 
in this cycle (i.e., the number at the start of a generation). In short, 
keff = number of neutrons in a generation 
number of neutrons in a previous generation 
A generation is defined as the period between birth of a neutron to its death by 
escape, parasitic capture, or absorption leading to fission. It is the computational 
equivalent by MC to a fission generation. (n, 2n),(n, 3n) are not considered as 
termination and are internal to the cycle. It is optional to include delayed neutrons. 
The expected value of the multiplication factor is then estimated by averaging 
over the events in the keff cycle. In the same way, the expected value of the leak￾age probability or the fraction of events leading to capture can also be obtained. 
The relative error in the estimate of the effective multiplication factor will usu￾ally decreases as the number of keff cycles increase. Thus, numerous cycles are 
necessary to arrive at a good estimate of keff. In addition, the first few cycles are 
inaccurate because the spatial neutron source has not converged. Because the dis￾tribution of source (fission) neutrons in a system is dependent on the eigenvalue 
of the system and on its geometry, it takes a number of inactive cycles for the 
Monte Carlo spatial neutron distribution to approach the converged distribution. 
For this reason, the first few cycles are ignored in the final estimate of keff. The 
estimates of keff from the remaining cycles are averaged to obtain a mean value 
for the effective multiplication factor. Criticality calculation in a Monte Carlo code 
such as MCNP (A General Monte Carlo N-Particle Transport Code) is performed 
through a special card known as KCODE card which describes the initial source 
distribution, skipped cycles, total cycles, etc. For example, let’s say we evaluated 
G generations and discarded the first D of them. (It is recommended that G −
D > 100 to observe any trends in the calculations.) Then the estimated effective 
multiplication factor of the system is given by 
keff = 1 
(G − D)
E
G
i=D+1 
ki 
eff 
where keff is the estimated system multiplication factor and ki 
eff is the multiplica￾tion factor determined from the ith cycle. The repeatability of the estimate (i.e., 
if the same calculation is performed with different random numbers, how much 
different will the estimate of keff be?) is determined from the estimated standard 
deviation of the mean. The standard deviation of the mean is calculated using the 
standard deviation, σS, of the distribution of keff-values. 
σS =
||||
1 
(G − D − 1)
E
G
i=D+1
(
ki 
eff − keff)2196 7 Computer Simulation of Neutron Transport—The Monte Carlo Method
For a valid Monte Carlo calculation, the range keff − σ to keff + σ should include 
the precise keff result about 68% of the time. The final result of the Monte Carlo 
calculation would be reported as keff ± σ for a nominal 68% confidence inter￾val,keff ± 2σ for 95% and keff ± 2.6σ for a 99% confidence interval for large N. 
These percentages refer to the fraction of the time the precise value of keff included 
in a confidence interval. MCNP has three different estimators for keff: collision, 
absorption, and track length between collisions. A statistically combined average 
is used as the final keff. 
7.5.2 keff Estimators 
There are several estimators for the multiplication factors, such as collision, 
absorption, track length, and prompt removal lifetime. The difference between 
implicit absorption k A 
eff and collision kC 
eff estimators is that in the absorption esti￾mator only the nuclides involved in collision are used for the estimation of the keff 
rather than an average of all nuclides in the material for the collision estimator. 
The track length estimator kTL 
eff is accumulated every time the neutron traverses 
a distance in a fissionable material cell. Monte Carlo codes Sampling the proba￾bility distributions during particle history simulation are taken from the detailed 
physics of the problem. They are deducted from the deterministic formulae of 
the relevant physics of interaction. This direct approach is called the physical ana￾logue approach which is quite lengthy and time-consuming. The modern MC codes 
rather develop sampling procedure from the integral form of the transport equa￾tion. The reader may consult specialized references for the mathematical details. 
There are many codes based on the Monte Carlo method. They have developed so 
rapidly as the capabilities of computers evolved. Some of these codes are MORSE, 
MCN, NCNG (LASL), Tripoli, TART (LLL), and more recently the well-known 
MCNP (LASL) series. Figure 7.18 shows the general organization of an MC code.
7.6 Particle Scoring 
The discussion so far has been concerned with the generation of source particles, 
tracking to the first collision and the determination of the new particle direction and 
energy following a collision. This is continued until particle history is terminated. 
Large number of histories and variance reduction methods must be employed in 
order to obtain acceptable statistics for the physical quantities desired in the energy, 
angle bins and spatial cells defined. Such physical quantities are [3]: 
(1) Flux density as a function of space, energy, and direction 
(2) The penetration dose or flux 
(3) Time dependence of arriving particles 
(4) The energy and angular distributions of the penetrating particles7.6 Particle Scoring 197
Fig. 7.18 The general organization of an MC code
7.6.1 Neutron Tallies 
A Monte Carlo code like MCNP provides: 
1. A standard summary information that includes: 
• Creation and loss of tracks and their energies 
• Tracks entering and reentering a cell and track population in the cell 
• Number of collisions in the cell 
• Average weight, mean free path, energy tracks in the cell 
• Activity of each nuclide in cell (interactions of with each nuclide in the cell, 
not radioactivity) 
• A complete weight balance for each cell 
2. Seventeen standard tally types: 7 (neutron tallies); 6 (photon tallies); 4 (electron 
tallies). They can be modified by the user in many ways. They are normalized 
per starting particle except in KCODE criticality problem, which are normal￾ized to be per fission neutron generation. There is also a plotter for displaying 
results. 
Table 7.2 lists the basic standard tally types. N, E, P refer to neutrons, electrons, 
and photons respectively. Table 7.3 shows the mathematical definitions of the 
physical quantities defined by the tally. The starred tallies are the same physical 
quantities in units of energy.
Note that cell flux becomes a surface flux when the cell becomes so thin. Also, 
the units of the flux follow the units of the source, e.g. S (n/s) give a flux in units 
of (n/cm2-s). In criticality calculations since the sources are fission sources the198 7 Computer Simulation of Neutron Transport—The Monte Carlo Method
Table 7.2 MCNP standard tallies 
Fn Unit Name *Fn Unit 
F1:N,E,P Surface current E MeV 
F2:N,E,P 1/cm2 Surface flux E MeV/cm2 
F4:N,E,P = Track length estimate of cell flux E = 
F5a:N,P = Flux at a point or ring detector E = 
F6:N,E,(N,P) MeV/g Track length estimate of energy 
deposition 
1.6022E-22 Jerks/g 
F7:N = Track length estimate of fission energy 
deposition 
1.6022E-22 = 
F8:N,E,P,(P,E) Pulses Pulse height tally E MeV 
Table 7.3 MCNP 
mathematical definitions of 
the tally physical quantities 
Fn Physical quantity 
F1 J = {
A d A{
μ dμ{
t dt {
E d E|μ|AΦ(r, E,μ, t)
F2 8s = {
A dA 
A
{
t dt {
E d EΦ(r, E, t)
F4 8V = {
V dV 
V
{
t dt {
E d EΦ(r, E, t)
F5 8PD = {
t dt {
E d EΦ(r, E, t)
*Fn Physical quantity × MeV 
*F1 {
A d A{
μ dμ{
t dt {
E d E E|μ|AΦ(r, E,μ, t)
*F2 {
A dA 
A
{
t dt {
E d E EΦ(r, E, t)
*F4 {
V dV 
V
{
t dt {
E d E EΦ(r, E, t)
*F5 {
t dt {
E d E EΦ(r, E, t)
units are deduced from the reactor power. The following conversion is used:
( J/s 
w − s
)( 1 MeV 
1.602 × 10−13J
)( fissions 
180 MeV)
= 3.467 × 1010fissions/w − s 
Therefore, in order to produce a power of P watts we need (3.467 ×
1010P) fissions/s. this power level produces (
3.467 × 1010P ν
)
neutrons/s which 
is the neutron source strength per second for a power level P in watts. 
7.7 Accuracy, Precision, Relative Error, and Figure of Merit 
A systematic error (true value of x − x) is a measure of how close is the expected 
value of (x) to the true value of x, which is seldom known [12].7.7 Accuracy, Precision, Relative Error, and Figure of Merit 199
Fig. 7.19 The meaning of 
precision and accuracy 
Systematic error 
True 
value 
MC 
estimate 
Table 7.4 Interpretation of 
the relative error Range of R = Sx /x Quality of tally 
0.5–1 Completely unacceptable 
0.2–0.5 Still unacceptable 
0.1–0.2 Questionable (undependable) 
<0.1 Generally reliable (not for point detector) 
<0.05 Generally reliable (for point detector) 
7.7.1 Precision 
The standard deviation σx =
/
x2 − x2 is a measure of precision of the Monte 
Carlo estimate. However, it is possible to get a highly precise result that is far 
from the true value if the model is not faithful. Figure 7.19 shows the meaning of 
precision and accuracy. 
7.7.2 Relative Error 
The relative error is a measure of calculation precision. Based on the long expe￾rience of MC practitioners, Table 7.4 presents the recommended interpretation for 
various values of the relative error R associated with an MCNP tally. 
7.7.3 Figure of Merit 
The estimated relative error squared, R2, should be proportional to 1 
N that is R2 ∝
1 
N where N is the number of histories. The computer time T should be proportional 
to N (T ∝ N ). Therefore, R2T = const. The figure Of Merit (FOM) is defined 
as FOM = 1 
R2T . The FOMs should always be examined against the number of 
histories for each tally that are approximately constant. It is a good measure of the 
efficiency of the Monte Carlo method (the higher the FOM the better the statistics).200 7 Computer Simulation of Neutron Transport—The Monte Carlo Method
Exercises 
1. Get acquainted with any MC code input and output files and the selection of 
x-section tables. Use the code for modeling of a heterogeneous core fuel cell 
and fuel assembly of a thermal reactor of your choice. In particular, 
(a) Find the multiplication factor for the fuel cell 
(b) Vary the enrichment until it becomes near critical within two decimal points 
(c) Repeat the same calculation for the fuel assembly (ignore BP and CR) 
2. Table below gives the geometrical and material composition of Godiva assem￾bly, a bare sphere 
Composition Enrichment Radius (exp.) Radius (calc) Critical mass of fuel U-235 density 
U235-U238 93.9% 8.71 cm 8.67 cm 48.7 kg 17.59 g/cm3 
(a) Show that the density of Godiva constituents (U-235 and U-238) is 
18.74 g/cm3. 
(b) Run a Monte Carlo code such as MCNP for Godiva and study results: 
(i) Use the multiplication Fm cards to find the various reaction rates 
(ii) Use the energy card and the Hansen-Roch energy group structure 
to obtain the neutron spectrum. Draw the spectrum of the 16-group 
structure 
(iii) Does the composition of Godiva reveal a fast neutron spectrum? 
(iv) What is the main mechanism of neutron moderation? 
References 
1. N.M. Schaeffer, Reactor Shielding for Nuclear Engineers (Organization for Economic Coop￾eration and Development, Nuclear Energy Agency, France, 2008) 
2. J. Duderstadt, W. Martin, Transport Theory (Wiley, New York, 1979) 
3. X-5 Monte Carlo Team, MCNP - A General Monte Carlo N-Particle Transport Code Manual, 
vols. I–III (2005) 
4. L. Carter, E. Cashwell, Particle Transport Simulation with the Monte Carlo Method (Loss 
Alamos Scientific Laboratory, 1975) 
5. D.A. Usikov, Estimate of perturbations in solving nonuniform neutron transport problems by 
the Monte Carlo method. At. Energy 42(1) (1977) 
6. S. Maire, D. Talay, On a Monte Carlo method for neutron transport criticality computations. 
IMA J. Numer. Anal. (2006) 
7. V.A. Velizhanin, I.G. Dyad’kin, Simulation of neutron transport in a low-capture medium by 
the Monte Carlo method. At. Energy 60(1) (1986) 
8. L.L. Carter, N.J. McCormick, Coupled sampling with the Monte Carlo method in neutron 
transport calculations. Nucl. Sci. Eng. 39(3) (1970) 
9. T. Mori, M. Nakagawa, M. Sasaki, Vectorization of continuous energy Monte Carlo method 
for neutron transport calculation. Nucl. Sci. Eng. (1992) 
10. T. Goorley, Criticality Calculations with MCNP5: A Primer, 2nd edn. (Los Alamos National 
Laboratory, X-5)References 201
11. G. Zhu et al., Monte Carlo burnup code development based on multi-group cross section 
method. Prog. Nucl. Energy 110 (2019) 
12. I.M. Sobol, A Primer for the Monte Carlo Method (eBook, Published 30 Sept 2017)8 Neutron Transport—The Variational 
Methods 
Variational methods are useful in neutron transport. First: a relatively accurate 
value of certain quantities can be obtained by evaluating integrals involving rela￾tively inaccurate values of the flux and adjoint. Second: finding the eigenvalue for 
a homogeneous, source-free problem. Variational methods have also been used to 
analyze the flux near a free surface. The mathematics behind variational methods in 
neutron transport is the subject of variational calculus. Therefore, we begin intro￾ducing this subject in Sect. 8.1 mainly deriving the Euler–Lagrange equation. In 
Sect. 8.2, we present some variational principles and show how we can obtain well￾known differential equations such as Sturm–Liouville differential equations and 
Fredholm integral equations with symmetric kernels. For example, the Ritz varia￾tional principle is used in the eigenvalue problems and the error of the eigenvalue 
can be estimated. Applying the Euler–Lagrange equation to the Roussopoulos vari￾ational principle, we can find the Euler equations. We end up with application of 
variational methods to transport theory in Sect. 8.3. 
8.1 Variational Calculus 
As we have learned from introductory calculus, in order to find x corresponding 
to a local minimum (xmin), we find the slope ( f ,
(x)) or (dy 
dx )
and let it equal to 
zero (Fig. 8.1). Values of x which satisfy this are candidates for xmin. Solving 
f ,
(x) = 0 gives stationary points and further testing reveals their nature either 
maximum or minimum. So far this is a regular calculus [1].
8.1.1 Functionals 
Suppose we want to find a stationary function of a functional (function of a 
function) that is F[ f ]. Then, usually solve a differential equation for stationary
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2023 
R. M. Kuridan, Neutron Transport, Graduate Texts in Physics, 
https://doi.org/10.1007/978-3-031-26932-5_8 
203204 8 Neutron Transport—The Variational Methods
Fig. 8.1 A stationary point 
of an arbitrary function
function f (x). This is called the calculus of variations. Notice that we have an 
additional layer of functions: the stationary point became a stationary function; 
the function f (x) became a functional F[ f ]; and equation to be solved for xmin 
became a differential equation for stationary function f (x). 
Variational calculus covers a wide array of minimization problems, but for the 
purpose of our discussion, we will limit it to path-type minimization problem. 
Sometimes we can associate a function with input and output such as a real 
number is mapped by the function to a real number ( f : R → R) and a function 
is mapped by the functional also to a real number (F : C2 → R) where C2 is the 
space of a twice differential function. 
Example 
Referring to Fig. 8.2, suppose we have the two points A and B and we want to find 
the path linking A and B such that the distance A to B is minimized. 
From calculus, the length of a smooth curve y = f (x) between two points A 
and B is just F = (
B
A 
ds and from the Pythagoras theorem ds =
/
(dx)
2 + (dy)
2 =
Fig. 8.2 Arbitrary path 
between two points 8.1 Variational Calculus 205
dx /
1 +
(dy 
dx )2 
, substituting, we get 
F =
(x2
x1 
dx /
1 +
(dy 
dx )2 
Example 
Find y = f (x) between points A and B such that the integral F is minimized. In 
this case, the functional we want to minimize is F with respect to f (x). Generally, 
we don’t only want to minimize the distance between two points, we could do the 
same for a multitude of quantities which can be minimized or even maximized. 
Suppose a particle moving along the path from A to B with a velocity υ(x, y), 
then find the path y = f (x) such that the time taken by the particle is minimized. 
The differential time increment is dt = ds 
υ(x,y) and 
T =
(x2
x1 
dx 
/
1 +
(dy 
dx )2 
υ(x, y)
Then find y = f (x) between A and B such that T is minimized Brachis￾tochrone problem (means the shortest time in ancient Greek). In general, the 
calculus of variations seeks to find y = f (x) such that the integral 
F[ f ] =
(x2
x1 
dxL(
x, y, y,
)
is stationary. F could be the distance functional /
1 +
(dy 
dx )2 
or the time 
functional 
/
1+
( dy 
dx )2 
υ(x,y) . 
8.1.2 The Euler–Lagrange Equation 
The next stage is to derive the differential equation that leads to finding the sta￾tionary functions (analog of f ,
(x) = 0 for stationary points). Such differential 
equations are known as the Euler–Lagrange equations. However, the equation 
doesn’t tell the nature of the stationary point being a maximum or a minimum 
[2].206 8 Neutron Transport—The Variational Methods
The aim is to find y = f (x) which makes the functional F = ( x2 
x1 dxL(
x, y, y,
)
stationary with the boundary conditions y(x1) = y1 and y(x2) = y2. 
Suppose y(x) makes F stationary and satisfies the aforementioned boundary 
conditions, then 
• Introduce a function η(x), and η(x1) = η(x2) = 0. 
• Define y(x) = y(x) + εη(x). It satisfies the same boundary conditions. 
Implicitly all the functions have continuous second derivative and y(x) represents 
a family of curves. 
Proof The primary objective is to find the particular curve of this family y(x) which 
makes F(ε) = (
x2
x1 
dxL(
x, y, y,
)
stationary. It is F(ε)since the variable x is integrated 
over and the limits of the integral are substituted and the only remaining variable is 
ε. If F(ε) to be made stationary set: 
d F(ε)
dε
|
|
|
ε=0 = 0 because when ε = 0 we end up with y(x) = y(x) which is 
already extremal. When d F(ε)
dε
|
|
|
ε=0 = 0, then 
d 
dε
|
|
|
|
ε=0 
(x2
x1 
dxL(
x, y, y,
)
=
(x2
x1 
∂
∂ε
L
(
x, y, y,
)
|
|
|
|
ε=0 
dx = 0 
Applying the chain rule, we obtain 
(x2
x1 
∂L 
∂ y 
∂ y 
∂ε
+
∂L 
∂ y,
∂ y,
∂ε
|
|
|
|
ε=0 
dx = 0 (8.1) 
We leave this integral aside to obtain the derivatives of 
y(x) = y(x) + εη(x)
y(x) = y,(x) + εη,
(x)
∂ y 
∂ε = η(x);
∂ y,
∂ε = η,
(x)
Substituting the partial derivatives into Eq. 8.1, we get 
δF(y, η)|ε=0 =
(x2
x1 
∂L 
∂ y 
η(x) +
∂L 
∂ y, η,
(x)
|
|
|
|
ε=0 
dx = 0 (8.2)8.1 Variational Calculus 207
Using integration by parts for the second term 
(x2
x1 
udυdx = uυ −
(x2
x1 
υdudx 
u = ∂L 
∂ y,; dυ = η,
(x); υ = (
x2
x1 
η,
(x)dx; du = ∂
∂x 
∂L 
∂ y, , then 
(x2
x1 
∂L 
∂ y, η,
(x)dx = ∂L 
∂ y,
(x2
x1 
η,
(x)dx −
(x2
x1 
⎛
⎝
(x2
x1 
η,
(x)dx 
⎞
⎠
∂
∂x 
∂L 
∂ y, dx 
= ∂L 
∂ y, η(x)
|
|
|
|
x2 
x1 
−
(x2
x1 
η(x)
∂
∂x 
∂L 
∂ y, dx 
The first term vanishes because η(x1) = η(x2) = 0 (boundary condition). 
We take the second term back to Eq. 8.2, hence we get 
δF(y, η) =
(x2
x1 
η(x)
(∂L 
∂ y − ∂
∂x 
∂L 
∂ y,
)|
|
|
|
ε=0 
dx = 0 
At ε = 0 y(x) = y(x) and y
,
(x) = y
,
(x) then 
δF(y, η) =
(x2
x1 
η(x)
(∂L 
∂ y − ∂
∂x 
∂L 
∂ y,
)
dx = 0 
Since η(x) is an arbitrary function, for the integral to be zero the quantity in 
brackets should be zero, that is, 
∂L 
∂ y − d 
dx ( ∂L 
∂ y,
)
= 0 (8.3) 
Equation 8.3 is known as (Euler–Lagrange) equation. 
It means that y(x) satisfies the Euler–Lagrange equation; however, it does not 
necessarily mean that F[y] has an extremum point at y(x). The Euler–Lagrange 
equation is only necessary, not a sufficient condition for y(x) to be an extremum 
point. In fact, it is very difficult to obtain a necessary and sufficient conditions for 
a function y(x) to an extremum point for a functional F[y]. It doesn’t identify the 
stationary nature of the functional whether it is a maximum or a minimum, one 
has to resort to other methods to find out.208 8 Neutron Transport—The Variational Methods
Example 
Being a square is a sufficient condition for being a rectangle and being a rectangle 
is a necessary condition for being a square. 
If the functional depends on many functions, then 
F[y1, y2,..., yn] =
(x2
x1 
dxL(
x, y1, y2,..., yn, y,
1, y,
2,..., y,
n
) (8.4) 
The Euler equations take the form 
∂L 
∂ y1 
− d 
dx ( ∂L 
∂ y,
1
)
= 0;
∂L 
∂ y2 
− d 
dx ( ∂L 
∂ y,
2
)
= 0 
∂L 
∂n − d 
dx ( ∂L 
∂ y,
n
)
= 0 (8.5) 
8.2 Variational Principles 
The choice of the appropriate variational principle for a given problem is usually 
a matter of trial and error. The following examples are some of the applications of 
variational methods in mathematics and reactor physics [3]. 
8.2.1 Sturm–Liouville Differential Equations 
This is a familiar second-order differential equation. The functional chosen for 
most of self-adjoint second-order differential equations is 
L
(
x, y, y,
)
= p(x)
(dy 
dx )2 
+ q(x)[y(x)]
2 + 2 f (x)y(x) (8.6) 
Hence, the variational principle is in the form: 
F(y) =
(x2
x1 
dxL(
x, y, y,
)8.2 Variational Principles 209
And 
δF(y, η) =
(x2
x1 
η(x)
(∂L 
∂ y − ∂
∂x 
∂L 
∂ y,
)
dx = 0 
where by differentiating 6, we get 
∂L 
∂ y = 2q(x)y(x) + 2 f (x);
∂L 
∂ y, = 2 p(x)(y,
)
We seek the stationary point y(x). By substitution, we get 
δF(y, η) = 2 (x2
x1 
η(x)
(
q(x)y(x) + f − ∂
∂x p(x)(y,
)
)
dx = 0 
at the boundaries η(x) = 0; therefore, we obtain the Euler–Lagrange equation or 
just the Sturm–Liouville differential equation 
− d 
dx
[
p(x)(y,
)
]
+ q(x)y(x) + f (x) = 0 (8.7) 
(a) Diffusion equation 
The general form of the one-speed one-dimensional neutron diffusion equation is 
− d 
dx (
D(x)
dy 
dx )
+ Σa(x)φ(x) = S(x) (8.8) 
The variational principle of the functional defined by Eq. 8.6 with some 
modification to suit the problem is defined by Eq. 8.8 
F(y) =
(
b
a 
dxL(
x, y, y,
)
=
(
b
a 
dx(
D(x)
(dy 
dx )2 
+ Σa(x)[y(x)]
2 − 2S(x)y(x)
)
(8.9) 
The first variation δF = 0 will produce the Euler–Lagrange equation 
∂L 
∂ y = 2Σa(x)y(x) − 2S(x)
∂
∂x 
∂L 
∂ y, = 2 
∂
∂x
(
D(x)y,
)210 8 Neutron Transport—The Variational Methods
Fig. 8.3 One-dimensional discretization of mesh spacing 
Substituting in the Euler–Lagrange Eq. (8.3), we obtain 
−2 
d 
dx (
D(x)
dy 
dx )
− 2Σa(x)y(x) − 2S(x) = 0 
which is just the diffusion equation if we set y = φ
− d 
dx (
D(x)
dy 
dx )
+ Σa(x)φ(x) = S(x)
(b) Difference form of the diffusion equation 
Consider a homogenous uniform bare slab (D(x) = D and Σa(x) = Σa) divided 
into equally spaced meshes bounded by x = a and x = b (Fig. 8.3) with the 
boundary conditions φ(x0 = a) = ρ and φ(xN+1 = b) = ω. 
Suppose we approximate the variational principal (8.9) as follows: 
F(y) =
(
b
a 
dxL(
x, y, y,
)
= Σ
N
n=0 
x
(n+1
xn 
dx(
D
(dy 
dx )2 
+ Σa[y(x)]
2 − 2S(x)y(x)
)
Introducing the central difference approximation for the derivative dy 
dx (Fig. 8.4) 
and integrating term by term, we get 
1st term = D 
x
(n+1
xn 
dx(dy 
dx )2 
∼= D
( yn+1 − yn
Δ
)2
Δ
2nd term = Σa 
x
(n+1
xn 
dx[y(x)]
2 ∼= Σa[yn]
2Δ8.2 Variational Principles 211
Fig. 8.4 Difference scheme 
for the first and second 
derivatives 
3rd term = −2 
x
(n+1
xn 
dxS(x)y(x) ∼= −2Sn ynΔ
F(y) = Σ
N
n=0
(
D (yn+1 − yn)
2
Δ2 Δ + Σa[yn]
2Δ − 2Sn ynΔ
)
where Δ = (yn+1 − yn) is the mesh spacing. 
Expanding the series truncated to two terms only which contain yn for the first 
term 
F(y) = ··· + D
( yn − yn−1
Δ
)2
Δ + D
( yn+1 − yn
Δ
)2
Δ
+ ··· + Σa[yn]
2Δ − 2Sn ynΔ
the Euler–Lagrange equation 
∂L 
∂ yn 
= 2 
D
Δ
( yn − yn−1
Δ
)
Δ − 2 
D
Δ
( yn+1 − yn
Δ
)
Δ + 2Σa ynΔ − 2SnΔ
∂
∂x 
∂L 
∂
(δyn
Δ
) = ∂
∂x 
(2DΔ + 2DΔ) = 0 
δF = 0 = 2 
D
Δ
( yn − yn−1
Δ
)
Δ − 2 
D
Δ
( yn+1 − yn
Δ
)
Δ + 2Σa ynΔ − 2SnΔ212 8 Neutron Transport—The Variational Methods
which reduces to 
−D
[ yn−1 − 2yn + yn+1
Δ2
]
+ Σa yn = Sn (8.10) 
Leaving the trial functions notation to flux notation 
−D
[
φn−1 − 2φn + φn+1
Δ2
]
+ Σaφn = Sn 
A simplified discretized form of the diffusion equation can be obtained directly 
in many ways [4]. Substituting for the second derivative in Eq. 8.8 from Fig. 4, 
we obtain 
−D
( yn+1 − 2yn + yn−1
Δ2
)
+ Σa yn = Sn 
which is exactly as Eq. 8.10 the result from the variational principle. 
8.2.2 Fredholm Integral Equations with Symmetric Kernels 
The variational principle is written as [3, 4] 
F(y) =
(x2
x1 
dxL(
x, y, y,
)
where 
L
(
x, y, y,
)
= [y(x)]
2 − y(x)
(x2
x1 
dx,
K(
x, x,
)
y
(
x,
)
− 2 f (x)y(x) (8.11) 
We seek the stationary point y(x)y(x)
δF(y, η) =
(x2
x1 
η(x)
(∂L 
∂ y − ∂
∂x 
∂L 
∂ y,
)
dx = 0 
where by differentiating 8.11, 
∂L 
∂ y = 2y(x) −
(x2
x1 
dx,
K(
x, x,
)
y
(
x,
)
− 2 f (x);
∂L 
∂ y, = 0.8.2 Variational Principles 213
By substitution, we get 
δF(y, η) =
(x2
x1 
η(x)
⎛
⎝2y(x) −
(x2
x1 
dx,
K(
x, x,
)
y
(
x,
)
− 2 f (x)
⎞
⎠dx = 0 
And we obtain the Euler–Lagrange equation or just the Fredholm integral 
equation 
y(x) − 1 
2 (x2
x1 
dx,
K(
x, x,
)
y
(
x,
)
− f (x) = 0 
8.2.3 Eigenvalue Problems 
Consider the general eigenvalue problem 
Mψn = λψn (8.12) 
where M is a linear operator, ψn is the eigenfunction, and λ is the eigenvalue. 
Also, consider the adjoint eigenvalue problem, 
M∗ψ∗
n = λ∗ψ∗
n (8.13) 
where the definitions for the adjoint case are similar to the forward case. The 
inner product of Eq. 8.12 with ψ∗
n yields
(
ψ∗
n , Mψn
)
= λ(ψ∗
n , ψn)
And the inner product of Eq. 13 with ψn yields
(
ψn, M∗ψ∗
n
)
= λ∗(ψ∗
n , ψn)
(a) The Ritz variational principle 
The variational principle for this eigenvalue problems is usually known as the Ritz 
principle written as 
L
[
x, y, y,
]
= (y∗, My)
(y∗, y) (8.14)214 8 Neutron Transport—The Variational Methods
L∗[
x, y∗, y∗,]
= (y, M∗ y∗)
(y∗, y) (8.15) 
And 
F(y) =
(x2
0 
dxL(
x, y, y,
)
; F∗(
y∗)
=
(x2
1 
dxL∗(
x, y∗, y∗∗)
The variation of F and F∗F∗
δF(y, η) =
(x2
x1 
dxη(x)
(∂L 
∂ y − ∂
∂x 
∂L 
∂ y,
)
= 0 (8.16) 
δF∗(
y∗, η∗)
=
x2 (
x1 
dxη∗(x)
(∂L∗
∂ y∗ − ∂
∂x 
∂L∗
∂ y∗
)
= 0 
∂L 
∂ y = ∂
∂ y 
(y∗, My)
(y∗, y) ;
∂L 
∂ y, = 0 
∂L 
∂ y = ∂
∂ y 
(y∗, My)
(y∗, y) = 1 
(y∗, y)
∂
∂ y
(
y∗, My)
+ (
y∗, My) ∂
∂ y 
1 
(y∗, y)
∂L 
∂ y = 1 
(y∗, y)
(
y∗, M)
− (
y∗, My) 1
(
y∗, y2
) (8.17) 
Substituting in the Euler-Lagrange equation (Eq. 8.16) and using Eq. 8.12 
1 
(y∗, y)
(
y∗, M)
− (
y∗, λy
) 1 
(y∗, y)y = 0
(
y∗, M)
= (
y∗, λy
) 1 
y 
Or
(
y∗, My)
= (
y∗, λy
)
From which we obtain the Euler equation for the eigenvalue problem 
My = λy (8.18) 
following the same procedure for the adjoint eigenfunction 
∂L∗
∂ y∗ = ∂
∂ y∗
(y, M∗ y∗)
(y∗, y) ;
∂L 
∂ y∗, = 08.2 Variational Principles 215
Using Eq. 8.13 instead of 8.12 we finally obtain the Euler equation for the 
adjoint eigenvalue equation 
M∗ y∗ = λ∗ y∗ (8.19) 
The Ritz variational principle is useful for estimating the eigenvalues. Recall 
Eq. 8.14 
L
[
y, y∗]
= (y∗, My)
(y∗, y)
replacing y by yn and y∗ by y∗
n 
y → yn and y∗ → y∗
n (8.20) 
L
[
y∗
n , yn
]
=
(
y∗
n , Myn
)
(
y∗
n , yn
) = λ
Hence, the stationary value of L is just the eigenvalue λ. 
(b) The error estimate of the eigenvalue 
Now we want to find the error estimate of λ by substituting trial functions: yn+δyn 
and y∗
n + δy∗
n with a first-order error and λ should change to λ + δλ. 
Proof Writing, 
λ + δλ =
[(y∗
n + δy∗
n ), M(yn + δyn
)]
(
y∗
n , yn
)
Hence, 
δλ =
[(y∗
n + δy∗
n ), M(yn + δyn
)]
[(y∗
n + δy∗
n ),(yn + δyn
)] − λ
Or 
δλ =
[(y∗
n + δy∗
n ), M(yn + δyn
)] − λ
[(y∗
n + δy∗
n ),(yn + δyn
)]
[(y∗
n + δy∗
n ),(yn + δyn
)]
=
[(y∗
n + δy∗
n ), M(yn + δyn
)] − [(y∗
n + δy∗
n ), λ(yn + δyn
)]
[(y∗
n + δy∗
n ),(yn + δyn
)]
=
[(y∗
n + δy∗
n ),(M − λ)(yn + δyn
)]
[(y∗
n + δy∗
n ),(yn + δyn
)]216 8 Neutron Transport—The Variational Methods
Notice that we can move λ in and out of the brackets because it is a constant 
value and not an operator. Rearranging, 
δλ = [y∗
n ,(M − λ)(yn + δyn)] + [
δy∗
n ,(M − λ)(yn + δyn)
]
[(y∗
n + δy∗
n ),(yn + δyn
)]
= (y∗
n ,(M − λ)yn) + (y∗
n ,(M − λ)δyn) + (
δy∗
n ,(M − λ)yn
)
+ (
δy∗
n ,(M − λ)δyn
)
[(y∗
n + δy∗
n ),(yn + δyn
)]
From Eq. 8.12, the first and third terms in the numerator are zero. Then, 
δλ = (y∗
n ,(M − λ)δyn) + (
δy∗
n ,(M − λ)δyn
)
[(y∗
n + δy∗
n ),(yn + δyn
)]
The first term is subjected to requirement number 2 in Chap. 4, which states 
that (φ∗, Lφ) = (φ, L∗φ∗). Therefore, we write
(
y∗
n , Mδyn
)
= (
δyn, M∗ y∗
n
)
and (
y∗
n , λδyn
)
= (
δyn, λ∗ y∗
n
)
. Or 
(y∗
n ,(M − λ)δyn) = (
δyn, M∗ y∗
n
)
− (
δyn, λ∗ y∗
n
)
= (
δyn, (M∗ − λ∗)y∗
n
)
Substituting in the first term in the numerator 
δλ =
(
δyn, (M∗ − λ∗)y∗
n
)
+ (
δy∗
n ,(M − λ)δyn
)
[(y∗
n + δy∗
n ),(yn + δyn
)]
From Eq. 8.13, the first is zero and we obtain the eigenvalue error as 
δλ =
(
δy∗
n , Mδyn
)
− λ
(
δy∗
n , δyn
)
(
y∗
n , yn
) (8.21) 
where we have retained the denominator to the original form. Therefore, a first￾order error in the trial functions leads to second-order error in the estimate of the 
eigenvalue. 
(c) Self-adjoint operators 
If M is a self-adjoint operator, we may determine the sign of the error δλ. However, 
before doing that we return to the original formulation in Eq. 8.20. Equation 8.21 
becomes 
δλ = (δy∗, Mδy) − λ(δy∗, δy)
(y∗, y)8.2 Variational Principles 217
Rewriting 21 using the self-adjoint eigenfunctions and substituting from 
Eq. 8.12 for MδyMδy 
δλ = (δy, λnδy) − λ(δy, δy)
(y, y) = (λn − λ)(δy, δy)
(y, y)
We now suggest expanding the trial functions in a set of eigenfunctions. 
Substituting y(x) = Σ
n an yn(x) and δy = Σ
n anδyn(x) in δλ and expressing 
the bracketed quantities as integrals, we get 
δλ =
( +a 
−a dx Σ
n(λn − λ)anδyn
Σ
n anδyn ( +a 
−a dx Σ
n an yn
Σ
n an yn 
It will be assumed for convenience that the eigenfunctions are normalized so 
that 
(
+a
−a 
dxyi (x)y j (x) = δij 
where δij is the Kronecker delta. Using the orthogonality property, we get 
δλ =
Σ
n(λn − λ)|an|
2δnn Σ
n|an|
2δnn 
=
Σ
n(λn − λ)|an|
2
Σ
n|an|
2 
where (an)
2 is always positive so it is written as |an|
2 and δnn = 1.
The eigenvalues are ordered such that λ0 < λ1 < λ2 < . . . being λ0 the 
fundamental (smallest) eigenvalue, hence λ ≥ λ0 yielding δλ ≤ 0. 
Example Referring to Eq. 8.9 in Chap. 1 which defines the flux in a multiplying 
slab of thickness 2a in terms of the first-order exponential integral function. 
φ(x) = γ
2 (a
−a 
dx,
φ
(
x,
)
E1
[
Σt
|
|x − x,
|
|
] (8.22) 
Suppose we want to determine the value of γ = [
νΣ f + Σs
]
which makes the 
slab critical. 
Equation 8.22 is written in the form of an eigenvalue problem 
Kφ = 1 
γ
φ (8.23)218 8 Neutron Transport—The Variational Methods
where K is the integral operator 
K = 1 
2 (a
−a 
dx,
E1
[
Σt
|
|x − x,
|
|
]
The Ritz functional Eq. 8.14 is written as 
L
[
y, y∗]
= (y∗, K y)
(y∗, y)
K is clearly a symmetric self-adjoint operator, hence y∗ = y and K = K∗. 
Making use of the analysis above, we write 
[y] =
1 
2
( a 
−a dx ( a 
−a dx,
E1
[
Σt
|
|x − x,
|
|
]
y
(
x,
)
y(x)
( a 
−a dxy2(x) → 1 
γ
(8.24) 
We know that the flux profile for a critical symmetric slab is y(x) = cos πx 
2a 
so we can utilize Eq. 8.24 to obtain an accurate estimate of γ . Execution of the 
integral of this sort is a formidable task, instead numerical methods are much 
easier. 
8.2.4 Inhomogeneous Problems 
Let us write an example describing inhomogeneous equations such as a linear 
system of the type 
Aφ = f (8.25) 
(if f = 0 it becomes a homogeneous equation). 
Usually, we are interested in a weighted average of φ which can be expressed 
as (g, φ). The suitable variational principle for obtaining an accurate estimate of 
(g, φ) from crude trial functions was suggested by Roussopoulos. 
8.2.4.1 The Roussopoulos Variational Principle 
Consider the adjoint problem with a source term g 
A∗φ∗ = g (8.26) 
Then the Roussopoulos variational principle is given by the functional 
L
[
y, y∗]
= (g, y) + (
y∗, f
)
− (
y∗, Ay) (8.27) 
Conclusions 
We may deduce the following conclusions based on the principle:8.2 Variational Principles 219
(i) if y = φ or y∗ = φ∗ then 
L
[
φ, φ∗]
= (g, φ) + (
φ∗, f
)
− (
φ∗, Aφ
)
Substituting from Eq. 8.25 
L
[
φ, φ∗]
= (g, φ) + (
φ∗, f
)
− (
φ∗, f
)
L
[
φ, φ∗]
= (g, φ)
Or using requirement 2 from Chap. 4 (φ∗, Aφ) = (φ, A∗φ∗) the principle 
becomes 
L
[
φ, φ∗]
= (g, φ) + (
φ∗, f
)
− (
φ, A∗φ∗)
And likewise we substitute from 26 
L
[
φ, φ∗]
= (g, φ) + (
φ∗, f
)
− (φ, g)
L
[
φ, φ∗]
= (
φ∗, f
)
(ii) The total Variation of the Roussopoulos variational principle is derived as 
follows: 
L
[
y, y∗]
= (g, y) + (
y∗, f
)
− (
y∗, Ay)
L + δL = L
[
(y + δy), (y∗ + δy∗)
]
δL = L
[
(y + δy), (y∗ + δy∗)
] − L
[
y, y∗]
Substituting from Eq. 8.27 
δL = (g, y + δy) + (
y∗ + δy∗, f
)
− [(y∗ + δy∗), A(y + δy
)]
−(g, y) − (
y∗, f
)
+ (
y∗, Ay)
δL = (g, y) + (g, δy) + (
f , y∗)
+ (
f , δy∗)
− [(y∗, A(y + δy
)]
− [(δy∗, A(y + δy
)]
− (g, y) − (
f , y∗)
+ (
y∗, Ay)
δL = (g, δy) + (
f , δy∗)
− [(y∗, A(y + δy
)]220 8 Neutron Transport—The Variational Methods
− [(δy∗, A(y + δy
)] + (
y∗, Ay)
δL = (g, δy) + (
f , δy∗)
− (
y∗, Ay)
− (
y∗, Aδy
)
− (
δy∗, Ay)
− (
δy∗, Aδy
)
+ (
y∗, Ay)
δL = (g, δy) + (
f , δy∗)
− (
y∗, Aδy
)
− (
δy∗, Ay)
− (
δy∗, Aδy
)
Utilizing the identity (y∗, Aδy) = (δy, A∗ y∗) and substituting 
δL = (g, δy) + (
f , δy∗)
− (
δy, A∗ y∗)
− (
δy∗, Ay)
− (
δy∗, Aδy
)
Now utilizing Eqs. 8.25 Ay = f and 25 A∗ y∗ = g and substituting 
δL = (g, δy) + (
f , δy∗)
− (δy, g) − (
δy∗, f
)
− (
δy∗, Aδy
)
we finally obtain 
δL = −(
δy∗, Aδy
) (8.28) 
This is the aim of the variational principle, first-order errors in the trial functions 
yield second-order errors in the quantity (g, φ). 
(iii) Euler equations 
Applying the Euler–Lagrange equation to the Roussopoulos variational principle, 
we can find the Euler equations. 
The Roussopoulos principle defined by Eq. 8.27 
L
[
y, y∗]
= (g, y) + (
y∗, f
)
− (
y∗, Ay)
can be rewritten in the following form using the requirement from Chap. 4: 
L
[
y, y∗]
= (g, y) + (
y∗, f
)
− (
y, A∗ y∗)
Taking the derivatives, ∂L 
∂ y = g − A∗ y∗ and ∂L 
∂ y, = 0. Substituting this into the 
Euler–Lagrange equation, we get 
∂L 
∂ y − ∂
∂x 
∂L 
∂ y, = 0 
We get g − A∗ y∗ = 0 or 
A∗ y∗ = g (8.29)8.2 Variational Principles 221
This is the first Euler equation and we might as well derive the second equation 
using 
L
[
y, y∗]
= (g, y) + (
y∗, f
)
− (
y∗, Ay)
Hence, ∂L 
∂ y∗ = f − Ay and ∂L 
∂ y∗, = 0. Applying the Euler–Lagrange equation 
again, we get f − Ay = 0 or 
Ay = f (8.30) 
Special cases 
Other forms of the Roussopoulos variational principle as special cases are 
(i) If A = A∗ and f = g and y = y∗
Substituting in the principle, we get 
L[y] = ( f , y) + (y, f ) − (y, Ay)
L[y] = 2( f , y) − (y, Ay)
or 
L
[
y∗]
= (
g, y∗)
+ (
y∗, g
)
− (
y∗, A∗ y∗)
L
[
y∗]
= 2
(
g, y∗)
− (
y∗, A∗ y∗)
(ii) If A = A∗ and A = M − λ, then 
L
[
y, y∗]
= (g, y) + (
y∗, f
)
− [
y∗,(M − λ)y
]
and the Euler equation is (M − λ)y − f = 0 or 
My = λy + f 
When f = 0 it becomes a homogenous case and we can take A → M − λ, hence 
My = λy 
which is an eigenvalue problem governed by the Ritz variational principle 
L[y] = (y, My)
(y, y)222 8 Neutron Transport—The Variational Methods
(iii) Suppose we choose trial functions y = cφandy∗ = c∗φ∗, then 
L
[
φ, φ∗]
= c(g, φ) + c∗(
φ∗, f
)
− cc∗(
φ∗, Aφ
) (8.31) 
Applying the Euler–Lagrange equation as in (ii), we get 
g − c∗φ∗A = 0 
f − cAφ = 0 
Taking the inner product between φ and the first equation and the inner product 
between φ∗ and the second equation we get 
(g, φ) − c∗(φ∗, Aφ) = 0
(
φ∗, f
)
− c
(
φ∗, Aφ
)
= 0 
Finally, we obtain 
c∗ = (g, φ)
(φ∗, Aφ)
c = (φ∗, f )
(φ∗, Aφ)
If we substitute back in Eq. 8.30, we get 
L
[
φ, φ∗]
= (φ∗, f )(g, φ)
(φ∗, Aφ) + (g, φ)(φ∗, f )
(φ∗, Aφ) − (φ∗, f )(g, φ)
(φ∗, Aφ)
or 
L
[
φ, φ∗]
= (φ∗, f )(g, φ)
(φ∗, Aφ)
This principle is first suggested by Schwinger. 
8.3 Application of Variational Methods to Transport Theory 
We use the Roussopoulos functional as a Lagrangian to generate sets of Euler 
equations. Consider the one-speed transport equation with isotropic scattering and 
sources [5, 6, 7] 
μ
∂φ
∂z 
+ Σt φ(z, μ) − Σs 
2 (
+1
−1 
dμ,
φ
(
z, μ,
)
= 1 
2 
S(z) (8.32)8.3 Application of Variational Methods to Transport Theory 223
The corresponding adjoint to the neutron transport equation is 
−μ
∂φ∗
∂z 
+ Σt φ∗(z, μ) − Σs 
2 (
+1
−1 
dμ,
φ∗(
z, μ,
)
= 1 
2 
S∗(z) (8.33) 
The Roussopoulos functional for Eqs. 8.32 and 8.33 is 
L
[
y, y∗]
=
(
S∗/
2, y
)
+
(
y∗, S
/
2
)
− (
y∗, Ay)
With the Euler equations: 
Aφ = S and A∗φ∗ = S∗. 
The Roussopoulos functional can be written explicitly for the transport equation 
and its adjoint as 
L
[
y, y∗]
=
(
dz (
1
−1 
dμ
⎡
⎣
1 
2 
S∗ y +
1 
2 
y∗ S − y∗μ
∂ y 
∂z − y∗Σt y(z, μ) + y∗Σs 
2 (
+1
−1 
dμ,
y
(
z, μ,
)
⎤
⎦ (8.34) 
Suppose we assume the functions y and y∗ which have a linear anisotropy of 
arbitrary trial functions such as those defined by P1 expansion 
y(z, μ) = 1 
2 
y0(z) +
3 
2 
μy1(z);
y∗(z, μ) = 1 
2 
y∗
0 (z) +
3 
2 
μy∗
1 (z)
If substituted in Eq. 8.34 and integrated over space and angle and, 
The functional L
[
y, y∗]
is replaced by L
[
y0, y1; y∗
0 , y∗
1
]
L
[
y0, y1; y∗
0 , y∗
1
]
=
(
dz (
1
−1 
dμ
(1 
2 
S∗
(1 
2 
y0 +
3 
2 
μy1
)
−
(1 
2 
y∗
0 +
3 
2 
μy∗
1
)
Σt
(1 
2 
y0 +
3 
2 
μy1
)
+
(1 
2 
y∗
0 +
3 
2 
μy∗
1
)Σs 
2 (
+1
−1 
dμ,
(1 
2 
y0 +
3 
2 
μ,
y1
)⎫
⎬
⎭224 8 Neutron Transport—The Variational Methods
Notice that (
1
−1 
μdμ = 0; (
1
−1 
dμ = 2 and (
1
−1 
μ2dμ = 2 
3 . The functional is 
reduced to its final form by the following steps: 
L
[
y0, y1; y∗
0 , y∗
1
]
=
(
dz (
1
−1 
dμ
[
1 
2 
S∗
(1 
2 
y0
)
+
1 
2 
S
(1 
2 
y∗
0
)
−
(1 
2 
y∗
0
)
μ
∂
∂z
(1 
2 
y0 +
3 
2 
μy1
)
−3 
2 
y∗
1 μ2 ∂
∂z
(1 
2 
y0 +
3 
2 
μy1
)
−
(1 
2 
y∗
0
)
Σt
(1 
2 
y0
)
−3 
2 
3 
2 
μ2 y1Σt y∗
1 +
(1 
2 
y∗
0
)Σs 
2 (
+1
−1 
dμ,
(1 
2 
y0
)⎤
⎦
=
(
dz (
1
−1 
dμ
⎡
⎢
⎢
⎢
⎢
⎢
⎢
⎢
⎣
1 
2 
S∗
(1 
2 y0
)
+
1 
2 
S
(1 
2 y∗
0
)
−
(1 
2 y∗
0
)
μ2 ∂
∂z
(3 
2 y1
)
−3 
2 y∗
1 μ2 ∂
∂z
(1 
2 y0
)
−
(1 
2 y∗
0
)
Σt
(1 
2 y0
)
−3 
2 
3 
2 μ2 y1Σt y∗
1 +
(1 
2 y∗
0
)Σs 
2
(1 
2 y0
)
2 
⎤
⎥
⎥
⎥
⎥
⎥
⎥
⎥
⎦
L
[
y0, y1; y∗
0 , y∗
1
]
=
(
dz[
1 
2 
1 
2 
2y0 S∗ +
1 
2 
1 
2 
2y∗
0 S − 1 
2 
2 
3 
3 
2 
y∗
0 
∂ y1 
∂z 
−1 
2 
2 
3 
3 
2 y∗
1 
∂ y0 
∂z − 1 
2 
1 
2 
2y0 y∗
0Σt − 3 
2 
3 
2 
2 
3 y1 y∗
1Σt 
+
1 
2 
1 
2 
1 
2 
(2)(2)y0 y∗
0Σs
]
L
[
y0, y1; y∗
0 , y∗
1
]
=
(
dz[
1 
2 
y0 S∗ +
1 
2 
y∗
0 S − 1 
2 
y0 y∗
0Σt − 3 
2 y1 y∗
1Σt 
+
1 
2 
y0 y∗
0Σs − 1 
2 
y∗
0 
∂ y1 
∂z − 1 
2 y∗
1 
∂ y0 
∂z
]
Finally, we obtain the final form 
L
[
y0, y1; y∗
0 , y∗
1
]
= 1 
2
(
dz[
y0 S∗ + y∗
0 S − y0 y∗
0Σa − 3y1 y∗
1Σt − y∗
0 
∂ y1 
∂z − y∗
1 
∂ y0 
∂z
]8.3 Application of Variational Methods to Transport Theory 225
Introducing the definition of the Euler–Lagrange formula 
(x2
x1 
∂L 
∂ y 
∂ y 
∂ε
+
∂L 
∂ y,
∂ y,
∂ε
|
|
|
|
ε=0 
dx = 0 (8.35) 
we have 
∂L 
∂ y∗
0 
= S − y0Σa − ∂ y1 
∂z = 0; ∂L 
∂ y0 = S∗ − y∗
0Σa = 0; ∂L 
∂ y1 = −3y∗
1Σt = 0; 
∂L 
∂ y∗
1 
= −3y1Σt − ∂ y0 
∂z = 0; and ∂
∂z 
∂L 
∂ y, = 0. 
We obtain the approximate Euler equations 
∂ y1 
∂z + Σa y0 = S 
∂ y0 
∂z + 3Σt y1 = 0
)
(8.36) 
On the other hand if we use the Roussopoulos functional for Eqs. 8.32 and 8.33 
in the form of 
L
[
y, y∗]
=
(
S∗/
2, y
)
+
(
y∗, S
/
2
)
− (
y, A∗ y∗)
By following the same steps, we get 
L
[
y0, y1; y∗
0 , y∗
1
]
= 1 
2
(
dz[
y0 S∗ + y∗
0 S − y0 y∗
0Σa − 3y1 y∗
1Σt + y1 
∂ y∗
0 
∂z
]
(8.37) 
Introducing the definition of the Euler–Lagrange formula as before, we have 
∂L 
∂ y∗
0 
= S − y0Σa = 0; ∂L 
∂ y0 = S∗ − y∗
0Σa + ∂ y∗
1 
∂z = 0; ∂L 
∂ y1 = −3y∗
1Σt + ∂ y∗
0 
∂z = 0; 
∂L 
∂ y∗
1 
= −3y1Σt = 0; and ∂
∂z 
∂L 
∂ y, = 0 
We finally obtain the approximate Euler equations in the adjoint form 
−∂ y∗
1 
∂z + Σa y∗
0 = S∗
−∂ y∗
0 
∂z + 3Σt y∗
1 = 0
)
(8.38) 
Equations 8.36 and 8.38 can be identified as the P1 equations and their adjoint 
if we apply the same definitions used in Chapter 3, e.g. y0(z) = φ(z) and y1(z) =
J (z) and y∗
0 (z) = φ∗(z) and y∗
1 = J ∗(z). Therefore, as seen in this example, one 
can generate the best approximate solution to the transport equation within the 
given assumptions by utilizing the appropriate variational principle.226 8 Neutron Transport—The Variational Methods
Exercises 
1. Develop the Euler equations for the following Lagrangians: 
(i) L
[
y, y,
, y,, ... y(n)
, x
]
and (ii) L
[
y, y1,... yn; y,
1,... y,
n, x
]
2. Compute the geometrical buckling by the variational principle for an infinite, 
bare, all thermal homogenous cylindrical reactor of radius R using one-speed 
diffusion theory. Use a trial function φ = 1 − ax2 where x = r 
R and a is a 
parameter to be determined. Compare the result obtained with this trial function 
to the exact value. For convenience regard R as the extrapolated boundary of 
the reactor. 
3. Use the Roussopoulos functional to estimate the total absorption rate occurring 
in a bare slab in which the neutron flux is maintained by a plane source at 
the origin. Use simple polynomials as the trial functions and compare your 
variational estimate with the exact expression for the absorption rate. 
4. Evaluate the numerical value of the first zero ν0 of J0(x) by using the Ritz 
principle for the differential operator that generates J0(νn x) as eigenfunctions. 
Use simple polynomial estimates as the trial functions. 
5. Prove that the Ritz functional for a self-adjoint eigenvalue problem is indeed 
an extremum principle (i.e. prove that δ2F indeed has a definite sign). Give an 
explicit example by using this principle to estimate eigenvalue for a bare slab 
geometry and compare these with the actual eigenvalue. 
References 
1. M. Becker, The Principles and Applications of Variational Methods (MIT Press, Cambridge 
Mass., 1964) 
2. W.M. Stacey, Variational Methods in Reactor Analysis (Academic Press, New York, 1973) 
3. J. Duderstadt, W. Martin, Transport Theory (Wiley, New York, 1979) 
4. G. Bell, S. Glasstone, Nuclear Reactor Theory (Van Nostrand, New York, 1970) 
5. T. Zhang, Z. Li, Variational nodal methods for neutron transport: 40 years in review, in Nuclear 
Engineering and Technology (2022) 
6. L. Bourhrara, New variational formulations for the neutron transport equation, in Transport The￾ory and Statistical Physics (2004) 
7. H.P. Holley, The variational method applied to the neutron transport equation, in Nuclear Engi￾neering and Technology (1971)9 Selected Problems Solutions 
Chapter 1: The neutron transport equation 
1.2. Suppose that the angular neutron density is given by 
n
(
r , Ω)
= n0 
4π
(1 − cos θ)
where θ is the between Ω and the z-axis. If A is the area perpendicular to the 
z-axis, then what is the number of neutrons passing through the area A per 
second: (a) per unit solid angle at an angle of 45o with the z-axis, (b) from 
the negative z to the positive z direction, (c) net, and (d) total? 
Solution 
The angular neutron density per unit volume per unit solid angle is given by 
n
(
r, Ω)
= n0 
4π
(1 − cos θ)
Referring to the Fig. 9.1
The vector area A = Ak and the velocity is υ = υΩ; hence, if we define 
μ = cosθ and dμ = − sin θ dθ, where θ(0, π) ↔ (+1, −1) and the solid angle 
is defined as dΩ = sin θ dθdψ = −dμdψ, then the number of neutrons passing 
through a unit area per second per unit solid angle is 
υn
(
r , Ω)
= ϕ
(
r, Ω)
= φ0 
4π
cosθ(1 − cos θ)
And, the scalar flux φ0 = υn0 and as vector current υn
(
r , Ω)
= j
(
r , Ω)
. Now, 
the number of neutrons passing through an area A per second per unit solid angle is 
A. j
(
r , Ω)
= A φ0 
4π
cosθ(1 − cos θ)
© The Author(s), under exclusive license to Springer Nature Switzerland AG 2023 
R. M. Kuridan, Neutron Transport, Graduate Texts in Physics, 
https://doi.org/10.1007/978-3-031-26932-5_9 
227228 9 Selected Problems Solutions
Fig. 9.1 Phase space Z-axis 
area A 
origin 
Substituting for θ, the expression becomes 
A. j
(
r , Ω)
= A φ0 
4π
μ(1 − μ)
However, the number of neutrons passing through area A in all directions per 
second are
(
4π
dΩ A. j
(
r , Ω)
=
(
2π
0 
dψ
(
+1
−1 
dμA φ0 
4π
μ(μ − 1)
= A φ0 
2 (
+1
−1 
dμ(μ2 − μ) = A φ0 
3 
(a) per unit solid angle at an angle of 45o with the z-axis 
A. j
(
r, Ω)
= A φ0 
4π
cosθ(1 − cos θ)
At the angle of θ = 45o with the z-axis, 
A. j
(
r , Ω)
= A φ0 
4π
cos45(1 − cos 45) = A φ0 
4π
( 1 
√2 − 1 
2
)
(b) per unit solid angle from the negative z to the positive z direction. This implies 
neutrons are passing the area A with all angles between 0 and π or μ from 0 
to −1 then we integrate as (this is just the partial current (J +)
J + = A φ0 
2 (−1
0 
dμ(μ2 − μ) =
[
μ3 
3 − μ2 
2
]−1 
0 
= −1 
3 − 1 
2 = − 5 
12 
Aφ09 Selected Problems Solutions 229
We can as well calculate J−
J − = A φ0 
2 (
+1
0 
dμ(μ2 − μ) =
[
μ3 
3 − μ2 
2
]+1 
0 
= 1 
3 − 1 
2 = −1 
6 
Aφ0 
(c) net current 
Jnet = J + − J − = − 5 
12 
Aφ0 +
1 
6 
Aφ0 = −1 
4 
Aφ0 
(d) total current 
Jtotal = J + + J − = − 5 
12 
Aφ0 − 1 
6 
Aφ0 = − 7 
12 
Aφ0 
1.3 Demonstrate that, in an isotropic flux, the partial current density in any 
direction is given by J ± = φ
/
4 
Solution 
The partial currents are expressed in the general form as 
J ±(
r
)
=
(
n.Ω>
<0 
dΩn.Ωϕ
(
r, Ω)
An isotropic flux implies 
ϕ
(
r , Ω)
= φ
(
r
)
/
4π
substituting 
J ±(
r
)
=
(
n.Ω>
<0 
dΩ(
n.Ω)
φ
(
r
)
/
4π = φ
(
r
)
/
4π
(
n.Ω>
<0 
dΩ(
n.Ω)
= φ
(
r
)
/
4π
(
2π
0 
dψ
(
±1
0 
dμμ = φ
(
r
)
/
4π(2π)
1 
2 = φ
(
r
)
/
4 
1.11 Consider neutron transport in a one-dimensional rod. That is the neutrons 
can move only to the left or to the right. If the neutron density of neutrons 
moving to the left is n−(x, E, t) and that to the right is n+(x, E, t) one needs 
only consider forward scattering described by Σ+
s
(
E, → E
) or backward 
scattering described by Σ−
s
(
E, → E
)
. 
(a) Derive the transport equations for n+ and n−230 9 Selected Problems Solutions
(b) Make the one-speed approximation in this set of equations, that is 
Σt = Σa + Σ+
s (E) + Σ−
s (E) = Σa + Σ+
s + Σ−
s 
Σ±
s
(
E, → E
)
= Σ±
s δ
(
E, → E
)
(c) Describe the boundary and initial conditions necessary to complete the 
specifications of the problem if the rod length is L. 
Solution 
This is a one-dimensional problem; so, the one-dimensional form of the NTE is 
used with the assumption of a homogenous rod. Referring to Fig. 9.2, we write 
the equation for the neutrons moving to the right direction 
∂n+
∂t = S(z, t) +
(∞
0 
d E,
υn+(
z, E,
, t
)
Σ+
s
(
E, → E
)
+
(∞
0 
d E,
υn−(
z, E,
, t
)
Σ+
s
(
E, → E
)
− υn+(z, E, t)Σt (E) − μ
∂υn+
∂z
where Σt (E) = Σa(E) + Σ+
s (E) + Σ−
s (E). When the neutrons moving to the 
right or to the left some of them will scatter in the forward direction and others 
in the backward direction. Those neutrons which scatter in the backward direction 
will contribute to those of the opposite sign. This is represented by the first and 
second terms on the right side. 
The equation for neutrons to the left is 
∂n−
∂t = S(z, t) +
(∞
0 
d E,
υn−(
z, E,
, t
)
Σ−
s
(
E, → E
)
+
(∞
0 
d E,
υn+(
z, E,
, t
)
Σ−
s
(
E, → E
)
− υn−(z, E, t)Σt (E) − μ
∂υn−
∂z 
The one-speed approximation:9 Selected Problems Solutions 231
Fig. 9.2 Neutron transport in a rod
Substituting for the transfer scattering x-section by Σ±
s
(
E, → E
) =
Σ±
s δ
(
E, → E
) and Σt = Σa + Σ+
s + Σ−
s and knowing that
( dx f (
x,
)
δ
(
x, → x
)
= f (x), we get 
∂n+
∂t = S(z, t) +
(∞
0 
d E,
υn+(
z, E,
, t
)
Σ+
s δ
(
E, → E
)
+
(∞
0 
d E,
υn−(
z, E,
, t
)
Σ+
s δ
(
E, → E
)
− υn+(z, E, t)Σt − μ
∂υn+
∂z 
∂n+
∂t = S+(z, t) + Σ+
s υn+(z, t) + Σ+
s υn−(z, t)
− (
Σa + Σ+
s + Σ−
s
)
υn+(z, t) − μ
∂υn+
∂z 
∂n+
∂t = S+(z, t) + Σ+
s υn−(z, t) − (
Σa + Σ−
s
)
υn+(z, t) − ∂υn+
∂z232 9 Selected Problems Solutions
And, the neutrons moving to the left likewise 
∂n−
∂t = S−(z, t) + Σ−
s υn+(z, t) − (
Σa + Σ+
s
)
υn−(z, t) +
∂υn−
∂z 
Notice that, for the neutrons going to the right, μ = 1 and, those to the left, 
μ = −1 and the leakage is through the right and left surfaces. Adding the two 
equations, we get 
∂n+
∂t 
+
∂n−
∂t = S+(z, t) + S−(z, t) + Σ+
s υn−(z, t)
− (
Σa + Σ−
s
)
υn+(z, t) + Σ−
s υn+(z, t)
− (
Σa + Σ+
s
)
υn−(z, t) −
(
(+1)
∂υn+
∂z 
+ (−1)
∂υn−
∂z
)
Canceling the alike terms, we end up with 
∂n+
∂t 
+
∂n−
∂t = S − υΣa
(
n+ + n−)
−
(
(+1)
∂υn+
∂z
+ (−1)
∂υn−
∂z
)
If we set n = n+ + n− and S = S+ + S−, then 
1 
υ
∂υn 
∂t = S − υΣan − ∂υn 
∂z 
or if the flux is defined as φ = φ+ + φ−, we obtain the one-speed 1D TE 
1 
υ
∂φ
∂t = S − Σaφ − ∂φ
∂z 
The last two steps are just a check on the previous steps. 
Initial and boundary conditions 
(i) The initial conditions are just 
n−(z, t = 0) = n−
0 (z) and n+(z, t = 0) = n+
0 (z). 
(ii) Zero flux at the extrapolation distances right and left υn+
(
L˜, t
)
= 0 and 
υn−
(
0˜, t
)
= 0. 
(iii) Zero partial currents: J +
n− = 0 on the left, and J −
n+ = 0 on the right. 
1.12 Explore the geometrical representation corresponding to the following phys￾ical quantities (neutron fluxes) in the three geometries. 
(i) Finite sphere of radius R 
ϕ(r,θ,ψ); ϕ(r, θ); ϕ(r , ψ); ϕ(θ , ψ); φ(r); ϕ(ψ); ϕ(θ); φ.9 Selected Problems Solutions 233
(ii) Finite cylinder of radius R and height H 
ϕ(r,z, ψ); φ(r ,z); ϕ(r, ψ); ϕ(z, ψ); φ(r); ϕ(ψ); φ(z); φ.
(iii) Parallel piped of dimensions a, b, c 
φ(x, y,z); φ(x, y); φ(x,z); φ(y,z); φ(x); φ(y); φ(z); φ.
Solution 
We will consider few cases for the parallel piped core and leave the rest to 
students: 
φ(x, y,z); (points) any point in the parallel piped; 
ϕ(x, y); (lines) vertical lines parallel to the z-axis at various points (x, y); 
φ(z);(surfaces) surfaces parallel to the x–y plane at various points on the z-axis. 
Chapter 2: Neutron diffusion 
The student is referred to appendices D and E for running test problems on the 1D 
code. 
Chapter 3: The P N Method 
3.1 Geometrical representation of the gradient function 
Solution 
Notice that from vector calculus, the gradient vector of the scalar function φ
is in the direction of the normal to the level surface of φ, e.g. 
n.∇φ = ∇φcos0 = ∇φ
If J ∝ n.∇φ, then 
J = −D
(
n.∇φ
)
= −D∇φ
3.2 Re-derive the PN equation for one-speed, isotropic scattering, and plane 
symmetry—include time dependence. 
(a) In particular, obtain the P1 equation and solve for an equation describing 
the total flux 
3D 
ν2 
∂2φ
∂t2
(1 
ν
+
3DΣa 
ν
)∂φ
∂t = D 
∂2φ
∂x2 − Σaφ(x, t) + S234 9 Selected Problems Solutions
(b) Compare this equation with the neutron diffusion equation: 
1 
ν
∂φ
∂t = D 
∂2φ
∂x2 − Σaφ(x, t) + S 
and indicate what differences you might expect in the solutions to the P1 
description. Also, indicate under what conditions or approximations the 
P1 equations should yield results similar to diffusion theory. 
Solution 
Assumptions: Time-dependent, one-speed, P1 equations in plane symmetry and 
isotropic scattering. 
(a) The P1 equations with the above assumptions can be derived easily as 
1 
υ
∂φ
∂t 
+
∂ J 
∂x + Σaφ(x, t) = S(x) (9.1) 
1 
υ
∂ J 
∂t 
+
1 
3 
∂φ
∂x + Σt J (x, t) = 0 (9.2) 
Multiply Eq. 9.1 by υ and take the derivative ∂
∂t ; and take the derivative ∂
∂x 
of Eq. 9.2 and notice that the source is independent of time. 
1 
υ2 
∂2φ
∂t2 +
1 
υ
∂ J 2 
∂x∂t 
+
Σa 
υ
∂φ(x, t)
∂t = 0 (9.3) 
1 
υ
∂ J 2 
∂x∂t 
+
1 
3 
∂2φ
∂x2 + Σt 
∂ J (x, t)
∂x = 0 (9.4) 
Subtract 9.4 from 9.3 
1 
υ
∂ J 
∂t 
+
1 
3 
∂φ
∂x + Σt J (x, t) = 0 (9.5) 
The diffusion equation is 
1 
υ
∂φ
∂t = D 
∂2φ
∂x2 − Σaφ(x, t) + S(x)
1 
υ
∂ J 
∂t 
+
1 
3 
∂φ
∂x + Σt J (x, t) = 0 (9.6) 
And, the diffusion approximation 
J (x, t) = −D ∂φ
∂x 
1 
υ
∂ J 
∂t 
+
1 
3 
∂φ
∂x + Σt J (x, t) = 0 (9.7)9 Selected Problems Solutions 235
Taking the derivative, 
∂ J (x, t)
∂x = −D 
∂2φ
∂x2 (9.8) 
Substituting 9.8 in 9.6, we get the DE in this form: 
1 
υ
∂ J 
∂t 
+
1 
3 
∂φ
∂x + Σt J (x, t) = 0 (9.9) 
Collecting 9.5 and 9.9 gives 
1 
υ2 
∂2φ
∂t2 +
Σa 
υ
∂φ
∂t − 1 
3 
∂2φ
∂x2 + Σt
[ 1 
υ
∂φ
∂t 
+ Σaφ(x, t) − S(x)
]
= 0 
Multiplying by 1
Σt 
1
Σt 
1 
υ2Σt 
∂2φ
∂t2 +
Σa 
υΣt 
∂φ
∂t − 1 
3Σt 
∂2φ
∂x2 +
1 
υ
∂φ
∂t 
+ Σaφ(x, t) − S(x) = 0 
or 
1 
υ2Σt 
∂2φ
∂t2 +
( 1 
υ +
Σa 
υΣt
)∂φ
∂t = 1 
3Σt 
∂2φ
∂x2 − Σaφ(x, t) + S(x)
1 
υ
∂ J 
∂t 
+
1 
3 
∂φ
∂x + Σt J (x, t) = 0 (9.10) 
The diffusion coefficient D is defined as 1 
3Σtr , where Σtr = Σt − Σs1 =
Σt − μ0Σs; however, Σs1 = 0 (isotropic scattering, hence Σtr = Σt and 
D = 1 
3Σt 
. 
Equation 9.10 is written as 
3D 
υ2 
∂2φ
∂t2 +
( 1 
υ +
3DΣa 
υ
)∂φ
∂t = D 
∂2φ
∂x2 − Σaφ(x, t) + S(x)
1 
υ
∂ J 
∂t 
+
1 
3 
∂φ
∂x + Σt J (x, t) = 0 (9.11) 
(b) Equation 9.10 is rewritten as 
1 
υ2Σt 
∂2φ
∂t2 +
Σa 
υΣt 
∂φ
∂t = − 1 
υ
∂φ
∂t 
+ D 
∂2φ
∂x2 − Σaφ(x, t) + S(x)
1 
υ
∂ J 
∂t 
+
1 
3 
∂φ
∂x + Σt J (x, t) = 0 (9.12)236 9 Selected Problems Solutions
The first and the second terms on the left-hand side of the equation contain the 
quantity υΣt which is the frequency of collisions cm 
sec 1 
cm = 1 
sec and the inverse 
of that is 1 
υΣt = l is the neutron lifetime in seconds. So, if υΣt is too large, the 
first and second terms vanish and the equation reduces to the diffusion equation 
on the right-hand side. For fast reactors, (l f ast ) is smaller than that of thermal 
reactors (lth). Therefore, the P1 equation above is applicable for a fast reactor and 
the diffusion equation is sufficient for a thermal reactor. This is true based on the 
assumptions made at the beginning. 
Chapter 4: The adjoint function 
4.1 Prove that the forward and adjoint operators of the total loss Lt , L∗
t , scattering 
Ls , L∗
s , and fission L f , L∗
f terms satisfy requirement 2 and hence they have 
true adjoints as defined from Eqs. 9.12 and 9.13 as 
Lt ϕ
(
r , E, Ω)
= −Σt
(
r , E, Ω)
ϕ
(
r , E, Ω)
L∗
t ϕ∗(
r , E, Ω)
= −Σt
(
r, E
)
ϕ∗(
r, E, Ω)
Ls ϕ
(
r, E, Ω)
=
(∞
0 
d E,
(
4π
dΩ,
Σs
(
r , E, → E, Ω, → Ω)
ϕ
(
r , E,
, Ω,
)
L∗
s ϕ∗(
r, E, Ω)
=
(∞
0 
d E,
(
4π
dΩ,
Σs
(
r , E → E,
, Ω → Ω,
)
ϕ∗(
r, E,
, Ω,
)
L f ϕ
(
r , E, Ω)
= χ(E)
4π
(
4π
dΩ,
(∞
0 
d E,
ν
(
E,
)
Σ f
(
r , E,
)
ϕ
(
r , E,
, Ω,
)
L∗
f ϕ∗(
r, E, Ω)
= ν(E)Σ f
(
r, E
)
4π
(∞
0 
d E,
(
4π
dΩ,
χ
(
E,
)
ϕ∗(
r , E,
, Ω,
)
Solution 
The requirements: 
(i) If the operators are self-adjoint, then 
φ∗ = φ and L = L∗ as separate entities. 
(ii) If they are not self-adjoint, then9 Selected Problems Solutions 237
(φ∗, Lφ) = (φ, L∗φ∗) or 
˚ φ∗Lφdξ =
˚ φL∗φ∗dξ
And, then you have to prove that both sides are equivalent term by term. 
The one-speed neutron diffusion equation 
−∇ · D
(
r
)
∇φ
(
r
)
+ Σa
(
r
)
φ
(
r
)
= νΣ f
(
r
)
φ
(
r
)
and its adjoint form 
−∇ · D
(
r
)
∇φ∗(
r
)
+ Σa
(
r
)
φ∗(
r
)
= νΣ f
(
r
)
φ∗(
r
)
The operators are written as 
L1speed φ
(
r
)
= −∇ · D
(
r
)
∇φ
(
r
)
+ Σa
(
r
)
φ
(
r
)
− νΣ f
(
r
)
φ
(
r
)
and the adjoint form can just be written down as 
L∗
1speed φ∗(
r
)
= −∇ · D
(
r
)
∇φ∗(
r
)
+ Σa
(
r
)
φ∗(
r
)
− νΣ f
(
r
)
φ∗(
r
)
Looking at the two equations, the only difference is the functions otherwise 
the operators are identical L1speed = L∗
1speed ; therefore, they will yield the same 
solution φ equal φ∗ except that the flux is normalized to the total power output is 
obvious that the one-speed form is self-adjoint. 
Notice that the boundary condition applied to the transport equation at the left 
boundary ϕ
(
r 0, Ω)
= 0 for Ω > 0; and ϕ∗ (
r 0, Ω)
= 0 for Ω < 0 or ϕ
(
rs , Ω)
=
0 for Ω < 0; and ϕ∗(
rs , Ω) = 0 for Ω > 0. The unit vector Ω
_ causes the 
streaming term in TE to be of opposite signs. This is not the case in the diffusion 
theory where the flux is isotropic. Notice also j
(
r, Ω)
= Ωϕ
(
r, Ω)
and J
(
r
)
=
Ωφ
(
r
)
are both vectors and ϕ
(
r, Ω)
and φ
(
r
)
are both scalars. 
Applying requirement II to DE and its adjoint, we get
(
φ∗, −∇ · D∇φ + Σaφ − νΣ f φ
)
− (
φ, −∇ · D∇φ∗ + Σaφ∗ − νΣ f φ∗)
The absorption and fission terms are clearly self-adjoint and no need to prove 
that. Only the streaming term needs a proof.
(
−φ∗∇ · D∇φ +
(
φ∇ · D∇φ∗
Integration by parts for the two integrals; first integral: 
u = −φ∗; dv = ∇ · D∇φ238 9 Selected Problems Solutions
du = −∇φ∗; v = D∇φ
Apply the identity ( −φ∗∇·D∇φ = uv−( vdu = −φ∗D∇φ+( D∇φ∇φ∗dV 
−φ∗D∇φ + φ∗D∇φ = 0 
And, the second integral is likewise. This proves that the streaming term is 
self-adjoint. 
4.2 Examine the adjoint of the time-dependent DE by proving Δ = 0. 
Solution 
The time rate of change in the TE: 
Applying requirement II, (φ∗, Lφ) = (φ, L∗φ∗) or (φ∗, Lφ) − (φ, L∗φ∗) = 0 
and, for the time-dependent term, we should prove 
(ϕ∗ 1 
υ
∂ϕ
∂t −
[
−ϕ 1 
υ
∂ϕ∗
∂t
]
) = 0 and in the explicit form:
˝ ϕ∗ 1 
υ
∂ϕ
∂t + ϕ 1 
υ
∂ϕ∗
∂t dV d EdΩ is equal to zero. Notice the integrand does not 
include the time derivative; therefore, 
1 
υ
∂
∂t ˚ ϕ∗ϕ + ϕϕ∗dV d EdΩ = 2 
υ
∂
∂t ˚ ϕ∗ϕdV d EdΩ
The initial and final conditions apply to the flux and adjoint, respectively. For 
example, ϕ
(
r , E, Ω, ti
)
= ϕi; ϕ∗(
r, E, Ω, t f
)
= ϕ∗
f have constant distributions at 
the beginning and at the end, hence 
2 
υ
˚ ∂
(
ϕ∗
f ϕi
)
∂t 
dV d EdΩ = 0 
4.4 Write down the energy-dependent P1 equations and from which try to deduce 
the adjoint form. 
Solution 
The Legendre equation with fission term from the chapter on spherical harmonics 
Example: sphere (rewrite it for a plane) 
n
[
∂ϕn−1 
∂r − (n − 1)
ϕn−1(r)
r
]
+ (n + 1)
[
∂ϕn+1 
∂r + (n + 2)
ϕn+1(r)
r
]
+ (2n + 1)(Σt − Σsn)φn(r ) = (2n + 1)νΣ f ϕ0(r)9 Selected Problems Solutions 239
The P1 equations
[
∂φ1 
∂r + 2 
φ1(r )
r
]
+ (Σt − Σs0)φ0(r ) = νΣ f φ0(r )
∂φ
∂r + 3(Σt − Σs1)φ1(r) = 3νΣ f φ0(r )
The energy form
[
∂ϕ1 
∂r + 2 
ϕ1(r , E)
r
]
+ Σt φ0(r , E)
−
(
d E,
Σs0
(
E, → E
)
φ0
(
r , E,
)
= χ(E)
(
d E,
ν
(
E,
)
Σ f
(
E,
)
φ0
(
r , E,
)
∂ϕ0 
∂r + 3Σt φ1(r, E) −
(
d E,
Σs1
(
E, → E
)
φ1
(
r , E,
)
= 3χ(E)
(
d E,
ν
(
E,
)
Σ f
(
E,
)
φ0
(
r, E,
)
or
[
∂ J (r , E)
∂r + 2 
J (r , E)
r
]
+ Σt φ(r , E)
−
(
d E,
Σs0
(
E, → E
)
φ
(
r , E,
)
= χ(E)
(
d E,
ν
(
E,
)
Σ f
(
E,
)
φ0
(
r , E,
)
∂φ
∂r + 3Σt J (r , E) −
(
d E,
Σs1
(
E, → E
)
J
(
r , E,
)
= 3χ(E)
(
d E,
ν
(
E,
)
Σ f
(
E,
)
φ
(
r , E,
)
The energy-dependent adjoint P1 equations 
−
[
∂ J ∗(r , E)
∂r + 2 
J ∗(r , E)
r
]
+ Σt φ∗(r, E)
−
(
d E,
Σs0
(
E → E,
)
φ∗(
r, E,
)
= ν(E)Σ f (E)
(
d E,
χ
(
E,
)
φ∗(
r , E,
)
− ∂φ∗
∂r + 3Σt J ∗(r , E) −
(
d E,
Σs1
(
E → E,
)
J ∗(
r , E,
)
= 3ν(E)Σ f (E)
(
d E,
χ
(
E,
)
φ∗(
r, E,
)240 9 Selected Problems Solutions
4.5 Find out the adjoint angular and space-dependent discrete ordinate equation. 
Solution 
The DO equation is 
μ
∂
∂z 
ϕ(z, μ) + Σt ϕ(z, μ) = Σs 
2 (
+1
−1 
dμ,
ϕ
(
z, μ,
)
+ S(z, μ)
The adjoint form is 
−μ
∂
∂z 
ϕ∗(z, μ) + Σt ϕ∗(z, μ) = Σs 
2 (
+1
−1 
dμ,
ϕ∗(
z, μ,
)
+ S∗(z, μ)
It is originally derived from the TE where the major difference is in the first term 
(streaming term) in the negative direction. 
Try to obtain the energy-dependent adjoint form. 
4.6 Derive the last term in the kinetic equation: 
ν(E)Σ f
(
r, E
) (∞
0 
d E,
[
(1 − β)χ
(
E,
)
+
Σ
6
i=1 
βi χi
(
E,
)
] (
dΩ,
ϕ∗
0
(
r, E,
, Ω,
)
Solution 
The TE with delayed neutrons 
1 
υ
∂φ
∂t = −Ω · ∇φ
(
r , E, Ω, t
)
− Σt
(
r , E, Ω)
φ
(
r , E, Ω, t
)
+
(∞
0 
d E,
(
4π
dΩ,
Σs
(
r , E, → E, Ω, → Ω)
φ
(
r, E,
, Ω,
, t
)
+ (1 − β)χ(E)
(
4π
dΩ,
(∞
0 
d E,
ν
(
E,
)
Σ f
(
r, E,
)
φ
(
r, E,
, Ω,
, t
)
+Σ
6
i=1 
λi Ci
(
r , t
)
χi (E)9 Selected Problems Solutions 241
All terms are familiar except the last two terms 
+ (1 − β)χ(E)
(
4π
dΩ,
(∞
0 
d E,
ν
(
E,
)
Σ f
(
r, E,
)
φ
(
r, E,
, Ω,
, t
)
+Σ
6
i=1 
λi Ci
(
r, t
)
χi (E)
which are meant for the accounting for delayed neutrons. 
First term represents the rate of prompt neutron production rate from fission, 
where 
β is the delayed neutron fraction; and 
(1 − β) is the remaining prompt neutrons. 
Secomd term is the delayed neutron production rate. How? 
Fission produces fragments. Some of them are converted to other products via 
decay. Those who decay by neutron emission are classified into six groups. They 
are delayed relative to prompt neutrons with known decay times and energy spectra 
χi (E).
Therefore, 
λi Ci
(
r, t
) is the decay rate of group (i) precursors ⇔ (number of delayed 
neutrons in group (i)). 
λi Ci
(
r, t
)
χi (E) the delayed neutrons emitted with energy E. Σ6 
i=1 λi Ci
(
r , t
)
χi (E) is the total number of delayed neutrons emitted by all 
the precursors at energy E. 
The last term of the adjoint form: 
ν(E)Σ f
(
r, E
) (∞
0 
d E,
[
(1 − β)χ
(
E,
)
+ Σ
6
i=1 
βi χi
(
E,
)
] (
dΩ,
φ∗
0
(
r , E,
, Ω,
)
Proof: Normally, in the process of fission neutrons causing fission are chosen on 
the energy scale E, and the outcome is selected at energy E. The concept of fission 
in the adjoint system is the reversal of the actual process. 
We start from the end of the fission process (the scale is E, where we have the 
importance fractions of prompt and delayed neutrons 
Prompt: ( ∞
0 d E,
(1 − β)χ
(
E,
) ( dΩ,
φ∗
0
(
r , E,
, Ω,
)
and 
delayed: ( ∞
0 d E, Σ
6
i=1 
βi χi
(
E,
) ( dΩ,
φ∗
0
(
r, E,
, Ω,
)
.242 9 Selected Problems Solutions
both of which resulted from the fission of one neutron ν(E)Σ f
(
r , E
)
at energy 
E, then 
ν(E)Σ f
(
r, E
)
⎡
⎣
(∞
0 
d E,
(1 − β)χ
(
E,
)
+
(∞
0 
d E,
Σ
6
i=1 
βi χi
(
E,
)
⎤
⎦
(
dΩ,
φ∗
0
(
r , E,
, Ω,
)
ν(E)Σ f
(
r , E
) (∞
0 
d E,
[
(1 − β)χ
(
E,
)
+ Σ
6
i=1 
βi χi
(
E,
)
] (
dΩ,
φ∗
0
(
r, E,
, Ω,
)
4.8 Let J (E)dE be the source of neutrons slowing down to the energy interval 
between E and E + dE from collisions with a moderator of mass A which 
scatters neutrons isotropically in the center of mass system. JA(E) can be 
viewed as an integral operator acting on the flux φ(E)
JA(E) = Lφ(E) =
E
(
/α
E 
d E, ΣH 
s
(
E,
)
(1 − α)E,
φ
(
E,
)
where symbols are familiar from neutron slowing down theory. Determine the 
adjoint L∗. 
Solution 
The slowing down source where neutrons slow down to energy E. Fig. 9.3 shows 
the limits of lower energies upon slowing down or the upper limit of initial neutron 
energy. So, what would be the adjoint operator) L∗
JA(E) = Lφ(E) =
E
(
/α
E 
d E, ΣA 
s
(
E,
)
(1 − α)E,
φ
(
E,
)
where neutrons scattered from E, to E with E/
α as the upper limit (top part of 
the figure). On the other hand, if a neutron at E is scattered downward, αE would 
be the lower limit.9 Selected Problems Solutions 243
Fig. 9.3 Elastic scattering of 
neutrons
The transfer scattering cross section can be written as
ΣA 
s
(
E, → E
)
= ΣA 
s
(
E,
)
P
(
E, → E
)
= ΣA 
s
(
E,
)
(1 − α)E,
The scattering probability is always dependent on the neutron energy before the 
scattering event. Therefore, JA(E) can be rewritten as 
JA(E) = Lφ(E) =
E
(
/α
E 
d E,
ΣA 
s
(
E, → E
)
φ
(
E,
)
The adjoint form is just reversing the energy transfer 
J ∗
A(E) = L∗φ∗(E) =
(
E
αE 
d E,
ΣA 
s
(
E → E,
)
φ∗(
E,
)
J ∗
A(E) = L∗φ∗(E) =
(
E
αE 
d E, ΣA 
s (E)
(1 − α)E φ∗(
E,
)
J ∗
A(E) = L∗φ∗(E) = ΣA 
s (E)
(1 − α)E (
E
αE 
d E,
φ∗(
E,
)
( E 
αE d E,
φ∗(
E,
)
is the total importance of the emergent neutrons from scattering.244 9 Selected Problems Solutions
Chapter 5: Perturbation theory 
5.3 The accurate flux and the adjoint flux in a subcritical system can readily be 
calculated. The configuration of another subcritical system is only slightly differ￾ent. Find an expression for the desired reaction rate integrated over the second 
system, such that the expression has only second-order errors and does not 
depend on variations from the flux and adjoint flux of the first system. 
Solution 
The expression has only second-order errors: 
To explain the order of errors, assume the quantities 
φ + 0 
φ + δφ + 0 
φ + δφ + δφδφ + 0 
The first quantity all orders of error higher than the zero order are neglected 
(assumed exact). 
The second quantity all orders of error higher than the first order are neglected. 
The third quantity all orders of error higher than the second order are neglected. 
However, the first-order perturbation theory the perturbed flux and adjoint φ
,
=
φ + δφ ∼= φ such that δφ = 0 and φ∗ = φ∗ + δφ∗ ∼= φ∗ (negating the small 
differences as if first-order errors and higher are neglected). 
When the expression has only second-order errors imply only first-order error 
is accepted. 
A subcritical system is kept critical by a source S(t) [reactor kinetics] 
The configuration of another subcritical system is only slightly different: 
(1) Could mean only the geometry is slightly different like in the case of 
approximations to suit different codes or 
(2) Could mean everything is slightly different. 
Variations from the flux and adjoint flux of the first system: 
It may depend on φ and φ∗ but does not depend on the variations δφ and δφ∗. 
Find an expression for the desired reaction rate integrated over the second 
system? 
Assuming one-speed theory where the flux is self-adjoint, the total importance 
of the reaction rate integrated on the second system is
(
V2 
dV φ∗(
r
)(Σa
(
r
)
+ δΣa
(
r
))φ
(
r
)9 Selected Problems Solutions 245
If the cross section is uniform and the system is a slab 
(a
−a 
dx(Σa + δΣa)
[
φ2(x)
]
φ(x) is the solution of the diffusion equation (as we have mentioned the criticality 
is sustained by an external supposedly isotropic source) 
−D 
d2φ
dx2 + Σaφ(x) = νΣ f φ(x) + Sext 
Actually, it is a space–time-dependent problem in reactor kinetics, 
1 
υ
∂φ
∂t = νΣ f φ(x, t) + Sext (t) + D 
∂2φ
∂x2 − Σaφ(x, t)
However, we ignore the time dependence and consider a moment in time 
d2φ
dx2 +
[
νΣ f − Σa 
D
]
φ(x) = d2φ
dx2 + B2 
m φ(x) = − Sext 
D 
φ(x) = − Sext 
DB2 
m 
+ A cos Bm x 
Substituting in the integral, 
(a
−a 
dx(Σa + δΣa)
[
− Sext 
DB2 
m 
+ A cos Bm x
]2 
5.4 Demonstrate the validity of problem (2) by considering the following example: 
An infinite medium extends from x = 0 to ∞ and contains a plane source at 
x = 0. The flux is to be described by the one group diffusion theory. The first 
system has an absorption cross section Σa and a diffusion constant D. The 
second system has the same source and diffusion constant, but an absorption 
cross section Σa + δΣa. Calculate the absorption rate throughout exactly and 
according to the derived perturbation procedure. Then show that results differ 
by second-order terms in δΣa. 
Solution 
The exact solution 
The unperturbed system flux by solving the one-speed neutron diffusion equation 
is246 9 Selected Problems Solutions
The perturbed system 
φ,
(x) = SL,
2D exp −x/L,
; L,2 = D 
Σ,
a 
The absorption rate before and after 
(∞
0 
dxΣa 
SL 
2D exp −x/L =
(∞
0 
dxΣ,
a 
SL,
2D exp −x/L, = S 
2 
Meaning that neutrons produced by source are eventually absorbed in both 
cases. 
Perturbation theory: 
(∞
0 
dxΣ,
aφ,
(x) =
(∞
0 
dx(Σa + δΣa)(φ(x) + δφ(x))
=
(∞
0 
dx[Σaφ(x)] + [δΣaφ(x)] + [Σaδφ(x)] + [δΣaδφ(x)] 
Second-order errors δΣaδφ(x) = 0 
=
(∞
0 
dx[Σaφ(x)] + [δΣaφ(x)] + [Σaδφ(x)] 
First-order perturbation δφ(x) = 0 
=
(∞
0 
dx[Σaφ(x)] + [δΣaφ(x)] = S 
2 +
(∞
0 
dx[δΣaφ(x)] 
= S 
2 +
δΣa 
Σa 
S 
2 = S 
2
(
1 +
δΣa 
Σa
)
S 
2
(
1 + δΣa 
Σa
)
is equivalent to S 
2
(
1 + δΣa 
Σa + (δΣa )
2 
Σa + ...)
with the second order 
term (δΣa )
2 
Σa zero as compared to the exact solution S 
2 . The results approach each 
other as δΣa → 0 
5.5 A critical system consisting of a slab surrounded on both sides by infinite 
reflectors (Fig. 9.4) is to be described by two group diffusion theory. The 
center third of the core suddenly has its thermal group absorption cross section 
increased slightly. Find the change in criticality factor by perturbation theory. 
Compare to the immense amount of work would be done if the perturbation 
theory is not used.9 Selected Problems Solutions 247
Core 
Core 
Core 
Reflector Reflector
Fig. 9.4 Reflected slab 
Solution 
The original system: Two-group theory for the core and reflector 
Derivation in the notes gives
Δρ = −
( 2a/3 
−2a/3 dxφ∗
2 (x)δΣa2φ2(x)
( 2a/3 
−2a/3 dxφ∗
1 (x)ν1Σ f 1φ1(x) + φ∗
2 (x)ν2Σ f 2φ1(x)
Derivation in the notes gives
Δρ = −
( 2a/3 
−2a/3 dxφ∗
2 (x)δΣa2φ2(x)
( 2a/3 
−2a/3 dxφ∗
1 (x)ν1Σ f 1φ1(x) + φ∗
2 (x)ν2Σ f 2φ1(x)
Needed are the thermal flux φ2 and adjoint φ∗
2 in the central portion of the 
core and fast flux φ1; and adjoint φ∗
1 in the same portion. perturbation theory 
saves plenty of time and effort in contrast to detailed calculation of the fluxes and 
adjoints fast and thermal in all regions with boundary and interface conditions. 
Chapter 6: Discrete ordinates 
6.4 Derive the discrete ordinates equations in 1D slab geometry for the case of 
N = 2 (e.g. the S2 equations). Assume isotropic scattering and choose the 
appropriate angles and weights. Compare the structure of these equations 
with the P1 equations. Assume a steady-state and a homogenous medium for 
convenience. 
6.5 Using the S2 equations developed in problem 1, derive equations satisfied 
by the sum and difference of the two angular flux components ϕ(z, μ1) =
ϕ(z, μ2). Then show that with appropriate choice of μ1 the flux will have the 
exact asymptotic diffusion length.248 9 Selected Problems Solutions
Solution 
The DO equation with isotropic scattering 
(n + 1)
d φ˜n+1 
dz + n 
d φ˜n−1 
dz + (2n + 1)Σt φ˜n(z) = (2n + 1)Σsnδn0 φ˜n(z)
+(2n + 1)S˜
n(z); n = 0, 1, 2, ··· , M − 1 
The S2 equations 
For M = 2 implies n = 0,1 
n = 0 
...
d φ˜1 
dz + Σa φ˜0(z) = S˜
0(z) (9.13) 
n = 1 
d φ˜0 
dz + 3Σt φ˜1(z) = 3 S˜
1(z) (9.14) 
where 
φ˜0(z) = 2π[w1ϕ(z, μ1)P0(μ1) + w2ϕ(z, μ2)P0(μ2)] 
φ˜1(z) = 2π[w1ϕ(z, μ1)P1(μ1) + w2ϕ(z, μ2)P1(μ2)] 
Again, 
φ˜0(z) = 2π[w1ϕ(z, μ1) + w2ϕ(z, μ2)] 
φ˜1(z) = 2π[μ1w1ϕ(z, μ1) + μ2w2ϕ(z, μ2)] 
We know w1 = w2 and μ1 = −μ2, substituting 
φ˜0(z) = 2πw1[ϕ(z, μ1) + ϕ(z, −μ1)] (9.15) 
φ˜1(z) = 2πμ1w1[ϕ(z, μ1) − ϕ(z, −μ1)] (9.16) 
By solving Eqs. (9.13) and (9.14), we can solve Eqs. (9.15–9.17) for ϕ(z, μ1)
and ϕ(z, −μ1)9 Selected Problems Solutions 249
The P1 equations 
....
dφ1 
dz + Σaφ0(z) = S0(z) (9.17) 
...
dφ0 
dz + 3Σt φ1(z) = 3S1(z) (9.18) 
which are identical to Eqs. (9.13) and (9.14), except for the definition of 
φ˜0,1(z) and φ0,1(z), where φ0(z) = 2π ( +1 
−1 dμϕ(z, μ) and φ1(z) =
2π ( +1 
−1 dμμϕ(z, μ)
Assuming no isotropic sources Eqs. 9.13 and 9.14 can be solved as 
φ˜0(z) ∼= S˜
0 
Σa +Cexp−z
/
L, and φ˜1(z) = − 1 
3Σt 
d φ˜0 
dz ≈ −D, d φ˜0 
dz = C D,
L, exp−z
/
L,
where D, = 1 
3Σt is the isotropic diffusion coefficient and (Σs1 = 0). 
Adding Eqs. 9.15 and 9.16 
φ˜0(z) + φ˜1(z)
μ1 
= 4πw1ϕ(z, μ1)
or and solving for ϕ(z, μ1)
ϕ(z, μ1) = 1 
4πw1
(
φ˜0(z) + φ˜1(z)
μ1
)
≈ 1 
4πw1
(
Cexp − z
/
L, +
D,
μ1L,
Cexp − z
/
L,
)
ϕ(z, μ1) = C 
4πw1
(
1 +
D,
μ1L,
)
exp − z
/
L,
ϕ(z, μ1) = C 
4πw1
(
1 +
Σa 
μ1
)
exp − z
/
L,
with appropriate choice of μ1 the flux will have the exact asymptotic diffusion 
length.A The concept of Directional Derivative 
A.1 Directional Derivative 
In short, the concept of directional derivative can be defined as taking the derivative 
in a particular direction. 
Partial derivatives 
Partial derivatives with respect to the axis x, y,z can be considered as the direc￾tional derivatives in the directions i, j, k, respectively. Therefore, ∂ f (x,y,z)
∂x implies 
assuming the variables y,z as constants and taking the derivative of the function f 
in the x-direction (i) which is defined as the slope in the x-direction. Derivatives 
with respect to the other directions are like so will produce slopes in the directions 
of y and z. In the following, we restrict ourselves to the Cartesian coordinates. 
The gradient (∇)
The grad (∇) is defined as an operator that consists of the partial derivatives in 
the direction of the three-unit vectors i , j, k 
∇ =
∂
∂x 
i +
∂
∂ y 
j +
∂
∂z 
k 
and operates on a scalar quantity, e.g. f (x, y,z) and the grad of f is 
∇ f = ∂ f 
∂x i +
∂ f 
∂ y 
j +
∂ f 
∂z 
k 
The slope in an arbitrary direction (the directional derivative): 
Now, we seek derivatives of the function f (x, y,z) in the direction of the unit 
vector Ω = Ωx i + Ωy j + Ωzk. Referring to Fig. A.1, the coordinates of the 
point Q is [x(s), y(s),z(s)] dependent on the value of s and the vector r like so,
© The Editor(s) (if applicable) and The Author(s), under exclusive license 
to Springer Nature Switzerland AG 2023 
R. M. Kuridan, Neutron Transport, Graduate Texts in Physics, 
https://doi.org/10.1007/978-3-031-26932-5 
251252 Appendix A: The concept of Directional Derivative
Fig. A.1 Directional derivative in a 3D cartesian geometry 
r = x(s)i + y(s)j + z(s)k. The directional derivative can be written using the 
chain rule as 
∂ f 
∂s = ∂ f 
∂x 
∂x(s)
∂s 
+
∂ f 
∂ y 
∂ y(s)
∂s 
+
∂ f 
∂z 
∂z(s)
∂s 
which is just the scalar product between the two vectors: 
∂ f 
∂s =
[
∂ f 
∂x i +
∂ f 
∂ y 
j +
∂ f 
∂z 
k
]
.
[
∂x(s)
∂s 
i +
∂ y(s)
∂s 
j +
∂z(s)
∂s 
k
]
(A.1) 
The quantity in the first bracket is ∇ f ; however, the second one is the derivative 
of r with respect to s as we can see: r' = x'
(s)i + y'
(s)j + z'
(s)k. The vector a 
is just a = x0,i + y0 j + z0k and hence, from the triangle of vectors r = a + sΩ
and taking the derivative w.r.t. s, then r' = Ω because a' = 0 independent of s.
Rewriting Eq. A.1 
∂ f 
∂s 
= ∇ f .r' = ∇ f .Ω = Ω.∇ f (A.2) 
This is just the streaming term in the neutron transport equation. Since Ω
is a three-dimensional unit vector, we obtain an infinite number of directional 
derivatives unless we specify a particular direction. 
Example 
Find the directional derivative ∂ f 
∂s at point P(1, 1, 1) in the direction of the vector 
2i − j + 5k given that f (x, y,z) = f0

x2 y + z

. Hence, 
∇ f = 2 f0 yxi + f0x2 j + f0kAppendix A: The concept of Directional Derivative 253
∇ f = 2 f0i + f0 j + f0k 
The unit vector is Ω = 2i− j+5k 
|2i− j+5k| = √
2 
30 
i − √
1 
30 j + √
5 
30 
k check? 
At point P, the directional derivative is 
∂ f 
∂s = Ω.∇ f = f0
 4 
√30 − 1 
√30 
+
5 
√30
= 8 
√30 f0 
Positive means an increasing f in the direction of Ω. 
A.1.1 ∇ in Planar Geometry 
In rectangular coordinates as in Fig. A.2, the unit vector Ω is in a phase space 
independent of the coordinate system of the position vector r, e.g. r : x, y,z and 
Ω : χ , ϑ. Consider a one-dimensional semi-infinite slab in which the neutron flux 
is varying with the z-axis. We know that the slab extends to infinity in the other 
directions x and y. 
Therefore, neutron motion is restricted to right and left on the z-axis and in the 
plane y–z (x = 0) or the plane x–z (y = 0) such that the dependence is only on ϑ
and not on the azimuthal angle χ. Figure A.2 in 3D reduces to 1D Fig. A.3. 
Applying the above analysis for the directional derivative to this one￾dimensional case, 
∂φ
∂s = ∂φ
∂z 
∂z(s)
∂s
Fig. A.2 Rectangular coordinate system 254 Appendix A: The concept of Directional Derivative
Fig. A.3 Directional 
derivative in a 1D slab 
where φ is the scalar flux. From the triangle in the figure, ∂z(s)
∂s = cosϑ and hence, 
∂φ
∂s = Ω.∇φ = ∂φ
∂z 
cosϑ = μ
∂φ
∂z 
A.1.2 ∇ in Spherical Geometry 
The spherical dimensions are r : r ,θ,ψ and Ω : ω,μ, where μ is the cosine 
of the angle between Ω and r as shown in Fig. A.4. The vector r is defined in 
cartesian coordinates as 
r = xi + yj + zk 
From Fig. A.4, 
x = r sin θ cos ψ, y = r sin θ sin ψ, z = r cos θ therefore, 
r = r sin θ cos ψi + r sin θ sin ψ j + r cos θk (A.3)
|
|r
|
| =
/
x2 + y2 + z2 = r 
So, what are the unit vectors in spherical coordinates rˆ, θˆ, and ψˆ ? 
Let us first consider this simple example. Taking the derivative of r w.r.t x in 
the formula of the vector r above, we get ∂r 
∂x = i (in the direction of increasingAppendix A: The concept of Directional Derivative 255
x). Therefore, the unit vector r ˆ is just the derivative of r in the direction of r in 
Eq. A.3 or 
r ˆ = ∂r 
∂r = sin θ cos ψi + sin θ sin ψ j + cos θk 
which is equal to r 
r . The other unit vectors are like so, 
θ = ∂r 
∂θ = r cos θ cos ψi + r cos θ sin ψ j − r sin θk
|
|θ
|
| =
/
[rcos θcos ψ]
2 + [rcos θ sin ψ]
2 + [rsin θ]
2 = r 
And, the unit vector θˆ = θ
|θ| = θ
r = cos θ cos ψ i + cos θ sin ψ j − sin θ k. 
In a similar fashion, 
ψ = ∂r 
∂ψ = −rsin θ sin ψi + rsin θ cos ψ j 
and
|
|
|ψ
|
|
| =
/
[−rsin θ sin ψ]
2 + [r sin θ cos ψ]
2 = rsin θ
Fig. A.4 Spherical coordinate system 256 Appendix A: The concept of Directional Derivative
And, we get 
ψˆ = ψ
|
|
|ψ
|
|
|
= ψ
rsinθ = −rsin θ sin ψi + r sin θ cos ψ j 
rsinθ
= −sin ψi + cos ψ j 
Collect the results for the spherical geometry unit vectors 
r ˆ =sin θ cos ψi
− + sin θ sin ψ j
− + cos θ k
−
θˆ = cos θ cos ψi
− + cos θ sin ψ j
− − sin θ k
−
ψˆ = − sin ψi
− + cos ψ j
−
⎫
⎪⎪⎪⎪⎬
⎪⎪⎪⎪⎭
(A.4) 
The following derivatives are going to be employed in the upcoming derivations 
leading to the gradient. 
∂x 
∂r =sin θ cos ψ
∂x 
∂θ =rcos θ cos ψ
∂x 
∂ψ = − rsin θ sin ψ
⎫
⎪⎪⎪⎪⎪⎪⎬
⎪⎪⎪⎪⎪⎪⎭
∂ y 
∂r =sin θ sin ψ
∂ y 
∂θ =rcos θ sin ψ
∂ y 
∂ψ =rsin θ cos ψ
⎫
⎪⎪⎪⎪⎪⎪⎬
⎪⎪⎪⎪⎪⎪⎭
∂z 
∂r =cos θ
∂z 
∂θ = − rsin θ
∂z 
∂ψ =0 
⎫
⎪⎪⎪⎪⎪⎪⎬
⎪⎪⎪⎪⎪⎪⎭
(A.5) 
The chain rule: 
∂
∂r = ∂x 
∂r ∂
∂x + ∂ y 
∂r ∂
∂ y + ∂z 
∂r ∂
∂z ∂
∂θ = ∂x 
∂θ
∂
∂x + ∂ y 
∂θ
∂
∂ y + ∂z 
∂θ
∂
∂z ∂
∂ψ = ∂x 
∂ψ
∂
∂x + ∂ y 
∂ψ
∂
∂ y + ∂z 
∂ψ
∂
∂z 
⎫
⎪⎬
⎪⎭
(A.6) 
Substituting A.5 into A.6, we get 
∂
∂r = sin θ cos ψ ∂
∂x + sin θ sin ψ ∂
∂ y + cos θ ∂
∂z ∂
∂θ = rcos θ cos ψ ∂
∂x + rcos θ sin ψ ∂
∂ y − rsin θ ∂
∂z ∂
∂ψ = −rsin θ sin ψ ∂
∂x + rsin θ cos ψ ∂
∂ y 
⎫
⎪⎬
⎪⎭
(A.7) 
Now, obtain ∂
∂x from the first equation of A.7 in terms of the rest and substitute 
in the second and the third equations of A.7. Do the same for ∂
∂ y 
and ∂
∂z . The 
reader can do this as an exercise. We finally obtain 
∂
∂x = sin θ cos ψ ∂
∂r + cos θ cos ψ
r ∂
∂θ + sin ψ
rsin θ
∂
∂ψ
∂
∂ y = sin θ sin ψ ∂
∂r + cos θ sin ψ
r ∂
∂θ + cos ψ
rsin θ
∂
∂ψ
∂
∂z = cos θ ∂
∂r − sin θ
r ∂
∂θ
⎫
⎪⎬
⎪⎭
(A.8)Appendix A: The concept of Directional Derivative 257
Back to the expressions for the unit vectors in Eq. A.8. We use the orthogonality 
to get: 
i .r ˆ = sin θ cos ψ
i .θˆ = cos θ cos ψ
i.ψˆ = −sin ψ
⎫
⎬
⎭
j.r ˆ = sin θ sin ψ
j.θˆ = cos θ sin ψ
j .ψˆ = cos ψ
⎫
⎬
⎭
k.r ˆ = cos θ
k.θˆ = −sin θ
k.ψˆ = 0 
⎫
⎬
⎭
(A.9) 
For example, 
i.rˆ

means the component of i onto r ˆ and so on for the rest of dot 
product. This set produces the following set: 
i = sin θ cos ψ r ˆ + cos θ cos ψ θˆ − sin ψ ψˆ
j = sin θ sin ψ r ˆ + cos θ sin ψ θˆ + cos φ ψˆ
k = cos θ r ˆ − sin θ θˆ
⎫
⎬
⎭
(A.10) 
Substituting A.10 and A.8 into Cartesian gradient, 
∇ =
∂
∂x 
i +
∂
∂ y 
j +
∂
∂z 
k 
We get for each component 
∂
∂x 
i =
[
sin θ cos ψ
∂
∂r +
cos θ cos ψ
r 
∂
∂θ +
sin ψ
rsin θ
∂
∂ψ ]

sin θ cos ψ r ˆ + cos θ cos ψ θˆ − sin ψˆ

∂
∂ y 
j =
[
sin θ sin ψ
∂
∂r +
cos θ sin ψ
r 
∂
∂θ +
cos ψ
rsin θ
∂
∂ψ ]

sin θ sin ψ r ˆ + cos θ sin ψ θˆ + cos ψ ψˆ

∂
∂z 
k =
[
cos θ
∂
∂r − sin θ
r 
∂
∂θ ]
cos θ r ˆ − sin θ θˆ

Summing up (exercise) and rearranging, we get a surprisingly short expression 
for the gradient in the spherical coordinates system: 
∇ =
∂
∂r 
r ˆ +
1 
r 
∂
∂θ
θˆ +
1 
rsin θ
∂
∂ψ ψˆ (A.11) 
Obtaining the directional derivative in 3D is a bit complicated ( ∂φ
∂s = Ω.∇φ); 
therefore, we will limit ourselves to spherical symmetry (r, μ) only. Just to get the 
feeling of complexity the streaming term in all dimensions and directions (general) 
is 
Ω.∇ϕ = μ
∂ϕ
∂r +
1 − μ2 
r 
∂ϕ
∂μ +
√
1 − μ2 
r 
sinω
sinθ
∂ϕ
∂ψ258 Appendix A: The concept of Directional Derivative
+
√
1 − μ2 
r cosω∂ϕ
∂θ −
√
1 − μ2 
r sinωcotθ
∂ϕ
∂ω
Based on the assumption, the flux varies with r and therefore Ω,as a result, 
varies with μ as defined at the beginning and not equal to cosθ. We consider the 
simplifying equation A.4 where small changes in the angle θ affects the geometry 
as shown. Using the definition of the directional derivative and equation A.10, it 
can be written in spherical coordinates as 
∂ f 
∂s = Ω.∇ f =
[
∂r (s)
∂s r ˆ +
∂θ(s)
∂s 
θˆ + ∂ψ(s)
∂s 
ψˆ
]
.
[
∂ f 
∂r 
r ˆ +
1 
r 
∂ f 
∂θ
θˆ +
1 
rsin θ
∂ f 
∂ψ ψˆ
]
Ω.∇ f =
[
∂ f 
∂r 
∂r (s)
∂s 
+
1 
r 
∂ f 
∂θ
∂θ(s)
∂s
+
1 
rsin θ
∂ f 
∂ψ
∂ψ(s)
∂s
]
We drop the last term for the spherical symmetry 
∂ f 
∂s = Ω.∇ f (r , θ) = ∂ f 
∂r 
∂r(s)
∂s 
+
1 
r 
∂ f 
∂θ
∂θ(s)
∂s 
and 
∂ f 
∂s = Ω.∇ f (r, μ) = ∂ f 
∂r 
∂r (s)
∂s
+
∂ f 
∂μ
∂μ(s)
∂s 
The Ω component on r ˆ is Ωr = Ω.r ˆ = cosϑ = μ. Substituting for ∂r(s)
∂s from 
the differential triangle in Fig. 1.26, 
∂r (s)
∂s ≈ dr 
ds = cosϑ = μ and 
∂θ(s)
∂s ≈ dθ(s)
ds = sinϑ
r 
∂ f 
∂r 
∂r (s)
∂s = μ
∂ f 
∂r 
and 
dμ(s)
ds = dμ
dθ
dθ(s)
ds = −sinθ
r (−sinθ) = 1 − μ2 
r 
∂ f 
∂μ
∂μ(s)
∂s = 1 − μ2 
r 
∂ f 
∂μ
∂ f 
∂s = Ω.∇ f (r , μ) = μ
∂ f 
∂r +
1 − μ2 
r 
∂ f 
∂μAppendix A: The concept of Directional Derivative 259
Fig. A.5 Directional derivative in a 3D spherical geometry 
When f = φ, then (Fig. A.5) 
Ω.∇φ = μ
∂
∂r 
φ(r, μ) +
1 − μ2 
r 
∂
∂μφ(r, μ)B Solid Angle and Differential Velocity 
B.1 Solid Angle 
It is the differential area dS on a spherically shaped surface encapsulated by the 
differential movement of the unit vector Ω in 3D space and referred to as dΩ. The 
differential surface area is estimated by approximating its dimensions in the phase 
space. Referring to Fig. B.1, the approximate dimensions are 1dθ; 1(sin θ)dψ; 
hence, 
dΩ = sin θ dθdψ
The area drawn by the solid angle if θ and ψ is extended to their limits 
π and 2π, respectively, is the area of the unit sphere 4π or

4π
dΩ =

2π
0 
dψ
π
0 
sin θ dθ = 4π
Likewise, if θ = π/2 and ψ = 2π, then the motion creates the upper 
hemispherical area

2π
dΩ =

2π
0 
dψ

π/2
0 
sin θ dθ = 2π
B.2 Differential Velocity 
The derivation of the differential velocity dυ is similar to that of the solid angle 
if we replace the unit radius by υ. Figure B.2 illustrates this quantity represented 
by the volume resulting from differential changes in the velocity and the angles 
θ and ψ. Therefore, the volume created is (υ sin θ dψ)(υdθ)(dυ) or 
dυ = υ2dυsin θ dθdϕ = υ2dυdΩ
© The Editor(s) (if applicable) and The Author(s), under exclusive license 
to Springer Nature Switzerland AG 2023 
R. M. Kuridan, Neutron Transport, Graduate Texts in Physics, 
https://doi.org/10.1007/978-3-031-26932-5 
261262 Appendix B: Solid Angle and Differential Velocity
Fig. B.1 The solid angle dΩ
Fig. B.2 Differential velocity dυC Radiative Transport 
Transport theory refers to the mathematical description of the transport of particles 
through a host medium. In this section, we survey the various transport processes 
through the governing equations to emphasize three things besides informing the 
reader about the differences between the physical and mathematical characteristics: 
firstly, the applications of transport theory. Secondly, the size of difficulty when 
using the deterministic numerical methods as a method of solution. Thirdly, the 
type of probabilities involved in the balance equations are taken into account in 
random sampling. Figure C.1 shows different particles which may be transported 
through the medium. 
C.1 Applications of the Transport Theory 
They include the following areas: 
Nuclear reactors 
• Neutron flux distribution in reactor cores. 
• Shielding against neutron and gamma radiation. 
Astrophysics
• Diffusion of light through stellar atmosphere.
Neutrons 
Photons 
Electrons 
Ions 
Waves (less than a mfp) 
Gas molecules 
Transport 
Processes 
of Partcles 
Fig. C.1 Particles transported through the medium 
© The Editor(s) (if applicable) and The Author(s), under exclusive license 
to Springer Nature Switzerland AG 2023 
R. M. Kuridan, Neutron Transport, Graduate Texts in Physics, 
https://doi.org/10.1007/978-3-031-26932-5 
263264 Appendix C: Radiative Transport
• Penetration of light through planetary atmospheres. 
Rarified gas dynamics 
• Upper atmosphere physics. 
• Sound propagation. 
• Diffusion of molecules in gases. 
Charged particle transport 
• Multiple scattering of electrons. 
• Gas discharge physics. 
• Diffusion of holes and electrons in semiconductors. 
• Development of cosmic ray showers. 
• Transport of electromagnetic radiation. 
• Multiple scattering of radar waves in a turbulent atmosphere. 
• Penetration of X-rays through matter. 
Plasma physics 
• Microscopic plasma dynamics micro-instabilities. 
• Plasma kinetic theory. 
Other 
• Traffic flow (transport of vehicles along highways). 
• Molecular orientation of macromolecules. 
• Particle transport equations. 
C.1.1 Neutron Transport Equation 
The general form of the neutron transport equation is 
1 
υ
∂φ
∂t 
+ Ω · ∇φ + Σt φ

r , E, Ω, t

=
∞
0 
d E'

dΩ'
Σs

E'
, Ω' → E, Ω
φ

r, E'
, Ω'
, t

+ S

r, E, Ω, t
Appendix C: Radiative Transport 265
The neutron source can be localized or due to fission. The general source term 
is expressed as 
S

r , E, Ω, t

= χ(E)
4π
∞
0 
d E'

dΩ'
ν

E'

Σ f

r , E'

φ

r, E'
, Ω'
, t

+ Sl

r , E, Ω, t

Sample problems: 
• Sources in an infinite media (plane or point). 
• Behavior of flux near a free surface (Milne problem). 
• Reflection of neutrons from interfaces or surface (albedo problem). 
• Finite geometry problems (slabs or spheres). 
• Criticality problems. 
• Time-dependent problems. 
• Initial value problem (pulsed neutrons). 
C1.2 Photon Transport Equation: (Low Energy e.g. Light) 
We define the photon energy intensity as 
Iγ

r, E, Ω, t

= (hν)cn
r , E, Ω, t

= photon energy times the photon flux. 
h is Planck’s constant 
ν is the photon frequency 
c is the speed of light 
n is the number of photons/cm2 s. 
C1.3 Photon Transport Equation (High-Energy, e.g. Gamma 
and X-rays) 
Steady-state Boltzmann equation for gamma rays: 
Ω · ∇ Iν

r , λ,Ω
+ ∑(λ)Iν

r, λ,Ω
=

λ
0 
dλ'

4π
dΩ'
Nek

λ'
, λ
Iν

r, λ'
, Ω'
 δ

1 + λ' − λ − Ω' · Ω
2π
+ S

r, λ,Ω
and k

λ'
, λ
= 2π
 λ
λ'

σ

λ'
, θ266 Appendix C: Radiative Transport
where: 
Iν

r, λ,Ω
dEdΩ: energy flux density 
Iν

r, λ,Ω
= Eγ φγ : MeV/cm2 s 
λ: gamma ray energy after scattering expressed in terms of its Compton wave￾length. E = hν, ν = c/λ
λ'
: gamma ray wavelength prior to scattering 
Ω' · Ω = cos θ: cosine of the scattering angle between initial and final unit 
direction vectors 
Σ(λ): total macroscopic x-section at energy corresponding to the gamma ray 
wavelength 
Ne: electron density [no. of electrons/cm3] = ZN 
N: atom density 
σ

λ'
, θ
: microscopic x-section per electron for Compton scattering given by 
Klein–Nishina formula. 
δ

1 + λ' − λ − Ω' · Ω
: dirac delta function that prescribes the angular change 
Ω'
·Ω be consistent with the change in wave length λ'
−λ as given by the Compton 
scattering equation λ' − λ = 1 − Ω' · Ω). 
S

r, λ,Ω
dEdΩ: energy emission by gamma ray sources [MeV/cm3 s]. 
C.1.4 Radiative Transport Equation 
1 
c 
∂ Iν
∂t 
+ Ω · ∇ Iν = ρ

r , t
−κν

r , Ω, t

Iν

r , Ω, t

+ εν

r, Ω, t

ρ

r , t

: material density 
κν

r , Ω, t

: absorption coefficient 
εν

r , Ω, t

: emission coefficient.Appendix C: Radiative Transport 267
C.1.5 Electron Transport Equation 
The electron transport equation is similar to that of neutrons except for two 
physical differences. 
1. strong infrequent collisions with heavy ions (nuclei) in which little energy 
transfer occurs (large-angle deflection) 
1 
υ
∂φ
∂t 
+ Ω · ∇φ + ∑t φ

r , E, Ω, t

=

dΩ'
∑s

Ω' → Ω
φ

r , E, Ω'
, t

+ S

r, E, Ω, t

2. frequent weak collisions with atomic electrons which give rise to very irregular 
particle trajectories (small-angle deflections) 
It gives rise to energy loss. The energy loss over a given path length ξ . The dif￾ferential energy loss is given by the Beth formula for dE 
dξ and using dξ = υdt,
hence, 1 
υ ∂
∂t = ∂
∂ξ to get 
∂φ
∂ξ + Ω · ∇φ + ∑t φ

Ω
=

dΩ'
Σs

Ω' → Ω
φ

Ω'

+ S 
Monte Carlo is used because of multi-scatter events involved which are difficult 
or impossible to solve adequately by other mathematical techniques. 
C.1.6 Ionized Gases and Plasma Transport Equation 
The dynamics of ionized gases and plasmas is influenced by the long nature of 
Coulomb interaction.
∂ne 
∂t

coll 
= ∂ne 
∂t 
+ υ ·
∂ne 
∂r − e 
m

E

r, t

+ υ × B

r , t
.
∂ne 
∂υ
where 
ne: electron density 
E: electric field vector 
B: magnetic field vector 
υ: electron velocity.Input Description of the 1D Program D
D.1 Input Description 
The 1D program solves the steady neutron diffusion equation in one-dimensional 
geometry using the finite-difference method. It can be run either with one energy 
group or two energy groups and either in a slab or cylindrical geometry. Temper￾ature feedback can be simulated in terms of changes in absorption cross sections 
as a function of local power density. 
The input file has five data arrays, NDAT, ADAT, XSEC, AHX, and ILX in a 
free format. 
(1) DATA1 
1. NMAX, maximum number of mesh intervals,≤100 
2. NG, number of energy groups, ≤2 
3. NREG, number of different material regions, ≤4 
4. NPG, geometry, 0 for a slab, and 1 for cylinder 
5. BC(1), Left boundary condition at x = x0,0 = zero flux, 1 = zero current 
6. BC(2), right boundary condition at x = xNMAX+1,0 = zero flux, 1 = zero 
current 
(2) DATA2 
1. APOUT, total core output, (MW). Need only for feedback calculation. 
Feedback calculation will be bypassed if APOUT = 0 
2. AREA, transverse cross-sectional area of core, (cm2); input only when 
APOUT /= 0 
3. BSQ, transverse buckling 
4. ελ, eigenvalue convergence criterion; default = 1.0×10–4 
5. εp, point-wise source convergence criterion; default = 1.0×10–4 
6. λ, initial eigenvalue guess, default = 1.0 
7. APC1, power coefficient, ∂
∑a(cm−1)
∂ P
 w
cm3
 , input only when APOUT/=0 
(3) AHX1 
Mesh spacing for N = 1,2, ….. NMAX. 
(4) ILX1
© The Editor(s) (if applicable) and The Author(s), under exclusive license 
to Springer Nature Switzerland AG 2023 
R. M. Kuridan, Neutron Transport, Graduate Texts in Physics, 
https://doi.org/10.1007/978-3-031-26932-5 
269270 Appendix D: Input Description of the 1D Program
Material region number for each mesh interval, N =1, 2, 3, …. NMAX. 
(5) XSEC 
One group cross sections: 
Identifier # D ∑a ν∑ f 
Two group cross sections, 
Identifier # D1 ∑a1 ∑s12 ν∑ f 1 D2 ∑a2 ν∑ f 2 
The identifier corresponds to the material region number given in the array ILX 
designated by a set of cross sections. 
Sample input text file: 
A bare core without a reflector (one region slab core), one group cross sections 
with a fixed mesh size, and zero flux boundary conditions. The slab corresponds 
to the axial direction of the reactor core. 
File name1.inp 
NMAX, NG, NREG, PG, BC 
26 1 1 0 0 0 
POUT, AREA, BSQ, EPSE, EPSP, LAMDA 
0.0 0.0 0.0 1.0e-4 1.0e-4 1.0 
(AHX(I), I=1, NMAX) 
26*6.0 
(ILX(I), I=1, NMAX) 
26*1 
(XSEC(I), I=1, NMG) 
1,9.21,0.1532,0.157, 
D.2 Running the 1D Program 
There are two ways of running the 1D program: 
(1) Once the input file is prepared in a notepad file you may run (execute) the 
1D program by double clicking the.exe file or (application file: the compiled 
source Fortran file). Both files can be downloaded from the publisher assigned 
site. You will be prompted for the input file name (name1.inp) and then you 
will be prompted for the output file name (name2.out). name2.out contains a 
detailed output. Finally, you will be prompted for another output file name 
(name3.out). The output file name3.out contains the power and relative flux 
profiles prepared for plotting using excel or other software.Appendix D: Input Description of the 1D Program 271
The output file name2.out consists of an edit of the DAT and other arrays, flux, 
and power profiles. Flux is normalized to one neutron produced per second in the 
core. Power distribution is also normalized so that the power averaged over the 
core is unity. The eigenvalue which is equivalent to the effective multiplication 
factor is also printed out. 
(2) Using the file 1D.mlapp (interface window) working in a MATLAB envi￾ronment. You will be prompted for the input items and then RUN the 
program 
Note: You can execute all the jobs without reference to the. For file unless you 
want to modify it, then you have to compile it using a Fortran compiler and 
produce a new .exe file such as the tasks described in some problems in the 
exercises. 
Sample output text file: 
D.3 Output Description 
The output file name2.out consists of an edit of the DAT and other arrays, flux, 
and power profiles. Flux is normalized to one neutron produced per second in the 
core. Power distribution is also normalized so that the power averaged over the 
core is unity. The eigenvalue which is equivalent to the effective multiplication 
factor is also printed out.272 Appendix D: Input Description of the 1D Program
File name2.out 
NMAX 
26 1 1 0 0 0 
POUT 
0.000000E+00 0.000000E+00 0.000000E+00 1.000000E-04 
1.000000E-04 1.000000 
AHX(I 
6.000000 6.000000 6.000000 6.000000 
6.000000 6.000000 6.000000 6.000000 
6.000000 6.000000 6.000000 6.000000 
6.000000 6.000000 6.000000 6.000000 
6.000000 6.000000 6.000000 6.000000 
6.000000 6.000000 6.000000 6.000000 
6.000000 6.000000 
ILX(I 
1 1 1 1 1 1 
1 1 1 1 1 1 
1 1 1 1 1 1 
1 1 1 1 1 1 
1 1 
XSEC(I 
1.000000 9.210000 1.532000E-01 1.570000E-01 
**** ONED DIFFUSION CODE **** 
MAXIMUM NO. OF MESH INTERVAL NMAX= 26 
NO. OF ENERGY GROUPS NG= 1 
NO. OF DIFFERENT MATERIAL REGIONS NREG= 1 
GEOMATERY 0/1=SLAB/CYLINDER PG= 0 
LEFT BOUNDARY CONDITION 0/1 FLUX/CURRENT BC(1)= 0 
RIGHT BOUNDARY CONDITION 0/1 FLUX/CURRENT BC(2)= 0 
TOTAL CORE POWER OUTPUT (MW) POUT= .00000E+00 
TRANSVER X-SECTIONAL AREA OF CORE AREA= .00000E+00 
TRANSVER BUCKLING (CM-2) BSQ= .00000E+00 
EIGEN VALUE CONVERGENCE CRITEION = .10000E-03 
POINT WISE SOURCE CONVERGENCE = .10000E-03 
INITIAL EIGEN VALUE GUESS = 1.00000 
I ILX AHX(CM) 
1 1 6.00000 
2 1 6.00000 
3 1 6.00000Appendix D: Input Description of the 1D Program 273
4 1 6.00000 
5 1 6.00000 
6 1 6.00000 
7 1 6.00000 
8 1 6.00000 
9 1 6.00000 
10 1 6.00000 
11 1 6.00000 
12 1 6.00000 
13 1 6.00000 
14 1 6.00000 
15 1 6.00000 
16 1 6.00000 
17 1 6.00000 
18 1 6.00000 
19 1 6.00000 
20 1 6.00000 
21 1 6.00000 
22 1 6.00000 
23 1 6.00000 
24 1 6.00000 
25 1 6.00000 
26 1 6.00000 
**** ONED DIFFUSION CODE **** 
CROSS SECTIONS
-----------------------------------------------
|REGION| D | SA | NUSF |
-----------------------------------------------
| 1 | .92100E+01| .15320E+00| .15700E+00|
-----------------------------------------------
| 0 | .00000E+00| .00000E+00| .00000E+00|
-----------------------------------------------
| 0 | .00000E+00| .00000E+00| .00000E+00|
-----------------------------------------------
| 0 | .00000E+00| .00000E+00| .00000E+00|
-----------------------------------------------
*** FLUX HAS CONVERGED AFTER 24 ITERATION 
*** WITH EIGEN VALUE= 1.0004330 
POWER AND ONE GROUP FLUX VS POSITION 274 Appendix D: Input Description of the 1D Program
--------------------------------------
|MESH |POSITION| POWER | FLUX |
--------------------------------------
| 1 | .00 | .09482 |.00000E+00|
--------------------------------------
| 2 | 6.00 | .28308 |.77464E-02|
--------------------------------------
| 3 | 12.00 | .46719 |.15379E-01|
--------------------------------------
| 4 | 18.00 | .64447 |.22788E-01|
--------------------------------------
| 5 | 24.00 | .81233 |.29862E-01|
--------------------------------------
| 6 | 30.00 | .96831 |.36501E-01|
--------------------------------------
| 7 | 36.00 | 1.11015 |.42605E-01|
--------------------------------------
| 8 | 42.00 | 1.23579 |.48088E-01|
--------------------------------------
| 9 | 48.00 | 1.34339 |.52869E-01|
--------------------------------------
| 10 | 54.00 | 1.43140 |.56879E-01|
--------------------------------------
| 11 | 60.00 | 1.49854 |.60059E-01|
--------------------------------------
| 12 | 66.00 | 1.54385 |.62364E-01|
--------------------------------------
| 13 | 72.00 | 1.56667 |.63761E-01|
--------------------------------------
| 14 | 78.00 | 1.56667 |.64228E-01|
--------------------------------------
| 15 | 84.00 | 1.54385 |.63761E-01|
--------------------------------------
| 16 | 90.00 | 1.49854 |.62364E-01|
--------------------------------------
| 17 | 96.00 | 1.43140 |.60059E-01|
--------------------------------------
| 18 | 102.00 | 1.34339 |.56879E-01|
--------------------------------------
| 19 | 108.00 | 1.23579 |.52869E-01|
--------------------------------------
| 20 | 114.00 | 1.11015 |.48088E-01|
--------------------------------------
| 21 | 120.00 | .96831 |.42605E-01|
--------------------------------------
| 22 | 126.00 | .81233 |.36501E-01| 
| 20 | 114.00 | 1.11015 |.48088E-01| --------------------------------------
--------------------------------------
| 21 | 120.00 | .96831 |.42605E-01|
--------------------------------------
| 22 | 126.00 | .81233 |.36501E-01|
--------------------------------------Appendix D: Input Description of the 1D Program 275
File name3.out 
POSITION POWER FLUX 
.00 .09482 .00000E+00 
6.00 .28308 .77464E-02 
12.00 .46719 .15379E-01 
18.00 .64447 .22788E-01 
24.00 .81233 .29862E-01 
30.00 .96831 .36501E-01 
36.00 1.11015 .42605E-01 
42.00 1.23579 .48088E-01 
48.00 1.34339 .52869E-01 
54.00 1.43140 .56879E-01 
60.00 1.49854 .60059E-01 
66.00 1.54385 .62364E-01 
72.00 1.56667 .63761E-01 
78.00 1.56667 .64228E-01 
84.00 1.54385 .63761E-01 
90.00 1.49854 .62364E-01 
96.00 1.43140 .60059E-01 
102.00 1.34339 .56879E-01 
108.00 1.23579 .52869E-01 
114.00 1.11015 .48088E-01 
120.00 .96831 .42605E-01 
126.00 .81233 .36501E-01 
132.00 .64447 .29862E-01 
138.00 .46719 .22788E-01 
144.00 .28308 .15379E-01 
150.00 .09482 .77464E-02 
156.00 .00000 .00000E+00 
| 23 | 132.00 | .64447 |.29862E-01|
--------------------------------------
| 24 | 138.00 | .46719 |.22788E-01|
--------------------------------------
| 25 | 144.00 | .28308 |.15379E-01|
--------------------------------------
| 26 | 150.00 | .09482 |.77464E-02|
--------------------------------------
| 27 | 156.00 | .00000 |.00000E+00|
--------------------------------------
**** ONED DIFFUSION CODE **** 
This sample problem is a criticality search problem where the core dimensions 
and the nuclear properties such as nuclear densities of the isotopes making up 
the core and the reflector are known and the task is to find the eigenvalue of the 
system (the criticality constant). The problem could be reversed if the reactor is 
known to be critical (the eigenvalue ∼= 1) and the nuclear densities are unchanged 
however the dimensions need to be found. In this case, it is a critical size search 
problem where the mesh number and spacing are varied in a systematic way until 
the eigenvalue is nearly equal to one with an acceptable deviation. The fissile 
density could also be varied through enrichment and the densities of absorber 
material such as control absorber, soluble Boron, or burnable absorbers can also276 Appendix D: Input Description of the 1D Program
be varied and therefore the nuclear cross sections in the input file are altered and 
the effect on criticality can be observed and hence studied. Notice that ∑ = N σ, 
where N is the isotopic density and σ is the microscopic cross section.E Sample Problems and Exercises 
for the 1D Program 
1. Bare (un-reflected) slab research reactor core: The slab represents the core axi￾ally in harmony with the expected cosine shape solution (Fig. E.1). The input 
file with one group cross sections is shown in Fig. E.2. The mesh spacing is 
varied with thicknesses: 2; 4; 6; 12 cm and the resulting fluxes are plotted along 
with the analytic solution [Ccos(π/H)]. In all the cases, the mesh spacing need 
not to be equal (Fig. E.1). 
The relative fluxes all coincide with the analytic solution which implies the 
accuracy of the numerical scheme (Fig. E.3). The variation of the mesh spacing 
does not alter the shape and the eigenvalues are almost unaffected as expected. 
However, if on the other hand the cross sections are modified the eigenvalues will 
change (Figs. E.2 and E.3).
Slab 
height 
core 
top 
tcelfer ro
Radial 
reflector 
bottom 
rotcelfer 
Fig. E.1 Core and reflectors in cylindrical geometry 
© The Editor(s) (if applicable) and The Author(s), under exclusive license 
to Springer Nature Switzerland AG 2023 
R. M. Kuridan, Neutron Transport, Graduate Texts in Physics, 
https://doi.org/10.1007/978-3-031-26932-5 
277278 Appendix E: Sample Problems and Exercises for the 1D Program
NMAX, NG, NREG, PG,BC 
26 1 1 0 0 0 
POUT, AREA, BSQ, EPSE, EPSP, LAMDA 
0.0 0.0 0.0 1.0e-4 1.0e-4 1.0 
(AHX(I), I=1, NMAX) 
26*6.0 
(ILX(I), I=1, NMAX) 
26*1 
(XSEC(I), I=1, NMG) 
1 9 21 0 1532 0 157 
Fig. E.2 Bare slab core input file 
0.000 
0.010 
0.020 
0.030 
0.040 
0.050 
0.060 
0.070 
78 84 90 96 102 108 114 120 126 132 138 144 150 156 
(∆x=2 cm) (∆x=4 cm) (∆x=6 cm) 
Normalized flux 
Core hight (cm) 
Fig. E.3 Relative fluxes in the upper part of the bare slab core 
2. Reflected slab core: It is reflected from above and below. A three-region core 
needs to be defined (reflector–core–reflector) and one group cross sections are 
chosen. The input file is shown in Fig. E.4.
3. Reflected cylindrical core with two energy group cross sections: Because, of 
the radial symmetry of the cylinder two regions can be described, the core and 
its reflector. Therefore, the boundary conditions are zero current at the center 
and zero flux on the outside and the printout follow accordingly. The input file 
is presented in Fig. A.2.e. The eigenvalue is about 1.26 because it is a core-free 
poison (Fig. E.5).
Exercises
1. You may test the effect of changing the nuclear cross sections and mesh spacing 
on criticality. Also, you can calculate the reflector savings on the core size by 
considering a bare critical core and then repeating the calculation after introduc￾ing a reflector. The eigenvalue will increase because some neutrons are reflectedAppendix E: Sample Problems and Exercises for the 1D Program 279
NMAX, NG, NREG, PG, BC 
38 1 3 0 0 0 
POUT, AREA, BSQ, EPSE, EPSP, LAMDA 
0.0 0.0 0.0 1.0e-4 1.0e-4 1.0 
(AHX(I), I=1, NMAX) 
6*2.0 26*6.0 6*2.0 
(ILX(I), I=1, NMAX) 
6*1 26*2 6*3 
(XSEC(I), I=1, NMG)
 1,1.328,.0181,0, 
 2,9.21,0.1532,0.157, 
3,1.328,.0181,0, 
Fig. E.4 Reflected slab core input file
NMAX, NG, NREG, PG, BC 
39 2 2 1 1 0 
POUT, AREA, BSQ, EPSE, EPSP, LAMDA 
0.0 0.0 0.0 1.0e-4 1.0e-4 1.0 
(AHX(I), I=1, NMAX) 
34*5.0 5*5.0 
(ILX(I), I=1, NMAX) 
34*1 5*2 
(XSEC(I),I=1,NMG) 
1,1.2627 0.01207 .02619 .008476 .3543 .121 .18514 
2,1.13 0.0004 0.0494 0.000 0.16 0.0197 0.000 
Fig. E.5 Reflected cylindrical core input file
back to the core enhancing it to become supercritical. In order to regain criti￾cality the core size is reduced and the amount of volume removed is the savings 
as a result of reflector presence.
2. Improve the printout of the text output file to look more elegant. 
3. Develop an interface window to use Matlab for input/output data. 
4. Modify the 1D program so that the normalized flux and normalized power 
output become in MW and n/cm2 s, respectively. 
5. Modify the 1D program to perform a depletion calculation (the numerical 
scheme is in Chap. 2). 
6. Modify the 1D program to perform an adjoint calculation (theory is in Chap. 4). 
(Notice that the eigenvalues should be equal in both the forward and the adjoint 
versions). 
7. Convert the FORTRAN file to PYTHON programing language.F Legendre Polynomials 
Legendre differential equation

1 − x2
y'' − 2x y' + n(n + 1)y = 0 
where n is a real number in the range (−1, 1)
Pn(x) =
≤ l 
∑2
l=0 
(−1)
l (2n − 2l)!
2nl!(n − l)!(n − 2l)!
xn−2l 
Pn(x) = 1 
2nn!
dn 
dxn (x2 − 1)
n 
Properties: 
Conjugate Legendre polynomials series: 
Pm 
n (x) = (1 − x2)
m/2 dm 
dxm Pn(x), −n ≤ m ≤ n 
P0(x) = 1, (x) = x, P2(x) = 1 
2

3x2 − 1

P4(x) = 1 
8 
(35x4 − 30x2 + 3),
P5(x) = 1 
8 
(63x5 − 70x3 + 15x)....
Orthogonality: 

1
−1 
dx Pn(x)Pm (x) =
0 m /= n 2 
2n+1 m = n
© The Editor(s) (if applicable) and The Author(s), under exclusive license 
to Springer Nature Switzerland AG 2023 
R. M. Kuridan, Neutron Transport, Graduate Texts in Physics, 
https://doi.org/10.1007/978-3-031-26932-5 
281282 Appendix F: Legendre Polynomials
Recursion relations: 
(n + 1)Pn+1(x) − (2n + 1)x Pn(x) + n Pn−1(x) = 0 
P'
n+1(x) − x P'
n(x) = (n + 1)Pn(x)

1 − x2 ∂ Pn(x)
∂x = n(n + 1)
(2n + 1)

Pn−1(x) − Pn+1(x)

